{"PublicRelease": "\u00a92019 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-00646-3", "Techniques": [{"TechniqueId": "T1126", "TechniqueName": "Network Share Connection Removal", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.C.1-10.png", "ScreenshotCaption": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.C.1-10.png", "ScreenshotCaption": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1026", "TechniqueName": "Multiband Communication", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Detections": [{"DetectionNote": "Telemetry showed the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-20.png", "ScreenshotCaption": "Telemetry showing the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain) (tainted by a parent Injected Shellcode alert, listed as Owner process)"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Detections": [{"DetectionNote": "Telemetry showed that powershell.exe had an outgoing connection on port 443, identified as HTTP type traffic. Telemetry also showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing netstat with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-4.C.1-100.png", "ScreenshotCaption": "Enrichment of netstat.exe executing labeled as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-4.C.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing netstat with command-line arguments"}]}, {"DetectionNote": "The capability enriched netstat.exe executing as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-4.C.1-100.png", "ScreenshotCaption": "Enrichment of netstat.exe executing labeled as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-4.C.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing netstat with command-line arguments"}]}]}, {"SubStep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Detections": [{"DetectionNote": "Telemetry showed netstat.exe executing with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.E.1.12-1.png", "ScreenshotCaption": "Enriched alert for netstat.exe labeled with Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery)\u00a0(tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.E.1.12-1.png", "ScreenshotCaption": "Enriched alert for netstat.exe labeled with Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery)\u00a0(tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery). The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-13.B.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Network Connections Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-13.B.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-13.B.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Network Connections Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-13.B.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"SubStep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed netstat.exe executing with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-13.B.2-10.png", "ScreenshotCaption": "Enrichment showing netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-13.B.2-10.png", "ScreenshotCaption": "Enrichment showing netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1132", "TechniqueName": "Data Encoding", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Detections": [{"DetectionNote": "Telemetry showed base64-encoded DNS requests for freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.C.1-20.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-1.C.1-100.png", "ScreenshotCaption": "Process tree showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing ipconfig with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.A.1-10.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig with command-line arguments"}]}, {"DetectionNote": "The capability enriched cmd.exe executing ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.A.1-10.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing ipconfig with command-line arguments"}]}]}, {"SubStep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Detections": [{"DetectionNote": "Telemetry showed arp.exe executing with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.A.2-5.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp with command-line arguments"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing arp with command-line arguments"}, {"ScreenshotName": "CR-2.A.2-10.png", "ScreenshotCaption": "Telemetry showing arp.exe executing within the process tree (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments. command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-4.B.1-10.png", "ScreenshotCaption": "Enrichment of netsh.exe executing with correct ATT&CK Tactic (Discovery) and related Technique (Security Software Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched netsh.exe executing with the correct ATT&CK Tactic (Discovery) and a related Technique (Security Software Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-4.B.1-10.png", "ScreenshotCaption": "Enrichment of netsh.exe executing with correct ATT&CK Tactic (Discovery) and related Technique (Security Software Discovery) (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed route.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.A.1-1.png", "ScreenshotCaption": "Telemetry showing route.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed ipconfig.exe executing with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched ipconfig.exe executing with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe executing with correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1039", "TechniqueName": "Data from Network Shared Drive", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed connection between Nimda (10.0.1.6) and the source of the file, Conficker (10.0.0.5), over port 445.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "CR-9.B.1-20.png", "ScreenshotCaption": "Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)"}]}]}, {"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing systeminfo with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.E.1-11.png", "ScreenshotCaption": "Enrichment of systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing systeminfo"}]}, {"DetectionNote": "The capability enriched systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.E.1-11.png", "ScreenshotCaption": "Enrichment of systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing systeminfo"}]}]}, {"SubStep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.E.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.E.2-12.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}]}, {"DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.E.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.E.2-12.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Detections": [{"DetectionNote": "No detection capability was available, though an alert was generated based on explorer.exe being flagged for loading a Meterpreter Agent. Data within a previous process injection alert showed the\u00a0loaded screenshotx64.dll module.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "CR-8.D.1-11.png", "ScreenshotCaption": "Alert for explorer.exe loading a Meterpreter agent (does not count as detection)"}, {"ScreenshotName": "CR-8.D.1-10.png", "ScreenshotCaption": "Alert showing loaded screenshotx64.dll module (does not count as a detection)"}]}]}]}, {"TechniqueId": "T1010", "TechniqueName": "Application Window Discovery", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for process injection from powershell.exe into cmd.exe (Anonymous RWX). The alert is tagged with the correct ATT&CK Tactic (Defense Evasion) and Technique (Process Injection). The alert is tainted by a parent PowerShell alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-3.C.1-10.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe injecting into cmd.exe"}, {"ScreenshotName": "CR-3.C.1-100.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell injection into cmd.exe mapped to ATT&CK Tactic (Defense Evasion) and Technique (Process Injection) (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for svchost.exe reflectively loading a malicious executable, identified as Mimikatz, then accessing lsass. The alert was also tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation). The powerkatz.dll was also seen loaded as a floating executable code.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CR-5.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert with correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)"}, {"ScreenshotName": "CR-5.A.1-21.png", "ScreenshotCaption": "Data within alert showing loaded powerkatz.dll as floating executable code"}]}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for svchost.exe injection into lsass.exe. The alert was mapped with the correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection). The hashdumpx64.dll was also seen loaded as a floating executable code.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CR-5.A.2-10.png", "ScreenshotCaption": "Specific Behavior alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection"}, {"ScreenshotName": "CR-5.A.2-20.png", "ScreenshotCaption": "Details of Specific Behavior alert for svchost.exe process injection into lsass.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)"}, {"ScreenshotName": "CR-5.A.2-11.png", "ScreenshotCaption": "Data within alert showing loaded hashdumpx64.dll as floating executable code"}]}]}, {"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated based on a malicious code injection caused by process injection of explorer.exe. The alert was mapped with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection) and indicated that explorer.exe was hosting injected threads and loading malicious files.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CR-8.D.1-21.png", "ScreenshotCaption": "Specific Behavior alert for process injection explorer.exe rolled into chain of injections"}, {"ScreenshotName": "CR-8.D.1-20.png", "ScreenshotCaption": "Specific Behavior alert for Malicious code injection to explorer.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)"}]}]}]}, {"TechniqueId": "T1061", "TechniqueName": "Graphical User Interface", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Detections": [{"DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-7.A.1-30.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}]}]}]}, {"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type. The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process Telemetry also showed rdpclip.exe executing on 10.0.0.5 (Conficker).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-20.png", "ScreenshotCaption": "Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent Injected Shellcode alert, listed as Owner process)"}, {"ScreenshotName": "CR-6.C.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type"}, {"ScreenshotName": "CR-6.C.1-11.png", "ScreenshotCaption": "Telemetry showing rdpclip.exe executing on 10.0.0.5 (Conficker)"}]}]}, {"SubStep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "Telemetry showed the logon session for Jesse to Conficker (10.0.0.5) as a Remote Interactive Logon Type. Telemetry also showed a connection over port 3389 to Conficker (10.0.0.5) through rundll32.exe serving as a proxy. The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-10.B.1-10.png", "ScreenshotCaption": "Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type"}, {"ScreenshotName": "CR-10.B.1-20.png", "ScreenshotCaption": "Telemetry showing a TCP port 3389 connection to Conficker (10.0.0.5)"}, {"ScreenshotName": "CR-10.B.1-100.png", "ScreenshotCaption": "Telemetry showing rundll32.exe process used to proxy connection over port 3389 from Nimda (10.0.1.6) to Conficker (10.0.0.5) (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "Telemetry showed creation of a RDP session on Creeper (10.0.0.4).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-20.A.1-21.png", "ScreenshotCaption": "Enrichment of RDP connection to\u00a0Creeper (10.0.0.4) identified as using RDP Port and related ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port, Standard Application Layer Protocol)"}, {"ScreenshotName": "CR-20.A.1-20.png", "ScreenshotCaption": "Telemetry of connection to port 3389 on Creeper (10.0.0.4)"}]}, {"DetectionNote": "The capability enriched a RDP connection with information that the connection was made to a RDP port, as well as a related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CR-20.A.1-21.png", "ScreenshotCaption": "Enrichment of RDP connection to\u00a0Creeper (10.0.0.4) identified as using RDP Port and related ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port, Standard Application Layer Protocol)"}, {"ScreenshotName": "CR-20.A.1-20.png", "ScreenshotCaption": "Telemetry of connection to port 3389 on Creeper (10.0.0.4)"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \"\\\\conficker\\wormshare\"' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-8.A.1-10.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched cmd.exe executing dir with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-8.A.1-10.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing tree with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-8.A.1-20.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the tree with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched cmd.exe executing tree with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-8.A.1-20.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the tree with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "Telemetry showed the creation of updater.dll. Telemetry was tainted by a parent alert on cmd.exe (listed as the owner process) generated based on updater.dll being detected as known malware.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-7.B.1-10.png", "ScreenshotCaption": "Telemetry showing the file write of updater.dll (tainted by a parent alert on cmd.exe, listed as Owner Process)"}, {"ScreenshotName": "CR-7.B.1-11.png", "ScreenshotCaption": "Parent alert for updater.dll being detected as known malware"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated based on the downloading and execution of wdbypass, identified as Fileless malware, from freegoogleadsenseinfo.com (C2 domain) over port 8080. The alert also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-14.A.1-40.png", "ScreenshotCaption": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080"}, {"ScreenshotName": "CR-14.A.1-10.png", "ScreenshotCaption": "Specific Behavior alert for Download & execute of the wdbypass file"}]}]}, {"SubStep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed the file write of autoupdate.vbs. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.E.1-10.png", "ScreenshotCaption": "Telemetry showing file write of autoupdate.vbs (tainted by a parent PowerShell alert, listed as Owner process)"}]}]}, {"SubStep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed file events for the write of update.vbs to Creeper (10.0.0.4).\u00a0The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.G.1-10.png", "ScreenshotCaption": "Telemetry of file events for write of update.vbs to Creeper (10.0.0.4) (tainted by a parent PowerShell alert, listed as Owner process)"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed the file creation of recycler.exe by powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.A.1-20.png", "ScreenshotCaption": "Telemetry showing file create/write of recycler.exe (tainted by a parent PowerShell alert, listed as Owner process)"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Detections": [{"DetectionNote": "Telemetry showed lsass.exe creating a Registry key for user Jesse, indicating that the user is new.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-7.A.1-20.png", "ScreenshotCaption": "Telemetry showing lsass.exe creating a Registry key for user Jesse"}]}]}]}, {"TechniqueId": "T1135", "TechniqueName": "Network Share Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Detections": [{"DetectionNote": "Telemetry showed the execution of ftp.exe and command-line arguments. [CR5]", "DetectionType": "Telemetry", "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched ftp.exe execution with a related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed creation of the .vsdx file in the Recycle Bin.\u00a0\u00a0The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-18.B.1-10.png", "ScreenshotCaption": "Telemetry of file create/write of vsdx (tainted by a parent PowerShell alert, listed as Owner process)"}]}]}]}, {"TechniqueId": "T1201", "TechniqueName": "Password Policy Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing sc with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.D.1-10.png", "ScreenshotCaption": "Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing sc with command-line arguments"}]}, {"DetectionNote": "The capability enriched cmd.exe executing sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.D.1-10.png", "ScreenshotCaption": "Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing sc with command-line arguments"}]}]}, {"SubStep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}]}, {"DetectionNote": "The capability enriched cmd.exe executing net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.B.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}]}]}, {"SubStep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Services Discovery). The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.D.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Services Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.D.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe with correct ATT&CK Technique (System Service Discovery) (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.D.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Services Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.D.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe with correct ATT&CK Technique (System Service Discovery) (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"SubStep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed sc.exe execution with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.H.1-10.png", "ScreenshotCaption": "Telemetry of sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed sc.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.J.1-10.png", "ScreenshotCaption": "Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Detections": [{"DetectionNote": "Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services were enabled. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.A.1-20.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Detections": [{"DetectionNote": "A General Behavior alert was generated based on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CR-1.A.1-10.png", "ScreenshotCaption": "General Behavior alert identifying Resume Viewer.exe as unknown malware"}, {"ScreenshotName": "CR-1.A.1-11.png", "ScreenshotCaption": "General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file"}, {"ScreenshotName": "CR-1.A.1-100.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated based on the identification of Resume Viewer.exe as unknown malware by the Anti-Malware engine. [CR1]", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CR-1.A.1-10.png", "ScreenshotCaption": "General Behavior alert identifying Resume Viewer.exe as unknown malware"}, {"ScreenshotName": "CR-1.A.1-11.png", "ScreenshotCaption": "General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file"}, {"ScreenshotName": "CR-1.A.1-100.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)"}], "Footnotes": [" Vendor stated that the capability would have prevented the execution of Resume Viewer.exe."]}, {"DetectionNote": "Telemetry showed that Resume Viewer.exe was executed and running as a process. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious. [CR2]", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-10.png", "ScreenshotCaption": "General Behavior alert identifying Resume Viewer.exe as unknown malware"}, {"ScreenshotName": "CR-1.A.1-11.png", "ScreenshotCaption": "General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file"}, {"ScreenshotName": "CR-1.A.1-100.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)"}], "Footnotes": [" The provided screenshot was captured later in the evaluation and includes additional information appended to explorer.exe not relevant to this procedure."]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.B.1-100.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed whoami.exe executing with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe executing with labels for Reconnaissance and Accounts discovery"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe executing with labels for Reconnaissance and Accounts discovery"}]}]}, {"SubStep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated based on whoami.exe performing Reconnaissance as a SYSTEM user. The alert was tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery). The alert was tainted by a parent Accessibility Features alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-20.B.1-10.png", "ScreenshotCaption": "Specific Behavior alert for whoami.exe execution with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent Accessibility Features alert)"}]}, {"DetectionNote": "Telemetry showed the execution of whoami.exe. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-20.B.1-10.png", "ScreenshotCaption": "Specific Behavior alert for whoami.exe execution with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent Accessibility Features alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.H.1-10.png", "ScreenshotCaption": "Telemetry within a process tree showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.H.1-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments"}]}]}, {"SubStep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.A.1-10.png", "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "13.C.1", "Procedure": "Empire:\u00ef\u00bf\u00bd'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-13.C.1-10.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.A.1-10.png", "ScreenshotCaption": "Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The alert was tainted by a parent PowerShell alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.A.1-10.png", "ScreenshotCaption": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.A.1-10.png", "ScreenshotCaption": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The alert was tainted by a parent PowerShell alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares). The alert was tainted by a parent PowerShell alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.D.1-100.png", "ScreenshotCaption": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.D.1-10.png", "ScreenshotCaption": "Process tree showing alert net.exe execution (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.D.1-100.png", "ScreenshotCaption": "Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.D.1-10.png", "ScreenshotCaption": "Process tree showing alert net.exe execution (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1110", "TechniqueName": "Brute Force", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00ef\u00bf\u00bdKmitnick, Bob, and Frieda", "Detections": [{"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.A.1-10.png", "ScreenshotCaption": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched net.exe execution with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.A.1-10.png", "ScreenshotCaption": "Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.A.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Detections": [{"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched net.exe execution with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for the unconventional creation of a new service with the correct ATT&CK Technique (New Service) and Tactic (Persistence, Privilege Escalation). The alert was tainted by a parent PowerShell alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.I.1-13.png", "ScreenshotCaption": "Specific Behavior alert for unconventional new service with correct ATT&CK Technique (New Service) and Tactics (Persistence, Privilege Escalation) (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed sc.exe executing with command-line arguments.[CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.I.1-13.png", "ScreenshotCaption": "Specific Behavior alert for unconventional new service with correct ATT&CK Technique (New Service) and Tactics (Persistence, Privilege Escalation) (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs though wscript.exe. The telemetry was tainted by a parent PowerShell alert based on a malicious Invoke-RunAs command.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.F.1-11.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs though wscript.exe (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-16.F.1-13.png", "ScreenshotCaption": "Parent alert on Malicious PowerShell Command (Invoke-RunAs)"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.C.1-20.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-1.C.1-100.png", "ScreenshotCaption": "Process tree showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)"}]}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "The capability enriched rundll32.exe opening an unusual network connection to the C2 server over the port 80 \"HTTP port.\u201d The data was tagged with the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol), and also showed the amount of transmitted/received bytes as well as that the winhttp.dll module was loaded (which an analyst could use to determine HTTP was used). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-30.png", "ScreenshotCaption": "Enrichment of rundll32.exe making an unusual network connection over the \\\"HTTP Port\\\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-6.B.1-100.png", "ScreenshotCaption": "Enrichment of rundll32.exe showing connection over port 80 and the amount of transmitted/received bytes (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-6.B.1-101.png", "ScreenshotCaption": "Enrichment of rundll32.exe showing winhttp.dll module loaded (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent PowerShell alert. Telemetry also showed that powershell.exe had an outgoing connection on port 443, identified as HTTP type traffic.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (does not count as a detection)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for powershell.exe executed as a PowerShell downloader. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol). Data also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-14.A.1-40.png", "ScreenshotCaption": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080"}, {"ScreenshotName": "CR-14.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol) (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1053", "TechniqueName": "Scheduled Task", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Detections": [{"DetectionNote": "Telemetry showed the Resume Viewer Update Checker scheduled task.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-7.C.1-10.png", "ScreenshotCaption": "Enrichment of schtasks.exe with the correct ATT&CK Tactic (Persistence)"}, {"ScreenshotName": "CR-7.C.1-11.png", "ScreenshotCaption": "Telemetry showing the Resume Viewer Update Checker scheduled task"}]}, {"DetectionNote": "The capability enriched schtasks.exe creating the Resume Viewer Update Checker scheduled task as reboot persistence and as SYSTEM. The data was also mapped to the correct ATT&CK Tactic (Persistence).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CR-7.C.1-10.png", "ScreenshotCaption": "Enrichment of schtasks.exe with the correct ATT&CK Tactic (Persistence)"}, {"ScreenshotName": "CR-7.C.1-11.png", "ScreenshotCaption": "Telemetry showing the Resume Viewer Update Checker scheduled task"}]}]}, {"SubStep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe executing update.dat with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-10.A.2-100.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-10.A.1-20.png", "ScreenshotCaption": "Parent alert for Injected shellcode into rundll32.exe"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Detections": [{"DetectionNote": "Telemetry showed the decoded powershell.exe function to gather clipboard data. The telemetry was tainted by a parent PowerShell alert..", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.E.1.5-1.png", "ScreenshotCaption": "Telemetry of the PowerShell function to gather clipboard data (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Detections": [{"DetectionNote": "No detection capability was available, though an alert was generated based on a chain of injections caused by process injection of powershell.exe to cmd.exe then explorer.exe.\u00a0Data within the alert showed the\u00a0loaded keyloggerx64.dll module, and additional data showed the memory address and size of the module within explorer.exe.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "CR-8.C.1-10.png", "ScreenshotCaption": "Alert for Chain of Injections for powershell.exe injecting into cmd.exe (does not count as detection)"}, {"ScreenshotName": "CR-8.C.1-100.png", "ScreenshotCaption": "Alert for Chain of Injections showing powershell.exe injecting into explorer.exe (does not count as detection)"}, {"ScreenshotName": "CR-8.C.1-11.png", "ScreenshotCaption": "Alert showing loaded keyloggerx64.dll module (does not count as detection)"}, {"ScreenshotName": "CR-8.C.1-12.png", "ScreenshotCaption": "Alert showing keyloggerx64.dll module loaded into explorer.exe, including memory address and size (does not count as a detection)"}]}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Detections": [{"DetectionNote": "An Indicator of Compromise alert was generated based on the execution of a malicious command in PowerShell named Get-Keystrokes.", "DetectionType": "Indicator of Compromise", "Screenshots": [{"ScreenshotName": "CR-15.A.1-20.png", "ScreenshotCaption": "Indicator of Compromise alert for Malicious Command Get-Keystrokes"}, {"ScreenshotName": "CR-15.A.1-100.png", "ScreenshotCaption": "Telemetry showing modloads associated with a keylogger"}]}, {"DetectionNote": "Telemetry showed modloads associated with the execution of a keylogger.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-15.A.1-20.png", "ScreenshotCaption": "Indicator of Compromise alert for Malicious Command Get-Keystrokes"}, {"ScreenshotName": "CR-15.A.1-100.png", "ScreenshotCaption": "Telemetry showing modloads associated with a keylogger"}]}]}]}, {"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.G.1-10.png", "ScreenshotCaption": "Telemetry showing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.G.2-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)"}]}, {"DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Technique (Account Discovery). The data was tainted by a parent Injected Shellcode alert", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.G.1-10.png", "ScreenshotCaption": "Telemetry showing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.G.2-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.G.2-10.png", "ScreenshotCaption": "Telemetry showing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.G.1-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Technique (Account Discovery). The data was tainted by a parent Injected Shellcode alert", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.G.2-10.png", "ScreenshotCaption": "Telemetry showing net executing with command-line arguments"}, {"ScreenshotName": "CR-2.G.1-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}]}]}, {"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Detections": [{"DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-7.A.1-10.png", "ScreenshotCaption": "Telemetry showing lusrmgr.msc running from mmc.exe"}]}]}, {"SubStep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Account Discovery). The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.G.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.G.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.G.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.G.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"SubStep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Account Discovery). The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.G.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.G.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.G.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.G.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed sc.exe executing with command-line arguments to set the service description. An analyst could use this information to determine it is not a legitimate service. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.I.1-21.png", "ScreenshotCaption": "Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "Telemetry showed that recycler.exe was WinRAR via file metadata. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.A.1-100.png", "ScreenshotCaption": "Telemetry showing recycler.exe identified as WinRAR via file metadata (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.B.1-20.png", "ScreenshotCaption": "Telemetry showing recycler.exe execution\u00a0(tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Detections": [{"DetectionNote": "Telemetry showed the logon session for Jesse to Conficker (10.0.0.5) as a Remote Interactive Logon Type.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-10.B.1-10.png", "ScreenshotCaption": "Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Enrichment of a logon attempt via net.exe using the valid credentials of user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched a logon attempt via net.exe, using the valid credentials of user Kmitnick, with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.B.1-20.png", "ScreenshotCaption": "Enrichment of a logon attempt via net.exe using the valid credentials of user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.D.1-10.png", "ScreenshotCaption": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments.[CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-16.D.1-10.png", "ScreenshotCaption": "General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed connection between Nimda (10.0.1.6) and the source of the file, Conficker (10.0.0.5), over port 445.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "CR-9.B.1-20.png", "ScreenshotCaption": "Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing the update.vbs from the Adobe Flash Updater service. Telemetry also showed\u00a0sc.exe executing the service. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-16.L.1-12.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing update.vbs"}, {"ScreenshotName": "CR-16.L.1-100.png", "ScreenshotCaption": "Telemetry showing sc.exe executing the service\u00a0(tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "2.C.2 ", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing tasklist with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.C.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tasklist with command-line arguments"}, {"ScreenshotName": "CR-2.A.2-10.png", "ScreenshotCaption": "Telemetry showing tasklist.exe executing within the process tree (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed qprocess.exe executing with command-line arguments. [CR5]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.C.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with correct ATT&CK Technique (Process Discovery) and Tactic (Discovery) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.B.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with labels for Reconnaissance and Local process discovery"}], "Footnotes": [" The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}, {"DetectionNote": "The capability enriched qprocess.exe executing as Reconnaissance and Local process discovery as well as the correct ATT&CK Technique (Process Discovery) and Tactic (Discovery). The data was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.C.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with correct ATT&CK Technique (Process Discovery) and Tactic (Discovery) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.B.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe executing with labels for Reconnaissance and Local process discovery"}]}]}]}, {"TechniqueId": "T1015", "TechniqueName": "Accessibility Features", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Detections": [{"DetectionNote": "Telemetry showed creation and file write events for magnify.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.C.1-10.png", "ScreenshotCaption": "Telemetry showing creation and write events for magnify.exe (tainted by a parent PowerShell alert, listed as Owner process)"}]}]}, {"SubStep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated based on a new process masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CR-20.A.1-10.png", "ScreenshotCaption": "Specific Behavior alert for magnify.exe\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}, {"ScreenshotName": "CR-20.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert for magnify.exe, in process tree,\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}]}, {"DetectionNote": "Telemetry showed the execution of magnify.exe. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-20.A.1-10.png", "ScreenshotCaption": "Specific Behavior alert for magnify.exe\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}, {"ScreenshotName": "CR-20.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert for magnify.exe, in process tree,\u00a0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Detections": [{"DetectionNote": "Telemetry showed port 53 command and control traffic.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-1.C.1-10.png", "ScreenshotCaption": "Telemetry showing port 53 command and control traffic"}]}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe opening a connection over port 80. The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-10.png", "ScreenshotCaption": "Enrichment of rundll32.exe making a connection over the \\\"HTTP Port\\\" with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-6.B.1-20.png", "ScreenshotCaption": "Telemetry showing rundll32.exe opening a connection over port 80 (tainted by a parent Injected Shellcode alert, listed as Owner process)"}]}, {"DetectionNote": "The capability enriched rundll32.exe opening a connection to the C2 server over a \\\"HTTP port\\\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-6.B.1-10.png", "ScreenshotCaption": "Enrichment of rundll32.exe making a connection over the \\\"HTTP Port\\\" with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-6.B.1-20.png", "ScreenshotCaption": "Telemetry showing rundll32.exe opening a connection over port 80 (tainted by a parent Injected Shellcode alert, listed as Owner process)"}]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making an outgoing connection on TCP port 443 to 192.168.0.5 (C2 Server). Telemetry also showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain) over port 443. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-100.png", "ScreenshotCaption": "Enrichment of powershell.exe making a connection over a \u201dHTTP Port,\" tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 (C2 Server) over port TCP port 443 (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "The capability enriched powershell.exe as making a connection over a \u201dHTTP Port\u201d. The data was tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) and was tainted by a parent PowerShell alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-100.png", "ScreenshotCaption": "Enrichment of powershell.exe making a connection over a \u201dHTTP Port,\" tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.B.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 (C2 Server) over port TCP port 443 (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for powershell.exe executed as a PowerShell downloader. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port). Data also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-14.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-14.A.1-40.png", "ScreenshotCaption": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection over port 8080. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-14.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-14.A.1-40.png", "ScreenshotCaption": "Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.F.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.1-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}]}, {"DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.F.1-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.1-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.F.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.2-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The data was tainted by a parent Injected Shellcode alert.", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing enriched net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-2.F.2-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.2-100.png", "ScreenshotCaption": "Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}]}]}, {"SubStep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" -domain' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The alert was tainted by a parent Injected Shellcode alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-2.F.3-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.3-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-2.F.3-10.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing net with command-line arguments"}, {"ScreenshotName": "CR-2.F.3-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-2.D.2-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing\u00a0(tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.F.1", "Procedure": "Empire: 'net group \"Domain Admins\" -domain' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Permission Groups Discovery). The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.F.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.F.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.F.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.F.1-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"SubStep": "12.F.2", "Procedure": "Empire: 'net\u00ef\u00bf\u00bdlocalgroup\u00ef\u00bf\u00bdadministrators' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Permission Groups Discovery). The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.F.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.F.2-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-12.F.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-12.F.2-1.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe running as medium integrity as user Debbie then another instance running later as high integrity as user Debbie. The telemetry is tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-3.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as medium integrity as user Debbie"}, {"ScreenshotName": "CR-3.A.1-20.png", "ScreenshotCaption": "Telemetry showing powershell.exe running as high integrity as user Debbie (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Detections": [{"DetectionNote": "Telemetry showed an integrity level change from medium to high for powershell.exe, which is indicative of\u00a0bypass UAC. The telemetry was tainted by a parent Malicious use of PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-14.A.1-11.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing with medium process integrity (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-14.A.1-12.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing with high process integrity (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-14.A.1-13.png", "ScreenshotCaption": "Parent alert generated for malicious use of PowerShell"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.D.1", "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "Detections": [{"DetectionNote": "Telemetry showed a deletion event for old.rar via powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.D.1-10.png", "ScreenshotCaption": "Telemetry showing a deletion event for old.rar via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)"}]}]}, {"SubStep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Detections": [{"DetectionNote": "Telemetry showed a deletion event for recycler.exe via powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-19.D.2-10.png", "ScreenshotCaption": "Telemetry showing a deletion event for recycler.exe via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)"}]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for injected shellcode by a compromised legitimate process (rundll32.exe). The alert was tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection) and was tainted by parent alert on rundll32.exe injection.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-200.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-101.png", "ScreenshotCaption": "Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)"}]}, {"DetectionNote": "A Specific Behavior alert was generated for rundll32.exe launching a module in a temporary folder and injecting shell code into a victim process. The alert was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-200.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-101.png", "ScreenshotCaption": "Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)"}]}, {"DetectionNote": "Telemetry within the rundll32.exe injection alert also showed full command-line arguments of rundll32.exe executing update.dat. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious. [CR4]", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-200.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-101.png", "ScreenshotCaption": "Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)"}, {"ScreenshotName": "CR-1.A.1-30.png", "ScreenshotCaption": "Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability and counted as a separate detection."]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though an alert was generated for malicious code injection into PowerShell. Telemetry also showed that bypassuactoken.x64.dll was loaded.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "CR-3.C.1-10.png", "ScreenshotCaption": "Alert for malicious code injection into PowerShell (does not count as a detection)"}, {"ScreenshotName": "CR-3.A.1-10.png", "ScreenshotCaption": "Telemetry showing the bypassuactoken.x64.dll was loaded (does not count as a detection)"}]}]}, {"SubStep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe associated with both users Debbie and George, indicating user context change via token manipulation. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-5.B.1-10.png", "ScreenshotCaption": "Telemetry within the process tree showing cmd.exe associated with users Debbie and George (tainted by a parent alert on explorer.exe)"}]}]}]}, {"TechniqueId": "T1222", "TechniqueName": "File and Directory Permissions Modification", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Detections": [{"DetectionNote": "A General Behavior alert was generated for takeown.exe performing activity related to swapping an accessibility features binary. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.B.1-10.png", "ScreenshotCaption": "General Behavior alert for takeown.exe performing activity related to swapping an accessibility features binary (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed takeown.exe executing with command-line arguments.[CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-17.B.1-10.png", "ScreenshotCaption": "General Behavior alert for takeown.exe performing activity related to swapping an accessibility features binary (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"SubStep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Detections": [{"DetectionNote": "Telemetry showed icacls.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-17.B.2-10.png", "ScreenshotCaption": "Telemetry showing icacls.exe executing\u00a0 with command-line arguments (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe rewriting autoupdate.bat to the user Debbie's Startup folder. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.B.1-10.png", "ScreenshotCaption": "Telemetry showing rename file event for autoupdate.bat"}, {"ScreenshotName": "CR-1.B.1-100.png", "ScreenshotCaption": "Process tree showing the cmd.exe associated with the autoupdate.bat file event (tainted by parent alert on explorer.exe)"}]}]}, {"SubStep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe executing autoupdate.bat from the Startup folder. The telemetry was tainted by a parent Injected Shellcode alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-10.A.1-100.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing autoupdate.bat from the Startup folder (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-10.A.1-10.png", "ScreenshotCaption": "Parent alert for Injected shellcode into rundll32.exe"}]}]}]}, {"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe launching pdfhelper.cmd. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-1.A.1-20.png", "ScreenshotCaption": "Telemetry showing cmd.exe launching pdfhelper.cmd (tainted by parent alert on explorer.exe)"}]}]}, {"SubStep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for powershell.exe, labeled with Command and Control as well as Malicious use of PowerShell. The alert was tagged as a Obfuscated PowerShell payload and mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CR-11.A.1-14.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe, labeled with Command and Control and Malicious use of PowerShell"}, {"ScreenshotName": "CR-11.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert tagged as obfuscated PowerShell payload and downloader mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)"}, {"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.A.1-12.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed powershell.exe execution, including decoded full command-line arguments, as well as wscript.exe executing autoupdate.vbs.\u00a0The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-11.A.1-14.png", "ScreenshotCaption": "Specific Behavior alert for powershell.exe, labeled with Command and Control and Malicious use of PowerShell"}, {"ScreenshotName": "CR-11.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert tagged as obfuscated PowerShell payload and downloader mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)"}, {"ScreenshotName": "CR-11.A.1-13.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-11.A.1-12.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent PowerShell alert)"}]}]}, {"SubStep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for a malicious command, which was identified as the Invoke-WinEnum function. The alert also identified the PowerShell commands as suspicious and were tagged with the correct ATT&CK Technique (PowerShell) and Tactic (Execution). The alert was tainted by a parent PowerShell alert.", "DetectionType": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.E.1-100.png", "ScreenshotCaption": "Specific Behavior alert for Malicious use of PowerShell (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.E.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a PowerShell Malicious command, identified as the Invoke-WinEnum function"}, {"ScreenshotName": "CR-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the temp write of the psm1 script module (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed the PowerShell Script module (.psm1) being written to the temp folder. The telemetry was tainted by a parent PowerShell alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-12.E.1-100.png", "ScreenshotCaption": "Specific Behavior alert for Malicious use of PowerShell (tainted by a parent PowerShell alert)"}, {"ScreenshotName": "CR-12.E.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a PowerShell Malicious command, identified as the Invoke-WinEnum function"}, {"ScreenshotName": "CR-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the temp write of the psm1 script module (tainted by a parent PowerShell alert)"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" -domain' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe executing as part of a suspicious execution chain related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent Injected Shellcode alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-4.A.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, {"ScreenshotName": "CR-4.A.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-4.A.1-101.png", "ScreenshotCaption": "Telemetry showing net.exe executing with command-line arguments"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-4.A.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, {"ScreenshotName": "CR-4.A.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}, {"ScreenshotName": "CR-4.A.1-101.png", "ScreenshotCaption": "Telemetry showing net.exe executing with command-line arguments"}]}]}, {"SubStep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" -domain' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe executing as part of a suspicious execution chain related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery). The alert was tainted by a parent Injected Shellcode alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-4.A.1-101.png", "ScreenshotCaption": "Telemetry showing net.exe executing with command-line arguments"}, {"ScreenshotName": "CR-4.A.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, {"ScreenshotName": "CR-4.A.2-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-4.A.1-101.png", "ScreenshotCaption": "Telemetry showing net.exe executing with command-line arguments"}, {"ScreenshotName": "CR-4.A.2-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing as part of a suspicious execution chain"}, {"ScreenshotName": "CR-4.A.2-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)"}]}]}, {"SubStep": "13.A.1", "Procedure": "Empire: 'net group \"Domain Computers\" -domain' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery). The alert was tainted by a parent PowerShell alert.", "DetectionType": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-13.A.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Remote System Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-13.A.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}]}, {"DetectionNote": "Telemetry showed net.exe executing with command-line arguments. [CR3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CR-13.A.1-100.png", "ScreenshotCaption": "General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Remote System Discovery) and Technique (Discovery)"}, {"ScreenshotName": "CR-13.A.1-10.png", "ScreenshotCaption": "Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)"}], "Footnotes": [" For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for svchost.exe loading Mimikatz and accessing lsass (an audited system resource). The alert was also tagged with the correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CR-5.A.1-11.png", "ScreenshotCaption": "Specific Behavior alert with correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection) with details about svchost.exe accessing lsass"}]}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Detections": [{"DetectionNote": "Telemetry showed svchost.exe injecting into lsass.exe. The telemetry was tainted by the parent \u201cinjected (svchost.exe > lsass.exe)\u201d alert. The hashdumpx64.dll was also seen loaded as a floating executable code.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "CR-5.A.2-20.png", "ScreenshotCaption": "Telemetry showing svchost.exe process injection into lsass.exe (tainted by a parent injection alert)"}, {"ScreenshotName": "CR-5.A.2-10.png", "ScreenshotCaption": "Parent alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection"}, {"ScreenshotName": "CR-5.A.2-11.png", "ScreenshotCaption": "Telemetry within alert showing loaded hashdumpx64.dll as floating executable code"}]}]}]}]}