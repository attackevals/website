{"PublicRelease": "\u00a92019 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 18-4019", "Techniques": [{"TechniqueId": "T1126", "TechniqueName": "Network Share Connection Removal", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated indicating that a connected network share was removed.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with net.exe and command-line arguments"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for removing connected network share"}]}, {"DetectionNote": "Telemetry showed a process tree containing net.exe and command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with net.exe and command-line arguments"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for removing connected network share"}]}]}]}, {"TechniqueId": "T1026", "TechniqueName": "Multiband Communication", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Detections": [{"DetectionNote": "Telemetry showed separate network connections over port TCP port 80 and UDP port 53, which could indicate multiband communication.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing network connection over UDP port 53"}, {"ScreenshotName": "CB-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing network connection over TCP port 80"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Detections": [{"DetectionNote": "Telemetry showed modload events importing dynamic libraries usually used for HTTP and SSL communication (e.g. winhttp.dll), followed by a CRL check to a CA, indicating that HTTPS was likely used.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-11.B.1-2.png", "ScreenshotCaption": "Telemetry showing modloads and certificate check"}]}]}]}, {"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing netstat.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-4.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments"}, {"ScreenshotName": "CB-4.C.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)"}]}, {"DetectionNote": "The capability enriched netstat.exe with the correct ATT&CK technique (System Network Connections Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-4.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments"}, {"ScreenshotName": "CB-4.C.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)"}]}]}, {"SubStep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Detections": [{"DetectionNote": "Telemetry within the process tree showed netstat.exe executing with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.E.1.12-2.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments"}, {"ScreenshotName": "CB-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)"}]}, {"DetectionNote": "The capability enriched netstat.exe with the correct ATT&CK Technique (System Network Connections Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-12.E.1.12-2.png", "ScreenshotCaption": "Telemetry from process tree showing netstat.exe with command-line arguments"}, {"ScreenshotName": "CB-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)"}]}]}, {"SubStep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}]}, {"DetectionNote": "The vendor demonstrated to MITRE that the capability can provide telemetry of net.exe, but no screenshot was captured for this procedure.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}]}]}, {"SubStep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed a process tree containing netstat.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-13.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with netstat.exe and command-line arguments"}, {"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe data with the correct ATT&CK Technique (T1049 - System Network Connections Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-13.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with netstat.exe and command-line arguments"}, {"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)"}]}]}]}, {"TechniqueId": "T1132", "TechniqueName": "Data Encoding", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing ipconfig.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments"}, {"ScreenshotName": "CB-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)"}]}, {"DetectionNote": "The capability enriched ipconfig.exe with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments"}, {"ScreenshotName": "CB-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)"}]}]}, {"SubStep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing arp.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing arp.exe with command-line arguments"}, {"ScreenshotName": "CB-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)"}]}, {"DetectionNote": "The capability enriched arp.exe with a related ATT&CK Technique (T1018 - Remote System Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing arp.exe with command-line arguments"}, {"ScreenshotName": "CB-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)"}]}]}, {"SubStep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing netsh.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-4.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing netsh.exe with command-line arguments"}, {"ScreenshotName": "CB-4.B.1-2.png", "ScreenshotCaption": "Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon"}]}, {"DetectionNote": "The capability enriched netsh.exe with a related ATT&CK technique (T1063 - Security Software Discovery) and a tag for Potential Windows Firewall Rule Recon.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-4.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing netsh.exe with command-line arguments"}, {"ScreenshotName": "CB-4.B.1-2.png", "ScreenshotCaption": "Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon"}]}]}, {"SubStep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing route.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing route.exe with command-line arguments"}]}]}, {"SubStep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing ipconfig.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments"}, {"ScreenshotName": "CB-12.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)"}]}, {"DetectionNote": "The capability enriched ipconfig.exe with the correct ATT&CK Technique (T1049 - System Network Configuration Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-12.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing ipconfig.exe with command-line arguments"}, {"ScreenshotName": "CB-12.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)"}]}]}, {"SubStep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1039", "TechniqueName": "Data from Network Shared Drive", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[CB90]", "DetectionType": "None", "Footnotes": ["Telemetry was available for the write file of the .vsdx file into the Recycle Bin, but no data was available that indicated it came from a network shared drive."]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing systeminfo.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.E.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing systeminfo.exe"}, {"ScreenshotName": "CB-2.E.1-2.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)"}]}, {"DetectionNote": "The capability enriched systeminfo.exe with the correct ATT&CK Technique (System Information Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.E.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing systeminfo.exe"}, {"ScreenshotName": "CB-2.E.1-2.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)"}]}]}, {"SubStep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.E.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.E.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (System Information Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.E.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.E.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)"}]}]}, {"SubStep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though modloads showed the thumbnail com object masquerading followed by a modload of dwmapi.dll (Microsoft Desktop Windows Manager API) and then a crossprocess (open process) to the target application, which could be indicative of screen capture behavior.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "CB-8.D.1-1.png", "ScreenshotCaption": "Telemetry showing modloads and crossprocess events (does not count as a detection)"}]}]}]}, {"TechniqueId": "T1010", "TechniqueName": "Application Window Discovery", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated that was mapped to correct ATT&CK Technique (Process Injection).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing open handles and thread injection into cmd.exe"}, {"ScreenshotName": "CB-3.C.1-3.png", "ScreenshotCaption": "Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe"}, {"ScreenshotName": "CB-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)"}]}, {"DetectionNote": "Telemetry showed \"crossproc\" events indicative of Process Injection into cmd.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing open handles and thread injection into cmd.exe"}, {"ScreenshotName": "CB-3.C.1-3.png", "ScreenshotCaption": "Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe"}, {"ScreenshotName": "CB-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)"}]}]}, {"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Detections": [{"DetectionNote": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-5.A.1-1.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}]}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated showing the correct ATT&CK Technique (Credential Dumping).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-5.A.2-2.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe"}, {"ScreenshotName": "CB-5.A.2-4.png", "ScreenshotCaption": "Specific Behavior alert showing correct ATT&CK Technique (Process Injection)"}, {"ScreenshotName": "CB-5.A.2-1.png", "ScreenshotCaption": "Alert showing correct ATT&CK Technique (Process Injection) within process tree"}]}, {"DetectionNote": "Telemetry showed a new thread and open handle into lsass.exe, which is indicative of process injection for credential dumping.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-5.A.2-2.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe"}, {"ScreenshotName": "CB-5.A.2-4.png", "ScreenshotCaption": "Specific Behavior alert showing correct ATT&CK Technique (Process Injection)"}, {"ScreenshotName": "CB-5.A.2-1.png", "ScreenshotCaption": "Alert showing correct ATT&CK Technique (Process Injection) within process tree"}]}]}, {"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Detections": [{"DetectionNote": "Telemetry showed a cross-process \"open handle\" event into explorer.exe, which could be indicative of process injection.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-8.D.1-1.png", "ScreenshotCaption": "Telemetry showing \\\"open handle\\\" crossproc on explorer.exe by the process"}]}]}]}, {"TechniqueId": "T1061", "TechniqueName": "Graphical User Interface", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Detections": [{"DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"}]}]}]}, {"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed a connection to 10.0.0.5 (Conficker) over TCP port 3389 as well as rdpclip.exe executing.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)"}, {"ScreenshotName": "CB-6.C.1-3.png", "ScreenshotCaption": "Telemetry showing rdpclip.exe running"}, {"ScreenshotName": "CB-6.C.1-1.png", "ScreenshotCaption": "Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)"}]}, {"DetectionNote": "The capability enriched the rdpclip.exe events with the correct ATT&CK Technique (Remote Desktop Protocol).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)"}, {"ScreenshotName": "CB-6.C.1-3.png", "ScreenshotCaption": "Telemetry showing rdpclip.exe running"}, {"ScreenshotName": "CB-6.C.1-1.png", "ScreenshotCaption": "Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)"}]}]}, {"SubStep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "Telemetry within the process tree showed rdpclip.exe execution by the user Jesse on the destination system of the RDP connection.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-10.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, {"ScreenshotName": "CB-10.B.1-2.png", "ScreenshotCaption": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)"}]}, {"DetectionNote": "The capability enriched rdpclip.exe with the correct ATT&CK Technique (Remote Desktop Protocol).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-10.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, {"ScreenshotName": "CB-10.B.1-2.png", "ScreenshotCaption": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)"}]}]}, {"SubStep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \"\\\\conficker\\wormshare\"' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-8.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing dir with command-line arguments"}, {"ScreenshotName": "CB-8.C.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)"}]}, {"DetectionNote": "The capability enriched cmd.exe with the correct ATT&CK Technique (T1083 - File and Directory Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-8.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing dir with command-line arguments"}, {"ScreenshotName": "CB-8.C.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)"}]}]}, {"SubStep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing tree.com with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-8.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing tree.com with command-line arguments"}, {"ScreenshotName": "CB-8.C.1-2.png", "ScreenshotCaption": "Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)"}]}, {"DetectionNote": "The capability enriched tree.com with the correct ATT&CK Technique (T1083 - File and Directory Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-8.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing tree.com with command-line arguments"}, {"ScreenshotName": "CB-8.C.1-2.png", "ScreenshotCaption": "Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)"}]}]}, {"SubStep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "Telemetry showed file modification events indicating updater.dll being created and written to disk.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-7.B.1-1.png", "ScreenshotCaption": "Telemetry showing updater.dll written to disk"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Detections": [{"DetectionNote": "The vendor demonstrated to MITRE that the capability can provide telemetry of network connections and file modifications indicating a Remote File Copy, but no screenshot was captured for this procedure.", "DetectionType": "Telemetry"}]}, {"SubStep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed filemods showing the creation and writing to autoupdate.vbs.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing creation and write to autoupdate.vbs"}]}]}, {"SubStep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed filemods showing the creation and writing to update.vbs on remote host 10.0.0.4 (Creeper).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.G.1-1.png", "ScreenshotCaption": "Telemetry showing remote creation and write to update.vbs"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed the creation of recycler.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing filemod (file modification) creation of recycler.exe"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Detections": [{"DetectionNote": "Telemetry showed Registry modification events related to the creation of the user account Jesse.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing Registry modifications for new user Jesse"}, {"ScreenshotName": "CB-7.A.1-4.png", "ScreenshotCaption": "Enrichment of lsass.exe with tag \\\"Create Accounts using GUI\\\""}]}, {"DetectionNote": "The capability enriched lsass.exe with the tag \\\"Create Accounts using GUI\\\". [CB1]", "DetectionType": "Enrichment", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing Registry modifications for new user Jesse"}, {"ScreenshotName": "CB-7.A.1-4.png", "ScreenshotCaption": "Enrichment of lsass.exe with tag \\\"Create Accounts using GUI\\\""}], "Footnotes": [" The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started."]}]}]}, {"TechniqueId": "T1135", "TechniqueName": "Network Share Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Detections": [{"DetectionNote": "Telemetry showed a process tree for ftp.exe being executed with command-line arguments including ftp.txt.", "DetectionType": "Telemetry"}, {"DetectionNote": "The capability enriched ftp.exe with the correct ATT&CK Technique (Exfil Over Alternate Protocol).", "DetectionType": "Enrichment"}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated with a severity score of 60/100 and was correctly mapped to correct ATT&CK Technique (T1074 - Data Staged).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing creation of the .vsdx file in the Recycle Bin"}, {"ScreenshotName": "CB-18.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)"}]}, {"DetectionNote": "Telemetry showed filemod events for the creation and write the .vsdx in the Recycle Bin.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing creation of the .vsdx file in the Recycle Bin"}, {"ScreenshotName": "CB-18.B.1-2.png", "ScreenshotCaption": "Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)"}]}]}]}, {"TechniqueId": "T1201", "TechniqueName": "Password Policy Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing sc.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.A-ALL.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe with command-line arguments"}, {"ScreenshotName": "CB-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)"}]}, {"DetectionNote": "The capability enriched sc.exe with the correct ATT&CK Technique (System Service Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.A-ALL.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe with command-line arguments"}, {"ScreenshotName": "CB-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)"}]}]}, {"SubStep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.D.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.D.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (System Service Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.D.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.D.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)"}]}]}, {"SubStep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.A.D.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}]}]}, {"SubStep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to remotely query services on Creeper. Telemetry also showed module loads and a network connection to Creeper (10.0.0.4).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution for the service query"}, {"ScreenshotName": "CB-16.H.1-2.png", "ScreenshotCaption": "Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)"}]}, {"DetectionNote": "The capability enriched the sc.exe execution with the correct ATT&CK Technique (System Service Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-16.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution for the service query"}, {"ScreenshotName": "CB-16.H.1-2.png", "ScreenshotCaption": "Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)"}]}]}, {"SubStep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to query the AdobeUpdater service on Creeper.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.J.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)"}]}, {"DetectionNote": "The capability enriched sc.exe execution with the correct ATT&CK Technique (System Service Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-16.J.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Detections": [{"DetectionNote": "Telemetry within the process tree showed reg.exe executing with command-line arguments to check if terminal services were enabled.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-17.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Detections": [{"DetectionNote": "A General Behavior alert was generated indicating that the user Debbie executed Resume Viewer.exe. This alert had a severity score of 51/100 and was based upon \"Newly Executed Applications\".", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CB-1.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing Resume Viewer.exe execution sequence"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application"}]}, {"DetectionNote": "Telemetry within the process tree showed Resume Viewer.exe running along with its children.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-1.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing Resume Viewer.exe execution sequence"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing echo with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing echo with command-line arguments"}]}]}, {"SubStep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing whoami.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing whoami.exe with command-line arguments"}, {"ScreenshotName": "CB-12.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}]}, {"DetectionNote": "The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-12.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing whoami.exe with command-line arguments"}, {"ScreenshotName": "CB-12.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}]}]}, {"SubStep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry within the process tree showed magnify.exe executing whoami.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree with telemetry showing whoami.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe\u00a0with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}]}, {"DetectionNote": "The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree with telemetry showing whoami.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Enrichment of whoami.exe\u00a0with correct ATT&CK Technique (T1033 - System Owner/User Discovery)"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing reg.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-2.H.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}]}, {"DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.H.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-2.H.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}]}]}, {"SubStep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-6.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-6.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}]}, {"DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-6.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-6.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}]}]}, {"SubStep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "13.C.1", "Procedure": "Empire:\u00ef\u00bf\u00bd'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed a process tree containing reg.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-13.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with reg.exe and command-line arguments"}, {"ScreenshotName": "CB-13.C.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)"}]}, {"DetectionNote": "The capability enriched reg.exe data with the correct ATT&CK Technique (Query Registry).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-13.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with reg.exe and command-line arguments"}, {"ScreenshotName": "CB-13.C.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry within the process tree showed reg.exe executing with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-17.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}]}, {"DetectionNote": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-17.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing reg.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "Specific Behavior alerts titled \"Windows Admin Shares - Lateral Movement\" were generated for credential accesses specifically targeting admin shares.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$"}, {"ScreenshotName": "CB-16.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for of the 4 different net.exe logon attempts"}]}, {"DetectionNote": "Telemetry showed a process tree containing repeated logon attempts via net.exe targeting ADMIN$.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$"}, {"ScreenshotName": "CB-16.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for of the 4 different net.exe logon attempts"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "Specific Behavior alerts were generated mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}]}, {"DetectionNote": "Telemetry showed a process tree containing repeated logon attempts via net.exe targeting ADMIN$, eventually resulting in a successful logon.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Specific Behavior alerts were generated mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with successful net.exe logon targeting C$"}, {"ScreenshotName": "CB-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}]}, {"DetectionNote": "Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments \u00a0targeting C$ using valid account credentials.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with successful net.exe logon targeting C$"}, {"ScreenshotName": "CB-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}]}]}]}, {"TechniqueId": "T1110", "TechniqueName": "Brute Force", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00ef\u00bf\u00bdKmitnick, Bob, and Frieda", "Detections": [{"DetectionNote": "Telemetry showed a process tree containing repeated logon attempts via net.exe and command-line arguments indicative of password spraying.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with four different net.exe logon attempts"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Enrichment of the individual net.exe logon attempts with tag \\\"Credential Access using Admin Shares - Failed Attempts\\\""}]}, {"DetectionNote": "The capability enriched individual net.exe events with tagging titled \\\"Credential Access using Admin Shares - Failed Attempts\\\". [CB8]", "DetectionType": "Enrichment", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with four different net.exe logon attempts"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Enrichment of the individual net.exe logon attempts with tag \\\"Credential Access using Admin Shares - Failed Attempts\\\""}], "Footnotes": ["The capability was modified after the start of the evaluation enabling enrichment to appear, so the detection is identified as a configuration change."]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Detections": [{"DetectionNote": "Telemetry showed a process tree containing repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts, including a success"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}]}, {"DetectionNote": "The capability enriched individual net.exe events with tagging titled \\\"Credential Access using Admin Shares - Failed Attempts\\\" for failures as well as a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons. [CB8]", "DetectionType": "Enrichment", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts, including a success"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)"}], "Footnotes": ["The capability was modified after the start of the evaluation enabling enrichment to appear, so the detection is identified as a configuration change."]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for sc.exe execution to create the AdobeUpdater service with the correct ATT&CK Technique (New Service).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-16.I.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK"}]}, {"DetectionNote": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to create a new AdobeUpdater service containing a binPath pointed to cmd.exe with arguments to execute update.vbs.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.I.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service"}, {"ScreenshotName": "CB-16.H.1-3.png", "ScreenshotCaption": "Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "Telemetry showed a process tree with cmd.exe execution and associated user context change.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob"}, {"ScreenshotName": "CB-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick"}, {"ScreenshotName": "CB-16.F.1-3.png", "ScreenshotCaption": "Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)"}]}, {"DetectionNote": "The capability enriched cmd.exe event data with the correct ATT&CK Technique (T1059 - Command-Line Interface).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob"}, {"ScreenshotName": "CB-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick"}, {"ScreenshotName": "CB-16.F.1-3.png", "ScreenshotCaption": "Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed network connections over TCP port 80 as well as a modload showing winhttp.dll was loaded, which an analyst could use to determine HTTP was used.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-6.B.1-8.png", "ScreenshotCaption": "Telemetry showing modloads showing winhttp.dll loaded"}, {"ScreenshotName": "CB-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing network connection over TCP port 80 to the C2 domain (could be used in conjunction with modload to determine protocol)"}]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed modload events importing dynamic libraries usually used for HTTP and SSL communication (e.g. winhttp.dll), followed by a CRL check to a CA, indicating that HTTPS was likely used.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-11.B.1-2.png", "ScreenshotCaption": "Telemetry showing modloads and certificate check"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1053", "TechniqueName": "Scheduled Task", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated mapped to the correct ATT&CK Technique (T1053 - Scheduled Task).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree containing schtasks.exe and full command a task creation"}, {"ScreenshotName": "CB-7.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)"}]}, {"DetectionNote": "Telemetry showed the process tree containing schtasks.exe as well as the full command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing process tree containing schtasks.exe and full command a task creation"}, {"ScreenshotName": "CB-7.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)"}]}]}, {"SubStep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Detections": [{"DetectionNote": "Telemetry within the process tree showed rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\\"-k netsvcs -p -s Schedule\\\".", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-10.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments"}, {"ScreenshotName": "CB-10.A.2-2.png", "ScreenshotCaption": "Telemetry from process tree showing updater.dll executed by rundll32.exe"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive.", "DetectionType": "Telemetry"}, {"DetectionNote": "The capability enriched recycler.exe with the correct ATT&CK Technique (1022 - Data Encrypted).", "DetectionType": "Enrichment"}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running.", "DetectionType": "Telemetry"}, {"DetectionNote": "The capability enriched recycler.exe with the correct ATT&CK Technique (1002 - Data Compressed).", "DetectionType": "Enrichment"}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[CB2]", "DetectionType": "None", "Footnotes": [" The vendor indicated that CB Defense sees applicable API calls, but that product was not included in the evaluation."]}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Detections": [{"DetectionNote": "Telemetry showed modloads associated with the execution of a keylogger.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing modloads associated with keylogger"}, {"ScreenshotName": "CB-15.A.1-3.png", "ScreenshotCaption": "Enrichment of data with tag \\\"PowerShell Input Capture -keylogger\\\""}]}, {"DetectionNote": "The capability enriched the events with a tag titled \\\"PowerShell Input Capture -keylogger\\\" based on known modloads that could be potentially abused to provide keylogger functionality.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing modloads associated with keylogger"}, {"ScreenshotName": "CB-15.A.1-3.png", "ScreenshotCaption": "Enrichment of data with tag \\\"PowerShell Input Capture -keylogger\\\""}]}]}]}, {"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Account Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}]}]}, {"SubStep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.G.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Account Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.G.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)"}]}]}, {"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Detections": [{"DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"}]}]}, {"SubStep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-12.G.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}]}]}, {"SubStep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}, {"ScreenshotName": "CB-12.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}]}, {"DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)"}, {"ScreenshotName": "CB-12.G.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry within the process trees showed execution of sc.exe with command-line arguments to create the AdobeUpdater service with binPath pointed to cmd.exe with arguments to execute update.vbs and a suspicious service description, which indicates masquerading.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.I.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution setting the AdobeUpdater service description"}, {"ScreenshotName": "CB-16.I.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "Telemetry showed the creation of recycler.exe. Binary metadata on recycler.exe indicated it was masquerading and had a digital signature and file metadata that matched the WinRAR utility.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing filemod creation of recycler.exe"}, {"ScreenshotName": "CB-19.A.1-2.png", "ScreenshotCaption": "Binary metadata showing recycler.exe is WinRAR.exe based on digital signature and file version information"}]}]}, {"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated on execution of recycler.exe indicating it was WinRAR and was masquerading as a renamed process.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR"}, {"ScreenshotName": "CB-19.B.1-5.png", "ScreenshotCaption": "Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process"}]}, {"DetectionNote": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR"}, {"ScreenshotName": "CB-19.B.1-5.png", "ScreenshotCaption": "Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Detections": [{"DetectionNote": "Telemetry within the process tree showed rdpclip.exe execution by the user Jesse on the destination system of the RDP connection.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-10.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, {"ScreenshotName": "CB-10.B.1-2.png", "ScreenshotCaption": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)"}]}, {"DetectionNote": "The capability enriched rdpclip.exe with the correct ATT&CK Technique (Remote Desktop Protocol).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-10.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rdpclip.exe running as user Jesse"}, {"ScreenshotName": "CB-10.B.1-2.png", "ScreenshotCaption": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed a process tree containing a successful logon via net.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with five different net.exe logon attempts, including a success"}, {"ScreenshotName": "CB-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon via net.exe"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments using valid account credentials.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with logon using valid account credentials"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to start the AdobeUpdater service on Creeper.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-16.L.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing sc.exe execution to start the AdobeUpdater service on Creeper"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "2.C.2 ", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing tasklist.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.C.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CB-2.C.2-2.png", "ScreenshotCaption": "Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)"}]}, {"DetectionNote": "The capability enriched tasklist.exe with the correct ATT&CK Technique (T1057 - Process Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.C.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CB-2.C.2-2.png", "ScreenshotCaption": "Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)"}]}]}, {"SubStep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing qprocess.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CB-12.C.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)"}]}, {"DetectionNote": "The capability enriched qprocess.exe with the correct ATT&CK Technique (Process Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-12.C.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CB-12.C.1-2.png", "ScreenshotCaption": "Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)"}]}]}]}, {"TechniqueId": "T1015", "TechniqueName": "Accessibility Features", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for powershell.exe with a severity score of 51/100 when magnify.exe was replaced. The alert was also mapped to the correct ATT&CK Technique (T1015 - Accessibility Features).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing creation and file write replacing magnify.exe in the system directory"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)"}]}, {"DetectionNote": "Telemetry showed filemod events overwriting magnify.exe in the system directory.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing creation and file write replacing magnify.exe in the system directory"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)"}]}]}, {"SubStep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated named \"Execution of cmd from non-standard path\" with a 60/100 severity score.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree telemetry showing magnify.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores"}]}, {"DetectionNote": "A General Behavior alert was generated named \"Suspicious renamed cmd process\" with a 72/100 severity score.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree telemetry showing magnify.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores"}]}, {"DetectionNote": "A Specific Behavior alert was generated on execution of magnify.exe named \"Suspicious screen magnifier\u00a0process\" with a 76/100 severity score.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree telemetry showing magnify.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores"}]}, {"DetectionNote": "Telemetry within the process tree that showed magnify.exe executing from utilman.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-20.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree telemetry showing magnify.exe execution"}, {"ScreenshotName": "CB-20.B.1-2.png", "ScreenshotCaption": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Detections": [{"DetectionNote": "Telemetry showed a network connection over UDP port 53.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing network connection over UDP port 53"}]}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Detections": [{"DetectionNote": "Telemetry showed network connections over TCP port 80 to 192.168.0.4 (C2 server).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "CB-6.B.1-4.png", "ScreenshotCaption": "Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)"}]}, {"DetectionNote": "The capability enriched the network connections from rundll32.exe with the correct ATT&CK Technique (T1043 - Commonly Used Port).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "CB-6.B.1-4.png", "ScreenshotCaption": "Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)"}]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Detections": [{"DetectionNote": "Telemetry showed network connections, including over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)"}, {"ScreenshotName": "CB-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing network connections, including over TCP port 443"}]}, {"DetectionNote": "The capability enriched backgroundtaskhost.exe and powershell.exe with the correct ATT&CK Technique (T1043 - Commonly Used Port).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)"}, {"ScreenshotName": "CB-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing network connections, including over TCP port 443"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Detections": [{"DetectionNote": "Telemetry showed network connection to 192.168.0.5 (C2 server) over TCP port 8080.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-14.A.1-3.png", "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over TCP port 8080"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.F.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.F.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}]}]}, {"SubStep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.2-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.2-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}]}]}, {"SubStep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-2.F.3-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.3-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.3-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-2.F.3-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-2.F.3-2.png", "ScreenshotCaption": "Enrichment of net.exe with tag Administrator Enumeration"}, {"ScreenshotName": "CB-2.F.3-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)"}]}]}, {"SubStep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.F.1", "Procedure": "Empire: 'net group \"Domain Admins\" -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.F.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-12.F.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}]}]}, {"SubStep": "12.F.2", "Procedure": "Empire: 'net\u00ef\u00bf\u00bdlocalgroup\u00ef\u00bf\u00bdadministrators' via PowerShell", "Detections": [{"DetectionNote": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}, {"ScreenshotName": "CB-12.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}]}, {"DetectionNote": "The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-12.F.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)"}, {"ScreenshotName": "CB-12.F.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.D.1", "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "Detections": [{"DetectionNote": "Telemetry showed the deletion of old.rar.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing filemod (file modification) deletion of old.rar"}]}]}, {"SubStep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Detections": [{"DetectionNote": "Telemetry showed the deletion of recycler.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing filemod (file modification) deletion of recycler.exe"}]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "Telemetry within the process tree showed the Resume Viewer.exe execution sequence and rundll32.exe executing.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-1.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)"}]}, {"DetectionNote": "The capability enriched the rundll32.exe execution with the correct ATT&CK Technique (T1085, which corresponds to the Rundll32 Technique).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-1.A.1-2.png", "ScreenshotCaption": "Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)"}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Detections": [{"DetectionNote": "Telemetry showed svchost.exe, with the seclogon command-line argument, performing activity related to token manipulation.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-3.A.1-6.png", "ScreenshotCaption": "Telemetry showing svchost.exe command line arguments, specifically seclogon"}, {"ScreenshotName": "CB-3.A.1-5.png", "ScreenshotCaption": "Telemetry showing svchost.exe activity related to token manipulation"}]}]}, {"SubStep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Detections": [{"DetectionNote": "Telemetry showed a change in user execution context from Debbie to George between parent and child processes, which is indicative of token manipulation.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-5.B.1-2.png", "ScreenshotCaption": "Telemetry showing parent cmd.exe process running under user context Debbie"}, {"ScreenshotName": "CB-5.B.1-3.png", "ScreenshotCaption": "Telemetry showing child cmd.exe process running under user context George"}]}]}]}, {"TechniqueId": "T1222", "TechniqueName": "File and Directory Permissions Modification", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Detections": [{"DetectionNote": "Telemetry within the process tree showed execution of takeown.exe with command-line arguments on magnify.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-17.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of takeown.exe execution with tag \\\"Permission modifications\\\""}]}, {"DetectionNote": "The capability enriched the execution of takeown.exe with \\\"Permission modifications\\\".[CB1]", "DetectionType": "Enrichment", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-17.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of takeown.exe execution with tag \\\"Permission modifications\\\""}], "Footnotes": [" The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started."]}]}, {"SubStep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Detections": [{"DetectionNote": "Telemetry within the process tree showed execution of icacls.exe with command-line arguments on magnify.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-17.B.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of icacls.exe execution with tag \\\"Permission modifications\\\""}]}, {"DetectionNote": "The capability enriched the execution of icacls.exe with \\\"Permission modifications\\\".[CB1]", "DetectionType": "Enrichment", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "CB-17.B.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CB-17.A.1-2.png", "ScreenshotCaption": "Enrichment of icacls.exe execution with tag \\\"Permission modifications\\\""}], "Footnotes": [" The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started."]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Detections": [{"DetectionNote": "Telemetry showed filemods indicating the creation and file write of autoupdate.bat to the Startup folder.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing filemods indicating update.bat was written to the Startup folder"}, {"ScreenshotName": "CB-1.B.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)"}]}, {"DetectionNote": "The capability enriched cmd.exe with the correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing filemods indicating update.bat was written to the Startup folder"}, {"ScreenshotName": "CB-1.B.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)"}]}]}, {"SubStep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing autoupdate.bat from the Startup folder.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-10.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing cmd.exe executing autoupdate.bat from Startup folder"}]}]}]}, {"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing the pdfhelper.cmd script.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-1.A.1-3.png", "ScreenshotCaption": "Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)"}]}, {"DetectionNote": "The capability enriched the cmd.exe execution with the correct ATT&CK Technique (T1064 - Scripting).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-1.A.1-3.png", "ScreenshotCaption": "Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script"}, {"ScreenshotName": "CB-1.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)"}]}]}, {"SubStep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Detections": [{"DetectionNote": "A Specific Behavior Alert was generated indicating that powershell.exe was a suspicious child process of wscript.exe.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)"}, {"ScreenshotName": "CB-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing process tree of script execution"}, {"ScreenshotName": "CB-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for Powershell scripting"}]}, {"DetectionNote": "A Specific Behavior alert was generated indicating that powershell.exe was executed with encoded command-line arguments.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)"}, {"ScreenshotName": "CB-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing process tree of script execution"}, {"ScreenshotName": "CB-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for Powershell scripting"}]}, {"DetectionNote": "Telemetry of a process tree showed powershell.exe execution, including full command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)"}, {"ScreenshotName": "CB-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing process tree of script execution"}, {"ScreenshotName": "CB-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for Powershell scripting"}]}, {"DetectionNote": "The capability enriched wscript.exe and powershell.exe with the correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)"}, {"ScreenshotName": "CB-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing process tree of script execution"}, {"ScreenshotName": "CB-11.A.1-3.png", "ScreenshotCaption": "Specific Behavior alerts for Powershell scripting"}]}]}, {"SubStep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Detections": [{"DetectionNote": "Telemetry showed process execution of powershell.exe. The powershell.exe process loaded several non-default dynamically loaded libraries that may indicate the functionality may be used by the PowerShell script.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe execution"}, {"ScreenshotName": "CB-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing dynamically loaded libraries (modloads) that may indicate PowerShell functionality"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-4.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-4.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with a related ATT&CK technique (Account Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-4.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-4.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}]}]}, {"SubStep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-4.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-4.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with a related ATT&CK technique (Account Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-4.A.2-1.png", "ScreenshotCaption": "Telemetry from process tree showing net.exe with command-line arguments"}, {"ScreenshotName": "CB-4.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)"}]}]}, {"SubStep": "13.A.1", "Procedure": "Empire: 'net group \"Domain Computers\" -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed a process tree containing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with net.exe and command-line arguments"}, {"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}]}, {"DetectionNote": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CB-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing process tree with net.exe and command-line arguments"}, {"ScreenshotName": "CB-13.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated showing the correct ATT&CK Technique (Credential Dumping).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CB-5.A.1-1.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}, {"ScreenshotName": "CB-5.A.1-4.png", "ScreenshotCaption": "Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)"}]}, {"DetectionNote": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection for credential dumping.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-5.A.1-1.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}, {"ScreenshotName": "CB-5.A.1-4.png", "ScreenshotCaption": "Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)"}]}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Detections": [{"DetectionNote": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection for credential dumping.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CB-5.A.2-2.png", "ScreenshotCaption": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe"}]}]}]}]}