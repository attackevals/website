{"PublicRelease": "\u00a92019 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 18-4019 ", "Techniques": [{"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.F.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.F.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.F.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "The capability enriched net.exe indicating it is commonly used for reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.F.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.1-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.F.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.2-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.F.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.2-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.F.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.2-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}, {"DetectionNote": "The capability enriched net.exe indicating it is commonly used for reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.F.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.F.2-99.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}]}, {"SubStep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" -domain' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.3-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.3-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.3-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.3-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "The capability enriched net.exe indicating it is commonly used for reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.F.3-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.F.3-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of AD group memberships.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "12.F.1", "Procedure": "Empire: 'net group \"Domain Admins\" -domain' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.F.1-T1069-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.F.1-T1069-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}]}]}, {"SubStep": "12.F.2", "Procedure": "Empire: 'net\u00ef\u00bf\u00bdlocalgroup\u00ef\u00bf\u00bdadministrators' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net1.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.F.2-T1069-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.F.2-T1069-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-3.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}]}, {"DetectionNote": "A Specific Behavior alert was generated for sc.exe used with parameters typical for lateral movement.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-3.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}]}, {"DetectionNote": "Telemetry showed sc.exe execution with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-3.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry within the process trees showed execution of sc.exe with command-line arguments to create the AdobeUpdater service with binPath pointed to cmd.exe with arguments to execute update.vbs and a suspicious service description, which could indicate masquerading.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. Additionally recycler.exe was identified as WinRAR via file metadata, including executable product and description.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-19.B.1-4.png", "ScreenshotCaption": "Telemetry showing recycler.exe metadata, which identified it as WinRAR"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "2.C.2 ", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing tasklist) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.D.2-2.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)"}, {"ScreenshotName": "CC-2.C.2-2.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.D.2-2.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)"}, {"ScreenshotName": "CC-2.C.2-2.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing tasklist.exe along with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.D.2-2.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)"}, {"ScreenshotName": "CC-2.C.2-2.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}]}, {"SubStep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance"}, {"ScreenshotName": "CC-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershelll.exe executing qprocess.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance"}, {"ScreenshotName": "CC-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "The capability enriched qprocess.exe as listing running processes and possibly a sign of reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance"}, {"ScreenshotName": "CC-12.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing qprocess.exe with command-line arguments"}, {"ScreenshotName": "CC-12.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Detections": [{"DetectionNote": "Telemetry showed a remote interactive logon event for the account Jesse logging on to Conficker (10.0.0.5) over port 3389.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-10.B.1-T1076-new.png", "ScreenshotCaption": "Telemetry showing a RemoteInteractive connection as Jesse over port 3389 to Conficker (10.0.0.5)"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick. Telemetry also showed a logon event for user Kmitnick on Conficker (10.0.0.5).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt"}, {"ScreenshotName": "CC-16.C.1-2.png", "ScreenshotCaption": "Telemetry showing a logon event for user Kmitnick on Conficker (10.0.0.5)"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. Telemetry also showed a logon event for user Kmitnick on Creeper (10.0.0.4).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-16.C.1-2.png", "ScreenshotCaption": "Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)"}, {"ScreenshotName": "CC-16.D.1-T1078-new.png", "ScreenshotCaption": "The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement"}]}, {"DetectionNote": "The capability enriched the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-16.C.1-2.png", "ScreenshotCaption": "Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)"}, {"ScreenshotName": "CC-16.D.1-T1078-new.png", "ScreenshotCaption": "The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement"}]}]}]}, {"TechniqueId": "T1126", "TechniqueName": "Network Share Connection Removal", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.C.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.C.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the Get-Content cmdlet on IT_tasks.txt.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-15.A.1-4.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the Get-Content cmdlet on IT_tasks.txt"}]}]}]}, {"TechniqueId": "T1010", "TechniqueName": "Application Window Discovery", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the GetForegroundWindow method.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the GetForegroundWindow method"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, {"ScreenshotName": "CC-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}, {"DetectionNote": "The capability enriched net.exe indicating that it was run with commands commonly used for reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, {"ScreenshotName": "CC-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, {"ScreenshotName": "CC-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}, {"DetectionNote": "The capability enriched net.exe indicating that it was run with commands commonly used for reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance"}, {"ScreenshotName": "CC-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "13.A.1", "Procedure": "Empire: 'net group \"Domain Computers\" -domain' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}]}, {"TechniqueId": "T1026", "TechniqueName": "Multiband Communication", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server) as well as earlier identified DNS queries, which could indicate multiband communication.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-6.B.1-T1043-new.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "CC-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making DNS queries"}]}]}]}, {"TechniqueId": "T1110", "TechniqueName": "Brute Force", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00ef\u00bf\u00bdKmitnick, Bob, and Frieda", "Detections": [{"DetectionNote": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts"}]}, {"DetectionNote": "The capability enriched multiple occurrences of net.exe usage as indicative of brute forcing a remote system as well as the correct ATT&CK Technique ID (Brute Force). [CC3]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts"}], "Footnotes": ["Screenshot is not available due to sensitivity of rule logic."]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt"}]}, {"DetectionNote": "The capability enriched multiple occurrences of net.exe usage as indicative of brute forcing a remote system as well as the correct ATT&CK Technique ID (Brute Force). [CC3]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempt"}], "Footnotes": ["Screenshot is not available due to sensitivity of rule logic."]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Detections": [{"DetectionNote": "Telemetry showed the creation of the new user Jesse.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-7.A.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of the new user Jesse"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the GetAsyncKeyState method, indicating keylogging.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the GetAsyncKeyState method"}, {"ScreenshotName": "CC-15.B.1-3.png", "ScreenshotCaption": "Enrichment of powershell.exe with a tag indicating .NET keylogging"}]}, {"DetectionNote": "The capability enriched powershell.exe with a tag indicating .NET keylogging.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-15.A.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the GetAsyncKeyState method"}, {"ScreenshotName": "CC-15.B.1-3.png", "ScreenshotCaption": "Enrichment of powershell.exe with a tag indicating .NET keylogging"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Detections": [{"DetectionNote": "A General Behavior alert was generated for the execution of a rare file (Resume Viewer.exe). [CC1] [CC4]", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing the execution of Resume Viewer.exe"}], "Footnotes": ["The vendor reported that this behavior would have been prevented from executing.", "Screenshot is unavailable due to sensitivity of alert logic."]}, {"DetectionNote": "Telemetry showed the execution of Resume Viewer.exe as a process.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing the execution of Resume Viewer.exe"}]}]}]}, {"TechniqueId": "T1201", "TechniqueName": "Password Policy Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of password policy information.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \"\\\\conficker\\wormshare\"' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing dir) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing dir)"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance."}, {"ScreenshotName": "CC-8.A.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing dir)"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance."}, {"ScreenshotName": "CC-8.A.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "The capability enriched cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing dir)"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance."}, {"ScreenshotName": "CC-8.A.1-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing tree) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tree)"}, {"ScreenshotName": "CC-8.A.2-2.png", "ScreenshotCaption": "Enrichment of tree.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tree)"}, {"ScreenshotName": "CC-8.A.2-2.png", "ScreenshotCaption": "Enrichment of tree.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "The capability enriched cmd.exe executing the tree command with a tag identifying the command as enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-8.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing tree)"}, {"ScreenshotName": "CC-8.A.2-2.png", "ScreenshotCaption": "Enrichment of tree.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-8.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of recently opened files.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of interesting files.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the type command with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the type command with command-line arguments"}]}]}, {"SubStep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the Get-ChildItem command.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-18.A.1-T1083-new.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the Get-ChildItem command"}]}]}]}, {"TechniqueId": "T1132", "TechniqueName": "Data Encoding", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Detections": [{"DetectionNote": "Telemetry showed a trace of encoded DNS queries being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-1.C.1-T1071-new.png", "ScreenshotCaption": "Telemetry showing rundll32 making encoded DNS queries"}]}]}]}, {"TechniqueId": "T1015", "TechniqueName": "Accessibility Features", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for the modification of an accessibility features binary known to be used for privilege escalation.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation"}, {"ScreenshotName": "CC-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command"}]}, {"DetectionNote": "Telemetry showed powershell.exe overwriting magnify.exe with cmd.exe via the copy command.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation"}, {"ScreenshotName": "CC-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command"}]}, {"DetectionNote": "The capability enriched cmd.exe as being renamed to another process and with a relevant ATT&CK Technique (Masquerading). [CC3]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation"}, {"ScreenshotName": "CC-17.B.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command"}], "Footnotes": ["Screenshot is not available due to sensitivity of rule logic."]}]}, {"SubStep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated for magnify.exe executing as a process with a renamed executable.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-20.A.1-3.png", "ScreenshotCaption": "Telemetry showing me magnify.exe executing from utilman.exe"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert for magnify.exe executing as a process with a renamed executable"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor"}]}, {"DetectionNote": "Telemetry showed magnify.exe executing from utilman.exe with the original file name of cmd.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-20.A.1-3.png", "ScreenshotCaption": "Telemetry showing me magnify.exe executing from utilman.exe"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert for magnify.exe executing as a process with a renamed executable"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor"}]}, {"DetectionNote": "The capability enriched utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-20.A.1-3.png", "ScreenshotCaption": "Telemetry showing me magnify.exe executing from utilman.exe"}, {"ScreenshotName": "CC-20.A.1-4.png", "ScreenshotCaption": "General Behavior alert for magnify.exe executing as a process with a renamed executable"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor"}]}]}]}, {"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Detections": [{"DetectionNote": "The capability enriched netstat.exe with a tag identifying the command as enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-4.C.1-2.png", "ScreenshotCaption": "Enrichment of netstat.exe with a tag identifying the command as enumeration"}]}]}, {"SubStep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of established network connections.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.G.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing netstat.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.G.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing netstat.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-3.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection"}]}]}, {"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Detections": [{"DetectionNote": "The capability enriched svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-5.A.2-1.png", "ScreenshotCaption": "Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection"}]}]}, {"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running pdfhelper.cmd) has been tagged for monitoring because its parent process has a detection (Resume Viewer.exe). [CC4]", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing the execution of pdfhelper.cmd"}], "Footnotes": ["Screenshot is unavailable due to sensitivity of alert logic."]}, {"DetectionNote": "Telemetry showed pdfhelper.cmd was executed by cmd.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing the execution of pdfhelper.cmd"}]}]}, {"SubStep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for PowerShell executing a long, encoded command.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe"}, {"ScreenshotName": "CC-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code"}, {"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell executing a long, encoded command"}]}, {"DetectionNote": "Telemetry showed wscript.exe executing autoupdate.vbs and subsequently powershell.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe"}, {"ScreenshotName": "CC-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code"}, {"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell executing a long, encoded command"}]}, {"DetectionNote": "The capability enriched wscript.exe executing powershell.exe with a tag indicating that wscript executed code.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-11.A.1-3.png", "ScreenshotCaption": "Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe"}, {"ScreenshotName": "CC-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code"}, {"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell executing a long, encoded command"}]}]}, {"SubStep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}]}, {"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.G.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with a tag identifying the command as enumeration"}]}, {"DetectionNote": "The capability enriched net.exe with a tag identifying the command as enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.G.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.G.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with a tag identifying the command as enumeration"}]}]}, {"SubStep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.G.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}, {"DetectionNote": "The capability enriched net.exe with a tag identifying the command as enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.G.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}]}, {"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Detections": [{"DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in), which displays local account information.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lursmgr.msc"}]}]}, {"SubStep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.G.1-T1087-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.G.1-T1087-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.G.2-T1087-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-12.G.2-T1087-new.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the reg) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance"}, {"ScreenshotName": "CC-2.G.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg)"}, {"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-2.G.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance"}, {"ScreenshotName": "CC-2.G.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg)"}, {"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-2.G.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance"}, {"ScreenshotName": "CC-2.G.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg)"}, {"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-2.G.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "The capability enriched reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance"}, {"ScreenshotName": "CC-2.G.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing reg)"}, {"ScreenshotName": "CC-2.H.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-2.G.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-6.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon"}, {"ScreenshotName": "CC-6.A.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}]}, {"DetectionNote": "The capability enriched reg.exe identifying that a sensitive Registry key was accessed which could be used for recon.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-6.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon"}, {"ScreenshotName": "CC-6.A.1-2.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}]}]}, {"SubStep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of system information via a Registry query.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "13.C.1", "Procedure": "Empire:\u00ef\u00bf\u00bd'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing reg.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.G.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}]}, {"DetectionNote": "The capability enriched reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-12.G.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-13.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed reg.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "The capability enriched reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for PowerShell downloading a significant amount of data using HTTP(S).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker (10.0.0.5) to the Recycle Bin as well as a file create event.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-18.B.1-T1074-new.png", "ScreenshotCaption": "Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin"}, {"ScreenshotName": "CC-18.A.1-4.png", "ScreenshotCaption": "Telemetry showing a file create event for the .vsdx file in the Recycle Bin"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior"}, {"DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use.", "DetectionType": "Telemetry"}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed a trace of DNS queries being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-1.C.1-T1071-new.png", "ScreenshotCaption": "Telemetry showing rundll32 making DNS queries"}]}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed a trace of HTTP connections being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing rundll32 making HTTP connections"}]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making a connection over port 443 to freegoogleadsenseinfo.com (C2 domain). [CC2]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-11.B.1-T1071-new.png", "ScreenshotCaption": "Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)"}, {"ScreenshotName": "CC-11.A.1-5.png", "ScreenshotCaption": "An alert for PowerShell downloading a significant amount of data using HTTP(S) (does not count as a detection since it was based on port)"}], "Footnotes": [" There was an alert for PowerShell downloading significant amount of data using HTTP(S), though this alert was based only on the port (443)."]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}]}]}]}, {"TechniqueId": "T1135", "TechniqueName": "Network Share Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of available shares.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of mapped network drives.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}]}, {"DetectionNote": "A Specific Behavior alert was generated for sc.exe used with parameters typical for lateral movement.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}]}, {"DetectionNote": "Telemetry showed sc.exe execution with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}, {"ScreenshotName": "CC-16.D.1-2.png", "ScreenshotCaption": "Specific Behavior alert for sc.exe used with parameters typical for lateral movement"}]}]}]}, {"TechniqueId": "T1039", "TechniqueName": "Data from Network Shared Drive", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker (10.0.0.5) to the Recycle Bin.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-18.A.1-3.png", "ScreenshotCaption": "Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Detections": [{"DetectionNote": "An Indicator of Compromise alert was generated for PowerShell Empire accessing the clipboard.", "DetectionType": "Indicator of Compromise", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, {"ScreenshotName": "CC-12.E.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for PowerShell Empire accessing the clipboard."}]}, {"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of clipboard contents.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, {"ScreenshotName": "CC-12.E.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for PowerShell Empire accessing the clipboard."}]}]}]}, {"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-6.C.1-T1076-new.png", "ScreenshotCaption": "Telemetry showing rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389"}]}]}, {"SubStep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "Telemetry showed a remote interactive logon event for the account Jesse logging on to Conficker (10.0.0.5) over port 3389.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-10.B.1-T1076-new.png", "ScreenshotCaption": "Telemetry showing a RemoteInteractive connection over port 3389 to Conficker (10.0.0.5)"}]}]}, {"SubStep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "The capability enriched a Remote Desktop connection indicating a successful login to Remote Desktop Services.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-20.A.1-2.png", "ScreenshotCaption": "Enrichment of a Remote Desktop connection indicating a successful login to Remote Desktop Services."}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Detections": [{"DetectionNote": "Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent logon event for user Debbie with an elevated token, indicating token manipulation.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-3.A.1-3.png", "ScreenshotCaption": "Telemetry showing svchost.exe executed with the seclogon command-line argument"}, {"ScreenshotName": "CC-3.A.1-1.png", "ScreenshotCaption": "Telemetry showing logon event for user Debbie with an elevated token"}]}]}, {"SubStep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Detections": [{"DetectionNote": "Telemetry showed a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-5.B.1-T1134-new.png", "ScreenshotCaption": "Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the echo command) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)"}, {"ScreenshotName": "CC-2.B.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the echo command"}, {"ScreenshotName": "CC-2.B.1-99.png", "ScreenshotCaption": "A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)"}, {"ScreenshotName": "CC-2.B.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the echo command"}, {"ScreenshotName": "CC-2.B.1-99.png", "ScreenshotCaption": "A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing the echo command.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)"}, {"ScreenshotName": "CC-2.B.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing the echo command"}, {"ScreenshotName": "CC-2.B.1-99.png", "ScreenshotCaption": "A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation"}, {"ScreenshotName": "CC-12.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation"}, {"ScreenshotName": "CC-12.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "The capability enriched powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation"}, {"ScreenshotName": "CC-12.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing whoami.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of user information.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing the execution of whoami"}, {"ScreenshotName": "CC-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)"}]}, {"DetectionNote": "Telemetry showed whoami.exe was executed from magnify.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing the execution of whoami"}, {"ScreenshotName": "CC-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)"}]}, {"DetectionNote": "The capability enriched whoami.exe with a tag identifying the command as enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing the execution of whoami"}, {"ScreenshotName": "CC-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-20.A.1-7.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)"}]}]}]}, {"TechniqueId": "T1222", "TechniqueName": "File and Directory Permissions Modification", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}]}, {"DetectionNote": "A Specific Behavior alert was generated for takeown.exe changing the ownership of an accessibility feature executable.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}]}, {"DetectionNote": "Telemetry showed takeown.exe executing with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}]}]}, {"SubStep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}]}, {"DetectionNote": "A Specific Behavior alert was generated for icalcs.exe changing the permissions of an accessibility feature executable.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}]}, {"DetectionNote": "Telemetry showed icacls.exe executing with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe with command-line arguments"}, {"ScreenshotName": "CC-17.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable"}, {"ScreenshotName": "CC-17.A.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe)."}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from within the Startup folder.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-1.B.1-T1060-new.png", "ScreenshotCaption": "Telemetry showing the autoupdate.bat within the Startup folder"}]}]}, {"SubStep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for a batch file automatically being started from the Startup folder.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-10.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a batch file automatically being started from the Startup folder."}, {"ScreenshotName": "CC-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-10.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for a batch file automatically being started from the Startup folder."}, {"ScreenshotName": "CC-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CC-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Specific Behavior alerts were generated for net.exe connecting to a remote administrative share.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CC-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net use logon attempts to ADMIN$ shares"}, {"ScreenshotName": "CC-16.A.1-1.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing a net use logon attempt to ADMIN$ shares"}, {"ScreenshotName": "CC-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.B.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Specific Behavior alerts were generated for net.exe connecting to a remote administrative share.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing a net use logon attempt to ADMIN$ shares"}, {"ScreenshotName": "CC-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.B.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing a net use logon attempt to ADMIN$ shares"}, {"ScreenshotName": "CC-16.B.1-2.png", "ScreenshotCaption": "Specific Behavior alerts for net.exe connecting to a remote administrative share"}, {"ScreenshotName": "CC-16.B.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-16.C.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-16.C.1-3.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.D.1", "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the command to delete old.rar.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing the deletion of old.rar"}]}]}, {"SubStep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the command to delete recycler.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-19.D.1-1.png", "ScreenshotCaption": "Telemetry showing the deletion of recycler.exe"}]}]}]}, {"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing sc with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.D.2-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.D.2-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.D.2-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.D.2-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.D.2-98.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of services.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.H.1-2.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing sc.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.H.1-2.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed sc.exe execution with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}, {"ScreenshotName": "CC-16.I.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Detections": [{"DetectionNote": "Telemetry showed reg.exe with command-line arguments to check if terminal services were enabled.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "The capability enriched the creation of updater.dll identifying that a command prompt modified an unknown DLL.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-7.B.1-1.png", "ScreenshotCaption": "Enrichment of the creation of updater.dll identifying that a command prompt modified an unknown DLL"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for PowerShell downloading a significant amount of data using HTTP(S).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}, {"ScreenshotName": "CC-14.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)"}]}, {"DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}, {"ScreenshotName": "CC-14.A.1-1.png", "ScreenshotCaption": "Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)"}]}]}, {"SubStep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed the file creation of autoupdate.vbs.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.D.1-6.png", "ScreenshotCaption": "Telemetry showing the creation of autoupdate.vbs"}]}]}, {"SubStep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed the file creation of update.vbs.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-16.D.1-6.png", "ScreenshotCaption": "Telemetry showing the creation of update.vbs"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe creating recycler.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-19.B.1-2.png", "ScreenshotCaption": "Telemetry showing the creation of recycler.exe"}]}]}]}, {"TechniqueId": "T1061", "TechniqueName": "Graphical User Interface", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Detections": [{"DetectionNote": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-7.A.1-T1061-new.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lursmgr.msc"}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing ipconfig) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)"}, {"ScreenshotName": "CC-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)"}, {"ScreenshotName": "CC-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "The capability enriched ipconfig.exe with a tag identifying the command as enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)"}, {"ScreenshotName": "CC-2.A.1-2.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe indicating its usage can be a sign of reconnaissance"}, {"ScreenshotName": "CC-2.A.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}, {"DetectionNote": "The capability enriched arp.exe indicating its usage can be a sign of reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of arp.exe indicating its usage can be a sign of reconnaissance"}, {"ScreenshotName": "CC-2.A.2-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)"}]}]}, {"SubStep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing netsh.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-4.B.1-2.png", "ScreenshotCaption": "Telemetry showing netsh.exe with command-line arguments"}]}]}, {"SubStep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance"}, {"ScreenshotName": "CC-12.A.1-2.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance"}, {"ScreenshotName": "CC-12.A.1-2.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "The capability enriched route.exe indicating that it could be used to print the routing table as part of reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance"}, {"ScreenshotName": "CC-12.A.1-2.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-12.A.2-4.png", "ScreenshotCaption": "Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-12.A.2-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "Telemetry showed ipconfig.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.A.2-4.png", "ScreenshotCaption": "Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-12.A.2-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}, {"DetectionNote": "The capability identified powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-12.A.2-4.png", "ScreenshotCaption": "Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration"}, {"ScreenshotName": "CC-12.A.2-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command line arguments"}, {"ScreenshotName": "CC-11.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)"}]}]}, {"SubStep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of network adapters.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, {"ScreenshotName": "CC-12.E.1-3.png", "ScreenshotCaption": "Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters"}]}, {"DetectionNote": "The capability enriched powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}, {"ScreenshotName": "CC-12.E.1-3.png", "ScreenshotCaption": "Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.E.1-1.png", "ScreenshotCaption": "Enrichment of systeminfo.exe indicating it could be used for reconnaissance."}, {"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "The capability enriched systeminfo.exe indicating it could be used for reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.E.1-1.png", "ScreenshotCaption": "Enrichment of systeminfo.exe indicating it could be used for reconnaissance."}, {"ScreenshotName": "CC-2.B.1-1.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Detections": [{"DetectionNote": "A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.E.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.E.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.E.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}, {"DetectionNote": "The capability enriched net.exe indicating it is commonly used for reconnaissance.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-2.A.1-1.png", "ScreenshotCaption": "General Behavior alert for rundll32.exe launching cmd.exe (executing net)"}, {"ScreenshotName": "CC-2.A.2-2.png", "ScreenshotCaption": "Enrichment of net.exe indicating it is commonly used for reconnaissance"}, {"ScreenshotName": "CC-2.E.2-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "CC-2.A.1-99.png", "ScreenshotCaption": "General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)"}]}]}, {"SubStep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of system information.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of Windows update information.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1053", "TechniqueName": "Scheduled Task", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe registering the \"Resume Viewer Update Checker\" scheduled task.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-7.C.1-2.png", "ScreenshotCaption": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence"}]}]}, {"SubStep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe executing updater.dll.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing rundll32 starting updater.dll, tainted by an \"abnormal rundll32 launch\" alert"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Detections": [{"DetectionNote": "Telemetry showed network connections over port 80 to 192.168.0.4 (C2 server) initiated from rundll32.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-6.B.1-T1043-new.png", "ScreenshotCaption": "Telemetry showing network connections over port 80 to 192.168.0.4 (C2 server)"}]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Detections": [{"DetectionNote": "Telemetry showed a network connection over port 443 to www.freegoogleadsenseinfo.com (C2 domain).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-11.A.1-4.png", "ScreenshotCaption": "Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of AV solutions.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}, {"SubStep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Detections": [{"DetectionNote": "Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of firewall rules.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function"}]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "A General Behavior alert was generated showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe).", "DetectionType": "General Behavior"}, {"DetectionNote": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. Additionally recycler.exe was identified as WinRAR via file metadata, including executable product and description. Telemetry also showed the creation of old.rar as the output of recycler.exe running.", "DetectionType": "Telemetry"}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated for the execution of ftp.exe with a command file option by an unusual parent process and could be used for exfiltration.", "DetectionType": "Specific Behavior"}, {"DetectionNote": "Telemetry showed ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21.", "DetectionType": "Telemetry"}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Detections": [{"DetectionNote": "The capability enriched svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-5.A.2-1.png", "ScreenshotCaption": "Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping"}]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "A General Behavior alert was generated for an unusual call to rundll32.exe. [CC4]", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat"}], "Footnotes": ["Screenshot is unavailable due to sensitivity of alert logic."]}, {"DetectionNote": "A Specific Behavior alert was generated for rundll32.exe executing in a way typical for rundll32 injections. [CC4]", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat"}], "Footnotes": ["Screenshot is unavailable due to sensitivity of alert logic."]}, {"DetectionNote": "Telemetry showed rundll32.exe executing update.dat.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-1.A.1-4.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Detections": [{"DetectionNote": "The capability enriched an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "CC-3.A.1-2.png", "ScreenshotCaption": "Enrichment of an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass."}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Detections": [{"DetectionNote": "A General Behavior alert was generated for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "CC-14.A.1-1.png", "ScreenshotCaption": "General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent"}, {"ScreenshotName": "CC-14.A.1-T1088-new.png", "ScreenshotCaption": "Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process"}]}, {"DetectionNote": "Telemetry showed an elevated PowerShell spawned under the context of user Bob from an unelevated parent process.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "CC-14.A.1-1.png", "ScreenshotCaption": "General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent"}, {"ScreenshotName": "CC-14.A.1-T1088-new.png", "ScreenshotCaption": "Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process"}]}]}]}]}