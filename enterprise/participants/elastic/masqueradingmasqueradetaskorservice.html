<!DOCTYPE html>
<html lang='en'>

<head>
    <script async src='https://www.googletagmanager.com/gtag/js?id=UA-62667723-5'></script><script src='/theme/scripts/analytics.js'></script>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='shortcut icon' href='https://d1zq5d3dtjfcoj.cloudfront.net/ME_icon.png' type='image/x-icon'>

    <link rel="stylesheet" href="/theme/style/all.css">

    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    
    <title>ATT&CK&reg; EVALUATIONS</title>
    <!-- Bootstrap CSS -->
    <link rel='stylesheet' href='/theme/style/bootstrap.min.css' />
    <link rel='stylesheet' href='/theme/style/bootstrap-glyphicon.min.css' />
    <link href="/theme/style/bootstrap-tourist.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/theme/style.min.css?9ce184b4">

    <link rel="stylesheet" type="text/css" href="/theme/tact_tech_subtech_summary.min.css?7f01a381">
</head>

<body>
    <header class='pb-5'>
        <nav class='navbar navbar-expand-lg navbar-light fixed-top box-shadow-bottom bg-white'>
        <a class='navbar-brand' href='/'><img src='https://d1zq5d3dtjfcoj.cloudfront.net/MITRE_Engenuity_ATTACK-Evaluations_logo_PMS_purple.jpg' height="50px" alt=''></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse' aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
          <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
          <ul class='nav nav-tabs ml-auto'>
            
            <li class="dropdown-submenu">
               <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Enterprise</strong></a>
                <!-- <ul class="dropdown-menu dropleft"> -->
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href="/methodology-overview.html">
                            Methodology Overview
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 50px;">
                            <li><a class="dropdown-item" href="/enterprise/participants/?adversaries=apt3">Results</a></li>
                            <li><a class="dropdown-item" href="/enterprise/APT3">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT3 (2018)
                        </a>
                        
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 90px;">
                            <li><a class="dropdown-item" href="/enterprise/participants/?adversaries=apt29">Results</a></li>
                            <li><a class="dropdown-item" href="/enterprise/APT29">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT29 (2019)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 130px;">
                            <li><a class="dropdown-item" href="/enterprise/participants/?adversaries=carbanak_fin7">Results</a></li>
                            <li><a class="dropdown-item" href="/enterprise/carbanak_fin7/">Overview</a></li>
                            </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Carbanak+FIN7 (2020)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 180px;">
                            <li><a class="dropdown-item" href="/get-evaluated">Call for Participation</a></li>
                            <li><a class="dropdown-item" href="/enterprise/wizard-spider-and-sandworm/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Wizard Spider and <br> Sandworm (2021)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href="/enterprise/participants/">
                            View All Participants
                        </a>
                    </li>

                </ul>
            </li>

            <li class="dropdown-submenu">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>ICS</strong></a>
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right">
                            <li><a class="dropdown-item" href="/ics/participants/">Participants</a></li>
                            <li><a class="dropdown-item" href="/ics/triton/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            TRITON (2020)
                        </a>
                    </li>
                </ul>
            </li>

            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Tools</strong></a>
                <!-- <div class="dropdown-menu" aria-labelledby="navbarDropdown"> -->
                <div class="dropdown-menu">
                    <a class="dropdown-item" href='/technique_comparison.html'>Technique Comparison Tool </a>
                    <a class="dropdown-item" href='/participant_comparison.html'>Participant Comparison Tool </a>
                    <!-- <a class="dropdown-item" href='https://github.com/mitre-attack/attack-arsenal'>
                        ATT&CK Arsenal
                        &nbsp;<i class="fas fa-external-link-alt"></i>
                    </a> -->
                    <a class="dropdown-item" href='https://github.com/center-for-threat-informed-defense/adversary_emulation_library'>
                        Emulation Plan Library 
                        &nbsp;<i class="fas fa-external-link-alt"></i>
                    </a>
                </div>  
            </li>
            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Resources</strong></a>
                <!-- <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> -->
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/using-attack-evaluations.html">Using ATT&CK Evaluations</a>
                        <a class="dropdown-item" href="/about.html">About ATT&CK</a>
                        <a class="dropdown-item" href="/FAQ.html">FAQ</a>
                        <a class="dropdown-item" href="https://mitre-engenuity.org/mad/https://mitre-engenuity.org/mad/https://mitre-engenuity.org/mad/">MITRE ATT&CK Defender Training&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i></a>
                        <a class="dropdown-item" href="https://mitre-engenuity.org/ctid/">Center for Threat-Informed Defense&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i></a>
                        <a class="dropdown-item" href="https://medium.com/mitre-engenuity/tagged/evaluation" target="_blank"> Blog</strong>&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i> </a>
                    </div>  
                </li> 
            <li class='nav-item'><a  class='nav-link'  href='/get-evaluated.html'><strong>Get Evaluated</strong></a></li>
          </ul>
        </div>
    </nav>
    <div class="div-cfp">
        <h5 class="h5-cfp">
            The 2021 ATT&CK Evaluations for Enterprise Call for Participation is now open. 
            Click <a class="a-click-here" href="/get-evaluated.html">here</a>
            to learn how to participate.
        </h5>
    </div>

</header>
<div id='content-width-lock'>
    <div id='content'>
<div class='divProcedureSummaryBody-techsummary'>
    <div style='width: 100%; padding-top: 20px;'>
        <table style='width: 100%;'>
            <tr>
                <td style='width: 100%;'>
                    <div style="padding: 0px; width: 100%;"> 
                        <span class="spanBreadcrumbs-results"> 
                            <a href='/'>Home</a> &nbsp;>&nbsp; 
                            <a href='/methodology-overview.html'>Enterprise</a> &nbsp;>&nbsp;
                            <a href='/enterprise/participants/'>Participants</a> &nbsp;>&nbsp;
                            <a href='/enterprise/participants/elastic/' id='aOverviewBreadcrumbVendorname'>Elastic</a> &nbsp;>
                            &nbsp;Masquerading: Masquerade Task or Service (T1036.004)
                        </span>
                    </div>
                </td>
            </tr>
        </table>
        <br />
        <table class='tableMain-techsummary'>
            <tr>
                <td class='tdMainLeftPane-techsummary'>
                    <table class='tableHeaderLegend-techsummary'>
                        <tr>
                            <td class='tdMainLabel-techsummary'>
                                <h4 class="h4-summary">SUBTECHNIQUE RESULTS</h4>
                                <h2>Masquerading: Masquerade Task or Service (T1036.004)
                                    <!-- <span class='tdInnerDetectionNotesSum-techsummary'>
                                        <a class='aFootnote' href='javascript:void(0);'><i class="fas fa-info-circle"></i>
                                            <span class='spanPopup-footnotes' onclick='return false;' href='#'>
                                                <strong style="font-size:16px">Subtechnique Page Information</strong><br />
                                                <hr style="border: 2px solid black;" />
                                                The ATT&CK subtechnique page displays all tested subtechniques belonging to that subtechnique, as well as all procedures and their respective detections. The procedures are grouped by their technique. The Procedure column contains a description of how the technique was tested. The Step column is where in the operational flow the procedure occurred. Click the Step Number to view it in the Operational Flow panel. Detections are classified by one or more Detection Types, summarized by the Detection Notes, and may be supported by Screenshots. The Operational Flow panel provides the context around when a procedure was executed by showing all steps of the evaluation, including the tactics, techniques and procedures of the executed steps.
                                            </span>
                                        </a>
                                    </span>      -->
                                </h2>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <br />
                                <div class='divDisclaimer-techsummary'>
                                    <em>MITRE Engenuity does not assign scores, rankings, or ratings. The evaluation results are available to the public, so other organizations may provide their own analysis and interpretation - these are not endorsed or validated by MITRE.</em>
                                </div>
                                <br />
                            </td>
                        </tr>
                    </table>
            </tr>
        </table>
    </div>
    <div id='div_filter_btns' style="display: flex; flex-direction: row; justify-content: center; font-size: 1.3rem;">
        See subtechnique results for:&nbsp;
            <div style="margin: 0 15px 0 15px;">
                <input type="checkbox" id="chk_carbanak_fin7" onclick="filterResultsByAdversary(this.parentNode.parentNode);" data-adversary="carbanak_fin7">
                <label for="chk_carbanak_fin7"">Carbanak+FIN7</label>
            </div>
            <div style="margin: 0 15px 0 15px;">
                <input type="checkbox" id="chk_apt29" onclick="filterResultsByAdversary(this.parentNode.parentNode);" data-adversary="apt29">
                <label for="chk_apt29"">APT29</label>
            </div>
            <div style="margin: 0 15px 0 15px;">
                <input type="checkbox" id="chk_apt3" onclick="filterResultsByAdversary(this.parentNode.parentNode);" data-adversary="apt3">
                <label for="chk_apt3"">APT3</label>
            </div>
    </div>
    <br />
        <div id="div_carbanak_fin7_summary" style="display: none; flex-direction: row; margin-bottom: 50px;">
            <table class="mt-1 w-75 mx-auto">
                <tbody>
                    <tr>
                        <td colspan=3 style="width: 100%">
                            <h2 class="text-center">Carbanak+FIN7</h2>
                        </td>
                    </tr>
                        <tr>
                            <td colspan=3 style="width: 100%">
                                <hr>
                                <h5 class="text-center">The subtechnique was not in scope.</h5>
                            </td>
                        </tr>
                </tbody>
            </table>

        </div>
        <div id="div_apt29_summary" style="display: none; flex-direction: row; margin-bottom: 50px;">
            <table class="mt-1 w-75 mx-auto">
                <tbody>
                    <tr>
                        <td colspan=3 style="width: 100%">
                            <h2 class="text-center">APT29</h2>
                        </td>
                    </tr>
                        <tr>
                            <td colspan=3 style="width: 100%">
                                <hr>
                                <h5 class="text-center">The subtechnique was not in scope.</h5>
                            </td>
                        </tr>
                </tbody>
            </table>

        </div>
        <div id="div_apt3_summary" style="display: none; flex-direction: row; margin-bottom: 50px;">
            <table class="mt-1 w-75 mx-auto">
                <tbody>
                    <tr>
                        <td colspan=3 style="width: 100%">
                            <h2 class="text-center">APT3</h2>
                        </td>
                    </tr>
                        <tr class="text-center text-white bg-dark">
                            <td style="width: 10%;"> 
                                Step 
                            </td>
                            <td style="width: 25%;">
                                ATT&CK Pattern
                            </td>
                            <td style="width: 65%;">
                                <table class="w-100">
                                    <tr>
                                        <td style="width: 30%;"> Detection Type </td>
                                        <td style="width: 70%;"> Detection Note </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 10%; height: 100%; padding: 4px 0 4px 0;">
                                <div class="divStepCell">
                                    16.I.1
                                </div>
                            </td>
                            <td style="width: 25%; height: 100%; padding: 4px 0 4px 0;">
                                <div class="divAttackPatternCell">
                                    <p class="p_attack_pattern_header"> Tactic </p>
                                    <a class="a_attack_pattern_link" 
                                        href="defenseevasion.html?adversaries=apt3"
                                    >
                                        <p>
                                            Defense Evasion (TA0005)
                                        </p>
                                    </a>
                                    <p class="p_attack_pattern_header"> Technique </p>
                                    <a class="a_attack_pattern_link" 
                                        href="masquerading.html?adversaries=apt3"
                                    >
                                        <p>
                                            Masquerading (T1036) 
                                        </p>
                                    </a>
                                </div>
                            </td>
                            <td style="width: 65%; height: 100%; padding: 4px 0 4px 0;">
                                <table style="width: 100%; height: 100%;">
                                    <tbody>
                                            <tr 
                                                class="tr_detection_row" 
                                                id="apt3_16_i_1_113_0" 
                                                onclick="show_detection_details(this);" 
                                                data-adversary="apt3" 
                                                data-substep="16_i_1_113" 
                                                data-detection_num="0"
                                            >
                                                <td class="tdDetectionType">
                                                            <div class="divDetectionTypeCell">
                                                    <a class="false_anchor" id="fa_apt3_16_i_1_113_0"></a>
                                                        Telemetry
                                                        <span class="span_modifiers">
                                                                (Tainted)
                                                        </span>
                                                    </div>
                                                </td>
                                                <td class="tdDetectionNote">
                                                            <div class="divDetectionNoteCell">
                                                        Telemetry showed sc.exe executions to create the AdobeUpdater service and set the binPath to run cmd.exe with an argument to execute update.vbs as well as set the description of the service. An analyst could use this information to determine masquerading occurred. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.
                                                            <a  
                                                                href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png" 
                                                                target="_blank"
                                                                class="ml-1" style="text-decoration: none;">[1]
                                                            </a>
                                                    </div>
                                                </td>
                                            </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                </tbody>
            </table>

                    <div id="div_apt3_16_i_1_113_0" class="mt-1 div_detection_details">
                        <div class="w-100 text-right p-3">
                            <a href="javascript:void(0);" onclick="close_detection_detail(this)"><i class="fas fa-times" style="font-size: 30px;"></i></a>
                        </div>
                        <div class="mx-auto bg-white p-3 div_inner_detection_detail">
                            <p class="p_detection_detail_header"> Procedure </p>
                            <p class="detection_detail_text">
                                Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)
                            </p>
                                [1]
                                <br>
                                <a  href="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png"
                                    target="_blank"
                                    onmouseover="show_large_screenshot('img__16_i_1_113_0_0');"
                                    onmouseout="hide_large_screenshot('img__16_i_1_113_0_0');"
                                >
                                    <img src="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png" class="img_preview" />
                                    <img src="https://d1zq5d3dtjfcoj.cloudfront.net/EG-16-14.png" 
                                        class="img_big"
                                        id="img__16_i_1_113_0_0"
                                    />
                                </a>
                                <br>
                        </div>
                    </div>
        </div>
</div>

<script type="text/javascript">
    let current_detection_row_id;
    let current_detection_detail_id;
    let selected_adversaries;
    
    document.onload = load_initial();

    function load_initial() {
        // Check if there is a selected row and detail in the url.
        let url_string = window.location.href;
        let url_obj = new URL(url_string);
        let div_filter_btns = document.getElementById('div_filter_btns');

        current_detection_row_id = url_obj.hash ? url_obj.hash.slice(1).toLowerCase() : "";
        current_detection_detail_id = current_detection_row_id ? "div_" + current_detection_row_id : "";
        selected_adversaries = url_obj.searchParams.get("adversaries") ? url_obj.searchParams.get("adversaries").toLowerCase().split(',') : null;

        if (selected_adversaries) {
            for (let adversary of selected_adversaries) {
                document.getElementById('chk_' + adversary).checked = true;
                document.getElementById(`div_${adversary}_summary`).style.display = "flex";
            }
        }
        else {
            selected_adversaries = []
            for (let chk_btn_div of div_filter_btns.children) {
                chk_btn_div.firstElementChild.checked = true;
                document.getElementById(`div_${chk_btn_div.firstElementChild.getAttribute('data-adversary')}_summary`).style.display = "flex";
                selected_adversaries.push(chk_btn_div.firstElementChild.getAttribute('data-adversary'))
            }
        }

        appendSelectedAdversariesToPatternLinks();

        if (current_detection_detail_id) {
            show_detection_details(document.getElementById(current_detection_row_id));
        }
    }

    function update_query_string() {
        let url = window.location.href;
        let query_string = selected_adversaries.length > 0 ? '?adversaries=' + selected_adversaries.join(',') : url.split("?")[0].split("#")[0];

        if (current_detection_row_id) {
            query_string += '#' + current_detection_row_id;
        }

        window.history.replaceState({}, "", query_string);
    }

    function show_large_screenshot(big_img_id) {
        document.getElementById(big_img_id).style.display = "block";
    }

    function hide_large_screenshot(big_img_id) {
        document.getElementById(big_img_id).style.display = "none";
    }

    function show_detection_details(tr) {
        let substep = tr.getAttribute("data-substep");
        let detection_num = tr.getAttribute("data-detection_num");
        let adversary = tr.getAttribute("data-adversary");
        let new_detection_detail_id = "div_" + adversary + "_" + substep + "_" + detection_num;

        // Update the row styles and current id
        if (current_detection_row_id) {
            document.getElementById(current_detection_row_id).classList.remove('selected_row');
        }
        tr.classList.add('selected_row');
        current_detection_row_id = tr.id;

        // Update the detail styles and current id
        if (current_detection_detail_id) {
            document.getElementById(current_detection_detail_id).style.display = "none";
        }
        document.getElementById(new_detection_detail_id).style.display = "block";
        current_detection_detail_id = new_detection_detail_id;
    
        update_query_string();
    }

    function close_detection_detail(anchor) {
        let div_to_close = anchor.parentNode.parentNode;
        div_to_close.style.display = 'none';
        document.getElementById(current_detection_row_id).classList.remove('selected_row');

        current_detection_detail_id = "";
        current_detection_row_id = "";

        update_query_string();
    }

    function filterResultsByAdversary(div_filter_btns) {
        selected_adversaries = [];
        for (let div_chk of div_filter_btns.children) {
            let elem = div_chk.firstElementChild;
            if (elem.checked) {
                selected_adversaries.push(elem.getAttribute('data-adversary'));
                document.getElementById(`div_${elem.getAttribute('data-adversary')}_summary`).style.display = 'flex';
            }
            else {
                document.getElementById(`div_${elem.getAttribute('data-adversary')}_summary`).style.display = 'none';
            }
        }
        appendSelectedAdversariesToPatternLinks();
        update_query_string();
    }

    function appendSelectedAdversariesToPatternLinks() {
        let patternLinks = document.querySelectorAll(".a_attack_pattern_link");
        patternLinks.forEach(link => {
            urlAndFilters = link.href.split("=");
            urlAndFilters[urlAndFilters.length -1] = selected_adversaries.join(',')
            newPatternLink = urlAndFilters.join("=");
            link.href = newPatternLink;
        })
    }
</script>

</div>
</div>
<footer>
    <div class="container-fluid border-top pt-4 pb-4">
        <div class="row" style="width: 95%; margin: 0 auto;">
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <p class="footer-links-left"><a class="footer-links-left" href="/terms-of-use.html">Terms and Conditions</a></p>
                <p class="footer-links-left"><a class="footer-links-left" href="/privacy.html">Privacy Policy</a></p>
                <p class="footer-links-left">© 2018 - 2021, The MITRE Corporation and MITRE Engenuity.</p>
                <p class="footer-links-left">MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.</p>
            </div>
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <div class="footer-float-right-responsive">
                    <div class="mb-1">
                        <a href="https://twitter.com/MITREengenuity" class="btn btn-footer w-100">
                            <img src="https://d1zq5d3dtjfcoj.cloudfront.net/twitter.png" class="mr-1" style="vertical-align: top" width="20" height="20">
                            <b>@MITREengenuity</b>
                        </a>
                    </div>
                    <div class="">
                        <a href="/contact.html" class="btn btn-footer w-100">
                            Contact
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
    
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap.min.js"></script>
    <script src="/theme/scripts/site.js"></script>

    <script src="/theme/scripts/bootstrap-tourist.js"></script>
    
</body>

<!-- jjli -->

</html>