<!DOCTYPE html>
<html lang='en'>

<head>
    <script async src='https://www.googletagmanager.com/gtag/js?id=UA-62667723-5'></script><script src='/theme/scripts/analytics.js'></script>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='shortcut icon' href='https://d1zq5d3dtjfcoj.cloudfront.net/ME_icon.png' type='image/x-icon'>

    <link rel="stylesheet" href="/theme/style/all.css">

    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    
    <title>ATT&CK&reg; EVALUATIONS</title>
    <!-- Bootstrap CSS -->
    <link rel='stylesheet' href='/theme/style/bootstrap.min.css' />
    <link rel='stylesheet' href='/theme/style/bootstrap-glyphicon.min.css' />
    <link href="/theme/style/bootstrap-tourist.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/theme/style.min.css?780e9fe1">

 </head>

<body>
    <header class=''>
        <nav class='navbar navbar-expand-lg navbar-light fixed-top box-shadow-bottom bg-white'>
        <a class='navbar-brand' href='/'><img src='https://d1zq5d3dtjfcoj.cloudfront.net/MITRE_Engenuity_ATTACK-Evaluations_logo_PMS_purple.jpg' height="50px" alt=''></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse' aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
          <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
          <ul class='nav nav-tabs ml-auto mr-5'>
            <li class="dropdown-submenu ml-3">
               <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Enterprise</strong></a>
                <!-- <ul class="dropdown-menu dropleft"> -->
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href="/methodology-overview">
                            Methodology Overview
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href='/participant_comparison'>Compare Participants</a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href='/technique_comparison'>Explore Techniques</a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 130px;">
                            <li><a class="dropdown-item" href="/get-evaluated">Call for Participation</a></li>
                            <li><a class="dropdown-item" href="/enterprise/wizard-spider-and-sandworm/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Wizard Spider and <br> Sandworm (2021)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 180px;">
                            <li><a class="dropdown-item" href="/enterprise/participants/?adversaries=carbanak_fin7">Results</a></li>
                            <li><a class="dropdown-item" href="/enterprise/carbanak_fin7/">Overview</a></li>
                            </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Carbanak+FIN7 (2020)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 230px;">
                            <li><a class="dropdown-item" href="/enterprise/participants/?adversaries=apt29">Results</a></li>
                            <li><a class="dropdown-item" href="/enterprise/apt29">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT29 (2019)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 280px;">
                            <li><a class="dropdown-item" href="/enterprise/participants/?adversaries=apt3">Results</a></li>
                            <li><a class="dropdown-item" href="/enterprise/apt3">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT3 (2018)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href="/enterprise/participants/">
                            View All Participants
                        </a>
                    </li>
                </ul>
            </li>

            <li class="dropdown-submenu ml-3">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>ICS</strong></a>
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href='/participant_comparison_ics'>Compare Participants</a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href='/technique_comparison_ics'>Explore Techniques</a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 85px;">
                            <li><a class="dropdown-item" href="/ics/participants/">Results</a></li>
                            <li><a class="dropdown-item" href="/ics/triton/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            TRITON (2021)
                        </a>
                    </li>
                </ul>
            </li>
            <li class='nav-item dropdown ml-3'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Resources</strong></a>
                <!-- <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> -->
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/using-attack-evaluations">Using ATT&CK Evaluations</a>
                        <a class="dropdown-item" href="/about">About ATT&CK</a>
                        <a class="dropdown-item" href="/FAQ">FAQ</a>
                        <a class="dropdown-item" href='https://github.com/center-for-threat-informed-defense/adversary_emulation_library'>
                            Emulation Plan Library 
                            &nbsp;<i class="fas fa-external-link-alt"></i>
                        </a>
                        <a class="dropdown-item" href="https://mitre-engenuity.org/mad/https://mitre-engenuity.org/mad/https://mitre-engenuity.org/mad/">MITRE ATT&CK Defender Training&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i></a>
                        <a class="dropdown-item" href="https://mitre-engenuity.org/ctid/">Center for Threat-Informed Defense&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i></a>
                        <a class="dropdown-item" href="https://medium.com/mitre-engenuity/tagged/evaluation" target="_blank"> Blog</strong>&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i> </a>
                    </div>  
                </li> 
            <li class='nav-item ml-4'><button class="btn btn-sm btn-engenuity-purple mt-1" onclick="window.location.href='/get-evaluated'">Get Evaluated</button></li>
          </ul>
        </div>
    </nav>
</header>
<div id='content-width-lock'>
    <div id='content'><br>
<div class="divEvaluationSummaryBody">
    <div style="padding: 0px; width: 100%;"> 
        <span class="spanBreadcrumbs-results"> 
            <a href='/'>Home</a> &nbsp;>&nbsp; 
            <a href="/enterprise/apt29/">Enterprise APT29</a> &nbsp;>&nbsp; Operational Flow
        </span>
        <br>
        <br>
        <br>
	</div>
	<div class='divFAQBody'>
	   <div style="margin-top:20px; text-align: center;">
		  <h1>APT29 Evaluation: Operational Flow</h1>
	   </div>
	   <br />
	<p>
		The Operational Flow separated technique execution into sequences we referred to as “Steps”. Organizing our execution into Steps ensured that the detection displayed was correctly associated with the technique that was being tested. Each Step corresponded to an adversary’s intended goal during an operation. We performed 20 Steps in total across two scenarios: 10 Steps corresponded to our first scenario (which used Pupy, Meterpreter, and custom tooling), and 10 Steps corresponded to our second scenario (which used PoshC2 and custom tooling). We further divided each Step into Sub-Steps that are denoted by letters (e.g. 1A, 1B, etc.). Those Steps and the corresponding techniques are outlined below.
	</p>
	<p>
		This information is also available in a single, downloadable <a href="https://github.com/mitre-attack/attack-arsenal/blob/master/adversary_emulation/APT29/Emulation_Plan/APT29_EmuPlan.pdf">PDF document</a>.
	</p>
	<h3 class="mt-3">First Scenario</h3>
	<p>
		The content to execute this scenario was tested and developed using <a href="https://github.com/n1nj4sec/pupy" target="_blank">Pupy</a>, <a href="https://github.com/rapid7/metasploit-framework" target="_blank">Meterpreter</a>, and other custom/modified scripts and payloads. Pupy and Meterpreter were chosen based on their available functionality and similarities to the adversary's malware within the context of this scenario, but alternative red team tooling could be used to accurately execute these and other APT29 behaviors. More information, including the required resources, setup instructions, and step by step instructions on how to execute the Day 1 scenario, is available at <a href='https://github.com/mitre-attack/attack-arsenal/tree/master/adversary_emulation/APT29'>ATT&CK Arsenal</a>.
	</p>
	<p onclick="toggle_step_collapse(this, 'step1DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 1 - Initial Compromise: </span><a href="javascript:;">Malware is executed on victim; establishes C2 connection</a><test class="right"></i></p>		
	 <div id="step1DIV"  style="display:none">
	   <table class="table_opflow_step">
		   <thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
				   <th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
				   <th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
				   <th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
				   <th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
			   </tr>
		   </thead>
		   <tbody>
			   <tr>
				   <td class="td_opflow_step" style="text-align: left; width: 32%;">
					   The scenario begins with an initial breach, where a legitimate user clicks (<a href="https://attack.mitre.org/techniques/T1204/" target="_blank">T1204</a>) an executable payload (screensaver executable) masquerading as a benign word document (<a href="https://attack.mitre.org/techniques/T1036/" target="_blank">T1036</a>). Once executed, the payload creates a C2 connection over port 1234 (<a href="https://attack.mitre.org/techniques/T1065/" target="_blank">T1065</a>) using the RC4 cryptographic cipher . The attacker then uses the active C2 connection to spawn interactive cmd.exe (<a href="https://attack.mitre.org/techniques/T1059/" target="_blank">T1059</a>) and powershell.exe (<a href="https://attack.mitre.org/techniques/T1086/" target="_blank">T1086</a>) shells.
					</td>
				   <td class="td_opflow_step" style="text-align: left; width: 33%;">
						CosmicDuke’s infection payloads have started by tricking victims into opening a Windows executable whose filename is manipulated to look like an image file using the Right-to-Left Override (RLO) feature. CosmicDuke has also used RC4 to decrypt incoming data and encrypt outgoing data.<a href="https://www.f-secure.com/documents/996508/1030745/cosmicduke_whitepaper.pdf" target="_blank">[2]</a> SeaDuke and CozyDuke have used the RC4 cipher to encrypt data.<a href="https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/" target="_blank">[4]</a> <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a> <a href="https://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory" target="_blank">[13]</a> <a href="https://securelist.com/the-cozyduke-apt/69731/" target="_blank">[16]</a> CozyDuke can be used to spawn a command line shell. <a href="https://securelist.com/the-cozyduke-apt/69731/" target="_blank">[16]</a>
				   </td>
				   <td class="td_opflow_step" style="width: 5%;">
						Kaspersky
				   </td>
				   <td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file describes how to either use the precompiled cod.3aka3.scr or generate a custom payload (via payload_configs.md), as well as additional commands to complete the step.
				   </td>
			   </tr>
		   </tbody>
	   </table>
	  </div>
	  <p onclick="toggle_step_collapse(this, 'step2DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 2 - Collection and Exfiltration: </span><a href="javascript:;">Adversary performs smash-and-grab data theft</a><test class="right"></i></p>
	 <div id="step2DIV"  style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker runs a one-liner command to search for filesystem for document and media files (<a href="https://attack.mitre.org/techniques/T1083/" target="_blank">T1083</a>, <a href="https://attack.mitre.org/techniques/T1119/" target="_blank">T1119</a>), collecting (<a href="https://attack.mitre.org/techniques/T1005/" target="_blank">T1005</a>) and compressing (<a href="https://attack.mitre.org/techniques/T1002/" target="_blank">T1002</a>) content into a single file (<a href="https://attack.mitre.org/techniques/T1074/" target="_blank">T1074</a>). The file is then exfiltrated over the existing C2 connection (<a href="https://attack.mitre.org/techniques/T1041/" target="_blank">T1041</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CosmicDuke’s information stealing functionality included stealing user files with file extensions that match a predefined list.<a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf" target="_blank">[1]</a> <a href="https://www.f-secure.com/documents/996508/1030745/cosmicduke_whitepaper.pdf" target="_blank">[2]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file contains the commands to complete the step.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step3DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 3 - Deploy Stealth Toolkit: </span><a href="javascript:;">Adversary drops secondary malware, elevates privileges, and establishes new C2 connection</a><test class="right"></i></p>
	 <div id="step3DIV"  style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker now uploads a new payload (<a href="https://attack.mitre.org/techniques/T1105/" target="_blank">T1105</a>) to the victim. The payload is a legitimately formed image file with a concealed PowerShell script (<a href="https://attack.mitre.org/techniques/T1027/" target="_blank">T1027</a>). The attacker then elevates privileges via a user account control (UAC) bypass (<a href="https://attack.mitre.org/techniques/T1122/" target="_blank">T1122</a>, <a href="https://attack.mitre.org/techniques/T1088/" target="_blank">T1088</a>), which executes the newly added payload. A new C2 connection is established over port 443 (<a href="https://attack.mitre.org/techniques/T1043/" target="_blank">T1043</a>) using the HTTPS protocol (<a href="https://attack.mitre.org/techniques/T1071/" target="_blank">T1071</a>, <a href="https://attack.mitre.org/techniques/T1032/" target="_blank">T1032</a>). Finally, the attacker removes artifacts of the privilege escalation from the Registry (<a href="https://attack.mitre.org/techniques/T1112/" target="_blank">T1112</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CosmicDuke has occasionally embedded other malware components that are written to disk and executed. <a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf" target="_blank">[1]</a>
						<br><br>
						MiniDuke has transferred additional backdoors onto a system via GIF files.<a href="https://securelist.com/the-miniduke-mystery-pdf-0-day-government-spy-assembler-0x29a-micro-backdoor/31112/" target="_blank">[3]</a> SeaDaddy/SeaDuke may support HTTPS/SSL network communications. <a href="https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/" target="_blank">[4]</a> <a href="https://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory" target="_blank">[13]</a> 
						<br><br>
						APT29 has removed tools and forensic artifacts to hide activity, including the usage of Sdelete (<a href="https://attack.mitre.org/software/S0195/" target="_blank">S0195</a>). APT29 has also bypassed UAC to elevate privileges.<a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> 
						<br><br>
						HAMMERTOSS has embedded pictures with commands using steganography.<a href="https://www2.fireeye.com/rs/848-DID-242/images/rpt-apt29-hammertoss.pdf" target="_blank">[6]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
						<br>
						Microsoft
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file describes how to either use the prebuilt monkey.png or generate a custom payload (via payload_configs.md), as well as additional commands to complete the step.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step4DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 4 - Clean Up and Reconnaissance: </span><a href="javascript:;">Adversary drops new tools, cleans up artifacts of breach, and surveys the victim environment</a><test class="right"></i></p>
	 <div id="step4DIV"  style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker uploads additional tools (<a href="https://attack.mitre.org/techniques/T1086" target="_blank">T1086</a>) through the new, elevated access before spawning an interactive powershell.exe shell (<a href="https://attack.mitre.org/techniques/T1086" target="_blank">T1086</a>). The additional tools are decompressed (<a href="https://attack.mitre.org/techniques/T1140" target="_blank">T1140</a>) and positioned on the target for usage. The attacker then enumerates running processes (<a href="https://attack.mitre.org/techniques/T1057" target="_blank">T1057</a>) to discover/terminate the initial access from Step 1 before deleting various files (<a href="https://attack.mitre.org/techniques/T1107" target="_blank">T1107</a>) associated with that access. Finally, the attacker launches a PowerShell script that performs a wide variety of reconnaissance commands (<a href="https://attack.mitre.org/techniques/T1083" target="_blank">T1083</a>, <a href="https://attack.mitre.org/techniques/T1033" target="_blank">T1033</a>, <a href="https://attack.mitre.org/techniques/T1082" target="_blank">T1082</a>, <a href="https://attack.mitre.org/techniques/T1016" target="_blank">T1016</a>, <a href="https://attack.mitre.org/techniques/T1057" target="_blank">T1057</a>, <a href="https://attack.mitre.org/techniques/0" target="_blank">T1063</a>, <a href="https://attack.mitre.org/techniques/T1069" target="_blank">T1069</a>), some of which are done by accessing the Windows API (<a href="https://attack.mitre.org/techniques/T1106" target="_blank">T1106</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CozyDuke has been instructed to download and execute other executables, which in some cases included common hacking tools such as PSExec (<a href="https://attack.mitre.org/software/S0029/" target="_blank">S0029</a>). <a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf" target="_blank">[1]</a>
						<br><br>
						MiniDuke can download and execute new malware and lateral movement tools. <a href="https://securelist.com/the-miniduke-mystery-pdf-0-day-government-spy-assembler-0x29a-micro-backdoor/31112/" target="_blank">[3]</a> 
						<br><br>
						APT29 has removed tools and forensic artifacts to hide activity. <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a> <a href="https://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory" target="_blank">[13]</a> 
						<br><br>
						CozyDuke can be used to spawn a command line shell. <a href="https://securelist.com/the-cozyduke-apt/69731/" target="_blank">[16]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Microsoft 
						<br>
						Kaspersky
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file contains the commands to complete the step, including executing the Invoke-Discovery function within readme.txt.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step5DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 5 - Establish Persistence: </span><a href="javascript:;">Adversary establishes two separate means of persistent access to the victim</a><test class="right"></i></p>
	 <div id="step5DIV"  style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker establishes two distinct means of persistent access to the victim by creating a new service (<a href="https://attack.mitre.org/techniques/T1050/" target="_blank">T1050</a>) and creating a malicious payload in the Windows Startup folder (<a href="https://attack.mitre.org/techniques/T1060/" target="_blank">T1060</a>)
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CosmicDuke has installed a Windows service to achieve persistence on a system. <a href="https://www.f-secure.com/documents/996508/1030745/cosmicduke_whitepaper.pdf" target="_blank">[2]</a> 
						<br><br>
						SeaDuke has the ability to persist using a .lnk file stored in the Startup directory. <a href="https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/" target="_blank">[4]</a> 
						APT29 has used several persistence mechanisms, including .LNK files. <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file describes how to generate custom hostui.exe and javamtsup.exe payloads (via payload_configs.md), as well as additional commands to complete the step, including executing the Invoke-Persistence function within readme.txt.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step6DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 6 - Credential Access: </span><a href="javascript:;">Adversary gathers various forms of credential materials</a><test class="right"></i></p>
	 <div id="step6DIV"  style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker accesses credentials stored in a local web browser (<a href="https:/attack.mitre.org/techniques/T1081" target="_blank">T1081</a>, <a href="https:/attack.mitre.org/techniques/T1003" target="_blank">T1003</a>) using a tool renamed to masquerade as a legitimate utility (<a href="https:/attack.mitre.org/techniques/T1036" target="_blank">T1036</a>). The attacker then harvests private keys (<a href="https:/attack.mitre.org/techniques/T1145" target="_blank">T1145</a>) and password hashes (<a href="https:/attack.mitre.org/techniques/T1003" target="_blank">T1003</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CosmicDuke’s information stealing functionality has included exporting user’s cryptographic certificates, including private keys, and collecting user credentials, including passwords from web browsers (ex: Google Chrome). CozyDuke has contained modules that can steal NTLM hashes as well as capture screenshots. <a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf" target="_blank">[1]</a> <a href="https://www.f-secure.com/documents/996508/1030745/cosmicduke_whitepaper.pdf" target="_blank">[2]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file contains the commands to complete the step, including executing the Get-PrivateKeys function within readme.txt.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step7DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 7 - Collection and Exfiltration: </span><a href="javascript:;">Adversary collects data from victim user, exfiltrates data to attacker-controller infrastructure</a><test class="right"></i></p>
	 <div id="step7DIV"  style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker collects screenshots (<a href="https://attack.mitre.org/techniques/T1113/" target="_blank">T1113</a>), data from the user’s clipboard (<a href="https://attack.mitre.org/techniques/T1115/" target="_blank">T1115</a>), and keystrokes (<a href="https://attack.mitre.org/techniques/T1056/" target="_blank">T1056</a>). The attacker then collects files (<a href="https://attack.mitre.org/techniques/T1005/" target="_blank">T1005</a>), which are compressed (<a href="https://attack.mitre.org/techniques/T1002/" target="_blank">T1002</a>) and encrypted (<a href="https://attack.mitre.org/techniques/T1022/" target="_blank">T1022</a>), before being exfiltrated to an attacker-controlled WebDAV share (<a href="https://attack.mitre.org/techniques/T1048/" target="_blank">T1048</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CosmicDuke’s information stealing functionality has included keylogging, taking screenshots, and stealing clipboard contents. Collected data can be exfiltrated using WebDAV. <a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf" target="_blank">[1]</a> <a href="https://www.f-secure.com/documents/996508/1030745/cosmicduke_whitepaper.pdf" target="_blank">[2]</a> 
						<br><br>
						CozyDuke can be used to take screenshots of a full desktop window and encrypt collected data. <a href="https://securelist.com/the-cozyduke-apt/69731/" target="_blank">[16]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file contains the commands to complete the step, including executing the Invoke-ScreenCapture, Get-Clipboard, Get-Keystrokes, and Invoke-Exfil functions within psversion.txt.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step8DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 8 - Expand Access: </span><a href="javascript:;">Adversary enumerates then executes payload on a remote workstation</a><test class="right"></i></p>
	 <div id="step8DIV"  style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker uses Lightweight Directory Access Protocol (LDAP) queries to enumerate other hosts in the domain (<a href="https://attack.mitre.org/techniques/T1018" target="_blank">T1018</a>) before creating a remote PowerShell session to a secondary victim (<a href="https://attack.mitre.org/techniques/T1028" target="_blank">T1028</a>). Through this connection, the attacker enumerates running processes (<a href="https://attack.mitre.org/techniques/T1057" target="_blank">T1057</a>). Next, the attacker uploads a new UPX-packed payload (<a href="https://attack.mitre.org/techniques/T1045" target="_blank">T1045</a>) to the secondary victim. This new payload is executed on the secondary victim via the PSExec utility (<a href="https://attack.mitre.org/techniques/T1077" target="_blank">T1077</a>, <a href="https://attack.mitre.org/techniques/T1035" target="_blank">T1035</a>) using the previously stolen credentials (<a href="https://attack.mitre.org/techniques/T1078" target="_blank">T1078</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						SeaDuke has been written in Python and has been delivered through the CozyDuke toolkit. <a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf" target="_blank">[1]</a> <a href="https://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory" target="_blank">[13]</a> 
						<br><br>
						SeaDuke/SeaDaddy samples have been UPX-packed. <a href="https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/" target="_blank">[4]</a> <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> <a href="https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/" target="_blank">[12]</a> 
						<br><br>
						APT29 has UPX-packed and used SMB to transfer files. <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> APT29 has used UPX-packed, Python-compiled backdoors. <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Microsoft 
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file describes how to generate a custom python.exe payload (via payload_configs.md), as well as additional commands to complete the step, including executing the Ad-Search and Invoke-SeaDukeStage functions within psversion.txt.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step9DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 9 - Clean Up, Collection, and Exfiltration: </span><a href="javascript:;">Adversary drops new tools, performs smash-and-grab data theft, then cleans up artifacts of breach on a remote workstation</a><test class="right"></i></p>
	 <div id="step9DIV" style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker uploads additional utilities to the secondary victim (<a href="https://attack.mitre.org/techniques/T1105/" target="_blank">T1105</a>) before running a PowerShell one-liner command (<a href="https://attack.mitre.org/techniques/T1086/" target="_blank">T1086</a>) to search for filesystem for document and media files (<a href="https://attack.mitre.org/techniques/T1083/" target="_blank">T1083</a>, <a href="https://attack.mitre.org/techniques/T1119/" target="_blank">T1119</a>). Files of interested are collected (<a href="https://attack.mitre.org/techniques/T1005/" target="_blank">T1005</a>) then encrypted (<a href="https://attack.mitre.org/techniques/T1022/" target="_blank">T1022</a>) and compressed (<a href="https://attack.mitre.org/techniques/T1002/" target="_blank">T1002</a>) into a single file (<a href="https://attack.mitre.org/techniques/T1074/" target="_blank">T1074</a>). The file this then exfiltrated over the existing C2 connection (<a href="https://attack.mitre.org/techniques/T1041/" target="_blank">T1041</a>). Finally, the attacker deletes various files (<a href="https://attack.mitre.org/techniques/T1107/" target="_blank">T1107</a>) associated with that access
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CosmicDuke’s information stealing functionality has included stealing user files with file extensions that match a predefined list and exfiltrating collected data via HTTPS. SeaDuke can execute command such as uploading and downloading files. <a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf" target="_blank">[1]</a> <a href="https://www.f-secure.com/documents/996508/1030745/cosmicduke_whitepaper.pdf" target="_blank">[2]</a> MiniDuke can download and execute new malware and lateral movement tools. <a href="https://securelist.com/the-miniduke-mystery-pdf-0-day-government-spy-assembler-0x29a-micro-backdoor/31112/" target="_blank">[3]</a> SeaDuke has contained commands to download and Base-64-encode files. <a href="https://unit42.paloaltonetworks.com/unit-42-technical-analysis-seaduke/" target="_blank">[4]</a> APT29 has removed tools and forensic artifacts to hide activity, including the usage of Sdelete (<a href="https://attack.mitre.org/software/S0195/" target="_blank">S0195</a>). <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a> <a href="https://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory" target="_blank">[13]</a> SeaDaddy has used RAR to archive collected data. <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a> CozyDuke can be used to take screenshots of a full desktop window and encrypt collected data. <a href="https://securelist.com/the-cozyduke-apt/69731" target="_blank">[16]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
						<br>
						Microsoft
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file contains the commands to complete the step.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step10DIV')" id="hide_show" class="collapsed collapseShowCarrot"><span style="font-size: 18px;">Step 10 - Persistence Execution: </span><a href="javascript:;">Adversary persistence mechanisms are executed when the initial victim machine is rebooted</a><test class="right"></i></p>
	 <div id="step10DIV"  style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The original victim is rebooted and the legitimate user logs in, emulating ordinary usage and a passage of time. This activity triggers the previously established persistence mechanisms, namely the execution of the new service (<a href="https://attack.mitre.org/techniques/T1035/" target="_blank">T1035</a>) and payload in the Windows Startup folder (<a href="https://attack.mitre.org/techniques/T1060/" target="_blank">T1060</a>). The payload in the Startup folder executes a follow-on payload using a stolen token (<a href="https://attack.mitre.org/techniques/T1106/" target="_blank">T1106</a>, <a href="https://attack.mitre.org/techniques/T1134/" target="_blank">T1134</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CosmicDuke has installed persistence services that duplicate and uses the process token of explorer.exe to start the malware. <a href="https://www.f-secure.com/documents/996508/1030745/cosmicduke_whitepaper.pdf" target="_blank">[2]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 1 README.md file contains the commands to complete the step.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	<br>
	<h3>Second Scenario</h3>
	<p>
		The content to execute this scenario was tested and developed using <a href="https://github.com/nettitude/PoshC2" target="_blank">PoshC2</a> and other custom/modified scripts and payloads. PoshC2 was chosen based on its available functionality and similarities to the adversary's malware within the context of this scenario, but alternative red team tooling could be used to accurately execute these and other APT29 behaviors. More information, including the required resources, setup instructions, and step by step instructions on how to execute the Day 2 scenario, is available at <a href="https://github.com/mitre-attack/attack-arsenal/tree/master/adversary_emulation/APT29" target="_blank">ATT&CK Arsenal</a>.
	</p>
	  	  <p onclick="toggle_step_collapse(this, 'step11DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 11 - Initial Compromise: <a href="javascript:;">Malware is executed on victim; surveys victim then establishes persistence access and C2 connection</a><test class="right"></i></p>
	 <div id="step11DIV"  style="display:none">
	    <table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The scenario begins with initial breach, where a legitimate user clicks (<a href="https://attack.mitre.org/techniques/T1204/" target="_blank">T1204</a>) a link file payload, which executes an alternate data stream (ADS) hidden on another dummy file (T1096) delivered as part of the spearphishing campaign. The ADS performs a series of enumeration commands to ensure it is not executing in a virtualized analysis environment (<a href="https://attack.mitre.org/techniques/T1497/" target="_blank">T1497</a>, <a href="https://attack.mitre.org/techniques/T1082/" target="_blank">T1082</a>, <a href="https://attack.mitre.org/techniques/T1120/" target="_blank">T1120</a>, <a href="https://attack.mitre.org/techniques/T1033/" target="_blank">T1033</a>, <a href="https://attack.mitre.org/techniques/T1016/" target="_blank">T1016</a>, <a href="https://attack.mitre.org/techniques/T1057/" target="_blank">T1057</a>, <a href="https://attack.mitre.org/techniques/T1083/" target="_blank">T1083</a>) before establishing persistence via a Windows Registry Run key entry (<a href="https://attack.mitre.org/techniques/T1060/" target="_blank">T1060</a>) pointing to an embedded DLL payload that was decoded and dropped to disk (<a href="https://attack.mitre.org/techniques/T1140/" target="_blank">T1140</a>). The ADS then executes a PowerShell stager (<a href="https://attack.mitre.org/techniques/T1086/" target="_blank">T1086</a>) which creates a C2 connection over port 443 (<a href="https://attack.mitre.org/techniques/T1043/" target="_blank">T1043</a>) using the HTTPS protocol (<a href="https://attack.mitre.org/techniques/T1071/" target="_blank">T1071</a>, <a href="https://attack.mitre.org/techniques/T1032/" target="_blank">T1032</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						APT29 has used several persistence mechanisms, including, Registry run keys. <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/" target="_blank">[11] </a>
						<br><br>
						APT29 phishing campaigns have contained weaponized Windows shortcut files that executed an obfuscated PowerShell command from within the file and dropped a DLL to the victim’s system.<a href="https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html" target="_blank">[8]</a> <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos" target="_blank">[11]</a> <a href="https://www.microsoft.com/security/blog/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers" target="_blank">[17]</a> 
						<br><br>
						PowerDuke has performed anti-VM checks designed to avoid executing in virtualized environments. PowerDuke payloads have also contained a component hidden in an ADS and connected to C2 over port 443. <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/" target="_blank">[11] </a>
						<br><br>
						Note: The anti-analysis commands and logic were derived from a VirusTotal submission.<a href="https://www.virustotal.com/gui/file/2f39dee2ee608e39917cc022d9aae399959e967a2dd70d83b81785a98bd9ed36/detection" target="_blank">[9]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Microsoft
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file describes how to configure the schemas.ps1, 2016_United_States_presidential_election_-_Wikipedia.html and 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk payloads, as well as additional commands to complete the step.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step12DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 12 - Fortify Access: <a href="javascript:;">Adversary attempts to hide artifacts of breach, enumerates victim software</a><test class="right"></i></p>
	 <div id="step12DIV" style="display:none">
	  	<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker modifies the time attributes of the DLL payload (<a href="https://attack.mitre.org/techniques/T1099" target="_blank">T1099</a>) used in the previously established persistence mechanism to match that of a random file found in the victim’s System32 directory (<a href="https://attack.mitre.org/techniques/T1083" target="_blank">T1083</a>). The attacker then enumerates registered AV products (<a href="https://attack.mitre.org/techniques/T1063" target="_blank">T1063</a>) and software installed by the user documented in the Windows Registry (<a href="https://attack.mitre.org/techniques/T1012" target="_blank">T1012</a>)
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						POSHSPY can modify standard information timestamps of downloaded executables to match a randomly selected file from the System32 directory. PowerDuke also has had undescribed commands named “detectav” and “software.” <a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html" target="_blank">[10]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file contains the commands to complete the step, including executing the timestomp function within timestomp.ps1 and the detectav and software functions within stepTwelve.ps1.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step13DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 13 - Reconnaissance: <a href="javascript:;">Adversary surveys the victim environment</a><test class="right"></i></p>
	 <div id="step13DIV" style="display:none">
		<table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker performs local enumeration using various Windows API calls, specifically gathering the local computer name (<a href="https://attack.mitre.org/techniques/T1082" target="_blank">T1082</a>), domain name (<a href="https://attack.mitre.org/techniques/T1063" target="_blank">T1063</a>), current user context (<a href="https://attack.mitre.org/techniques/T1033" target="_blank">T1033</a>), and running processes (<a href="https://attack.mitre.org/techniques/T1057" target="_blank">T1057</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						PowerDuke can get the NetBIOS name, the computer’s domain name, user’s name, and process list via select Windows API calls. <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos" target="_blank">[11]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">

					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file contains the commands to complete the step, including executing the comp, domain, user, and pslist functions within stepThirteen.ps1.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step14DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 14 - Elevation & Credential Access: <a href="javascript:;">Adversary elevates privileges and dumps credential materials</a><test class="right"></i></p>
	 <div id="step14DIV" style="display:none">
	   <table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker elevates privileges via a user account control (UAC) bypass (<a href="https://attack.mitre.org/techniques/T1122" target="_blank">T1122</a>, <a href="https://attack.mitre.org/techniques/T1088" target="_blank">T1088</a>). The attacker then uses the new elevated access to create and execute code within a custom WMI class (<a href="https://attack.mitre.org/techniques/T1047" target="_blank">T1047</a>) that downloads (<a href="https://attack.mitre.org/techniques/T1105" target="_blank">T1105</a>) and executes Mimikatz to dump plain-text credentials (<a href="https://attack.mitre.org/techniques/T1003" target="_blank">T1003</a>), which are parsed, encoded, and stored in the WMI class (<a href="https://attack.mitre.org/techniques/T1027" target="_blank">T1027</a>). After tracking that the WMI execution has completed (<a href="https://attack.mitre.org/techniques/T1057" target="_blank">T1057</a>), the attacker reads the plaintext credentials stored within the WMI class (<a href="https://attack.mitre.org/techniques/T1140" target="_blank">T1140</a>)
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						APT29 has embedded and encoded PowerShell scripts in WMI class properties. <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> <a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html" target="_blank">[10]</a> APT29 has bypassed UAC to elevate privileges. <a href="https://www.slideshare.net/</a>MatthewDunwoody1/no-easy-breach-derby-con-201" target="_blank">[5]</a> APT29 has used WMI to store and run Invoke-Mimikatz (<a href="https://attack.mitre.org/software/S0002" target="_blank">S0002</a>) on remote hosts. <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a> <a href="https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/" target="_blank">[12]</a> POSHSPY has used WMI to both store and persist PowerShell backdoor code. POSHSPY can also download and execute additional PowerShell code and Windows binaries. <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a> <a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html" target="_blank">[10] <a href="https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/" target="_blank">[12]</a></a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Microsoft
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file describes how to configure the stepFourteen_bypassUAC.ps1 and stepFourteen_credDump.ps1 payloads, as well as additional commands to complete the step, including executing the bypass function within stepFourteen_bypassUAC.ps1 and the wmidump function within stepFourteen_credDump.ps1.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step15DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 15 - Establish Persistence: <a href="javascript:;">Adversary establishes a secondary means of persistent access to the victim</a><test class="right"></i></p>
	 <div id="step15DIV" style="display:none">
	   <table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker establishes a secondary means of persistent access to the victim by creating a WMI event subscription (<a href="https://attack.mitre.org/techniques/T1084/" target="_blank">T1084</a>) to execute a PowerShell payload whenever the current user (<a href="https://attack.mitre.org/techniques/T1033/" target="_blank">T1033</a>) logs in
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						APT29 has used several persistence mechanisms, including WMI backdoors that execute PowerShell components. <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> <a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html" target="_blank">[10]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Microsoft
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file describes how to configure the stepFifteen_wmi.ps1 payload, as well as additional commands to complete the step, including executing the wmi function within stepFifteen_wmi.ps1
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step16DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 16 - Expand Access: <a href="javascript:;">Adversary enumerates then dumps credential materials from domain controller</a><test class="right"></i></p>
	 <div id="step16DIV"  style="display:none">
	   <table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker enumerates the environment’s domain controller (<a href="https://attack.mitre.org/techniques/T1018" target="_blank">T1018</a>) and the domain’s security identifier (SID) (<a href="https://attack.mitre.org/techniques/T1033" target="_blank">T1033</a>) via the Windows API (<a href="https://attack.mitre.org/techniques/T1106" target="_blank">T1106</a>). Next, the attacker uses the previously dumped credentials (<a href="https://attack.mitre.org/techniques/T1078" target="_blank">T1078</a>) to create a remote PowerShell session to the domain controller (<a href="https://attack.mitre.org/techniques/T1028" target="_blank">T1028</a>). Through this connection, the attacker copies the Mimikatz binary used in Step 14 to the domain controller (<a href="https://attack.mitre.org/techniques/T1105" target="_blank">T1105</a>) then dumps the hash of the KRBTGT account (<a href="https://attack.mitre.org/techniques/T1003" target="_blank">T1003</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						PowerDuke can get the current user’s SID via select Windows API calls. <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos" target="_blank">[11]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Microsoft
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file contains the commands to complete the step, including executing the Get-NetDomainController function within powerView.ps1, the siduser function within stepSixteen_SID.ps1, and the Invoke-WinRMSession function within Invoke-WinRMSession.ps1
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step17DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 17 - Collection: <a href="javascript:;">Adversary collects, stages, and obfuscates data from victim user</a><test class="right"></i></p>
	 <div id="step17DIV" style="display:none">
	   <table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker harvests emails stored in the local email client (<a href="https://attack.mitre.org/techniques/T1114" target="_blank">T1114</a>) before collecting (<a href="https://attack.mitre.org/techniques/T1005" target="_blank">T1005</a>) and staging (<a href="https://attack.mitre.org/techniques/T1074" target="_blank">T1074</a>) a file of interest. The staged file is compressed (<a href="https://attack.mitre.org/techniques/T1002" target="_blank">T1002</a>) as well as prepended with the magic bytes of the GIF file type (<a href="https://attack.mitre.org/techniques/T1027" target="_blank">T1027</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						APT29 has used the legit Microsoft DLL and PowerShell to interact with Exchange Web Services (EWS) for email theft. <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a>
						<br><br>
						POSHSPY can appended a file signature header to all encrypted data prior to upload or download. <a href="https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html" target="_blank">[10]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
						<br>
						Microsoft
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file contains the commands to complete the step, including executing the psemail function within stepSeventeen_email.ps1 and the zip function within stepSeventeen_zip.ps1.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step18DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 18 - Exfiltration: <a href="javascript:;">Adversary exfiltrates data to attacker-controller web infrastructure</a><test class="right"></i></p>
	 <div id="step18DIV" style="display:none">
	   <table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker maps a local drive to an online web service account (<a href="https://attack.mitre.org/techniques/T1102/" target="_blank">T1102</a>) then exfiltrates the previous staged data to this repository (<a href="https://attack.mitre.org/techniques/T1048/" target="_blank">T1048</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						CloudDuke can use a Microsoft OneDrive to exchange stolen data with its operators. <a href="https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf" target="_blank">[1]</a> <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Kaspersky
						<br>
						Microsoft
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file contains the commands to complete the step.
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step19DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 19 - Clean Up: <a href="javascript:;">Adversary cleans up artifacts of breach</a><test class="right"></i></p>
	 <div id="step19DIV" style="display:none">
	   <table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The attacker deletes various files (<a href="https://attack.mitre.org/techniques/T1107/" target="_blank">T1107</a>) associated with that access by reflectively loading and executing the Sdelete binary (<a href="https://attack.mitre.org/techniques/T1055/" target="_blank">T1055</a>) within powershell.exe
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						APT29 has removed tools and forensic artifacts to hide activity, including the usage of Sdelete (<a href="https://attack.mitre.org/software/S0195/" target="_blank">S0195</a>). <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016">[5]</a> PowerDuke can write random data across then delete a file. <a href="https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos" target="_blank">[11]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Microsoft
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file contains the commands to complete the step, including executing the wipe function within wipe.ps1.
					</td>
				</tr>
			</tbody>
			<caption align="bottom" style="text-align: left;"><em>Step 19 was excluded from the evaluation due to execution inconsistencies.</em></caption>
		</table>

	  </div>
	  	  <p onclick="toggle_step_collapse(this, 'step20DIV')" id="hide_show" class="collapsed collapseShowCarrot">Step 20 - Persistence Execution: <a href="javascript:;">Adversary persistence mechanisms are executed when the initial victim machine is rebooted, access is used to create credential material and access new victim workstation</a><test class="right"></i></p>
	 <div id="step20DIV"  style="display:none">
	   <table class="table_opflow_step">
			<thead>
				<tr style="background-color: lightgray; border-bottom: 1px solid black;">
					<th class="th_opflow_step" style="width: 32%;">High Level Overview of Emulation and Techniques Evaluated</th>
					<th class="th_opflow_step" style="width: 33%;">Cited Intelligence</th>
					<th class="th_opflow_step" style="width: 5%;">Open Invitation Contributor(s)</th>
					<th class="th_opflow_step" style="width: 20%; border-right: none;">Emulation Content</th>
				</tr>
			</thead>
			<tbody>
				<tr>					
					<td class="td_opflow_step" style="text-align: left; width: 32%;">
						The original victim is rebooted and the legitimate user logs in, emulating ordinary usage and a passage of time. This activity triggers the previously established persistence mechanisms, namely the execution of the DLL payload (<a href="https://attack.mitre.org/techniques/T1085/" target="_blank">T1085</a>), referenced by the Windows Registry Run key, and the WMI event subscription (<a href="https://attack.mitre.org/techniques/T1084/" target="_blank">T1084</a>), which executes a new PowerShell stager (<a href="https://attack.mitre.org/techniques/T1086/" target="_blank">T1086</a>). The attacker uses the renewed access to generate a Kerberos Golden Ticket (<a href="https://attack.mitre.org/techniques/T1097/" target="_blank">T1097</a>), using materials from the earlier breach, which is used to establish a remote PowerShell session to a new victim (<a href="https://attack.mitre.org/techniques/T1028/" target="_blank">T1028</a>). Through this connection, the attacker creates a new account within the domain (<a href="https://attack.mitre.org/techniques/T1136/" target="_blank">T1136</a>).
					</td>
					<td class="td_opflow_step" style="text-align: left; width: 33%;">
						APT29 have used Kerberos ticket attacks for lateral movement and has created accounts to log in. <a href="https://www.slideshare.net/MatthewDunwoody1/no-easy-breach-derby-con-2016" target="_blank">[5]</a> <a href="https://www.fireeye.com/blog/products-and-services/2019/02/state-of-the-hack-no-easy-breach-revisited.html" target="_blank">[7]</a>
					</td>
					<td class="td_opflow_step" style="width: 5%;">
						Microsoft
						<br>
						SentinelOne
					</td>
					<td class="td_opflow_step" style="border-right: none; text-align: left; width: 20%;">
						The Day 2 README.md file contains the commands to complete the step, including executing the Invoke-Mimikatz function within Invoke-Mimikatz.ps1
					</td>
				</tr>
			</tbody>
		</table>
	  </div>
	  <br>
		<div class="mx-auto">
			<a class="btn btn-lg btn-engenuity-purple float-left" href="/enterprise/apt29/" role="button">&laquo; APT29 Overview</a>
			<a class="btn btn-lg btn-engenuity-purple float-right" href="/enterprise/apt29/scope" role="button">APT29 Technique Scope &raquo;</a>
		</div>	
		<br><br>
	</div>
</div>
<br><br>
<script>
	function toggle_step_collapse(p_clicked, id){
		$("#"+id).slideToggle();
		if(p_clicked.classList.contains('collapsed')) {
			p_clicked.classList.remove('collapsed');
		} else {
			p_clicked.classList.add('collapsed');
		}
	}
</script>
</div>
</div>
<footer>
    <div class="container-fluid border-top pt-4 pb-4">
        <div class="row" style="width: 95%; margin: 0 auto;">
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <p class="footer-links-left"><a class="footer-links-left" href="/terms-of-use">Terms and Conditions</a></p>
                <p class="footer-links-left"><a class="footer-links-left" href="/privacy">Privacy Policy</a></p>
                <p class="footer-links-left">© 2018 - 2021, The MITRE Corporation and MITRE Engenuity.</p>
                <p class="footer-links-left">MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.</p>
            </div>
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <div class="footer-float-right-responsive">
                    <div class="mb-1">
                        <a href="https://twitter.com/MITREengenuity" class="btn btn-footer w-100">
                            <img src="https://d1zq5d3dtjfcoj.cloudfront.net/twitter.png" class="mr-1" style="vertical-align: top" width="20" height="20">
                            <b>@MITREengenuity</b>
                        </a>
                    </div>
                    <div class="">
                        <a href="/contact" class="btn btn-footer w-100">
                            Contact
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
    
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap.min.js"></script>
    <script src="/theme/scripts/site.js"></script>

    <script src="/theme/scripts/bootstrap-tourist.js"></script>
    
</body>

<!-- jjli -->

</html>