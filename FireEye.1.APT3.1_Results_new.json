{"PublicRelease": "\u00a92019 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-00646-3", "Techniques": [{"TechniqueId": "T1126", "TechniqueName": "Network Share Connection Removal", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed net.exe executing with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-16.C.1-1.png", "ScreenshotCaption": "Telemetry showed net.exe executing with command-line arguments."}, {"ScreenshotName": "FE-16.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker unmounted the share from CodeRed. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.C.1-1.png", "ScreenshotCaption": "Telemetry showed net.exe executing with command-line arguments."}, {"ScreenshotName": "FE-16.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1026", "TechniqueName": "Multiband Communication", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Detections": [{"DetectionNote": "Telemetry showed a combination of both DNS requests as well as HTTP requests, which could indicate multiband communication.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified C2 communication over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-6.B.1-2.png", "ScreenshotCaption": "Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Detections": [{"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor was configured to communicate with freegoogleadsenseinfo.com (C2 domain) over HTTPS.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Detections": [{"DetectionNote": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-4.C.1-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)"}, {"ScreenshotName": "FE-4.C.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about netstat"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that netstat was a reconnaissance command used to enumerate active and listening network ports. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-4.C.1-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)"}, {"ScreenshotName": "FE-4.C.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about netstat"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Detections": [{"DetectionNote": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connection Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified netstat.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.E.1.12-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.B.2-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified netstat.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.B.2-1.png", "ScreenshotCaption": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1132", "TechniqueName": "Data Encoding", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Detections": [{"DetectionNote": "Telemetry showed base64-encoded DNS requests to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the parent Cobalt Strike DNS Beacon alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-1.C.1-2.png", "ScreenshotCaption": "Telemetry showing encoded DNS requests (tainted by parent Cobalt Strike DNS Beacon alert)"}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Detections": [{"DetectionNote": "The capability enriched ipconfig.exe with an alert for Ipconfig Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)"}, {"ScreenshotName": "FE-2.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that ipconfig.exe was one of the reconnaissance commands performed to enumerate the network configuration of Nimda. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.A.1-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)"}, {"ScreenshotName": "FE-2.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Detections": [{"DetectionNote": "The capability enriched arp.exe with an alert for Arp Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.A.1-2.png", "ScreenshotCaption": "Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)"}, {"ScreenshotName": "FE-2.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about arp.exe execution"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that arp.exe was one of the reconnaissance commands performed to enumerate the network configuration of Nimda. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.A.1-2.png", "ScreenshotCaption": "Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)"}, {"ScreenshotName": "FE-2.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about arp.exe execution"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Detections": [{"DetectionNote": "The capability enriched netsh.exe with an alert for Netsh Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1063 - Security Software Discovery) and the correct Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-4.B.1-1.png", "ScreenshotCaption": "Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)"}, {"ScreenshotName": "FE-4.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about netsh"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that netsh was a reconnaissance command used to obtain network configuration and the configuration profile of the Windows Firewall. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-4.B.1-1.png", "ScreenshotCaption": "Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)"}, {"ScreenshotName": "FE-4.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about netsh"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched route.exe with an alert for Route Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified route.exe as a reconnaissance command used.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-1.png", "ScreenshotCaption": "Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched ipconfig.exe with an alert for Ipconfig Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified ipconfig.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.2-1.png", "ScreenshotCaption": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1039", "TechniqueName": "Data from Network Shared Drive", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Detections": [{"DetectionNote": "The capability enriched systeminfo.exe with an alert for Systeminfo Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1082 - System Information Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.E.1-1.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)"}, {"ScreenshotName": "FE-2.E.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about systeminfo"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified systeminfo as a reconnaissance command used to obtain details from the system.[FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.E.1-1.png", "ScreenshotCaption": "Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)"}, {"ScreenshotName": "FE-2.E.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about systeminfo"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Config Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1082 - System Information Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.E.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.E.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net config as a reconnaissance command performed. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.E.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.E.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1010", "TechniqueName": "Application Window Discovery", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Detections": [{"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified a process injection from PowerShell.exe to cmd.exe. [FE5][FE11]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-3.C.1-1.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying a process injection from PowerShell.exe to cmd.exe (Specific Behavior)"}, {"ScreenshotName": "FE-3.C.1-2.png", "ScreenshotCaption": "Continued excerpt from the Managed Defense Report showing the artifact evidence of a process injection from PowerShell.exe to cmd.exe"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", " The vendor stated the process injection detection capability is a HX plugin that is only available within the Managed Defense Service, and the data is reported to  a separate cloud server which is not accessible to customers at this time."]}]}, {"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1061", "TechniqueName": "Graphical User Interface", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Detections": [{"DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe spawning lusrmgr.exe"}]}]}]}, {"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "The capability enriched the RDP connection from rundll32.exe with an alert for RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-6.C.1-1.png", "ScreenshotCaption": "Enrichment of RDP connection from rundll32.exe with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}]}]}, {"SubStep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "Telemetry showed a Logon Type 10 (interactive) event for the account Jesse logging on to Conficker.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-10.B.1-1.png", "ScreenshotCaption": "Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-10.B.1-4.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)"}]}, {"DetectionNote": "The capability enriched a TCP port 3389 connection to 10.0.0.5 (Conficker) with the alert RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-10.B.1-1.png", "ScreenshotCaption": "Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-10.B.1-4.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the user account Jesse logged on to Conficker via Remote Desktop Protocol. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-10.B.1-1.png", "ScreenshotCaption": "Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-10.B.1-4.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "The capability enriched a TCP port 3389 connection with an alert for RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-20.A.1-1.png", "ScreenshotCaption": "Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the use of the Remote Desktop Protocol to connect to Creeper.[FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-20.A.1-1.png", "ScreenshotCaption": "Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \"\\\\conficker\\wormshare\"' via cmd", "Detections": [{"DetectionNote": "The capability enriched cmd.exe executing dir with an alert for Dir Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-8.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing dir with Dir Command alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and, Tactic, Discovery)"}]}]}, {"SubStep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "Detections": [{"DetectionNote": "The capability enriched cmd.exe executing tree with an alert for Tree Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-8.A.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)"}, {"ScreenshotName": "FE-7.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)"}, {"ScreenshotName": "FE-8.A.1-4.png", "ScreenshotCaption": "Excerpt from Managed Defense Report showing additional details about tree"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker performed a directory listing of the contents of Debbie's user profile directory. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-8.A.1-2.png", "ScreenshotCaption": "Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)"}, {"ScreenshotName": "FE-7.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)"}, {"ScreenshotName": "FE-8.A.1-4.png", "ScreenshotCaption": "Excerpt from Managed Defense Report showing additional details about tree"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "No detection capability identified for this procedure.", "DetectionType": "None"}]}, {"SubStep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "Telemetry showed the file write for updater.dll into the system32 folder. The telemetry was tainted by the parent AV signature alert for updater.dll.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-7.B.1-1.png", "ScreenshotCaption": "Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105 \u00a0- Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, {"ScreenshotName": "FE-7.B.1-2.png", "ScreenshotCaption": "Telemetry showing updater.dll file write (tainted by parent AV signature alert)"}]}, {"DetectionNote": "The capability enriched updater.dll being written by cmd.exe with an alert for CMD File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105\u00a0- Remote File Copy) and a related ATT&CK Technique (T1059 - Command-Line Interface) and Tactic (Execution).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-7.B.1-1.png", "ScreenshotCaption": "Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105 \u00a0- Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, {"ScreenshotName": "FE-7.B.1-2.png", "ScreenshotCaption": "Telemetry showing updater.dll file write (tainted by parent AV signature alert)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Detections": [{"DetectionNote": "The capability enriched a HTTP GET request for wdbypass with an alert for PowerShell URL Request (Weak Signal). The alert also was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactic (Command and Control).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-14.A.1-4.png", "ScreenshotCaption": "Enrichment of HTTP GET request for wdbypass with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy, and Tactic, Command and Control)"}]}]}, {"SubStep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "The capability enriched powershell.exe writing autoupdate.vbs with an alert for PowerShell File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactics (Command and Control, Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.E.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy) and Tactics, Command and Control and Lateral Movement)"}, {"ScreenshotName": "FE-16.E.1-2.png", "ScreenshotCaption": "Additional details on enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert"}]}]}, {"SubStep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "The capability enriched powershell.exe writing update.vbs with an alert for File Write to Network Share (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactic (Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.G.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert"}, {"ScreenshotName": "FE-16.G.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the autoupdate.vbs script being written to Creeper. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.G.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert"}, {"ScreenshotName": "FE-16.G.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "The capability enriched powershell.exe writing recycler.exe with an alert for PowerShell File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactics (Command and Control, Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-19.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)"}, {"ScreenshotName": "FE-19.A.1-2.png", "ScreenshotCaption": "Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it indicated the attacker placed recycler.exe on the system.[FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-19.A.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)"}, {"ScreenshotName": "FE-19.A.1-2.png", "ScreenshotCaption": "Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Detections": [{"DetectionNote": "Telemetry from Conficker showed the creation of the new user Jesse.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of user Jesse"}, {"ScreenshotName": "FE-7.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the creation of a local user account for Jesse on Conficker. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of user Jesse"}, {"ScreenshotName": "FE-7.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1135", "TechniqueName": "Network Share Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Detections": [{"DetectionNote": "The capability enriched a TCP port 21 connection to 192.168.0.4 (C2 server) with an alert for FTP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1048 - Exfiltration Over Alternative Protocol) and Tactic (Exfiltration).", "DetectionType": "Enrichment"}, {"DetectionNote": "The capability enriched ftp.exe execution with an alert for FTP Utility Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Software (T0095 - FTP).", "DetectionType": "Enrichment"}, {"DetectionNote": "The capability enriched ftp.exe with the -s argument with a separate alert for FTP Utility Execution (Weak Signal).", "DetectionType": "Enrichment"}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed the ftp commands being written to ftp.txt and the subsequent execution of ftp.exe with the file. The old.rar file was seen uploaded to 192.168.0.4 (C2 server). [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "A Specific Behavior alert was generated on the file write of the .vsdx named File Write To Root Of Recycle Bin (Weak Signal). The alert details explained how all legitimate files should be written to a subfolder of the recycle bin, and not to the root.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "FE-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert"}, {"ScreenshotName": "FE-18.B.1-2.png", "ScreenshotCaption": "Additional telemetry showing file write of .vsdx with PowerShell File Write alert"}, {"ScreenshotName": "FE-18.B.1-3.png", "ScreenshotCaption": "Specific Behavior alert for File Write to Root of Recycle Bin"}]}, {"DetectionNote": "Telemetry showed the creation of the .vsdx file in the Recycle Bin. The telemetry was tainted by the parent PowerShell File Write alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-18.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert"}, {"ScreenshotName": "FE-18.B.1-2.png", "ScreenshotCaption": "Additional telemetry showing file write of .vsdx with PowerShell File Write alert"}, {"ScreenshotName": "FE-18.B.1-3.png", "ScreenshotCaption": "Specific Behavior alert for File Write to Root of Recycle Bin"}]}]}]}, {"TechniqueId": "T1201", "TechniqueName": "Password Policy Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Detections": [{"DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.D.1-2.png", "ScreenshotCaption": "Additional details from enrichment of sc.exe"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)"}, {"ScreenshotName": "FE-2.D.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about sc"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that sc was one of the commands used to enumerate current running services. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.D.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.D.1-2.png", "ScreenshotCaption": "Additional details from enrichment of sc.exe"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)"}, {"ScreenshotName": "FE-2.D.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about sc"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Start Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.D.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)"}, {"ScreenshotName": "FE-2.D.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that net was one of the commands used to enumerate current running services. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.D.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)"}, {"ScreenshotName": "FE-2.D.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Start Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.D.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.D.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). [FE7]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.H.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}], "Footnotes": [" All five of the sc.exe events are rolled under the same SC Execution alert."]}]}, {"SubStep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).[FE7]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.J.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}], "Footnotes": [" All five of the sc.exe events are rolled under the same SC Execution alert."]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Detections": [{"DetectionNote": "Telemetry showed reg.exe executing with command-line arguments to check if terminal services are enabled. The telemetry was tainted by the parent Reg Execution (Weak Signal) alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-17.A.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments (tainted by parent Reg Execution alert)"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Detections": [{"DetectionNote": "A General Behavior alert was generated for the Resume Viewer.exe file due to it being labeled as malicious by a machine learning engine. The alert was generated after a configuration change of the file size limit for the machine learning engine. [FE1][FE2]", "DetectionType": "General Behavior", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-1.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)"}, {"ScreenshotName": "FE-1.A.1-5.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe being executed by explorer.exe"}], "Footnotes": [" The vendor reported that this file would have been quarantined and prevented from executing.  ", "The scan type used to produce this alert is On-access, which means the scan occurs on file writes and executions."]}, {"DetectionNote": "Telemetry showed Resume Viewer.exe executing with a parent process of explorer.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-1.A.1-1.png", "ScreenshotCaption": "General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)"}, {"ScreenshotName": "FE-1.A.1-5.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe being executed by explorer.exe"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Detections": [{"DetectionNote": "Telemetry showed the use of echo with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)"}, {"ScreenshotName": "FE-2.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about echo"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that echo was one of the commands used to enumerate the current username. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.B.1-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)"}, {"ScreenshotName": "FE-2.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about echo"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched whoami.exe with an alert for Whoami Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified whoami.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed whoami.exe executing from magnify.exe within an alert for Accessibility Features Child Process. The telemetry was tainted by the Accessibility Features Child Process (METHODOLOGY) alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)"}, {"ScreenshotName": "FE-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}]}, {"DetectionNote": "The capability enriched whoami.exe with an alert for Whoami Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)"}, {"ScreenshotName": "FE-20.A.1-6.png", "ScreenshotCaption": "Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Detections": [{"DetectionNote": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)"}, {"ScreenshotName": "FE-2.H.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about reg"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because the attacker queried a registry key that contains system policy configurations. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.H.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)"}, {"ScreenshotName": "FE-2.H.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about reg"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery). An alert was also generated for a File Write To Named Pipe (Weak Signal) for reg.exe.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-6.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-6.A.1-2.png", "ScreenshotCaption": "File Write To Named Pipe  alert for write to remote named pipe from reg.exe"}, {"ScreenshotName": "FE-6.A.1-3.png", "ScreenshotCaption": "Additional details on named pipe alert"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)"}, {"ScreenshotName": "FE-6.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about reg query"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified reg.exe as a reconnaissance command to enumerate a Registry key on the host Conficker to determine the configuration of its Windows Terminal Server service. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-6.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-6.A.1-2.png", "ScreenshotCaption": "File Write To Named Pipe  alert for write to remote named pipe from reg.exe"}, {"ScreenshotName": "FE-6.A.1-3.png", "ScreenshotCaption": "Additional details on named pipe alert"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)"}, {"ScreenshotName": "FE-6.A.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about reg query"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "13.C.1", "Procedure": "Empire:\u00ef\u00bf\u00bd'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-13.C.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified reg.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-13.C.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-17.A.1-1.png", "ScreenshotCaption": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement). The four events were included under the same alert.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Frieda"}, {"ScreenshotName": "FE-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Bob"}, {"ScreenshotName": "FE-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick"}, {"ScreenshotName": "FE-16.A.1-4.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "The capability enriched a logon attempt via net.exe with an alert for Net Use Command Execution (Weak Signal). The alert details showed net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick. The alert was also tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker accessed Conficker by mounting the ADMIN$ share. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "The capability enriched net1.exe with an alert for Net Use Command Execution (Weak Signal). The alert also was tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.D.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)"}, {"ScreenshotName": "FE-16.D.1-1.png", "ScreenshotCaption": "Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker mounted the C$ drive on creeper with the kmitnick account. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.D.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)"}, {"ScreenshotName": "FE-16.D.1-1.png", "ScreenshotCaption": "Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1110", "TechniqueName": "Brute Force", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00ef\u00bf\u00bdKmitnick, Bob, and Frieda", "Detections": [{"DetectionNote": "Telemetry showed the logon failure from Kmitnick by searching for Windows Security Log Event ID 4625. [FE3]", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-4.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-5.png", "ScreenshotCaption": "Telemetry showing failed logon attempt for Kmitnick"}, {"ScreenshotName": "FE-16.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)"}], "Footnotes": [" A configuration change was made to allow for the capture of Windows Security Event ID 4625."]}, {"DetectionNote": "The capability enriched repeated logon attempts via net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1077 - Windows Admin Share) and Tactic (Lateral Movement). \u00a0The four events were included under the same alert and each of the passwords were redacted by the capability. [FE10]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-4.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-5.png", "ScreenshotCaption": "Telemetry showing failed logon attempt for Kmitnick"}, {"ScreenshotName": "FE-16.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)"}], "Footnotes": [" The vendor indicated the un-redacted passwords could be observed in triage/acquistion data."]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the attacker attempted to access systems using four accounts.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-2.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-3.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-4.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)"}, {"ScreenshotName": "FE-16.A.1-5.png", "ScreenshotCaption": "Telemetry showing failed logon attempt for Kmitnick"}, {"ScreenshotName": "FE-16.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Detections": [{"DetectionNote": "Telemetry showed the successful logon for the user Kmitnick.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon of user Kmitnick"}, {"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}]}, {"DetectionNote": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon of user Kmitnick"}, {"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.I.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}, {"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed the sc.exe command creating a new service called adobeupdater on Creeper from CodeRed. [FE5][FE7]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.I.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}, {"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", " All five of the sc.exe events are rolled under the same SC Execution alert."]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs with a parent process of powershell.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-16.F.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, {"ScreenshotName": "FE-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs"}]}, {"DetectionNote": "The capability enriched cmd.exe spawning wscript.exe with an alert for Wscript Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1059 - Command-Line Interface) and Tactic (Execution). Alert details showed that the context of the user was changed to Kmitnick.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.F.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)"}, {"ScreenshotName": "FE-16.F.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "An Indicator of Compromise alert was generated for the hardcoded DNS record name syntax in the DNS lookups for freegoogleadsenseinfo.com (C2 domain). The alert was also tagged with the correct ATT&CK Technique (T1071 - Standard Application Layer Protocol) and Tactic (Command and Control).", "DetectionType": "Indicator of Compromise", "Screenshots": [{"ScreenshotName": "FE-1.C.1-2.png", "ScreenshotCaption": "Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)"}, {"ScreenshotName": "FE-1.C.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that command and control occurred via DNS. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-1.C.1-2.png", "ScreenshotCaption": "Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)"}, {"ScreenshotName": "FE-1.C.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed HTTP GET requests over port 80 to 192.168.0.4 (C2 server).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified C2 communication over HTTP to www.freegoogleadsenseinfo.com (C2 domain). [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-6.B.1-3.png", "ScreenshotCaption": "Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor was configured to communicate with freegoogleadsenseinfo.com (C2 domain) over HTTPS.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Detections": [{"DetectionNote": "The capability enriched a HTTP GET request with an alert for PowerShell URL Request (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1071 - Standard Application Layer Protocol) and Tactic (Command and Control).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-14.A.1-4.png", "ScreenshotCaption": "Enrichment of HTTP GET request with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)"}]}]}]}, {"TechniqueId": "T1053", "TechniqueName": "Scheduled Task", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Detections": [{"DetectionNote": "The capability enriched schtasks.exe with an alert for Scheduled Task Activity (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1053 - Scheduled Task) and Tactics (Execution, Persistence, and Privilege Escalation).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-7.C.1-1.png", "ScreenshotCaption": "Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-7.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)"}, {"ScreenshotName": "FE-7.C.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about schtask"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that updater.dll persisted through the creation of a scheduled task. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-7.C.1-1.png", "ScreenshotCaption": "Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-7.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)"}, {"ScreenshotName": "FE-7.C.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about schtask"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed svchost.exe executing rundll32.exe, which executed updater.dll. The telemetry was tainted by the parent Rundll32 Execution alert, which was tagged with a related ATT&CK Technique (T1085 - Rundll32) and Tactic (Defense Evasion, Execution), but did not include information on the use of a Scheduled Task specifically.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-10.A.2-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}, {"ScreenshotName": "FE-10.A.2-2.png", "ScreenshotCaption": "Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)"}, {"ScreenshotName": "FE-10.A.2-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the Resume Viewer Update Checker scheduled task executing updater.dll with rundll32.exe. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-10.A.2-1.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}, {"ScreenshotName": "FE-10.A.2-2.png", "ScreenshotCaption": "Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)"}, {"ScreenshotName": "FE-10.A.2-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Detections": [{"DetectionNote": "The Managed Defense Report indicated an Indicator of Compromise detection occurred because it identified that the attacker executed the Windows Clipboard capability in Empire. The capability separately showed a PowerShell Execution (Weak Signal) alert containing the encoded PowerShell command. This command could be decoded, but this was not counted as a separate detection because it was external to the capability. [FE5]", "DetectionType": "Indicator of Compromise", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed the Windows Clipboard capability of Empire (Indicator of Compromise)"}, {"ScreenshotName": "FE-12.E.1.5-1.png", "ScreenshotCaption": "PowerShell Execution alert containing encoded PowerShell command (does not count as a detection)"}, {"ScreenshotName": "FE-12.E.1.5-2.png", "ScreenshotCaption": "Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.", "DetectionType": "General Behavior"}, {"DetectionNote": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.", "DetectionType": "General Behavior"}, {"DetectionNote": "The capability enriched an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1022 - Data Encrypted).", "DetectionType": "Enrichment"}, {"DetectionNote": "The capability enriched recycler.exe writing old.rar to the root of the Recycle Bin with an alert for Rar Archive Created (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "DetectionType": "Enrichment"}, {"DetectionNote": "The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "DetectionType": "Enrichment"}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed recycler.exe creating an encrypted RAR archive. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.", "DetectionType": "General Behavior"}, {"DetectionNote": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.", "DetectionType": "General Behavior"}, {"DetectionNote": "The capability enriched the command line output containing -hp with an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed).", "DetectionType": "Enrichment"}, {"DetectionNote": "The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "DetectionType": "Enrichment"}, {"DetectionNote": "The capability enriched the file write of RAR with a second alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "DetectionType": "Enrichment"}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it indicated the attacker executed recycler.exe to create an encrypted RAR file old.rar.[FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though the capability detected PowerShell activity during the time of the keylogging.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "FE-15.A.1-1.png", "ScreenshotCaption": "PowerShell activity during the time of the keylogging (does not count as detection)"}]}]}]}, {"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.G.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net user as a reconnaissance command performed. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.G.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.E.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net user as a reconnaissance command performed. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.E.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-2.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Detections": [{"DetectionNote": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in), which displays local account information.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-7.A.1-3.png", "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.exe"}]}]}, {"SubStep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used to capture information about local users.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.G.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.G.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "The capability enriched the sc.exe command with an alert for SC Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1007 - System Service Discovery) and the correct Tactic (Discovery).  [FE7]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with related correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-1.png", "ScreenshotCaption": "Additional details on enrichment of sc.exe with SC Execution alert"}], "Footnotes": [" All five of the sc.exe events are rolled under the same SC Execution alert."]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "Telemetry showed the MD5 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR. The telemetry was tainted by the parent PowerShell File Write alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-19.A.1-2.png", "ScreenshotCaption": "Telemetry showing MD5 hash of recycler.exe"}, {"ScreenshotName": "FE-19.A.1-1.png", "ScreenshotCaption": "Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the attacker placing the WinRAR utility on the system as recycler.exe. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-19.A.1-2.png", "ScreenshotCaption": "Telemetry showing MD5 hash of recycler.exe"}, {"ScreenshotName": "FE-19.A.1-1.png", "ScreenshotCaption": "Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}]}, {"DetectionNote": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}]}, {"DetectionNote": "The capability enriched an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with related ATT&CK Techniques (T1022 - Data Encrypted and T1002 - Data Compressed).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}]}, {"DetectionNote": "The capability enriched recycler.exe writing old.rar to the root of the Recycle Bin with an alert for Rar Archive Created (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}]}, {"DetectionNote": "The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed recycler.exe creating an encrypted RAR archive.[FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-19.B.1-1.png", "ScreenshotCaption": "General Behavior alert for Execution from Suspicious Directory"}, {"ScreenshotName": "FE-19.B.1-2.png", "ScreenshotCaption": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)"}, {"ScreenshotName": "FE-19.B.1-3.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.B.1-4.png", "ScreenshotCaption": "General Behavior alert for File Write To Root Of Recycle Bin"}, {"ScreenshotName": "FE-19.B.1-5.png", "ScreenshotCaption": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)"}, {"ScreenshotName": "FE-19.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Detections": [{"DetectionNote": "Telemetry showed a Logon Type 10 (interactive) event for the account Jesse logging on to Conficker.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-10.B.1-2.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the account Jesse was used to log in to Conficker as part of Lateral Movement.[FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-10.B.1-2.png", "ScreenshotCaption": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker"}, {"ScreenshotName": "FE-10.B.1-3.png", "ScreenshotCaption": "Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed the successful logon for the user Kmitnick.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, {"ScreenshotName": "FE-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon of user Kmitnick"}]}, {"DetectionNote": "The capability enriched a logon attempt via net.exe using valid credentials for user Kmitnick with an alert for Net Use Command Execution (Weak Signal). The password for Kmitnick was redacted within the capability. [FE10]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.B.1-1.png", "ScreenshotCaption": "Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, {"ScreenshotName": "FE-16.B.1-2.png", "ScreenshotCaption": "Telemetry showing successful logon of user Kmitnick"}], "Footnotes": [" The vendor indicated the un-redacted passwords could be observed in triage/acquistion data."]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "The capability enriched a logon attempt via net1.exe using valid credentials for user Kmitnick with an alert for Net Use Command Execution (Weak Signal). The password for the user Kmitnick was redacted by the capability.[FE10]", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.D.1-1.png", "ScreenshotCaption": "Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, {"ScreenshotName": "FE-16.D.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)"}], "Footnotes": [" The vendor indicated the un-redacted passwords could be observed in triage/acquistion data."]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker mounted the C$ drive on creeper with the kmitnick account. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.D.1-1.png", "ScreenshotCaption": "Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert"}, {"ScreenshotName": "FE-16.D.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though DNS requests for freegoogleadsenseinfo.com (C2 domain) were observed.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "FE-9.B.1-1.png", "ScreenshotCaption": "DNS requests to freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed the sc.exe command starting the adobeupdater service on Creeper. [FE5][FE7]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-16.L.1-1.png", "ScreenshotCaption": "Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-16.I.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", " All five of the sc.exe events are rolled under the same SC Execution alert."]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "2.C.2 ", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Detections": [{"DetectionNote": "The capability enriched tasklist.exe with an alert for Tasklist Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1057 - Process Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.C.2-1.png", "ScreenshotCaption": "Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)"}, {"ScreenshotName": "FE-2.C.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about tasklist"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that tasklist was one of the commands used to enumerate current running processes. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.C.2-1.png", "ScreenshotCaption": "Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)"}, {"ScreenshotName": "FE-2.C.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about tasklist"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched qprocess.exe with an alert for Qprocess Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1057 - Process Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.C.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified qprocess.exe as a reconnaissance command used.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.C.1-1.png", "ScreenshotCaption": "Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1015", "TechniqueName": "Accessibility Features", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Detections": [{"DetectionNote": "A Specific Behavior alert was also generated for Accessibility Features File Write (Weak Signal) based on magnifier.exe being overwritten. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "FE-17.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)"}]}, {"DetectionNote": "A Specific Behavior alert was generated for Suspicious Accessibility Features Replacement (BACKDOOR) based on magnifer.exe being overwritten. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "FE-17.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified magnifer.exe being overwritten with cmd.exe. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-17.C.1-1.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-2.png", "ScreenshotCaption": "Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)"}, {"ScreenshotName": "FE-17.C.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated for RENAMED CMD.EXE, with a description explaining how attackers will sometimes rename cmd.exe to other filenames to try to bypass detections.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "FE-20.A.1-3.png", "ScreenshotCaption": "General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-4.png", "ScreenshotCaption": "Continued details for General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)"}]}, {"DetectionNote": "A Specific Behavior alert was generated for Accessibility Features Child Process due to whoami.exe spawning from magnify.exe. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Persistence, Privilege Escalation).", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "FE-20.A.1-3.png", "ScreenshotCaption": "General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-4.png", "ScreenshotCaption": "Continued details for General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-20.A.1-3.png", "ScreenshotCaption": "General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-4.png", "ScreenshotCaption": "Continued details for General Behavior alert for RENAMED CMD.EXE"}, {"ScreenshotName": "FE-20.A.1-5.png", "ScreenshotCaption": "Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)"}, {"ScreenshotName": "FE-20.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Detections": [{"DetectionNote": "Telemetry showed port 53 command and control traffic.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing port 53 command and control traffic"}, {"ScreenshotName": "FE-1.C.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it observed the use of UDP port 53 for DNS command and control traffic. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing port 53 command and control traffic"}, {"ScreenshotName": "FE-1.C.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Detections": [{"DetectionNote": "Telemetry showed a connection over port 80 to 192.168.0.4 (C2 server).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 connections to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified C2 communication over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain).\u00a0[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 connections to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "FE-6.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe communicating over TCP port 443. The telemetry was tainted by the parent PowerShell Network Connection alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)"}, {"ScreenshotName": "FE-11.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)"}, {"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor communicated with 192.168.0.5 (C2 server) over port 443.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)"}, {"ScreenshotName": "FE-11.B.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)"}, {"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Detections": [{"DetectionNote": "Telemetry showed a connection to freegoogleadsenseinfo.com (C2 domain) over TCP port 8080. The telemetry was tainted by the parent PowerShell URL Request (Weak Signal) alert.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)"}, {"ScreenshotName": "FE-14.A.1-9.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)"}, {"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire instance communicated with freegoogleadsenseinfo.com (C2 domain) over port 8080.[FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-14.A.1-4.png", "ScreenshotCaption": "Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)"}, {"ScreenshotName": "FE-14.A.1-9.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)"}, {"ScreenshotName": "FE-11.B.1-4.png", "ScreenshotCaption": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated members of the local administrators group. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery)", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.F.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated members of the local administrators group. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.F.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" -domain' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.3-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated the Shockwave domain's Domain Administrators group. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.F.3-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}, {"ScreenshotName": "FE-2.B.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)"}, {"ScreenshotName": "FE-2.F.3-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed loading of an assembly associated with accessing Active Directory security principals.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "FE-12.E.1.2-1.png", "ScreenshotCaption": "Telemetry showing loading of System.DirectoryServices.AccountManagement assembly (does not count as a detection)"}]}]}, {"SubStep": "12.F.1", "Procedure": "Empire: 'net group \"Domain Admins\" -domain' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.F.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "12.F.2", "Procedure": "Empire: 'net\u00ef\u00bf\u00bdlocalgroup\u00ef\u00bf\u00bdadministrators' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-12.F.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Detections": [{"DetectionNote": "Telemetry showed execution of powershell.exe as a high integrity process as SYSTEM with a token login ID previously associated with user Debbie. [FE6]", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-3.A.1-3.png", "ScreenshotCaption": "Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0xfcf5fd"}, {"ScreenshotName": "FE-3.A.1-4.png", "ScreenshotCaption": "Telemetry showing group membership of token logon ID 0xfcf5fd, associated with user Debbie, which includes S-1-16-12288 (High Mandatory Level)"}], "Footnotes": [" A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called)."]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Detections": [{"DetectionNote": "Telemetry showed execution of powershell.exe as a high integrity process as SYSTEM with a token login ID previously associated with user Bob, which indicates UAC bypassing. [FE6]", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-14.A.1-7.png", "ScreenshotCaption": "Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0x10530b3"}, {"ScreenshotName": "FE-14.A.1-8.png", "ScreenshotCaption": "Telemetry showing group membership of token logon ID 0x10530b3 associated with user Bob, which includes S-1-16-12288 (High Mandatory Level)"}], "Footnotes": [" A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called)."]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.D.1", "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "The capability enriched rundll32.exe with an alert for Rundll32 Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1085 - Rundll32) and Tactics (Defense Evasion, Execution).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-1.A.1-3.png", "ScreenshotCaption": "Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)"}, {"ScreenshotName": "FE-1.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified use of rundll32.exe to execute update.dat with command-line arguments. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-1.A.1-3.png", "ScreenshotCaption": "Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)"}, {"ScreenshotName": "FE-1.A.1-6.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Detections": [{"DetectionNote": "Telemetry showed a svchost.exe seclogon event for a token logon ID later used by a process whose group membership indicated high integrity. [FE6]", "DetectionType": "Telemetry", "Modifiers": ["Configuration Change"], "Screenshots": [{"ScreenshotName": "FE-3.A.1-3.png", "ScreenshotCaption": "Telemetry showing svchost.exe seclogon event for token login ID 0xfcf5fd"}, {"ScreenshotName": "FE-3.A.1-4.png", "ScreenshotCaption": "Telemetry showing group membership of token logon ID 0xfcf5fd, which includes S-1-16-12288 (High Mandatory Level)"}], "Footnotes": [" A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called)."]}]}, {"SubStep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Detections": [{"DetectionNote": "Telemetry showed a process (net.exe) executed during Step 4 as user Debbie and a subsequent process (reg.exe) executed during Step 6 as user George, indicating a change in user context from a stolen token.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing the user Debbie executing net.exe with command-line arguments during Step 4"}, {"ScreenshotName": "FE-5.B.1-1.png", "ScreenshotCaption": "Telemetry showing the user George executing reg.exe with command-line arguments during Step 6"}]}]}]}, {"TechniqueId": "T1222", "TechniqueName": "File and Directory Permissions Modification", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Detections": [{"DetectionNote": "The capability enriched takeown.exe with an alert for Takeown Execution. The alert described how takeown can be used to change file ownership.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-17.B.1-1.png", "ScreenshotCaption": "Enrichment of takeown.exe with Takeown Execution alert"}]}]}, {"SubStep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Detections": [{"DetectionNote": "The capability enriched icacls.exe with an alert for Icacls Execution. The alert described how icacls can be used to display or change Windows file ACLs.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-17.B.2-1.png", "ScreenshotCaption": "Enrichment of icacls.exe with Icacls Execution alert"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Detections": [{"DetectionNote": "Telemetry showed autoupdate.bat being written to the Startup folder.[FE50]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat file written to the Startup folder"}, {"ScreenshotName": "FE-1.B.1-2.png", "ScreenshotCaption": "Enrichment of autoupdate.bat being written to Startup with Persistence category"}, {"ScreenshotName": "FE-1.B.1-3.png", "ScreenshotCaption": "Additional details on enrichment of autoupdate.dat"}, {"ScreenshotName": "FE-1.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)"}], "Footnotes": ["The alert mapped to two ATT&CK Techniques (T1059 - Command-Line Interface and T1105 - Remote File Copy), but they were not directly related to the Registry Run Keys / Startup Folder Technique under test in this procedure."]}, {"DetectionNote": "The capability enriched the file write of autoupdate.bat to the Startup folder by categorizing it as Persistence.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat file written to the Startup folder"}, {"ScreenshotName": "FE-1.B.1-2.png", "ScreenshotCaption": "Enrichment of autoupdate.bat being written to Startup with Persistence category"}, {"ScreenshotName": "FE-1.B.1-3.png", "ScreenshotCaption": "Additional details on enrichment of autoupdate.dat"}, {"ScreenshotName": "FE-1.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified the backdoor persisted by executing autoupdate.bat at system start due to its presence in the Startup directory.[FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat file written to the Startup folder"}, {"ScreenshotName": "FE-1.B.1-2.png", "ScreenshotCaption": "Enrichment of autoupdate.bat being written to Startup with Persistence category"}, {"ScreenshotName": "FE-1.B.1-3.png", "ScreenshotCaption": "Additional details on enrichment of autoupdate.dat"}, {"ScreenshotName": "FE-1.B.1-4.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-10.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)"}, {"ScreenshotName": "FE-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder"}, {"ScreenshotName": "FE-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)"}, {"ScreenshotName": "FE-10.A.1-4.png", "ScreenshotCaption": "Additional details of rundll32.exe telemetry"}, {"ScreenshotName": "FE-10.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing update.dll with command-line arguments. The telemetry was tainted by the parent alert for Rundll32 Execution (Weak Signal).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "FE-10.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)"}, {"ScreenshotName": "FE-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder"}, {"ScreenshotName": "FE-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)"}, {"ScreenshotName": "FE-10.A.1-4.png", "ScreenshotCaption": "Additional details of rundll32.exe telemetry"}, {"ScreenshotName": "FE-10.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}]}, {"DetectionNote": "The capability enriched cmd.exe executing a file from Startup with an alert for Process Execution Startup. The alert was also tagged with the correct ATT&CK Technique (T1060 - Registry Run Keys / Startup Folder) and Tactic (Persistence).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-10.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)"}, {"ScreenshotName": "FE-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder"}, {"ScreenshotName": "FE-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)"}, {"ScreenshotName": "FE-10.A.1-4.png", "ScreenshotCaption": "Additional details of rundll32.exe telemetry"}, {"ScreenshotName": "FE-10.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that autoupdate.bat persisted due to its presence in the startup directory. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-10.A.1-1.png", "ScreenshotCaption": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)"}, {"ScreenshotName": "FE-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder"}, {"ScreenshotName": "FE-10.A.1-3.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)"}, {"ScreenshotName": "FE-10.A.1-4.png", "ScreenshotCaption": "Additional details of rundll32.exe telemetry"}, {"ScreenshotName": "FE-10.A.1-5.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Detections": [{"DetectionNote": "Telemetry showed Resume Viewer.exe spawning the child process cmd.exe to launch pdfhelper.cmd.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "FE-1.A.1-2.png", "ScreenshotCaption": "Telemetry showing the child cmd.exe process running the pdfhelper.cmd script"}]}]}, {"SubStep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Detections": [{"DetectionNote": "An Indicator of Compromise alert was generated for EMPIRE RAT (Backdoor) based on a detected string specific to the backdoor. The alert was also mapped to a related ATT&CK Technique (T1086 - PowerShell).", "DetectionType": "Indicator of Compromise", "Screenshots": [{"ScreenshotName": "FE-11.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-3.png", "ScreenshotCaption": "Additional details on Specific Behavior alert for Suspicious PowerShell Usage"}, {"ScreenshotName": "FE-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)"}]}, {"DetectionNote": "A Specific Behavior alert was generated for Suspicious PowerShell Usage (Methodology) indicating powershell.exe ran with unusual arguments due to the -enc and -noP command-line arguments. The alert was mapped to a related ATT&CK Technique (T1086 - PowerShell) and the correct Tactic (Execution) and captured the encoded command.", "DetectionType": "Specific Behavior", "Screenshots": [{"ScreenshotName": "FE-11.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-3.png", "ScreenshotCaption": "Additional details on Specific Behavior alert for Suspicious PowerShell Usage"}, {"ScreenshotName": "FE-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)"}]}, {"DetectionNote": "The capability enriched wscript.exe with an alert for Wscript Execution (Weak Signal). The alert was tagged with the correct ATT&CK Technique (T1064 - Scripting) and Tactic (Execution).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-11.A.1-2.png", "ScreenshotCaption": "Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-3.png", "ScreenshotCaption": "Additional details on Specific Behavior alert for Suspicious PowerShell Usage"}, {"ScreenshotName": "FE-11.A.1-1.png", "ScreenshotCaption": "Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)"}, {"ScreenshotName": "FE-11.A.1-4.png", "ScreenshotCaption": "Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)"}]}]}, {"SubStep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Detections": [{"DetectionNote": "The capability enriched powershell.exe with an alert for PowerShell Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1086 - PowerShell).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.E.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)"}]}, {"DetectionNote": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that a PowerShell command was run from the Empire process. [FE5]", "DetectionType": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.E.1-1.png", "ScreenshotCaption": "Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)"}, {"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" -domain' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-4.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net group"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it indicated net group was one of the reconnaissance commands performed. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-4.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-4.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net group"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" -domain' via cmd", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-4.A.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net group"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it indicated net group was one of the reconnaissance commands performed. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-2.A.1-3.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)"}, {"ScreenshotName": "FE-4.A.2-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)"}, {"ScreenshotName": "FE-4.A.2-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report with additional details about net group"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {"SubStep": "13.A.1", "Procedure": "Empire: 'net group \"Domain Computers\" -domain' via PowerShell", "Detections": [{"DetectionNote": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1018 - Remote System Discovery) and Tactic (Discovery).", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)"}]}, {"DetectionNote": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]", "DetectionType": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": [{"ScreenshotName": "FE-12.A.1-2.png", "ScreenshotCaption": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)"}, {"ScreenshotName": "FE-13.A.1-1.png", "ScreenshotCaption": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)"}], "Footnotes": [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}]}