{"PublicRelease": "\u00a92019 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 18-4019 ", "Techniques": [{"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-10.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-11.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-12.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.F.1", "Procedure": "Empire: 'net group \"Domain Admins\" -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}]}]}, {"SubStep": "12.F.2", "Procedure": "Empire: 'net\u00ef\u00bf\u00bdlocalgroup\u00ef\u00bf\u00bdadministrators' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "A General Behavior alert was generated for the lateral movement activity. A new story grouping was generated for the event on Creeper to associate subsequent activity.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "S1-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to start the AdobeUpdater service on Creeper (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-16.G.1-1.png", "ScreenshotCaption": "Lateral movement alert generated by the remote service start on Creeper"}]}, {"DetectionNote": "Telemetry showed execution of sc.exe to start the AdobeUpdater service on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.L.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to start the AdobeUpdater service on Creeper (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-16.G.1-1.png", "ScreenshotCaption": "Lateral movement alert generated by the remote service start on Creeper"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed executions of sc.exe to create the AdobeUpdater service on Creeper with a binPath pointing to cmd.exe to execute update.vbs as well as a setting the service description. An analyst can use this information to determine AdobeUpdater is masquerading. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create the AdobeUpdater service and set the description (partially shown one line above; both tainted by prior threat story)"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "Telemetry showed file creation event for recycler.exe on CodeRed along with MD5, SHA1, and SHA256 hashes. Hashes could be used to look up information on the binary. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.A.1-2.png", "ScreenshotCaption": "Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID"}, {"ScreenshotName": "S1-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file write of recycler.exe with file hashes"}]}]}, {"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The Process Name field in the row for recycler.exe enriched the event with \"Command line RAR\". The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.B.1-1.png", "ScreenshotCaption": "Enrichment showing the execution of recycler.exe with process name identified as \\\"Command line RAR\\\""}, {"ScreenshotName": "S1-19.A.1-2.png", "ScreenshotCaption": "Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID"}]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "2.C.2 ", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing tasklist.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-5.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-1.png", "ScreenshotCaption": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting qprocess.exe"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Detections": [{"DetectionNote": "Telemetry showed the Jesse account had logged into the system.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "S1-10.B.1-3.png", "ScreenshotCaption": "Telemetry showing last logged on user identified as Jesse"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt using valid credentials of user Kmitnick via net.exe and command-line arguments (tainted by relationship to threat story). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts, the last of which using valid credentials for user Kmitnick (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts and corresponding exit codes"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt using valid credentials for user Kmitnick (tainted by relationship to threat story)"}]}]}]}, {"TechniqueId": "T1126", "TechniqueName": "Network Share Connection Removal", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed execution of net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.C.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe and command-line arguments (tainted by relationship to threat story)"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1010", "TechniqueName": "Application Window Discovery", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-4.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-4.A.1-3.png", "ScreenshotCaption": "Event tree showing net.exe (tainted by launch from process lineage previously identified as malicious)"}]}]}, {"SubStep": "13.A.1", "Procedure": "Empire: 'net group \"Domain Computers\" -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed execution of net.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}]}]}]}, {"TechniqueId": "T1026", "TechniqueName": "Multiband Communication", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Detections": [{"DetectionNote": "Telemetry showed port 80 connections to 192.168.0.4 (C2 server) and DNS requests for freegoogleadsenseinfo.com (C2 domain), which could indicate multiband communication. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 connection to 192.168.0.4 (C2 server)"}, {"ScreenshotName": "S1-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS query to C2 domain (tainted by relationship to threat story shown in Group ID)"}]}]}]}, {"TechniqueId": "T1110", "TechniqueName": "Brute Force", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00ef\u00bf\u00bdKmitnick, Bob, and Frieda", "Detections": [{"DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, {"ScreenshotName": "S1-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts (tainted by relationship to threat story)"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Detections": [{"DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, {"ScreenshotName": "S1-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts (tainted by relationship to threat story)"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Detections": [{"DetectionNote": "Telemetry showed the creation of the user Jesse which was noted from SAM Registry events.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "S1-7.A.1-1.png", "ScreenshotCaption": "Telemetry showing creation of user account Jesse"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Detections": [{"DetectionNote": "Telemetry showed GetAsyncKeyStateApi, which was indicative of keylogging. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).[SO3]", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-8.C.1-2.png", "ScreenshotCaption": "Telemetry showing GetAsyncKeyStateApi (Group ID tainted the event but was not shown in this view)"}, {"ScreenshotName": "S1-8.C.1-1.png", "ScreenshotCaption": "Telemetry showing process injection into explorer.exe (does not count as a detection)"}], "Footnotes": [" Vendor stated log files indicate the powershell process was using the SSL cache folder."]}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Detections": [{"DetectionNote": "The capability enriched data collected as keylogging behavior that was not visible through the standard interface during the evaluation. [SO5]", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-15.A.1-1.png", "ScreenshotCaption": "Enrichment of use of GetAsyncKeyStateApi tagged as a keylogger (tainted by relationship to threat story but Group ID not shown in this view)"}], "Footnotes": [" The capability associated the keylogging event to the parent Group ID even though it is not visible in the data provided."]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Detections": [{"DetectionNote": "A General Behavior alert was generated due to static analysis of the file through the DFI resulting in it being marked as suspicious, which generated a story (group ID) that subsequent linked events are tainted by.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "S1-1.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing execution of Resume Viewer.exe"}, {"ScreenshotName": "S1-1.A.1-2.png", "ScreenshotCaption": "General Behavior alert for execution of Resume Viewer.exe as a suspicious file"}]}, {"DetectionNote": "Telemetry showed Resume Viewer.exe execution with subsequent file writes and execution.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "S1-1.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing execution of Resume Viewer.exe"}, {"ScreenshotName": "S1-1.A.1-2.png", "ScreenshotCaption": "General Behavior alert for execution of Resume Viewer.exe as a suspicious file"}]}]}]}, {"TechniqueId": "T1201", "TechniqueName": "Password Policy Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe execution of autoupdate.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.F.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe launching autoupdate.vbs (tainted by relationship to threat story)"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \"\\\\conficker\\wormshare\"' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-8.A.1-2.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing dir with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing tree with command-line arguments. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-8.A.1-3.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tree with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed a remote access event on update.vbs.[SO91]", "DetectionType": "Telemetry", "Footnotes": ["MITRE verified telemetry was generated for the remote update.vbs file access event, but no screenshot was available."]}]}, {"SubStep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1132", "TechniqueName": "Data Encoding", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Detections": [{"DetectionNote": "Telemetry showed DNS requests with encoded content to freegoogleadsenseinfo.com (the C2 domain). The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.C.1-2.png", "ScreenshotCaption": "Telemetry showing stream of DNS requests with encoded data"}, {"ScreenshotName": "S1-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS query for freegoogleadsenseinfo.com (C2 domain) (tainted by relationship to threat story)"}]}]}]}, {"TechniqueId": "T1015", "TechniqueName": "Accessibility Features", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Detections": [{"DetectionNote": "Telemetry showed file write of magnify.exe in the system directory from a file copy event for cmd.exe with matching hash values. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.C.1-1.png", "ScreenshotCaption": "Telemetry showing file copy and write events of cmd.exe to overwrite magnify.exe with matching hash values (tainted by prior lateral movement threat story; Group ID not shown in this view)"}]}]}, {"SubStep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of magnify.exe which was identified as a Windows Command Processor within the interface. Activity associated with a new story (Group ID).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "S1-20.B.1-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe execution (identified as Windows Command Processor)"}]}]}]}, {"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing netstat.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}]}]}, {"SubStep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed execution of net.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}]}]}, {"SubStep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed execution of netstat.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of netstat.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe allocating memory, writing to memory space, and invoking a thread into cmd.exe (tainted by association with parent alert for powershell.exe process executed by svchost.exe).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-3.C.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe injecting into cmd.exe (Group ID tainted this event but was not shown in this view)"}]}]}, {"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe injecting into svchost.exe (not counted for detection) then invoking a remote thread into lsass.exe. Powershell.exe was listed as the source of the remote thread into lsass.exe instead of svchost.exe because the alert on powershell.exe came before other events and therefore had increased precedence. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-5.A.2-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe invoking a remote thread into lsass.exe (Group ID tainted this event but was not shown in this view)"}]}]}, {"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Detections": [{"DetectionNote": "Telemetry showed the sequence of events related to process injection from powershell.exe into explorer.exe. The capability associated the process with the highest threat to the event (powershell.exe) instead of cmd.exe (the expected source of the injection) because it had an alert associated with it previously. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-8.D.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe injecting into explorer.exe (Group ID tainted this event but was not shown in this view)"}]}]}]}, {"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing the pdfhelper.cmd script. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.B.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing the child cmd.exe process running the script pdfhelper.cmd (tainted by relationship to threat story)"}]}]}, {"SubStep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Detections": [{"DetectionNote": "A General Behavior alert was generated for the execution of autoupdate.vbs that was listed as an active threat.", "DetectionType": "General Behavior", "Screenshots": [{"ScreenshotName": "S1-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing wscript.exe and powershell.exe"}, {"ScreenshotName": "S1-11.A.1-1.png", "ScreenshotCaption": "General Behavior alert for execution of autoupdate.vbs listed as an active threat"}]}, {"DetectionNote": "Telemetry showed wscript.exe executing autoupdate.vbs which then executed powershell.exe with an encoded PowerShell script.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "S1-11.A.1-2.png", "ScreenshotCaption": "Telemetry showing wscript.exe and powershell.exe"}, {"ScreenshotName": "S1-11.A.1-1.png", "ScreenshotCaption": "General Behavior alert for execution of autoupdate.vbs listed as an active threat"}]}]}, {"SubStep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Detections": [{"DetectionNote": "Telemetry showed execution of a PowerShell script with follow-on enumeration activity that coincided with the execution of the WinEnum module. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-1.png", "ScreenshotCaption": "Telemetry showing encoded PowerShell script (tainted Group ID not shown but was the search parameter)"}]}]}]}, {"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-13.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-14.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.F.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-12.F.1-2.png", "ScreenshotCaption": "Continued threat story showing related processes"}]}]}, {"SubStep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.F.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.F.1-1.png", "ScreenshotCaption": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe"}, {"ScreenshotName": "S1-12.F.1-2.png", "ScreenshotCaption": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.H.1-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-6.A.1-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing reg with command-line arguments (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)"}]}]}, {"SubStep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "13.C.1", "Procedure": "Empire:\u00ef\u00bf\u00bd'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed execution of reg.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-13.A.1-1.png", "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments (tainted Group ID not shown but was the search parameter)"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed reg.exe execution with command-line arguments. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.A.1-4.png", "ScreenshotCaption": "Threat story graph showing telemetry of reg.exe executing (tainted by prior lateral movement alert by Group ID)"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[SO20][SO3]", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "S1-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)"}], "Footnotes": ["Telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over TCP port 443 (no protocol was identified for this traffic).", " Vendor stated log files indicate the powershell process was using the SSL cache folder."]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed file write of the .vsdx to the Recycle Bin. The activity seen during the lateral movement step tainted the telemetry because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-18.B.1-1.png", "ScreenshotCaption": "Exported telemetry of threat story (taints event) showing .vsdx file copy and write"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed DNS requests to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.C.1-1.png", "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (tainted by relationship to threat story)"}]}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[SO96]", "DetectionType": "None", "Footnotes": ["Telemetry showed a connection to port 80 (no detection showed HTTP specifically)."]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[SO20][SO3]", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "S1-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)"}], "Footnotes": ["Telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over TCP port 443 (no protocol was identified for this traffic).", " Vendor stated log files indicate the powershell process was using the SSL cache folder."]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1135", "TechniqueName": "Network Share Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing WMI queries that indicated logical disk information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Additional telemetry showing powershell.exe WMI queries for logical disk information"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of sc.exe to create the AdobeUpdater service on Creeper with a binPath pointing to cmd.exe to execute update.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.I.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create the AdobeUpdater service (tainted by prior threat story)"}]}]}]}, {"TechniqueId": "T1039", "TechniqueName": "Data from Network Shared Drive", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed remote file access behavior for the .vsdx file from the network shared drive.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "S1-9.B.1-1.png", "ScreenshotCaption": "Telemetry showing .vsdx file access from WormShare on the network shared drive"}]}]}, {"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed the .vsdx file copied from a network shared drive on Conficker. The activity seen during the lateral movement step tainted the telemetry because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-18.B.1-1.png", "ScreenshotCaption": "Exported telemetry of threat story (taints event) showing .vsdx file copy from network shared drive on Conficker"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[SO95]", "DetectionType": "None", "Footnotes": ["PowerShell telemetry showed execution of an encoded command and the script was decoded to Windows.Clipboard(...) outside of the capability, but this was not counted as a detection because it was external to the capability."]}]}]}, {"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed a port 3389 connection. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-6.C.1-1.png", "ScreenshotCaption": "Telemetry showing port 3389 connection (tainted by relationship to threat story shown in Group ID)"}]}]}, {"SubStep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "Telemetry from Nimda showed a TCP port 3389 connection from 10.0.1.6 (Nimda) to 10.0.0.5 (Conficker). The rundll32.exe process (PID 184) that was used to load updater.dll was used to proxy the RDP connection to Conficker. The telemetry was tainted by the activity generated during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-10.B.1-1.png", "ScreenshotCaption": "Telemetry showing connection over port 3389 to 10.0.0.5 (Conficker)"}, {"ScreenshotName": "S1-10.B.1-2.png", "ScreenshotCaption": "Threat group identified as malicious, including rundll32.exe (PID 184) proxying the port 3389 connection (port 3389 connection not specifically shown in this view, but it identifies the rundll32.exe process tainting the connection by Group ID)"}]}]}, {"SubStep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-4.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing whoami.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-2.png", "ScreenshotCaption": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting whoami.exe"}]}]}, {"SubStep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Enrichment showed execution of the whoami command (enriched with description \"whoami - displays logged on user information\"). Execution of whoami was associated to the story (Group ID) created from the execution of magnify.exe, but was not considered tainted because an alert was not generated when magnify.exe was executed.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "S1-20.B.1-1.png", "ScreenshotCaption": "Enrichment of whoami command (displays logged on user information)"}]}]}]}, {"TechniqueId": "T1222", "TechniqueName": "File and Directory Permissions Modification", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Detections": [{"DetectionNote": "Telemetry showed takeown.exe execution with command-line arguments containing magnify.exe. The event was enriched to show that ownership of a file was taken over. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.A.1-1.png", "ScreenshotCaption": "Enrichment showing takeown.exe execution (tainted by prior lateral movement alert by Group ID)"}]}]}, {"SubStep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Detections": [{"DetectionNote": "Telemetry showed icacls.exe execution with command-line arguments containing magnify.exe. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.A.1-3.png", "ScreenshotCaption": "Telemetry showing icacls.exe execution (tainted by prior lateral movement alert by Group ID)"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Detections": [{"DetectionNote": "Telemetry on actions performed from Resume Viewer.exe showed autoupdate.bat being written to the Startup Folder. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.B.1-1.png", "ScreenshotCaption": "Telemetry showing autoupdate.bat write to the Startup folder (tainted by relationship to threat story)"}]}]}, {"SubStep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed execution of autoupdate.bat from the Startup folder for persistence. The telemetry was associated to a new story (Group ID) but was not marked as malicious or tainted because it is not associated with an alert.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "S1-10.A.1-2.png", "ScreenshotCaption": "Telemetry showing execution of autoupdate.bat from the Startup folder"}, {"ScreenshotName": "S1-10.A.1-3.png", "ScreenshotCaption": "Group ID query showing both autoupdate.bat and updater.dll persistence execution"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.A.1-1.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts targeting ADMIN$ (tainted by relationship to threat story)"}, {"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts targeting ADMIN$ and corresponding exit codes"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting ADMIN$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.A.1-2.png", "ScreenshotCaption": "Telemetry showing net.exe logon attempts and corresponding exit codes"}, {"ScreenshotName": "S1-16.B.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt targeting ADMIN$ (tainted by relationship to threat story)"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting C$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.D.1-1.png", "ScreenshotCaption": "Telemetry showing a net.exe logon attempt targeting C$ (tainted by relationship to threat story)"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.D.1", "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "Detections": [{"DetectionNote": "Telemetry showed the file deletion of old.rar. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.D.1-1.png", "ScreenshotCaption": "Telemetry exported from threat story showing the deletion of old.rar was tainted by prior activity because it was under the same Group ID"}]}]}, {"SubStep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Detections": [{"DetectionNote": "Telemetry showed the file deletion of recycler.exe. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.D.1-1.png", "ScreenshotCaption": "Telemetry exported from threat story showing the deletion of recycler.exe was tainted by prior activity because it was under the same Group ID"}]}]}]}, {"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing sc.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-6.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-7.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-1.png", "ScreenshotCaption": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting net.exe"}]}]}, {"SubStep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of sc.exe to query services on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.H.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to query services on Creeper (tainted by relationship to threat story)"}]}]}, {"SubStep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of sc.exe to query the AdobeUpdater service on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.J.1-1.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to query AdobeUpdater service on Creeper (tainted by relationship to threat story)"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Detections": [{"DetectionNote": "Telemetry showed reg.exe execution with command-line arguments indicating a check to see if terminal services was enabled. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-17.A.1-4.png", "ScreenshotCaption": "Threat story graph showing telemetry of reg.exe with query for terminal server setting (tainted by prior lateral movement alert by Group ID)"}]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "Telemetry showed file write of updater.dll. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-7.B.1-1.png", "ScreenshotCaption": "Telemetry showing file write of updater.dll (tainted by relationship to threat story)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed creation and file write events for autoupdate.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.E.1-1.png", "ScreenshotCaption": "Telemetry showing file event for autoupdate.vbs (tainted by relationship to threat story but Group ID not shown in this view)"}, {"ScreenshotName": "S1-16.E.1-2.png", "ScreenshotCaption": "Telemetry showing creation and writes to autoupdate.vbs"}]}]}, {"SubStep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed creation of update.vbs on 10.0.0.4 (Creeper). The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-16.G.1-2.png", "ScreenshotCaption": "Telemetry showing create file event of update.vbs on 10.0.0.4 (Creeper) (tainted by relationship to threat story but Group ID not shown in this view)"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed file write of recycler.exe with hash value. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-19.A.1-1.png", "ScreenshotCaption": "Telemetry showing file write of recycler.exe"}, {"ScreenshotName": "S1-19.A.1-2.png", "ScreenshotCaption": "Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID"}]}]}]}, {"TechniqueId": "T1061", "TechniqueName": "Graphical User Interface", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing arp.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.2-1.png", "ScreenshotCaption": "Telemetry showing arp.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing netsh.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-4.A.1-2.png", "ScreenshotCaption": "Telemetry showing netsh.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-1.png", "ScreenshotCaption": "Threat story showing partial tree of activity from the initial compromise alert"}, {"ScreenshotName": "S1-12.A.1-2.png", "ScreenshotCaption": "Continued threat story showing initial compromise alert and powershell.exe\u00a0tainting route.exe"}]}]}, {"SubStep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.A.1-3.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.A.1-1.png", "ScreenshotCaption": "Threat story showing initial compromise alert and powershell.exe\u00a0tainting ipconfig.exe"}]}]}, {"SubStep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing WMI queries that indicated network adapter and configuration information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Additional telemetry showing powershell.exe WMI queries for network adapter and configuration information"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-8.png", "ScreenshotCaption": "Telemetry showing systeminfo.exe (tainted by relationship to threat story)"}]}]}, {"SubStep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-2.A.1-9.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing WMI queries that indicated operating system information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Additional telemetry showing powershell.exe WMI queries for operating system information"}]}]}, {"SubStep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1053", "TechniqueName": "Scheduled Task", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Detections": [{"DetectionNote": "Telemetry showed execution of schtasks.exe and associated command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-7.C.1-1.png", "ScreenshotCaption": "Telemetry showing schtask.exe and associated command-line arguments (tainted by relationship to threat story)"}]}]}, {"SubStep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe executing updater.dll as part of the scheduled task persistence. The telemetry was associated with the execution of autoupdate.bat for persistence because it was associated with the same story (Group ID) but is not marked as malicious or tainted because it is not associated with an alert.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "S1-10.A.1-3.png", "ScreenshotCaption": "Group ID query showing both autoupdate.bat and updater.dll persistence execution"}, {"ScreenshotName": "S1-10.A.2-2.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[SO97]", "DetectionType": "None", "Footnotes": ["DNS requests were observed (no detection showed port 53 specifically)."]}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Detections": [{"DetectionNote": "Telemetry showed a port 80 connection to 192.168.0.4 (C2 server) that was associated with the rundll32 parent process. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-6.B.1-1.png", "ScreenshotCaption": "Telemetry showing port 80 connection to 192.168.0.4 (C2 server) (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)"}]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Detections": [{"DetectionNote": "Telemetry showed network connections to 192.168.0.5 (C2 server) over TCP port 443. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-11.B.1-1.png", "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (Group ID tainted the event but was not shown in this view)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Detections": [{"DetectionNote": "Telemetry showed network connections over port 8080. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-14.A.1-2.png", "ScreenshotCaption": "Telemetry showing network connections over port 8080 in the filter (tainted by relationship to threat story but Group ID not shown in this view)"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing WMI queries that indicated antivirus product information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Enrichment of powershell.exe with action \\\"attempted to find other installed security software\\\" (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe WMI queries for antivirus product information (tainted by relationship to threat story)"}]}, {"DetectionNote": "The capability enriched powershell.exe activity with the action \\\"attempted to find other installed security software.\\\" The enrichment was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "DetectionType": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-12.E.1-2.png", "ScreenshotCaption": "Enrichment of powershell.exe with action \\\"attempted to find other installed security software\\\" (tainted Group ID not shown but was the search parameter)"}, {"ScreenshotName": "S1-12.E.1-3.png", "ScreenshotCaption": "Telemetry showing powershell.exe WMI queries for antivirus product information (tainted by relationship to threat story)"}]}]}, {"SubStep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"]}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Detections": [{"DetectionNote": "Telemetry showed ftp.exe running with ftp.txt as an argument. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[SO1]", "DetectionType": "None", "Footnotes": [" Vendor states that the capability would normally block credential dumping activity like this, but the mitigation capability was disabled due to the evaluation parameters."]}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[SO1]", "DetectionType": "None", "Footnotes": [" Vendor states that the capability would normally block credential dumping activity like this, but the mitigation capability was disabled due to the evaluation parameters."]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe executing as a result of Resume Viewer.exe running. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-1.A.1-1.png", "ScreenshotCaption": "Telemetry from process tree showing rundll32.exe (tainted by relationship to threat story)"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Detections": [{"DetectionNote": "Telemetry showed process integrity levels changing from medium to high.[SO11]", "DetectionType": "Telemetry", "Footnotes": ["Detect was verified, but a screenshot for this data was unavailable. Integrity level values are based upon how the capability tracks integrity levels and not how Windows tracks them causing a difference in values."]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Detections": [{"DetectionNote": "Telemetry showed process integrity levels changing from medium to high (tainted by parent alert).[SO4]", "DetectionType": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [{"ScreenshotName": "S1-14.A.1-1.png", "ScreenshotCaption": "Telemetry showing process integrity level change from medium to high (tainted by relationship to threat story but Group ID not shown in this view)"}], "Footnotes": ["Integrity level numbers are based upon how the capability tracks integrity levels and not how Windows tracks them causing a difference in values."]}]}]}]}