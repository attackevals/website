<!DOCTYPE html>
<html lang='en'>

<head>
    <script async src='https://www.googletagmanager.com/gtag/js?id=UA-62667723-5'></script><script src='/theme/scripts/analytics.js'></script>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='shortcut icon' href='https://d1zq5d3dtjfcoj.cloudfront.net/ME_icon.png' type='image/x-icon'>

    <link rel="stylesheet" href="/theme/style/all.css">

    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    
    <title>ATT&CK&reg; EVALUATIONS</title>
    <!-- Bootstrap CSS -->
    <link rel='stylesheet' href='/theme/style/bootstrap.min.css' />
    <link rel='stylesheet' href='/theme/style/bootstrap-glyphicon.min.css' />
    <link href="/theme/style/bootstrap-tourist.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/theme/style.min.css?a678f2af">

    <link rel="stylesheet" type="text/css" href="/theme/vendor_comparison.min.css?a7156ca8">
</head>

<body>
    <header class='pb-5'>
        <nav class='navbar navbar-expand-lg navbar-light fixed-top box-shadow-bottom bg-white'>
        <a class='navbar-brand' href='/'><img src='https://d1zq5d3dtjfcoj.cloudfront.net/MITRE_Engenuity_ATTACK-Evaluations_logo_PMS_purple.jpg' height="50px" alt=''></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse' aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
          <span class='navbar-toggler-icon'></span>
        </button>
        
        <div class='collapse navbar-collapse' id='navbarCollapse'>
          <ul class='nav nav-tabs ml-auto'>
            
            <li class="dropdown-submenu">
               <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Enterprise</strong></a>
                <!-- <ul class="dropdown-menu dropleft"> -->
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <!-- <ul class="dropdown-menu drop_menu_side"> -->
                        <ul class="dropdown-menu drop_menu_side_right">                            
                            <li><a class="dropdown-item" href="/adversary-emulation.html">Adversary Emulation</a></li>
                            <li><a class="dropdown-item" href="/evaluation-process.html">Evaluation Process</a></li>
                            <li><a class="dropdown-item" href="/setup-and-configuration.html">Setup and Configuration</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Methodology Overview
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 50px;">
                            <li><a class="dropdown-item" href="/enterprise/evaluations.html?round=APT3">Results</a></li>
                            <li><a class="dropdown-item" href="/APT3">Overview</a></li>
                            <li><a class="dropdown-item" href="/APT3/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/APT3/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/APT3/scope.html">Technique Scope</a></li>
                            <li><a class="dropdown-item" href="/APT3/operational-flow.html">Operational Flow</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT3 (2018)
                        </a>
                        
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 90px;">
                            <li><a class="dropdown-item" href="/enterprise/evaluations.html?round=APT29">Results</a></li>
                            <li><a class="dropdown-item" href="/APT29">Overview</a></li>
                            <li><a class="dropdown-item" href="/APT29/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/APT29/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/APT29/scope.html">Technique Scope</a></li>
                            <li><a class="dropdown-item" href="/APT29/operational-flow.html">Operational Flow</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT29 (2019)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 130px;">
                            <li><a class="dropdown-item" href="/enterprise/evaluations.html?round=carbanak-fin7">Participants</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/">Overview</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/protection-categories.html">Protection Categories</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/scope.html">Technique Scope</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Carbanak+FIN7 (2020)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 180px;">
                            <li><a class="dropdown-item" href="/get-evaluated">Call for Participation</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Wizard Spider and <br> Sandworm (2021)
                        </a>
                    </li>
                </ul>
            </li>

            <li class="dropdown-submenu">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>ICS</strong></a>
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right">
                            <li><a class="dropdown-item" href="/get-evaluated.html">Call for Participation</a></li>
                            <li><a class="dropdown-item" href="/ICS/evaluations.html">Participants</a></li>
                            <li><a class="dropdown-item" href="/TRITON/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            TRITON (2020)
                        </a>
                    </li>
                </ul>
            </li>

            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Tools</strong></a>
                <!-- <div class="dropdown-menu" aria-labelledby="navbarDropdown"> -->
                <div class="dropdown-menu">
                    <a class="dropdown-item" href='/technique_comparison.html'>Technique Comparison Tool </a>
                    <a class="dropdown-item" href='/vendor_comparison.html'>Vendor Comparison Tool </a>
                    <a class="dropdown-item" href='/do-it-yourself.html'>Do It Yourself Evaluations</a>
                    <a class="dropdown-item" href='/data_analysis_tool.html'>Data Analysis Tool</a>
                    <a class="dropdown-item" href='https://github.com/mitre-attack/attack-arsenal'>
                        ATT&CK Arsenal
                        &nbsp;<i class="fas fa-external-link-alt"></i>
                    </a>
                </div>  
            </li>
            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Resources</strong></a>
                <!-- <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> -->
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/using-attack-evaluations.html">Using ATT&CK Evaluations</a>
                        <a class="dropdown-item" href="/about.html">About ATT&CK</a>
                        <a class="dropdown-item" href="/FAQ.html">FAQ</a>                    
                        <a class="dropdown-item" href="/issues.html">Issue Tracker</a>
                        <a class="dropdown-item" href="https://medium.com/mitre-engenuity/tagged/evaluation" target="_blank"> Blog</strong>&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i> </a>
                    </div>  
                </li> 
            <li class='nav-item'><a  class='nav-link'  href='/get-evaluated.html'><strong>Get Evaluated</strong></a></li>
          </ul>
        </div>
    </nav>
    <div class="div-cfp">
        <h5 class="h5-cfp">
            The 2021 ATT&CK Evaluations for Enterprise Call for Participation is now open. 
            Click <a class="a-click-here" href="/get-evaluated.html">here</a>
             to learn how to participate.
        </h5>
    </div>
</header>
<div id='content'>

<div class='divEvaluationSummaryBody' id='div_vendor_comparison_main'>
    <div class='diff_div_breadcrumbs_tags'>
        <table style='width: 100%;'>
            <tr>
                <td style='width: 50%;'>
                    <div style="padding: 0px; width: 100%;"> 
                        <span class="spanBreadcrumbs-results"> 
                            <a href='/'> Home </a> &nbsp; > &nbsp; Vendor Comparison Tool
                        </span>
                    </div>
                </td>
                <td style='width: 50%; text-align: right;'>
                </td>
            </tr>
        </table>
    </div>

    <div class="ml-1 mt-5">
        <p>
            Need help using this tool? Try <a href="#" onclick="start_tour();">taking our tour</a>! 
        </p>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-2 diff_div_user_options">
                <div class="row diff_menu_section">
                    <div class="dropdown">
                        <div class="btn-group" role="group">
                            <button id="btnSelectRound" type="button" class="btn btn-engenuity-purple dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Select Round
                            </button>
                            <div class="dropdown-menu" id="round_dropdown" aria-labelledby="btnSelectRound" style="background-color: rgb(98, 65, 197); position: absolute; transform: translate3d(763px, 152px, 0px); top: 0px; left: 0px;" x-placement="bottom-start">  
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row diff_div_vendor_selects diff_menu_section">
                    <h5 style="margin-bottom: 0; line-height: 2;">Compare</h5>
                    <select class="form-control diff_vendor_select" id="diff_vendor1_select" data-column_uid="1"></select>
                    <h5 style="margin-bottom: 0; line-height: 2;">with </h5>
                    <select class="form-control diff_vendor_select" id="diff_vendor2_select" data-column_uid="2"></select>
                </div>
    
                <div class="row diff_div_filters diff_menu_section">
                    <h5 style="margin-bottom: 0; line-height: 2;">Filter by </h5>
                        <select class="form-control diff_filter" id="diff_match_filter" onchange="applyFilters(true);">
                            <option value="all_steps">All steps</option>
                            <option value="diffs">Different steps only</option>
                            <option value="matches">Matched steps only</option>
                        </select>
                        <select class="form-control diff_filter mt-3" id="diff_tactic_filter" onchange="applyFilters(true);">
                        </select>
                </div>
                <div class="row diff_div_filters diff_menu_section_last">
                        <button class="btn btn-engenuity-purple" style="display: block;" id="expand" onclick="open_all_cards(false)"><i class="fas fa-plus-square" style="margin-right: 5px;"></i>Expand All</button>
                        <button class="btn btn-engenuity-purple" style="display: none;" id="collapse" onclick="close_all_cards(false)"><i class="fas fa-minus-square"style="margin-right: 5px;"></i>Collapse All</button>
                </div>

                
            </div>
            <div class="col-10">
                <div class="diff_div_main" id="diff_div_main"></div>
                <a id="scrollUp" href="#" title="Back to top"><i class="fas fa-arrow-alt-circle-up"></i></a>
            </div>
        </div>

    </div>

</div>

<div class="divEvaluationSummaryBody" id="divTourBody" style="display: none;">
    <div class="diff_div_breadcrumbs_tags">
        <table style="width: 100%;">
            <tbody><tr>
                <td style="width: 50%;">
                    <div style="padding: 0px; width: 100%;"> 
                        <span class="spanBreadcrumbs-results"> 
                            <a href="/"> Home </a> &nbsp; &gt; &nbsp; Vendor Comparison Tool
                        </span>
                    </div>
                </td>
                <td style="width: 50%; text-align: right;">
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-2 diff_div_user_options">
                <div class="row diff_menu_section">
                    <div class="dropdown">
                        <div class="btn-group" role="group">
                            <button id="btnSelectRound_tour" type="button" class="btn btn-engenuity-purple dropdown-toggle disabled" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Round: Tour</button>
                            <div class="dropdown-menu" id="round_dropdown_tour" aria-labelledby="btnSelectRound" style="background-color: rgb(98, 65, 197); position: absolute; transform: translate3d(763px, 152px, 0px); top: 0px; left: 0px;" x-placement="bottom-start">  
                            <a id="APT3_tour" class="dropdown-item" style="color: white" href="javascript:void(0);" onclick="new_round_selected(this.id);">APT3</a><a id="APT29_tour" class="dropdown-item" style="color: white" href="javascript:void(0);" onclick="new_round_selected(this.id);">APT29</a></div>
                        </div>
                    </div>
                </div>
                
                <div class="row diff_div_vendor_selects diff_menu_section">
                    <h5 style="margin-bottom: 0; line-height: 2;">Compare</h5>
                    <select disabled class="form-control diff_vendor_select" id="diff_vendor1_select_tour" data-column_uid="1" onchange="if (this.selectedOptions) vendor_selected(this.selectedOptions[0], false);"><option data-vendorname="Bitdefender" data-displayname="Bitdefender" data-vendortable="v1" value="Bitdefender">Vendor A</option><option data-vendorname="CrowdStrike" data-displayname="CrowdStrike" data-vendortable="v1" value="CrowdStrike">Vendor B</option></select>
                    <h5 style="margin-bottom: 0; line-height: 2;">with </h5>
                    <select disabled class="form-control diff_vendor_select" id="diff_vendor2_select_tour" data-column_uid="1" onchange="if (this.selectedOptions) vendor_selected(this.selectedOptions[0], false);"><option data-vendorname="CrowdStrike" data-displayname="CrowdStrike" data-vendortable="v1" value="CrowdStrike">Vendor B</option></select>
                </div>
    
                <div class="row diff_div_filters diff_menu_section">
                    <h5 style="margin-bottom: 0; line-height: 2;">Filter by </h5>
                        <select disabled class="form-control diff_filter" id="diff_match_filter_tour" onchange="applyFilters(true);">
                            <option value="all_steps">All steps</option>
                            <option value="diffs">Different steps only</option>
                            <option value="matches">Matched steps only</option>
                        </select>
                        <select disabled class="form-control diff_filter mt-3" id="diff_tactic_filter_tour" onchange="applyFilters(true);"><option value="all_tactics">All tactics</option><option value="TA0002" data-tactic_name="Execution">Execution</option><option value="TA0003" data-tactic_name="Persistence">Persistence</option><option value="TA0004" data-tactic_name="Privilege Escalation">Privilege Escalation</option><option value="TA0005" data-tactic_name="Defense Evasion">Defense Evasion</option><option value="TA0006" data-tactic_name="Credential Access">Credential Access</option><option value="TA0007" data-tactic_name="Discovery">Discovery</option><option value="TA0008" data-tactic_name="Lateral Movement">Lateral Movement</option><option value="TA0009" data-tactic_name="Collection">Collection</option><option value="TA0010" data-tactic_name="Exfiltration">Exfiltration</option><option value="TA0011" data-tactic_name="Command and Control">Command and Control</option></select>
                </div>
                <div class="row diff_div_filters diff_menu_section_last">
                        <button class="btn btn-engenuity-purple disabled" style="display: block" id="expand_tour" onclick="open_all_cards(false)"><i class="fas fa-plus-square" style="margin-right: 5px;"></i>Expand All</button>
                        <button class="btn btn-engenuity-purple disabled" style="display: none;" id="collapse_tour" onclick="close_all_cards(false)"><i class="fas fa-minus-square" style="margin-right: 5px;"></i>Collapse All</button>
                </div>

                
            </div>
            <div class="col-10">
                
                <div class="diff_div_main" id="diff_div_main_tour">

                    <div class="diff_div_step_tid_card" id="div_1_A_1_T1032_tour" data-match_status="match" data-tactic_ids="TA0011" style="display: block;">
                        <div class="card w-100" style="border: none;">
                            <div class="card-header hoverpointer card-header-text collapsed" id="div_collapse_header_1_A_1_T1032_tour"
                                data-toggle="collapse" data-target="#div_collapse_body_1_A_1_T1032_tour" aria-expanded="false"
                                aria-controls="div_collapse_body_1_A_1_T1032_tour" onclick="check_expand_status(this);">
                                <h5 class="diff_substep_label">1.A.1</h5>
                                <h5 style="display: inline-block; margin-left: 40px; margin-bottom: 0;">Standard Cryptographic Protocol
                                    (T1032)</h5>
                            </div>
                            <div id="div_collapse_body_1_A_1_T1032_tour" class="collapse"
                                aria-labelledby="div_collapse_header_1_A_1_T1032_tour"
                                style="border-top: 1px solid rgba(0, 0, 0, 0.1);">
                                <table class="diff_step_tid_table" style="margin-bottom: 0px;">
                                    <tr class="tr_diff_row">
                                        <td class="td_diff_cell" style="visibility: hidden; font-size: 12px;">=</td>
                                        <td class="td_diff_proc_crit"><span class="span_proc_crit_title">
                                                <h6>Procedure: </h6>
                                            </span><span class="span_proc_crit">Used RC4 stream cipher to encrypt C2 (192.168.0.5)
                                                traffic</span></td>
                                    </tr>
                                    <tr class="tr_diff_row">
                                        <td class="td_diff_cell" style="visibility: hidden; font-size: 12px;">=</td>
                                        <td class="td_diff_proc_crit"><span class="span_proc_crit_title" style="margin-right:42px;">
                                                <h6>Criteria: </h6>
                                            </span><span class="span_proc_crit">Evidence that the network data sent over the C2 channel
                                                is encrypted</span></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>



                    

                    <div class="diff_div_step_tid_card" id="div_1_A_2_T1028_tour" data-match_status="no_match" data-tactic_ids="TA0002 TA0008" style="display: block;">
                        <div class="card w-100" style="border: none;">
                            <div class="card-header hoverpointer card-header-text-difference collapsed" id="div_collapse_header_1_A_2_T1028_tour"
                                data-toggle="collapse" data-target="#div_collapse_body_1_A_2_T1028_tour" aria-expanded="true"
                                aria-controls="div_collapse_body_1_A_2_T1028_tour" onclick="check_expand_status(this);">
                                <h5 class="diff_substep_label">1.A.2</h5>
                                <h5 style="display: inline-block; margin-left: 40px; margin-bottom: 0;">Windows Remote Management (T1028)
                                </h5>
                            </div>
                            <div id="div_collapse_body_1_A_2_T1028_tour" class="collapse" aria-labelledby="div_collapse_header_1_A_2_T1028_tour"
                                style="border-top: 1px solid rgba(0,0,0,.1);">
                                <table class="diff_step_tid_table" style="margin-bottom: 0px;">
                                    <tr class="tr_diff_row">
                                        <td class="td_diff_cell" style="visibility: hidden; font-size: 12px;">=</td>
                                        <td class="td_diff_proc_crit"><span class="span_proc_crit_title">
                                                <h6>Procedure: </h6>
                                            </span><span class="span_proc_crit">Established WinRM connection to remote host Scranton
                                                (10.0.1.4)</span></td>
                                    </tr>
                                    <tr class="tr_diff_row">
                                        <td class="td_diff_cell" style="visibility: hidden; font-size: 12px;">=</td>
                                        <td class="td_diff_proc_crit"><span class="span_proc_crit_title" style="margin-right:42px;">
                                                <h6>Criteria: </h6>
                                            </span><span class="span_proc_crit">Network connection to Scranton (10.0.1.4) over port
                                                5985</span></td>
                                    </tr>
                                </table>
                                <hr id="card_hr_tour">
                                <table class="diff_step_tid_table" id="diff_table_1_A_2_T1028_tour">
                                    <thead>
                                        <tr class="tr_diff_row">
                                            <th class="th_v1_detection_cell">
                                                <h5 class="sub-h5">Vendor A</h5>
                                            </th>
                                            <th class="th_v2_detection_cell">
                                                <h5 class="sub-h5">Vendor B</h5>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="tr_diff_row" id="same_tour">
                                            <td class="td_v1_detection_cell">
                                                <div class="card w-100">
                                                    <div class="card-header hover-pointer collapsed" data-toggle="collapse"
                                                        data-target=".detection_3283_body" aria-expanded="false"
                                                        aria-controls="detection_3283_body">
                                                        <h6 class="mb-0">Technique<img
                                                                src="https://d1zq5d3dtjfcoj.cloudfront.net/round2_technique.svg"
                                                                class="tc_img_detection_icon" title="Technique"></h6>
                                                        <h6 class="mb-0 sub-h6">Alert<img
                                                                src="https://d1zq5d3dtjfcoj.cloudfront.net/round2_alert.svg"
                                                                class="tc_img_detection_icon" title="Alert"></h6>
                                                    </div>
                                                    <div class="detection_3283_body collapse" aria-labelledby="detection_3283_header"
                                                        style="">
                                                        <div class="card-body"><span class="tc_span_detection_note">A Technique alert
                                                                detection (warning severity) called "WinRM Remote Execution" was generated
                                                                due to the execution of wsmprovhost.exe.<a
                                                                    href="https://d1zq5d3dtjfcoj.cloudfront.net/HanSight-APT29-3612.png"
                                                                    target="_blank"><sup>[1]</sup> </a></span></div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td_v2_detection_cell">
                                                <div class="card w-100">
                                                    <div class="card-header hover-pointer collapsed" data-toggle="collapse"
                                                        data-target=".detection_3283_body" aria-expanded="false"
                                                        aria-controls="detection_3283_body">
                                                        <h6 class="mb-0">Technique<img
                                                                src="https://d1zq5d3dtjfcoj.cloudfront.net/round2_technique.svg"
                                                                class="tc_img_detection_icon" title="Technique"></h6>
                                                        <h6 class="mb-0 sub-h6">Alert<img
                                                                src="https://d1zq5d3dtjfcoj.cloudfront.net/round2_alert.svg"
                                                                class="tc_img_detection_icon" title="Alert"></h6>
                                                    </div>
                                                    <div class="detection_3283_body collapse" aria-labelledby="detection_3283_header"
                                                        style="">
                                                        <div class="card-body"><span class="tc_span_detection_note">A Technique alert
                                                                detection (red indicator) was generated for "Powershell or WinRM remoting
                                                                activity" based on wsmprovhost.exe.</span></div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="tr_diff_row" id="different_tour">
                                            <td class="td_v1_detection_cell">
                                                <div class="card w-100">
                                                    <div class="card-header collapsed hover-pointer" data-toggle="collapse"
                                                        data-target=".detection_3285_body" aria-expanded="false"
                                                        aria-controls="detection_3285_body" style="background-color: lightgrey" id="div_detection1_expand_tour1">
                                                        <h6 class="mb-0">Telemetry<img
                                                                src="https://d1zq5d3dtjfcoj.cloudfront.net/round2_telemetry.svg"
                                                                class="tc_img_detection_icon" title="Telemetry"></h6>
                                                        <h6 class="mb-0 sub-h6" style="visibility: hidden;">placeholder</h6>
                                                    </div>
                                                    <div class="collapse detection_3285_body" aria-labelledby="detection_3285_header" id="div_detection1_expand_tour2">
                                                        <div class="card-body"><span class="tc_span_detection_note">Telemetry showed network
                                                                connection to a remote host over port TCP 1234.</span></div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td_v2_detection_cell">
                                                <div class="card w-100">
                                                    <div class="card-header collapsed hover-pointer" data-toggle="collapse"
                                                        data-target=".detection_3285_body" aria-expanded="false"
                                                        aria-controls="detection_3285_body" style="background-color: lightgrey" id="div_detection2_expand_tour1">
                                                        <h6 class="mb-0">Telemetry<img
                                                                src="https://d1zq5d3dtjfcoj.cloudfront.net/round2_telemetry.svg"
                                                                class="tc_img_detection_icon" title="Telemetry"></h6>
                                                        <h6 class="mb-0 sub-h6">Correlated<img
                                                                src="https://d1zq5d3dtjfcoj.cloudfront.net/round2_correlated.svg"
                                                                class="tc_img_detection_icon" title="Correlated"></h6>
                                                    </div>
                                                    <div class="collapse detection_3285_body" aria-labelledby="detection_3285_header" id="div_detection2_expand_tour2">
                                                        <div class="card-body"><span class="tc_span_detection_note">Telemetry showed network
                                                                connection to a remote host over port TCP 1234. The
                                                                detection was correlated to a parent alert.</div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>







                </div>
            </div>
        </div>

    </div>

</div>


<script type="text/javascript">
    var json_data = {
        "APT3" : {'Round': '1', 'Steps': [{'Substep': '1.A.1', 'Procedure': 'Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)', 'Techniques': [{'TechniqueId': 'T1204', 'TechniqueName': 'User Execution', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated indicating that the user Debbie executed Resume Viewer.exe. This alert had a severity score of 51/100 and was based upon "Newly Executed Applications".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing Resume Viewer.exe execution sequence'}, {'ScreenshotName': 'CB-1.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed Resume Viewer.exe running along with its children.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing Resume Viewer.exe execution sequence'}, {'ScreenshotName': 'CB-1.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert for Machine Learning showed that Resume Viewer.exe was executed and that it was detected as malicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.A.1-1.png', 'ScreenshotCaption': 'Machine Learning General Behavior alert showing execution of Resume Viewer.exe and detection as malicious'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the alert showed that Resume Viewer.exe executed, and would also be available in a separate view.[CS8]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.A.1-1.png', 'ScreenshotCaption': 'Machine Learning General Behavior alert showing execution of Resume Viewer.exe and detection as malicious'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated based on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-1.A.1-10.png', 'ScreenshotCaption': 'General Behavior alert identifying Resume Viewer.exe as unknown malware'}, {'ScreenshotName': 'CR-1.A.1-11.png', 'ScreenshotCaption': 'General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file'}, {'ScreenshotName': 'CR-1.A.1-100.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated based on the identification of Resume Viewer.exe as unknown malware by the Anti-Malware engine. [CR1]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-1.A.1-10.png', 'ScreenshotCaption': 'General Behavior alert identifying Resume Viewer.exe as unknown malware'}, {'ScreenshotName': 'CR-1.A.1-11.png', 'ScreenshotCaption': 'General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file'}, {'ScreenshotName': 'CR-1.A.1-100.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)'}], 'Footnotes': [' Vendor stated that the capability would have prevented the execution of Resume Viewer.exe.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that Resume Viewer.exe was executed and running as a process. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious. [CR2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-1.A.1-10.png', 'ScreenshotCaption': 'General Behavior alert identifying Resume Viewer.exe as unknown malware'}, {'ScreenshotName': 'CR-1.A.1-11.png', 'ScreenshotCaption': 'General Behavior alert for explorer.exe executing Resume Viewer.exe, identified as a known malicious file'}, {'ScreenshotName': 'CR-1.A.1-100.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe running as a process (tainted by parent alert on explorer.exe)'}], 'Footnotes': [' The provided screenshot was captured later in the evaluation and includes additional information appended to explorer.exe not relevant to this procedure.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for Malicious File Detection on the execution of Resume Viewer.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-01-1.png', 'ScreenshotCaption': 'Malicious File Detection General Behavior alert on Resume Viewer.exe execution and surrounding telemetry'}, {'ScreenshotName': 'EG-01-2.png', 'ScreenshotCaption': 'Event tree view showing Malicious File Detection General Behavior alert on Resume Viewer.exe execution'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed events surrounding the Resume Viewer.exe event to indicate execution (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-01-1.png', 'ScreenshotCaption': 'Malicious File Detection General Behavior alert on Resume Viewer.exe execution and surrounding telemetry'}, {'ScreenshotName': 'EG-01-2.png', 'ScreenshotCaption': 'Event tree view showing Malicious File Detection General Behavior alert on Resume Viewer.exe execution'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for the execution of a rare file (Resume Viewer.exe). [CC1] [CC4]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing the execution of Resume Viewer.exe'}], 'Footnotes': ['The vendor reported that this behavior would have been prevented from executing.', 'Screenshot is unavailable due to sensitivity of alert logic.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of Resume Viewer.exe as a process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing the execution of Resume Viewer.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for the Resume Viewer.exe file due to it being labeled as malicious by a machine learning engine. The alert was generated after a configuration change of the file size limit for the machine learning engine. [FE1][FE2]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'FE-1.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)'}, {'ScreenshotName': 'FE-1.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe being executed by explorer.exe'}], 'Footnotes': [' The vendor reported that this file would have been quarantined and prevented from executing.  ', 'The scan type used to produce this alert is On-access, which means the scan occurs on file writes and executions.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Resume Viewer.exe executing with a parent process of explorer.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-1.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)'}, {'ScreenshotName': 'FE-1.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe being executed by explorer.exe'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that Resume Viewer.exe was executed. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe running (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that Resume Viewer.exe was executed by Explorer.exe by user Debbie.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-1.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing that Resume Viewer.exe was executed by Explorer.exe by user Debbie'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the user execution sequence of Resume Viewer.exe with multiple files written and subsequently executed.[MS1]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-1.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of Resume Viewer.exe from explorer.exe and dropping pdfhelper.cmd and autoupdate.bat'}, {'ScreenshotName': 'MS-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing write of pdfhelper.cmd'}, {'ScreenshotName': 'MS-1.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing write of autoupdate.bat'}, {'ScreenshotName': 'MS-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing execution of pdfhelper.cmd and update.dat'}, {'ScreenshotName': 'MS-1.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing execution of decoy PDF by MicrosoftPdfReader.exe'}, {'ScreenshotName': 'MS-1.A.1-6.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe binary and process metadata'}, {'ScreenshotName': 'MS-1.A.1-7.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe binary reputation'}, {'ScreenshotName': 'MS-1.A.1-8.png', 'ScreenshotCaption': 'Exploit Guard audit of Resume Viewer.exe'}], 'Footnotes': ['Resume Viewer.exe was audited by Exploit Guard and the vendor stated that the audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that Resume Viewer.exe was executed and running as a process owned by user Debbie.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-1.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe running as a process'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of Resume Viewer.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-01-1.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe execution'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated due to static analysis of the file through the DFI resulting in it being marked as suspicious, which generated a story (group ID) that subsequent linked events are tainted by.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-1.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing execution of Resume Viewer.exe'}, {'ScreenshotName': 'S1-1.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert for execution of Resume Viewer.exe as a suspicious file'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Resume Viewer.exe execution with subsequent file writes and execution.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-1.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing execution of Resume Viewer.exe'}, {'ScreenshotName': 'S1-1.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert for execution of Resume Viewer.exe as a suspicious file'}], 'Footnotes': []}]}]}]}, {'Substep': '1.A.1', 'Procedure': 'Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32', 'Techniques': [{'TechniqueId': 'T1085', 'TechniqueName': 'Rundll32', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the rundll32.exe execution with the correct ATT&CK Technique (T1085, which corresponds to the Rundll32 Technique).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe'}, {'ScreenshotName': 'CB-1.A.1-1.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed the Resume Viewer.exe execution sequence and rundll32.exe executing.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe'}, {'ScreenshotName': 'CB-1.A.1-1.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated due to rundll32 launching a suspended process. The alert was mapped to the correct ATT&CK Technique (Rundll32) and Tactic (Defense Evasion).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)'}, {'ScreenshotName': 'CS-1.A.1-4.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating rundll32 execution was suspicious'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating rundll32 executing update.dat was suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-1.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)'}, {'ScreenshotName': 'CS-1.A.1-4.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating rundll32 execution was suspicious'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the OverWatch alert showed rundll32.exe executing, and would also be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert showing rundll32 execution (mapped to correct ATT&CK Technique, Rundll32, and Tactic, Defense Evasion. Green arrow indicates injection.)'}, {'ScreenshotName': 'CS-1.A.1-4.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating rundll32 execution was suspicious'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for injected shellcode by a compromised legitimate process (rundll32.exe). The alert was tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection) and was tainted by parent alert on rundll32.exe injection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-1.A.1-200.png', 'ScreenshotCaption': 'Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)'}, {'ScreenshotName': 'CR-1.A.1-101.png', 'ScreenshotCaption': 'Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)'}, {'ScreenshotName': 'CR-1.A.1-30.png', 'ScreenshotCaption': 'Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for rundll32.exe launching a module in a temporary folder and injecting shell code into a victim process. The alert was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-1.A.1-200.png', 'ScreenshotCaption': 'Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)'}, {'ScreenshotName': 'CR-1.A.1-101.png', 'ScreenshotCaption': 'Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)'}, {'ScreenshotName': 'CR-1.A.1-30.png', 'ScreenshotCaption': 'Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the rundll32.exe injection alert also showed full command-line arguments of rundll32.exe executing update.dat. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious. [CR4]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-1.A.1-200.png', 'ScreenshotCaption': 'Specific Behavior alert for rundll32.exe launching a module from a temporary folder and injecting shellcode into a victim process (tainted by parent alert on explorer.exe)'}, {'ScreenshotName': 'CR-1.A.1-101.png', 'ScreenshotCaption': 'Telemetry within the rundll32.exe injection alert showing command-line arguments of rundll32.exe running update.dat (tainted by parent alert on explorer.exe)'}, {'ScreenshotName': 'CR-1.A.1-30.png', 'ScreenshotCaption': 'Specific Behavior alert for rundll32.exe, identified as a compromised legitimate process, injecting shellcode into rundll32.exe, tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability and counted as a separate detection.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert called RunDLL32 with Suspicious DLL Location was generated due to rundll32.exe running update.dat. The alert was also tagged with the correct ATT&CK Technique (T1085 - Rundll32) and Tactics (Defense Evasion, Execution) and was tainted by a parent Malicious File Detection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-01-10.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe running update.dat execution event'}, {'ScreenshotName': 'EG-01-2.png', 'ScreenshotCaption': 'Event tree view showing the Malicious File Detection alert tainting rundll32.exe telemetry'}, {'ScreenshotName': 'EG-01-11.png', 'ScreenshotCaption': 'Specific Behavior alert for RunDLL32 with Suspicious DLL Location and surrounding telemetry\xa0 (tagged with correct ATT&CK Technique, T1085 - Rundll32 and Tactics, Defense Evasion, Execution; tainted by parent Malicious File Detection alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe running update.dat. The telemetry was tainted by a parent Malicious File Detection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-01-10.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe running update.dat execution event'}, {'ScreenshotName': 'EG-01-2.png', 'ScreenshotCaption': 'Event tree view showing the Malicious File Detection alert tainting rundll32.exe telemetry'}, {'ScreenshotName': 'EG-01-11.png', 'ScreenshotCaption': 'Specific Behavior alert for RunDLL32 with Suspicious DLL Location and surrounding telemetry\xa0 (tagged with correct ATT&CK Technique, T1085 - Rundll32 and Tactics, Defense Evasion, Execution; tainted by parent Malicious File Detection alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for rundll32.exe executing in a way typical for rundll32 injections. [CC4]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat'}], 'Footnotes': ['Screenshot is unavailable due to sensitivity of alert logic.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for an unusual call to rundll32.exe. [CC4]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat'}], 'Footnotes': ['Screenshot is unavailable due to sensitivity of alert logic.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing update.dat.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified use of rundll32.exe to execute update.dat with command-line arguments. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-1.A.1-3.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)'}, {'ScreenshotName': 'FE-1.A.1-6.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched rundll32.exe with an alert for Rundll32 Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1085 - Rundll32) and Tactics (Defense Evasion, Execution).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-1.A.1-3.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)'}, {'ScreenshotName': 'FE-1.A.1-6.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that cmd.exe created the rundll32.exe process that started update.dat. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-1.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe launched rundll32.exe (tainted by the Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'Specific Behavior alerts were generated based on suspicious indicators that a "Loaded non-DLL and non-CPL file with specified parameters via rundll32." The alerts were tagged with the correct ATT&CK Tactic (Defense Evasion, Execution) and Technique (Rundll32).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-1.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing update.dat via rundll32.exe'}, {'ScreenshotName': 'MC-1.B.1-6.png', 'ScreenshotCaption': 'Process tree within trace detection showing rundll32.exe executing (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-1.A.1-23.png', 'ScreenshotCaption': 'Specific Behavior alerts based on suspicious indicators that a "Loaded non-DLL and non-CPL file with specified parameters via rundll32." The alerts were tagged with the correct ATT&CK Tactic (Defense Evasion, Execution) and Technique (Rundll32)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing update.dat via rundll32.exe. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-1.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing update.dat via rundll32.exe'}, {'ScreenshotName': 'MC-1.B.1-6.png', 'ScreenshotCaption': 'Process tree within trace detection showing rundll32.exe executing (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-1.A.1-23.png', 'ScreenshotCaption': 'Specific Behavior alerts based on suspicious indicators that a "Loaded non-DLL and non-CPL file with specified parameters via rundll32." The alerts were tagged with the correct ATT&CK Tactic (Defense Evasion, Execution) and Technique (Rundll32)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for a low-reputation DLL loaded by a signed executable due to rundll32.exe execution of update.dat.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-1.A.1-10.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe process injection sequence'}, {'ScreenshotName': 'MS-1.A.1-13.png', 'ScreenshotCaption': 'General Behavior alert on low-reputation DLL load by signed executable'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for rundll32.exe running update.dat.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-1.A.1-10.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe process injection sequence'}, {'ScreenshotName': 'MS-1.A.1-13.png', 'ScreenshotCaption': 'General Behavior alert on low-reputation DLL load by signed executable'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'Specific Behavior alerts were generated for rundll32. The alerts were tagged with the correct ATT&CK Technique (Rundll32) and were tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts for rundll32 tagged with the correct ATT&CK Technique (Rundll32) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-6.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe executing update.dat, identified as a suspicious DLL and malware (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-7.png', 'ScreenshotCaption': 'Additional details of General Behavior alert for rundll32.exe executing update.dat'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated based on rundll32.exe executing update.dat, identified as a suspicious DLL and malware. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine. [PA1]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts for rundll32 tagged with the correct ATT&CK Technique (Rundll32) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-6.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe executing update.dat, identified as a suspicious DLL and malware (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-7.png', 'ScreenshotCaption': 'Additional details of General Behavior alert for rundll32.exe executing update.dat'}], 'Footnotes': ['Vendor stated the capability would have prevented execution of update.dat.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing update.dat with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts for rundll32 tagged with the correct ATT&CK Technique (Rundll32) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-6.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe executing update.dat, identified as a suspicious DLL and malware (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.A.1-7.png', 'ScreenshotCaption': 'Additional details of General Behavior alert for rundll32.exe executing update.dat'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe launching rundll32.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-01-1.png', 'ScreenshotCaption': 'Telemetry showing execution of Resume Viewer.exe'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing as a result of Resume Viewer.exe running. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-1.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing rundll32.exe (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '1.A.1', 'Procedure': 'Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)', 'Techniques': [{'TechniqueId': 'T1064', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the cmd.exe execution with the correct ATT&CK Technique (T1064 - Scripting).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-1.A.1-3.png', 'ScreenshotCaption': 'Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script'}, {'ScreenshotName': 'CB-1.A.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing the pdfhelper.cmd script.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-1.A.1-3.png', 'ScreenshotCaption': 'Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script'}, {'ScreenshotName': 'CB-1.A.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating the execution of pdfhelper.cmd was suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-1.A.1-5.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating pdfhelper.cmd execution was suspicious'}, {'ScreenshotName': 'CS-1.A.1-7.png', 'ScreenshotCaption': 'Telemetry showing pdfhelper.cmd execution'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed pdfhelper.cmd being executed by cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.A.1-5.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating pdfhelper.cmd execution was suspicious'}, {'ScreenshotName': 'CS-1.A.1-7.png', 'ScreenshotCaption': 'Telemetry showing pdfhelper.cmd execution'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe launching pdfhelper.cmd. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-1.A.1-20.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe launching pdfhelper.cmd (tainted by parent alert on explorer.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing pdfhelper.cmd as well as pdfhelper.cmd spawning as a child process of Resume Viewer.exe. The telemetry was tainted by a parent Malicious File Detection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-01-3.png', 'ScreenshotCaption': 'Telemetry showing pdfhelper.cmd spawned as a child process of Resume Viewer.exe (tainted by parent Malicious File Detection alert)'}, {'ScreenshotName': 'EG-01-9.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe process creation and execution of pdfhelper.cmd (tainted by parent Malicious File Detection alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running pdfhelper.cmd) has been tagged for monitoring because its parent process has a detection (Resume Viewer.exe). [CC4]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing the execution of pdfhelper.cmd'}], 'Footnotes': ['Screenshot is unavailable due to sensitivity of alert logic.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed pdfhelper.cmd was executed by cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing the execution of pdfhelper.cmd'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Resume Viewer.exe spawning the child process cmd.exe to launch pdfhelper.cmd.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing the child cmd.exe process running the pdfhelper.cmd script'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that Resume Viewer.exe created cmd.exe, which ran the script pdfhelper.cmd. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-1.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe running pdfhelper.cmd (tainted by the Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed pdfhelper.cmd being executed by cmd.exe. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-1.B.1-5.png', 'ScreenshotCaption': 'Telemetry showing pdfhelper.cmd execution'}, {'ScreenshotName': 'MC-1.B.1-6.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing pdfhelper.cmd (tainted by a parent alert on Resume Viewer.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within a process tree showed the child cmd.exe process running the script pdfhelper.cmd.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for execution of the Windows script engine. The alert was tagged with the correct ATT&CK Technique (Scripting).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe launching pdfhelper.cmd'}, {'ScreenshotName': 'PA-1.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of Windows script engine tagged with the correct ATT&CK Technique (Scripting)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe launching pdfhelper.cmd.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-1.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe launching pdfhelper.cmd'}, {'ScreenshotName': 'PA-1.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of Windows script engine tagged with the correct ATT&CK Technique (Scripting)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed the execution sequence of Resume Viewer.exe executing cmd.exe, which executed rundll32.exe (the pdfhelper.cmd script was not shown).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-01-1.png', 'ScreenshotCaption': 'Telemetry showing Resume Viewer.exe execution (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing the pdfhelper.cmd script. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing the child cmd.exe process running the script pdfhelper.cmd (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '1.B.1', 'Procedure': 'Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder', 'Techniques': [{'TechniqueId': 'T1060', 'TechniqueName': 'Registry Run Keys / Startup Folder', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe with the correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing filemods indicating update.bat was written to the Startup folder'}, {'ScreenshotName': 'CB-1.B.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed filemods indicating the creation and file write of autoupdate.bat to the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing filemods indicating update.bat was written to the Startup folder'}, {'ScreenshotName': 'CB-1.B.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Registry activity related to the Startup folder. Though no screenshot of the file write is available, this data maybe indicative of modifications to the folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing Registry modification related to Startup Folder'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed cmd.exe rewriting autoupdate.bat to the user Debbie's Startup folder. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-1.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing rename file event for autoupdate.bat'}, {'ScreenshotName': 'CR-1.B.1-100.png', 'ScreenshotCaption': 'Process tree showing the cmd.exe associated with the autoupdate.bat file event (tainted by parent alert on explorer.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert called "Detected Persistence - Start Folder Persistence" was generated due to cmd.exe writing autoupdate.bat to the Startup folder. The alert was also tagged with the correct ATT&CK Technique (T1060 - Registry Run Keys / Start Folder) and Tactic (Persistence). The Specific Behavior alert was tainted by a parent Malicious File Detection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-01-8.png', 'ScreenshotCaption': 'Telemetry showing autoupdate.bat written to the Start Menu (tainted by parent Malicious File Detection alert)'}, {'ScreenshotName': 'EG-01-7.png', 'ScreenshotCaption': '\\"Detected Persistence - Start Folder Persistence\\" Specific Behavior alert related to autoupdate.bat (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Start Folder, and Tactic, Persistence; tainted by cmd.exe generating the alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed autoupdate.bat written to the Start Menu. The telemetry was tainted by a parent Malicious File Detection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-01-8.png', 'ScreenshotCaption': 'Telemetry showing autoupdate.bat written to the Start Menu (tainted by parent Malicious File Detection alert)'}, {'ScreenshotName': 'EG-01-7.png', 'ScreenshotCaption': '\\"Detected Persistence - Start Folder Persistence\\" Specific Behavior alert related to autoupdate.bat (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Start Folder, and Tactic, Persistence; tainted by cmd.exe generating the alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.bat from within the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.B.1-T1060-new.png', 'ScreenshotCaption': 'Telemetry showing the autoupdate.bat within the Startup folder'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified the backdoor persisted by executing autoupdate.bat at system start due to its presence in the Startup directory.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing autoupdate.bat file written to the Startup folder'}, {'ScreenshotName': 'FE-1.B.1-2.png', 'ScreenshotCaption': 'Enrichment of autoupdate.bat being written to Startup with Persistence category'}, {'ScreenshotName': 'FE-1.B.1-3.png', 'ScreenshotCaption': 'Additional details on enrichment of autoupdate.dat'}, {'ScreenshotName': 'FE-1.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the file write of autoupdate.bat to the Startup folder by categorizing it as Persistence.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing autoupdate.bat file written to the Startup folder'}, {'ScreenshotName': 'FE-1.B.1-2.png', 'ScreenshotCaption': 'Enrichment of autoupdate.bat being written to Startup with Persistence category'}, {'ScreenshotName': 'FE-1.B.1-3.png', 'ScreenshotCaption': 'Additional details on enrichment of autoupdate.dat'}, {'ScreenshotName': 'FE-1.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed autoupdate.bat being written to the Startup folder.[FE50]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing autoupdate.bat file written to the Startup folder'}, {'ScreenshotName': 'FE-1.B.1-2.png', 'ScreenshotCaption': 'Enrichment of autoupdate.bat being written to Startup with Persistence category'}, {'ScreenshotName': 'FE-1.B.1-3.png', 'ScreenshotCaption': 'Additional details on enrichment of autoupdate.dat'}, {'ScreenshotName': 'FE-1.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)'}], 'Footnotes': ['The alert mapped to two ATT&CK Techniques (T1059 - Command-Line Interface and T1105 - Remote File Copy), but they were not directly related to the Registry Run Keys / Startup Folder Technique under test in this procedure.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that autoupdate.bat was created in the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing autoupdate.bat created in Startup folder'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for "An exe/bat/lnk/dll file has been copied or renamed in the Windows Startup Folder" for persistence based on pdfhelper.cmd. The alert was tagged with the correct ATT&CK Tactic (Persistence) and Technique (Registry Run Keys / Start Folder).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-1.B.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for "An exe/bat/lnk/dll file has been copied or renamed in the Windows Startup Folder" for persistence based on pdfhelper.cmd, tagged with the correct ATT&CK Tactic (Persistence) and Technique (Registry Run Keys / Start Folder)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed the execution sequence for Resume Viewer.exe writing autoupdate.bat to Debbie's Startup folder to establish persistence.", 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing write of autoupdate.bat to startup folder'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a file being created in the Startup folder with the correct ATT&CK Technique (Registry Run Keys / Start Folder). The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.[PA6]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-1.B.1-1.png', 'ScreenshotCaption': "Telemetry showing autoupdate.bat being moved to the user Debbie's Startup folder (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {'ScreenshotName': 'PA-1.B.1-2.png', 'ScreenshotCaption': 'Enrichment of a file being created in the Startup folder tagged with the correct ATT&CK Technique (Registry Run Keys / Start Folder) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': ['The logic to produce the enrichment was configured after the start of the evaluation so it is identified as a config change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed autoupdate.bat being moved to the user Debbie's Startup folder. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-1.B.1-1.png', 'ScreenshotCaption': "Telemetry showing autoupdate.bat being moved to the user Debbie's Startup folder (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)"}, {'ScreenshotName': 'PA-1.B.1-2.png', 'ScreenshotCaption': 'Enrichment of a file being created in the Startup folder tagged with the correct ATT&CK Technique (Registry Run Keys / Start Folder) (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a cmd.exe "rename to executable" event for autoupdate.bat in the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-01-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe \\"rename to executable\\" event for autoupdate.bat in Startup folder'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry on actions performed from Resume Viewer.exe showed autoupdate.bat being written to the Startup Folder. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-1.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing autoupdate.bat write to the Startup folder (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '1.C.1', 'Procedure': 'Cobalt Strike: C2 channel established using port 53', 'Techniques': [{'TechniqueId': 'T1043', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a network connection over UDP port 53.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing network connection over UDP port 53'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though DNS requests for freegoogleadsenseinfo.com (C2 domain) were observed (no detection showed port 53 specifically).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.C.1-1.png', 'ScreenshotCaption': 'OverWatch alert showing suspicious DNS traffic (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed port 53 command and control traffic.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-1.C.1-10.png', 'ScreenshotCaption': 'Telemetry showing port 53 command and control traffic'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though DNS requests were observed (no detection showed port 53 specifically).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it observed the use of UDP port 53 for DNS command and control traffic. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 53 command and control traffic'}, {'ScreenshotName': 'FE-1.C.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed port 53 command and control traffic.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 53 command and control traffic'}, {'ScreenshotName': 'FE-1.C.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though DNS requests were observed (no detection showed port 53 specifically).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[MS99]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS requests to the C2 domain (custom query) (does not count as a detection)'}], 'Footnotes': ['DNS requests were observed (no detection showed port 53 specifically).']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a scripting engine (rundll32.exe) making a network connection over DNS ports. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 53 command and control traffic (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a scripting engine (rundll32.exe) making a network connection over DNS ports (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed port 53 command and control traffic. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.[PA2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 53 command and control traffic (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-1.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a scripting engine (rundll32.exe) making a network connection over DNS ports (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[SO97]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['DNS requests were observed (no detection showed port 53 specifically).']}]}]}]}, {'Substep': '1.C.1', 'Procedure': 'Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com', 'Techniques': [{'TechniqueId': 'T1071', 'TechniqueName': 'Standard Application Layer Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for abnormally large DNS requests for freegoogleadsenseinfo.com (C2 domain) being sent. The alert was mapped to a related ATT&CK Technique (Exfiltration Over Alternative Protocol) and Tactic (Exfiltration).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious'}, {'ScreenshotName': 'CS-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS requests'}, {'ScreenshotName': 'CS-E-4.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a Specific Behavior occurred because they observed suspected command and control or data exfiltration via DNS.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-1.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious'}, {'ScreenshotName': 'CS-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS requests'}, {'ScreenshotName': 'CS-E-4.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch also generated a General Behavior alert indicating the DNS traffic was suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-1.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious'}, {'ScreenshotName': 'CS-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS requests'}, {'ScreenshotName': 'CS-E-4.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the OverWatch alert showed the DNS requests, and would also be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-1.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing abnormally large DNS requests mapped to related ATT&CK Technique, Exfiltration Over Alternative Protocol, and Tactic, Exfiltration) and OverWatch General Behavior alert indicating that traffic was suspicious'}, {'ScreenshotName': 'CS-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS requests'}, {'ScreenshotName': 'CS-E-4.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating they observed suspected command and control or data exfiltration via DNS (Specific Behavior)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-1.C.1-20.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-1.C.1-100.png', 'ScreenshotCaption': 'Process tree showing rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry in the event tree view showed DNS requests spawning from rundll32.exe to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Malicious File Detection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-01-5.png', 'ScreenshotCaption': 'Telemetry showing DNS requests from rundll32.exe (tainted by parent Malicious File Detection alert)'}, {'ScreenshotName': 'EG-01-6.png', 'ScreenshotCaption': 'Telemetry showing DNS connections'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a trace of DNS queries being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.C.1-T1071-new.png', 'ScreenshotCaption': 'Telemetry showing rundll32 making DNS queries'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that command and control occurred via DNS. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-1.C.1-2.png', 'ScreenshotCaption': 'Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)'}, {'ScreenshotName': 'FE-1.C.1-5.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated for the hardcoded DNS record name syntax in the DNS lookups for freegoogleadsenseinfo.com (C2 domain). The alert was also tagged with the correct ATT&CK Technique (T1071 - Standard Application Layer Protocol) and Tactic (Command and Control).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-1.C.1-2.png', 'ScreenshotCaption': 'Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)'}, {'ScreenshotName': 'FE-1.C.1-5.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that DNS requests to freegoogleadsenseinfo.com (C2 domain) were being performed out of svchost.exe on Nimda.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS queries to freegoogleadsenseinfo.com (C2 domain) from svchost.exe'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from showed DNS requests to freegoogleadsenseinfo.com (C2 domain).[MS3]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'MS-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS requests to the C2 domain (custom query)'}], 'Footnotes': ['The vendor stated that DNS telemetry is captured but it was not immediately visible in the portal. The vendor made changes to the portal during the test to enable by default the visibility of these events.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[PA2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed DNS requests to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS requests to the C2 domain (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '1.C.1', 'Procedure': 'Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding', 'Techniques': [{'TechniqueId': 'T1132', 'TechniqueName': 'Data Encoding', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the base64-encoded DNS requests for freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the parent Exfiltration alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-1.C.1-2.png', 'ScreenshotCaption': 'Telemetry within an alert showing encoded DNS requests (tainted by parent Exfiltration alert)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed base64-encoded DNS requests for freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-1.C.1-20.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-1.C.1-100.png', 'ScreenshotCaption': 'Process tree showing rundll32.exe making encoded DNS queries to freegoogleadsenseinfo.com (C2 Domain) (tainted by parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a trace of encoded DNS queries being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-1.C.1-T1071-new.png', 'ScreenshotCaption': 'Telemetry showing rundll32 making encoded DNS queries'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed base64-encoded DNS requests to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the parent Cobalt Strike DNS Beacon alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-1.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing encoded DNS requests (tainted by parent Cobalt Strike DNS Beacon alert)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the capability identified DNS queries (no detection showed data encoding specifically).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[PA2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed DNS requests with encoded content to freegoogleadsenseinfo.com (the C2 domain). The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-1.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing stream of DNS requests with encoded data'}, {'ScreenshotName': 'S1-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS query for freegoogleadsenseinfo.com (C2 domain) (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.A.1', 'Procedure': "Cobalt Strike: 'ipconfig -all' via cmd", 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing ipconfig.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing ipconfig.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing ipconfig.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because ipconfig was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing ipconfig with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (ipconfig not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating ipconfig was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing ipconfig with command-line arguments. The process tree showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran ipconfig) were considered tainted and suspicious.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing ipconfig with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (ipconfig not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating ipconfig was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.A.1-10.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing ipconfig with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing ipconfig with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.A.1-10.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing ipconfig with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-1.png', 'ScreenshotCaption': 'Unusual Child Processes of RunDLL32 General Behavior alert caused by ipconfig.exe (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-2.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert called Unusual Child Process of RunDLL32 was generated for cmd.exe executing ipconfig.exe with command-line arguments. The alert was tainted as part of the event tree under a parent Malicious File Detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-1.png', 'ScreenshotCaption': 'Unusual Child Processes of RunDLL32 General Behavior alert caused by ipconfig.exe (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-2.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing ipconfig.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-1.png', 'ScreenshotCaption': 'Unusual Child Processes of RunDLL32 General Behavior alert caused by ipconfig.exe (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-2.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing ipconfig) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)'}, {'ScreenshotName': 'CC-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-2.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)'}, {'ScreenshotName': 'CC-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-2.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe with a tag identifying the command as enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing ipconfig)'}, {'ScreenshotName': 'CC-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-2.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running ipconfig) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that ipconfig.exe was one of the reconnaissance commands performed to enumerate the network configuration of Nimda. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.A.1-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)'}, {'ScreenshotName': 'FE-2.A.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe with an alert for Ipconfig Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.A.1-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)'}, {'ScreenshotName': 'FE-2.A.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing ipconfig.exe with command-line arguments and enriched the command with the condition Ipconfig All Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT21]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.A.1-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with condition Ipconfig All Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the ipconfig utility displayed configuration information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing ipconfig.exe (tainted by a trace detection on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the ipconfig utility displayed configuration information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing ipconfig.exe (tainted by a trace detection on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the ipconfig utility displayed configuration information'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration commands that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for ipconfig.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of discovery techniques'}, {'ScreenshotName': 'MS-2.A.1-4.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of discovery techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing ipconfig.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for ipconfig.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of discovery techniques'}, {'ScreenshotName': 'MS-2.A.1-4.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of discovery techniques'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for a commonly abused process (cmd.exe) spawning out of rundll32.exe. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}, {'ScreenshotName': 'PA-2.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}, {'ScreenshotName': 'PA-2.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of ipconfig.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}, {'ScreenshotName': 'PA-2.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing ipconfig with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing ipconfig with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}, {'ScreenshotName': 'PA-2.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of ipconfig.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for a commonly abused process (cmd.exe) spawning out of rundll32.exe (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-1.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.A.2', 'Procedure': "Cobalt Strike: 'arp -a' via cmd", 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched arp.exe with a related ATT&CK Technique (T1018 - Remote System Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing arp.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing arp.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing arp.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because arp was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing arp with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (arp not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating arp was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing arp with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran arp) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing arp with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (arp not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating arp was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed arp.exe executing with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.A.2-5.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing arp with command-line arguments'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing arp with command-line arguments'}, {'ScreenshotName': 'CR-2.A.2-10.png', 'ScreenshotCaption': 'Telemetry showing arp.exe executing within the process tree (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-3.png', 'ScreenshotCaption': 'Telemetry showing arp.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing arp.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-3.png', 'ScreenshotCaption': 'Telemetry showing arp.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe indicating its usage can be a sign of reconnaissance'}, {'ScreenshotName': 'CC-2.A.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched arp.exe indicating its usage can be a sign of reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe indicating its usage can be a sign of reconnaissance'}, {'ScreenshotName': 'CC-2.A.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running arp) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that arp.exe was one of the reconnaissance commands performed to enumerate the network configuration of Nimda. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)'}, {'ScreenshotName': 'FE-2.A.1-5.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about arp.exe execution'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched arp.exe with an alert for Arp Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.A.1-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)'}, {'ScreenshotName': 'FE-2.A.1-5.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about arp.exe execution'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing arp.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing arp.exe with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the arp.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the contents of the local ARP cache table was viewed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing arp.exe (tainted by a trace detection on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of arp.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the contents of the local ARP cache table was viewed'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing arp.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing arp.exe (tainted by a trace detection on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of arp.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the contents of the local ARP cache table was viewed'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for arp.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.A.1-6.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing arp.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for arp.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.A.1-6.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing arp with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}, {'ScreenshotName': 'PA-2.A.2-3.png', 'ScreenshotCaption': 'Enrichment the execution of arp.exe as possible reconnaissance (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.2-4.png', 'ScreenshotCaption': 'Enrichment of the execution of arp.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of arp.exe as possible reconnaissance as well as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing arp with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}, {'ScreenshotName': 'PA-2.A.2-3.png', 'ScreenshotCaption': 'Enrichment the execution of arp.exe as possible reconnaissance (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.2-4.png', 'ScreenshotCaption': 'Enrichment of the execution of arp.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing arp with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing arp with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}, {'ScreenshotName': 'PA-2.A.2-3.png', 'ScreenshotCaption': 'Enrichment the execution of arp.exe as possible reconnaissance (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.A.2-4.png', 'ScreenshotCaption': 'Enrichment of the execution of arp.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing arp.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-1.png', 'ScreenshotCaption': 'Telemetry showing arp.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing arp.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing arp.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.B.1', 'Procedure': "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing echo with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing echo with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because echo was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (echo not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating echo was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing echo with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran echo) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (echo not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating echo was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.B.1-100.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-4.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing echo with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-4.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the echo command) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)'}, {'ScreenshotName': 'CC-2.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing the echo command'}, {'ScreenshotName': 'CC-2.B.1-99.png', 'ScreenshotCaption': 'A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)'}, {'ScreenshotName': 'CC-2.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing the echo command'}, {'ScreenshotName': 'CC-2.B.1-99.png', 'ScreenshotCaption': 'A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing the echo command.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing the echo command)'}, {'ScreenshotName': 'CC-2.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing the echo command'}, {'ScreenshotName': 'CC-2.B.1-99.png', 'ScreenshotCaption': 'A General Behavior alert showing that a spawned process (cmd.exe running echo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that echo was one of the commands used to enumerate the current username. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)'}, {'ScreenshotName': 'FE-2.B.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about echo'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the use of echo with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)'}, {'ScreenshotName': 'FE-2.B.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about echo'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the cmd.exe echo command with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) and a suspicious indicator that the command tried to identify the user on the system.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing the echo command'}, {'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the echo command (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of echo command with a correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) and a suspicious indicator that the command tried to identify the user on the system'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing the echo command. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing the echo command'}, {'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the echo command (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of echo command with a correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) and a suspicious indicator that the command tried to identify the user on the system'}], 'Footnotes': ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing echo with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for echo with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-5.png', 'ScreenshotCaption': 'Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing echo command'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.B.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing echo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.B.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing echo with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-1.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing echo with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.C.1', 'Procedure': "Cobalt Strike: 'ps' (Process status) via Win32 APIs", 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.C.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '2.C.2 ', 'Procedure': "Cobalt Strike: 'tasklist -v' via cmd", 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched tasklist.exe with the correct ATT&CK Technique (T1057 - Process Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.C.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing tasklist.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.C.2-2.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing tasklist.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.C.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing tasklist.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.C.2-2.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because tasklist was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing tasklist with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (tasklist not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating tasklist was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tasklist with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran tasklist) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing tasklist with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (tasklist not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating tasklist was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tasklist with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.C.2-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing tasklist with command-line arguments'}, {'ScreenshotName': 'CR-2.A.2-10.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe executing within the process tree (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-5.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing tasklist.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-5.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing tasklist) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.D.2-2.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)'}, {'ScreenshotName': 'CC-2.C.2-2.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.D.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.D.2-2.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)'}, {'ScreenshotName': 'CC-2.C.2-2.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.D.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tasklist.exe along with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.D.2-2.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing tasklist)'}, {'ScreenshotName': 'CC-2.C.2-2.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.D.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running tasklist) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that tasklist was one of the commands used to enumerate current running processes. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.C.2-1.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)'}, {'ScreenshotName': 'FE-2.C.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about tasklist'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched tasklist.exe with an alert for Tasklist Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1057 - Process Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.C.2-1.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)'}, {'ScreenshotName': 'FE-2.C.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about tasklist'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tasklist.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.C.2-1.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched tasklist.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Service Discovery) and a suspicious indicator that the process discovered running Windows services and/or processes.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing tasklist.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Service Discovery) and a suspicious indicator that the process discovered running Windows services and/or processes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tasklist.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing tasklist.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Service Discovery) and a suspicious indicator that the process discovered running Windows services and/or processes'}], 'Footnotes': ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.C.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for tasklist.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-4.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing tasklist.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.C.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for tasklist.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-4.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched tasklist.exe executing with a related ATT&CK Technique (System Information Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.C.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing tasklist with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.C.2-2.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe executing with a related ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.C.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of tasklist.exe as the enumeration of running processes via the command line (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of tasklist.exe as the enumeration of running processes via the command line. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.C.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing tasklist with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.C.2-2.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe executing with a related ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.C.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of tasklist.exe as the enumeration of running processes via the command line (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tasklist with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.C.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing tasklist with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.C.2-2.png', 'ScreenshotCaption': 'Enrichment of tasklist.exe executing with a related ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.C.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of tasklist.exe as the enumeration of running processes via the command line (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tasklist.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-1.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe with command-line arguments'}, {'ScreenshotName': 'RSA-02-2.png', 'ScreenshotCaption': 'Additional telemetry showing tasklist.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tasklist.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing tasklist.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.D.1', 'Procedure': "Cobalt Strike: 'sc query' via cmd", 'Techniques': [{'TechniqueId': 'T1007', 'TechniqueName': 'System Service Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with the correct ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.A-ALL.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.D.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing sc.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.A-ALL.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.D.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because sc query was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (sc query not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating sc query was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing sc with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran sc) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (sc query not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating sc query was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.D.1-10.png', 'ScreenshotCaption': 'Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing sc with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing sc with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.D.1-10.png', 'ScreenshotCaption': 'Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing sc with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-6.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing sc.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-6.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.D.2-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing sc with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.D.2-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running sc) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that sc was one of the commands used to enumerate current running services. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.D.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.D.1-2.png', 'ScreenshotCaption': 'Additional details from enrichment of sc.exe'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)'}, {'ScreenshotName': 'FE-2.D.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about sc'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.D.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.D.1-2.png', 'ScreenshotCaption': 'Additional details from enrichment of sc.exe'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)'}, {'ScreenshotName': 'FE-2.D.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about sc'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing sc.exe with command-line arguments and enriched the command with the condition SC Query Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT21]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.D.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with condition SC Query Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the sc.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing sc.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the sc.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-23.png', 'ScreenshotCaption': 'Enrichment of sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for sc.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-4.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing sc.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for sc.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.A.1-4.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing sc with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing sc with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing sc.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-2.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing sc.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-6.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.D.2', 'Procedure': "Cobalt Strike: 'net start' via cmd", 'Techniques': [{'TechniqueId': 'T1007', 'TechniqueName': 'System Service Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.D.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.D.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net start not specifically shown)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-7.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-7.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.D.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.D.2-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.D.2-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.D.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.D.2-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.D.2-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.D.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.D.2-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.D.2-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that net was one of the commands used to enumerate current running services. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.D.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)'}, {'ScreenshotName': 'FE-2.D.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Start Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.D.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)'}, {'ScreenshotName': 'FE-2.D.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-5.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-5.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.D.2-2.png', 'ScreenshotCaption': 'Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.D.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.D.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-7.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.E.1', 'Procedure': "Cobalt Strike: 'systeminfo' via cmd", 'Techniques': [{'TechniqueId': 'T1082', 'TechniqueName': 'System Information Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched systeminfo.exe with the correct ATT&CK Technique (System Information Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.E.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing systeminfo.exe'}, {'ScreenshotName': 'CB-2.E.1-2.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing systeminfo.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.E.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing systeminfo.exe'}, {'ScreenshotName': 'CB-2.E.1-2.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch also generated a General Behavior alert indicating systeminfo execution was suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing systeminfo'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)'}, {'ScreenshotName': 'CS-2.E.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating systeminfo.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because systeminfo was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing systeminfo'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)'}, {'ScreenshotName': 'CS-2.E.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating systeminfo.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing systeminfo. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran systeminfo) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing systeminfo'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (systeminfo not specifically shown)'}, {'ScreenshotName': 'CS-2.E.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating systeminfo.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating systeminfo was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.E.1-11.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing systeminfo'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing systeminfo with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.E.1-11.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing systeminfo'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-8.png', 'ScreenshotCaption': 'Telemetry showing systeminfo.exe (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing systeminfo.exe (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-8.png', 'ScreenshotCaption': 'Telemetry showing systeminfo.exe (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.E.1-1.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe indicating it could be used for reconnaissance.'}, {'ScreenshotName': 'CC-2.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched systeminfo.exe indicating it could be used for reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.E.1-1.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe indicating it could be used for reconnaissance.'}, {'ScreenshotName': 'CC-2.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running systeminfo) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified systeminfo as a reconnaissance command used to obtain details from the system.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.E.1-1.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)'}, {'ScreenshotName': 'FE-2.E.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about systeminfo'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched systeminfo.exe with an alert for Systeminfo Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1082 - System Information Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.E.1-1.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)'}, {'ScreenshotName': 'FE-2.E.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about systeminfo'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing systeminfo.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing systeminfo.exe (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched systeminfo.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the systeminfo.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-5.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing systeminfo.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-1.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the systeminfo.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-5.png', 'ScreenshotCaption': 'Enrichment of systeminfo.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried'}], 'Footnotes': ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for systeminfo.exe'}, {'ScreenshotName': 'MS-2.A.1-4.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe running systeminfo.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for systeminfo.exe'}, {'ScreenshotName': 'MS-2.A.1-4.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing systeminfo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.E.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.E.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of systeminfo.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of systeminfo.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing systeminfo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.E.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.E.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of systeminfo.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing systeminfo with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing systeminfo with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.E.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.E.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of systeminfo.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing systeminfo.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-3.png', 'ScreenshotCaption': 'Telemetry showing systeminfo.exe'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-8.png', 'ScreenshotCaption': 'Telemetry showing systeminfo.exe (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.E.2', 'Procedure': "Cobalt Strike: 'net config workstation' via cmd", 'Techniques': [{'TechniqueId': 'T1082', 'TechniqueName': 'System Information Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (System Information Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.E.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.E.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.E.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.E.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because net config was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net config not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net config was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net config not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net config was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.E.2-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net executing with command-line arguments'}, {'ScreenshotName': 'CR-2.E.2-12.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.E.2-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net executing with command-line arguments'}, {'ScreenshotName': 'CR-2.E.2-12.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-9.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-9.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.E.2-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.E.2-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe indicating it is commonly used for reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.E.2-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.A.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.E.2-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net config as a reconnaissance command performed. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.E.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-2.E.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Config Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1082 - System Information Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.E.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-2.E.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.E.2-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-5.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-5.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery) and a suspicious indicator that system configuration info was queried'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-2.E.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.E.2-2.png', 'ScreenshotCaption': 'Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.E.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.E.2-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.E.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.E.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.E.2-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.E.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.E.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.E.2-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery)'}, {'ScreenshotName': 'PA-2.E.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-9.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.F.1', 'Procedure': "Cobalt Strike: 'net localgroup administrators' via cmd", 'Techniques': [{'TechniqueId': 'T1069', 'TechniqueName': 'Permission Groups Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with tag Administrator Enumeration'}, {'ScreenshotName': 'CB-2.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with tag Administrator Enumeration'}, {'ScreenshotName': 'CB-2.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch also generated a General Behavior alert indicating net localgroup execution was suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)'}, {'ScreenshotName': 'CS-2.F.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net localgroup'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because net localgroup was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)'}, {'ScreenshotName': 'CS-2.F.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net localgroup'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)'}, {'ScreenshotName': 'CS-2.F.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net localgroup'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.F.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'CR-2.F.1-100.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing enriched net.exe executing\xa0(tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.F.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'CR-2.F.1-100.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing enriched net.exe executing\xa0(tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-10.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-16.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Enumeration of Administrator Account (tainted by a parent Malicious File Detection). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-10.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-16.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-10.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-16.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.F.1-99.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.1-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.F.1-99.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.1-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe indicating it is commonly used for reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.F.1-99.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.1-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.F.1-99.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.1-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated members of the local administrators group. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)'}, {'ScreenshotName': 'FE-2.F.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)'}, {'ScreenshotName': 'FE-2.F.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT19]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["The conditions contributing to Enrichment were added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-6.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-6.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.F.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.F.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-10.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.F.2', 'Procedure': "Cobalt Strike: 'net localgroup administrators -domain' via cmd", 'Techniques': [{'TechniqueId': 'T1069', 'TechniqueName': 'Permission Groups Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.F.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.F.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with tag Administrator Enumeration'}, {'ScreenshotName': 'CB-2.F.2-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.F.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.F.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with tag Administrator Enumeration'}, {'ScreenshotName': 'CB-2.F.2-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net localgroup was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net localgroup not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net localgroup was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing enriched net.exe executing\xa0(tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.F.2-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'CR-2.F.2-100.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing enriched net.exe executing\xa0(tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.F.2-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'CR-2.F.2-100.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-16.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-11.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Enumeration of Administrator Account (tainted by a parent Malicious File Detection). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-16.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-11.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-16.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-11.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.F.2-99.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.2-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.2-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.F.2-99.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.2-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.2-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe indicating it is commonly used for reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.F.2-99.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.2-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.2-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.F.2-99.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.2-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.2-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated members of the local administrators group. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)'}, {'ScreenshotName': 'FE-2.F.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.F.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery)', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)'}, {'ScreenshotName': 'FE-2.F.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.F.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT19]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.F.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["The conditions contributing to Enrichment were added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-6.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.B.1-6.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that information of users/groups was obtained'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.F.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.F.2-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.F.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.F.2-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.F.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-11.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.F.3', 'Procedure': 'Cobalt Strike: \'net group "Domain Admins" -domain\' via cmd', 'Techniques': [{'TechniqueId': 'T1069', 'TechniqueName': 'Permission Groups Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.F.3-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.F.3-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with tag Administrator Enumeration'}, {'ScreenshotName': 'CB-2.F.3-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.F.3-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.F.3-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with tag Administrator Enumeration'}, {'ScreenshotName': 'CB-2.F.3-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The enrichment was tainted by a previous detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by orange line for medium severity from previous detection)'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe (including net group) as tainted by orange line for medium severity'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The alert was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.F.3-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'CR-2.F.3-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing\xa0(tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.F.3-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'CR-2.F.3-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing\xa0(tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-12.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-17.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Enumeration of Administrator Account (tainted by a parent Malicious File Detection). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-12.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-17.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-12.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-17.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with command-line arguments with Enumeration of Administrator Accounts alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery; tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.3-1.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.3-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.3-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe indicating it is commonly used for reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.3-1.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.3-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.3-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.F.3-1.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating it is commonly used for reconnaissance'}, {'ScreenshotName': 'CC-2.F.3-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.F.3-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running net) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated the Shockwave domain's Domain Administrators group. [FE5]", 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.F.3-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)'}, {'ScreenshotName': 'FE-2.F.3-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.F.3-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)'}, {'ScreenshotName': 'FE-2.F.3-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT19]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.F.3-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["The conditions contributing to Enrichment were added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Techniques (Permission Groups Discovery) and a suspicious indicator that information of users/groups was obtained.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-27.png', 'ScreenshotCaption': 'Enrichment of net group with a correct ATT&CK Tactic (Discovery) and Technique (Permission Group Discovery) and a suspicious indicator that a net utility was used to gather information of user groups'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-27.png', 'ScreenshotCaption': 'Enrichment of net group with a correct ATT&CK Tactic (Discovery) and Technique (Permission Group Discovery) and a suspicious indicator that a net utility was used to gather information of user groups'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.F.3-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.F.3-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.F.3-2.png', 'ScreenshotCaption': 'Telemetry showing domain admins group discovery by Nimda at the domain controller'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.F.3-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.F.3-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.F.3-2.png', 'ScreenshotCaption': 'Telemetry showing domain admins group discovery by Nimda at the domain controller'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.F.3-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-5.png', 'ScreenshotCaption': 'Enrichment of the execution of net1.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-4.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe as the execution of an enumeration command as well as the execution of net1.exe as the execution of an enumeration command using net or net1. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.F.3-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-5.png', 'ScreenshotCaption': 'Enrichment of the execution of net1.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-4.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.F.3-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-5.png', 'ScreenshotCaption': 'Enrichment of the execution of net1.exe as the possible enumeration of administrator groups (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.F.3-4.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1 (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'An "IIOC" module called "Enumerates domain administrators" was generated and provided enrichment.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'RSA-02-5.png', 'ScreenshotCaption': 'Event enrichment from IIOC module \\"Enumerates domain administrators\\"'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'RSA-02-5.png', 'ScreenshotCaption': 'Event enrichment from IIOC module \\"Enumerates domain administrators\\"'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-12.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.G.1', 'Procedure': "Cobalt Strike: 'net user -domain' via cmd", 'Techniques': [{'TechniqueId': 'T1087', 'TechniqueName': 'Account Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.G.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.G.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net.exe) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with the correct ATT&CK Technique (Account Discovery). The data was tainted by a parent Injected Shellcode alert', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.G.1-10.png', 'ScreenshotCaption': 'Telemetry showing net executing with command-line arguments'}, {'ScreenshotName': 'CR-2.G.2-100.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.G.1-10.png', 'ScreenshotCaption': 'Telemetry showing net executing with command-line arguments'}, {'ScreenshotName': 'CR-2.G.2-100.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-13.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-13.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the net) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.G.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.G.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with a tag identifying the command as enumeration'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a tag identifying the command as enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.G.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing net)'}, {'ScreenshotName': 'CC-2.G.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with a tag identifying the command as enumeration'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net user as a reconnaissance command performed. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.G.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-2.G.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.G.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-2.G.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the condition Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.G.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-26.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-26.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration commands that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.G.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.G.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.G.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.G.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-13.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.G.2', 'Procedure': "Cobalt Strike: 'net user george -domain' via cmd", 'Techniques': [{'TechniqueId': 'T1087', 'TechniqueName': 'Account Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.G.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.G.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.G.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.G.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net user was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net user was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing net with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (net user not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net user was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with the correct ATT&CK Technique (Account Discovery). The data was tainted by a parent Injected Shellcode alert', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.G.2-10.png', 'ScreenshotCaption': 'Telemetry showing net executing with command-line arguments'}, {'ScreenshotName': 'CR-2.G.1-100.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-2.D.2-10.png', 'ScreenshotCaption': 'Process tree showing enriched net.exe executing with the correct ATT&CK Technique (Account Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.G.2-10.png', 'ScreenshotCaption': 'Telemetry showing net executing with command-line arguments'}, {'ScreenshotName': 'CR-2.G.1-100.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-14.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing net.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-14.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.H.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-2.G.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a tag identifying the command as enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.H.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-2.G.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net user as a reconnaissance command performed. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.E.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-2.G.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.E.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-2.G.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the conditions Reconnaissance Tool and Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT20]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.G.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with conditions Reconnaissance Tool and Net User Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["One condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-26.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the net.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-26.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that information of users/groups was obtained'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.G.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.G.2-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.G.2-2.png', 'ScreenshotCaption': 'Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-2.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert on suspicious sequence of exploration activities'}, {'ScreenshotName': 'MS-2.G.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.G.2-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.G.2-2.png', 'ScreenshotCaption': 'Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net1.exe executing with the correct ATT&CK Technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.G.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.G.2-2.png', 'ScreenshotCaption': 'Enrichment of net1.exe executing with the correct ATT&CK Technique (Account Discovery)'}, {'ScreenshotName': 'PA-2.G.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.G.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.G.2-2.png', 'ScreenshotCaption': 'Enrichment of net1.exe executing with the correct ATT&CK Technique (Account Discovery)'}, {'ScreenshotName': 'PA-2.G.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.G.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.G.2-2.png', 'ScreenshotCaption': 'Enrichment of net1.exe executing with the correct ATT&CK Technique (Account Discovery)'}, {'ScreenshotName': 'PA-2.G.2-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-4.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.A.1-14.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '2.H.1', 'Procedure': "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", 'Techniques': [{'TechniqueId': 'T1012', 'TechniqueName': 'Query Registry', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.H.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.H.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing reg.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-2.H.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CB-2.H.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because reg query was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (reg query not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating reg query was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran reg) were considered tainted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-2.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg with command-line arguments'}, {'ScreenshotName': 'CS-2.A.1-1.png', 'ScreenshotCaption': 'Process tree showing all cmd.exe children under rundll32.exe as tainted by orange line for medium severity (reg query not specifically shown)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating reg query was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-2.H.1-10.png', 'ScreenshotCaption': 'Telemetry within a process tree showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-2.H.1-11.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert triggered for a specified number of discovery techniques over a specified time period, which resulted in four Enumeration Command Sequence alerts for Step 2 (tainted by a parent Malicious File Detection).[EG8]', 'Modifiers': ['Delayed', 'Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-15.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': ['This alert was configured after the start of the evaluation so is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed cmd.exe executing reg.exe with command-line arguments (tainted by a parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-02-18.png', 'ScreenshotCaption': 'General Behavior alerts for Enumeration Command Sequences that triggered for specified number of commands in specified time period'}, {'ScreenshotName': 'EG-02-19.png', 'ScreenshotCaption': 'Detail of one Enumeration Command Sequences alert (tainted by parent Malicious File Detection)'}, {'ScreenshotName': 'EG-02-15.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments (tainted by parent Malicious File Detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing the reg) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.H.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance'}, {'ScreenshotName': 'CC-2.G.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing reg)'}, {'ScreenshotName': 'CC-2.H.1-2.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.G.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.H.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance'}, {'ScreenshotName': 'CC-2.G.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing reg)'}, {'ScreenshotName': 'CC-2.H.1-2.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.G.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.H.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance'}, {'ScreenshotName': 'CC-2.G.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing reg)'}, {'ScreenshotName': 'CC-2.H.1-2.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.G.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-2.H.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed, possibly as part of reconnaissance'}, {'ScreenshotName': 'CC-2.G.2-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing reg)'}, {'ScreenshotName': 'CC-2.H.1-2.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-2.G.2-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running reg) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because the attacker queried a registry key that contains system policy configurations. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.H.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)'}, {'ScreenshotName': 'FE-2.H.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about reg'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.H.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)'}, {'ScreenshotName': 'FE-2.H.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about reg'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-2.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the reg.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-26.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility'}, {'ScreenshotName': 'MC-2.A.1-99.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery).'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the reg.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-26.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility'}, {'ScreenshotName': 'MC-2.A.1-99.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by a trace detection on Resume Viewer.exe.[MC2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-2.B.1-4.png', 'ScreenshotCaption': 'Process tree within trace detection containing cmd.exe executing the reg.exe (tainted by a parent alert on Resume Viewer.exe)'}, {'ScreenshotName': 'MC-2.A.1-26.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility'}, {'ScreenshotName': 'MC-2.A.1-99.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery).'}], 'Footnotes': ["Though not visible in the image, MITRE confirmed that the relevant command was visible within the trace detection's process tree."]}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe running reg.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-2.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for reg.exe with command-line arguments'}, {'ScreenshotName': 'MS-2.H.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe executing with the correct ATT&CK Technique (Query Registry).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-2.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.H.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-2.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-2.H.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-02-4.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-2.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '3.A.1', 'Procedure': 'Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level', 'Techniques': [{'TechniqueId': 'T1088', 'TechniqueName': 'Bypass User Account Control', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an integrity level change for user Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High), which is indicative of bypassing UAC.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-3.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing process integrity level change for Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe running as medium integrity as user Debbie then another instance running later as high integrity as user Debbie. The telemetry is tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-3.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running as medium integrity as user Debbie'}, {'ScreenshotName': 'CR-3.A.1-20.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running as high integrity as user Debbie (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a mismatch between the logon id (authentication id) of parent and child processes indicating that a different token was used. Though no screenshot for this data is available, this information can be used to trace back to the logon event for that logon id to display the process integrity level indicative of the elevated token used for bypass UAC. [EG7]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-03-06.png', 'ScreenshotCaption': 'Telemetry showing authentication (logon) ID mismatch between parent and child processes'}], 'Footnotes': [' During the evaluation, Windows Defender was unknowingly reenabled. As a result, Bypass UAC was tested in a slightly modified method. The detection method Endgame exhibited would have been valid regardless.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-3.A.1-2.png', 'ScreenshotCaption': 'Enrichment of an unelevated svchost.exe spawning an elevated powershell.exe process with a tag indicating a possible UAC Bypass.'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of powershell.exe as a high integrity process as SYSTEM with a token login ID previously associated with user Debbie. [FE6]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'FE-3.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0xfcf5fd'}, {'ScreenshotName': 'FE-3.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing group membership of token logon ID 0xfcf5fd, associated with user Debbie, which includes S-1-16-12288 (High Mandatory Level)'}], 'Footnotes': [' A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called).']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though an alert was triggered due to svchost.exe creating the process powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-3.A.1-1.png', 'ScreenshotCaption': 'Alert for PowerShell process creation (does not count as a detection)'}, {'ScreenshotName': 'CT-3.A.1-2.png', 'ScreenshotCaption': 'Relationships view of alert showing svchost.exe spawning powershell.exe tree (including encoded PowerShell). Red dots indicate malicious behavior and orange indicate suspicious behavior (based off impact value) (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a possible UAC bypass. The alert was tagged with the correct ATT&CK Technique (Bypass User Account Control) and Tactics (Defense Evasion, Privilege Escalation).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-3.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a possible UAC bypass, tagged with the correct ATT&CK Technique (Bypass User Account Control) and Tactics (Defense Evasion, Privilege Escalation)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe as a medium integrity process as user Debbie and subsequent execution of powershell.exe as a high integrity process as SYSTEM as part of the UAC bypass (tainted by alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-3.C.1-2.png', 'ScreenshotCaption': "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"}, {'ScreenshotName': 'MS-3.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe running as medium integrity as user Debbie'}, {'ScreenshotName': 'MS-3.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running as high integrity as SYSTEM'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process integrity level change from parent rundll32.exe (medium / 8192) to child powershell.exe (high / 12288), both running as user Debbie.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-3.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing process integrity level change from parent rundll32.exe (medium) to child powershell.exe (high), both running as user Debbie'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though an alert was created for PowerShell with the -enc command-line argument.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-03-2.png', 'ScreenshotCaption': 'Alert for powershell.exe execution with encoded command-line arguments (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed process integrity levels changing from medium to high.[SO11]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Detect was verified, but a screenshot for this data was unavailable. Integrity level values are based upon how the capability tracks integrity levels and not how Windows tracks them causing a difference in values.']}]}]}]}, {'Substep': '3.A.1', 'Procedure': 'Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token', 'Techniques': [{'TechniqueId': 'T1134', 'TechniqueName': 'Access Token Manipulation', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe, with the seclogon command-line argument, performing activity related to token manipulation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-3.A.1-6.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe command line arguments, specifically seclogon'}, {'ScreenshotName': 'CB-3.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe activity related to token manipulation'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though an alert was generated for malicious code injection into PowerShell. Telemetry also showed that bypassuactoken.x64.dll was loaded.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-3.C.1-10.png', 'ScreenshotCaption': 'Alert for malicious code injection into PowerShell (does not count as a detection)'}, {'ScreenshotName': 'CR-3.A.1-10.png', 'ScreenshotCaption': 'Telemetry showing the bypassuactoken.x64.dll was loaded (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a svchost.exe seclogon event for a token logon id (authentication id) later used by a new powershell.exe process, highlighting token manipulation via a mismatch in ids between parent and child process tokens. [EG7]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-03-7.png', 'ScreenshotCaption': 'Telemetry showing svhost.exe seclogon event for token login id 0x5f997f7 (100243447)'}, {'ScreenshotName': 'EG-03-06.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe spawned with token authentication id 100243447'}], 'Footnotes': [' During the evaluation, Windows Defender was unknowingly reenabled. As a result, Bypass UAC was tested in a slightly modified method. The detection method Endgame exhibited would have been valid regardless.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent logon event for user Debbie with an elevated token, indicating token manipulation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-3.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe executed with the seclogon command-line argument'}, {'ScreenshotName': 'CC-3.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing logon event for user Debbie with an elevated token'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a svchost.exe seclogon event for a token logon ID later used by a process whose group membership indicated high integrity. [FE6]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'FE-3.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe seclogon event for token login ID 0xfcf5fd'}, {'ScreenshotName': 'FE-3.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing group membership of token logon ID 0xfcf5fd, which includes S-1-16-12288 (High Mandatory Level)'}], 'Footnotes': [' A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called).']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though an alert was triggered due to svchost.exe creating the process powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-3.A.1-1.png', 'ScreenshotCaption': 'Alert for PowerShell process creation (does not count as a detection)'}, {'ScreenshotName': 'CT-3.A.1-2.png', 'ScreenshotCaption': 'Relationships view of alert showing svchost.exe spawning powershell.exe tree (including encoded PowerShell). Red dots indicate malicious behavior and orange indicate suspicious behavior (based off impact value) (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe, with the seclogon command-line argument as well as a New Credentials logon event for user Debbie, indicating token manipulation.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MC-3.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe, with the seclogon command-line argument'}, {'ScreenshotName': 'MC-3.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing a New Credentials logon event for user Debbie'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent elevated powershell.exe process, indicating token manipulation (tainted by parent alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-3.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe execution with seclogon command-line argument then subsequent powershell.exe'}, {'ScreenshotName': 'MS-3.C.1-2.png', 'ScreenshotCaption': "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent logon event with an elevated token and new logon ID, indicating token manipulation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-3.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe executed with the seclogon command-line argument'}, {'ScreenshotName': 'PA-3.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing logon event with an elevated token and new logon ID'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '3.B.1', 'Procedure': "Cobalt Strike: 'ps' (Process status) via Win32 APIs", 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine. [PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-3.B.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '3.C.1', 'Procedure': 'Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe', 'Techniques': [{'TechniqueId': 'T1055', 'TechniqueName': 'Process Injection', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated that was mapped to correct ATT&CK Technique (Process Injection).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-3.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing open handles and thread injection into cmd.exe'}, {'ScreenshotName': 'CB-3.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe'}, {'ScreenshotName': 'CB-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed "crossproc" events indicative of Process Injection into cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-3.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing open handles and thread injection into cmd.exe'}, {'ScreenshotName': 'CB-3.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe'}, {'ScreenshotName': 'CB-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated showing that PowerShell created a thread into a remote process. The alert identified the correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion). The process tree view showed the alert as tainted by parent svchost.exe and powershell.exe detections.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious'}, {'ScreenshotName': 'CS-3.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch also generated a General Behavior alert identifying the injection as suspicious. The process tree view showed the alert as tainted by previous svchost.exe and powershell.exe detections.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious'}, {'ScreenshotName': 'CS-3.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry associated with the alert would show thread creation in a separate view.[CS8]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior Process Injection alert mapped to correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion) as well as OverWatch General Behavior alert identifying behavior as suspicious'}, {'ScreenshotName': 'CS-3.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree view of Process Injection Specific Behavior alert and OverWatch General Behavior alert tainted by parent detections (orange line indicates medium severity)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for process injection from powershell.exe into cmd.exe (Anonymous RWX). The alert is tagged with the correct ATT&CK Tactic (Defense Evasion) and Technique (Process Injection). The alert is tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-3.C.1-10.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe injecting into cmd.exe'}, {'ScreenshotName': 'CR-3.C.1-100.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell injection into cmd.exe mapped to ATT&CK Tactic (Defense Evasion) and Technique (Process Injection) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for process injection into cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-03-2.png', 'ScreenshotCaption': 'Specific Behavior alert for process injection into cmd.exe'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell opening a handle to a system process with access rights typical for a known PowerShell injection pattern, identified as a sign of code injection'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified a process injection from PowerShell.exe to cmd.exe. [FE5][FE11]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-3.C.1-1.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report identifying a process injection from PowerShell.exe to cmd.exe (Specific Behavior)'}, {'ScreenshotName': 'FE-3.C.1-2.png', 'ScreenshotCaption': 'Continued excerpt from the Managed Defense Report showing the artifact evidence of a process injection from PowerShell.exe to cmd.exe'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", ' The vendor stated the process injection detection capability is a HX plugin that is only available within the Managed Defense Service, and the data is reported to  a separate cloud server which is not accessible to customers at this time.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated based on DLL injection for powershell.exe injecting into cmd.exe. The detection was labeled with Process Hijacking and Privilege Escalation and tainted by the parent "Powershell process created" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for DLL injection detection labeled with Process Hijacking and Privilege Escalation (tainted by the parent \\"Powershell process created\\" alert)'}], 'Footnotes': ['The vendor noted all DLL injection conditions are labeled with Privilege Escalation. The vendor also noted Privilege Escalation is one of ten "Capabilities" that are part of the taxonomy.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for\xa0a process injection from PowerShell into cmd.exe based on both connecting to a named pipe. The alert was tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert \xa0for\xa0a process injection from PowerShell into cmd.exe based on both connecting to a named pipe, tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for process injection.[MS5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-3.C.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe injecting into cmd.exe'}, {'ScreenshotName': 'MS-3.C.1-2.png', 'ScreenshotCaption': "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"}, {'ScreenshotName': 'MS-3.C.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert showing powershell.exe process injection'}, {'ScreenshotName': 'MS-3.C.1-4.png', 'ScreenshotCaption': 'Telemetry showing process injection activity audited by Exploit Guard'}], 'Footnotes': [' Process Injection attempt was audited by Exploit Guard. Vendor states that the Exploit Guard audit events demonstrate that execution would have been prevented if Export Address Table (EAF) was enabled in blocking mode.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched data showing powershell.exe injecting into cmd.exe (tainted by alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-3.C.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe injecting into cmd.exe'}, {'ScreenshotName': 'MS-3.C.1-2.png', 'ScreenshotCaption': "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"}, {'ScreenshotName': 'MS-3.C.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert showing powershell.exe process injection'}, {'ScreenshotName': 'MS-3.C.1-4.png', 'ScreenshotCaption': 'Telemetry showing process injection activity audited by Exploit Guard'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell injecting shellcode. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine. [PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-3.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell injecting shellcode (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating a remote thread into cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-03-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating a remote thread into cmd.exe'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe allocating memory, writing to memory space, and invoking a thread into cmd.exe (tainted by association with parent alert for powershell.exe process executed by svchost.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-3.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe injecting into cmd.exe (Group ID tainted this event but was not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '4.A.1', 'Procedure': 'Cobalt Strike: \'net group "Domain Controllers" -domain\' via cmd', 'Techniques': [{'TechniqueId': 'T1018', 'TechniqueName': 'Remote System Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK technique (Account Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK technique (Account Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch also generated a General Behavior alert identifying cmd.exe executing net as suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'CS-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)'}, {'ScreenshotName': 'CS-4.A.1-2.png', 'ScreenshotCaption': 'Additional process tree view showing net.exe enrichment'}, {'ScreenshotName': 'CS-4.A.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net group'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'CS-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)'}, {'ScreenshotName': 'CS-4.A.1-2.png', 'ScreenshotCaption': 'Additional process tree view showing net.exe enrichment'}, {'ScreenshotName': 'CS-4.A.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net group'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed net.exe executing with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'CS-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)'}, {'ScreenshotName': 'CS-4.A.1-2.png', 'ScreenshotCaption': 'Additional process tree view showing net.exe enrichment'}, {'ScreenshotName': 'CS-4.A.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net group'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the enrichment showed net.exe executing with command-line arguments, and would be available in a separate view.[CS8]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'CS-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)'}, {'ScreenshotName': 'CS-4.A.1-2.png', 'ScreenshotCaption': 'Additional process tree view showing net.exe enrichment'}, {'ScreenshotName': 'CS-4.A.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net group'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe executing as part of a suspicious execution chain related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-4.A.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing as part of a suspicious execution chain'}, {'ScreenshotName': 'CR-4.A.1-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-4.A.1-101.png', 'ScreenshotCaption': 'Telemetry showing net.exe executing with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-4.A.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing as part of a suspicious execution chain'}, {'ScreenshotName': 'CR-4.A.1-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-4.A.1-101.png', 'ScreenshotCaption': 'Telemetry showing net.exe executing with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the net command with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery). [EG11]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'EG-04-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing net with command-line arguments'}, {'ScreenshotName': 'EG-04-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the process creation of net group with command-line arguments. [EG11]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-04-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing net with command-line arguments'}, {'ScreenshotName': 'EG-04-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe indicating that it was run with commands commonly used for reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance'}, {'ScreenshotName': 'CC-4.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance'}, {'ScreenshotName': 'CC-4.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it indicated net group was one of the reconnaissance commands performed. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-4.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net group'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-4.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net group'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the condition Net Group Reconnaissance Command. The enrichment was tainted by the parent \\"Powershell Execution Policy ByPass command ran\\" alert.[CT4]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with condition Net Group Reconnaissance Command, (tainted by the parent \\"Powershell Execution Policy ByPass command ran\\" alert)'}], 'Footnotes': [" At least one condition was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-4.A.1-10.png', 'ScreenshotCaption': 'Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-4.A.1-10.png', 'ScreenshotCaption': 'Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}, {'ScreenshotName': 'MS-4.A.1-2.png', 'ScreenshotCaption': 'Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'PA-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1'}, {'ScreenshotName': 'PA-4.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command'}, {'ScreenshotName': 'PA-4.A.1-4.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe as the execution of an enumeration command.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'PA-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1'}, {'ScreenshotName': 'PA-4.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command'}, {'ScreenshotName': 'PA-4.A.1-4.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe as the execution of an enumeration command using net or net1.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'PA-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1'}, {'ScreenshotName': 'PA-4.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command'}, {'ScreenshotName': 'PA-4.A.1-4.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'PA-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1'}, {'ScreenshotName': 'PA-4.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command'}, {'ScreenshotName': 'PA-4.A.1-4.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe running net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-04-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '4.A.2', 'Procedure': 'Cobalt Strike: \'net group "Domain Computers" -domain\' via cmd', 'Techniques': [{'TechniqueId': 'T1018', 'TechniqueName': 'Remote System Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-4.A.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-4.A.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK technique (Account Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-4.A.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-4.A.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK technique (Account Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'CS-4.A.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)'}, {'ScreenshotName': 'CS-4.A.2-2.png', 'ScreenshotCaption': 'Additional process tree view showing net.exe enrichment'}, {'ScreenshotName': 'CS-4.A.2-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net group'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team identified net group as suspicious with a General Behavior alert.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'CS-4.A.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)'}, {'ScreenshotName': 'CS-4.A.2-2.png', 'ScreenshotCaption': 'Additional process tree view showing net.exe enrichment'}, {'ScreenshotName': 'CS-4.A.2-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net group'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed net.exe executing with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'CS-4.A.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)'}, {'ScreenshotName': 'CS-4.A.2-2.png', 'ScreenshotCaption': 'Additional process tree view showing net.exe enrichment'}, {'ScreenshotName': 'CS-4.A.2-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net group'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the enrichment showed net.exe with command-line arguments, and would be available in a separate view.[CS8]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'CS-4.A.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery)'}, {'ScreenshotName': 'CS-4.A.2-2.png', 'ScreenshotCaption': 'Additional process tree view showing net.exe enrichment'}, {'ScreenshotName': 'CS-4.A.2-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert for net group'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe executing as part of a suspicious execution chain related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery). The alert was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-4.A.1-101.png', 'ScreenshotCaption': 'Telemetry showing net.exe executing with command-line arguments'}, {'ScreenshotName': 'CR-4.A.2-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing as part of a suspicious execution chain'}, {'ScreenshotName': 'CR-4.A.2-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-4.A.1-101.png', 'ScreenshotCaption': 'Telemetry showing net.exe executing with command-line arguments'}, {'ScreenshotName': 'CR-4.A.2-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing as part of a suspicious execution chain'}, {'ScreenshotName': 'CR-4.A.2-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the net command with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery). [EG11]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'EG-04-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing net with command-line arguments'}, {'ScreenshotName': 'EG-04-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net group command mapped to related ATT&CK Technique (T1069 - Permission Groups Discovery) and\xa0correct Tactic (Discovery)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the process creation of net group with command-line arguments. [EG11]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-04-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing net with command-line arguments'}, {'ScreenshotName': 'EG-04-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net group command mapped to related ATT&CK Technique (T1069 - Permission Groups Discovery) and\xa0correct Tactic (Discovery)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe indicating that it was run with commands commonly used for reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance'}, {'ScreenshotName': 'CC-4.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-4.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe indicating that it was run with commands commonly used for reconnaissance'}, {'ScreenshotName': 'CC-4.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it indicated net group was one of the reconnaissance commands performed. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-4.A.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)'}, {'ScreenshotName': 'FE-4.A.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net group'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)'}, {'ScreenshotName': 'FE-4.A.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)'}, {'ScreenshotName': 'FE-4.A.2-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about net group'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with the condition Net Group Reconnaissance Command. The enrichment was tainted by the parent "Powershell Execution Policy ByPass command ran" alert.', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-4.A.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with condition Net Group Reconnaissance Command, (tainted by the parent \\"Powershell Execution Policy ByPass command ran\\" alert)'}], 'Footnotes': ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-4.A.1-10.png', 'ScreenshotCaption': 'Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-4.A.1-10.png', 'ScreenshotCaption': 'Process tree within trace detection showing cmd.exe executing net.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information about domain computers and controllers'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-4.A.1-2.png', 'ScreenshotCaption': 'Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)'}, {'ScreenshotName': 'MS-4.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe as the execution of an enumeration command using net or net1.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'PA-4.A.2-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing net with command-line arguments'}, {'ScreenshotName': 'PA-4.A.2-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe as the execution of an enumeration command using net or net1'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe running net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-04-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-4.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}, {'ScreenshotName': 'S1-4.A.1-3.png', 'ScreenshotCaption': 'Event tree showing net.exe (tainted by launch from process lineage previously identified as malicious)'}], 'Footnotes': []}]}]}]}, {'Substep': '4.B.1', 'Procedure': "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netsh.exe with a related ATT&CK technique (T1063 - Security Software Discovery) and a tag for Potential Windows Firewall Rule Recon.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-4.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing netsh.exe with command-line arguments'}, {'ScreenshotName': 'CB-4.B.1-2.png', 'ScreenshotCaption': 'Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing netsh.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-4.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing netsh.exe with command-line arguments'}, {'ScreenshotName': 'CB-4.B.1-2.png', 'ScreenshotCaption': 'Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating the execution of netsh by cmd.exe was suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-4.B.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because netsh was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-4.B.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the OverWatch alert showed netsh executing with command-line arguments, and would be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-4.B.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating netsh execution by cmd.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating netsh was a reconnaissance command (General Behavior)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netsh.exe executing with the correct ATT&CK Tactic (Discovery) and a related Technique (Security Software Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-4.B.1-10.png', 'ScreenshotCaption': 'Enrichment of netsh.exe executing with correct ATT&CK Tactic (Discovery) and related Technique (Security Software Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing net with command-line arguments. command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-4.B.1-10.png', 'ScreenshotCaption': 'Enrichment of netsh.exe executing with correct ATT&CK Tactic (Discovery) and related Technique (Security Software Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the process creation of netsh with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-04-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing netsh with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netsh.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-4.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing netsh.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that netsh was a reconnaissance command used to obtain network configuration and the configuration profile of the Windows Firewall. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-4.B.1-1.png', 'ScreenshotCaption': 'Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)'}, {'ScreenshotName': 'FE-4.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about netsh'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netsh.exe with an alert for Netsh Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1063 - Security Software Discovery) and the correct Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-4.B.1-1.png', 'ScreenshotCaption': 'Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)'}, {'ScreenshotName': 'FE-4.B.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about netsh'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netsh.exe with command-line arguments. The telemetry was tainted by the parent "Powershell Execution Policy ByPass command ran" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-4.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing netsh.exe with command-line arguments (tainted by the parent \\"Powershell Execution Policy ByPass command ran\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netsh.exe with the correct Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the netsh utility manipulated firewall rules.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-4.A.1-10.png', 'ScreenshotCaption': 'Process tree within trace detection showing cmd.exe executing netsh.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of netsh.exe with the correct Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the netsh utility manipulated firewall rules'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netsh.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-4.A.1-10.png', 'ScreenshotCaption': 'Process tree within trace detection showing cmd.exe executing netsh.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-4.A.1-2.png', 'ScreenshotCaption': 'Enrichment of netsh.exe with the correct Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that the netsh utility manipulated firewall rules'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing netsh.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-4.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for netsh.exe with command-line arguments'}, {'ScreenshotName': 'MS-4.A.1-2.png', 'ScreenshotCaption': 'Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing netsh with command-line arguments'}, {'ScreenshotName': 'PA-4.B.1-2.png', 'ScreenshotCaption': 'Enrichment of netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netsh with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing netsh with command-line arguments'}, {'ScreenshotName': 'PA-4.B.1-2.png', 'ScreenshotCaption': 'Enrichment of netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe running netsh.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-04-1.png', 'ScreenshotCaption': 'Telemetry showing netsh.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netsh.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-4.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing netsh.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.1', 'Procedure': "Cobalt Strike: 'netstat -ano' via cmd", 'Techniques': [{'TechniqueId': 'T1049', 'TechniqueName': 'System Network Connections Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with the correct ATT&CK technique (System Network Connections Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-4.C.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing netstat.exe with command-line arguments'}, {'ScreenshotName': 'CB-4.C.1-2.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing netstat.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-4.C.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing netstat.exe with command-line arguments'}, {'ScreenshotName': 'CB-4.C.1-2.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating cmd.exe executing netstat with command-line arguments was suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-4.C.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because netstat was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-4.C.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the OverWatch alert showed cmd.exe executing netstat with command-line arguments, and would be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-4.C.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating netstat execution by cmd.exe was suspicious'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating netstat was a reconnaissance command (General Behavior)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe executing as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-4.C.1-100.png', 'ScreenshotCaption': 'Enrichment of netstat.exe executing labeled as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-4.C.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing netstat with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netstat with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-4.C.1-100.png', 'ScreenshotCaption': 'Enrichment of netstat.exe executing labeled as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-4.C.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing netstat with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the netstat command with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and \xa0Tactic (Discovery). [EG11]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'EG-04-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing netstat with command-line arguments'}, {'ScreenshotName': 'EG-04-4.png', 'ScreenshotCaption': 'Additional UI view of telemetry (showing the netstat command in this instance)'}, {'ScreenshotName': 'EG-04-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of netstat with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the process creation of netstat with command-line arguments. [EG11]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-04-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing netstat with command-line arguments'}, {'ScreenshotName': 'EG-04-4.png', 'ScreenshotCaption': 'Additional UI view of telemetry (showing the netstat command in this instance)'}, {'ScreenshotName': 'EG-04-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of netstat with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with a tag identifying the command as enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-4.C.1-2.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with a tag identifying the command as enumeration'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that netstat was a reconnaissance command used to enumerate active and listening network ports. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-4.C.1-1.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)'}, {'ScreenshotName': 'FE-4.C.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about netstat'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-4.C.1-1.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)'}, {'ScreenshotName': 'FE-4.C.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about netstat'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netstat.exe with command-line arguments. The telemetry was tainted by the parent "Powershell Execution Policy ByPass command ran" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-4.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing netstat.exe with command-line arguments (tainted by the parent \\"Powershell Execution Policy ByPass command ran\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with the correct Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that network statistics and TCP/IP connections were gathered.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-4.A.1-10.png', 'ScreenshotCaption': 'Process tree within trace detection showing cmd.exe executing netstat.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-4.A.1-6.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with the correct Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that network statistics and TCP/IP connections were gathered'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netstat.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-4.A.1-10.png', 'ScreenshotCaption': 'Process tree within trace detection showing cmd.exe executing netstat.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-4.A.1-6.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with the correct Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that network statistics and TCP/IP connections were gathered'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing netstat.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-4.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for netstat.exe with command-line arguments'}, {'ScreenshotName': 'MS-4.A.1-2.png', 'ScreenshotCaption': 'Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing netstat with command-line arguments'}, {'ScreenshotName': 'PA-4.C.1-2.png', 'ScreenshotCaption': 'Enrichment of netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netsh with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-4.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing netstat with command-line arguments'}, {'ScreenshotName': 'PA-4.C.1-2.png', 'ScreenshotCaption': 'Enrichment of netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe running netstat.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-04-1.png', 'ScreenshotCaption': 'Telemetry showing netstat.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing netstat.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-4.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing netstat.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '5.A.1', 'Procedure': 'Cobalt Strike: Built-in Mimikatz credential dump capability executed', 'Techniques': [{'TechniqueId': 'T1003', 'TechniqueName': 'Credential Dumping', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated showing the correct ATT&CK Technique (Credential Dumping).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-5.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cross process events, specifically a handle to open thread into lsass.exe'}, {'ScreenshotName': 'CB-5.A.1-4.png', 'ScreenshotCaption': 'Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection for credential dumping.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-5.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cross process events, specifically a handle to open thread into lsass.exe'}, {'ScreenshotName': 'CB-5.A.1-4.png', 'ScreenshotCaption': 'Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for Credential Dumping, which indicated "a DLL was detected as being reflectively loaded in the callstack." The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-5.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated by the OverWatch team indicating the Credential Dumping activity was suspicious. The process tree view showed the alert as tainted by a parent detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-5.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing the lsass handle open and DLL loading would be available in a separate view.[CS8]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-5.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for svchost.exe loading Mimikatz and accessing lsass (an audited system resource). The alert was also tagged with the correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-5.A.1-11.png', 'ScreenshotCaption': 'Specific Behavior alert with correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection) with details about svchost.exe accessing lsass'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the correct ATT&CK Technique (Credential Dumping).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-05-1.png', 'ScreenshotCaption': 'Specific Behavior alert mapped to the correct ATT&CK Technique (Credential Dumping)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though a DDNA Scan alerted for svchost.exe and displayed details related to Project Injection.[CT2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-5.A.1-1.png', 'ScreenshotCaption': 'Alert showing DDNA Scan for svchost.exe (does not count as a detection)'}, {'ScreenshotName': 'CT-5.A.1-2.png', 'ScreenshotCaption': 'Alert showing DDNA Scan details for svchost.exe, including that it appears to inject code into another process (does not count as a detection)'}, {'ScreenshotName': 'CT-5.A.1-3.png', 'ScreenshotCaption': 'Alert showing additional DDNA Scan details for svchost.exe, including that it appears to inject code into another process (does not count as a detection)'}], 'Footnotes': [' According to the vendor, DDNA scans trigger due to machine learning scanning in-memory code and identifying that the code is malicious. DDNA output, which is delayed, shows the process capabilities (known as "traits"), which may give an analyst clues on what the process does.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on credential memory access.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-5.A.1-3.png', 'ScreenshotCaption': 'Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe'}, {'ScreenshotName': 'MS-5.A.2-2.png', 'ScreenshotCaption': 'Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)'}, {'ScreenshotName': 'MS-5.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert description for sensitive credential memory read'}, {'ScreenshotName': 'MS-5.A.1-1.png', 'ScreenshotCaption': 'Process tree for sensitive credential memory read alert'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched data showing a svchost.exe process opening lsass.exe with a description that it was accessing credentials (tainted by parent process injection event that occurred from svchost.exe). Exploit Guard audited the process open and credential extraction event.[MS6]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-5.A.1-3.png', 'ScreenshotCaption': 'Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe'}, {'ScreenshotName': 'MS-5.A.2-2.png', 'ScreenshotCaption': 'Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)'}, {'ScreenshotName': 'MS-5.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert description for sensitive credential memory read'}, {'ScreenshotName': 'MS-5.A.1-1.png', 'ScreenshotCaption': 'Process tree for sensitive credential memory read alert'}], 'Footnotes': ['Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode. Vendor stated that Credential Guard can also mitigate this attack if enabled.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a suspicious handle being opened to lsass.exe to dump passwords. The alert was tagged with the correct ATT&CK Technique (Credential Dumping). [PA3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-5.A.1-1.png', 'ScreenshotCaption': 'A Specific Behavior alert for a suspicious handle being opened to lsass.exe to dump password, tagged with the correct ATT&CK Technique (Credential Dumping)'}], 'Footnotes': ['Vendor stated the capability would have prevented this behavior.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[SO1]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': [' Vendor states that the capability would normally block credential dumping activity like this, but the mitigation capability was disabled due to the evaluation parameters.']}]}]}]}, {'Substep': '5.A.1', 'Procedure': 'Cobalt Strike: Credential dump capability involved process injection into lsass', 'Techniques': [{'TechniqueId': 'T1055', 'TechniqueName': 'Process Injection', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-5.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cross process events, specifically a handle to open thread into lsass.exe'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched several event types with descriptions, including for a remote process opening a handle to lsass and a DLL being reflectively loaded (ReflectiveDllOpenLsass), as well as an lsass process accessed (ProcessHollowingDetected).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-5.A.1-8.png', 'ScreenshotCaption': 'Enrichment showing ReflectiveDllOpenLsass and ProcessHollowingDetected events'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for svchost.exe reflectively loading a malicious executable, identified as Mimikatz, then accessing lsass. The alert was also tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation). The powerkatz.dll was also seen loaded as a floating executable code.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-5.A.1-11.png', 'ScreenshotCaption': 'Specific Behavior alert with correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation)'}, {'ScreenshotName': 'CR-5.A.1-21.png', 'ScreenshotCaption': 'Data within alert showing loaded powerkatz.dll as floating executable code'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed privileged accesses (PROCESS_VM_READ and PROCESS_QUERY_LIMITED_INFORMATION) into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-05-1.png', 'ScreenshotCaption': 'Telemetry showing process accesses into lsass.exe'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated when a DDNA Scan alerted for svchost.exe. DDNA scan results showed that svchost.exe "appeared to inject code into another process."', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-5.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing DDNA Scan for svchost.exe'}, {'ScreenshotName': 'CT-5.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process'}, {'ScreenshotName': 'CT-5.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert additional details on DDNA Scan for svchost.exe, including that it appears to inject code into another process'}], 'Footnotes': [' According to the vendor, DDNA scans trigger due to machine learning scanning in-memory code and identifying that the code is malicious. DDNA output, which is delayed, shows the process capabilities (known as "traits"), which may give an analyst clues on what the process does.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for process injection into lsass.exe.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-5.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe'}, {'ScreenshotName': 'MS-5.A.1-1.png', 'ScreenshotCaption': 'Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe'}, {'ScreenshotName': 'MS-5.A.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe accessing lsass.exe and dumping credentials (tainted by parent alert on sensitive credential memory read for the first credential dump). Exploit Guard audited process open and credential extraction event.[MS30]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-5.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe'}, {'ScreenshotName': 'MS-5.A.1-1.png', 'ScreenshotCaption': 'Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe'}, {'ScreenshotName': 'MS-5.A.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)'}], 'Footnotes': ['Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a suspicious handle being opened to lsass.exe. The alert was tagged with a related ATT&CK Technique (Credential Dumping). [PA3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-5.A.1-1.png', 'ScreenshotCaption': 'A Specific Behavior alert for a suspicious handle being opened to lsass.exe, tagged with a related ATT&CK Technique (Credential Dumping)'}], 'Footnotes': ['Vendor stated the capability would have prevented this behavior.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '5.A.2', 'Procedure': 'Cobalt Strike: Built-in hash dump capability executed', 'Techniques': [{'TechniqueId': 'T1003', 'TechniqueName': 'Credential Dumping', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection for credential dumping.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-5.A.2-2.png', 'ScreenshotCaption': 'Telemetry showing cross process events, specifically a handle to open thread into lsass.exe'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A second Specific Behavior alert was generated for Credential Dumping, which indicated that "a remote thread in LSASS accessed credential registry keys." The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-5.A.2-1.png', 'ScreenshotCaption': 'Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert'}, {'ScreenshotName': 'CS-5.A.2-4.png', 'ScreenshotCaption': 'Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for Credential Dumping, which indicated "a DLL was detected as being reflectively loaded in the callstack." The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-5.A.2-1.png', 'ScreenshotCaption': 'Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert'}, {'ScreenshotName': 'CS-5.A.2-4.png', 'ScreenshotCaption': 'Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch also generated a General Behavior alert indicating the Credential Dumping activity was suspicious. The process tree view showed the alert as tainted by a previous detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-5.A.2-1.png', 'ScreenshotCaption': 'Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert'}, {'ScreenshotName': 'CS-5.A.2-4.png', 'ScreenshotCaption': 'Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry for the lsass remote thread and DLL loading would be available in a separate view.[CS8]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-5.A.2-1.png', 'ScreenshotCaption': 'Two Specific Behavior alerts for Credential Dumping (mapped to correct ATT&CK Technique, Credential Dumping, and Tactic, Credential Access) and General Behavior OverWatch alert'}, {'ScreenshotName': 'CS-5.A.2-4.png', 'ScreenshotCaption': 'Process tree view of Specific Behavior alerts for Credential Dumping and OverWatch General Behavior alert (tainted by previous detection by orange line indicating medium severity )'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe injecting into lsass.exe. The telemetry was tainted by the parent “injected (svchost.exe > lsass.exe)” alert. The hashdumpx64.dll was also seen loaded as a floating executable code.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-5.A.2-20.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe process injection into lsass.exe (tainted by a parent injection alert)'}, {'ScreenshotName': 'CR-5.A.2-10.png', 'ScreenshotCaption': 'Parent alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection'}, {'ScreenshotName': 'CR-5.A.2-11.png', 'ScreenshotCaption': 'Telemetry within alert showing loaded hashdumpx64.dll as floating executable code'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the correct ATT&CK Technique (Credential Dumping).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-05-2.png', 'ScreenshotCaption': 'Specific Behavior alert mapped to the correct ATT&CK Technique (Credential Dumping)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-5.A.2-1.png', 'ScreenshotCaption': 'Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying credential dumping'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a thread create within lsass.exe from svchost.exe, which could be indicative of credential dumping. The telemetry was tainted by the parent "Powershell process created" and "Policy Remote Process Compromise" alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-5.A.2-2.png', 'ScreenshotCaption': 'Telemetry showing thread create to lsass.exe (tainted by the parent \\"Powershell process created\\" and \\"Policy Remote Process Compromise\\" alerts)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched data showing a svchost.exe process opening lsass.exe with a description that it was accessing credentials (tainted by parent process injection event that occurred from svchost.exe). Exploit Guard audited the process open and credential extraction event.[MS6]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-5.A.2-1.png', 'ScreenshotCaption': 'Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe'}, {'ScreenshotName': 'MS-5.A.2-2.png', 'ScreenshotCaption': 'Alert for process injection into lsass.exe tainting this event (inner failure message in screenshot not relevant to tested functionality)'}], 'Footnotes': ['Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode. Vendor stated that Credential Guard can also mitigate this attack if enabled.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for svchost dumping credentials via the Registry. The alert was tagged with the correct ATT&CK Technique (Credential Dumping).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-5.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-5.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for svchost dumping credentials via the Registry tagged with the correct ATT&CK Technique (Credential Dumping)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a code injection into lsass.exe. The telemetry was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-5.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-5.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for svchost dumping credentials via the Registry tagged with the correct ATT&CK Technique (Credential Dumping)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[SO1]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': [' Vendor states that the capability would normally block credential dumping activity like this, but the mitigation capability was disabled due to the evaluation parameters.']}]}]}]}, {'Substep': '5.A.2', 'Procedure': 'Cobalt Strike: Hash dump capability involved process injection into lsass.exe', 'Techniques': [{'TechniqueId': 'T1055', 'TechniqueName': 'Process Injection', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated showing the correct ATT&CK Technique (Credential Dumping).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-5.A.2-2.png', 'ScreenshotCaption': 'Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe'}, {'ScreenshotName': 'CB-5.A.2-4.png', 'ScreenshotCaption': 'Specific Behavior alert showing correct ATT&CK Technique (Process Injection)'}, {'ScreenshotName': 'CB-5.A.2-1.png', 'ScreenshotCaption': 'Alert showing correct ATT&CK Technique (Process Injection) within process tree'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new thread and open handle into lsass.exe, which is indicative of process injection for credential dumping.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-5.A.2-2.png', 'ScreenshotCaption': 'Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe'}, {'ScreenshotName': 'CB-5.A.2-4.png', 'ScreenshotCaption': 'Specific Behavior alert showing correct ATT&CK Technique (Process Injection)'}, {'ScreenshotName': 'CB-5.A.2-1.png', 'ScreenshotCaption': 'Alert showing correct ATT&CK Technique (Process Injection) within process tree'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched several event types with descriptions, including for a remote process opening a handle to lsass and a DLL being reflectively loaded (ReflectiveDllOpenLsass), malicious process hollowing (ProcessHollowingDetected), and a remote process injecting code into lsass (LsassInjectedCode).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-5.A.2-5.png', 'ScreenshotCaption': 'Enrichment showing ReflectiveDllOpenLsass, ProcessHollowingDetected, and LsassInjectedCode events'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for svchost.exe injection into lsass.exe. The alert was mapped with the correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection). The hashdumpx64.dll was also seen loaded as a floating executable code.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-5.A.2-10.png', 'ScreenshotCaption': 'Specific Behavior alert for svchost.exe injecting into lsass.exe, labeled as Malicious Code Injection'}, {'ScreenshotName': 'CR-5.A.2-20.png', 'ScreenshotCaption': 'Details of Specific Behavior alert for svchost.exe process injection into lsass.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)'}, {'ScreenshotName': 'CR-5.A.2-11.png', 'ScreenshotCaption': 'Data within alert showing loaded hashdumpx64.dll as floating executable code'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the correct ATT&CK Technique (Process Injection).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-05-2.png', 'ScreenshotCaption': 'Telemetry showing process injection into lsass.exe (tainted by parent Process Injection alert)'}, {'ScreenshotName': 'EG-05-5.png', 'ScreenshotCaption': 'Specific Behavior alert mapped to the correct ATT&CK Technique (Process Injection)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed multiple privileged accesses (including PROCESS_CREATE_THREAD) into lsass, indicative of Process Injection (tainted by the Process Injection alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-05-2.png', 'ScreenshotCaption': 'Telemetry showing process injection into lsass.exe (tainted by parent Process Injection alert)'}, {'ScreenshotName': 'EG-05-5.png', 'ScreenshotCaption': 'Specific Behavior alert mapped to the correct ATT&CK Technique (Process Injection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-5.A.2-1.png', 'ScreenshotCaption': 'Enrichment of svchost.exe injecting a thread into lsass.exe with a tag identifying thread injection'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for process hijacking based on a thread create within lsass.exe from svchost.exe (tainted by the parent "Powershell process created" and "Policy Remote Process Compromise" alerts.)', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-5.A.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing process hijacking detection for lsass.exe thread create (tainted by the parent \\"Powershell process created\\" and \\"Policy Remote Process Compromise\\" alerts)'}, {'ScreenshotName': 'CT-5.A.2-3.png', 'ScreenshotCaption': 'General Behavior alert showing DDNA Scan for svchost.exe'}, {'ScreenshotName': 'CT-5.A.2-5.png', 'ScreenshotCaption': 'General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process'}], 'Footnotes': ['The vendor noted Privilege Escalation is one of ten "Capabilities" that are part of the taxonomy.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated when a DDNA Scan alerted for svchost.exe. The DDNA scan results showed that svchost.exe "appeared to inject code into another process."', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-5.A.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing process hijacking detection for lsass.exe thread create (tainted by the parent \\"Powershell process created\\" and \\"Policy Remote Process Compromise\\" alerts)'}, {'ScreenshotName': 'CT-5.A.2-3.png', 'ScreenshotCaption': 'General Behavior alert showing DDNA Scan for svchost.exe'}, {'ScreenshotName': 'CT-5.A.2-5.png', 'ScreenshotCaption': 'General Behavior alert details on DDNA Scan for svchost.exe, including that it appears to inject code into another process'}], 'Footnotes': [' According to the vendor, DDNA scans trigger due to machine learning scanning in-memory code and identifying that the code is malicious. DDNA output, which is delayed, shows the process capabilities (known as "traits"), which may give an analyst clues on what the process does.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for process injection into lsass.exe. The alert was rolled up under the prior lsass.exe process injection alert and the last activity seen field was updated.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-5.A.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)'}, {'ScreenshotName': 'MS-5.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe'}, {'ScreenshotName': 'MS-5.A.1-1.png', 'ScreenshotCaption': 'Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe accessing lsass.exe and dumping credentials (tainted by parent alert on sensitive credential memory read for the first credential dump). Exploit Guard audited process open and credential extraction event.[MS30]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-5.A.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)'}, {'ScreenshotName': 'MS-5.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe'}, {'ScreenshotName': 'MS-5.A.1-1.png', 'ScreenshotCaption': 'Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe'}], 'Footnotes': ['Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a code injection into lsass.exe. The telemetry was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-5.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing a code injection into lsass.exe (tainted by a parent process injection alert on cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe injecting into svchost.exe (not counted for detection) then invoking a remote thread into lsass.exe. Powershell.exe was listed as the source of the remote thread into lsass.exe instead of svchost.exe because the alert on powershell.exe came before other events and therefore had increased precedence. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-5.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe invoking a remote thread into lsass.exe (Group ID tainted this event but was not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '5.B.1', 'Procedure': 'Cobalt Strike: Built-in token theft capability executed to change user context to George', 'Techniques': [{'TechniqueId': 'T1134', 'TechniqueName': 'Access Token Manipulation', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a change in user execution context from Debbie to George between parent and child processes, which is indicative of token manipulation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-5.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing parent cmd.exe process running under user context Debbie'}, {'ScreenshotName': 'CB-5.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing child cmd.exe process running under user context George'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed the compromised process (21898821890) running as Debbie, then children from this process spawning first as Debbie and later as George. This could indicate theft of George's token within the context of the process.", 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-5.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing children of the compromised process (PID 21898821890) first running as Debbie, then as George'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe associated with both users Debbie and George, indicating user context change via token manipulation. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-5.B.1-10.png', 'ScreenshotCaption': 'Telemetry within the process tree showing cmd.exe associated with users Debbie and George (tainted by a parent alert on explorer.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for Privilege Escalation based on rundll32.exe as Debbie, spawning the process cmd.exe as George, which indicated a possible stolen token. The alert was mapped to the correct ATT&CK Technique (T1134 - Access Token Manipulation) and Tactics (Privilege Escalation, Defense Evasion).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-05-6.png', 'ScreenshotCaption': 'Specific Behavior alert on Privilege Escalation showing a process spawning (cmd.exe) with different tokens than the parent (rundll32.exe) (mapped to the correct ATT&CK Technique, T1134 - Access Token Manipulation, and Tactics, Privilege Escalation and Defense Evasion)'}, {'ScreenshotName': 'EG-05-7.png', 'ScreenshotCaption': 'Telemetry showing the cmd.exe that spawned as user George from rundll32.exe running as user Debbie (tainted by parent Privilege Escalation alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the users change in the parent-child processes of rundll32.exe and cmd.exe (tainted by the Privilege Escalation alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-05-6.png', 'ScreenshotCaption': 'Specific Behavior alert on Privilege Escalation showing a process spawning (cmd.exe) with different tokens than the parent (rundll32.exe) (mapped to the correct ATT&CK Technique, T1134 - Access Token Manipulation, and Tactics, Privilege Escalation and Defense Evasion)'}, {'ScreenshotName': 'EG-05-7.png', 'ScreenshotCaption': 'Telemetry showing the cmd.exe that spawned as user George from rundll32.exe running as user Debbie (tainted by parent Privilege Escalation alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-5.B.1-T1134-new.png', 'ScreenshotCaption': 'Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process (net.exe) executed during Step 4 as user Debbie and a subsequent process (reg.exe) executed during Step 6 as user George, indicating a change in user context from a stolen token.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-4.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing the user Debbie executing net.exe with command-line arguments during Step 4'}, {'ScreenshotName': 'FE-5.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing the user George executing reg.exe with command-line arguments during Step 6'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a change in user execution context from Debbie to George between processes, which is indicative of token manipulation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-5.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing a change in user execution context from Debbie to George between processes'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe as a high integrity process from SYSTEM and subsequent cmd.exe process running as user George (tainted by the parent alert on suspicious process injection into lsass.exe). Svchost.exe was executed with seclogon command-line argument indicating token manipulation.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-5.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe invocation with seclogon flag subsequently running cmd.exe as SYSTEM'}, {'ScreenshotName': 'MS-5.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing resulting cmd.exe running as user George'}, {'ScreenshotName': 'MS-5.B.1-4.png', 'ScreenshotCaption': 'Alert for suspicious process injection showing tainted association via a process tree containing subsequent cmd.exe processes (inner failure message in screenshot not relevant to tested functionality)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation. The telemetry was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-5.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation (tainted by a parent process injection alert on cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '6.A.1', 'Procedure': "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", 'Techniques': [{'TechniqueId': 'T1012', 'TechniqueName': 'Query Registry', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CB-6.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CB-6.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating the reg query command was suspicious. The alert was tainted by the parent cmd.exe process.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg with command-line arguments'}, {'ScreenshotName': 'CS-6.A.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert identifying reg query as suspicious as well as reg.exe process (tainted by previous detection by orange line indicating medium severity)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by the parent cmd.exe process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg with command-line arguments'}, {'ScreenshotName': 'CS-6.A.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert identifying reg query as suspicious as well as reg.exe process (tainted by previous detection by orange line indicating medium severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-6.A.1-10.png', 'ScreenshotCaption': 'Telemetry showing reg.exe executing with command-line arguments (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent Process Injection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-06-1.png', 'ScreenshotCaption': 'Telemetry showing reg with command-line arguments'}, {'ScreenshotName': 'EG-06-4.png', 'ScreenshotCaption': 'Event tree view of telemetry showing reg with command-line arguments (tainted by parent Process Injection alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe identifying that a sensitive Registry key was accessed which could be used for recon.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-6.A.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon'}, {'ScreenshotName': 'CC-6.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-6.A.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe identifying that a sensitive Registry key was accessed which could be used for recon'}, {'ScreenshotName': 'CC-6.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified reg.exe as a reconnaissance command to enumerate a Registry key on the host Conficker to determine the configuration of its Windows Terminal Server service. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-6.A.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-6.A.1-2.png', 'ScreenshotCaption': 'File Write To Named Pipe  alert for write to remote named pipe from reg.exe'}, {'ScreenshotName': 'FE-6.A.1-3.png', 'ScreenshotCaption': 'Additional details on named pipe alert'}, {'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)'}, {'ScreenshotName': 'FE-6.A.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about reg query'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery). An alert was also generated for a File Write To Named Pipe (Weak Signal) for reg.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-6.A.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-6.A.1-2.png', 'ScreenshotCaption': 'File Write To Named Pipe  alert for write to remote named pipe from reg.exe'}, {'ScreenshotName': 'FE-6.A.1-3.png', 'ScreenshotCaption': 'Additional details on named pipe alert'}, {'ScreenshotName': 'FE-2.A.1-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)'}, {'ScreenshotName': 'FE-6.A.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about reg query'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg.exe with command-line arguments. Telemetry also showed that two PIPEs were created as a result of reg.exe execution. The telemetry was tainted by the parent "Powershell process created" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments (tainted by the parent \\"Powershell process created\\" alert)'}, {'ScreenshotName': 'CT-6.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing PIPEs created (tainted by the parent \\"Powershell process created\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated indicating that reg.exe command-line arguments contains signs of malicious usage such as encoded content or interacting with Registry keys.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MC-6.A.1-11.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg.exe with command-line arguments (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-6.A.1-7.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility'}, {'ScreenshotName': 'MC-6.A.1-5.png', 'ScreenshotCaption': 'General Behavior alert indicating that reg.exe command-line arguments contains signs of malicious usage'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-6.A.1-11.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg.exe with command-line arguments (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-6.A.1-7.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility'}, {'ScreenshotName': 'MC-6.A.1-5.png', 'ScreenshotCaption': 'General Behavior alert indicating that reg.exe command-line arguments contains signs of malicious usage'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-6.A.1-11.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg.exe with command-line arguments (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-6.A.1-7.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the Registry was queried via execution of the reg.exe utility'}, {'ScreenshotName': 'MC-6.A.1-5.png', 'ScreenshotCaption': 'General Behavior alert indicating that reg.exe command-line arguments contains signs of malicious usage'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of reg.exe executing with command-line arguments. The telemetry was tainted by the relationship to prior rundll32.exe activity based on process injection alert context.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for reg.exe with command-line arguments'}, {'ScreenshotName': 'MS-6.A.1-2.png', 'ScreenshotCaption': 'Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe executing with the correct ATT&CK Technique (Query Registry).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-6.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of reg.exe as querying a remote key (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-6.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of reg.exe as querying a remote key. The data was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-6.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of reg.exe as querying a remote key (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-6.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg with command-line arguments (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-6.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of reg.exe as querying a remote key (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-6.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with the correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-06-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-6.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing reg with command-line arguments (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '6.B.1', 'Procedure': 'Cobalt Strike: C2 channel modified to use port 80', 'Techniques': [{'TechniqueId': 'T1043', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the network connections from rundll32.exe with the correct ATT&CK Technique (T1043 - Commonly Used Port).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'CB-6.B.1-4.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connections over TCP port 80 to 192.168.0.4 (C2 server).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'CB-6.B.1-4.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection over TCP port 80 to 192.168.0.4 (C2 server).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-6.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched rundll32.exe opening a connection to the C2 server over a \\"HTTP port\\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-6.B.1-10.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe making a connection over the \\"HTTP Port\\" with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-6.B.1-20.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe opening a connection over port 80 (tainted by a parent Injected Shellcode alert, listed as Owner process)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe opening a connection over port 80. The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-6.B.1-10.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe making a connection over the \\"HTTP Port\\" with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-6.B.1-20.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe opening a connection over port 80 (tainted by a parent Injected Shellcode alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a TCP port 80 connection from rundll32.exe to 192.168.0.4 (C2 server). The telemetry was tainted by a parent Malicious File Detection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-06-2.png', 'ScreenshotCaption': 'Telemetry showing a TCP port 80 connection from rundll32.exe'}, {'ScreenshotName': 'EG-06-7.png', 'ScreenshotCaption': 'Telemetry showing port 80 traffic (tainted by the parent\xa0Malicious File Detection alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connections over port 80 to 192.168.0.4 (C2 server) initiated from rundll32.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-6.B.1-T1043-new.png', 'ScreenshotCaption': 'Telemetry showing network connections over port 80 to 192.168.0.4 (C2 server)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified C2 communication over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain).\xa0[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 80 connections to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'FE-6.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection over port 80 to 192.168.0.4 (C2 server).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 80 connections to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'FE-6.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an outbound network connection from rundll32.exe to 192.168.0.4 (C2 server) over TCP port 80. The telemetry was tainted by the parent "Sponsor Process Established Network Connection" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing outbound traffic to 192.168.0.4 (C2 server) over TCP port 80 (tainted by parent \\"Sponsor Process Established Network Connection\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)'}, {'ScreenshotName': 'MC-6.C.1-2.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed connections over TCP port 80 to freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)'}, {'ScreenshotName': 'MC-6.C.1-2.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for rundll32.exe opening a connection to 192.186.0.4 (C2 server) over port 80. The telemetry was tainted by the relationship to the previous alert on unexpected behavior originating from rundll32.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for rundll32.exe opening network connection'}, {'ScreenshotName': 'MS-6.B.1-2.png', 'ScreenshotCaption': 'Incident graph from \\"Unexpected process behavior\\" alert (resulting from rundll32.exe) showing tainted network connection'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed port 80 command and control traffic.[PA2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 80 command and control traffic'}], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed connections over TCP port 80 to freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-06-2.png', 'ScreenshotCaption': 'Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a port 80 connection to 192.168.0.4 (C2 server) that was associated with the rundll32 parent process. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 80 connection to 192.168.0.4 (C2 server) (tainted by relationship to rundll32 parent process linked by Group ID but not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '6.B.1', 'Procedure': 'Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com', 'Techniques': [{'TechniqueId': 'T1071', 'TechniqueName': 'Standard Application Layer Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connections over TCP port 80 as well as a modload showing winhttp.dll was loaded, which an analyst could use to determine HTTP was used.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.B.1-8.png', 'ScreenshotCaption': 'Telemetry showing modloads showing winhttp.dll loaded'}, {'ScreenshotName': 'CB-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing network connection over TCP port 80 to the C2 domain (could be used in conjunction with modload to determine protocol)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed a connection to 192.168.0.4 (C2 server) on port 80 (no detection showed HTTP specifically).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched rundll32.exe opening an unusual network connection to the C2 server over the port 80 "HTTP port.” The data was tagged with the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol), and also showed the amount of transmitted/received bytes as well as that the winhttp.dll module was loaded (which an analyst could use to determine HTTP was used). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-6.B.1-30.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe making an unusual network connection over the \\"HTTP Port\\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol) (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-6.B.1-100.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe showing connection over port 80 and the amount of transmitted/received bytes (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-6.B.1-101.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe showing winhttp.dll module loaded (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed a connection to port 80 (no detection showed HTTP specifically).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a trace of HTTP connections being made by rundll32.exe to freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing rundll32 making HTTP connections'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified C2 communication over HTTP to www.freegoogleadsenseinfo.com (C2 domain). [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-6.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'FE-6.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed HTTP GET requests over port 80 to 192.168.0.4 (C2 server).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-6.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'FE-6.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an outbound HTTP request to www.freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing outbound C2 traffic over HTTP to www.freegoogleadsense.info (C2 domain)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connections over TCP port 80 and that winhttp.dll module was loaded into the same process (PID 6276) that made the network connection, which an analyst could use to determine HTTP was used.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)'}, {'ScreenshotName': 'MC-6.B.1-22.png', 'ScreenshotCaption': 'Telemetry showing that the winhttp.dll module was loaded into the process (PID 6276) that made the network connection'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed a connection to port 80 (no detection showed HTTP specifically).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed port 80 command and control traffic as well as the loading of winhttp.dll, which an analyst could use to determine HTTP was used.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 80 command and control traffic as well as the loading of winhttp.dll'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed a connection to TCP port 80 (no detection showed HTTP specifically).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[SO96]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Telemetry showed a connection to port 80 (no detection showed HTTP specifically).']}]}]}]}, {'Substep': '6.B.1', 'Procedure': 'Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS', 'Techniques': [{'TechniqueId': 'T1026', 'TechniqueName': 'Multiband Communication', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed separate network connections over port TCP port 80 and UDP port 53, which could indicate multiband communication.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing network connection over UDP port 53'}, {'ScreenshotName': 'CB-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing network connection over TCP port 80'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed connections over both DNS and TCP port 80, which could indicate multiband communication. The DNS connections were tainted by a parent Exfiltration alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-6.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing TCP port 80 connection to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'CS-1.C.1-2.png', 'ScreenshotCaption': 'Telemetry within an alert showing abnormally large DNS requests occurred (tainted by parent Exfiltration alert)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-6.B.1-20.png', 'ScreenshotCaption': 'Telemetry showing the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain) (tainted by a parent Injected Shellcode alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed connections over DNS as well as over port 80, which could indicate multiband communication. The telemetry was tainted by a parent Malicious File Detection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-06-6.png', 'ScreenshotCaption': 'Telemetry showing DNS connections'}, {'ScreenshotName': 'EG-06-7.png', 'ScreenshotCaption': 'Telemetry showing port 80 traffic (tainted by parent\xa0Malicious File Detection alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server) as well as earlier identified DNS queries, which could indicate multiband communication.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-6.B.1-T1043-new.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe making network connections over port 80 to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'CC-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe making DNS queries'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified C2 communication over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)'}, {'ScreenshotName': 'FE-6.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a combination of both DNS requests as well as HTTP requests, which could indicate multiband communication.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-6.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)'}, {'ScreenshotName': 'FE-6.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed C2 traffic was over TCP port 80 as well as earlier traffic over DNS, which could indicate multiband communication. The HTTP telemetry over TCP port 80 was tainted by the parent "Sponsor Process Established Network Connection" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS queries to freegoogleadsenseinfo.com (C2 domain) from svchost.exe'}, {'ScreenshotName': 'CT-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing outbound traffic to 192.168.0.4 (C2 server) over TCP port 80 (tainted by the parent \\"Sponsor Process Established Network Connection\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an execution sequence for rundll32.exe opening a connection to 192.168.0.4 (C2 server) over port 80, and prior activity showed DNS traffic to the same C2 IP address, which could indicate multiband communication. The port 80 telemetry was tainted by the relationship to the previous alert on unexpected behavior originating from rundll32.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-6.B.1-2.png', 'ScreenshotCaption': 'Incident graph from \\"Unexpected process behavior\\" alert (resulting from rundll32.exe) showing tainted network connection'}, {'ScreenshotName': 'MS-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for rundll32.exe opening port 80 network connection'}, {'ScreenshotName': 'MS-6.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing DNS traffic to C2 domain'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed command and control traffic for both ports 80 and 53 .', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing ports 80 and 53 command and control traffic'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed port 80 connections to 192.168.0.4 (C2 server) and DNS requests for freegoogleadsenseinfo.com (C2 domain), which could indicate multiband communication. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 80 connection to 192.168.0.4 (C2 server)'}, {'ScreenshotName': 'S1-1.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing DNS query to C2 domain (tainted by relationship to threat story shown in Group ID)'}], 'Footnotes': []}]}]}]}, {'Substep': '6.C.1', 'Procedure': 'Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)', 'Techniques': [{'TechniqueId': 'T1076', 'TechniqueName': 'Remote Desktop Protocol', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the rdpclip.exe events with the correct ATT&CK Technique (Remote Desktop Protocol).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)'}, {'ScreenshotName': 'CB-6.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing rdpclip.exe running'}, {'ScreenshotName': 'CB-6.C.1-1.png', 'ScreenshotCaption': 'Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to 10.0.0.5 (Conficker) over TCP port 3389 as well as rdpclip.exe executing.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-6.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)'}, {'ScreenshotName': 'CB-6.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing rdpclip.exe running'}, {'ScreenshotName': 'CB-6.C.1-1.png', 'ScreenshotCaption': 'Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because they identified suspicious communications over port 3389 (RDP) to other hosts.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-6.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing logon type 10 (interactive remote login) as user George@shockwave on 10.0.0.5 (Conficker)'}, {'ScreenshotName': 'CS-6.C.1-5.png', 'ScreenshotCaption': 'Telemetry showing a network connection to 10.0.0.5 (Conficker) over TCP port 3389'}, {'ScreenshotName': 'CS-E-1.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection for logon type 10 (interactive logon) and a connection to 10.0.0.5 (Conficker) over TCP port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-6.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing logon type 10 (interactive remote login) as user George@shockwave on 10.0.0.5 (Conficker)'}, {'ScreenshotName': 'CS-6.C.1-5.png', 'ScreenshotCaption': 'Telemetry showing a network connection to 10.0.0.5 (Conficker) over TCP port 3389'}, {'ScreenshotName': 'CS-E-1.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type. The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process Telemetry also showed rdpclip.exe executing on 10.0.0.5 (Conficker).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-6.B.1-20.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent Injected Shellcode alert, listed as Owner process)'}, {'ScreenshotName': 'CR-6.C.1-10.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type'}, {'ScreenshotName': 'CR-6.C.1-11.png', 'ScreenshotCaption': 'Telemetry showing rdpclip.exe executing on 10.0.0.5 (Conficker)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection over port 3389 to 10.0.0.5 (Conficker) as well as a Type 10 (interactive remote) login event by user George on Conficker. The port 3389 telemetry was tainted by a parent Process Injection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-06-4.png', 'ScreenshotCaption': 'Event tree view of telemetry showing port 3389 connection to 10.0.0.5 (Conficker) (tainted by parent Process Injection alert)'}, {'ScreenshotName': 'EG-06-3.png', 'ScreenshotCaption': 'Telemetry showing Type 10 (interactive remote) login event by user George on Conficker'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-6.C.1-T1076-new.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe making network connections to 10.0.0.5 (Conficker) over port 3389'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the RDP connection from rundll32.exe with an alert for RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-6.C.1-1.png', 'ScreenshotCaption': 'Enrichment of RDP connection from rundll32.exe with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed cmd.exe creating an outbound TCP port 3389 (RDP) connection from Nimda and enriched the connection with the conditions Lateral Movement and Remote Share Access. The enrichment was tainted by the parent \\"Windows command prompt invoked\\" alert. [CT22]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-6.C.1-1.png', 'ScreenshotCaption': 'Enrichment of outbound TCP port 3389 (RDP) connection with Lateral Movement and Remote Share Access (tainted by parent \\"Windows command prompt invoked\\" alert)'}, {'ScreenshotName': 'CT-6.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing inbound TCP port 3389 connection to 10.0.0.5 (Conficker)'}], 'Footnotes': ["At least one condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry also identified an inbound connection to Conficker over TCP port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-6.C.1-1.png', 'ScreenshotCaption': 'Enrichment of outbound TCP port 3389 (RDP) connection with Lateral Movement and Remote Share Access (tainted by parent \\"Windows command prompt invoked\\" alert)'}, {'ScreenshotName': 'CT-6.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing inbound TCP port 3389 connection to 10.0.0.5 (Conficker)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Lateral Movement) and the Technique (Remote Desktop Protocol).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-6.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing a connection to 10.0.0.5 (Conficker) over TCP port 3389'}, {'ScreenshotName': 'MC-6.C.1-2.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Lateral Movement) and the Technique (Remote Desktop Protocol)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to 10.0.0.5 (Conficker) over TCP port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-6.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing a connection to 10.0.0.5 (Conficker) over TCP port 3389'}, {'ScreenshotName': 'MC-6.C.1-2.png', 'ScreenshotCaption': 'Enrichment of rundll32.exe (the process that made the network connection) with the correct ATT&CK Tactic (Lateral Movement) and the Technique (Remote Desktop Protocol)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker). Logon activity over the last 30 days on Conficker shows George with a logon type 10 RemoteInteractive logon event. Telemetry also showed George logged into Conficker and displayed a movement graph of activity from user account Debbie to George.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-6.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for cmd.exe connection over RDP to 10.0.0.5 (Conficker)'}, {'ScreenshotName': 'MS-6.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution sequence on 10.0.0.5 (Conficker) showing George logon'}, {'ScreenshotName': 'MS-6.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing user logon activity on 10.0.0.5 (Conficker) showing George with a logon type 10 RemoteInteractive logon event'}, {'ScreenshotName': 'MS-6.C.1-4.png', 'ScreenshotCaption': 'Graph showing movement from Debbie account to George'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for an unexpected process using the RDP port. The data was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-6.C.1-1.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-6.C.1-2.png', 'ScreenshotCaption': 'General Behavior alert for an unexpected process using the RDP port (tainted by a parent process injection alert on cmd.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker). The telemetry was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-6.C.1-1.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-6.C.1-2.png', 'ScreenshotCaption': 'General Behavior alert for an unexpected process using the RDP port (tainted by a parent process injection alert on cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe connecting to 10.0.0.5 (Conficker) over port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-06-3.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe connecting over port 3389 (RDP) to 10.0.0.5 (Conficker)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a port 3389 connection. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-6.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 3389 connection (tainted by relationship to threat story shown in Group ID)'}], 'Footnotes': []}]}]}]}, {'Substep': '7.A.1', 'Procedure': 'Added user Jesse to Conficker (10.0.0.5) through RDP connection', 'Techniques': [{'TechniqueId': 'T1136', 'TechniqueName': 'Create Account', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched lsass.exe with the tag \\"Create Accounts using GUI\\". [CB1]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'CB-7.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing Registry modifications for new user Jesse'}, {'ScreenshotName': 'CB-7.A.1-4.png', 'ScreenshotCaption': 'Enrichment of lsass.exe with tag \\"Create Accounts using GUI\\"'}], 'Footnotes': [' The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Registry modification events related to the creation of the user account Jesse.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-7.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing Registry modifications for new user Jesse'}, {'ScreenshotName': 'CB-7.A.1-4.png', 'ScreenshotCaption': 'Enrichment of lsass.exe with tag \\"Create Accounts using GUI\\"'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the user Jesse and the user being added to the domain admin group.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of the user Jesse with the user RID 000003E8'}, {'ScreenshotName': 'CS-7.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing user RID 000003E8 (corresponding to the user Jesse) added to the admin group (00000220), a well-known security identifier'}, {'ScreenshotName': 'CS-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing group membership of the user Jesse, including Remote (0000022B), Admins (00000220), and Users (00000221), which are well-known security identifiers'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed lsass.exe creating a Registry key for user Jesse, indicating that the user is new.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-7.A.1-20.png', 'ScreenshotCaption': 'Telemetry showing lsass.exe creating a Registry key for user Jesse'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the new user Jesse.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-7.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of the new user Jesse'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified the creation of a local user account for Jesse on Conficker. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of user Jesse'}, {'ScreenshotName': 'FE-7.A.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from Conficker showed the creation of the new user Jesse.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of user Jesse'}, {'ScreenshotName': 'FE-7.A.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert named "New user account created" was generated based on the Registry change identifying that the new user Jesse was created. A child event of the alert indicated that the account had been added to the local admins group (but did not identify the account creation specifically).', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'CT-7.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"New user account created\\" and event showing account name was Jesse'}, {'ScreenshotName': 'CT-7.A.1-2.png', 'ScreenshotCaption': 'Child event of Specific Behavior alert showing new account added to local admins group'}], 'Footnotes': [" This alert was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the user Jesse.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of user account Jesse'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed data for account Jesse creation after configuration change to enable collection of event ID 4720.[MS7]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'MS-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of user account Jesse'}], 'Footnotes': [' Visibility of account creation data was verified in retesting at the end of the evaluation after vendor adjusted data collection configuration and visibility of account creation.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe creating a Registry key for user Jesse'}, {'ScreenshotName': 'PA-7.A.1-4.png', 'ScreenshotCaption': 'Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed mmc.exe creating a Registry key for user Jesse, indicating that the user is new.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe creating a Registry key for user Jesse'}, {'ScreenshotName': 'PA-7.A.1-4.png', 'ScreenshotCaption': 'Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the user Jesse which was noted from SAM Registry events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of user account Jesse'}], 'Footnotes': []}]}]}]}, {'Substep': '7.A.1', 'Procedure': 'Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection', 'Techniques': [{'TechniqueId': 'T1061', 'TechniqueName': 'Graphical User Interface', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lusrmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-6.C.1-4.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lursmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-7.A.1-30.png', 'ScreenshotCaption': 'Telemetry showing lusrmgr.msc running from mmc.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-07-5.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lursmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-7.A.1-T1061-new.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lursmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe spawning lusrmgr.exe'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in) (tainted by the parent "LSA Registry Key modified" alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe process executing lusrmgr.msc (tainted by the parent \\"LSA Registry Key modified\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-7.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lusrmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-7.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lusrmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing lusrmgr.msc running from mmc.exe'}, {'ScreenshotName': 'PA-7.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing lusrmgr.msc running from mmc.exe'}, {'ScreenshotName': 'PA-7.A.1-2.png', 'ScreenshotCaption': 'Enrichment of the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '7.A.1', 'Procedure': 'Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information', 'Techniques': [{'TechniqueId': 'T1087', 'TechniqueName': 'Account Discovery', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lusrmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-6.C.1-4.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lursmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-7.A.1-10.png', 'ScreenshotCaption': 'Telemetry showing lusrmgr.msc running from mmc.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-07-5.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lusrmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in), which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lursmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in), which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lusrmgr.exe'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information. The telemetry was tainted by the parent "LSA Registry Key modified" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-7.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lusrmgr.msc (tainted by the parent \\"LSA Registry Key modified\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-7.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing lusrmgr.msc running from mmc.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-7.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing mmc.exe running lusrmgr.msc'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in) as reconnaissance via the MMC utility with local users and groups view.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing lusrmgr.msc running from mmc.exe'}, {'ScreenshotName': 'PA-7.A.1-5.png', 'ScreenshotCaption': 'Enrichment of mmc.exe as reconnaissance via the MMC utility with local users and groups view'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing lusrmgr.msc running from mmc.exe'}, {'ScreenshotName': 'PA-7.A.1-5.png', 'ScreenshotCaption': 'Enrichment of mmc.exe as reconnaissance via the MMC utility with local users and groups view'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '7.B.1', 'Procedure': 'Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file modification events indicating updater.dll being created and written to disk.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-7.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing updater.dll written to disk'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write for updater.dll into the system32 folder by user George. The telemetry was tainted by the parent \\"unexpected process\\" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-7.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing file write for updater.dll (tainted by the parent \\"unexpected process\\" alert)'}, {'ScreenshotName': 'CS-7.B.1-2.png', 'ScreenshotCaption': 'Additional telemetry showing\xa0file write for updater.dll'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of updater.dll. Telemetry was tainted by a parent alert on cmd.exe (listed as the owner process) generated based on updater.dll being detected as known malware.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-7.B.1-10.png', 'ScreenshotCaption': 'Telemetry showing the file write of updater.dll (tainted by a parent alert on cmd.exe, listed as Owner Process)'}, {'ScreenshotName': 'CR-7.B.1-11.png', 'ScreenshotCaption': 'Parent alert for updater.dll being detected as known malware'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of updater.dll (tainted by the parent Malicious File Detection).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-07-1.png', 'ScreenshotCaption': 'Telemetry showing creation of updater.dll\xa0(tainted by parent Malicious File Detection alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the creation of updater.dll identifying that a command prompt modified an unknown DLL.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-7.B.1-1.png', 'ScreenshotCaption': 'Enrichment of the creation of updater.dll identifying that a command prompt modified an unknown DLL'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched updater.dll being written by cmd.exe with an alert for CMD File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105\xa0- Remote File Copy) and a related ATT&CK Technique (T1059 - Command-Line Interface) and Tactic (Execution).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-7.B.1-1.png', 'ScreenshotCaption': 'Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105 \xa0- Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)'}, {'ScreenshotName': 'FE-7.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing updater.dll file write (tainted by parent AV signature alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write for updater.dll into the system32 folder. The telemetry was tainted by the parent AV signature alert for updater.dll.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-7.B.1-1.png', 'ScreenshotCaption': 'Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105 \xa0- Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)'}, {'ScreenshotName': 'FE-7.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing updater.dll file write (tainted by parent AV signature alert)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of updater.dll. The telemetry was tainted by the parent "Powershell process created" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-7.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of updater.dll (tainted by the parent \\"Powershell process created\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a new dynamic library created in the Windows system (System32) folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-7.B.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a new PE file created in the Windows system (System32) folder'}, {'ScreenshotName': 'MC-7.B.1-99.png', 'ScreenshotCaption': 'Specific Behavior alert for a new dynamic library file created in the Windows system (System32) folder'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a new PE file created in the Windows system (System32) folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-7.B.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a new PE file created in the Windows system (System32) folder'}, {'ScreenshotName': 'MC-7.B.1-99.png', 'ScreenshotCaption': 'Specific Behavior alert for a new dynamic library file created in the Windows system (System32) folder'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe writing updater.dll to disk.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-7.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing file write of updater.dll'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a script engine creating/writing a DLL in the system32 folder. The alert was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-7.B.1-1.png', 'ScreenshotCaption': 'Telemetry showed the file create event for updater.dll'}, {'ScreenshotName': 'PA-7.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a script engine creating/writing a DLL in the system32 folder (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.B.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a Windows scripting engine creating an executable on disk'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a Windows scripting engine creating an executable on disk.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.B.1-1.png', 'ScreenshotCaption': 'Telemetry showed the file create event for updater.dll'}, {'ScreenshotName': 'PA-7.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a script engine creating/writing a DLL in the system32 folder (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.B.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a Windows scripting engine creating an executable on disk'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for updater.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.B.1-1.png', 'ScreenshotCaption': 'Telemetry showed the file create event for updater.dll'}, {'ScreenshotName': 'PA-7.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a script engine creating/writing a DLL in the system32 folder (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.B.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a Windows scripting engine creating an executable on disk'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write of updater.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-07-1.png', 'ScreenshotCaption': 'Telemetry showing file write event of updater.dll'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write of updater.dll. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-7.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing file write of updater.dll (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '7.C.1', 'Procedure': "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", 'Techniques': [{'TechniqueId': 'T1053', 'TechniqueName': 'Scheduled Task', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated mapped to the correct ATT&CK Technique (T1053 - Scheduled Task).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree containing schtasks.exe and full command a task creation'}, {'ScreenshotName': 'CB-7.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the process tree containing schtasks.exe as well as the full command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree containing schtasks.exe and full command a task creation'}, {'ScreenshotName': 'CB-7.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a Specific Behavior was observed because a scheduled task was created for persistence.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-7.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing creation of the scheduled task'}, {'ScreenshotName': 'CS-7.C.1-3.png', 'ScreenshotCaption': 'General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-E-4.png', 'ScreenshotCaption': 'Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating the creation of the scheduled task was suspicious. The process tree view showed the alert as tainted by a previous cmd.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-7.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing creation of the scheduled task'}, {'ScreenshotName': 'CS-7.C.1-3.png', 'ScreenshotCaption': 'General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-E-4.png', 'ScreenshotCaption': 'Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the scheduled task.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-7.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing creation of the scheduled task'}, {'ScreenshotName': 'CS-7.C.1-3.png', 'ScreenshotCaption': 'General Behavior alert from OverWatch indicating scheduled task creation was suspicious (tainted by previous cmd.exe detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-E-4.png', 'ScreenshotCaption': 'Email excerpt from OverWatch team indicating they observed a scheduled task establishing persistence (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched schtasks.exe creating the Resume Viewer Update Checker scheduled task as reboot persistence and as SYSTEM. The data was also mapped to the correct ATT&CK Tactic (Persistence).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-7.C.1-10.png', 'ScreenshotCaption': 'Enrichment of schtasks.exe with the correct ATT&CK Tactic (Persistence)'}, {'ScreenshotName': 'CR-7.C.1-11.png', 'ScreenshotCaption': 'Telemetry showing the Resume Viewer Update Checker scheduled task'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the Resume Viewer Update Checker scheduled task.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-7.C.1-10.png', 'ScreenshotCaption': 'Enrichment of schtasks.exe with the correct ATT&CK Tactic (Persistence)'}, {'ScreenshotName': 'CR-7.C.1-11.png', 'ScreenshotCaption': 'Telemetry showing the Resume Viewer Update Checker scheduled task'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert for "Persistence-Scheduled Task Creation" was generated (tainted by parent Malicious File Detection alert). \xa0The alert was also mapped to the correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-07-2.png', 'ScreenshotCaption': 'Enrichment of scheduled task from persistence hunt'}, {'ScreenshotName': 'EG-07-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-07-4.png', 'ScreenshotCaption': 'Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched data from a hunt for persistence via scheduled task, which showed the \\"Resume Viewer Update Checker\\" scheduled task.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-07-2.png', 'ScreenshotCaption': 'Enrichment of scheduled task from persistence hunt'}, {'ScreenshotName': 'EG-07-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-07-4.png', 'ScreenshotCaption': 'Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the event tree with the correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-07-2.png', 'ScreenshotCaption': 'Enrichment of scheduled task from persistence hunt'}, {'ScreenshotName': 'EG-07-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-07-4.png', 'ScreenshotCaption': 'Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing creation of the scheduled task data was also visible in a event tree (tainted by parent Malicious File Detection alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-07-2.png', 'ScreenshotCaption': 'Enrichment of scheduled task from persistence hunt'}, {'ScreenshotName': 'EG-07-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of scheduled task with correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-07-4.png', 'ScreenshotCaption': 'Specific Behavior alert for scheduled task creation mapped to correct ATT&CK Technique (T1053 - Scheduled Task) and Tactic (Persistence) (tainted by parent Malicious File Detection alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe registering the "Resume Viewer Update Checker" scheduled task.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-7.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that updater.dll persisted through the creation of a scheduled task. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-7.C.1-1.png', 'ScreenshotCaption': 'Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)'}, {'ScreenshotName': 'FE-7.C.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)'}, {'ScreenshotName': 'FE-7.C.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about schtask'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched schtasks.exe with an alert for Scheduled Task Activity (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1053 - Scheduled Task) and Tactics (Execution, Persistence, and Privilege Escalation).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-7.C.1-1.png', 'ScreenshotCaption': 'Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)'}, {'ScreenshotName': 'FE-7.C.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)'}, {'ScreenshotName': 'FE-7.C.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report with additional details about schtask'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert called "Schtasks with create command" was generated due to a schtasks.exe process create from cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-7.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert on \\"Schtasks with create command\\" for schtasks.exe run from cmd.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the Schtasks alert showed a process creation of schtasks.exe from cmd.exe, and would be available in a separate view.[CT9]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-7.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert on \\"Schtasks with create command\\" for schtasks.exe run from cmd.exe'}], 'Footnotes': ['For this alert, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a task being created that runs an executable (via rundll32) under system rights at Windows logon. The alert was tagged with the correct ATT&CK Tactics (Execution, Persistence, Privilege Escalation) and Technique (Scheduled Task).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-7.C.1-3.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe creating the "Resume Viewer Update Checker" scheduled task via schtasks.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-7.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a task being created that runs an executable (via rundll32) under system rights at Windows logon, tagged with the correct ATT&CK Tactics (Execution, Persistence, Privilege Escalation) and Technique (Scheduled Task)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe creating the "Resume Viewer Update Checker" scheduled task via schtasks.exe. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-7.C.1-3.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe creating the "Resume Viewer Update Checker" scheduled task via schtasks.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-7.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a task being created that runs an executable (via rundll32) under system rights at Windows logon, tagged with the correct ATT&CK Tactics (Execution, Persistence, Privilege Escalation) and Technique (Scheduled Task)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A delayed Specific Behavior alert was generated on a low-reputation DLL persisting through a scheduled task.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence'}, {'ScreenshotName': 'MS-7.C.1-2.png', 'ScreenshotCaption': 'Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe registering the "Resume Viewer Update Checker" scheduled task.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence'}, {'ScreenshotName': 'MS-7.C.1-2.png', 'ScreenshotCaption': 'Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a commonly abused host process scheduling a task. The alert was tainted by a parent process injection alert on cmd.exe.[PA4]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-4.png', 'ScreenshotCaption': 'Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)'}], 'Footnotes': ['Vendor stated the capability would have prevented the creation of the scheduled task.']}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the creation of a new scheduled task. The alert was tainted by a parent process injection alert on cmd.exe.[PA4]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-4.png', 'ScreenshotCaption': 'Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)'}], 'Footnotes': ['Vendor stated the capability would have prevented the creation of the scheduled task.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-4.png', 'ScreenshotCaption': 'Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed schtasks.exe creating the Resume Viewer Update Checker scheduled task as reboot persistence and as SYSTEM. The telemetry was tainted by a parent process injection alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing schtasks.exe creating the scheduled task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the creation of a new scheduled task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a commonly abused host process scheduling a task (tainted by a parent process injection alert on cmd.exe)'}, {'ScreenshotName': 'PA-7.C.1-4.png', 'ScreenshotCaption': 'Enrichment of schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of schtasks.exe as well as the full command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-07-2.png', 'ScreenshotCaption': 'Telemetry showing the schtask.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of schtasks.exe and associated command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-7.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing schtask.exe and associated command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '8.A.1', 'Procedure': 'Cobalt Strike: \'dir -s -b "\\\\conficker\\wormshare"\' via cmd', 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe with the correct ATT&CK Technique (T1083 - File and Directory Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing dir with command-line arguments'}, {'ScreenshotName': 'CB-8.C.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing dir with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing dir with command-line arguments'}, {'ScreenshotName': 'CB-8.C.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe running dir. The process tree view showed the cmd.exe process that ran dir as tainted by a prior detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe running dir with command-line arguments (search was on commands running within the past 10 minutes)'}, {'ScreenshotName': 'CS-8.A.1-2.png', 'ScreenshotCaption': 'Process tree view showing cmd.exe that ran dir (dir not specifically shown, cmd.exe is second from top and tainted by previous detection by orange line indicating medium severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing dir with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-8.A.1-10.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the dir with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing dir with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-8.A.1-10.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the dir with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched dir with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery). The enrichment was also tainted by a parent Malicious File Detection.[EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-08-1.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of dir with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within an event tree (tainted by a parent Malicious File Detection) showed cmd.exe executing dir with command-line arguments. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-08-1.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of dir with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing dir) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-8.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing dir)'}, {'ScreenshotName': 'CC-8.A.1-99.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.'}, {'ScreenshotName': 'CC-8.A.1-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-8.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing dir)'}, {'ScreenshotName': 'CC-8.A.1-99.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.'}, {'ScreenshotName': 'CC-8.A.1-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-8.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing dir)'}, {'ScreenshotName': 'CC-8.A.1-99.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the dir command indicating that the parameter was a directory listing of a network drive associated with potential reconnaissance.'}, {'ScreenshotName': 'CC-8.A.1-98.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running dir) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing dir with an alert for Dir Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-8.A.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing dir with Dir Command alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and, Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that svchost.exe created cmd.exe, which executed dir. The telemetry was tainted by the parent \\"Powershell process created\\" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing dir with command-line arguments (tainted by the parent \\"Powershell process created\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing the dir command with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing the dir command (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-8.A.2-5.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the dir command with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing the dir command. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing the dir command (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-8.A.2-5.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the dir command with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for cmd.exe executing dir with command-line arguments. The telemetry was tainted by a prior alert on rundll32.exe being executed without command-line arguments.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments'}, {'ScreenshotName': 'MS-8.A.1-2.png', 'ScreenshotCaption': 'Process tree view of rundll32.exe \\"Unexpected behavior from process run with no command-line arguments\\" alert that tainted dir (dir command not shown)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'A General Behavior alert was generated for a commonly abused process (cmd.exe) spawning out of rundll32.exe. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe executing dir with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-8.A.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd executing dir with command-line arguments as the execution of the dir command on a network location (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-8.A.1-4.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing dir with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing dir with command-line arguments as the execution of the dir command on a network location. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe executing dir with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-8.A.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd executing dir with command-line arguments as the execution of the dir command on a network location (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-8.A.1-4.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing dir with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing dir with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe executing dir with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-8.A.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd executing dir with command-line arguments as the execution of the dir command on a network location (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-8.A.1-4.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing dir with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing dir with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-08-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing dir with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing dir with command-line arguments. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-8.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing dir with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '8.A.2', 'Procedure': 'Cobalt Strike: \'tree "C:\\Users\\debbie"\' via cmd', 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched tree.com with the correct ATT&CK Technique (T1083 - File and Directory Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-8.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing tree.com with command-line arguments'}, {'ScreenshotName': 'CB-8.C.1-2.png', 'ScreenshotCaption': 'Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tree.com with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-8.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing tree.com with command-line arguments'}, {'ScreenshotName': 'CB-8.C.1-2.png', 'ScreenshotCaption': 'Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating tree.com was suspicious. The process tree view showed the alert as tainted by a previous cmd.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)'}, {'ScreenshotName': 'CS-8.A.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-8.A.2-2.png', 'ScreenshotCaption': 'Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was identified because tree was one of the reconnaissance commands performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)'}, {'ScreenshotName': 'CS-8.A.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-8.A.2-2.png', 'ScreenshotCaption': 'Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe running tree with command-line arguments. The process tree view also showed the cmd.exe that was the parent for tree.com as tainted by a prior detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-8.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe running tree with command-line arguments (search was on commands running within the past 10 minutes)'}, {'ScreenshotName': 'CS-8.A.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-8.A.2-2.png', 'ScreenshotCaption': 'Additional details for OverWatch General Behavior alert indicating tree.com was suspicious (tainted by previous detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-E-3.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating tree was a reconnaissance command (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing tree with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery). The data was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-8.A.1-20.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the tree with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tree with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-8.A.1-20.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing the tree with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched tree with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery). The enrichment was also tainted by a parent Malicious File Detection).[EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-08-1.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of tree with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within an event tree (tainted by a parent Malicious File Detection) showed cmd.exe executing tree with command-line arguments.[EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-08-1.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of tree with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery) (tainted by parent Malicious File Detection, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for rundll32.exe launching cmd.exe (executing tree) which was identified as extremely rare and suspicious.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-8.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing tree)'}, {'ScreenshotName': 'CC-8.A.2-2.png', 'ScreenshotCaption': 'Enrichment of tree.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-8.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-8.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing tree)'}, {'ScreenshotName': 'CC-8.A.2-2.png', 'ScreenshotCaption': 'Enrichment of tree.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-8.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing the tree command with a tag identifying the command as enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-8.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for rundll32.exe launching cmd.exe (executing tree)'}, {'ScreenshotName': 'CC-8.A.2-2.png', 'ScreenshotCaption': 'Enrichment of tree.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-8.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (cmd.exe running tree) has been tagged for monitoring because its parent process has a detection (rundll32.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': "The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker performed a directory listing of the contents of Debbie's user profile directory. [FE5]", 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-8.A.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)'}, {'ScreenshotName': 'FE-7.C.1-3.png', 'ScreenshotCaption': "Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)"}, {'ScreenshotName': 'FE-8.A.1-4.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report showing additional details about tree'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing tree with an alert for Tree Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-8.A.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)'}, {'ScreenshotName': 'FE-7.C.1-3.png', 'ScreenshotCaption': "Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)"}, {'ScreenshotName': 'FE-8.A.1-4.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report showing additional details about tree'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that svchost.exe created cmd.exe, which executed tree with command-line arguments. The telemetry was tainted by the parent \\"Powershell process created\\" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-8.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing tree with command-line arguments (tainted by the parent \\"Powershell process created\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing the tree.exe with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-8.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing tree.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-8.A.2-5.png', 'ScreenshotCaption': 'Enrichment of tree.exe with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tree.exe. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-8.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing tree.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-8.A.2-5.png', 'ScreenshotCaption': 'Enrichment of tree.exe with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for cmd.exe executing tree.com with command-line arguments. The telemetry was tainted by a prior alert on rundll32.exe being executed without command-line arguments.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-8.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments'}, {'ScreenshotName': 'MS-8.A.1-2.png', 'ScreenshotCaption': 'Process tree view of rundll32.exe \\"Unexpected behavior from process run with no command-line arguments\\" alert that tainted tree (tree command not shown)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-8.A.2-1.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe executing tree with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-8.A.2-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tree with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-8.A.2-1.png', 'ScreenshotCaption': 'Telemetry showed cmd.exe executing tree with command-line arguments (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}, {'ScreenshotName': 'PA-8.A.2-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tree with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-08-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing tree with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing tree with command-line arguments. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-8.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing tree with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '8.B.1', 'Procedure': "Cobalt Strike: 'ps' (Process status) via Win32 APIs", 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-8.B.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of a specific API call as process enumeration and suspicious activity (tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '8.C.1', 'Procedure': 'Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie', 'Techniques': [{'TechniqueId': 'T1056', 'TechniqueName': 'Input Capture', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CB2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': [' The vendor indicated that CB Defense sees applicable API calls, but that product was not included in the evaluation.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed explorer.exe injecting from a known beacon (does not detect input capture specifically).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-8.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability was available, though an alert was generated based on a chain of injections caused by process injection of powershell.exe to cmd.exe then explorer.exe.\xa0Data within the alert showed the\xa0loaded keyloggerx64.dll module, and additional data showed the memory address and size of the module within explorer.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-8.C.1-10.png', 'ScreenshotCaption': 'Alert for Chain of Injections for powershell.exe injecting into cmd.exe (does not count as detection)'}, {'ScreenshotName': 'CR-8.C.1-100.png', 'ScreenshotCaption': 'Alert for Chain of Injections showing powershell.exe injecting into explorer.exe (does not count as detection)'}, {'ScreenshotName': 'CR-8.C.1-11.png', 'ScreenshotCaption': 'Alert showing loaded keyloggerx64.dll module (does not count as detection)'}, {'ScreenshotName': 'CR-8.C.1-12.png', 'ScreenshotCaption': 'Alert showing keyloggerx64.dll module loaded into explorer.exe, including memory address and size (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though strings were pulled from a Process Injection alert, which identified functionality of code to indicate keylogging, but no proof of execution was identified.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-08-2.png', 'ScreenshotCaption': 'Event tree showing a Process Injection alert from which strings were pulled (does not count as a detection)'}, {'ScreenshotName': 'EG-08-4.png', 'ScreenshotCaption': 'Strings output extracted from Process Injection alert, showing key definitions typically associated with a keylogger, but no evidence of execution (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed a remote thread being created from cmd.exe in explorer.exe. The vendor noted that if a user determined the process creation was suspicious, the user could manually kick off a DDNA scan from the Command-Line Interface (CLI) view by using the Process ID (PID).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-8.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing remote thread being created into explorer.exe (does not count as a detection)'}, {'ScreenshotName': 'CT-8.C.1-2.png', 'ScreenshotCaption': 'Command-Line Interface view for host Nimda kicking off DDNA Scan for PID 11252 (does not count as a detection)'}, {'ScreenshotName': 'CT-8.C.1-3.png', 'ScreenshotCaption': 'DDNA JSON output from PID 11252 showing process capabilities (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though an alert indicated cmd.exe obtained a handle to the memory thread and injected code into explorer.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-8.C.1-3.png', 'ScreenshotCaption': 'Alert that cmd.exe obtained a handle to the memory thread and injected code into explorer.exe (does not count as detection)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A delayed Specific Behavior alert was generated on "Possible keylogging activity" against explorer.exe.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-8.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe reading user keystrokes'}, {'ScreenshotName': 'MS-8.C.1-1.png', 'ScreenshotCaption': 'Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)'}, {'ScreenshotName': 'MS-8.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"Possible keylogging activity\\" against explorer.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed events indicating "explorer.exe is reading user keystrokes."', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'MS-8.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe reading user keystrokes'}, {'ScreenshotName': 'MS-8.C.1-1.png', 'ScreenshotCaption': 'Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)'}, {'ScreenshotName': 'MS-8.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"Possible keylogging activity\\" against explorer.exe'}], 'Footnotes': ['The vendor stated that Input Capture telemetry is captured but it was not immediately visible in the user portal. The vendor made changes to the portal during the test to enable the visibility of these events.', 'Telemetry also showed cmd.exe injecting into explorer.exe to facilitate the keylogging, but this did not identify input capture specifically so was not counted as a detection.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of a specific API call as keylogging and suspicious activity. Though it does not count as a detection, the capability also showed code and hook injections into explorer.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-8.C.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of a specific API call as keylogging and suspicious activity'}, {'ScreenshotName': 'PA-8.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing code injection into explorer.exe (does not count as a detection)'}, {'ScreenshotName': 'PA-8.C.1-3.png', 'ScreenshotCaption': 'Telemetry showing hook injection from explorer.exe (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though a floating code "IIOC" module alerted with a elevated risk score for DLL injection. An analyst could explore the module and observe the keylogger aggressor script, but this only showed that there is a potential capability of a keylogger, not that execution occurred.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-08-2.png', 'ScreenshotCaption': 'Floating Code module output showing keylogger aggressor script (does not count as a detection)'}, {'ScreenshotName': 'RSA-08-3.png', 'ScreenshotCaption': 'Floating Code module output showing keylogger key definitions (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed GetAsyncKeyStateApi, which was indicative of keylogging. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).[SO3]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-8.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing GetAsyncKeyStateApi (Group ID tainted the event but was not shown in this view)'}, {'ScreenshotName': 'S1-8.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing process injection into explorer.exe (does not count as a detection)'}], 'Footnotes': [' Vendor stated log files indicate the powershell process was using the SSL cache folder.']}]}]}]}, {'Substep': '8.C.1', 'Procedure': 'Cobalt Strike: Keylogging capability included residual enumeration of application windows', 'Techniques': [{'TechniqueId': 'T1010', 'TechniqueName': 'Application Window Discovery', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '8.D.1', 'Procedure': 'Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie', 'Techniques': [{'TechniqueId': 'T1113', 'TechniqueName': 'Screen Capture', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though modloads showed the thumbnail com object masquerading followed by a modload of dwmapi.dll (Microsoft Desktop Windows Manager API) and then a crossprocess (open process) to the target application, which could be indicative of screen capture behavior.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-8.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing modloads and crossprocess events (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed explorer.exe injecting from a known beacon (does not detect screen capture specifically).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-8.D.1-2.png', 'ScreenshotCaption': 'Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890) (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability was available, though an alert was generated based on explorer.exe being flagged for loading a Meterpreter Agent. Data within a previous process injection alert showed the\xa0loaded screenshotx64.dll module.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-8.D.1-11.png', 'ScreenshotCaption': 'Alert for explorer.exe loading a Meterpreter agent (does not count as detection)'}, {'ScreenshotName': 'CR-8.D.1-10.png', 'ScreenshotCaption': 'Alert showing loaded screenshotx64.dll module (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though strings were pulled from a Process Injection alert, which identified functionality of code to indicate screen capture, but no proof of execution was identified.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-08-5.png', 'ScreenshotCaption': 'Strings output extracted from Process Injection alert, showing BitBlt and CreateCompatibleBitmap that could be associated with screen capture, but no evidence of execution (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed a remote thread being created from cmd.exe into explorer.exe. The vendor also noted that if a user determined the process creation was suspicious, the user could manually kick off a DDNA scan. DDNA results on this process reported "This module may capture screen shots," indicating the module has the capability to perform this.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-8.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing remote thread being created into explorer.exe (does not count as a detection)'}, {'ScreenshotName': 'CT-8.D.1-2.png', 'ScreenshotCaption': 'DDNA JSON output showing the process had the capability to capture screen shots (does not count as a detection; DDNA scan was manually initiated)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched an explorer.exe process with ScreenshotTaken.[MS31]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'MS-8.D.1-1.png', 'ScreenshotCaption': 'Enrichment of explorer.exe with ScreenshotTaken'}], 'Footnotes': ['The vendor stated that screen capture telemetry is captured but it was not immediately visible in the portal. The vendor made changes to the portal during the test to enable by default the visibility of these events, so this detection is identified as a configuration change.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of a specific API call as information gathering using screen capture and suspicious activity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-8.D.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of a specific API call using screen capture and suspicious activity'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though a floating code "IIOC" module alerted with a elevated risk score for DLL injection. An analyst could explore the module and observe multiple components related to jpegs, which may be related to screenshots, but does not show that execution occurred.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-08-4.png', 'ScreenshotCaption': 'Floating Code module generated from DLL injection showing multiple jpeg components (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '8.D.1', 'Procedure': 'Cobalt Strike: Screen capture capability involved process injection into explorer.exe', 'Techniques': [{'TechniqueId': 'T1055', 'TechniqueName': 'Process Injection', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a cross-process "open handle" event into explorer.exe, which could be indicative of process injection.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-8.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing \\"open handle\\" crossproc on explorer.exe by the process'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed InjectedThread events for explorer.exe (pid=21776848613) injecting from cmd.exe (pid=21898821890), which is a known beacon.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-8.D.1-2.png', 'ScreenshotCaption': 'Telemetry showing injected thread events (explorer.exe, pid=21776848613, injecting from cmd.exe, pid=21898821890)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated based on a malicious code injection caused by process injection of explorer.exe. The alert was mapped with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection) and indicated that explorer.exe was hosting injected threads and loading malicious files.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-8.D.1-21.png', 'ScreenshotCaption': 'Specific Behavior alert for process injection explorer.exe rolled into chain of injections'}, {'ScreenshotName': 'CR-8.D.1-20.png', 'ScreenshotCaption': 'Specific Behavior alert for Malicious code injection to explorer.exe with correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert for process injection was generated with cmd.exe as the source. The alert was tainted by parent Malicious File Detection and process injection alerts, and was also labeled with the correct ATT&CK Technique (T1055 - Process Injection) and Tactics (Defense Evasion and Execution).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-08-3.png', 'ScreenshotCaption': 'Event tree showing process injection Specific Behavior alert (last alert in the view, ID 2561310) (tainted by parent Malicious File Detection and process injection alerts and labeled with the correct ATT&CK Technique, Process Injection, and Tactics, Defense Evasion and Execution)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a remote thread being created from cmd.exe into explorer.exe, which could be indicative of process injection.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-8.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing remote thread being created into explorer.exe'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for code injection into explorer.exe. The alert was tagged with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection) and was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-8.D.1-9.png', 'ScreenshotCaption': 'Specific Behavior alert for code injection into explorer.exe, tagged with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection)'}, {'ScreenshotName': 'MC-8.D.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for code injection into explorer.exe (tainted by a trace detection on cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution sequence for cmd.exe injecting into explorer.exe with the label \\"Inject to process.\\"', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-8.D.1-2.png', 'ScreenshotCaption': 'Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\"Inject to process\\")'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe injecting into explorer.exe as code injection via CreateThread.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-8.D.1-2.png', 'ScreenshotCaption': 'Enrichment of cmd.exe injecting into explorer.exe as code injection via CreateThread'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though a floating code "IIOC" module alerted with a elevated risk score for DLL injection. There was no telemetry available for the processes that were injected to verify its relation this procedure.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-08-4.png', 'ScreenshotCaption': "Floating Code module generated from DLL injection showing introspection into the module's characteristics (does not count as a detection)"}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the sequence of events related to process injection from powershell.exe into explorer.exe. The capability associated the process with the highest threat to the event (powershell.exe) instead of cmd.exe (the expected source of the injection) because it had an alert associated with it previously. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-8.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe injecting into explorer.exe (Group ID tainted this event but was not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '9.A.1', 'Procedure': "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[PA2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '9.B.1', 'Procedure': 'Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)', 'Techniques': [{'TechniqueId': 'T1039', 'TechniqueName': 'Data from Network Shared Drive', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed connection between Nimda (10.0.1.6) and the source of the file, Conficker (10.0.0.5), over port 445.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-9.B.1-20.png', 'ScreenshotCaption': 'Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though file creation telemetry showed that the .vsdx file was created (no indication it was created from a shared drive).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-09-3.png', 'ScreenshotCaption': 'Telemetry showing .vsdx file creation, but no indication of network shared drive (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[MS32]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['The vendor stated that by default WDATP monitored activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of the evaluation. Subsequently, the vendor made changes to enable the visibility of .vsdx events by default, which is now available in WDATP.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file read event for the .vsdx file from the network shared drive.[PA2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-9.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a file read event for the .vsdx file from the network shared drive'}], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed remote file access behavior for the .vsdx file from the network shared drive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-9.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing .vsdx file access from WormShare on the network shared drive'}], 'Footnotes': []}]}]}]}, {'Substep': '9.B.1', 'Procedure': 'Cobalt Strike: Download capability exfiltrated data through existing C2 channel', 'Techniques': [{'TechniqueId': 'T1041', 'TechniqueName': 'Exfiltration Over Command and Control Channel', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed connection between Nimda (10.0.1.6) and the source of the file, Conficker (10.0.0.5), over port 445.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-9.B.1-20.png', 'ScreenshotCaption': 'Telemetry showing a port 445 connection between Nimda (10.0.1.6) and the source of the file on Conficker (10.0.0.5) (does not count as detection)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though DNS requests for freegoogleadsenseinfo.com (C2 domain) were observed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-9.B.1-1.png', 'ScreenshotCaption': 'DNS requests to freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though port 53 network traffic to/from freegoogleadsenseinfo.com (C2 domain) was observed.[PA2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-9.B.1-2.png', 'ScreenshotCaption': 'Port 53 network traffic to/from freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)'}], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '10.A.1', 'Procedure': 'Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32', 'Techniques': [{'TechniqueId': 'T1060', 'TechniqueName': 'Registry Run Keys / Startup Folder', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed cmd.exe executing autoupdate.bat from the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-10.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing cmd.exe executing autoupdate.bat from Startup folder'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe running autoupdate.bat from the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-10.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe running autoupdate.bat from Startup folder'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing autoupdate.bat from the Startup folder. The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-10.A.1-100.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing autoupdate.bat from the Startup folder (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-10.A.1-10.png', 'ScreenshotCaption': 'Parent alert for Injected shellcode into rundll32.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the process chain for rundll32.exe execution of update.dat. The telemetry was tainted by the parent alert for \\"RunDLL32 with Suspicious DLL Location.\\"', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-10-5.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by parent \\"RunDLL32 with Suspicious DLL Location\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a batch file automatically being started from the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-10.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a batch file automatically being started from the Startup folder.'}, {'ScreenshotName': 'CC-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-10.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a batch file automatically being started from the Startup folder.'}, {'ScreenshotName': 'CC-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that autoupdate.bat persisted due to its presence in the startup directory. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-10.A.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)'}, {'ScreenshotName': 'FE-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.bat from Startup folder'}, {'ScreenshotName': 'FE-10.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)'}, {'ScreenshotName': 'FE-10.A.1-4.png', 'ScreenshotCaption': 'Additional details of rundll32.exe telemetry'}, {'ScreenshotName': 'FE-10.A.1-5.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe executing a file from Startup with an alert for Process Execution Startup. The alert was also tagged with the correct ATT&CK Technique (T1060 - Registry Run Keys / Startup Folder) and Tactic (Persistence).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-10.A.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)'}, {'ScreenshotName': 'FE-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.bat from Startup folder'}, {'ScreenshotName': 'FE-10.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)'}, {'ScreenshotName': 'FE-10.A.1-4.png', 'ScreenshotCaption': 'Additional details of rundll32.exe telemetry'}, {'ScreenshotName': 'FE-10.A.1-5.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-10.A.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)'}, {'ScreenshotName': 'FE-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.bat from Startup folder'}, {'ScreenshotName': 'FE-10.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)'}, {'ScreenshotName': 'FE-10.A.1-4.png', 'ScreenshotCaption': 'Additional details of rundll32.exe telemetry'}, {'ScreenshotName': 'FE-10.A.1-5.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing update.dll with command-line arguments. The telemetry was tainted by the parent alert for Rundll32 Execution (Weak Signal).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-10.A.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)'}, {'ScreenshotName': 'FE-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.bat from Startup folder'}, {'ScreenshotName': 'FE-10.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)'}, {'ScreenshotName': 'FE-10.A.1-4.png', 'ScreenshotCaption': 'Additional details of rundll32.exe telemetry'}, {'ScreenshotName': 'FE-10.A.1-5.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe starting rundll32.exe, which started update.dat, as well as cmd.exe executing autoupdate.bat from the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe starting rundll32.exe'}, {'ScreenshotName': 'CT-10.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe creating cmd.exe and executing .bat from startup'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder, then update.dat via rundll32.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-10.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.bat then update.dat via rundll32.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence of cmd.exe executing autoupdate.bat from the Startup folder to start update.dat.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-10.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing Startup folder execution sequence for autoupdate.bat on user logon'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-10.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.bat from the Startup folder'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-10-1.png', 'ScreenshotCaption': 'Telemetry showing the execution of autoupdate.bat from the Startup Folder'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of autoupdate.bat from the Startup folder for persistence. The telemetry was associated to a new story (Group ID) but was not marked as malicious or tainted because it is not associated with an alert.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution of autoupdate.bat from the Startup folder'}, {'ScreenshotName': 'S1-10.A.1-3.png', 'ScreenshotCaption': 'Group ID query showing both autoupdate.bat and updater.dll persistence execution'}], 'Footnotes': []}]}]}]}, {'Substep': '10.A.2', 'Procedure': 'Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32', 'Techniques': [{'TechniqueId': 'T1053', 'TechniqueName': 'Scheduled Task', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\"-k netsvcs -p -s Schedule\\".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-10.A.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing svchost.exe parent of rundll32.exe process running with \\"-k netsvcs -p -s Schedule\\" arguments'}, {'ScreenshotName': 'CB-10.A.2-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing updater.dll executed by rundll32.exe'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe starting updater.dll. The telemetry was tainted by the parent OverWatch alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-10.A.2-2.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll (tainted by the parent OverWatch alert)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing update.dat with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-10.A.2-100.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing update.dat (tainted by a parent Injected Shellcode alert)'}, {'ScreenshotName': 'CR-10.A.1-20.png', 'ScreenshotCaption': 'Parent alert for Injected shellcode into rundll32.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the event tree showed rundll32.exe executing updater.dll. The telemetry was tainted by a Malicious File Detection alert for updater.dll and a Process Injection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-10-1.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll (tainted by Malicious File Detection alert)'}, {'ScreenshotName': 'EG-10-2.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll (tainted by Process Injection alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing updater.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-10.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing rundll32 starting updater.dll, tainted by an "abnormal rundll32 launch" alert'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified the Resume Viewer Update Checker scheduled task executing updater.dll with rundll32.exe. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-10.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll'}, {'ScreenshotName': 'FE-10.A.2-2.png', 'ScreenshotCaption': 'Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)'}, {'ScreenshotName': 'FE-10.A.2-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe executing rundll32.exe, which executed updater.dll. The telemetry was tainted by the parent Rundll32 Execution alert, which was tagged with a related ATT&CK Technique (T1085 - Rundll32) and Tactic (Defense Evasion, Execution), but did not include information on the use of a Scheduled Task specifically.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-10.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll'}, {'ScreenshotName': 'FE-10.A.2-2.png', 'ScreenshotCaption': 'Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)'}, {'ScreenshotName': 'FE-10.A.2-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe executing rundll32.exe, which executed updater.dll. The telemetry was tainted by the parent \\"Sponsor process started V2\\" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-10.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe executing rundll32.exe (tainted by parent \\"Sponsor process started V2\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments "-k netsvcs -p -s Schedule".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-10.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments "-k netsvcs -p -s Schedule"'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\"-k netsvcs -p -s Schedule\\".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-10.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence for svchost.exe parent of rundll32.exe process running with \\"-k netsvcs -p -s Schedule\\" arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments "-k netsvcs -p -s Schedule".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-10.A.2-3.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe running with command-line arguments "-k netsvcs -p -s Schedule"'}, {'ScreenshotName': 'PA-10.A.2-4.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing updater.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-10-2.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing updater.dll as part of the scheduled task persistence. The telemetry was associated with the execution of autoupdate.bat for persistence because it was associated with the same story (Group ID) but is not marked as malicious or tainted because it is not associated with an alert.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-10.A.1-3.png', 'ScreenshotCaption': 'Group ID query showing both autoupdate.bat and updater.dll persistence execution'}, {'ScreenshotName': 'S1-10.A.2-2.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing updater.dll'}], 'Footnotes': []}]}]}]}, {'Substep': '10.B.1', 'Procedure': 'RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse', 'Techniques': [{'TechniqueId': 'T1078', 'TechniqueName': 'Valid Accounts', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched rdpclip.exe with the correct ATT&CK Technique (Remote Desktop Protocol).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing rdpclip.exe running as user Jesse'}, {'ScreenshotName': 'CB-10.B.1-2.png', 'ScreenshotCaption': 'Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed rdpclip.exe execution by the user Jesse on the destination system of the RDP connection.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing rdpclip.exe running as user Jesse'}, {'ScreenshotName': 'CB-10.B.1-2.png', 'ScreenshotCaption': 'Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a type 10 (interactive) UserLogon event for Jesse.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing user logon by Jesse to Conficker'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the logon session for Jesse to Conficker (10.0.0.5) as a Remote Interactive Logon Type.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-10.B.1-10.png', 'ScreenshotCaption': 'Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that the userinit.exe process was running as the user Jesse, indicating Jesse logged in. The telemetry was tainted by the parent \\"Start Folder Persistence\\" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-10-3.png', 'ScreenshotCaption': 'Telemetry showing userinit.exe running as Jesse (tainted by parent \\"Start Folder Persistence\\" alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a remote interactive logon event for the account Jesse logging on to Conficker (10.0.0.5) over port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-10.B.1-T1076-new.png', 'ScreenshotCaption': 'Telemetry showing a RemoteInteractive connection as Jesse over port 3389 to Conficker (10.0.0.5)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that the account Jesse was used to log in to Conficker as part of Lateral Movement.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-10.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker'}, {'ScreenshotName': 'FE-10.B.1-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Logon Type 10 (interactive) event for the account Jesse logging on to Conficker.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-10.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker'}, {'ScreenshotName': 'FE-10.B.1-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that the explorer.exe process was running as the user Jesse, indicating the account exists.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe running as Jesse'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a remote interactive logon for Jesse to Conficker (10.0.0.5).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the new local user account Jesse logging into Conficker.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing local user account Jesse first and last seen logons on Conficker'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed userinit.exe as well as explorer.exe spawn as the user Jesse.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing userinit.exe as well as explorer.exe spawn as the user Jesse'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed \\"unregmp2.exe /FirstLogon\\" (associated with user logon) as well as the user name \\"Jesse J\\" within Machine Properties.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-10-3.png', 'ScreenshotCaption': 'Telemetry showing \\"unregmp2.exe /FirstLogon\\" (associated with user logon)'}, {'ScreenshotName': 'RSA-10-4.png', 'ScreenshotCaption': 'Telemetry showing user name \\"Jesse J\\" within Machine Properties'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the Jesse account had logged into the system.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-10.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing last logged on user identified as Jesse'}], 'Footnotes': []}]}]}]}, {'Substep': '10.B.1', 'Procedure': 'RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism', 'Techniques': [{'TechniqueId': 'T1076', 'TechniqueName': 'Remote Desktop Protocol', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched rdpclip.exe with the correct ATT&CK Technique (Remote Desktop Protocol).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing rdpclip.exe running as user Jesse'}, {'ScreenshotName': 'CB-10.B.1-2.png', 'ScreenshotCaption': 'Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed rdpclip.exe execution by the user Jesse on the destination system of the RDP connection.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing rdpclip.exe running as user Jesse'}, {'ScreenshotName': 'CB-10.B.1-2.png', 'ScreenshotCaption': 'Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior occurred because they observed suspicious communications over 3389 (RDP) to other hosts.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-1.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)'}, {'ScreenshotName': 'CS-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing user logon by Jesse to Conficker with type 10 (interactive logon)'}, {'ScreenshotName': 'CS-10.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing logged-on user activity, including the use of rdpclip.exe'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the remote connection to Conficker for a user logon by Jesse with type 10 (interactive) as well as the use of rdpclip.exe by the logged-on user.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-E-1.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating suspicious communications over 3389 (RDP) were observed (General Behavior)'}, {'ScreenshotName': 'CS-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing user logon by Jesse to Conficker with type 10 (interactive logon)'}, {'ScreenshotName': 'CS-10.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing logged-on user activity, including the use of rdpclip.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the logon session for Jesse to Conficker (10.0.0.5) as a Remote Interactive Logon Type. Telemetry also showed a connection over port 3389 to Conficker (10.0.0.5) through rundll32.exe serving as a proxy. The telemetry was tainted by a parent Injected Shellcode alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-10.B.1-10.png', 'ScreenshotCaption': 'Telemetry of logon session for Jesse from Nimda (10.0.1.6) to Conficker (10.0.0.5) with Remote Interactive Logon Type'}, {'ScreenshotName': 'CR-10.B.1-20.png', 'ScreenshotCaption': 'Telemetry showing a TCP port 3389 connection to Conficker (10.0.0.5)'}, {'ScreenshotName': 'CR-10.B.1-100.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe process used to proxy connection over port 3389 from Nimda (10.0.1.6) to Conficker (10.0.0.5) (tainted by a parent Injected Shellcode alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Type 10 logon event (corresponding to interactive) for Jesse as well remote connections over port 3389 to 10.0.0.5 (Conficker).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-10-6.png', 'ScreenshotCaption': 'Telemetry showing Type 10 (interactive) logon for Jesse'}, {'ScreenshotName': 'EG-10-7.png', 'ScreenshotCaption': 'Telemetry showing remote connections over port 3389 to 10.0.0.5 (Conficker)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a remote interactive logon event for the account Jesse logging on to Conficker (10.0.0.5) over port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-10.B.1-T1076-new.png', 'ScreenshotCaption': 'Telemetry showing a RemoteInteractive connection over port 3389 to Conficker (10.0.0.5)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified the user account Jesse logged on to Conficker via Remote Desktop Protocol. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-10.B.1-1.png', 'ScreenshotCaption': 'Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-10.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker'}, {'ScreenshotName': 'FE-10.B.1-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a TCP port 3389 connection to 10.0.0.5 (Conficker) with the alert RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-10.B.1-1.png', 'ScreenshotCaption': 'Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-10.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker'}, {'ScreenshotName': 'FE-10.B.1-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Logon Type 10 (interactive) event for the account Jesse logging on to Conficker.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-10.B.1-1.png', 'ScreenshotCaption': 'Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-10.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker'}, {'ScreenshotName': 'FE-10.B.1-3.png', 'ScreenshotCaption': 'Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a TCP port 3389 (RDP) connection to 10.0.0.5 (Conficker) with the conditions Lateral Movement and Remote Share Access. One connection event was tainted by the parent \\"Windows command prompt invoked\\" alert. [CT19]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-10.B.1-2.png', 'ScreenshotCaption': 'Enrichment of TCP port 3389 (RDP) connection to 10.0.0.5 (Conficker) with conditions Lateral Movement and Remote Share Access (tainted by the parent \\"Windows command prompt invoked\\" alert)'}], 'Footnotes': ["The conditions contributing to Enrichment were added to the capability's detection after the start of the evaluation, so this detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the rundll32.exe that made the network connection with the correct ATT&CK Tactic (Lateral Movement) and Technique (Remote Desktop Protocol).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)'}, {'ScreenshotName': 'MC-10.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing a connection over port 3389 to Conficker (10.0.0.5) (tainted by parent alert on rundll32.exe)'}, {'ScreenshotName': 'MC-10.A.1-1.png', 'ScreenshotCaption': 'Enrichment of the rundll32.exe that made the network connection with the correct ATT&CK Tactic (Lateral Movement) and Technique (Remote Desktop Protocol)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a remote interactive logon for Jesse to Conficker (10.0.0.5) as well as a connection to 10.0.0.5 (Conficker) over port 3389 from rundll32.exe. The telemetry was tainted by a trace detection on rundll32.exe', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a remote interactive logon for Jesse to Conficker (10.0.0.5)'}, {'ScreenshotName': 'MC-10.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing a connection over port 3389 to Conficker (10.0.0.5) (tainted by parent alert on rundll32.exe)'}, {'ScreenshotName': 'MC-10.A.1-1.png', 'ScreenshotCaption': 'Enrichment of the rundll32.exe that made the network connection with the correct ATT&CK Tactic (Lateral Movement) and Technique (Remote Desktop Protocol)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed\xa0a successful connection to Conficker (10.0.0.5) over port 3389 from rundll32.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-10.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing successful port 3389 connection to Conficker (10.0.0.5)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-10.B.1-2.png', 'ScreenshotCaption': 'Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389'}, {'ScreenshotName': 'PA-10.B.1-3.png', 'ScreenshotCaption': 'Enrichment of the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-10.B.1-2.png', 'ScreenshotCaption': 'Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389'}, {'ScreenshotName': 'PA-10.B.1-3.png', 'ScreenshotCaption': 'Enrichment of the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from Nimda showed a TCP port 3389 connection from 10.0.1.6 (Nimda) to 10.0.0.5 (Conficker). The rundll32.exe process (PID 184) that was used to load updater.dll was used to proxy the RDP connection to Conficker. The telemetry was tainted by the activity generated during the privilege escalation step because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-10.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing connection over port 3389 to 10.0.0.5 (Conficker)'}, {'ScreenshotName': 'S1-10.B.1-2.png', 'ScreenshotCaption': 'Threat group identified as malicious, including rundll32.exe (PID 184) proxying the port 3389 connection (port 3389 connection not specifically shown in this view, but it identifies the rundll32.exe process tainting the connection by Group ID)'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.1', 'Procedure': 'Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)', 'Techniques': [{'TechniqueId': 'T1064', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior Alert was generated indicating that powershell.exe was a suspicious child process of wscript.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)'}, {'ScreenshotName': 'CB-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree of script execution'}, {'ScreenshotName': 'CB-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alerts for Powershell scripting'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated indicating that powershell.exe was executed with encoded command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)'}, {'ScreenshotName': 'CB-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree of script execution'}, {'ScreenshotName': 'CB-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alerts for Powershell scripting'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched wscript.exe and powershell.exe with the correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)'}, {'ScreenshotName': 'CB-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree of script execution'}, {'ScreenshotName': 'CB-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alerts for Powershell scripting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry of a process tree showed powershell.exe execution, including full command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)'}, {'ScreenshotName': 'CB-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree of script execution'}, {'ScreenshotName': 'CB-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alerts for Powershell scripting'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated indicating "A PowerShell script launched that shares characteristics with known PowerShell exploit kits."', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-11.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell sharing characteristics with known exploit kits'}, {'ScreenshotName': 'CS-11.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a Specific Behavior was observed because a malicious script invoked by wscript was run by Bob on CodeRed and launched PowerShell.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-11.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell sharing characteristics with known exploit kits'}, {'ScreenshotName': 'CS-11.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated from OverWatch indicating wscript.exe executing launcher.vbs was suspicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-11.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell sharing characteristics with known exploit kits'}, {'ScreenshotName': 'CS-11.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the OverWatch alert showed wscript.exe executing launcher.vbs, and would be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-11.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell sharing characteristics with known exploit kits'}, {'ScreenshotName': 'CS-11.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert from OverWatch for wscript.exe executing launcher.vbs was suspicious'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating a malicious script was run (Specific Behavior)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for powershell.exe, labeled with Command and Control as well as Malicious use of PowerShell. The alert was tagged as a Obfuscated PowerShell payload and mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-11.A.1-14.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe, labeled with Command and Control and Malicious use of PowerShell'}, {'ScreenshotName': 'CR-11.A.1-11.png', 'ScreenshotCaption': 'Specific Behavior alert tagged as obfuscated PowerShell payload and downloader mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)'}, {'ScreenshotName': 'CR-11.A.1-13.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-11.A.1-12.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe execution, including decoded full command-line arguments, as well as wscript.exe executing autoupdate.vbs.\xa0The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-11.A.1-14.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe, labeled with Command and Control and Malicious use of PowerShell'}, {'ScreenshotName': 'CR-11.A.1-11.png', 'ScreenshotCaption': 'Specific Behavior alert tagged as obfuscated PowerShell payload and downloader mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)'}, {'ScreenshotName': 'CR-11.A.1-13.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-11.A.1-12.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for "Windows Script Executing PowerShell" due to wscript.exe launching powershell.exe. The alert was mapped to the correct ATT&CK Technique (T1064 - Scripting) and Tactic (Execution).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-11-1.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe also showing telemetry for script execution  (mapped to related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)'}, {'ScreenshotName': 'EG-11-7.png', 'ScreenshotCaption': 'Specific Behavior alert for wscript.exe launching powershell.exe (mapped to the correct ATT&CK Technique, T1064 - Scripting, and Tactic, Execution)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated indicating that powershell.exe ran with unusual arguments due to the -enc and -noP command-line arguments. The alert was mapped to a related ATT&CK Technique (T1086 - PowerShell) and the correct Tactic (Execution).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-11-1.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe also showing telemetry for script execution  (mapped to related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)'}, {'ScreenshotName': 'EG-11-7.png', 'ScreenshotCaption': 'Specific Behavior alert for wscript.exe launching powershell.exe (mapped to the correct ATT&CK Technique, T1064 - Scripting, and Tactic, Execution)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the process events associated with wscript.exe executing the autoupdate.vbs script (tainted by parent alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-11-1.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe also showing telemetry for script execution  (mapped to related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)'}, {'ScreenshotName': 'EG-11-7.png', 'ScreenshotCaption': 'Specific Behavior alert for wscript.exe launching powershell.exe (mapped to the correct ATT&CK Technique, T1064 - Scripting, and Tactic, Execution)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell executing a long, encoded command.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-11.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe'}, {'ScreenshotName': 'CC-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code'}, {'ScreenshotName': 'CC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell executing a long, encoded command'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched wscript.exe executing powershell.exe with a tag indicating that wscript executed code.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-11.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe'}, {'ScreenshotName': 'CC-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code'}, {'ScreenshotName': 'CC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell executing a long, encoded command'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wscript.exe executing autoupdate.vbs and subsequently powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-11.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs and subsequently powershell.exe'}, {'ScreenshotName': 'CC-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe executing powershell.exe with a tag indicating that wscript executed code'}, {'ScreenshotName': 'CC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell executing a long, encoded command'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for Suspicious PowerShell Usage (Methodology) indicating powershell.exe ran with unusual arguments due to the -enc and -noP command-line arguments. The alert was mapped to a related ATT&CK Technique (T1086 - PowerShell) and the correct Tactic (Execution) and captured the encoded command.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-11.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)'}, {'ScreenshotName': 'FE-11.A.1-3.png', 'ScreenshotCaption': 'Additional details on Specific Behavior alert for Suspicious PowerShell Usage'}, {'ScreenshotName': 'FE-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)'}, {'ScreenshotName': 'FE-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched wscript.exe with an alert for Wscript Execution (Weak Signal). The alert was tagged with the correct ATT&CK Technique (T1064 - Scripting) and Tactic (Execution).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-11.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)'}, {'ScreenshotName': 'FE-11.A.1-3.png', 'ScreenshotCaption': 'Additional details on Specific Behavior alert for Suspicious PowerShell Usage'}, {'ScreenshotName': 'FE-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)'}, {'ScreenshotName': 'FE-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)'}], 'Footnotes': []}, {'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated for EMPIRE RAT (Backdoor) based on a detected string specific to the backdoor. The alert was also mapped to a related ATT&CK Technique (T1086 - PowerShell).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-11.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)'}, {'ScreenshotName': 'FE-11.A.1-3.png', 'ScreenshotCaption': 'Additional details on Specific Behavior alert for Suspicious PowerShell Usage'}, {'ScreenshotName': 'FE-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)'}, {'ScreenshotName': 'FE-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wscript.exe executing autoupdate.vbs and that wscript.exe created a powershell.exe process, including the encoded command-line arguments (tainted by the parent Script File Created alert).[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing script execution (tainted by the parent Script File Created alert)'}, {'ScreenshotName': 'CT-11.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creation from wscript.exe (tainted by the parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for decoding and running encoded scripting sources from another process (wscript.exe). The alert was tagged with correct ATT&CK Tactic (Defense Evasion, Execution) and Techniques (PowerShell).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts and enrichments for wcript.exe and powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell commands being executed from another process (wscript.exe). The alert was tagged with correct ATT&CK Tactic (Execution) and Techniques (PowerShell).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts and enrichments for wcript.exe and powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell execution with a very long command line. The alert was tagged with correct ATT&CK Tactics (Defense Evasion, Execution) and Techniques (Scripting, PowerShell).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts and enrichments for wcript.exe and powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the VBScript interpreter launching a suspicious PowerShell process. The alert was tagged with the correct ATT&CK Tactics (Defense Evasion, Execution) and Techniques (Scripting, PowerShell).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts and enrichments for wcript.exe and powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe with the correct ATT&CK Tactic (Execution) and Techniques (PowerShell) and a suspicious indicator that a PowerShell command was executed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts and enrichments for wcript.exe and powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched wscript.exe with the correct ATT&CK Tactics (Defense Evasion, Execution) and Techniques (Scripting, PowerShell) and a suspicious indicator that the VBScript interpreter was executed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts and enrichments for wcript.exe and powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wscript.exe (executing autoupdate.vbs) then spawning powershell.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe (executing autoupdate.vbs) then spawning powershell.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alerts and enrichments for wcript.exe and powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A delayed Specific Behavior alert was generated for suspicious PowerShell command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of autoupdate.vbs script'}, {'ScreenshotName': 'MS-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution of wscript.exe'}, {'ScreenshotName': 'MS-11.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing execution of PowerShell cmdlets from wscript.exe'}, {'ScreenshotName': 'MS-11.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing PowerShell script metadata and decoded command-line arguments'}, {'ScreenshotName': 'MS-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"Suspicious PowerShell command-line\\"'}, {'ScreenshotName': 'MS-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"PowerShell script with suspicious content\\" detected through Antimalware Scan Interface extracted content'}, {'ScreenshotName': 'MS-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell script with malicious cmdlets'}, {'ScreenshotName': 'MS-11.A.1-8.png', 'ScreenshotCaption': 'Process tree of alert showing containing malicious PowerShell cmdlets related to Empire'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell script with malicious cmdlets related to Empire.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of autoupdate.vbs script'}, {'ScreenshotName': 'MS-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution of wscript.exe'}, {'ScreenshotName': 'MS-11.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing execution of PowerShell cmdlets from wscript.exe'}, {'ScreenshotName': 'MS-11.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing PowerShell script metadata and decoded command-line arguments'}, {'ScreenshotName': 'MS-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"Suspicious PowerShell command-line\\"'}, {'ScreenshotName': 'MS-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"PowerShell script with suspicious content\\" detected through Antimalware Scan Interface extracted content'}, {'ScreenshotName': 'MS-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell script with malicious cmdlets'}, {'ScreenshotName': 'MS-11.A.1-8.png', 'ScreenshotCaption': 'Process tree of alert showing containing malicious PowerShell cmdlets related to Empire'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell script with suspicious content detected through Antimalware Scan Interface extracted content.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of autoupdate.vbs script'}, {'ScreenshotName': 'MS-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution of wscript.exe'}, {'ScreenshotName': 'MS-11.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing execution of PowerShell cmdlets from wscript.exe'}, {'ScreenshotName': 'MS-11.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing PowerShell script metadata and decoded command-line arguments'}, {'ScreenshotName': 'MS-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"Suspicious PowerShell command-line\\"'}, {'ScreenshotName': 'MS-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"PowerShell script with suspicious content\\" detected through Antimalware Scan Interface extracted content'}, {'ScreenshotName': 'MS-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell script with malicious cmdlets'}, {'ScreenshotName': 'MS-11.A.1-8.png', 'ScreenshotCaption': 'Process tree of alert showing containing malicious PowerShell cmdlets related to Empire'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe running autoupdate.vbs through wscript.exe and subsequent execution of PowerShell script and cmdlets.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of autoupdate.vbs script'}, {'ScreenshotName': 'MS-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution of wscript.exe'}, {'ScreenshotName': 'MS-11.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing execution of PowerShell cmdlets from wscript.exe'}, {'ScreenshotName': 'MS-11.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing PowerShell script metadata and decoded command-line arguments'}, {'ScreenshotName': 'MS-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"Suspicious PowerShell command-line\\"'}, {'ScreenshotName': 'MS-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"PowerShell script with suspicious content\\" detected through Antimalware Scan Interface extracted content'}, {'ScreenshotName': 'MS-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell script with malicious cmdlets'}, {'ScreenshotName': 'MS-11.A.1-8.png', 'ScreenshotCaption': 'Process tree of alert showing containing malicious PowerShell cmdlets related to Empire'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell execution. The alert was tagged with a related Technique (PowerShell)', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)'}, {'ScreenshotName': 'PA-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)'}, {'ScreenshotName': 'PA-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for suspicious PowerShell activity'}, {'ScreenshotName': 'PA-11.A.1-8.png', 'ScreenshotCaption': 'Indicator of Compromise alerts for suspicious PowerShell strings'}, {'ScreenshotName': 'PA-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying PowerShell Empire'}, {'ScreenshotName': 'PA-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands'}, {'ScreenshotName': 'PA-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell execution with base64 encoded commands.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)'}, {'ScreenshotName': 'PA-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)'}, {'ScreenshotName': 'PA-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for suspicious PowerShell activity'}, {'ScreenshotName': 'PA-11.A.1-8.png', 'ScreenshotCaption': 'Indicator of Compromise alerts for suspicious PowerShell strings'}, {'ScreenshotName': 'PA-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying PowerShell Empire'}, {'ScreenshotName': 'PA-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands'}, {'ScreenshotName': 'PA-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for suspicious PowerShell activity', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)'}, {'ScreenshotName': 'PA-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)'}, {'ScreenshotName': 'PA-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for suspicious PowerShell activity'}, {'ScreenshotName': 'PA-11.A.1-8.png', 'ScreenshotCaption': 'Indicator of Compromise alerts for suspicious PowerShell strings'}, {'ScreenshotName': 'PA-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying PowerShell Empire'}, {'ScreenshotName': 'PA-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands'}, {'ScreenshotName': 'PA-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the execution of the windows script engine The alert was tagged with the correct ATT&CK Technique (Scripting).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)'}, {'ScreenshotName': 'PA-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)'}, {'ScreenshotName': 'PA-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for suspicious PowerShell activity'}, {'ScreenshotName': 'PA-11.A.1-8.png', 'ScreenshotCaption': 'Indicator of Compromise alerts for suspicious PowerShell strings'}, {'ScreenshotName': 'PA-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying PowerShell Empire'}, {'ScreenshotName': 'PA-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands'}, {'ScreenshotName': 'PA-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying PowerShell Empire.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)'}, {'ScreenshotName': 'PA-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)'}, {'ScreenshotName': 'PA-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for suspicious PowerShell activity'}, {'ScreenshotName': 'PA-11.A.1-8.png', 'ScreenshotCaption': 'Indicator of Compromise alerts for suspicious PowerShell strings'}, {'ScreenshotName': 'PA-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying PowerShell Empire'}, {'ScreenshotName': 'PA-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands'}, {'ScreenshotName': 'PA-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'Indicator of Compromise alerts were generated for suspicious PowerShell strings.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)'}, {'ScreenshotName': 'PA-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)'}, {'ScreenshotName': 'PA-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for suspicious PowerShell activity'}, {'ScreenshotName': 'PA-11.A.1-8.png', 'ScreenshotCaption': 'Indicator of Compromise alerts for suspicious PowerShell strings'}, {'ScreenshotName': 'PA-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying PowerShell Empire'}, {'ScreenshotName': 'PA-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands'}, {'ScreenshotName': 'PA-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wscript.exe executing autoupdate.vbs as well as the resulting powershell.exe execution. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for execution of the windows script engine tagged with the correct ATT&CK Technique (Scripting)'}, {'ScreenshotName': 'PA-11.A.1-6.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell (execution) tagged with a related Technique (PowerShell)'}, {'ScreenshotName': 'PA-11.A.1-7.png', 'ScreenshotCaption': 'Specific Behavior alert for suspicious PowerShell activity'}, {'ScreenshotName': 'PA-11.A.1-8.png', 'ScreenshotCaption': 'Indicator of Compromise alerts for suspicious PowerShell strings'}, {'ScreenshotName': 'PA-11.A.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying PowerShell Empire'}, {'ScreenshotName': 'PA-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands'}, {'ScreenshotName': 'PA-11.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wscript.exe executing autoupdate.vbs and the subsequent PowerShell child process. [RS1]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-11-1.png', 'ScreenshotCaption': 'Telemetry showing the autoupdate.vbs script executed by wscript.exe'}], 'Footnotes': [' Vendor says launch command-line argument truncation resulted in PowerShell not being able to be decoded.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for the execution of autoupdate.vbs that was listed as an active threat.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe and powershell.exe'}, {'ScreenshotName': 'S1-11.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for execution of autoupdate.vbs listed as an active threat'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wscript.exe executing autoupdate.vbs which then executed powershell.exe with an encoded PowerShell script.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-11.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe and powershell.exe'}, {'ScreenshotName': 'S1-11.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for execution of autoupdate.vbs listed as an active threat'}], 'Footnotes': []}]}]}]}, {'Substep': '11.B.1', 'Procedure': 'Empire: C2 channel established using port 443', 'Techniques': [{'TechniqueId': 'T1043', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched backgroundtaskhost.exe and powershell.exe with the correct ATT&CK Technique (T1043 - Commonly Used Port).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)'}, {'ScreenshotName': 'CB-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing network connections, including over TCP port 443'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connections, including over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-11.A.1-1.png', 'ScreenshotCaption': 'Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)'}, {'ScreenshotName': 'CB-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing network connections, including over TCP port 443'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making connection to 192.168.0.5 (C2 server) over port 443. The telemetry was tainted by an alert on its parent powershell.exe process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making a network connection over port 443 (tainted by parent powershell.exe high severity alert indicated by red icon)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe as making a connection over a ”HTTP Port”. The data was tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) and was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-11.A.1-13.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-11.B.1-100.png', 'ScreenshotCaption': 'Enrichment of powershell.exe making a connection over a ”HTTP Port," tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-11.B.1-11.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 (C2 Server) over port TCP port 443 (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an outgoing connection on TCP port 443 to 192.168.0.5 (C2 Server). Telemetry also showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain) over port 443. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-11.A.1-13.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-11.B.1-100.png', 'ScreenshotCaption': 'Enrichment of powershell.exe making a connection over a ”HTTP Port," tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-11.B.1-11.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 (C2 Server) over port TCP port 443 (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert for "PowerShell Making Network Connections" was triggered due to powershell.exe making a connection over port 443. The alert was tainted by a parent alert and mapped to the correct ATT&CK Tactic (Command and Control).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-11-2.png', 'ScreenshotCaption': 'Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert)'}, {'ScreenshotName': 'EG-11-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making connections over port 443 (tainted by parent alert)'}, {'ScreenshotName': 'EG-11-5.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"PowerShell Making Network Connections\\" (mapped to correct ATT&CK Tactic, Command and Control)'}, {'ScreenshotName': 'EG-11-6.png', 'ScreenshotCaption': 'Event tree view of Specific Behavior alert for \\"Command and Control PowerShell Network\\"(tainted by parent alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing the decoded powershell.exe command-line arguments showed a connection over port 443 to www.freegoogleadsenseinfo.com (C2 domain) (tainted by parent alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-11-2.png', 'ScreenshotCaption': 'Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert)'}, {'ScreenshotName': 'EG-11-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making connections over port 443 (tainted by parent alert)'}, {'ScreenshotName': 'EG-11-5.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"PowerShell Making Network Connections\\" (mapped to correct ATT&CK Tactic, Command and Control)'}, {'ScreenshotName': 'EG-11-6.png', 'ScreenshotCaption': 'Event tree view of Specific Behavior alert for \\"Command and Control PowerShell Network\\"(tainted by parent alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a network connection over port 443 to www.freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-11.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor communicated with 192.168.0.5 (C2 server) over port 443.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)'}, {'ScreenshotName': 'FE-11.B.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)'}, {'ScreenshotName': 'FE-11.B.1-4.png', 'ScreenshotCaption': 'Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe communicating over TCP port 443. The telemetry was tainted by the parent PowerShell Network Connection alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)'}, {'ScreenshotName': 'FE-11.B.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)'}, {'ScreenshotName': 'FE-11.B.1-4.png', 'ScreenshotCaption': 'Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating an outbound connection to 192.168.0.5 (C2 server) over TCP port 443.[CT5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making a network connection over TCP port 443'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell sending and receiving information through port 443. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) and a suspicious indicator that powershell.exe accessed a known TCP port'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over port 443 (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert also showed decoded command-line arguments containing port 443.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-11.A.1-9.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating over TCP port 443'}, {'ScreenshotName': 'MS-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server)'}, {'ScreenshotName': 'MS-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry within alert showing decoded command-line arguments containing port 443\xa0and tainted relationship to the powershell.exe process'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'General Behavior alerts were generated for PowerShell making network connections to the internet as well as Wscript connecting to an external network. The alerts were tainted by a parent alert on wscript.exe.[PA2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.B.1-2.png', 'ScreenshotCaption': 'General Behavior alerts for PowerShell making network connections to the internet as well as Wscript connecting to an external network (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port). The data was tainted by a parent alert on wscript.exe.[PA2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.B.1-2.png', 'ScreenshotCaption': 'General Behavior alerts for PowerShell making network connections to the internet as well as Wscript connecting to an external network (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent alert on wscript.exe.[PA2]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.A.1-3.png', 'ScreenshotCaption': 'Enrichment of the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-11.B.1-2.png', 'ScreenshotCaption': 'General Behavior alerts for PowerShell making network connections to the internet as well as Wscript connecting to an external network (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over port 443 and to letsencrypt.org (no protocol was identified for this traffic).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-11-2.png', 'ScreenshotCaption': 'Telemetry showing network connections, including over port 443 (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connections to 192.168.0.5 (C2 server) over TCP port 443. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (Group ID tainted the event but was not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '11.B.1', 'Procedure': 'Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com', 'Techniques': [{'TechniqueId': 'T1071', 'TechniqueName': 'Standard Application Layer Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed modload events importing dynamic libraries usually used for HTTP and SSL communication (e.g. winhttp.dll), followed by a CRL check to a CA, indicating that HTTPS was likely used.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-11.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing modloads and certificate check'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent PowerShell alert. Telemetry also showed that powershell.exe had an outgoing connection on port 443, identified as HTTP type traffic.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-11.A.1-13.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-11.B.1-11.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing the decoded powershell.exe command-line arguments showed a connection to over HTTPS to www.freegoogleadsenseinfo.com (C2 domain) (tainted by parent alert). Telemetry also showed a connection to letsencrypt.org, which could indicate use of a cert for HTTPS.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-11-2.png', 'ScreenshotCaption': 'Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert)'}, {'ScreenshotName': 'EG-11-6.png', 'ScreenshotCaption': 'Telemetry showing connection to letsencrypt.org'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a connection over port 443 to freegoogleadsenseinfo.com (C2 domain). [CC2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-11.B.1-T1071-new.png', 'ScreenshotCaption': 'Telemetry showing a network connection over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)'}, {'ScreenshotName': 'CC-11.A.1-5.png', 'ScreenshotCaption': 'An alert for PowerShell downloading a significant amount of data using HTTP(S) (does not count as a detection since it was based on port)'}], 'Footnotes': [' There was an alert for PowerShell downloading significant amount of data using HTTP(S), though this alert was based only on the port (443).']}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor was configured to communicate with freegoogleadsenseinfo.com (C2 domain) over HTTPS.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-11.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over TCP port 443 (no protocol was identified for this traffic).[CT5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making a network connection over TCP port 443 (does not count as a detection)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic) and an alert than indicated that powershell.exe queried registered cryptographic provider libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Alert indicating that powershell.exe queried registered cryptographic provider libraries (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated on the C2 domain.[MS12]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'MS-11.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel'}, {'ScreenshotName': 'MS-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry within alert showing decoded command-line arguments containing HTTPS'}, {'ScreenshotName': 'MS-11.B.1-2.png', 'ScreenshotCaption': 'Alert\xa0for C2 domain indicator of compromise'}], 'Footnotes': [' Vendor added detection for evaluation C2 domain using the standard customer-facing custom detection capabilities of the product.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over an encrypted channel (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert showed decoded command-line arguments to perform HTTPS connection to C2 domain.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-11.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel'}, {'ScreenshotName': 'MS-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry within alert showing decoded command-line arguments containing HTTPS'}, {'ScreenshotName': 'MS-11.B.1-2.png', 'ScreenshotCaption': 'Alert\xa0for C2 domain indicator of compromise'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[PA2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a connection over port 443 to freegoogleadsenseinfo.com (C2 domain).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-11-2.png', 'ScreenshotCaption': 'Telemetry showing network connections, including over port 443'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[SO20][SO3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)'}], 'Footnotes': ['Telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over TCP port 443 (no protocol was identified for this traffic).', ' Vendor stated log files indicate the powershell process was using the SSL cache folder.']}]}]}]}, {'Substep': '11.B.1', 'Procedure': 'Empire: Encrypted C2 channel established using HTTPS', 'Techniques': [{'TechniqueId': 'T1032', 'TechniqueName': 'Standard Cryptographic Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed modload events importing dynamic libraries usually used for HTTP and SSL communication (e.g. winhttp.dll), followed by a CRL check to a CA, indicating that HTTPS was likely used.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-11.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing modloads and certificate check'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that powershell.exe had an outgoing connection on port 443, identified as HTTP type traffic. Telemetry also showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-11.A.1-13.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell command with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-11.B.1-11.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making outgoing connection to 192.168.0.5 tagged with SERVICE_HTTP (Hypertext Transfer Protocol Over TLS/SSL (HTTPS)) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing the decoded powershell.exe command-line arguments showed a connection to over HTTPS to www.freegoogleadsenseinfo.com (C2 domain) (tainted by parent alert). Telemetry also showed a connection to letsencrypt.org, which could indicate use of a cert for HTTPS.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-11-2.png', 'ScreenshotCaption': 'Telemetry showing decoded powershell.exe command-line arguments (tainted by parent alert)'}, {'ScreenshotName': 'EG-11-6.png', 'ScreenshotCaption': 'Telemetry showing connection to letsencrypt.org'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell downloading a significant amount of data using HTTP(S).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-11.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor was configured to communicate with freegoogleadsenseinfo.com (C2 domain) over HTTPS.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-11.B.1-4.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over TCP port 443 (no protocol was identified for this traffic).[CT5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making a network connection over TCP port 443 (does not count as a detection)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over port 443 (no protocol was identified for this traffic) and an alert than indicated that powershell.exe queried registered cryptographic provider libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making a network connection over port 443 (does not count as a detection)'}, {'ScreenshotName': 'MC-11.A.1-5.png', 'ScreenshotCaption': 'Alert indicating that powershell.exe queried registered cryptographic provider libraries (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over an encrypted channel (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert showed decoded command-line arguments to perform HTTPS connection to C2 domain.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-11.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel'}, {'ScreenshotName': 'MS-11.B.1-4.png', 'ScreenshotCaption': 'Telemetry within alert showing decoded command-line arguments containing HTTPS'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[PA2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor stated that more information would be available if their firewall appliance was installed and activated.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over port 443 and to letsencrypt.org (no protocol was identified for this traffic).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-11-2.png', 'ScreenshotCaption': 'Telemetry showing network connections, including over port 443 (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[SO20][SO3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-11.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over TCP port 443 (does not count as a detection)'}], 'Footnotes': ['Telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over TCP port 443 (no protocol was identified for this traffic).', ' Vendor stated log files indicate the powershell process was using the SSL cache folder.']}]}]}]}, {'Substep': '12.A.1', 'Procedure': "Empire: 'route print' via PowerShell", 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing route.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing route.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because route print was part of the basic reconnaissance activity performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing route.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating route print was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing route.exe with command-line arguments. The process tree view showed route.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing route.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating route print was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed route.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing route.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing route.exe with command-line arguments (tainted by parent PowerShell alerts).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-1.png', 'ScreenshotCaption': 'Event tree view of telemetry showing route.exe with command-line arguments (tainted by parent PowerShell alerts)'}, {'ScreenshotName': 'EG-12-2.png', 'ScreenshotCaption': 'Telemetry showing route.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance'}, {'ScreenshotName': 'CC-12.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing route.exe with command-line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched route.exe indicating that it could be used to print the routing table as part of reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance'}, {'ScreenshotName': 'CC-12.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing route.exe with command-line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing route.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of route.exe indicating that it could be used to print the routing table as part of reconnaissance'}, {'ScreenshotName': 'CC-12.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing route.exe with command-line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (route) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified route.exe as a reconnaissance command used.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched route.exe with an alert for Route Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing route.exe with command-line arguments and enriched the command with the conditions Reconnaissance Tool and Route Spawned with Reconnaissance. The enrichment was tainted by the parent Script File Created alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of route.exe with conditions Reconnaissance Tool and Route Spawned with Reconnaissance (tainted by the parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched route.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that routing tables were viewed or manipulated.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of route.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that routing tables were viewed or manipulated'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing route.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of route.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) and a suspicious indicator that routing tables were viewed or manipulated'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by previous "Suspicious sequence of exploration activities" and suspicious PowerShell cmdlet alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.A.1-4.png', 'ScreenshotCaption': 'Process tree view of \\"Suspicious sequence of exploration activities\\" alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing route.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing route.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-1.png', 'ScreenshotCaption': 'Telemetry showing route.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing route.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.A.1-1.png', 'ScreenshotCaption': 'Threat story showing partial tree of activity from the initial compromise alert'}, {'ScreenshotName': 'S1-12.A.1-2.png', 'ScreenshotCaption': 'Continued threat story showing initial compromise alert and powershell.exe\xa0tainting route.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '12.A.2', 'Procedure': "Empire: 'ipconfig -all' via PowerShell", 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe with the correct ATT&CK Technique (T1049 - System Network Configuration Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.A.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing ipconfig.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing ipconfig.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.A.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing ipconfig.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because ipconfig was part of the basic reconnaissance activity performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing ipconfig.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating ipconfig was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The process tree view showed ipconfig.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing ipconfig.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating ipconfig was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe executing with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.A.2-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed ipconfig.exe executing with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.A.2-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments (tainted by parent PowerShell alerts).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-1.png', 'ScreenshotCaption': 'Event tree view of telemetry showing ipconfig.exe with command-line arguments (tainted by parent PowerShell alerts)'}, {'ScreenshotName': 'EG-12-2.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.2-4.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-12.A.2-3.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability identified powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.2-4.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-12.A.2-3.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed ipconfig.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.2-4.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing ipconfig.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-12.A.2-3.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (ipconfig) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified ipconfig.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.2-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe with an alert for Ipconfig Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.A.2-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing ipconfig.exe with command-line arguments and enriched the command with the condition Ipconfig All Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT6]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.A.2-1.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with condition Ipconfig All Reconnaissance Command (tainted by parent Script File Created alert)'}], 'Footnotes': ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ipconfig.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by previous "Suspicious sequence of exploration activities" and suspicious PowerShell cmdlet alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.A.1-4.png', 'ScreenshotCaption': 'Process tree view of \\"Suspicious sequence of exploration activities\\" alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.A.2-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.A.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing ipconfig.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.A.2-2.png', 'ScreenshotCaption': 'Enrichment of ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-1.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing ipconfig.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.A.1-1.png', 'ScreenshotCaption': 'Threat story showing initial compromise alert and powershell.exe\xa0tainting ipconfig.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '12.B.1', 'Procedure': "Empire: 'whoami -all -fo list' via PowerShell", 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing whoami.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.B.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing whoami.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing whoami.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.B.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating whoami.exe with command-line arguments was suspicious. The process tree view showed whoami.exe as tainted by a previous powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.B.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because whoami was part of the basic reconnaissance activity performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.B.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the OverWatch alert showed powershell.exe executing whoami.exe with command-line arguments, and would be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-12.B.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert and telemetry indicating whoami.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating whoami was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.B.1-1.png', 'ScreenshotCaption': 'Enrichment of whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-12.B.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe executing with labels for Reconnaissance and Accounts discovery'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed whoami.exe executing with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.B.1-1.png', 'ScreenshotCaption': 'Enrichment of whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-12.B.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe executing with labels for Reconnaissance and Accounts discovery'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-2.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe with command-line arguments'}, {'ScreenshotName': 'EG-12-1.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing whoami.exe with command-line arguments (tainted by parent PowerShell alerts). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-2.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe with command-line arguments'}, {'ScreenshotName': 'EG-12-1.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation'}, {'ScreenshotName': 'CC-12.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing whoami.exe with command-line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation'}, {'ScreenshotName': 'CC-12.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing whoami.exe with command-line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing whoami.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing whoami.exe indicating a sign of reconnaissance before privilege escalation'}, {'ScreenshotName': 'CC-12.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing whoami.exe with command-line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified whoami.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.B.1-1.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe with an alert for Whoami Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.B.1-1.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing whoami.exe with command-line arguments and enriched the command with the condition Whoami Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT15]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.B.1-1.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with condition Whoami Reconnaissance Command (tainted by parent Script File Created alert)'}], 'Footnotes': ["The condition contributing to enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whomai.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Owner / User Discovery) and a suspicious indicator that the name of the logged user was discovered.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Owner / User Discovery) and a suspicious indicator that the name of the logged user was discovered'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing whoami.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Owner / User Discovery) and a suspicious indicator that the name of the logged user was discovered'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by previous \\"Suspicious sequence of exploration activities\\" and suspicious PowerShell cmdlet alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.A.1-4.png', 'ScreenshotCaption': 'Process tree view of \\"Suspicious sequence of exploration activities\\" alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of powershell.exe executing whoami.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing whoami.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing whoami.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-1.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.A.1-2.png', 'ScreenshotCaption': 'Continued threat story showing initial compromise alert and powershell.exe\xa0tainting whoami.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '12.C.1', 'Procedure': "Empire: 'qprocess *' via PowerShell", 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched qprocess.exe with the correct ATT&CK Technique (Process Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing qprocess.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.C.1-2.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing qprocess.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing qprocess.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.C.1-2.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating qprocess.exe with command-line arguments was suspicious. The process tree view showed qprocess.exe as tainted by a previous powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.C.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because qprocess was part of the basic reconnaissance activity performed performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.C.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the OverWatch alert showed execution of qprocess.exe with command-line arguments, and would be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-12.C.1-1.png', 'ScreenshotCaption': 'OverWatch General Behavior alert and telemetry indicating qprocess.exe with command-line arguments was suspicious (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating qprocess was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched qprocess.exe executing as Reconnaissance and Local process discovery as well as the correct ATT&CK Technique (Process Discovery) and Tactic (Discovery). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.C.1-1.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe executing with correct ATT&CK Technique (Process Discovery) and Tactic (Discovery) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-12.B.1-2.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe executing with labels for Reconnaissance and Local process discovery'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed qprocess.exe executing with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.C.1-1.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe executing with correct ATT&CK Technique (Process Discovery) and Tactic (Discovery) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-12.B.1-2.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe executing with labels for Reconnaissance and Local process discovery'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing qprocess.exe with command-line arguments (tainted by parent PowerShell alerts).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-1.png', 'ScreenshotCaption': 'Event tree view of telemetry showing qprocess.exe with command-line arguments (tainted by parent PowerShell alerts)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance'}, {'ScreenshotName': 'CC-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing qprocess.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched qprocess.exe as listing running processes and possibly a sign of reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance'}, {'ScreenshotName': 'CC-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing qprocess.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershelll.exe executing qprocess.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.A.1-1.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe as listing running processes and possibly a sign of reconnaissance'}, {'ScreenshotName': 'CC-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing qprocess.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (qprocess) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified qprocess.exe as a reconnaissance command used.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.C.1-1.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched qprocess.exe with an alert for Qprocess Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1057 - Process Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.C.1-1.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments (tainted by parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes'}, {'ScreenshotName': 'MC-12.A.1-99.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes'}, {'ScreenshotName': 'MC-12.A.1-99.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing qprocess.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (Process Discovery) and a suspicious indicator that QPROCESS was used to check active processes'}, {'ScreenshotName': 'MC-12.A.1-99.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe with the correct ATT&CK Tactic (Discovery) and a suspicious indicator that software running on a system was queried'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by previous \\"Suspicious sequence of exploration activities\\" and suspicious PowerShell cmdlet alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.A.1-4.png', 'ScreenshotCaption': 'Process tree view of \\"Suspicious sequence of exploration activities\\" alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched qprocess.exe executing with a related ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.C.1-2.png', 'ScreenshotCaption': 'Enrichment of execution of qprocess.exe as the enumeration of running processes via the command line (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.C.1-3.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe executing with a related ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of qprocess.exe as the enumeration of running processes via the command line. The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.C.1-2.png', 'ScreenshotCaption': 'Enrichment of execution of qprocess.exe as the enumeration of running processes via the command line (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.C.1-3.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe executing with a related ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.C.1-2.png', 'ScreenshotCaption': 'Enrichment of execution of qprocess.exe as the enumeration of running processes via the command line (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.C.1-3.png', 'ScreenshotCaption': 'Enrichment of qprocess.exe executing with a related ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing qprocess.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-1.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.A.1-1.png', 'ScreenshotCaption': 'Threat story showing initial compromise alert and powershell.exe\xa0tainting qprocess.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '12.D.1', 'Procedure': "Empire: 'net start' via PowerShell", 'Techniques': [{'TechniqueId': 'T1007', 'TechniqueName': 'System Service Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.A.D.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net start was part of the basic reconnaissance activity performed performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net start was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe and net1.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-6.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net start was part of basic reconnaissance activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Services Discovery). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.D.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Services Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-12.D.1-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe with correct ATT&CK Technique (System Service Discovery) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.D.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Services Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-12.D.1-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe with correct ATT&CK Technique (System Service Discovery) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).\xa0The enrichment was tainted by parent PowerShell alerts. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'EG-12-1.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of  net.exe with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)\xa0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments (tainted by parent PowerShell alerts). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'EG-12-1.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of  net.exe with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)\xa0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-11.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.D.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Start Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.D.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the parent Script File Created alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net or sc command executed through PowerShell. The alert was tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe'}, {'ScreenshotName': 'MC-12.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert was generated for net or sc command executed through PowerShell, tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe'}, {'ScreenshotName': 'MC-12.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert was generated for net or sc command executed through PowerShell, tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing qprocess.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows services were manipulated via sc.exe/net.exe'}, {'ScreenshotName': 'MC-12.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert was generated for net or sc command executed through PowerShell, tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert description for \\"Suspicious sequence of discovery activities\\"'}, {'ScreenshotName': 'MS-12.D.1-2.png', 'ScreenshotCaption': 'Process tree view of \\"Suspicious sequence of discovery activities\\" alert context with net.exe command-line arguments'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a previous suspicious PowerShell cmdlet alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert description for \\"Suspicious sequence of discovery activities\\"'}, {'ScreenshotName': 'MS-12.D.1-2.png', 'ScreenshotCaption': 'Process tree view of \\"Suspicious sequence of discovery activities\\" alert context with net.exe command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe executing as an enumeration command called by a commonly abused causality group owner (CGO, wscipt.exe). The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.D.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing as the execution of an enumeration command (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.D.1-3.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing as a enumeration command called by a commonly abused causality group owner (CGO, wscript.exe) (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing as the execution of an enumeration command. The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.D.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing as the execution of an enumeration command (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.D.1-3.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing as a enumeration command called by a commonly abused causality group owner (CGO, wscript.exe) (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.D.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing as the execution of an enumeration command (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.D.1-3.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing as a enumeration command called by a commonly abused causality group owner (CGO, wscript.exe) (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.A.1-1.png', 'ScreenshotCaption': 'Threat story showing initial compromise alert and powershell.exe\xa0tainting net.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1', 'Procedure': 'Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques', 'Techniques': [{'TechniqueId': 'T1064', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed process execution of powershell.exe. The powershell.exe process loaded several non-default dynamically loaded libraries that may indicate the functionality may be used by the PowerShell script.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe execution'}, {'ScreenshotName': 'CB-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing dynamically loaded libraries (modloads) that may indicate PowerShell functionality'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating they identified a Specific Behavior for an unidentified PowerShell script running.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing the temp write of the ps1 script'}, {'ScreenshotName': 'CS-12.E.1-4.png', 'ScreenshotCaption': 'OverWatch Specific Behavior alert indicating the PowerShell script was malicious'}, {'ScreenshotName': 'CS-12.E.1-3.png', 'ScreenshotCaption': 'Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team generated a Specific Behavior alert indicating the PowerShell script was malicious.[CS1]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing the temp write of the ps1 script'}, {'ScreenshotName': 'CS-12.E.1-4.png', 'ScreenshotCaption': 'OverWatch Specific Behavior alert indicating the PowerShell script was malicious'}, {'ScreenshotName': 'CS-12.E.1-3.png', 'ScreenshotCaption': 'Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell script (.ps1) being written to the temp folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing the temp write of the ps1 script'}, {'ScreenshotName': 'CS-12.E.1-4.png', 'ScreenshotCaption': 'OverWatch Specific Behavior alert indicating the PowerShell script was malicious'}, {'ScreenshotName': 'CS-12.E.1-3.png', 'ScreenshotCaption': 'Email excerpt from OverWatch team indicating they observed an unidentified PowerShell script running (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a malicious command, which was identified as the Invoke-WinEnum function. The alert also identified the PowerShell commands as suspicious and were tagged with the correct ATT&CK Technique (PowerShell) and Tactic (Execution). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.E.1-100.png', 'ScreenshotCaption': 'Specific Behavior alert for Malicious use of PowerShell (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-12.E.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a PowerShell Malicious command, identified as the Invoke-WinEnum function'}, {'ScreenshotName': 'CR-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the temp write of the psm1 script module (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell Script module (.psm1) being written to the temp folder. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.E.1-100.png', 'ScreenshotCaption': 'Specific Behavior alert for Malicious use of PowerShell (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-12.E.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a PowerShell Malicious command, identified as the Invoke-WinEnum function'}, {'ScreenshotName': 'CR-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the temp write of the psm1 script module (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for "PowerShell with Unusual Arguments" that coincided with the execution of WinEnum (tainted by parent PowerShell alerts). The alert also identified a related ATT&CK Technique (T1086 - PowerShell) and Tactic (Execution). From the alert, the Interactive Shell was used to analyze the PowerShell script and the function Invoke-WinEnum was observed.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-3.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"PowerShell with Unusual Arguments\\" (tagged with correct ATT&CK Technique, T1086 - PowerShell, and Tactic, Execution; tainted by parent PowerShell alerts)'}, {'ScreenshotName': 'EG-12-E-01.png', 'ScreenshotCaption': 'Telemetry pulled by Interactive Shell showing the contents of the WinEnum script (does not count as a detection)'}, {'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe execution (ID 2397532) (tainted by parent PowerShell alerts)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the PowerShell Process (tainted by parent PowerShell alerts).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-3.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"PowerShell with Unusual Arguments\\" (tagged with correct ATT&CK Technique, T1086 - PowerShell, and Tactic, Execution; tainted by parent PowerShell alerts)'}, {'ScreenshotName': 'EG-12-E-01.png', 'ScreenshotCaption': 'Telemetry pulled by Interactive Shell showing the contents of the WinEnum script (does not count as a detection)'}, {'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe execution (ID 2397532) (tainted by parent PowerShell alerts)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that a PowerShell command was run from the Empire process. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.E.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe with an alert for PowerShell Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1086 - PowerShell).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.E.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to the domain controller 10.0.0.4 (Creeper), which coincided with the execution of WinEnum.[CT5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-12.E.1.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe execution and connection to the domain controller 10.0.0.4 (Creeper)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell script (.ps1) being written to the temp folder, indicating the execution of a PowerShell script.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.E.1-4.png', 'ScreenshotCaption': 'Telemetry showing the PowerShell script (.ps1) being written to the temp folder'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for "A malicious PowerShell Cmdlet was invoked on the machine."', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe execution sequence resulting from WinEnum'}, {'ScreenshotName': 'MS-12.A.1-4.png', 'ScreenshotCaption': 'Process tree view of \\"Suspicious sequence of exploration activities\\" alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.E.1-2.png', 'ScreenshotCaption': 'Additional telemetry showing powershell.exe execution sequence resulting from WinEnum'}, {'ScreenshotName': 'MS-12.E.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"A malicious PowerShell Cmdlet was invoked on the machine\\"'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree under alert \\"A malicious PowerShell Cmdlet was invoked on the machine\\" showing Invoke-Empire and Invoke-WinEnum'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence from PowerShell with several activities from the WinEnum cmdlet. The telemetry was tainted by the previous \\"Suspicious sequence of exploration activities\\" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe execution sequence resulting from WinEnum'}, {'ScreenshotName': 'MS-12.A.1-4.png', 'ScreenshotCaption': 'Process tree view of \\"Suspicious sequence of exploration activities\\" alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.E.1-2.png', 'ScreenshotCaption': 'Additional telemetry showing powershell.exe execution sequence resulting from WinEnum'}, {'ScreenshotName': 'MS-12.E.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"A malicious PowerShell Cmdlet was invoked on the machine\\"'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree under alert \\"A malicious PowerShell Cmdlet was invoked on the machine\\" showing Invoke-Empire and Invoke-WinEnum'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell execution with base64 encoded commands. The alert was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.E.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.E.1-3.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying suspicious PowerShell strings as Empire WinEnum'}], 'Footnotes': []}, {'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire WinEnum.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.E.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.E.1-3.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying suspicious PowerShell strings as Empire WinEnum'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.E.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell execution with base64 encoded commands (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.E.1-3.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying suspicious PowerShell strings as Empire WinEnum'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell running and a PowerShell script being written to disk that coincided with the execution of WinEnum.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-3.png', 'ScreenshotCaption': 'Telemetry showing a PowerShell script written to disk'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of a PowerShell script with follow-on enumeration activity that coincided with the execution of the WinEnum module. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing encoded PowerShell script (tainted Group ID not shown but was the search parameter)'}], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.1', 'Procedure': 'Empire: WinEnum module included enumeration of user information', 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Get-UserInfo was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-02.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Get-UserInfo function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of user information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire UserInfo.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.1-1.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying suspicious PowerShell strings as Empire UserInfo'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.2', 'Procedure': 'Empire: WinEnum module included enumeration of AD group memberships', 'Techniques': [{'TechniqueId': 'T1069', 'TechniqueName': 'Permission Groups Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum AD Group Memberships was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-03.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the AD Group Memberships function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of AD group memberships.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed loading of an assembly associated with accessing Active Directory security principals.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.E.1.2-1.png', 'ScreenshotCaption': 'Telemetry showing loading of System.DirectoryServices.AccountManagement assembly (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed powershell.exe connecting to the domain controller. This could indicate AD group information was being obtained, but this was not directly detected. The vendor indicated the capability sees the start of a PowerShell connection, but would not see additional commands after that start.[CT5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-12.E.1.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe execution and connection to the domain controller 10.0.0.4 (Creeper) (does not count as a detection)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.3', 'Procedure': 'Empire: WinEnum module included enumeration of password policy information', 'Techniques': [{'TechniqueId': 'T1201', 'TechniqueName': 'Password Policy Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Password Last changed was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-03.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Password Last Changed function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of password policy information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.4.1', 'Procedure': 'Empire: WinEnum module included enumeration of recently opened files', 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Last 5 files opened was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-03.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Last 5 files opened function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of recently opened files.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.4-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.4.2', 'Procedure': 'Empire: WinEnum module included enumeration of interesting files', 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Interesting Files was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-04.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Interesting Files function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of interesting files.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.4-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.5', 'Procedure': 'Empire: WinEnum module included enumeration of clipboard contents', 'Techniques': [{'TechniqueId': 'T1115', 'TechniqueName': 'Clipboard Data', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed execution of an encoded PowerShell command and OverWatch alerted on it as suspicious. The PowerShell decoded to Windows.Clipboard(...) outside of the capability, which indicated clipboard interaction, but this was not counted as a detection because it was external to the capability.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing encoded PowerShell, which decodes to show Windows.Clipboard details (does not count as a detection)'}, {'ScreenshotName': 'CS-12.E.1.5-3.png', 'ScreenshotCaption': 'Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)'}, {'ScreenshotName': 'CS-12.E.1.5-1.png', 'ScreenshotCaption': 'OverWatch alert indicating encoded PowerShell was suspicious (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the decoded powershell.exe function to gather clipboard data. The telemetry was tainted by a parent PowerShell alert..', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.E.1.5-1.png', 'ScreenshotCaption': 'Telemetry of the PowerShell function to gather clipboard data (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of a PowerShell sub-process and decoded the command within the capability to show\xa0Windows.Clipboard (tainted by parent PowerShell alerts). Though it does not count as part of the detection, the Interactive Shell could also be used to analyze the PowerShell execution and WinEnum Clipboard Contents was observed.[EG13]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-4.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell displaying Windows.Clipboard as part of WinEnum. The PowerShell process was tainted by parent PowerShell alerts.'}, {'ScreenshotName': 'EG-12-E-05.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and Clipboard Contents function (does not count as part of detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated for PowerShell Empire accessing the clipboard.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}, {'ScreenshotName': 'CC-12.E.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert for PowerShell Empire accessing the clipboard.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of clipboard contents.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}, {'ScreenshotName': 'CC-12.E.1-4.png', 'ScreenshotCaption': 'Indicator of Compromise alert for PowerShell Empire accessing the clipboard.'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'The Managed Defense Report indicated an Indicator of Compromise detection occurred because it identified that the attacker executed the Windows Clipboard capability in Empire. The capability separately showed a PowerShell Execution (Weak Signal) alert containing the encoded PowerShell command. This command could be decoded, but this was not counted as a separate detection because it was external to the capability. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker executed the Windows Clipboard capability of Empire (Indicator of Compromise)'}, {'ScreenshotName': 'FE-12.E.1.5-1.png', 'ScreenshotCaption': 'PowerShell Execution alert containing encoded PowerShell command (does not count as a detection)'}, {'ScreenshotName': 'FE-12.E.1.5-2.png', 'ScreenshotCaption': 'Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed execution of an encoded PowerShell command. The PowerShell decoded to Windows.Clipboard(...) outside of the capability, which indicated clipboard interaction, but this was not counted as a detection because it was external to the capability.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.E.1.1-5.png', 'ScreenshotCaption': 'Telemetry showing execution of an encoded PowerShell command (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Clipboard Data).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.5-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Clipboard Data)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[SO95]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['PowerShell telemetry showed execution of an encoded command and the script was decoded to Windows.Clipboard(...) outside of the capability, but this was not counted as a detection because it was external to the capability.']}]}]}]}, {'Substep': '12.E.1.6.1', 'Procedure': 'Empire: WinEnum module included enumeration of system information', 'Techniques': [{'TechniqueId': 'T1082', 'TechniqueName': 'System Information Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from decoded PowerShell (within the capability) showed the Get-Sysinfo function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-12.E.1.6.1-1.png', 'ScreenshotCaption': 'Telemetry showing the Get-Sysinfo function'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Get-SysInfo was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-05.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Get-SysInfo function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of system information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed invocation of the PowerShell cmdlet Get-SysInfo.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing Get-SysInfo invocation'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire SysImfo.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.6-1.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing WMI queries that indicated operating system information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.E.1-3.png', 'ScreenshotCaption': 'Additional telemetry showing powershell.exe WMI queries for operating system information'}], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.6.2', 'Procedure': 'Empire: WinEnum module included enumeration of Windows update information', 'Techniques': [{'TechniqueId': 'T1082', 'TechniqueName': 'System Information Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Windows Last Updated was observed.[EG13]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of Windows update information.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed invocation of the PowerShell cmdlet Get-HotFix.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing Get-HotFix invocation'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.7', 'Procedure': 'Empire: WinEnum module included enumeration of system information via a Registry query', 'Techniques': [{'TechniqueId': 'T1012', 'TechniqueName': 'Query Registry', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from decoded PowerShell (within the capability) showed the Get-Sysinfo function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-12.E.1.6.1-1.png', 'ScreenshotCaption': 'Telemetry showing the Get-Sysinfo function'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Get-SysInfo was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-05.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Get-SysInfo function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of system information via a Registry query.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the enumeration of system information via a Registry query as suspicious. The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.6-1.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo'}, {'ScreenshotName': 'PA-12.E.1.7-1.png', 'ScreenshotCaption': 'Enrichment of the enumeration of system information via a Registry query as suspicious (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire SysImfo.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.6-1.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying suspicious PowerShell strings as Empire SysInfo'}, {'ScreenshotName': 'PA-12.E.1.7-1.png', 'ScreenshotCaption': 'Enrichment of the enumeration of system information via a Registry query as suspicious (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.8', 'Procedure': 'Empire: WinEnum module included enumeration of services', 'Techniques': [{'TechniqueId': 'T1007', 'TechniqueName': 'System Service Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Services was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-06.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Services function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of services.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed invocation of the PowerShell cmdlet Get-Service.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing Get-Service invocation'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.8-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.9.1', 'Procedure': 'Empire: WinEnum module included enumeration of available shares', 'Techniques': [{'TechniqueId': 'T1135', 'TechniqueName': 'Network Share Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Available Shares was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-06.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Available Shares function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of available shares.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.9-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.9.2', 'Procedure': 'Empire: WinEnum module included enumeration of mapped network drives', 'Techniques': [{'TechniqueId': 'T1135', 'TechniqueName': 'Network Share Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Mapped Network Drives was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-07.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Mapped Network Drives function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of mapped network drives.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.9-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing WMI queries that indicated logical disk information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.E.1-3.png', 'ScreenshotCaption': 'Additional telemetry showing powershell.exe WMI queries for logical disk information'}], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.10.1', 'Procedure': 'Empire: WinEnum module included enumeration of AV solutions', 'Techniques': [{'TechniqueId': 'T1063', 'TechniqueName': 'Security Software Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum AV Solution was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-08.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the AV Solution function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of AV solutions.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an event log for the WMI query of the system AV products.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.10-2.png', 'ScreenshotCaption': 'Telemetry showing an event log for the WMI query of the system AV products'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe activity with the action \\"attempted to find other installed security software.\\" The enrichment was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.E.1-2.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with action \\"attempted to find other installed security software\\" (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.E.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe WMI queries for antivirus product information (tainted by relationship to threat story)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing WMI queries that indicated antivirus product information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.E.1-2.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with action \\"attempted to find other installed security software\\" (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.E.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe WMI queries for antivirus product information (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.10.2', 'Procedure': 'Empire: WinEnum module included enumeration of firewall rules', 'Techniques': [{'TechniqueId': 'T1063', 'TechniqueName': 'Security Software Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Firewall Rules was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-09.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Firewall Rules function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of firewall rules.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Security Software Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.10-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Security Software Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.11', 'Procedure': 'Empire: WinEnum module included enumeration of network adapters', 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Interactive Shell was used to analyze the PowerShell execution and WinEnum Get-NetInfo-Network Adapters was observed.[EG13]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-12-E-10.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Network Adapters function (does not count as a detection due to manual process of pulling events)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}, {'ScreenshotName': 'CC-12.E.1-3.png', 'ScreenshotCaption': 'Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of network adapters.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}, {'ScreenshotName': 'CC-12.E.1-3.png', 'ScreenshotCaption': 'Enrichment of powershell.exe making a WMI query with a tag identifying the command as WMI enumerating adapters'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed invocation of the PowerShell cmdlet Get-NetInfo.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing Get-NetInfo invocation'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire NetInfo.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.11-1.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying suspicious PowerShell strings as Empire NetInfo'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing WMI queries that indicated network adapter and configuration information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing WMI queries (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.E.1-3.png', 'ScreenshotCaption': 'Additional telemetry showing powershell.exe WMI queries for network adapter and configuration information'}], 'Footnotes': []}]}]}]}, {'Substep': '12.E.1.12', 'Procedure': 'Empire: WinEnum module included enumeration of established network connections', 'Techniques': [{'TechniqueId': 'T1049', 'TechniqueName': 'System Network Connections Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with the correct ATT&CK Technique (System Network Connections Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.E.1.12-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing netstat.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.E.1.12-1.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed netstat.exe executing with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.E.1.12-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing netstat.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.E.1.12-1.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing netstat.exe with command-line arguments. The process tree view showed netstat.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.E.12-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing netstat.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.E.1.12-1.png', 'ScreenshotCaption': 'Enriched alert for netstat.exe labeled with Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery)\xa0(tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed netstat.exe executing with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.E.1.12-1.png', 'ScreenshotCaption': 'Enriched alert for netstat.exe labeled with Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery)\xa0(tainted by a parent PowerShell alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).\xa0The enrichment was tainted by parent PowerShell alerts. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-3.png', 'ScreenshotCaption': 'Event tree showing telemetry of netstat subprocess associated with WinEnum (tainted by parent PowerShell alerts)'}, {'ScreenshotName': 'EG-12-E-10.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Netstat Established Connections and Processes function (does not count as a detection due to manual process of pulling events)'}, {'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)\xa0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'An event tree from the suspicious PowerShell process showed a netstat subprocess that was created by WinEnum (tainted by parent PowerShell alerts). Though it does not count as part of the detection, the Interactive Shell could also be used to analyze the PowerShell execution and WinEnum Get-NetInfo-Network Adapters was observed.[EG13][EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-3.png', 'ScreenshotCaption': 'Event tree showing telemetry of netstat subprocess associated with WinEnum (tainted by parent PowerShell alerts)'}, {'ScreenshotName': 'EG-12-E-10.png', 'ScreenshotCaption': 'Interactive Shell events showing the WinEnum script and the Netstat Established Connections and Processes function (does not count as a detection due to manual process of pulling events)'}, {'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)\xa0(tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': ['Interactive Shell was not by itself considered telemetry, but the analyst can retrieve additional Windows Logs to enhance baseline Endgame functionality. ', ' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the full contents of the executed Invoke-WinEnum PowerShell function, which includes enumeration of established network connections.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the full contents of the executed Invoke-WinEnum PowerShell function'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified netstat.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.E.1.12-1.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connection Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.E.1.12-1.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing netstat.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing netstat.exe (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing Get-NetInfo invocation'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.E.1-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing netstat.exe with command-line arguments'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed invocation of the PowerShell cmdlet Get-NetInfo and subsequent execution of netstat.exe with command-line arguments from powershell.exe. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-2.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing Get-NetInfo invocation'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process'}, {'ScreenshotName': 'MS-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.E.1-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing netstat.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Network Connections Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.E.1.12-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Network Connections Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing netstat.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-3.png', 'ScreenshotCaption': 'Telemetry showing netstat.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing netstat.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing netstat.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}], 'Footnotes': []}]}]}]}, {'Substep': '12.F.1', 'Procedure': 'Empire: \'net group "Domain Admins" -domain\' via PowerShell', 'Techniques': [{'TechniqueId': 'T1069', 'TechniqueName': 'Permission Groups Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net group was part of additional malicious discovery performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-12.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The process tree view showed net.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-12.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-12.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Permission Groups Discovery). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.F.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-12.F.1-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.F.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-12.F.1-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'An alert for Enumeration of Administrator Account provided enrichment to the net group command (tainted by parent PowerShell alerts). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-12-5.png', 'ScreenshotCaption': 'Enrichment on net group by Enumeration of Administrator Accounts alert (mapped to correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic (Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-12-5.png', 'ScreenshotCaption': 'Enrichment on net group by Enumeration of Administrator Accounts alert (mapped to correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic (Discovery)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments (tainted by parent PowerShell alerts). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-12-5.png', 'ScreenshotCaption': 'Enrichment on net group by Enumeration of Administrator Accounts alert (mapped to correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic (Discovery)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-T1069-new.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-T1069-new.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-12.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-12.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\xa0conditions Net Domain Admins Reconnaissance Command and Net Group Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT16]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.F.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with conditions Net Domain Admins Reconnaissance Command and Net Group Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins'}, {'ScreenshotName': 'MC-12.F.1-99.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins'}, {'ScreenshotName': 'MC-12.F.1-99.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of domain admins'}, {'ScreenshotName': 'MC-12.F.1-99.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.F.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.F.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-4.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe and net1.exe as an enumeration command. The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-4.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-4.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.1-4.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}], 'Footnotes': []}]}]}]}, {'Substep': '12.F.2', 'Procedure': "Empire: 'netï¿½localgroupï¿½administrators' via PowerShell", 'Techniques': [{'TechniqueId': 'T1069', 'TechniqueName': 'Permission Groups Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)'}, {'ScreenshotName': 'CB-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)'}, {'ScreenshotName': 'CB-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net localgroup was part of additional malicious discovery performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net localgroup was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net localgroup was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Permission Groups Discovery). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.F.2-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-12.F.2-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.F.2-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-12.F.2-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'An alert for Enumeration of Administrator Account provided enrichment to the net group command (tainted by parent PowerShell alerts).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry). The tree also shows Enumeration of Administrator Accounts alert.'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry). The tree also shows Enumeration of Administrator Accounts alert.'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments (tainted by parent PowerShell alerts). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry). The tree also shows Enumeration of Administrator Accounts alert.'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net1.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.F.2-T1069-new.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.F.2-T1069-new.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-12.F.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-12.F.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\xa0conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT16]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.F.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with conditions Net Group Reconnaissance Command and Net LocalGroup Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Permissions Group Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.F.2-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.F.2-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.2-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.2-3.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.2-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.2-3.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.F.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.2-2.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as the possible enumeration of administrator groups (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.F.2-3.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '12.G.1', 'Procedure': "Empire: 'net user' via PowerShell", 'Techniques': [{'TechniqueId': 'T1087', 'TechniqueName': 'Account Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.G.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.G.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}, {'ScreenshotName': 'CB-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net user was part of additional malicious discovery performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-12.G.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-12.G.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Account Discovery). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.G.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-12.G.1-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.G.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-12.G.1-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the event with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-6.png', 'ScreenshotCaption': 'Telemetry from event tree showing net.exe with command-line arguments (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments (tainted by parent PowerShell alerts). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-6.png', 'ScreenshotCaption': 'Telemetry from event tree showing net.exe with command-line arguments (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.G.1-T1087-new.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.G.1-T1087-new.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used to capture information about local users.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.G.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.G.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\xa0condition Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.G.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and a related Technique (System Owner/User Discovery) and a suspicious indicator that the net utility was used to obtain information of user groups'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.G.1-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.G.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.G.1-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.G.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.G.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.G.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by relationship to threat story)'}, {'ScreenshotName': 'S1-12.F.1-2.png', 'ScreenshotCaption': 'Continued threat story showing related processes'}], 'Footnotes': []}]}]}]}, {'Substep': '12.G.2', 'Procedure': "Empire: 'net user -domain' via PowerShell", 'Techniques': [{'TechniqueId': 'T1087', 'TechniqueName': 'Account Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)'}, {'ScreenshotName': 'CB-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)'}, {'ScreenshotName': 'CB-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net user was part of additional malicious discovery performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)'}, {'ScreenshotName': 'CS-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net user was part of additional malicious discovery activity (General Behavior)'}, {'ScreenshotName': 'CS-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted from previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Account Discovery). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-12.G.1-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-12.G.2-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-12.G.1-1.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-12.G.2-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Account Discovery) and Technique (Discovery)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the event with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell alerts.[EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments (tainted by parent PowerShell alerts). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-12-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery) (tainted by parent PowerShell alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.G.2-T1087-new.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-12.G.2-T1087-new.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-12.G.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-12.G.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\xa0condition Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-12.G.2-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with condition Net User Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-12.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-12.F.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery).'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A delayed Specific Behavior alert called "Reconnaissance using directory services queries" was generated for domain user enumeration.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.G.2-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.G.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper'}], 'Footnotes': ['The vendor noted this was an Azure Advanced Threat Protection alert.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.G.2-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.G.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-12.E.1-4.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.G.2-3.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}, {'ScreenshotName': 'MS-12.G.2-2.png', 'ScreenshotCaption': 'Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.G.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-12.G.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-12.G.2-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-12-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted Group ID not shown but was the search parameter)'}, {'ScreenshotName': 'S1-12.F.1-1.png', 'ScreenshotCaption': 'Threat story showing initial compromise alert and powershell.exe\xa0tainting net.exe'}, {'ScreenshotName': 'S1-12.F.1-2.png', 'ScreenshotCaption': 'Continued threat story showing initial compromise alert and powershell.exe\xa0tainting net.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '13.A.1', 'Procedure': 'Empire: \'net group "Domain Computers" -domain\' via PowerShell', 'Techniques': [{'TechniqueId': 'T1018', 'TechniqueName': 'Remote System Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK Technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with net.exe and command-line arguments'}, {'ScreenshotName': 'CB-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with net.exe and command-line arguments'}, {'ScreenshotName': 'CB-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net group was part of additional malicious discovery performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)'}, {'ScreenshotName': 'CS-13.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The process tree view showed the enrichment was tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)'}, {'ScreenshotName': 'CS-13.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net group was part of additional malicious discovery activity (General Behavior)'}, {'ScreenshotName': 'CS-13.A.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery) and correct Tactic (Discovery) (tainted by previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-13.A.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Remote System Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-13.A.1-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-13.A.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (Remote System Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-13.A.1-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery). The enrichment was tainted by a parent alert. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-2.png', 'ScreenshotCaption': 'Telemetry from event tree showing with net.exe with command-line arguments (tainted by parent alert)'}, {'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery) (tainted by parent alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments (tainted by parent alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-2.png', 'ScreenshotCaption': 'Telemetry from event tree showing with net.exe with command-line arguments (tainted by parent alert)'}, {'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery) and correct Tactic (Discovery) (tainted by parent alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-13.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-13.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1018 - Remote System Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing net.exe with command-line arguments and enriched the command with the\xa0condition Net User Reconnaissance Command. The enrichment was tainted by the parent Script File Created alert.[CT17]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with condition Net Group Reconnaissance Command (tainted by the parent Script File Created alert)'}], 'Footnotes': ["The condition contributing to Enrichment was added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information of domain computers and controllers.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information of domain computers and controllers'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery) and a suspicious indicator that the net utility obtained information of domain computers and controllers'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of net.exe with command-line arguments'}, {'ScreenshotName': 'MS-13.A.1-3.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-13.A.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe with command-line arguments (tainted by parent PowerShell malicious cmdlet alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of net.exe with command-line arguments'}, {'ScreenshotName': 'MS-13.A.1-3.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-13.A.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of net.exe and net1.exe as an enumeration command. The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-13.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-13.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of net.exe and net1.exe as an enumeration command (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-13-1.png', 'ScreenshotCaption': 'Telemetry showing execution of net.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)'}], 'Footnotes': []}]}]}]}, {'Substep': '13.B.1', 'Procedure': "Empire: 'net use' via PowerShell", 'Techniques': [{'TechniqueId': 'T1049', 'TechniqueName': 'System Network Connections Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with a related ATT&CK Technique (Account Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'The vendor demonstrated to MITRE that the capability can provide telemetry of net.exe, but no screenshot was captured for this procedure.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with related ATT&CK Technique (Account Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because net use was part of additional malicious discovery performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-13.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net use was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-13.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating net use was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-13.B.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Network Connections Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-13.B.1-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-13.B.1-100.png', 'ScreenshotCaption': 'General Behavior alert for net.exe executing with the correct ATT&CK Tactic (System Network Connections Discovery) and Technique (Discovery)'}, {'ScreenshotName': 'CR-13.B.1-10.png', 'ScreenshotCaption': 'Process tree showing alerted net.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was triggered for enumerating Windows network admin shares as part of Discovery (tainted by parent alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-1.png', 'ScreenshotCaption': 'Specific Behavior alert for Discovery via network file share enumeration (tainted by parent alert)'}, {'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery), related ATT&CK Technique (Remote System Discovery), and correct Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with the correct ATT&CK Technique (T1049 - System Network Connections Discovery), a related ATT&CK Technique (Remote System Discovery), and the correct Tactic (Discovery). The enrichment was tainted by a parent alert. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-1.png', 'ScreenshotCaption': 'Specific Behavior alert for Discovery via network file share enumeration (tainted by parent alert)'}, {'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery), related ATT&CK Technique (Remote System Discovery), and correct Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe with command-line arguments (tainted by parent alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-1.png', 'ScreenshotCaption': 'Specific Behavior alert for Discovery via network file share enumeration (tainted by parent alert)'}, {'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery), related ATT&CK Technique (Remote System Discovery), and correct Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-13.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-13.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-13.B.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-13.B.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe with command-line arguments (tainted by the parent Script File Created alert).[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-13.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on wscript.exe', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe executing net.exe (tainted by parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-13.A.1-3.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-13.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of net.exe with command-line arguments'}, {'ScreenshotName': 'MS-13.B.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe with command-line arguments (tainted by parent PowerShell malicious cmdlet alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-13.A.1-3.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)'}, {'ScreenshotName': 'MS-13.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of net.exe with command-line arguments'}, {'ScreenshotName': 'MS-13.B.1-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-13.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-13-1.png', 'ScreenshotCaption': 'Telemetry showing execution of net.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of net.exe and command-line arguments (tainted Group ID not shown but was the search parameter)'}], 'Footnotes': []}]}]}]}, {'Substep': '13.B.2', 'Procedure': "Empire: 'netstat -ano' via PowerShell", 'Techniques': [{'TechniqueId': 'T1049', 'TechniqueName': 'System Network Connections Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe data with the correct ATT&CK Technique (T1049 - System Network Connections Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-13.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with netstat.exe and command-line arguments'}, {'ScreenshotName': 'CB-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing netstat.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-13.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with netstat.exe and command-line arguments'}, {'ScreenshotName': 'CB-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because netstat was part of additional malicious discovery performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-13.B.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing netstat.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating netstat was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed netstat.exe executing with command-line arguments. The process tree view showed netstat.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-13.B.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing netstat.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating netstat was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-13.B.2-10.png', 'ScreenshotCaption': 'Enrichment showing netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed netstat.exe executing with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-13.B.2-10.png', 'ScreenshotCaption': 'Enrichment showing netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe data with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of netstat.exe with command-line arguments (tainted by parent alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.G.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing netstat.exe with command-line arguments'}, {'ScreenshotName': 'CC-13.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing netstat.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.G.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing netstat.exe with command-line arguments'}, {'ScreenshotName': 'CC-13.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (netstat) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified netstat.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-13.B.2-1.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)'}, {'ScreenshotName': 'FE-13.B.2-1.png', 'ScreenshotCaption': 'Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of netstat.exe with command-line arguments (tainted by the parent Script File Created alert).[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-13.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing netstat.exe with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched netstat.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that the network protocol statistics were gathered.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe executing netstat.exe (tainted by parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of nestat.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that the network protocol statistics were gathered'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing netstat.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe executing netstat.exe (tainted by parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of nestat.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery) and a suspicious indicator that the network protocol statistics were gathered'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A delayed General Behavior alert was generated for "Suspicious sequence of exploration activities".', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-13.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)'}, {'ScreenshotName': 'MS-13.A.1-3.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)'}, {'ScreenshotName': 'MS-13.B.2-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing netstat.exe with command-line arguments'}], 'Footnotes': ['Alert is based on the correlation of a chain of related behaviors across multiple steps.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-13.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)'}, {'ScreenshotName': 'MS-13.A.1-3.png', 'ScreenshotCaption': 'Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)'}, {'ScreenshotName': 'MS-13.B.2-2.png', 'ScreenshotCaption': 'Process tree view of General Behavior alert on \\"Suspicious sequence of exploration activities\\" showing netstat.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing netstat with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-13.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing netstat with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure due to event suppression (previously detected).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of netstat.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of netstat.exe and command-line arguments (tainted Group ID not shown but was the search parameter)'}], 'Footnotes': []}]}]}]}, {'Substep': '13.C.1', 'Procedure': "Empire:ï¿½'reg query' via PowerShell to enumerate a specific Registry key", 'Techniques': [{'TechniqueId': 'T1012', 'TechniqueName': 'Query Registry', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe data with the correct ATT&CK Technique (Query Registry).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-13.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with reg.exe and command-line arguments'}, {'ScreenshotName': 'CB-13.C.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing reg.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-13.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with reg.exe and command-line arguments'}, {'ScreenshotName': 'CB-13.C.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert identifying reg.exe execution as suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-13.C.1-4.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-13.C.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-13.C.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating reg query was suspicious'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because reg query was part of additional malicious discovery performed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-13.C.1-4.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-13.C.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-13.C.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating reg query was suspicious'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-13.C.1-4.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-13.C.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating reg query was suspicious (tainted by previous powershell.exe detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-13.C.1-3.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating reg query was suspicious'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating reg query was part of additional malicious discovery activity (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-13.C.1-10.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of reg.exe with command-line arguments (tainted by parent alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-13-3.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.G.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-12.G.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-13.A.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified reg.exe as a reconnaissance command used. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-13.C.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-13.C.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-12.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of reg.exe with command-line arguments (tainted by the parent Script File Created alert).[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-13.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments (tainted by the parent Script File Created alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that reg.exe utility queried the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe executing reg.exe (tainted by parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that reg.exe utility queried the Registry'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg.exe. The telemetry was tainted by a trace detection on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe executing reg.exe (tainted by parent alert on wscript.exe)'}, {'ScreenshotName': 'MC-13.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that reg.exe utility queried the Registry'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of reg.exe with command-line arguments (tainted by suspicious sequence of exploration activities alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-13.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of reg.exe and command-line arguments'}, {'ScreenshotName': 'MS-13.C.1-2.png', 'ScreenshotCaption': 'Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-13.B.3-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-13.B.3-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-13.B.3-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-13.B.3-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of reg.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-13-1.png', 'ScreenshotCaption': 'Telemetry showing execution of reg.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of reg.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-13.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of reg.exe and command-line arguments (tainted Group ID not shown but was the search parameter)'}], 'Footnotes': []}]}]}]}, {'Substep': '14.A.1', 'Procedure': 'Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level', 'Techniques': [{'TechniqueId': 'T1088', 'TechniqueName': 'Bypass User Account Control', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a Specific Behavior was observed because a base64 obfuscated PowerShell command was used to invoke UAC bypass.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-14.A.1-9.png', 'ScreenshotCaption': 'Telemetry showing integrity level change through query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000)'}, {'ScreenshotName': 'CS-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing the Invoke-BypassUACTokenManipulation function'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating obfuscated PowerShell invoked UAC bypass (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an integrity level change through a query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000), which is indicative of bypassing UAC. Telemetry also showed the Invoke-BypassUACTokenManipulation function in the script.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-14.A.1-9.png', 'ScreenshotCaption': 'Telemetry showing integrity level change through query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000)'}, {'ScreenshotName': 'CS-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing the Invoke-BypassUACTokenManipulation function'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating obfuscated PowerShell invoked UAC bypass (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an integrity level change from medium to high for powershell.exe, which is indicative of\xa0bypass UAC. The telemetry was tainted by a parent Malicious use of PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-14.A.1-11.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing with medium process integrity (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-14.A.1-12.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing with high process integrity (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-14.A.1-13.png', 'ScreenshotCaption': 'Parent alert generated for malicious use of PowerShell'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a mismatch between the logon id (authentication id) of parent (powershell.exe - 312288) and child (powershell.exe - 10184789) processes indicating that a different token was used. Though no screenshot for this data is available, this information can be used to trace back to the logon event for that logon id to display the process integrity level indicative of the elevated token used for bypass UAC.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-14-2.png', 'ScreenshotCaption': 'Telemetry showing authentication (logon) ID mismatch between parent and child processes'}, {'ScreenshotName': 'EG-14-4.png', 'ScreenshotCaption': 'Telemetry showing svhost.exe seclogon event for token login id 0x9b6855 (10184789), used by the spawned powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-14.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent'}, {'ScreenshotName': 'CC-14.A.1-T1088-new.png', 'ScreenshotCaption': 'Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an elevated PowerShell spawned under the context of user Bob from an unelevated parent process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-14.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for a possible PowerShell privilege escalation based on the elevation of a child process from a non-elevated parent'}, {'ScreenshotName': 'CC-14.A.1-T1088-new.png', 'ScreenshotCaption': 'Telemetry showing an elevated PowerShell being spawned under the context of user Bob from an unelevated parent process'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of powershell.exe as a high integrity process as SYSTEM with a token login ID previously associated with user Bob, which indicates UAC bypassing. [FE6]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'FE-14.A.1-7.png', 'ScreenshotCaption': 'Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0x10530b3'}, {'ScreenshotName': 'FE-14.A.1-8.png', 'ScreenshotCaption': 'Telemetry showing group membership of token logon ID 0x10530b3 associated with user Bob, which includes S-1-16-12288 (High Mandatory Level)'}], 'Footnotes': [' A Configuration Change was made in order to collect Windows Event Logs for events 4627 (Group Membership Information) and 4673 (A privileged service was called).']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though an alert called "PowerShell executed encoded commands" triggered due to svchost.exe creating powershell.exe with the -enc command-line argument.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-14.A.1-1.png', 'ScreenshotCaption': 'Alert for encoded PowerShell (does not count as a detection)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a possible UAC bypass. The alert was tagged with the correct ATT&CK Technique (Bypass User Account Control) and Tactics (Defense Evasion, Privilege Escalation).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing an integrity level change for powershell.exe'}, {'ScreenshotName': 'MC-14.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a possible UAC bypass.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an integrity level change from medium (2) to high (3) for powershell.exe, which is indicative of bypass UAC.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing an integrity level change for powershell.exe'}, {'ScreenshotName': 'MC-14.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for a possible UAC bypass.'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of powershell.exe executing "Invoke-BypassUACTokenManipulation" Empire cmdlet under the context of user Bob with medium integrity level, execution of svchost.exe with seclogon flag to use impersonation service with new high integrity powershell.exe process as SYSTEM, and subsequent context adjustment of powershell.exe to user Bob (tainted by the parent alert for suspicious sequence of exploration activities).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-14.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing medium integrity powershell.exe process executing Invoke-BypassUACTokenManipulation as user Bob'}, {'ScreenshotName': 'MS-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing high integrity powershell.exe process as SYSTEM'}, {'ScreenshotName': 'MS-14.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing high integrity powershell.exe process as Bob'}, {'ScreenshotName': 'MS-14.A.1-5.png', 'ScreenshotCaption': 'Parent alert for \\"Suspicious sequence of exploration activities\\" showing powershell.exe process tainting this event'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying a PowerShell Empire script performing the bypass UAC attack.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-14.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running as medium integrity level (8192)'}, {'ScreenshotName': 'PA-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running as high integrity level (12288)'}, {'ScreenshotName': 'PA-14.A.1-3.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying a PowerShell Empire script performing the bypass UAC attack.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process integrity level change from parent powershell.exe (medium / 8192) to child powershell.exe (high / 12288).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-14.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running as medium integrity level (8192)'}, {'ScreenshotName': 'PA-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe running as high integrity level (12288)'}, {'ScreenshotName': 'PA-14.A.1-3.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying a PowerShell Empire script performing the bypass UAC attack.'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed process integrity levels changing from medium to high (tainted by parent alert).[SO4]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-14.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing process integrity level change from medium to high (tainted by relationship to threat story but Group ID not shown in this view)'}], 'Footnotes': ['Integrity level numbers are based upon how the capability tracks integrity levels and not how Windows tracks them causing a difference in values.']}]}]}]}, {'Substep': '14.A.1', 'Procedure': 'Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'The vendor demonstrated to MITRE that the capability can provide telemetry of network connections and file modifications indicating a Remote File Copy, but no screenshot was captured for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was observed because PowerShell retrieved the file wdbypass from www.freegoogleadsenseinfo.com (C2 domain) over port 8080.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating PowerShell retrieved the file wdbypass (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated based on the downloading and execution of wdbypass, identified as Fileless malware, from freegoogleadsenseinfo.com (C2 domain) over port 8080. The alert also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-14.A.1-40.png', 'ScreenshotCaption': 'Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080'}, {'ScreenshotName': 'CR-14.A.1-10.png', 'ScreenshotCaption': 'Specific Behavior alert for Download & execute of the wdbypass file'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing decoded PowerShell telemetry extracted from the command-line arguments showed a connection over port 8080 with a HTTP request to download wdbypass payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-14-1.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell with download request of wdbypass over port 8080'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell downloading a significant amount of data using HTTP(S).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass'}, {'ScreenshotName': 'CC-14.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass'}, {'ScreenshotName': 'CC-14.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell downloading a significant amount of data using HTTP(S)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a HTTP GET request for wdbypass with an alert for PowerShell URL Request (Weak Signal). The alert also was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactic (Command and Control).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-14.A.1-4.png', 'ScreenshotCaption': 'Enrichment of HTTP GET request for wdbypass with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy, and Tactic, Command and Control)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass (tainted by the parent "Powershell executed encoded commands" alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing port 8080 HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\"Powershell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-14.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing encoded PowerShell command that could be decoded outside the capability (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connection to 192.168.0.5 (C2 server) over port 8080 as well as decoded PowerShell making a connection over port 8080 with a HTTP request to download wdbypass payload. (tainted by alert on suspicious PowerShell command-line arguments).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-14.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080'}, {'ScreenshotName': 'MS-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-14.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-14-1.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '14.A.1', 'Procedure': 'Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP', 'Techniques': [{'TechniqueId': 'T1071', 'TechniqueName': 'Standard Application Layer Protocol', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-14.A.1-6.png', 'ScreenshotCaption': 'Telemetry showing encoded PowerShell command that decodes to show HTTP traffic (does not count as a detection)'}, {'ScreenshotName': 'CS-14.A.1-7.png', 'ScreenshotCaption': 'Decoded PowerShell (outside of capability) showing download request over HTTP (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for powershell.exe executed as a PowerShell downloader. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol). Data also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-14.A.1-40.png', 'ScreenshotCaption': 'Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080'}, {'ScreenshotName': 'CR-14.A.1-30.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing decoded PowerShell telemetry extracted from the command-line arguments showed a connection over port 8080 with a HTTP request to download wdbypass payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-14-1.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell with download request of wdbypass over port 8080'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a HTTP GET request with an alert for PowerShell URL Request (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1071 - Standard Application Layer Protocol) and Tactic (Command and Control).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-14.A.1-4.png', 'ScreenshotCaption': 'Enrichment of HTTP GET request with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass (tainted by the parent "Powershell executed encoded commands" alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing port 8080  HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\"Powershell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-14.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing encoded PowerShell command that could be decoded outside the capability (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a decoded PowerShell script invoked that created a web request to the C2 server with related data showing the connection was made (tainted by alert on suspicious PowerShell command-line arguments).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-14.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-14-1.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '14.A.1', 'Procedure': 'Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080', 'Techniques': [{'TechniqueId': 'T1043', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connection to 192.168.0.5 (C2 server) over TCP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-14.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing network connection to 192.168.0.5 (C2 server) over TCP port 8080'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a network connection event to 192.168.0.5 (C2 server) on TCP port 8080 that was associated with the encoded PowerShell IEX command.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-14.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing IEX connection over to 192.168.0.5 (C2 server) on TCP port 8080'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for powershell.exe executed as a PowerShell downloader. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port). Data also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-14.A.1-30.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-14.A.1-40.png', 'ScreenshotCaption': 'Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection over port 8080. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-14.A.1-30.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe mapped to the correct ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-14.A.1-40.png', 'ScreenshotCaption': 'Specific Behavior alert showing decoded PowerShell with download request of wdbypass over HTTP port 8080'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert for Command and Control was triggered because of PowerShell making a connection over TCP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-14-3.png', 'ScreenshotCaption': 'General Behavior alert for Command and Control associated with network traffic from PowerShell over TCP port 8080'}, {'ScreenshotName': 'EG-14-1.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell with download request of wdbypass over port 8080'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing decoded PowerShell telemetry extracted from the command-line arguments showed a connection over port 8080 with a HTTP request to download wdbypass payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-14-3.png', 'ScreenshotCaption': 'General Behavior alert for Command and Control associated with network traffic from PowerShell over TCP port 8080'}, {'ScreenshotName': 'EG-14-1.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell with download request of wdbypass over port 8080'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire instance communicated with freegoogleadsenseinfo.com (C2 domain) over port 8080.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)'}, {'ScreenshotName': 'FE-14.A.1-9.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)'}, {'ScreenshotName': 'FE-11.B.1-4.png', 'ScreenshotCaption': 'Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to freegoogleadsenseinfo.com (C2 domain) over TCP port 8080. The telemetry was tainted by the parent PowerShell URL Request (Weak Signal) alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)'}, {'ScreenshotName': 'FE-14.A.1-9.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)'}, {'ScreenshotName': 'FE-11.B.1-4.png', 'ScreenshotCaption': 'Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an HTTP GET request over port 8080 to freegoogleadsenseinfo.com (C2 domain) for the file wdbypass (tainted by the parent "Powershell executed encoded commands" alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing port 8080 HTTP GET request to C2 domain for file wdbypass (tainted by the parent \\"Powershell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a network connection to 192.168.0.5 (C2 server) over TCP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing a network connection to 192.168.0.5 (C2 server) over TCP port 8080'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to 192.168.0.5 (C2 server) on port 8080 was made (tainted by alert on suspicious PowerShell command-line arguments).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-14.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080'}, {'ScreenshotName': 'MS-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an outgoing network connection to www.freegoogleadsenseinfo.com (C2 domain) over port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-14.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing an outgoing network connection to www.freegoogleadsenseinfo.com (C2 domain) over port 8080'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connection to 192.168.0.5 (C2 server) over port 8080. Though it does not count as a detection, telemetry also showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-14-2.png', 'ScreenshotCaption': 'Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080'}, {'ScreenshotName': 'RSA-14-1.png', 'ScreenshotCaption': 'Telemetry of decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connections over port 8080. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-14.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing network connections over port 8080 in the filter (tainted by relationship to threat story but Group ID not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '15.A.1', 'Procedure': 'Empire: Built-in keylogging module executed to capture keystrokes of user Bob', 'Techniques': [{'TechniqueId': 'T1056', 'TechniqueName': 'Input Capture', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the events with a tag titled \\"PowerShell Input Capture -keylogger\\" based on known modloads that could be potentially abused to provide keylogger functionality.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-15.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing modloads associated with keylogger'}, {'ScreenshotName': 'CB-15.A.1-3.png', 'ScreenshotCaption': 'Enrichment of data with tag \\"PowerShell Input Capture -keylogger\\"'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed modloads associated with the execution of a keylogger.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-15.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing modloads associated with keylogger'}, {'ScreenshotName': 'CB-15.A.1-3.png', 'ScreenshotCaption': 'Enrichment of data with tag \\"PowerShell Input Capture -keylogger\\"'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was identified because they observed the adversary logging keystrokes based on the GetKeystrokes PowerShell function.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-15.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell script containing the function Get-Keystrokes'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating keylogging activity occurred (Specific Behavior)'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the decoded PowerShell script, which displayed the function Get-Keystrokes.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-15.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell script containing the function Get-Keystrokes'}, {'ScreenshotName': 'CS-E-8.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating keylogging activity occurred (Specific Behavior)'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated based on the execution of a malicious command in PowerShell named Get-Keystrokes.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-15.A.1-20.png', 'ScreenshotCaption': 'Indicator of Compromise alert for Malicious Command Get-Keystrokes'}, {'ScreenshotName': 'CR-15.A.1-100.png', 'ScreenshotCaption': 'Telemetry showing modloads associated with a keylogger'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed modloads associated with the execution of a keylogger.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-15.A.1-20.png', 'ScreenshotCaption': 'Indicator of Compromise alert for Malicious Command Get-Keystrokes'}, {'ScreenshotName': 'CR-15.A.1-100.png', 'ScreenshotCaption': 'Telemetry showing modloads associated with a keylogger'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the capability pulled PowerShell Script Block logs from the host to show the execution of Get-KeyStrokes.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-15-1.png', 'ScreenshotCaption': 'Telemetry showing PowerShell Script Block logging with execution of Get-KeyStrokes (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe with a tag indicating .NET keylogging.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-15.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing the GetAsyncKeyState method'}, {'ScreenshotName': 'CC-15.B.1-3.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with a tag indicating .NET keylogging'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the GetAsyncKeyState method, indicating keylogging.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-15.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing the GetAsyncKeyState method'}, {'ScreenshotName': 'CC-15.B.1-3.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with a tag indicating .NET keylogging'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the capability detected PowerShell activity during the time of the keylogging.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-15.A.1-1.png', 'ScreenshotCaption': 'PowerShell activity during the time of the keylogging (does not count as detection)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT30]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['The vendor noted the capability can create a new condition that would track all actions on a certain file of interest. Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A delayed Specific Behavior alert was generated on keylogging activity in powershell.exe.', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-15.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing keylogger events'}, {'ScreenshotName': 'MS-15.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of Get-Keystrokes cmdlet'}, {'ScreenshotName': 'MS-15.A.1-5.png', 'ScreenshotCaption': 'Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)'}, {'ScreenshotName': 'MS-15.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for keylogging activity from powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making API calls consistent with keylogger behavior. Telemetry also showed execution of Get-Keystrokes Empire PowerShell cmdlet (tainted by alert on PowerShell script with suspicious content).[MS15]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-15.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing keylogger events'}, {'ScreenshotName': 'MS-15.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of Get-Keystrokes cmdlet'}, {'ScreenshotName': 'MS-15.A.1-5.png', 'ScreenshotCaption': 'Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)'}, {'ScreenshotName': 'MS-15.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for keylogging activity from powershell.exe'}], 'Footnotes': [' Vendor stated that Input Capture telemetry is captured but it was not immediately visible in the portal. Vendor made changes to the portal during the test to enable by default the visibility of these events.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of a specific API call as keylogging and suspicious activity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-15.A.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of a specific API call as keylogging and suspicious activity'}, {'ScreenshotName': 'PA-15.A.1-2.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window'}], 'Footnotes': []}, {'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying a PowerShell Empire script logging keys pressed, time, and the active window.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-15.A.1-1.png', 'ScreenshotCaption': 'Enrichment of the execution of a specific API call as keylogging and suspicious activity'}, {'ScreenshotName': 'PA-15.A.1-2.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched data collected as keylogging behavior that was not visible through the standard interface during the evaluation. [SO5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-15.A.1-1.png', 'ScreenshotCaption': 'Enrichment of use of GetAsyncKeyStateApi tagged as a keylogger (tainted by relationship to threat story but Group ID not shown in this view)'}], 'Footnotes': [' The capability associated the keylogging event to the parent Group ID even though it is not visible in the data provided.']}]}]}]}, {'Substep': '15.A.1', 'Procedure': 'Empire: Built-in keylogging module included residual enumeration of application windows', 'Techniques': [{'TechniqueId': 'T1010', 'TechniqueName': 'Application Window Discovery', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the decoded PowerShell script, which displayed the API call GetForegroundWindow to enumerate the active window.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-15.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the GetForegroundWindow method.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-15.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing the GetForegroundWindow method'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise alert was generated identifying a PowerShell Empire script logging keys pressed, time, and the active window.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-15.A.1-2.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window'}, {'ScreenshotName': 'PA-15.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the decoded PowerShell script, which includes the API call GetForegroundWindow to enumerate the active window.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-15.A.1-2.png', 'ScreenshotCaption': 'Indicator of Compromise alert identifying a PowerShell Empire script logging keys pressed, time, and the active window'}, {'ScreenshotName': 'PA-15.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing decoded PowerShell script containing the API call GetForegroundWindow'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '15.B.1', 'Procedure': "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", 'Techniques': [{'TechniqueId': 'T1081', 'TechniqueName': 'Credentials in Files', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because IT_tasks.txt was retrieved from a network share as a file of interest.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)'}, {'ScreenshotName': 'CS-15.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing file read event for IT_tasks.txt'}, {'ScreenshotName': 'CS-15.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing FsPostOpen event for IT_tasks.txt'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file read event for IT_tasks.txt by powershell.exe as well as a FsPostOpen event indicating IT_tasks.txt was opened.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating IT_tasks.txt was retrieved as a file of interest (General Behavior)'}, {'ScreenshotName': 'CS-15.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing file read event for IT_tasks.txt'}, {'ScreenshotName': 'CS-15.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing FsPostOpen event for IT_tasks.txt'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. [EG1]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': [' Had malicious access to it_tasks been detected, response actions allow file retrieval which could have identified credentials in files.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the Get-Content cmdlet on IT_tasks.txt.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-15.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing the Get-Content cmdlet on IT_tasks.txt'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry was available that showed execution of Get-Content PowerShell cmdlet. Data does not show what file the cmdlet was executed on.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-15.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing "Get-Content" cmdlet (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file read event for IT_tasks.txt.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-15.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a file read event for IT_tasks.txt'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '16.A.1', 'Procedure': "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of usersï¿½Kmitnick, Bob, and Frieda", 'Techniques': [{'TechniqueId': 'T1110', 'TechniqueName': 'Brute Force', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched individual net.exe events with tagging titled \\"Credential Access using Admin Shares - Failed Attempts\\". [CB8]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'CB-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with four different net.exe logon attempts'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Enrichment of the individual net.exe logon attempts with tag \\"Credential Access using Admin Shares - Failed Attempts\\"'}], 'Footnotes': ['The capability was modified after the start of the evaluation enabling enrichment to appear, so the detection is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing repeated logon attempts via net.exe and command-line arguments indicative of password spraying.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with four different net.exe logon attempts'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Enrichment of the individual net.exe logon attempts with tag \\"Credential Access using Admin Shares - Failed Attempts\\"'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated General Behavior alerts indicating the net use commands were suspicious. The alerts were tainted by a parent powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts'}, {'ScreenshotName': 'CS-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)'}, {'ScreenshotName': 'CS-16.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)'}, {'ScreenshotName': 'CS-16.A.1-2.png', 'ScreenshotCaption': 'Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally using several accounts.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts'}, {'ScreenshotName': 'CS-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)'}, {'ScreenshotName': 'CS-16.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)'}, {'ScreenshotName': 'CS-16.A.1-2.png', 'ScreenshotCaption': 'Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying, including details that the logons were for local admin (type 6) and that they failed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts'}, {'ScreenshotName': 'CS-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing details for the logon attempt into the 10.0.1.4 (Morris) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)'}, {'ScreenshotName': 'CS-16.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing details for the logon attempt into the 10.0.1.6 (Nimda) showing UserLogonFlags_decimal is equal to 6 (attempt for local admin) and UserLogonFailed (no distinction between authentication failure and authorization failure)'}, {'ScreenshotName': 'CS-16.A.1-2.png', 'ScreenshotCaption': 'Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe execution with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.A.1-10.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-20.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.A.1-10.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-20.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched each individual net.exe logon attempt with a tag titled Lateral Movement via \\"Mounting Hidden Shares\\" (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-1.png', 'ScreenshotCaption': 'Enrichment of each net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe connection events with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-1.png', 'ScreenshotCaption': 'Enrichment of each net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-1.png', 'ScreenshotCaption': 'Enrichment of each net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched multiple occurrences of net.exe usage as indicative of brute forcing a remote system as well as the correct ATT&CK Technique ID (Brute Force). [CC3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts'}], 'Footnotes': ['Screenshot is not available due to sensitivity of rule logic.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The Managed Defense Report indicated a General Behavior occurred because it identified that the attacker attempted to access systems using four accounts.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-4.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing failed logon attempt for Kmitnick'}, {'ScreenshotName': 'FE-16.A.1-6.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched repeated logon attempts via net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1077 - Windows Admin Share) and Tactic (Lateral Movement). \xa0The four events were included under the same alert and each of the passwords were redacted by the capability. [FE10]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-4.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing failed logon attempt for Kmitnick'}, {'ScreenshotName': 'FE-16.A.1-6.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)'}], 'Footnotes': [' The vendor indicated the un-redacted passwords could be observed in triage/acquistion data.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the logon failure from Kmitnick by searching for Windows Security Log Event ID 4625. [FE3]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'FE-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-4.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing failed logon attempt for Kmitnick'}, {'ScreenshotName': 'FE-16.A.1-6.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)'}], 'Footnotes': [' A configuration change was made to allow for the capture of Windows Security Event ID 4625.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched each individual net.exe logon attempt with the condition \xa0\\"Net User Reconnaissance Command\\". The enrichment was tainted by the parent \\"Powershell executed remote commands\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed encoded commands\\" alert)'}, {'ScreenshotName': 'CT-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed encoded commands\\" alert)'}, {'ScreenshotName': 'CT-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Bob (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed encoded commands\\" alert)'}, {'ScreenshotName': 'CT-16.A.1-4.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Frieda (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for powershell.exe performing a potential brute force password hack via the net utility.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing repeated logon attempts via net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing repeated logon attempts via net.exe. The telemetry was tainted by a trace detection on powershell.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing repeated logon attempts via net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS16]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-4.png', 'ScreenshotCaption': 'Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server'}, {'ScreenshotName': 'MS-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for brute force attempt to remote SMB shares'}, {'ScreenshotName': 'MS-16.A.1-5.png', 'ScreenshotCaption': 'System access history from CodeRed to Nimda and Morris'}], 'Footnotes': ['The alert spans multiple login attempts.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed failed authorization attempts due to bad passwords as indicated by a fallback request over WebDAV to port 80 on the C2 server, but did not indicate the two failed access attempts on Morris and Conficker that were due to the accounts having insufficient access on the systems.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-4.png', 'ScreenshotCaption': 'Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server'}, {'ScreenshotName': 'MS-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for brute force attempt to remote SMB shares'}, {'ScreenshotName': 'MS-16.A.1-5.png', 'ScreenshotCaption': 'System access history from CodeRed to Nimda and Morris'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for sensitive administrative shares mapping with unexpected parent.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local Kmitnick (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for a sensitive administrative shares mapping with unexpected parent'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local Kmitnick (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for a sensitive administrative shares mapping with unexpected parent'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-1.png', 'ScreenshotCaption': 'Telemetry showing logon attempts via net.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts and corresponding exit codes'}, {'ScreenshotName': 'S1-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.A.1', 'Procedure': 'Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)', 'Techniques': [{'TechniqueId': 'T1077', 'TechniqueName': 'Windows Admin Shares', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'Specific Behavior alerts titled "Windows Admin Shares - Lateral Movement" were generated for credential accesses specifically targeting admin shares.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$'}, {'ScreenshotName': 'CB-16.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alerts for of the 4 different net.exe logon attempts'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing repeated logon attempts via net.exe targeting ADMIN$.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$'}, {'ScreenshotName': 'CB-16.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alerts for of the 4 different net.exe logon attempts'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated General Behavior alerts indicating the net use commands attempting logon to ADMIN$ shares were suspicious. The alerts were tainted by a parent powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.A.1-2.png', 'ScreenshotCaption': 'Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net use logon attempts to ADMIN$ shares'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.A.1-2.png', 'ScreenshotCaption': 'Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net use logon attempts to ADMIN$ shares'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe with command-line arguments targeting ADMIN$ shares on the machines 10.0.1.4 (Morris) and 10.0.1.6 (Nimda).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-16.A.1-2.png', 'ScreenshotCaption': 'Process tree view of OverWatch General Behavior alerts indicating net.exe commands were suspicious (net.exe command details not specifically shown, tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net use logon attempts to ADMIN$ shares'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.A.1-10.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-20.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments.[CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.A.1-10.png', 'ScreenshotCaption': 'Enrichment of net.exe execution with related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Frieda with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.A.1-20.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Bob with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was triggered for each individual net.exe connection with a tag titled Lateral Movement via "Mounting Hidden Shares" (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-1.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares, associated with each net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe connection events with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-1.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares, associated with each net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-1.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares, associated with each net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'Specific Behavior alerts were generated for net.exe connecting to a remote administrative share.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net use logon attempts to ADMIN$ shares'}, {'ScreenshotName': 'CC-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alerts for net.exe connecting to a remote administrative share'}, {'ScreenshotName': 'CC-16.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net use logon attempts to ADMIN$ shares'}, {'ScreenshotName': 'CC-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alerts for net.exe connecting to a remote administrative share'}, {'ScreenshotName': 'CC-16.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net use logon attempts to ADMIN$ shares'}, {'ScreenshotName': 'CC-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alerts for net.exe connecting to a remote administrative share'}, {'ScreenshotName': 'CC-16.A.1-99.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement). The four events were included under the same alert.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Frieda'}, {'ScreenshotName': 'FE-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Bob'}, {'ScreenshotName': 'FE-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick'}, {'ScreenshotName': 'FE-16.A.1-4.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched individual net.exe logon attempts targeting ADMIN$ with the condition \\"Net User Reconnaissance Command\\". The enrichment was tainted by the parent \\"Powershell executed remote commands\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.A.1-1.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed encoded commands\\" alert)'}, {'ScreenshotName': 'CT-16.A.1-2.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed encoded commands\\" alert)'}, {'ScreenshotName': 'CT-16.A.1-3.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Bob (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed encoded commands\\" alert)'}, {'ScreenshotName': 'CT-16.A.1-4.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Frieda (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing repeated logon attempts targeting ADMIN$ via net.exe. The telemetry was tainted by a trace detection on powershell.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing repeated logon attempts targeting ADMIN$ via net.exe (tainted by a parent alert on powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS16]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-4.png', 'ScreenshotCaption': 'Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server'}, {'ScreenshotName': 'MS-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for brute force attempt to remote SMB shares'}], 'Footnotes': ['The alert spans multiple login attempts.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts to ADMIN$ via net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed failed authorization attempts due to bad passwords as indicated by a fallback request over WebDAV to port 80 on the C2 server, but did not indicate the two failed access attempts on Morris and Conficker that were due to the accounts having insufficient access on the systems.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-4.png', 'ScreenshotCaption': 'Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server'}, {'ScreenshotName': 'MS-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for brute force attempt to remote SMB shares'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a net.exe logon attempt to ADMIN$. The alert was tagged with the correct ATT&CK Technique (Windows Admin Shares).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local user Kmitnick (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for a net.exe logon attempt to ADMIN$ tagged with the correct ATT&CK Technique (Windows Admin Shares)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Frieda (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) as domain user Bob (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) as local user Kmitnick (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for a net.exe logon attempt to ADMIN$ tagged with the correct ATT&CK Technique (Windows Admin Shares)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-1.png', 'ScreenshotCaption': 'Telemetry showing logon attempts targeting ADMIN$ via net.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts targeting ADMIN$ (tainted by relationship to threat story)'}, {'ScreenshotName': 'S1-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts targeting ADMIN$ and corresponding exit codes'}], 'Footnotes': []}]}]}]}, {'Substep': '16.B.1', 'Procedure': "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", 'Techniques': [{'TechniqueId': 'T1078', 'TechniqueName': 'Valid Accounts', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing a successful logon via net.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with five different net.exe logon attempts, including a success'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing successful logon via net.exe'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating the successful net use connection was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing successful net.exe connection using valid credentials of Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)'}, {'ScreenshotName': 'CS-16.B.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a parent powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing successful net.exe connection using valid credentials of Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)'}, {'ScreenshotName': 'CS-16.B.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a logon attempt via net.exe, using the valid credentials of user Kmitnick, with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.B.1-20.png', 'ScreenshotCaption': 'Enrichment of a logon attempt via net.exe using the valid credentials of user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.B.1-20.png', 'ScreenshotCaption': 'Enrichment of a logon attempt via net.exe using the valid credentials of user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe connection events with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the net.exe connection using valid credentials for Kmitnick with a tag titled Lateral Movement via \\"Mounting Hidden Shares\\" (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials for user Kmitnick (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick. Telemetry also showed a logon event for user Kmitnick on Conficker (10.0.0.5).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt'}, {'ScreenshotName': 'CC-16.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing a logon event for user Kmitnick on Conficker (10.0.0.5)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a logon attempt via net.exe using valid credentials for user Kmitnick with an alert for Net Use Command Execution (Weak Signal). The password for Kmitnick was redacted within the capability. [FE10]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.B.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert'}, {'ScreenshotName': 'FE-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing successful logon of user Kmitnick'}], 'Footnotes': [' The vendor indicated the un-redacted passwords could be observed in triage/acquistion data.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the successful logon for the user Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.B.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert'}, {'ScreenshotName': 'FE-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing successful logon of user Kmitnick'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick. The telemetry was tainted by the parent "Powershell executed remote commands" alert. Telemetry also showed explorer.exe (as the user Bob) write a PIPE on Conficker, which could indicate to an analyst that the share had been successfully mounted.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (tainted by the parent \\"Powershell executed remote commands\\" alert)'}, {'ScreenshotName': 'CT-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\"FileExts Registry Key modified\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to login using the valid credentials of user Kmitnick. The telemetry was tainted by a trace detection on powershell.exe. Telemetry also showed a login event on Conficker (10.0.0.5) for user Kmitnick.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing a login event on Conficker (10.0.0.5) for user Kmitnick'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick (tainted by parent alert on PowerShell script with suspicious content). Telemetry showed Kmitnick login event on 10.0.0.5 (Conficker) and that 10.0.1.5 (CodeRed) accessed resources on 10.0.0.5 (Conficker).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing user Kmitnick login activity on 10.0.0.5 (Conficker)'}, {'ScreenshotName': 'MS-16.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing 10.0.1.5 (CodeRed) system accessed resources on 10.0.0.5 (Conficker)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched an lsass.exe event with the correct ATT&CK Technique (Valid Accounts).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.B.1-3.png', 'ScreenshotCaption': 'Enrichment of an lsass.exe event with the correct ATT&CK Technique (Valid Accounts).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick followed by an event for the credentials being validated by the DC. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.B.1-3.png', 'ScreenshotCaption': 'Enrichment of an lsass.exe event with the correct ATT&CK Technique (Valid Accounts).'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-2.png', 'ScreenshotCaption': 'Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt using valid credentials of user Kmitnick via net.exe and command-line arguments (tainted by relationship to threat story). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts, the last of which using valid credentials for user Kmitnick (tainted by relationship to threat story)'}, {'ScreenshotName': 'S1-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts and corresponding exit codes'}], 'Footnotes': []}]}]}]}, {'Substep': '16.B.1', 'Procedure': 'Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)ï¿½', 'Techniques': [{'TechniqueId': 'T1077', 'TechniqueName': 'Windows Admin Shares', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'Specific Behavior alerts were generated mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing repeated logon attempts via net.exe targeting ADMIN$, eventually resulting in a successful logon.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating the successful net use connection to ADMIN$ was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)'}, {'ScreenshotName': 'CS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)'}, {'ScreenshotName': 'CS-16.B.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)'}, {'ScreenshotName': 'CS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)'}, {'ScreenshotName': 'CS-16.B.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to connect to ADMIN$ on 10.0.0.5 (Conficker) as the user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)'}, {'ScreenshotName': 'CS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing successful net use connection to ADMIN$ (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)'}, {'ScreenshotName': 'CS-16.B.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating successful net use connection to ADMIN$ was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.B.1-20.png', 'ScreenshotCaption': 'Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments.[CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.B.1-20.png', 'ScreenshotCaption': 'Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was triggered for each individual net.exe connection with a tag titled Lateral Movement via "Mounting Hidden Shares" (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe connection events with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed logon attempt targeting ADMIN$ via net.exe and command-line arguments. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'Specific Behavior alerts were generated for net.exe connecting to a remote administrative share.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net use logon attempt to ADMIN$ shares'}, {'ScreenshotName': 'CC-16.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for net.exe connecting to a remote administrative share'}, {'ScreenshotName': 'CC-16.B.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net use logon attempt to ADMIN$ shares'}, {'ScreenshotName': 'CC-16.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for net.exe connecting to a remote administrative share'}, {'ScreenshotName': 'CC-16.B.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net use logon attempt to ADMIN$ shares'}, {'ScreenshotName': 'CC-16.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for net.exe connecting to a remote administrative share'}, {'ScreenshotName': 'CC-16.B.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker accessed Conficker by mounting the ADMIN$ share. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-16.B.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.B.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a logon attempt via net.exe with an alert for Net Use Command Execution (Weak Signal). The alert details showed net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick. The alert was also tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.B.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-16.B.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick. Telemetry also showed explorer.exe (as the user Bob) write a PIPE on Conficker, which could indicate to an analyst that the share had been successfully mounted (tainted by the parent FileExts Registry Key modified alert).[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (tainted by the parent \\"Powershell executed remote commands\\" alert)'}, {'ScreenshotName': 'CT-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\"FileExts Registry Key modified\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the net utility executed to authenticate to a remote admin share with valid accounts. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the net utility executed to authenticate to a remote admin share with valid accounts, tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe to ADMIN$ with command-line arguments to login using the valid credentials of user Kmitnick. The telemetry was tainted by a trace detection on powershell.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the net utility executed to authenticate to a remote admin share with valid accounts, tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS17]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for brute force attempt to remote SMB shares'}], 'Footnotes': ['The alert spans multiple login attempts.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for brute force attempt to remote SMB shares'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local Kmitnick. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local user Kmitnick (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe and command-line arguments targeting ADMIN$ via net.exe and command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-2.png', 'ScreenshotCaption': 'Telemetry showing logon attempt targeting ADMIN$ via net.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe and command-line arguments targeting ADMIN$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts and corresponding exit codes'}, {'ScreenshotName': 'S1-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt targeting ADMIN$ (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.B.1', 'Procedure': 'Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying', 'Techniques': [{'TechniqueId': 'T1110', 'TechniqueName': 'Brute Force', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched individual net.exe events with tagging titled \\"Credential Access using Admin Shares - Failed Attempts\\" for failures as well as a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons. [CB8]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'CB-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with five different net.exe logon attempts, including a success'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)'}], 'Footnotes': ['The capability was modified after the start of the evaluation enabling enrichment to appear, so the detection is identified as a configuration change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with five different net.exe logon attempts, including a success'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating the successful net use connection was suspicious. The alert was tainted by a parent powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.B.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)'}, {'ScreenshotName': 'CS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)'}], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally using several accounts.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.B.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)'}, {'ScreenshotName': 'CS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments to connect as the user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a parent powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.B.1-2.png', 'ScreenshotCaption': 'OverWatch General Behavior alert indicating successful net use connection by Kmitnick was suspicious (would be tainted by previous powershell.exe detection by orange line indicating medium severity in process tree view that is not shown)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally (General Behavior)'}, {'ScreenshotName': 'CS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing successful net.exe connection by Kmitnick (tainted by previous powershell.exe detection by red line indicating high severity. The vendor noted the process tree view and severities change as detections occur.)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe execution with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.B.1-20.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.B.1-20.png', 'ScreenshotCaption': 'Enrichment of net.exe execution showing logon attempts for the user Kmitnick with related ATT&CK Technique (Windows Admin Shares) and Tactic (Lateral Movement) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched each individual net.exe connection with a tag titled Lateral Movement via \\"Mounting Hidden Shares\\" (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection with \\"Mounting Hidden Share\\" and Lateral Movement tags (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-4.png', 'ScreenshotCaption': 'Telemetry showing event tree with all 5 net commands associated with brute force failures and eventual success (tainted by parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe connection events with a related ATT&CK Technique (T1077 - Windows Admin Shares) and \xa0Tactics (Execution, Lateral Movement). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection with \\"Mounting Hidden Share\\" and Lateral Movement tags (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-4.png', 'ScreenshotCaption': 'Telemetry showing event tree with all 5 net commands associated with brute force failures and eventual success (tainted by parent PowerShell alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-3.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection with \\"Mounting Hidden Share\\" and Lateral Movement tags (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-4.png', 'ScreenshotCaption': 'Telemetry showing event tree with all 5 net commands associated with brute force failures and eventual success (tainted by parent PowerShell alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched multiple occurrences of net.exe usage as indicative of brute forcing a remote system as well as the correct ATT&CK Technique ID (Brute Force). [CC3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt'}], 'Footnotes': ['Screenshot is not available due to sensitivity of rule logic.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing successful logon of user Kmitnick'}, {'ScreenshotName': 'FE-16.B.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the successful logon for the user Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing successful logon of user Kmitnick'}, {'ScreenshotName': 'FE-16.B.1-1.png', 'ScreenshotCaption': 'Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a net.exe logon attempt targeting ADMIN$ with the condition \\"Net User Reconnaissance Command\\". The enrichment was tainted by the parent \\"Powershell executed remote commands\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\"FileExts Registry Key modified\\" alert)'}, {'ScreenshotName': 'CT-16.B.1-1.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry also showed explorer.exe (as the user Bob) write a PIPE on Conficker, which could indicate to an analyst that the share had been successfully mounted (tainted by the parent FileExts Registry Key modified alert).[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe writing \\\\\\\\conficker\\\\PIPE\\\\srvsvc (tainted by the parent \\"FileExts Registry Key modified\\" alert)'}, {'ScreenshotName': 'CT-16.B.1-1.png', 'ScreenshotCaption': 'Enrichment showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with the account Kmitnick (enriched with condition \\"Net User Reconnaissance Command\\", tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for powershell.exe performing a potential brute force password hack via the net utility.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to login using the valid credentials of user Kmitnick. The telemetry was tainted by a trace detection on powershell.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing a logon attempt via net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for powershell.exe performing a potential brute force password hack via the net utility'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS17]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'MS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for brute force attempt to remote SMB shares'}], 'Footnotes': ['The alert spans multiple login attempts.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying, eventually resulting in a successful logon (tainted by parent alert on PowerShell script with suspicious content).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert for brute force attempt to remote SMB shares'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local user Kmitnick followed by an event for the credentials being validated by the DC. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing an event for the logon credentials being validated by the DC (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local Kmitnick (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-2.png', 'ScreenshotCaption': 'Telemetry showing logon attempts via net.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts and corresponding exit codes'}, {'ScreenshotName': 'S1-16.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempts (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.C.1', 'Procedure': "Empire: 'net use -delete' via PowerShell", 'Techniques': [{'TechniqueId': 'T1126', 'TechniqueName': 'Network Share Connection Removal', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated indicating that a connected network share was removed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with net.exe and command-line arguments'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for removing connected network share'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing net.exe and command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with net.exe and command-line arguments'}, {'ScreenshotName': 'CB-16.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for removing connected network share'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because the user Bob removed an artifact for the ADMIN$ share.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating they observed ADMIN$ artifact removed (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments. The telemetry was tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing net.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating they observed ADMIN$ artifact removed (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.C.1-10.png', 'ScreenshotCaption': 'General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments.[CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.C.1-10.png', 'ScreenshotCaption': 'General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a event tree containing net.exe and command-line arguments (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-5.png', 'ScreenshotCaption': 'Telemetry showing event tree containing net.exe and command-line argument (tainted by parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker unmounted the share from CodeRed. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showed net.exe executing with command-line arguments.'}, {'ScreenshotName': 'FE-16.B.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showed net.exe executing with command-line arguments.'}, {'ScreenshotName': 'FE-16.B.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments (tainted by the parent "Powershell executed remote commands" alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe and command-line arguments (tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the net utility removing a shared connection via PowerShell. The alert was tagged with the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the net utility removing a shared connection via PowerShell, tagged to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on powershell.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the net utility removing a shared connection via PowerShell, tagged to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.C.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.C.1-2.png', 'ScreenshotCaption': 'Enrichment of net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe execution and command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-3.png', 'ScreenshotCaption': 'Telemetry showing net.exe execution and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe and command-line arguments (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.D.1', 'Procedure': 'Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)', 'Techniques': [{'TechniqueId': 'T1077', 'TechniqueName': 'Windows Admin Shares', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'Specific Behavior alerts were generated mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with successful net.exe logon targeting C$'}, {'ScreenshotName': 'CB-16.D.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments \xa0targeting C$ using valid account credentials.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with successful net.exe logon targeting C$'}, {'ScreenshotName': 'CB-16.D.1-2.png', 'ScreenshotCaption': 'Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)'}, {'ScreenshotName': 'CS-16.D.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree containing successful net use connection to C$ (tainted by previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to the C$ share on 10.0.0.4 (Creeper) as the user Kmitnick. The telemetry was tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating Bob attempted to move laterally to access network resources (General Behavior)'}, {'ScreenshotName': 'CS-16.D.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree containing successful net use connection to C$ (tainted by previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.D.1-100.png', 'ScreenshotCaption': 'Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.D.1-10.png', 'ScreenshotCaption': 'Process tree showing alert net.exe execution (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments.[CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.D.1-100.png', 'ScreenshotCaption': 'Specific Behavior alert of net.exe execution with correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.D.1-10.png', 'ScreenshotCaption': 'Process tree showing alert net.exe execution (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was triggered for each individual net.exe connection with a tag titled Lateral Movement via "Mounting Hidden Shares" (tainted by parent PowerShell alert). The alert was also tagged with \xa0the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) .', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-6.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt tagged with  correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe connection events with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-6.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt tagged with  correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed logon attempt targeting C$ via net.exe and command-line arguments. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-6.png', 'ScreenshotCaption': 'Specific Behavior alert for Mounting Hidden Shares for the successful net.exe connection attempt tagged with  correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) (tainted by parent PowerShell alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.C.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.C.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (net) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker mounted the C$ drive on creeper with the kmitnick account. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-16.D.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)'}, {'ScreenshotName': 'FE-16.D.1-1.png', 'ScreenshotCaption': 'Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net1.exe with an alert for Net Use Command Execution (Weak Signal). The alert also was tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.D.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)'}, {'ScreenshotName': 'FE-16.D.1-1.png', 'ScreenshotCaption': 'Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. [CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the net utility executed to authenticate to a remote admin share with valid accounts. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.D.1-9.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.D.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for the net utility removing a shared connection via PowerShell, mapped to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on powershell.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.D.1-9.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)'}, {'ScreenshotName': 'MC-16.D.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for the net utility removing a shared connection via PowerShell, mapped to the correct ATT&CK Tactic (Defense Evasion) and Technique (Network Share Connection Removal)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe and command-line arguments targeting C$ via net.exe and command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-4.png', 'ScreenshotCaption': 'Telemetry showing logon attempt targeting C$ via net.exe and command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe and command-line arguments targeting C$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt targeting C$ (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.D.1', 'Procedure': "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", 'Techniques': [{'TechniqueId': 'T1078', 'TechniqueName': 'Valid Accounts', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments using valid account credentials.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with logon using valid account credentials'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments to the C$ share on Creeper as the user Kmitnick. The process tree view showed net.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.D.1-2.png', 'ScreenshotCaption': 'Telemetry showing successful net use connection by Kmitnick in the process tree view (tainted by previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.D.1-10.png', 'ScreenshotCaption': 'General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe executing with command-line arguments.[CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.D.1-10.png', 'ScreenshotCaption': 'General Behavior alert for net.exe conducting suspicious activity (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched net.exe connection events with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-6.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection (tainted by parent PowerShell alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the net.exe connection (using valid credentials for Kmitnick) with a tag titled Lateral Movement via \\"Mounting Hidden Shares\\" (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-6.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection (tainted by parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials for user Kmitnick (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-7.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of net.exe with related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactics (Execution, Lateral Movement) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-6.png', 'ScreenshotCaption': 'Enrichment of successful net.exe connection (tainted by parent PowerShell alert)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)'}, {'ScreenshotName': 'CC-16.D.1-T1078-new.png', 'ScreenshotCaption': 'The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. Telemetry also showed a logon event for user Kmitnick on Creeper (10.0.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing a logon event for user Kmitnick on Creeper (10.0.0.4)'}, {'ScreenshotName': 'CC-16.D.1-T1078-new.png', 'ScreenshotCaption': 'The capability enriching the net.exe connection using valid credentials of Kmitnick with an alert for possible lateral movement'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker mounted the C$ drive on creeper with the kmitnick account. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-16.D.1-1.png', 'ScreenshotCaption': 'Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert'}, {'ScreenshotName': 'FE-16.D.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a logon attempt via net1.exe using valid credentials for user Kmitnick with an alert for Net Use Command Execution (Weak Signal). The password for the user Kmitnick was redacted by the capability.[FE10]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.D.1-1.png', 'ScreenshotCaption': 'Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert'}, {'ScreenshotName': 'FE-16.D.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)'}], 'Footnotes': [' The vendor indicated the un-redacted passwords could be observed in triage/acquistion data.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. [CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing net.exe. The telemetry was tainted by a trace detection on powershell.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.D.1-9.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe (tainted by a parent alert on powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed that the logon event for Kmitnick on Creeper was successful.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.A.1-6.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.D.1-2.png', 'ScreenshotCaption': 'Telemetry from query showing successful Kmitnick logon event for Creeper'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick followed by a event for a successful login. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.D.1-2.png', 'ScreenshotCaption': 'Telemetry showing a event for a successful login by user Kmitnick (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-4.png', 'ScreenshotCaption': 'Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing a net.exe logon attempt using valid credentials for user Kmitnick (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.E.1', 'Procedure': 'Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed filemods showing the creation and writing to autoupdate.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation and write to autoupdate.vbs'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because a .vbs was written to the filesystem, which was likely used to carry out additional actions.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing File Write and New Script Write for autoupdate.vbs within powershell.exe (tainted by previous detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating they observed autoupdate.vbs written (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Write and New Script Write events for autoupdate.vbs under powershell.exe. The telemetry was tainted by a previous detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing File Write and New Script Write for autoupdate.vbs within powershell.exe (tainted by previous detection by orange line indicating medium severity)'}, {'ScreenshotName': 'CS-E-10.png', 'ScreenshotCaption': 'Excerpt from email sent by OverWatch team indicating they observed autoupdate.vbs written (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of autoupdate.vbs. The telemetry was tainted by a parent PowerShell alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.E.1-10.png', 'ScreenshotCaption': 'Telemetry showing file write of autoupdate.vbs (tainted by a parent PowerShell alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of autoupdate.vbs (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-8.png', 'ScreenshotCaption': 'Telemetry showing creation of autoupdate.vbs (tainted by parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file creation of autoupdate.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-6.png', 'ScreenshotCaption': 'Telemetry showing the creation of autoupdate.vbs'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe writing autoupdate.vbs with an alert for PowerShell File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactics (Command and Control, Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.E.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy) and Tactics, Command and Control and Lateral Movement)'}, {'ScreenshotName': 'FE-16.E.1-2.png', 'ScreenshotCaption': 'Additional details on enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating autoupdate.vbs (tainted by parent Powershell executed remote commands alerts) .[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating autoupdate.vbs (tainted by parent \\"Powershell executed remote commands\\" alerts)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of autoupdate.vbs'}, {'ScreenshotName': 'MC-16.E.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of autoupdate.vbs on Code Red (10.0.1.5).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of autoupdate.vbs'}, {'ScreenshotName': 'MC-16.E.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating autoupdate.vbs (tainted by parent alert on PowerShell script with suspicious content).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)'}, {'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create and write events for autoupdate.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing file create and write events for autoupdate.vbs'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write of autoupdate.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-5.png', 'ScreenshotCaption': 'Telemetry showing file write of autoupdate.vbs'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation and file write events for autoupdate.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.E.1-1.png', 'ScreenshotCaption': 'Telemetry showing file event for autoupdate.vbs (tainted by relationship to threat story but Group ID not shown in this view)'}, {'ScreenshotName': 'S1-16.E.1-2.png', 'ScreenshotCaption': 'Telemetry showing creation and writes to autoupdate.vbs'}], 'Footnotes': []}]}]}]}, {'Substep': '16.F.1', 'Procedure': 'Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnickï¿½', 'Techniques': [{'TechniqueId': 'T1059', 'TechniqueName': 'Command-Line Interface', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe event data with the correct ATT&CK Technique (T1059 - Command-Line Interface).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob'}, {'ScreenshotName': 'CB-16.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick'}, {'ScreenshotName': 'CB-16.F.1-3.png', 'ScreenshotCaption': 'Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree with cmd.exe execution and associated user context change.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob'}, {'ScreenshotName': 'CB-16.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick'}, {'ScreenshotName': 'CB-16.F.1-3.png', 'ScreenshotCaption': 'Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new cmd.exe process running wscript.exe as user Kmitnick, which then launched powershell.exe. The command line arguments for cmd.exe showed that autoupdate.vbs was run. The telemetry was tainted by a previous detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-16.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe launching autoupdate.vbs as user Kmitnick (tainted by previous detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.vbs though wscript.exe. The telemetry was tainted by a parent PowerShell alert based on a malicious Invoke-RunAs command.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.F.1-11.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs though wscript.exe (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'CR-16.F.1-13.png', 'ScreenshotCaption': 'Parent alert on Malicious PowerShell Command (Invoke-RunAs)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched events related to cmd.exe launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-9.png', 'ScreenshotCaption': 'Enrichment showing cmd launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-11.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executed as user Kmitnick (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-10.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of autoupdate.vbs execution with related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of autoupdate.vbs with a related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution). (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-9.png', 'ScreenshotCaption': 'Enrichment showing cmd launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-11.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executed as user Kmitnick (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-10.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of autoupdate.vbs execution with related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe execution and associated user context change (tainted by parent PowerShell alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-9.png', 'ScreenshotCaption': 'Enrichment showing cmd launching PowerShell via wscript.exe running autoupdate.vbs (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-11.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executed as user Kmitnick (tainted by parent PowerShell alert)'}, {'ScreenshotName': 'EG-16-10.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of autoupdate.vbs execution with related ATT&CK Technique (T1064 - Scripting) and Tactic (Execution) (tainted by parent PowerShell alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick'}, {'ScreenshotName': 'CC-20.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs through wscript.exe, and the associated user context change between user Bob and user Kmitnick'}, {'ScreenshotName': 'CC-20.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert was generated showing that a spawned process (cmd.exe) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe spawning wscript.exe with an alert for Wscript Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1059 - Command-Line Interface) and Tactic (Execution). Alert details showed that the context of the user was changed to Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.F.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)'}, {'ScreenshotName': 'FE-16.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.vbs with a parent process of powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.F.1-1.png', 'ScreenshotCaption': 'Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)'}, {'ScreenshotName': 'FE-16.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed svchost.exe creating cmd.exe, which ran autoupdate.vbs as user Kmitnick (tainted by the parent \\"Powershell executed remote commands\\" alert).[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe creating cmd.exe and executing autoupdate.vbs as user Kmitnick'}, {'ScreenshotName': 'CT-16.F.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by the parent \\"Powershell executed remote commands\\" alert)'}, {'ScreenshotName': 'CT-16.F.1-3.png', 'ScreenshotCaption': 'Telemetry showing wscript.exe execute autoupate.vbs and resulting powershell.exe (tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched wscript.exe executing autoupdate.vbs with the correct ATT&CK Tactic (Execution) and Technique (Command Line Interface).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick'}, {'ScreenshotName': 'MC-16.F.1-2.png', 'ScreenshotCaption': 'Enrichment of wscript.exe executing autoupdate.vbs with the correct ATT&CK Tactic (Execution) and Technique (Command Line Interface)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.vbs as user Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick'}, {'ScreenshotName': 'MC-16.F.1-2.png', 'ScreenshotCaption': 'Enrichment of wscript.exe executing autoupdate.vbs with the correct ATT&CK Tactic (Execution) and Technique (Command Line Interface)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.vbs via wscript.exe as user Kmitnick. The execution generated three new PowerShell related alerts for the initial execution sequence of Empire that tainted this event, but were not counted as separate detections for this technique.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by parent PowerShell alerts)'}, {'ScreenshotName': 'MS-16.D.1-3.png', 'ScreenshotCaption': 'Parent alert for PowerShell with suspicious command-line tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.D.1-5.png', 'ScreenshotCaption': 'Parent alert for malicious PowerShell cmdlet tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.F.1-2.png', 'ScreenshotCaption': 'Enrichment of wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting).'}, {'ScreenshotName': 'PA-16.F.1-3.png', 'ScreenshotCaption': 'Indicator of Compromise Alert identifying PowerShell Empire using the Runas functionality'}], 'Footnotes': []}, {'DetectionType': 'Indicator of Compromise', 'DetectionNote': 'An Indicator of Compromise Alert was generated identify PowerShell Empire using the Runas functionality.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.F.1-2.png', 'ScreenshotCaption': 'Enrichment of wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting).'}, {'ScreenshotName': 'PA-16.F.1-3.png', 'ScreenshotCaption': 'Indicator of Compromise Alert identifying PowerShell Empire using the Runas functionality'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.vbs. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing autoupdate.vbs (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.F.1-2.png', 'ScreenshotCaption': 'Enrichment of wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting).'}, {'ScreenshotName': 'PA-16.F.1-3.png', 'ScreenshotCaption': 'Indicator of Compromise Alert identifying PowerShell Empire using the Runas functionality'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing autoupdate.vbs via wscript.exe as user Kmitnick', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-6.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe and executing autoupdate.vbs as user Kmitnick'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe execution of autoupdate.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.F.1-1.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe launching autoupdate.vbs (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.G.1', 'Procedure': 'Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed filemods showing the creation and writing to update.vbs on remote host 10.0.0.4 (Creeper).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing remote creation and write to update.vbs'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed update.vbs written to the C$ remote share on host 10.0.0.4 (Creeper).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-16.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing update.vbs with event_name NewScriptWritten indicating a write to C$'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file events for the write of update.vbs to Creeper (10.0.0.4).\xa0The telemetry was tainted by a parent PowerShell alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.G.1-10.png', 'ScreenshotCaption': 'Telemetry of file events for write of update.vbs to Creeper (10.0.0.4) (tainted by a parent PowerShell alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry for file creation events was available, and would show the creation of update.vbs. No screenshot for the event was made available, though other file creation events, as well as the subsequent execution of update.vbs was identified.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file creation of update.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-6.png', 'ScreenshotCaption': 'Telemetry showing the creation of update.vbs'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified the autoupdate.vbs script being written to Creeper. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-16.G.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert'}, {'ScreenshotName': 'FE-16.G.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe writing update.vbs with an alert for File Write to Network Share (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactic (Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.G.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert'}, {'ScreenshotName': 'FE-16.G.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the update.vbs creation event with the condition \\"File created on hidden share (C$)\\". The enrichment was tainted by parent \\"Powershell executed remote commands\\" alerts.[CT15]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.G.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe creating update.vbs (tainted by parent \\"Powershell executed remote commands\\" alerts)'}], 'Footnotes': ["The condition contributing to enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.G.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of update.vbs'}, {'ScreenshotName': 'MC-16.G.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of update.vbs on Creeper (10.0.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.G.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of update.vbs'}, {'ScreenshotName': 'MC-16.G.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe with the correct ATT&CK Tactic (Command and Control) and Technique (Remote File Copy) and a suspicious indicator that a file was copied to a remote computer via PowerShell'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of update.vbs on 10.0.0.4 (Creeper) and the remote file copy action from 10.0.1.5 (CodeRed) (the remote file copy event on CodeRed was tainted by parent PowerShell alerts).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.G.1-1.png', 'ScreenshotCaption': 'Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)'}, {'ScreenshotName': 'MS-16.G.1-2.png', 'ScreenshotCaption': 'Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a script being modified/moved to a remote location. The alert was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.G.1-1.png', 'ScreenshotCaption': 'Telemetry showed file create and write events for update.vbs'}, {'ScreenshotName': 'PA-16.G.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a script being modified/moved to a remote location (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create and write events for update.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.G.1-1.png', 'ScreenshotCaption': 'Telemetry showed file create and write events for update.vbs'}, {'ScreenshotName': 'PA-16.G.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a script being modified/moved to a remote location (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of update.vbs on 10.0.0.4 (Creeper). The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.G.1-2.png', 'ScreenshotCaption': 'Telemetry showing create file event of update.vbs on 10.0.0.4 (Creeper) (tainted by relationship to threat story but Group ID not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.H.1', 'Procedure': "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", 'Techniques': [{'TechniqueId': 'T1007', 'TechniqueName': 'System Service Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the sc.exe execution with the correct ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution for the service query'}, {'ScreenshotName': 'CB-16.H.1-2.png', 'ScreenshotCaption': 'Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)'}, {'ScreenshotName': 'CB-16.H.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed execution of sc.exe with command-line arguments to remotely query services on Creeper. Telemetry also showed module loads and a network connection to Creeper (10.0.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution for the service query'}, {'ScreenshotName': 'CB-16.H.1-2.png', 'ScreenshotCaption': 'Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)'}, {'ScreenshotName': 'CB-16.H.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was observed because the user Bob was querying for a particular service on Creeper.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution to query services on Creeper (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed Bob querying for a service on Creeper (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to query services on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution to query services on Creeper (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed Bob querying for a service on Creeper (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe execution with command-line arguments. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.H.1-10.png', 'ScreenshotCaption': 'Telemetry of sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-12.png', 'ScreenshotCaption': 'Telemetry showing sc.exe execution to query services on Creeper'}, {'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enrichment of sc.exe execution to query services on Creeper with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)  (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe execution to query services on Creeper. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-12.png', 'ScreenshotCaption': 'Telemetry showing sc.exe execution to query services on Creeper'}, {'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enrichment of sc.exe execution to query services on Creeper with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)  (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.H.1-2.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.H.1-2.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). [FE7]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.L.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-16.H.1-1.png', 'ScreenshotCaption': 'Additional details on enrichment of sc.exe with SC Execution alert'}], 'Footnotes': [' All five of the sc.exe events are rolled under the same SC Execution alert.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing sc.exe to remotely query services on Creeper and enriched sc.exe with enriched with the condition SC Query Reconnaissance Command. The enrichment was tainted by the parent \\"Powershell executed remote commands\\" alert.[CT8]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.H.1-1.png', 'ScreenshotCaption': 'Enrichment showing powershell.exe executing sc.exe to query services on Creeper (enriched with condition SC Query Reconnaissance Command, tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['The capability was modified after the start of the evaluation to allow the condition contributing to Enrichment to appear, so the detection is identified as a configuration change. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-16.J.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-16.J.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from CodeRed showed sc.exe command remotely querying services on Creeper (tainted by parent alert on PowerShell script with suspicious content).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper'}, {'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for the sc utility be used to perform actions of remote services. The alert was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.H.1-2.png', 'ScreenshotCaption': 'General Behavior alert for the sc utility be used to perform actions of remote services (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.H.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.H.1-2.png', 'ScreenshotCaption': 'General Behavior alert for the sc utility be used to perform actions of remote services (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.H.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.H.1-2.png', 'ScreenshotCaption': 'General Behavior alert for the sc utility be used to perform actions of remote services (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.H.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to query services on 10.0.0.4 (Creeper).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-7.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to query services on 10.0.0.4 (Creeper)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to query services on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.H.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to query services on Creeper (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.I.1', 'Procedure': "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", 'Techniques': [{'TechniqueId': 'T1050', 'TechniqueName': 'New Service', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for sc.exe execution to create the AdobeUpdater service with the correct ATT&CK Technique (New Service).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service'}, {'ScreenshotName': 'CB-16.H.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed execution of sc.exe with command-line arguments to create a new AdobeUpdater service containing a binPath pointed to cmd.exe with arguments to execute update.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service'}, {'ScreenshotName': 'CB-16.H.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating they observed a General Behavior because newly created file (AdobeUpdater service in registry) established persistence on the host.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.H.1-4.png', 'ScreenshotCaption': 'Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description'}, {'ScreenshotName': 'CS-16.H.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution to create the AdobeUpdater service (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed a newly created file (AdobeUpdater service in registry) to establish persistence (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe executing with command-line arguments for a new service called AdobeUpdater with binPath pointed to cmd.exe with arguments to execute update.vbs and service description \\"Synchronize with Adobe for security updates.\\" The process tree view showed sc.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.H.1-4.png', 'ScreenshotCaption': 'Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description'}, {'ScreenshotName': 'CS-16.H.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution to create the AdobeUpdater service (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed a newly created file (AdobeUpdater service in registry) to establish persistence (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the unconventional creation of a new service with the correct ATT&CK Technique (New Service) and Tactic (Persistence, Privilege Escalation). The alert was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.I.1-13.png', 'ScreenshotCaption': 'Specific Behavior alert for unconventional new service with correct ATT&CK Technique (New Service) and Tactics (Persistence, Privilege Escalation) (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe executing with command-line arguments.[CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-16.I.1-13.png', 'ScreenshotCaption': 'Specific Behavior alert for unconventional new service with correct ATT&CK Technique (New Service) and Tactics (Persistence, Privilege Escalation) (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on the AdobeUpdater service named "Persistence-New Service". The alert was also tagged with the correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-13.png', 'ScreenshotCaption': 'Specific Behavior alert for new service AdobeUpdater creation on Creeper tagged with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with the correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence). The enrichment was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-13.png', 'ScreenshotCaption': 'Specific Behavior alert for new service AdobeUpdater creation on Creeper tagged with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe execution to create the AdobeUpdater service and set the binPath to run cmd.exe with an argument to execute update.vbs. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-13.png', 'ScreenshotCaption': 'Specific Behavior alert for new service AdobeUpdater creation on Creeper tagged with correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for sc.exe used with parameters typical for lateral movement.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-16.D.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for sc.exe used with parameters typical for lateral movement'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-16.D.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for sc.exe used with parameters typical for lateral movement'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe execution with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-16.D.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for sc.exe used with parameters typical for lateral movement'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it observed the sc.exe command creating a new service called adobeupdater on Creeper from CodeRed. [FE5][FE7]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-16.I.1-1.png', 'ScreenshotCaption': 'Additional details on enrichment of sc.exe with SC Execution alert'}, {'ScreenshotName': 'FE-16.L.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-16.I.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", ' All five of the sc.exe events are rolled under the same SC Execution alert.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.I.1-1.png', 'ScreenshotCaption': 'Additional details on enrichment of sc.exe with SC Execution alert'}, {'ScreenshotName': 'FE-16.L.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-16.I.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'An alert called "Windows Service Registry Key modified" and a Specific Behavior alert called "New Windows service created" were generated due to the AdobeUpdater service being created in the Registry.', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'CT-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \\"Powershell executed remote commands\\" alert)'}, {'ScreenshotName': 'CT-16.I.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"\\"New Windows service created\\"\\" and additional alert for \\"Windows Service Registry Key modified\\"'}], 'Footnotes': ['The capability may have been modified after the start of the evaluation to create these alerts, so the detection is identified as a configuration change. See Configuration page for details.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe to create a new service named AdobeUpdater with binPath pointed to cmd.exe with arguments to run update.vbs and suspicious service description. The telemetry was tainted by the parent \\"Powershell executed remote commands alert\\".[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \\"Powershell executed remote commands\\" alert)'}, {'ScreenshotName': 'CT-16.I.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for \\"\\"New Windows service created\\"\\" and additional alert for \\"Windows Service Registry Key modified\\"'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing that a new service was added'}, {'ScreenshotName': 'MC-16.J.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that a new service was added. Telemetry also showed powershell.exe executing sc.exe. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing that a new service was added'}, {'ScreenshotName': 'MC-16.J.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the suspicious service registration of AdobeUpdater.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry from CodeRed showing execution sequence of sc.exe AdobeUpdater remote service creation'}, {'ScreenshotName': 'MS-16.I.1-2.png', 'ScreenshotCaption': 'Telemetry showing AdobeUpdater service registry information that was changed on Creeper'}, {'ScreenshotName': 'MS-16.I.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert on suspicious service registration on Creeper'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from CodeRed showed sc.exe execution to remotely create the AdobeUpdater service with a binPath set to run cmd.exe with an argument to execute update.vbs on Creeper (tainted by parent alert on PowerShell script with suspicious content). Telemetry from Creeper shows the registry keys that were changed to add the new service', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry from CodeRed showing execution sequence of sc.exe AdobeUpdater remote service creation'}, {'ScreenshotName': 'MS-16.I.1-2.png', 'ScreenshotCaption': 'Telemetry showing AdobeUpdater service registry information that was changed on Creeper'}, {'ScreenshotName': 'MS-16.I.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert on suspicious service registration on Creeper'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a new service created via the command line. The alert was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to create a new AdobeUpdater service (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.I.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of Registry keys associated with the AdobeUpdater service'}, {'ScreenshotName': 'PA-16.I.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a new service created via the command line (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.I.1-4.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing with the correct ATT&CK Technique (New Service)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe executing with the correct ATT&CK Technique (New Service).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to create a new AdobeUpdater service (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.I.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of Registry keys associated with the AdobeUpdater service'}, {'ScreenshotName': 'PA-16.I.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a new service created via the command line (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.I.1-4.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing with the correct ATT&CK Technique (New Service)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe with command-line arguments to create a new AdobeUpdater service containing a binPath pointed to cmd.exe with arguments to execute update.vbs. Telemetry also showed the creation of Registry keys associated with this new service. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to create a new AdobeUpdater service (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.I.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of Registry keys associated with the AdobeUpdater service'}, {'ScreenshotName': 'PA-16.I.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for a new service created via the command line (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.I.1-4.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing with the correct ATT&CK Technique (New Service)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to create a new service called AdobeUpdater with a binPath set to run cmd.exe and execute update.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-7.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to create the AdobeUpdater service'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to create the AdobeUpdater service on Creeper with a binPath pointing to cmd.exe to execute update.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to create the AdobeUpdater service (tainted by prior threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.I.1', 'Procedure': "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", 'Techniques': [{'TechniqueId': 'T1036', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process trees showed execution of sc.exe with command-line arguments to create the AdobeUpdater service with binPath pointed to cmd.exe with arguments to execute update.vbs and a suspicious service description, which indicates masquerading.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.I.1-2.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution setting the AdobeUpdater service description'}, {'ScreenshotName': 'CB-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe executing with command-line arguments for a new service called AdobeUpdater with binPath pointed to cmd.exe with arguments to execute update.vbs and service description \\"Synchronize with Adobe for security updates.\\". An analyst could use this information to determine it is not a legitimate service. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.H.1-3.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution with the AdobeUpdater service description (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-16.H.1-4.png', 'ScreenshotCaption': 'Telemetry showing AdobeUpdater service details with binPath pointed to cmd.exe with arguments and service description'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe executing with command-line arguments to set the service description. An analyst could use this information to determine it is not a legitimate service. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.I.1-21.png', 'ScreenshotCaption': 'Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe executions to create the AdobeUpdater service and set the binPath to run cmd.exe with an argument to execute update.vbs as well as set the description of the service. An analyst could use this information to determine masquerading occurred. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Telemetry of sc.exe executions to create and set the description of a new service on Creeper (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process trees showed execution of sc.exe with command-line arguments to create the AdobeUpdater service with binPath pointed to cmd.exe with arguments to execute update.vbs and a suspicious service description, which could indicate masquerading.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the sc.exe command with an alert for SC Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1007 - System Service Discovery) and the correct Tactic (Discovery).  [FE7]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.L.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with related correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-16.I.1-1.png', 'ScreenshotCaption': 'Additional details on enrichment of sc.exe with SC Execution alert'}], 'Footnotes': [' All five of the sc.exe events are rolled under the same SC Execution alert.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe to create a new service named AdobeUpdater with binPath pointed to cmd.exe with arguments to run update.vbs and suspicious service description, which could assist an analyst in determining this was not a legitimate Adobe product. The telemetry was tainted by the parent \\"Powershell executed remote commands alert\\".[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe to create the AdobeUpdater service on Creeper and set its description (tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe with command-line arguments, to create and configure the AdobeUpdater service, that an analyst could use to determine the service is masquerading. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from CodeRed showed sc.exe service creation command for the AdobeUpdater service with a binPath set to run update.vbs with cmd.exe on startup on Creeper (tainted by parent alert on PowerShell script with suspicious content).\xa0Telemetry also showed the sc.exe command to set the service description, but a screenshot was not available. An analyst can use this information to determine AdobeUpdater is masquerading.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution sequence of sc.exe AdobeUpdater remote service creation'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe with command-line arguments to set the service description. An analyst could use this information to determine it is not a legitimate service. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.I.1-5.png', 'ScreenshotCaption': 'Telemetry showed execution of sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to create a new service called AdobeUpdater with a binPath set to run cmd.exe and execute update.vbs as well as set the service description. An analyst can use this information to determine the service is masquerading.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-7.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to create the AdobeUpdater service and set its description'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed executions of sc.exe to create the AdobeUpdater service on Creeper with a binPath pointing to cmd.exe to execute update.vbs as well as a setting the service description. An analyst can use this information to determine AdobeUpdater is masquerading. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.I.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to create the AdobeUpdater service and set the description (partially shown one line above; both tainted by prior threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.J.1', 'Procedure': "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", 'Techniques': [{'TechniqueId': 'T1007', 'TechniqueName': 'System Service Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe execution with the correct ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.J.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper'}, {'ScreenshotName': 'CB-16.H.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed execution of sc.exe with command-line arguments to query the AdobeUpdater service on Creeper.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.J.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper'}, {'ScreenshotName': 'CB-16.H.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating they observed a Specific Behavior because the user Bob queried for a particular service on Creeper.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.J.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe execution to query the AdobeUpdater service on Creeper process tree view (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed Bob querying for a service (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe executing with command-line arguments to query the AdobeUpdater service on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.J.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe execution to query the AdobeUpdater service on Creeper process tree view (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed Bob querying for a service (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.J.1-10.png', 'ScreenshotCaption': 'Telemetry showing sc.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). The enrichment was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. \xa0[EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe execution to query the AdobeUpdater service on Creeper. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.\xa0[EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe execution with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).[FE7]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.L.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-16.J.1-1.png', 'ScreenshotCaption': 'Additional details on enrichment of sc.exe with SC Execution alert'}], 'Footnotes': [' All five of the sc.exe events are rolled under the same SC Execution alert.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed powershell.exe executing sc.exe to query the AdobeUpdater service on Creeper and enriched sc.exe with the condition SC QC Reconnaissance Command. The enrichment was tainted by the parent \\"Powershell executed remote commands alert\\".[CT8]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.J.1-1.png', 'ScreenshotCaption': 'Enrichment showing powershell.exe executing sc.exe query AdobeUpdater service on Creeper (enriched with condition SC QC Reconnaissance Command, tainted by the parent \\"Powershell executed remote commands\\" alert)'}], 'Footnotes': ['The capability was modified after the start of the evaluation to allow the condition contributing to Enrichment to appear, so the detection is identified as a configuration change. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that the configuration of a system service was queried.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-16.J.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that the configuration of a system service was queried.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-16.J.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that the configuration of a system service was queried.'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from CodeRed showed sc.exe remote service query on Creeper for the AdobeUpdater service (tainted by parent alert on PowerShell script with suspicious content).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.J.1-1.png', 'ScreenshotCaption': 'Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing sc.exe as enumeration of services via the command line. The data was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.J.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.J.1-2.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing sc.exe as enumeration of services via the command line (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.J.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.J.1-2.png', 'ScreenshotCaption': 'Enrichment of powershell.exe executing sc.exe as enumeration of services via the command line (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to query for the AdobeUpdater service on 10.0.0.4 (Creeper).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-7.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to query the AdobeUpdater service on 10.0.0.4 (Creeper)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to query the AdobeUpdater service on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.J.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to query AdobeUpdater service on Creeper (tainted by relationship to threat story)'}], 'Footnotes': []}]}]}]}, {'Substep': '16.K.1', 'Procedure': "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the type command with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing the type command with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability identified for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file read event for update.vbs. The telemetry was tainted by a parent alert on wscript.exe [PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.K.1-1.png', 'ScreenshotCaption': 'Telemetry showing a file read event for update.vbs (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a remote access event on update.vbs.[SO91]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['MITRE verified telemetry was generated for the remote update.vbs file access event, but no screenshot was available.']}]}]}]}, {'Substep': '16.L.1', 'Procedure': "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", 'Techniques': [{'TechniqueId': 'T1035', 'TechniqueName': 'Service Execution', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed execution of sc.exe with command-line arguments to start the AdobeUpdater service on Creeper.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing sc.exe execution to start the AdobeUpdater service on Creeper'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating they observed a Specific Behavior because update.vbs executed following the start of the AdobeUpdater service.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc start in the process tree view (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed execution of update.vbs following the AdobeUpdater service start (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe executing with command-line arguments to start the AdobeUpdater service on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc start in the process tree view (tainted from previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed execution of update.vbs following the AdobeUpdater service start (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing the update.vbs from the Adobe Flash Updater service. Telemetry also showed\xa0sc.exe executing the service. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-16.L.1-12.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing update.vbs'}, {'ScreenshotName': 'CR-16.L.1-100.png', 'ScreenshotCaption': 'Telemetry showing sc.exe executing the service\xa0(tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the sc.exe command to start AdobeUpdater named "Service Command Lateral Movement". The alert was also tagged with the correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-15.png', 'ScreenshotCaption': 'Specific Behavior alert \\"Service Command Lateral Movement\\" for the start of AdobeUpdater service on Creeper tagged with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with the correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution). The event was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. \xa0[EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-15.png', 'ScreenshotCaption': 'Specific Behavior alert \\"Service Command Lateral Movement\\" for the start of AdobeUpdater service on Creeper tagged with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe execution to start the AdobeUpdater service on Creeper. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.\xa0[EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-16-14.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of sc.exe execution with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}, {'ScreenshotName': 'EG-16-15.png', 'ScreenshotCaption': 'Specific Behavior alert \\"Service Command Lateral Movement\\" for the start of AdobeUpdater service on Creeper tagged with correct ATT&CK Technique (T1035 - Service Execution) and Tactic (Execution)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for sc.exe used with parameters typical for lateral movement.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-16.D.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for sc.exe used with parameters typical for lateral movement'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-16.D.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for sc.exe used with parameters typical for lateral movement'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sc.exe execution with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-16.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing sc.exe with command-line arguments'}, {'ScreenshotName': 'CC-16.I.1-1.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (sc) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}, {'ScreenshotName': 'CC-16.D.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for sc.exe used with parameters typical for lateral movement'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it observed the sc.exe command starting the adobeupdater service on Creeper. [FE5][FE7]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-16.L.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-16.I.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident.", ' All five of the sc.exe events are rolled under the same SC Execution alert.']}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-16.L.1-1.png', 'ScreenshotCaption': 'Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)'}, {'ScreenshotName': 'FE-16.I.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe to start the AdobeUpdater service on Creeper. The telemetry was tainted by the parent \\"Powershell executed remote commands\\" alert. Telemetry from Creeper also showed services.exe creating cmd.exe, which executed the update.vbs file (showing AdobeUpdater service starting).[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe start AdobeUpdater service on Creeper (tainted by the parent \\"Powershell executed remote commands\\" alert)'}, {'ScreenshotName': 'CT-16.L.1-2.png', 'ScreenshotCaption': 'Telemetry showing AdobeUpdater service starting on Creeper (tainted by the parent \\"\\"New Windows service created\\"\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that a Windows service was manipulated via sc.exe/net.exe tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-16.J.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc.exe. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-16.J.1-4.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc.exe (tainted by a trace detection on cmd.exe)'}, {'ScreenshotName': 'MC-16.J.1-3.png', 'ScreenshotCaption': 'Enrichment of net.exe with a relevant ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Windows service was manipulated via sc.exe/net.exe tool'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a successful AdobeUpdater remote service execution attempt on Creeper.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry from CodeRed showing execution sequence of sc.exe service start for AdobeUpdater on Creeper'}, {'ScreenshotName': 'MS-16.L.1-2.png', 'ScreenshotCaption': 'Telemetry showing service execution on Creeper and new Empire connection to www.freegoogleadsenseinfo.com (C2 domain) (C2 alert rule for BORON domain was added by the vendor earlier in Step 11)'}, {'ScreenshotName': 'MS-16.L.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert showing successful remote AdobeUpdater service execution attempt from CodeRed to Creeper'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from CodeRed showed the sc.exe remote service start to execute the AdobeUpdater service on Creeper (tainted by parent alert on PowerShell script with suspicious content). Telemetry from Creeper showed the execution sequence of Empire and command and control connections.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-16.D.1-4.png', 'ScreenshotCaption': 'Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)'}, {'ScreenshotName': 'MS-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry from CodeRed showing execution sequence of sc.exe service start for AdobeUpdater on Creeper'}, {'ScreenshotName': 'MS-16.L.1-2.png', 'ScreenshotCaption': 'Telemetry showing service execution on Creeper and new Empire connection to www.freegoogleadsenseinfo.com (C2 domain) (C2 alert rule for BORON domain was added by the vendor earlier in Step 11)'}, {'ScreenshotName': 'MS-16.L.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert showing successful remote AdobeUpdater service execution attempt from CodeRed to Creeper'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.L.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing update.vbs on 10.0.0.4 (Creeper)'}, {'ScreenshotName': 'PA-16.L.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing sc with command-line arguments. As part of the service, telemetry also showed cmd.exe executing update.vbs on 10.0.0.4 (Creeper). The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing sc with command-line arguments (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-16.L.1-2.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe executing update.vbs on 10.0.0.4 (Creeper)'}, {'ScreenshotName': 'PA-16.L.1-3.png', 'ScreenshotCaption': 'Enrichment of sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to start the AdobeUpdater service on 10.0.0.4 (Creeper). Telemetry on Creeper showed the execution of cmd.exe to run update.vbs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-16-9.png', 'ScreenshotCaption': 'Telemetry showing the execution of sc.exe to start the AdobeUpdater service on 10.0.0.4 (Creeper)'}, {'ScreenshotName': 'RSA-16-8.png', 'ScreenshotCaption': 'Telemetry showing the execution of update.vbs on 10.0.0.4 (Creeper)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for the lateral movement activity. A new story grouping was generated for the event on Creeper to associate subsequent activity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to start the AdobeUpdater service on Creeper (tainted by relationship to threat story)'}, {'ScreenshotName': 'S1-16.G.1-1.png', 'ScreenshotCaption': 'Lateral movement alert generated by the remote service start on Creeper'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of sc.exe to start the AdobeUpdater service on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-16.L.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of sc.exe to start the AdobeUpdater service on Creeper (tainted by relationship to threat story)'}, {'ScreenshotName': 'S1-16.G.1-1.png', 'ScreenshotCaption': 'Lateral movement alert generated by the remote service start on Creeper'}], 'Footnotes': []}]}]}]}, {'Substep': '17.A.1', 'Procedure': "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", 'Techniques': [{'TechniqueId': 'T1007', 'TechniqueName': 'System Service Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed reg.exe executing with command-line arguments to check if terminal services were enabled.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments to check if terminal services are enabled. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services were enabled. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-17.A.1-20.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg.exe with command-line arguments indicating a check to see if terminal services was enabled. Telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-17-2.png', 'ScreenshotCaption': 'Telemetry from event tree showing reg.exe'}, {'ScreenshotName': 'EG-17-1.png', 'ScreenshotCaption': 'Event tree view showing tainted powershell.exe with reg.exe child process'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe with command-line arguments to check if terminal services were enabled.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments to check if terminal services are enabled. The telemetry was tainted by the parent Reg Execution (Weak Signal) alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe executing with command-line arguments (tainted by parent Reg Execution alert)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg.exe with command-line arguments indicating a check to see if terminal services was enabled. The telemetry was tainted by the parent \\"New Windows service created\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg.exe (tainted by the parent \\"New Windows service created\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-2.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry'}, {'ScreenshotName': 'MC-17.A.1-99.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-2.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry'}, {'ScreenshotName': 'MC-17.A.1-99.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent cmd.exe alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-2.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of powershell.exe that executed reg.exe with the ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that PowerShell queried terminal services Registry'}, {'ScreenshotName': 'MC-17.A.1-99.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery) and a suspicious indicator that Registry was queried for remote services RDP'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services was enabled (tainted by prior alert on suspicious PowerShell command-line).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe query for terminal server setting'}, {'ScreenshotName': 'MS-17.A.1-2.png', 'ScreenshotCaption': 'Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe executing with command-line arguments as the terminal server key queried by the reg utility. The data was tainted by a parent alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services was enabled.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-17-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe query for terminal server setting'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe execution with command-line arguments indicating a check to see if terminal services was enabled. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-17.A.1-4.png', 'ScreenshotCaption': 'Threat story graph showing telemetry of reg.exe with query for terminal server setting (tainted by prior lateral movement alert by Group ID)'}], 'Footnotes': []}]}]}]}, {'Substep': '17.A.1', 'Procedure': "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", 'Techniques': [{'TechniqueId': 'T1012', 'TechniqueName': 'Query Registry', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CB-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed reg.exe executing with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CB-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree view showing reg.exe executing with command-line arguments (tainted by previous powershell.exe detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-17.A.1-10.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-17-1.png', 'ScreenshotCaption': 'Event tree view showing tainted powershell.exe with reg.exe child process'}, {'ScreenshotName': 'EG-17-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg.exe with command-line arguments. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-17-1.png', 'ScreenshotCaption': 'Event tree view showing tainted powershell.exe with reg.exe child process'}, {'ScreenshotName': 'EG-17-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery) (tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe indicating that a sensitive registry key was accessed for potential reconnaissance'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (reg) has been tagged for monitoring because its parent process has a detection (powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-17.A.1-1.png', 'ScreenshotCaption': 'Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg.exe with command-line arguments. The telemetry was tainted by the parent \\"New Windows service created\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg.exe (tainted by the parent \\"New Windows service created\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the reg.exe utility queried the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-2.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the reg.exe utility queried the Registry'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg.exe. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-2.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of reg.exe with the correct ATT&CK Tactic (Discovery) and Technique (Query Registry) and a suspicious indicator that the reg.exe utility queried the Registry'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments (tainted by prior alert on suspicious PowerShell command line).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-17.A.1-2.png', 'ScreenshotCaption': 'Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query'}, {'ScreenshotName': 'MS-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe executing with command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe executing with command-line arguments as the terminal server key queried by the reg utility. The data was tainted by a parent alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg with command-line arguments to check if terminal services were enabled. (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery).'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg with command-line arguments to check if terminal services were enabled. (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing reg with command-line arguments to check if terminal services were enabled. The telemetry was tainted by a parent alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments as the terminal server key queried by the reg utility (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing reg with command-line arguments to check if terminal services were enabled. (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.A.1-3.png', 'ScreenshotCaption': 'Enrichment of reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery).'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe executing with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-17-1.png', 'ScreenshotCaption': 'Telemetry showing reg.exe execution'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed reg.exe execution with command-line arguments. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-17.A.1-4.png', 'ScreenshotCaption': 'Threat story graph showing telemetry of reg.exe executing (tainted by prior lateral movement alert by Group ID)'}], 'Footnotes': []}]}]}]}, {'Substep': '17.B.1', 'Procedure': "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", 'Techniques': [{'TechniqueId': 'T1222', 'TechniqueName': 'File and Directory Permissions Modification', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of takeown.exe with \\"Permission modifications\\".[CB1]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'CB-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing takeown.exe with command-line arguments'}, {'ScreenshotName': 'CB-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of takeown.exe execution with tag \\"Permission modifications\\"'}], 'Footnotes': [' The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed execution of takeown.exe with command-line arguments on magnify.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing takeown.exe with command-line arguments'}, {'ScreenshotName': 'CB-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of takeown.exe execution with tag \\"Permission modifications\\"'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because takeown.exe was executed to bypass Windows logon.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree view showing execution of takeown.exe (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed takeown.exe executed to bypass Windows logon (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed takeown.exe executing with command-line arguments. The process tree view showed takeown.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree view showing execution of takeown.exe (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed takeown.exe executed to bypass Windows logon (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for takeown.exe performing activity related to swapping an accessibility features binary. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-17.B.1-10.png', 'ScreenshotCaption': 'General Behavior alert for takeown.exe performing activity related to swapping an accessibility features binary (tainted by a parent PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed takeown.exe executing with command-line arguments.[CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-17.B.1-10.png', 'ScreenshotCaption': 'General Behavior alert for takeown.exe performing activity related to swapping an accessibility features binary (tainted by a parent PowerShell alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing takeown.exe with command-line arguments. Telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-17-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing takeown.exe (tainted by parent alerts on powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for takeown.exe changing the ownership of an accessibility feature executable.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing takeown.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe).'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing takeown.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed takeown.exe executing with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing takeown.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for takeown.exe changing the ownership of an accessibility feature executable'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (takeown) has been tagged for monitoring because its parent process has a detection (powershell.exe).'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched takeown.exe with an alert for Takeown Execution. The alert described how takeown can be used to change file ownership.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-17.B.1-1.png', 'ScreenshotCaption': 'Enrichment of takeown.exe with Takeown Execution alert'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing takeown.exe to take ownership of magnify.exe. The telemetry was tainted by the parent \\"New Windows service created\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing takeown.exe (tainted by the parent \\"New Windows service created\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched takeown.exe with a suspicious indicator that the takeown command was executed to obtain ownership of a file or directory.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of takeown.exe with a suspicious indicator that the takeown command was executed to obtain ownership of a file or directory'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing takeown.exe. The telemetry was tainted by a trace detection on cmd.exe..', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of takeown.exe with a suspicious indicator that the takeown command was executed to obtain ownership of a file or directory'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed takeown.exe execution to change the file permissions on magnify.exe (tainted by prior alert on suspicious PowerShell command-line).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing takeown.exe execution with magnify.exe in command-line arguments'}, {'ScreenshotName': 'MS-17.A.1-2.png', 'ScreenshotCaption': 'Process tree view of suspicious PowerShell command-line alert showing tainted relationship to takeown.exe'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing takeown with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.B.1-2.png', 'ScreenshotCaption': 'Enrichment of takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.B.1-3.png', 'ScreenshotCaption': 'Enrichment of takeown.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder. The data was tainted by a parent alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing takeown with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.B.1-2.png', 'ScreenshotCaption': 'Enrichment of takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.B.1-3.png', 'ScreenshotCaption': 'Enrichment of takeown.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing takeown with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-17.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing takeown with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.B.1-2.png', 'ScreenshotCaption': 'Enrichment of takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.B.1-3.png', 'ScreenshotCaption': 'Enrichment of takeown.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed takeown.exe execution to change the file permissions on magnify.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-17-1.png', 'ScreenshotCaption': 'Telemetry showing takeown.exe execution with magnify.exe in command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'Telemetry showed takeown.exe execution with command-line arguments containing magnify.exe. The event was enriched to show that ownership of a file was taken over. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-17.A.1-1.png', 'ScreenshotCaption': 'Enrichment showing takeown.exe execution (tainted by prior lateral movement alert by Group ID)'}], 'Footnotes': []}]}]}]}, {'Substep': '17.B.2', 'Procedure': "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", 'Techniques': [{'TechniqueId': 'T1222', 'TechniqueName': 'File and Directory Permissions Modification', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the execution of icacls.exe with \\"Permission modifications\\".[CB1]', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'CB-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing icacls.exe with command-line arguments'}, {'ScreenshotName': 'CB-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of icacls.exe execution with tag \\"Permission modifications\\"'}], 'Footnotes': [' The enrichment was added as a configuration change during the action and was not part of the original set of detections when the evaluation started.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed execution of icacls.exe with command-line arguments on magnify.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing icacls.exe with command-line arguments'}, {'ScreenshotName': 'CB-17.A.1-2.png', 'ScreenshotCaption': 'Enrichment of icacls.exe execution with tag \\"Permission modifications\\"'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a General Behavior was observed because icacls.exe was executed to bypass Windows logon.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree view showing execution of icacls.exe (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed icacls.exe executed to bypass Windows logon (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of icacls.exe with command-line arguments. The process tree view showed icacls.exe as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry from process tree view showing execution of icacls.exe (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-E-11.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed icacls.exe executed to bypass Windows logon (General Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed icacls.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-17.B.2-10.png', 'ScreenshotCaption': 'Telemetry showing icacls.exe executing\xa0 with command-line arguments (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing icacls.exe with command-line arguments. Telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-17-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing icacls.exe (tainted by parent alerts on powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for icalcs.exe changing the permissions of an accessibility feature executable.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing icacls.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe).'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing icacls.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed icacls.exe executing with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing icacls.exe with command-line arguments'}, {'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for icacls.exe changing the permissions of an accessibility feature executable'}, {'ScreenshotName': 'CC-17.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (icacls) has been tagged for monitoring because its parent process has a detection (powershell.exe).'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched icacls.exe with an alert for Icacls Execution. The alert described how icacls can be used to display or change Windows file ACLs.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-17.B.2-1.png', 'ScreenshotCaption': 'Enrichment of icacls.exe with Icacls Execution alert'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe running icacls.exe to modify magnify.exe access controls. The telemetry was tainted by the parent \\"New Windows service created\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing icacls.exe (tainted by the parent \\"New Windows service created\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched icacls.exe with a suspicious indicator that full access permissions were given to certain users.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of icacls.exe with a suspicious indicator that full access permissions were given to certain users'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing icacls.exe. The telemetry was tainted by a trace detection on cmd.exe..', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-17.A.1-1.png', 'ScreenshotCaption': 'Telemetry of reg.exe executing with command-line arguments (tainted by a parent PowerShell alert)'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'Enrichment of icacls.exe with a suspicious indicator that full access permissions were given to certain users'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed icacls.exe execution to change permissions on magnify.exe granting discretionary access to SYSTEM (tainted by prior alert on suspicious PowerShell command-line).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-17.A.1-2.png', 'ScreenshotCaption': 'Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query'}, {'ScreenshotName': 'MS-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing icacls.exe execution with magnify.exe in command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched icalcs.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing icacls with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.B.2-2.png', 'ScreenshotCaption': 'Enrichment of icacls.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing icalcs with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing icacls with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.B.2-2.png', 'ScreenshotCaption': 'Enrichment of icacls.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed icacls.exe execution to change permissions on magnify.exe granting discretionary access to SYSTEM.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-17-1.png', 'ScreenshotCaption': 'Telemetry showing icacls.exe execution with magnify.exe in command-line arguments'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed icacls.exe execution with command-line arguments containing magnify.exe. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-17.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing icacls.exe execution (tainted by prior lateral movement alert by Group ID)'}], 'Footnotes': []}]}]}]}, {'Substep': '17.C.1', 'Procedure': "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", 'Techniques': [{'TechniqueId': 'T1015', 'TechniqueName': 'Accessibility Features', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for powershell.exe with a severity score of 51/100 when magnify.exe was replaced. The alert was also mapped to the correct ATT&CK Technique (T1015 - Accessibility Features).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation and file write replacing magnify.exe in the system directory'}, {'ScreenshotName': 'CB-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed filemod events overwriting magnify.exe in the system directory.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation and file write replacing magnify.exe in the system directory'}, {'ScreenshotName': 'CB-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write of magnify.exe by powershell.exe in the system directory. The telemetry was tainted by an alert on its parent powershell.exe process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing file write of magnify.exe by powershell.exe (tainted by parent powershell.exe high severity alert indicated by red icon)'}, {'ScreenshotName': 'CS-17.C.1-2.png', 'ScreenshotCaption': 'Additional view of telemetry showing the magnify.exe file write'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation and file write events for magnify.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-17.C.1-10.png', 'ScreenshotCaption': 'Telemetry showing creation and write events for magnify.exe (tainted by a parent PowerShell alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated named "Persistence-Accessibility Features" based on magnifier.exe being overwritten. The alert was tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-17-1.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of magnify.exe named \\"Persistence-Accessibility Features\\" tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe)'}, {'ScreenshotName': 'EG-17-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of magnify.exe overwrite with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the magnify.exe overwrite with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-17-1.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of magnify.exe named \\"Persistence-Accessibility Features\\" tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe)'}, {'ScreenshotName': 'EG-17-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of magnify.exe overwrite with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the overwrite of magnify.exe and was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-17-1.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of magnify.exe named \\"Persistence-Accessibility Features\\" tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe)'}, {'ScreenshotName': 'EG-17-2.png', 'ScreenshotCaption': 'Enriched event tree showing enrichment of magnify.exe overwrite with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence) (tainted by parent alerts on powershell.exe, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the modification of an accessibility features binary known to be used for privilege escalation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation'}, {'ScreenshotName': 'CC-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched cmd.exe as being renamed to another process and with a relevant ATT&CK Technique (Masquerading). [CC3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation'}, {'ScreenshotName': 'CC-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command'}], 'Footnotes': ['Screenshot is not available due to sensitivity of rule logic.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe overwriting magnify.exe with cmd.exe via the copy command.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-17.A.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for the modification of an accessibility features binary known to be used for privilege escalation'}, {'ScreenshotName': 'CC-17.B.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe overwriting magnify.exe with cmd.exe via the copy command'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was also generated for Accessibility Features File Write (Weak Signal) based on magnifier.exe being overwritten. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-17.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)'}, {'ScreenshotName': 'FE-17.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)'}, {'ScreenshotName': 'FE-17.C.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for Suspicious Accessibility Features Replacement (BACKDOOR) based on magnifer.exe being overwritten. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-17.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)'}, {'ScreenshotName': 'FE-17.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)'}, {'ScreenshotName': 'FE-17.C.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified magnifer.exe being overwritten with cmd.exe. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-17.C.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)'}, {'ScreenshotName': 'FE-17.C.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)'}, {'ScreenshotName': 'FE-17.C.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe creating and writing magnify.exe to the system directory with the condition \\"Creation of Sticky Keys File.\\" The enrichment was tainted by parent \\"New Windows service created\\" alerts.[CT12]', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-17.C.1-1.png', 'ScreenshotCaption': 'Enrichment showing powershell.exe creating and writing magnify.exe (enriched with condition \\"Creation of Sticky Keys File\\", tainted by the parent \\"New Windows service created\\" alert)'}, {'ScreenshotName': 'CT-17.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing copy of cmd.exe to magnify.exe in the system directory (tainted by the parent \\"New Windows service created\\" alert)'}], 'Footnotes': ["The condition contributing to Enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry also showed a different view of the event with powershell.exe copying cmd.exe as magnify.exe in the system directory. The telemetry was tainted by parent "New Windows service created" alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-17.C.1-1.png', 'ScreenshotCaption': 'Enrichment showing powershell.exe creating and writing magnify.exe (enriched with condition \\"Creation of Sticky Keys File\\", tainted by the parent \\"New Windows service created\\" alert)'}, {'ScreenshotName': 'CT-17.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing copy of cmd.exe to magnify.exe in the system directory (tainted by the parent \\"New Windows service created\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for powershell.exe altering the attributes of an executable file under the Windows system folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing a file modification event for Magnifier.exe'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'A General Behavior alert for powershell.exe altering the attributes of an executable file under the Windows system folder'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file modification event for Magnifier.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing a file modification event for Magnifier.exe'}, {'ScreenshotName': 'MC-17.A.1-9.png', 'ScreenshotCaption': 'A General Behavior alert for powershell.exe altering the attributes of an executable file under the Windows system folder'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for overwrite of magnify.exe indicating a sticky keys binary hijack for persistence was detected.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing overwrite of magnify.exe'}, {'ScreenshotName': 'MS-17.C.1-2.png', 'ScreenshotCaption': 'Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash'}, {'ScreenshotName': 'MS-17.C.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe overwriting magnify.exe with the new file containing the same hash for cmd.exe. Reputation metadata confirms magnify.exe is cmd.exe under the file names observed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing overwrite of magnify.exe'}, {'ScreenshotName': 'MS-17.C.1-2.png', 'ScreenshotCaption': 'Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash'}, {'ScreenshotName': 'MS-17.C.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write events overwriting magnify.exe in the system directory as well as the change in the hash of the file. The telemetry was tainted by a parent alert on cmd.exe.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing file write events overwriting magnify.exe in the system directory (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'PA-17.C.1-2.png', 'ScreenshotCaption': 'Telemetry showing change in the hash of magnify.exe'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event on magnify.exe in the system directory. A search for "cmd" on CodeRed shows the hash value of magnify.exe matches cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-17-1.png', 'ScreenshotCaption': 'Telemetry showing file write to magnify.exe in the system directory'}, {'ScreenshotName': 'RSA-17-2.png', 'ScreenshotCaption': 'Magnify.exe hash matches cmd.exe (top two hashes in Tracking pane, file names and full hash values cut off)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write of magnify.exe in the system directory from a file copy event for cmd.exe with matching hash values. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-17.C.1-1.png', 'ScreenshotCaption': 'Telemetry showing file copy and write events of cmd.exe to overwrite magnify.exe with matching hash values (tainted by prior lateral movement threat story; Group ID not shown in this view)'}], 'Footnotes': []}]}]}]}, {'Substep': '18.A.1', 'Procedure': "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the Get-ChildItem command.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-18.A.1-T1083-new.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing the Get-ChildItem command'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed the decoded PowerShell script that was executed to recursively search for .vsdx files on Conficker's remote file share.", 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-18.A.1-1.png', 'ScreenshotCaption': 'Query showing .vsdx PowerShell file search script that was executed'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an event with the execution of the Get-ChildItem command. The telemetry was tainted by a parent alert on wscript.exe.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-18.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing an event with the execution of the Get-ChildItem command (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '18.B.1', 'Procedure': "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", 'Techniques': [{'TechniqueId': 'T1074', 'TechniqueName': 'Data Staged', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated with a severity score of 60/100 and was correctly mapped to correct ATT&CK Technique (T1074 - Data Staged).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of the .vsdx file in the Recycle Bin'}, {'ScreenshotName': 'CB-18.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed filemod events for the creation and write the .vsdx in the Recycle Bin.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing creation of the .vsdx file in the Recycle Bin'}, {'ScreenshotName': 'CB-18.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was observed the .vsdx file being copied to the Recycle Bin, a \\"likely location to stage files of interest.\\"[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing the .vsdx being written into the Recycle Bin (event_SimpleName of OoxmlFileWritten)'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed the .vsdx file being copied to Recycle Bin for staging (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the .vsdx file being written into the Recycle Bin.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing the .vsdx being written into the Recycle Bin (event_SimpleName of OoxmlFileWritten)'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed the .vsdx file being copied to Recycle Bin for staging (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of the .vsdx file in the Recycle Bin.\xa0\xa0The telemetry was tainted by a parent PowerShell alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-18.B.1-10.png', 'ScreenshotCaption': 'Telemetry of file create/write of vsdx (tainted by a parent PowerShell alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of the .vsdx file in the Recycle Bin. The telemetry was tainted by the parent powershell.exe alerts on " PowerShell with Unusual Arguments" and "PowerShell Network".', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-18-1.png', 'ScreenshotCaption': 'Telemetry showing the file creation of the .vsdx file in the Recycle Bin'}, {'ScreenshotName': 'EG-18-2.png', 'ScreenshotCaption': 'Event tree showing creation of the .vsdx file (tainted by parent alerts on powershell.exe)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker (10.0.0.5) to the Recycle Bin as well as a file create event.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-18.B.1-T1074-new.png', 'ScreenshotCaption': 'Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin'}, {'ScreenshotName': 'CC-18.A.1-4.png', 'ScreenshotCaption': 'Telemetry showing a file create event for the .vsdx file in the Recycle Bin'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on the file write of the .vsdx named File Write To Root Of Recycle Bin (Weak Signal). The alert details explained how all legitimate files should be written to a subfolder of the recycle bin, and not to the root.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert'}, {'ScreenshotName': 'FE-18.B.1-2.png', 'ScreenshotCaption': 'Additional telemetry showing file write of .vsdx with PowerShell File Write alert'}, {'ScreenshotName': 'FE-18.B.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for File Write to Root of Recycle Bin'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the .vsdx file in the Recycle Bin. The telemetry was tainted by the parent PowerShell File Write alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert'}, {'ScreenshotName': 'FE-18.B.1-2.png', 'ScreenshotCaption': 'Additional telemetry showing file write of .vsdx with PowerShell File Write alert'}, {'ScreenshotName': 'FE-18.B.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for File Write to Root of Recycle Bin'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker to the Recycle Bin. The telemetry was tainted by the parent "Powershell executed encoded commands" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing PowerShell copying .vsdx file from network share to Recycle Bin (tainted by the parent \\"Powershell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for PowerShell creating a file in the Recycle Bin. The alert was tagged with the correct ATT&CK Tactic (Collection) and Technique (Data Staged).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing file creation in the Recycle Bin (tainted by parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-18.B.1-9.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell creating a file in the Recycle Bin, tagged with the correct ATT&CK Tactic (Collection) and Technique (Data Staged).'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of the .vsdx file in the Recycle Bin. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing file creation in the Recycle Bin (tainted by parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-18.B.1-9.png', 'ScreenshotCaption': 'Specific Behavior alert for PowerShell creating a file in the Recycle Bin, tagged with the correct ATT&CK Tactic (Collection) and Technique (Data Staged).'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed PowerShell Copy-Item cmdlet execution (no information available about what file is being copied or where the data is coming from).[MS50]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-18.B.1-1.png', 'ScreenshotCaption': 'Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)'}], 'Footnotes': [' Vendor states that by default WDATP monitors activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of test.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read and write events for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) to the Recycle Bin. The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing file read and write events for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) to the Recycle Bin (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write of the .vsdx to the Recycle Bin. The activity seen during the lateral movement step tainted the telemetry because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-18.B.1-1.png', 'ScreenshotCaption': 'Exported telemetry of threat story (taints event) showing .vsdx file copy and write'}], 'Footnotes': []}]}]}]}, {'Substep': '18.B.1', 'Procedure': "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", 'Techniques': [{'TechniqueId': 'T1039', 'TechniqueName': 'Data from Network Shared Drive', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[CB90]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Telemetry was available for the write file of the .vsdx file into the Recycle Bin, but no data was available that indicated it came from a network shared drive.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry was available for the write file of the .vsdx into the Recycle Bin (no data was available that indicated it came from a network shared drive).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. [EG16]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': [' Telemetry was available for the write file of shockwave_network.vsdx into the Recycle Bin, but no data was available that indicated it came from a network shared drive.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker (10.0.0.5) to the Recycle Bin.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-18.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing the copy of the .vsdx file from the network drive to the Recycle Bin'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe copying the .vsdx file from the network shared drive on Conficker to the Recycle Bin. The telemetry was tainted by the parent "Powershell executed encoded commands" alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing PowerShell copying .vsdx file from network share to Recycle Bin (tainted by the parent \\"Powershell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed PowerShell Copy-Item cmdlet execution (no information available about what file is being copied or where the data is coming from).[MS50]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-18.B.1-1.png', 'ScreenshotCaption': 'Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)'}], 'Footnotes': [' Vendor states that by default WDATP monitors activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of test.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a script engine reading files from network locations. The alert was tainted by a parent alert on wscript.exe.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a file event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-18.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a script engine reading files from network locations (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file read event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker). The telemetry was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-18.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing a file event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-18.B.1-2.png', 'ScreenshotCaption': 'Specific Behavior alert for a script engine reading files from network locations (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the .vsdx file copied from a network shared drive on Conficker. The activity seen during the lateral movement step tainted the telemetry because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-18.B.1-1.png', 'ScreenshotCaption': 'Exported telemetry of threat story (taints event) showing .vsdx file copy from network shared drive on Conficker'}], 'Footnotes': []}]}]}]}, {'Substep': '19.A.1', 'Procedure': 'Empire: File dropped to disk is a renamed copy of the WinRAR binary', 'Techniques': [{'TechniqueId': 'T1036', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of recycler.exe. Binary metadata on recycler.exe indicated it was masquerading and had a digital signature and file metadata that matched the WinRAR utility.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing filemod creation of recycler.exe'}, {'ScreenshotName': 'CB-19.A.1-2.png', 'ScreenshotCaption': 'Binary metadata showing recycler.exe is WinRAR.exe based on digital signature and file version information'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the SHA256 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing SHA256 hash of recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that recycler.exe was WinRAR via file metadata. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-19.A.1-100.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe identified as WinRAR via file metadata (tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[EG15]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Telemetry later identified recycler.exe as WinRAR during execution, no detections identified it as WinRAR upon file copy.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified the attacker placing the WinRAR utility on the system as recycler.exe. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing MD5 hash of recycler.exe'}, {'ScreenshotName': 'FE-19.A.1-1.png', 'ScreenshotCaption': 'Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the MD5 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR. The telemetry was tainted by the parent PowerShell File Write alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing MD5 hash of recycler.exe'}, {'ScreenshotName': 'FE-19.A.1-1.png', 'ScreenshotCaption': 'Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though telemetry later identified recycler.exe as WinRAR during execution (no detections identified it as WinRAR upon file copy).[CT5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the MD5/SHA256 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing the MD5/SHA256 hash value of recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of recycler.exe on CodeRed. Binary reputation and metadata for recycler.exe shows hash and publisher signature as win.rar GmbH indicating the file is actually the WinRAR utility.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH'}, {'ScreenshotName': 'MS-19.A.1-2.png', 'ScreenshotCaption': 'Binary reputation and metadata for recycler.exe showing WinRAR information'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the MD5 and SHA256 hash values of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR. The telemetry was tainted by a parent alert on wscript.exe.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing file create/write and hash values of recycler.exe (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.[RS30]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Telemetry later identified recycler.exe as WinRAR during execution, no detections identified it as WinRAR upon file copy.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation event for recycler.exe on CodeRed along with MD5, SHA1, and SHA256 hashes. Hashes could be used to look up information on the binary. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID'}, {'ScreenshotName': 'S1-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing file write of recycler.exe with file hashes'}], 'Footnotes': []}]}]}]}, {'Substep': '19.A.1', 'Procedure': 'Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of recycler.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing filemod (file modification) creation of recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write of recycler.exe by powershell.exe as well as the network connection over which the download occurred. The process tree view showed the parent powershell.exe process as tainted by a previous wscript.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing file write of recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-19.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing network connection from 192.168.0.5 (C2 server) used by powershell.exe to transfer recycler.exe (parent powershell.exe tainted by previous wscript.exe detection by red line indicating high severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file creation of recycler.exe by powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-19.A.1-20.png', 'ScreenshotCaption': 'Telemetry showing file create/write of recycler.exe (tainted by a parent PowerShell alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file creation of recycler.exe by powershell.exe. The telemetry was tainted by parent PowerShell with Unusual Arguments and PowerShell Network alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-19-1.png', 'ScreenshotCaption': 'Telemetry showing file creation of recycler.exe by powershell.exe (tainted by parent PowerShell alerts)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating recycler.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-19.B.1-2.png', 'ScreenshotCaption': 'Telemetry showing the creation of recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it indicated the attacker placed recycler.exe on the system.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-19.A.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)'}, {'ScreenshotName': 'FE-19.A.1-2.png', 'ScreenshotCaption': 'Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe writing recycler.exe with an alert for PowerShell File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactics (Command and Control, Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-19.A.1-1.png', 'ScreenshotCaption': 'Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)'}, {'ScreenshotName': 'FE-19.A.1-2.png', 'ScreenshotCaption': 'Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert called "Policy Dropper Behavior" was generated based on three events occurring in the same parent process within a set time frame, a network connection (TCP Outbound to 192.168.0.5 over 443) followed by an executable file create (powershell.exe creating recycler.exe) followed by a process spawning from that executable (powershell.exe creating the recycler.exe process).', 'Modifiers': ['Configuration Change'], 'Screenshots': [{'ScreenshotName': 'CT-19.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for \\"Policy Dropper Behavior\\" based on three correlated events'}, {'ScreenshotName': 'CT-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing creation of recycler.exe (tainted by \\"Powershell executed encoded commands\\" and \\"Policy Dropper Behavior\\" alerts) and powershell.exe behavior contributing to \\"Policy Dropper Behavior\\" alert'}], 'Footnotes': ['The capability may have been modified after the start of the evaluation to create this alert, so the detection is identified as a configuration change. See Configuration page for details.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating recycler.exe. The telemetry was tainted by parent \\"Powershell executed encoded commands\\" and \\"Policy Dropper Behavior\\" alerts.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-19.A.1-1.png', 'ScreenshotCaption': 'General Behavior alert for \\"Policy Dropper Behavior\\" based on three correlated events'}, {'ScreenshotName': 'CT-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing creation of recycler.exe (tainted by \\"Powershell executed encoded commands\\" and \\"Policy Dropper Behavior\\" alerts) and powershell.exe behavior contributing to \\"Policy Dropper Behavior\\" alert'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation event for recycler.exe', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing file creation event for recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating recycler.exe file (tainted by alert on\xa0PowerShell script with a suspicious command-line was generated by numerous scripts).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH'}, {'ScreenshotName': 'MS-19.A.1-3.png', 'ScreenshotCaption': 'Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for executables created to disk by the Windows scripting engine. The alert was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing the file create and write events for recycler.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-19.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert for PowerShell dropping an executable file to disk (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-19.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert for executables created to disk by the Windows scripting engine (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for PowerShell dropping an executable file to disk. The alert was tainted by a parent alert on wscript.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing the file create and write events for recycler.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-19.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert for PowerShell dropping an executable file to disk (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-19.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert for executables created to disk by the Windows scripting engine (tainted by a parent alert on wscript.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create and write events for recycler.exe. The telemetry was tainted by a parent alert on wscript.exe.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing the file create and write events for recycler.exe (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-19.A.1-2.png', 'ScreenshotCaption': 'General Behavior alert for PowerShell dropping an executable file to disk (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-19.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert for executables created to disk by the Windows scripting engine (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a write file event for recycler.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-19-1.png', 'ScreenshotCaption': 'Telemetry showing file write of recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write of recycler.exe with hash value. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing file write of recycler.exe'}, {'ScreenshotName': 'S1-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry exported from threat story showing recycler.exe file write tainted by prior activity because it was under the same Group ID'}], 'Footnotes': []}]}]}]}, {'Substep': '19.B.1', 'Procedure': 'Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file', 'Techniques': [{'TechniqueId': 'T1002', 'TechniqueName': 'Data Compressed', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched recycler.exe with the correct ATT&CK Technique (1002 - Data Compressed).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for a RAR archive "written by a process with suspicious command line arguments." The alert showed the command-line details and was tagged with the correct ATT&CK Technique (Data Compressed) and Tactic (Exfiltration). The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating they observed a Specific Behavior because a .vsdx file was archived for likely exfiltration using the renamed RAR binary, recycler.exe.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on execution of recycler.exe named "Exfiltration-Encrypting Files with WinRar". The alert was tainted by parent Windows Script Executing PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched recycler.exe with a related ATT&CK Technique (T1022 - Data Encrypted) and Tactic (Exfiltration). The enrichment was tainted by a parent Windows Script Executing PowerShell alert. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data. The telemetry was tainted by parent Windows Script Executing PowerShell alert. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. Additionally recycler.exe was identified as WinRAR via file metadata, including executable product and description. Telemetry also showed the creation of old.rar as the output of recycler.exe running.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it indicated the attacker executed recycler.exe to create an encrypted RAR file old.rar.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the command line output containing -hp with an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the file write of RAR with a second alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed recycler.exe creating old.rar in the Recycle Bin and enriched the data with "Data Exfiltration Archiving" due to the archive file being created. The enrichment was tainted by parent "Powershell executed encoded command" alerts.', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [], 'Footnotes': ["The conditions contributing to Enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating recycler.exe and executing the command-line arguments including the -hp flag indicating WinRAR utility execution with compression and encryption. The telemetry was tainted by parent "Powershell executed encoded commands" and "Policy Dropper Behavior" alerts', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution sequence for recycler.exe with WinRAR command-line arguments, including the -hp flag, for data encryption and compression (tainted by alert on\xa0PowerShell script with a suspicious command-line was generated by numerous scripts).', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent alert on wscript.exe', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS3]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '19.B.1', 'Procedure': 'Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file', 'Techniques': [{'TechniqueId': 'T1022', 'TechniqueName': 'Data Encrypted', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched recycler.exe with the correct ATT&CK Technique (1022 - Data Encrypted).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was created for a RAR archive "written by a process with suspicious command line arguments." Details showed the flags -hp within the command line that indicated use of encryption, and the alert was mapped to a related ATT&CK Technique (Data Compressed) and the correct Tactic (Exfiltration). The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was observed because a .vsdx file was archived for likely exfiltration using the renamed WinRAR binary, recycler.exe.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on execution of recycler.exe named "Exfiltration-Encrypting Files with WinRar". The alert was tainted by parent Windows Script Executing PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched recycler.exe with the correct ATT&CK Technique (T1022 - Data Encrypted) and Tactic (Exfiltration). The enrichment was tainted by parent Windows Script Executing PowerShell alert. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data. The telemetry was tainted by parent Windows Script Executing PowerShell alert. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (recycler) has been tagged for monitoring because its parent process has a detection (powershell.exe).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it observed recycler.exe creating an encrypted RAR archive. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1022 - Data Encrypted).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched recycler.exe writing old.rar to the root of the Recycle Bin with an alert for Rar Archive Created (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed recycler.exe creating old.rar in the Recycle Bin and enriched the data with "Data Exfiltration Archiving" due to the archive file being created. The enrichment was tainted by parent "Powershell executed encoded command" alerts.', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [], 'Footnotes': ["The conditions contributing to Enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating recycler.exe and executing the command-line arguments including the -hp flag indicating WinRAR utility execution with compression and encryption. The telemetry was tainted by parent "Powershell executed encoded commands" and "Policy Dropper Behavior" alerts', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution sequence for recycler.exe with WinRAR command-line arguments, including the -hp flag, for data encryption and compression (tainted by alert on\xa0PowerShell script with a suspicious command-line was generated by numerous scripts).', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS3]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '19.B.1', 'Procedure': 'Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary', 'Techniques': [{'TechniqueId': 'T1036', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on execution of recycler.exe indicating it was WinRAR and was masquerading as a renamed process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR'}, {'ScreenshotName': 'CB-19.B.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-19.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR'}, {'ScreenshotName': 'CB-19.B.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was created for a RAR archive "written by a process with suspicious command line arguments.". Details showed that recycler.exe wrote a RAR archive and that recycler.exe was signed by win.rar GmbH. The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-19.B.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-19.B.1-3.png', 'ScreenshotCaption': 'Additional alert details showing recycler.exe was signed by win.rar GmbH'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was observed because a .vsdx file was archived for likely exfiltration using the renamed WinRAR binary, recycler.exe.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-19.B.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-19.B.1-3.png', 'ScreenshotCaption': 'Additional alert details showing recycler.exe was signed by win.rar GmbH'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-19.B.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert showing recycler.exe was identified as WinRAR (tainted by previous powershell.exe detection by red line indicating high severity)'}, {'ScreenshotName': 'CS-19.B.1-3.png', 'ScreenshotCaption': 'Additional alert details showing recycler.exe was signed by win.rar GmbH'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed a .vsdx file archived using the renamed RAR binary, recycler.exe (Specific Behavior)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-19.B.1-20.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe execution\xa0(tainted by a parent PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on execution of recycler.exe named "Exfiltration-Encrypting Files with WinRar". The alert was tainted by parent Windows Script Executing PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-19-4.png', 'ScreenshotCaption': 'Specific Behavior alert for the execution of recycler.exe named \\"Exfiltration-Encrypting Files with WinRar\\" (tainted by Windows Script Executing PowerShell alert)'}, {'ScreenshotName': 'EG-19-1.png', 'ScreenshotCaption': 'Telemetry showing execution of recycler.exe with command-line arguments and creation of old.rar output (tainted by Windows Script Executing PowerShell alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by parent Windows Script Executing PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-19-4.png', 'ScreenshotCaption': 'Specific Behavior alert for the execution of recycler.exe named \\"Exfiltration-Encrypting Files with WinRar\\" (tainted by Windows Script Executing PowerShell alert)'}, {'ScreenshotName': 'EG-19-1.png', 'ScreenshotCaption': 'Telemetry showing execution of recycler.exe with command-line arguments and creation of old.rar output (tainted by Windows Script Executing PowerShell alert)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. Additionally recycler.exe was identified as WinRAR via file metadata, including executable product and description.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-19.B.1-4.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe metadata, which identified it as WinRAR'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it observed recycler.exe creating an encrypted RAR archive.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-19.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for Execution from Suspicious Directory'}, {'ScreenshotName': 'FE-19.B.1-2.png', 'ScreenshotCaption': 'Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)'}, {'ScreenshotName': 'FE-19.B.1-3.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.B.1-4.png', 'ScreenshotCaption': 'General Behavior alert for File Write To Root Of Recycle Bin'}, {'ScreenshotName': 'FE-19.B.1-5.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-19.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for Execution from Suspicious Directory'}, {'ScreenshotName': 'FE-19.B.1-2.png', 'ScreenshotCaption': 'Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)'}, {'ScreenshotName': 'FE-19.B.1-3.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.B.1-4.png', 'ScreenshotCaption': 'General Behavior alert for File Write To Root Of Recycle Bin'}, {'ScreenshotName': 'FE-19.B.1-5.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-19.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for Execution from Suspicious Directory'}, {'ScreenshotName': 'FE-19.B.1-2.png', 'ScreenshotCaption': 'Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)'}, {'ScreenshotName': 'FE-19.B.1-3.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.B.1-4.png', 'ScreenshotCaption': 'General Behavior alert for File Write To Root Of Recycle Bin'}, {'ScreenshotName': 'FE-19.B.1-5.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with related ATT&CK Techniques (T1022 - Data Encrypted and T1002 - Data Compressed).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-19.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for Execution from Suspicious Directory'}, {'ScreenshotName': 'FE-19.B.1-2.png', 'ScreenshotCaption': 'Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)'}, {'ScreenshotName': 'FE-19.B.1-3.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.B.1-4.png', 'ScreenshotCaption': 'General Behavior alert for File Write To Root Of Recycle Bin'}, {'ScreenshotName': 'FE-19.B.1-5.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched recycler.exe writing old.rar to the root of the Recycle Bin with an alert for Rar Archive Created (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-19.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for Execution from Suspicious Directory'}, {'ScreenshotName': 'FE-19.B.1-2.png', 'ScreenshotCaption': 'Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)'}, {'ScreenshotName': 'FE-19.B.1-3.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.B.1-4.png', 'ScreenshotCaption': 'General Behavior alert for File Write To Root Of Recycle Bin'}, {'ScreenshotName': 'FE-19.B.1-5.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-19.B.1-1.png', 'ScreenshotCaption': 'General Behavior alert for Execution from Suspicious Directory'}, {'ScreenshotName': 'FE-19.B.1-2.png', 'ScreenshotCaption': 'Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)'}, {'ScreenshotName': 'FE-19.B.1-3.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.B.1-4.png', 'ScreenshotCaption': 'General Behavior alert for File Write To Root Of Recycle Bin'}, {'ScreenshotName': 'FE-19.B.1-5.png', 'ScreenshotCaption': 'Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)'}, {'ScreenshotName': 'FE-19.A.1-3.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability showed recycler.exe creating old.rar in the Recycle Bin and enriched the data with "Data Exfiltration Archiving" due to the archive file being created. The enrichment was tainted by parent "Powershell executed encoded command" alerts.', 'Modifiers': ['Configuration Change', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-19.B.1-1.png', 'ScreenshotCaption': 'Enrichment showing recycler.exe creating old.rar (enriched with \\"Data Exfiltration Archiving\\", tainted by parent \\"Powershell executed encoded command\\" alerts)'}, {'ScreenshotName': 'CT-19.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe with full command-line (tainted by parent \\"Powershell executed encoded commands\\" and \\"Policy Dropper Behavior\\" alerts)'}], 'Footnotes': ["The conditions contributing to Enrichment may have been added to the capability's detection after the start of the evaluation, so the detection is identified as a configuration change. See Configuration page for details."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating recycler.exe and executing the command-line arguments including the -hp flag indicating WinRAR utility execution with compression and encryption. The telemetry was tainted by parent "Powershell executed encoded commands" and "Policy Dropper Behavior" alerts.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-19.B.1-1.png', 'ScreenshotCaption': 'Enrichment showing recycler.exe creating old.rar (enriched with \\"Data Exfiltration Archiving\\", tainted by parent \\"Powershell executed encoded command\\" alerts)'}, {'ScreenshotName': 'CT-19.B.1-3.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe with full command-line (tainted by parent \\"Powershell executed encoded commands\\" and \\"Policy Dropper Behavior\\" alerts)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing the execution of recycler.exe with command-line arguments (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-19.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing the creation of old.rar (tainted by a parent alert on cmd.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution sequence for recycler.exe with RAR command-line arguments, including the -hp flag, for data encryption and compression indicating it was actually WinRAR masquerading as a different file (tainted by alert on\xa0PowerShell script with a suspicious command-line was generated by numerous scripts).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-19.A.1-3.png', 'ScreenshotCaption': 'Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)'}, {'ScreenshotName': 'MS-19.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression indicating it is WinRAR'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-19.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-19.B.1-2.png', 'ScreenshotCaption': 'Enrichment of recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent alert on wscript.exe', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-19.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing recycler.exe execution (tainted by a parent alert on wscript.exe)'}, {'ScreenshotName': 'PA-19.B.1-2.png', 'ScreenshotCaption': 'Enrichment of recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading)'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS4][RS3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-19-1.png', 'ScreenshotCaption': 'Telemetry showing execution of recycler.exe with command-line arguments indicating it is WinRAR'}], 'Footnotes': ['Vendor stated file hash is also available that could be used with sources like Virustotal to identify the binary. YARA is also supported and rules could be created to identify WinRAR.', 'Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The Process Name field in the row for recycler.exe enriched the event with "Command line RAR". The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-19.B.1-1.png', 'ScreenshotCaption': 'Enrichment showing the execution of recycler.exe with process name identified as \\"Command line RAR\\"'}, {'ScreenshotName': 'S1-19.A.1-2.png', 'ScreenshotCaption': 'Telemetry exported from threat story showing execution of recycler.exe was tainted by prior activity because it was under the same Group ID'}], 'Footnotes': []}]}]}]}, {'Substep': '19.C.1', 'Procedure': "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", 'Techniques': [{'TechniqueId': 'T1048', 'TechniqueName': 'Exfiltration Over Alternative Protocol', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ftp.exe with the correct ATT&CK Technique (Exfil Over Alternate Protocol).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process tree for ftp.exe being executed with command-line arguments including ftp.txt.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was observed because collected files were exfiltrated via FTP.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating ftp.exe executing with ftp.txt was suspicious. The process tree view showed ftp.exe as tainted by a previous powershell.exe detection.[CS1]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [], 'Footnotes': ['OverWatch is the managed threat hunting service.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the OverWatch alert showed ftp.exe executing with ftp.txt.[CS2]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ftp.exe execution with a related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol). The data was tainted by a parent PowerShell alert.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of ftp.exe and command-line arguments. [CR5]', 'Modifiers': [], 'Screenshots': [], 'Footnotes': [' The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of ftp.txt and ftp.exe executing with command-line arguments. Telemetry also showed the FTP connection to 192.168.0.4 (C2 server) on port 21.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the execution of ftp.exe with a command file option by an unusual parent process and could be used for exfiltration.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it observed the ftp commands being written to ftp.txt and the subsequent execution of ftp.exe with the file. The old.rar file was seen uploaded to 192.168.0.4 (C2 server). [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a TCP port 21 connection to 192.168.0.4 (C2 server) with an alert for FTP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1048 - Exfiltration Over Alternative Protocol) and Tactic (Exfiltration).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ftp.exe execution with an alert for FTP Utility Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Software (T0095 - FTP).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ftp.exe with the -s argument with a separate alert for FTP Utility Execution (Weak Signal).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ftp.exe with ftp.txt as an argument as well as an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21. The telemetry was tainted by the parent \\"Powershell executed encoded commands\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched powershell.exe executing ftp.exe with the correct ATT&CK Tactic (Exfiltration) and Technique (Exfiltration over Alternative Protocol) and a suspicious indicator that a connection was made to a remove server via the ftp protocol.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ftp.exe, which made an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution sequence for ftp.exe with command-line arguments including ftp.txt (tainted by alert on\xa0PowerShell script with a suspicious command-line was generated by numerous scripts). Telemetry also showed connections to 192.168.0.4 (C2 server) on ports 20 and 21 for the FTP connection.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched ftp.exe as the execution of a CLI file transfer/copy utility. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of ftp.exe and command-line arguments as well as a an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of ftp.exe with command-line arguments, including ftp.txt, for exfiltration. The contents of ftp.txt was not seen.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed ftp.exe running with ftp.txt as an argument. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '19.D.1', 'Procedure': 'Empire: \'del C:\\"$"Recycle.bin\\old.rar\'', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of old.rar.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing filemod (file modification) deletion of old.rar'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was observed because files (including old.rar) were deleted from the host CodeRed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing deletion of old.rar'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed old.rar being deleted (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of old.rar with an event name of FileDeleted.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing deletion of old.rar'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed old.rar being deleted (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a deletion event for old.rar via powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-19.D.1-10.png', 'ScreenshotCaption': 'Telemetry showing a deletion event for old.rar via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though there was telemetry to show the creation of old.rar. A host query for the file showed the old.rar no longer exists, but no deletion event was seen.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the command to delete old.rar.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing the deletion of old.rar'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe deleting old.rar from the Recycle Bin. The telemetry was tainted by the parent \\"PowerShell executed encoded commands\\" alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe deleting old.rar (tainted by the parent \\"PowerShell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed execution sequence for the PowerShell "Remove-Item" cmdlet (no arguments were available to indicate what was deleted).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing PowerShell executing the Remove-Item cmdlet (does not count as a detection)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file delete event for old.rar. The telemetry was tainted by a parent alert on wscript.exe.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing the file delete event for old.rar (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. [RS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-19-3.png', 'ScreenshotCaption': 'Master file table on 10.0.1.5 (CodeRed) shows old.rar listed under deleted files (does not count as a detection)'}], 'Footnotes': ['The master file table on 10.0.1.5 (CodeRed) was\xa0inspected through the capability to look for deleted files, showing old.rar.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file deletion of old.rar. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry exported from threat story showing the deletion of old.rar was tainted by prior activity because it was under the same Group ID'}], 'Footnotes': []}]}]}]}, {'Substep': '19.D.2', 'Procedure': "Empire: 'del recycler.exe'", 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of recycler.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing filemod (file modification) deletion of recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The OverWatch team sent an email indicating a Specific Behavior was observed because files (including recycler.exe) were deleted from the host CodeRed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-19.D.1-2.png', 'ScreenshotCaption': 'Telemetry showing deletion of recycler.exe'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed recycler.exe being deleted (Specific Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of recycler.exe with an event name of ExecutableDeleted.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-19.D.1-2.png', 'ScreenshotCaption': 'Telemetry showing deletion of recycler.exe'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt sent by OverWatch team indicating they observed recycler.exe being deleted (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a deletion event for recycler.exe via powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-19.D.2-10.png', 'ScreenshotCaption': 'Telemetry showing a deletion event for recycler.exe via powershell.exe (tainted by a parent PowerShell alert, listed as Owner process)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a deletion event for recycler.exe caused by powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-19-3.png', 'ScreenshotCaption': 'Telemetry showing file deletion of recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the command to delete recycler.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing the deletion of recycler.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe deleting recycler.exe. The telemetry was tainted by the parent \\"PowerShell executed encoded commands alert\\".[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-19.D.2-1.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe deleting recycler.exe (tainted by the parent \\"PowerShell executed encoded commands\\" alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched PowerShell deleting recylcer.exe with the correct ATT&CK Tactic (Defense Evasion) and Technique (File Deletion) and a suspicious indicator that an executable file was deleted from the system root folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing file deletion event for recycler.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-19.D.1-9.png', 'ScreenshotCaption': 'Enrichment of PowerShell deleting recylcer.exe with the correct ATT&CK Tactic (Defense Evasion) and Technique (File Deletion) and a suspicious indicator that an executable file was deleted from the system root folder'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file deletion event for recycler.exe. The telemetry was tainted by a trace detection on cmd.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing file deletion event for recycler.exe (tainted by a parent alert on cmd.exe)'}, {'ScreenshotName': 'MC-19.D.1-9.png', 'ScreenshotCaption': 'Enrichment of PowerShell deleting recylcer.exe with the correct ATT&CK Tactic (Defense Evasion) and Technique (File Deletion) and a suspicious indicator that an executable file was deleted from the system root folder'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file delete event for recycler.exe. The telemetry was tainted by a parent alert on wscript.exe.[PA7]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'PA-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry showing the file delete event for recycler.exe (tainted by a parent alert on wscript.exe)'}], 'Footnotes': ['The process tree showing taintedness is visible within the same UI but did not fit within the current frame.']}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file deletion of recycler.exe. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'S1-19.D.1-1.png', 'ScreenshotCaption': 'Telemetry exported from threat story showing the deletion of recycler.exe was tainted by prior activity because it was under the same Group ID'}], 'Footnotes': []}]}]}]}, {'Substep': '20.A.1', 'Procedure': 'magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)', 'Techniques': [{'TechniqueId': 'T1015', 'TechniqueName': 'Accessibility Features', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on execution of magnify.exe named "Suspicious screen magnifier\xa0process" with a 76/100 severity score.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree telemetry showing magnify.exe execution'}, {'ScreenshotName': 'CB-20.B.1-2.png', 'ScreenshotCaption': 'Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\xa0showing red severity scores'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated named "Execution of cmd from non-standard path" with a 60/100 severity score.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree telemetry showing magnify.exe execution'}, {'ScreenshotName': 'CB-20.B.1-2.png', 'ScreenshotCaption': 'Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\xa0showing red severity scores'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated named "Suspicious renamed cmd process" with a 72/100 severity score.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree telemetry showing magnify.exe execution'}, {'ScreenshotName': 'CB-20.B.1-2.png', 'ScreenshotCaption': 'Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\xa0showing red severity scores'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree that showed magnify.exe executing from utilman.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree telemetry showing magnify.exe execution'}, {'ScreenshotName': 'CB-20.B.1-2.png', 'ScreenshotCaption': 'Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\xa0showing red severity scores'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on utilman.exe executing magnify.exe, noting that "a process chain bypassed Windows logon security." The alert was marked critical and was mapped to the correct ATT&CK Technique (Accessibility Features) and Tactic (Persistence). Data in the alert also showed that magnify.exe was identified as cmd.exe based on hash value in the common name field.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-20.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)'}, {'ScreenshotName': 'CS-20.A.1-2.png', 'ScreenshotCaption': 'File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)'}], 'Footnotes': []}, {'DetectionType': 'General Behavior', 'DetectionNote': 'OverWatch generated a General Behavior alert indicating a Windows logon bypass on Creeper was observed.[CS9]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'CS-20.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)'}, {'ScreenshotName': 'CS-20.A.1-2.png', 'ScreenshotCaption': 'File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)'}], 'Footnotes': ['OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the alert showed the details for magnify.exe, and would also be available in a separate view.[CS2]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-20.A.1-1.png', 'ScreenshotCaption': 'Specific Behavior alert showing magnify.exe executing from utilman.exe (mapped to correct ATT&CK Technique, Accessibility Features, and Tactic, Persistence; pink indicates critical severity)'}, {'ScreenshotName': 'CS-20.A.1-2.png', 'ScreenshotCaption': 'File details of magnify.exe in Accessibility Features Specific Behavior alert identifying it as cmd.exe by hash and common name'}, {'ScreenshotName': 'CS-E-12.png', 'ScreenshotCaption': 'Email excerpt from the OverWatch team indicating they observed a Windows logon bypass (General Behavior)'}], 'Footnotes': ['For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated based on a new process masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-20.A.1-10.png', 'ScreenshotCaption': 'Specific Behavior alert for magnify.exe\xa0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)'}, {'ScreenshotName': 'CR-20.A.1-11.png', 'ScreenshotCaption': 'Specific Behavior alert for magnify.exe, in process tree,\xa0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of magnify.exe. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-20.A.1-10.png', 'ScreenshotCaption': 'Specific Behavior alert for magnify.exe\xa0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)'}, {'ScreenshotName': 'CR-20.A.1-11.png', 'ScreenshotCaption': 'Specific Behavior alert for magnify.exe, in process tree,\xa0masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on Windows File Name Mismatch between magnify.exe and cmd.exe, indicating this could be used for accessibility features in the description. The alert is tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-20-1.png', 'ScreenshotCaption': 'Specific Behavior alert on Windows File Name Mismatch showing magnify.exe was renamed from cmd.exe and tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution)'}, {'ScreenshotName': 'EG-20-2.png', 'ScreenshotCaption': 'Enrichment of magnify.exe with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched magnify.exe with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by the Windows File Name Mismatch alert). [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-20-1.png', 'ScreenshotCaption': 'Specific Behavior alert on Windows File Name Mismatch showing magnify.exe was renamed from cmd.exe and tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution)'}, {'ScreenshotName': 'EG-20-2.png', 'ScreenshotCaption': 'Enrichment of magnify.exe with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry in the event tree showed the execution of magnify.exe by utilman.exe (tainted by the Windows File Name Mismatch alert). [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-20-1.png', 'ScreenshotCaption': 'Specific Behavior alert on Windows File Name Mismatch showing magnify.exe was renamed from cmd.exe and tagged with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution)'}, {'ScreenshotName': 'EG-20-2.png', 'ScreenshotCaption': 'Enrichment of magnify.exe with correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Defense Evasion, Execution) (tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for magnify.exe executing as a process with a renamed executable.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-20.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing me magnify.exe executing from utilman.exe'}, {'ScreenshotName': 'CC-20.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for magnify.exe executing as a process with a renamed executable'}, {'ScreenshotName': 'CC-20.A.1-7.png', 'ScreenshotCaption': 'Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-20.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing me magnify.exe executing from utilman.exe'}, {'ScreenshotName': 'CC-20.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for magnify.exe executing as a process with a renamed executable'}, {'ScreenshotName': 'CC-20.A.1-7.png', 'ScreenshotCaption': 'Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed magnify.exe executing from utilman.exe with the original file name of cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-20.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing me magnify.exe executing from utilman.exe'}, {'ScreenshotName': 'CC-20.A.1-4.png', 'ScreenshotCaption': 'General Behavior alert for magnify.exe executing as a process with a renamed executable'}, {'ScreenshotName': 'CC-20.A.1-7.png', 'ScreenshotCaption': 'Enrichment of utilman.exe executing magnify.exe with a tag indicating that magnify was a persistent backdoor'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for Accessibility Features Child Process due to whoami.exe spawning from magnify.exe. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Persistence, Privilege Escalation).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-20.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert for RENAMED CMD.EXE'}, {'ScreenshotName': 'FE-20.A.1-4.png', 'ScreenshotCaption': 'Continued details for General Behavior alert for RENAMED CMD.EXE'}, {'ScreenshotName': 'FE-20.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)'}, {'ScreenshotName': 'FE-20.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)'}], 'Footnotes': []}, {'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell. [FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-20.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert for RENAMED CMD.EXE'}, {'ScreenshotName': 'FE-20.A.1-4.png', 'ScreenshotCaption': 'Continued details for General Behavior alert for RENAMED CMD.EXE'}, {'ScreenshotName': 'FE-20.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)'}, {'ScreenshotName': 'FE-20.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated for RENAMED CMD.EXE, with a description explaining how attackers will sometimes rename cmd.exe to other filenames to try to bypass detections.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-20.A.1-3.png', 'ScreenshotCaption': 'General Behavior alert for RENAMED CMD.EXE'}, {'ScreenshotName': 'FE-20.A.1-4.png', 'ScreenshotCaption': 'Continued details for General Behavior alert for RENAMED CMD.EXE'}, {'ScreenshotName': 'FE-20.A.1-5.png', 'ScreenshotCaption': 'Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)'}, {'ScreenshotName': 'FE-20.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed magnify.exe executing from parent process utilman.exe (PID 3996). The telemetry was tainted by the parent POS Interactive Login Event alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe (tainted by the parent POS Interactive Login Event alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the command prompt tool executed by masquerading an accessibility tool. The alert was tagged with the correct ATT&CK Tactics (Persistence, Privilege Escalation) and Technique (Accessibility Features).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-20.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe (original name identified as cmd.exe) executing from utilman.exe (tainted by a trace detection on magnify.exe)'}, {'ScreenshotName': 'MC-20.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for the command prompt tool executed by masquerading an accessibility tool. The alert was tagged with the correct ATT&CK Tactics (Persistence, Privilege Escalation) and Technique (Accessibility Features)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed magnify.exe (original name identified as cmd.exe) executing from utilman.exe. The telemetry was tainted by a trace detection on magnify.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-20.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe (original name identified as cmd.exe) executing from utilman.exe (tainted by a trace detection on magnify.exe)'}, {'ScreenshotName': 'MC-20.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for the command prompt tool executed by masquerading an accessibility tool. The alert was tagged with the correct ATT&CK Tactics (Persistence, Privilege Escalation) and Technique (Accessibility Features)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated on a successful sticky keys binary hijack because magnify.exe was executing as cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-20.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing sequence of magnify.exe executing from utilman.exe'}, {'ScreenshotName': 'MS-20.A.1-4.png', 'ScreenshotCaption': 'Specific Behavior alert on sticky keys binary hijack of magnify.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of magnify.exe from utilman.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-20.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing sequence of magnify.exe executing from utilman.exe'}, {'ScreenshotName': 'MS-20.A.1-4.png', 'ScreenshotCaption': 'Specific Behavior alert on sticky keys binary hijack of magnify.exe'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed magnify.exe executing from utilman.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-20.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe executing from utilman.exe'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of magnify.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-20-1.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe execution'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of magnify.exe which was identified as a Windows Command Processor within the interface. Activity associated with a new story (Group ID).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe execution (identified as Windows Command Processor)'}], 'Footnotes': []}]}]}]}, {'Substep': '20.A.1', 'Procedure': 'RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism', 'Techniques': [{'TechniqueId': 'T1076', 'TechniqueName': 'Remote Desktop Protocol', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a logon type 10 (remote interactive logon) for Kmitnick on Creeper, indicating a RDP session was established and logged into.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CS-20.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing logon type 10 (remote interactive logon) for Kmitnick on Creeper'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a RDP connection with information that the connection was made to a RDP port, as well as a related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-20.A.1-21.png', 'ScreenshotCaption': 'Enrichment of RDP connection to\xa0Creeper (10.0.0.4) identified as using RDP Port and related ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port, Standard Application Layer Protocol)'}, {'ScreenshotName': 'CR-20.A.1-20.png', 'ScreenshotCaption': 'Telemetry of connection to port 3389 on Creeper (10.0.0.4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of a RDP session on Creeper (10.0.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-20.A.1-21.png', 'ScreenshotCaption': 'Enrichment of RDP connection to\xa0Creeper (10.0.0.4) identified as using RDP Port and related ATT&CK Tactic (Command and Control) and Technique (Commonly Used Port, Standard Application Layer Protocol)'}, {'ScreenshotName': 'CR-20.A.1-20.png', 'ScreenshotCaption': 'Telemetry of connection to port 3389 on Creeper (10.0.0.4)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to port 3389 on Creeper (10.0.0.4) with information transmitted in bytes indicating a RDP session was established.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'EG-20-3.png', 'ScreenshotCaption': 'Telemetry showing connection to Creeper (10.0.0.4) on port 3389'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a Remote Desktop connection indicating a successful login to Remote Desktop Services.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-20.A.1-2.png', 'ScreenshotCaption': 'Enrichment of a Remote Desktop connection indicating a successful login to Remote Desktop Services.'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'The Managed Defense Report indicated a Specific Behavior occurred because it identified the use of the Remote Desktop Protocol to connect to Creeper.[FE5]', 'Modifiers': ['Delayed'], 'Screenshots': [{'ScreenshotName': 'FE-20.A.1-1.png', 'ScreenshotCaption': 'Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-20.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)'}], 'Footnotes': [" Managed Defense Reports are reports provided by FireEye's managed detection and response (MDR) service. FireEye provided reports to MITRE after the completion of the evaluation to mimic what they would produce in a real incident."]}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched a TCP port 3389 connection with an alert for RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-20.A.1-1.png', 'ScreenshotCaption': 'Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)'}, {'ScreenshotName': 'FE-20.A.1-2.png', 'ScreenshotCaption': 'Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an inbound connection to Creeper (10.0.0.4) on port 3389.[CT5]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CT-20.A.1-1.png', 'ScreenshotCaption': 'Telemetry showing connection to Creeper (10.0.0.4) on port 3389'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of a terminal services session on Creeper from CodeRed with corresponding logon by Kmitnick.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MS-20.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe starting terminal service session on Creeper from CodeRed (10.0.1.5)'}, {'ScreenshotName': 'MS-20.A.1-3.png', 'ScreenshotCaption': 'Telemetry showing Kmitnick RDP logon from CodeRed to Creeper'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an inbound connection to Creeper (10.0.0.4) on port 3389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-20.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing an inbound connection to Creeper (10.0.0.4) on port 3389'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '20.B.1', 'Procedure': "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'CarbonBlack', 'DisplayName': 'Carbon Black', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree with telemetry showing whoami.exe execution'}, {'ScreenshotName': 'CB-20.B.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe\xa0with correct ATT&CK Technique (T1033 - System Owner/User Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry within the process tree showed magnify.exe executing whoami.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CB-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree with telemetry showing whoami.exe execution'}, {'ScreenshotName': 'CB-20.B.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe\xa0with correct ATT&CK Technique (T1033 - System Owner/User Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of whoami.exe. The process tree view showed whoami.exe was tainted by a previous magnify.exe detection.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CS-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry from process tree showing magnify.exe child process whoami.exe (tainted by pink line indicating critical severity)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated based on whoami.exe performing Reconnaissance as a SYSTEM user. The alert was tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery). The alert was tainted by a parent Accessibility Features alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CR-20.B.1-10.png', 'ScreenshotCaption': 'Specific Behavior alert for whoami.exe execution with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent Accessibility Features alert)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of whoami.exe. [CR3]', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CR-20.B.1-10.png', 'ScreenshotCaption': 'Specific Behavior alert for whoami.exe execution with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery) (tainted by a parent Accessibility Features alert)'}], 'Footnotes': [' For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery). The enrichment was tainted by an alert on Windows File Name Mismatch-Accessibility Features. [EG11]', 'Modifiers': ['Delayed', 'Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-20-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing execution of whoami.exe (tainted by parent alert on magnify.exe)'}, {'ScreenshotName': 'EG-20-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery)\xa0(tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed whoami.exe was executed from magnify.exe. The telemetry was tainted by an alert on Windows File Name Mismatch-Accessibility Features. [EG11]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'EG-20-1.png', 'ScreenshotCaption': 'Telemetry from event tree showing execution of whoami.exe (tainted by parent alert on magnify.exe)'}, {'ScreenshotName': 'EG-20-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery)\xa0(tainted by Windows File Name Mismatch alert, tree is initially available unenriched to show the base telemetry)'}], 'Footnotes': [' Telemetry is immediately available within the event tree and then can be enriched with ATT&CK Techniques and Tactics, so this is counted as two detections.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General Behavior', 'DetectionNote': 'A General Behavior alert was generated showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-20.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing the execution of whoami'}, {'ScreenshotName': 'CC-20.A.1-6.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-20.A.1-7.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)'}], 'Footnotes': []}, {'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe with a tag identifying the command as enumeration.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-20.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing the execution of whoami'}, {'ScreenshotName': 'CC-20.A.1-6.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-20.A.1-7.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed whoami.exe was executed from magnify.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CC-20.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing the execution of whoami'}, {'ScreenshotName': 'CC-20.A.1-6.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with a tag identifying the command as enumeration'}, {'ScreenshotName': 'CC-20.A.1-7.png', 'ScreenshotCaption': 'General Behavior alert showing that a spawned process (whoami) has been tagged for monitoring because its parent process has a detection (magnify.exe)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe with an alert for Whoami Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FE-20.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)'}, {'ScreenshotName': 'FE-20.A.1-6.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed whoami.exe executing from magnify.exe within an alert for Accessibility Features Child Process. The telemetry was tainted by the Accessibility Features Child Process (METHODOLOGY) alert.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'FE-20.A.1-5.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)'}, {'ScreenshotName': 'FE-20.A.1-6.png', 'ScreenshotCaption': 'Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed magnify.exe executing whoami.exe. The telemetry was tainted by the parent POS Interactive Login Event alert.[CT5]', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'CT-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe executing whoami.exe (tainted by the parent POS Interactive Login Event alert)'}], 'Footnotes': ['Vendor modified configurations between scenario one and two, but MITRE assesses the change did not significantly affect results for this detection. See Configuration page for details.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Specific Behavior', 'DetectionNote': 'A Specific Behavior alert was generated for the whoami command was executed through a masqueraded tool (magnify.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MC-20.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe (original name identified as cmd.exe) executing whoami.exe (tainted by a trace detection on magnify.exe)'}, {'ScreenshotName': 'MC-20.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for the whoami command was executed through a masqueraded tool (magnify.exe)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed magnify.exe (original name identified as cmd.exe) executing whoami.exe. The telemetry was tainted by a trace detection on magnify.exe.', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MC-20.A.1-2.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe (original name identified as cmd.exe) executing whoami.exe (tainted by a trace detection on magnify.exe)'}, {'ScreenshotName': 'MC-20.A.1-3.png', 'ScreenshotCaption': 'Specific Behavior alert for the whoami command was executed through a masqueraded tool (magnify.exe)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed whoami.exe executing from magnify.exe (tainted by sticky keys binary hijack alert).', 'Modifiers': ['Tainted'], 'Screenshots': [{'ScreenshotName': 'MS-20.A.1-1.png', 'ScreenshotCaption': 'Execution sequence showing whoami.exe executing from magnify.exe'}, {'ScreenshotName': 'MS-20.A.1-4.png', 'ScreenshotCaption': 'Process tree view of sticky keys binary hijack alert showing tainted relationship to whoami.exe'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'The capability enriched whoami.exe executing as an enumeration command.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe executing whoami.exe'}, {'ScreenshotName': 'PA-20.B.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe executing as an enumeration command'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed magnify.exe executing whoami.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'PA-20.B.1-1.png', 'ScreenshotCaption': 'Telemetry showing magnify.exe executing whoami.exe'}, {'ScreenshotName': 'PA-20.B.1-2.png', 'ScreenshotCaption': 'Enrichment of whoami.exe executing as an enumeration command'}], 'Footnotes': []}]}, {'VendorName': 'RSA', 'DisplayName': 'RSA', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of whoami.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'RSA-20-1.png', 'ScreenshotCaption': 'Telemetry showing whoami.exe execution'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Enrichment', 'DetectionNote': 'Enrichment showed execution of the whoami command (enriched with description "whoami - displays logged on user information"). Execution of whoami was associated to the story (Group ID) created from the execution of magnify.exe, but was not considered tainted because an alert was not generated when magnify.exe was executed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'S1-20.B.1-1.png', 'ScreenshotCaption': 'Enrichment of whoami command (displays logged on user information)'}], 'Footnotes': []}]}]}]}]},
        "APT29": {'Round': '2', 'Steps': [{'Substep': '1.A.1', 'Procedure': 'User Pam executed payload rcs.3aka3.doc', 'Criteria': 'The rcs.3aka3.doc process spawning from explorer.exe', 'Techniques': [{'TechniqueId': 'T1204', 'TechniqueName': 'User Execution', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity) for Antimalware was generated for explorer.exe executing rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-637.png', 'ScreenshotCaption': 'antimalware alert \nincluded both these images for now since antimalware is pretty important but does not show pam executing '}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated for the execution of a rogue unusual executable.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-639.png', 'ScreenshotCaption': 'rouge executable - most likely based on name'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-636.png', 'ScreenshotCaption': 'image showing pam execution'}, {'ScreenshotName': 'Bitdefender-APT29-642.png', 'ScreenshotCaption': 'process create for 3.scr file - this data is a view with more details'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General', 'DetectionNote': "A General alert detection (yellow indicator) was generated for a suspicious file meeting the sensor's low-confidence threshold for a malicious file.", 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10176.png', 'ScreenshotCaption': 'A general detection showing explorer.exe executing rcs.3aka.doc.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for the suspicious execution of the rcs.3aka3.doc file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10184.png', 'ScreenshotCaption': 'MSSP Alert for the rcs.3aka3.doc file.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10179.png', 'ScreenshotCaption': 'A process tree showing explorer.exe executing rcs.3aka.doc.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) including "User Execution" was generated when explorer.exe executed rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14868.png', 'ScreenshotCaption': 'Execution of malicious file. Level 4 alert (red). After scan occured, selected NASHUA and look through logs.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection including "User Execution" was received that included a description of rcs.3aka3.doc and its execution.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-11803.png', 'ScreenshotCaption': '1.A.1, 1.A.3 - MDR Report Day 1'}, {'ScreenshotName': 'CyCraft-APT29-12218.png', 'ScreenshotCaption': '1.A.1 - MDR Report Day 1'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; unique symbol) called "User Execution" was generated due to explorer.exe executing rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7330.png', 'ScreenshotCaption': '1.a.1 - process tree for user execution'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for rcs.3aka3.doc being identified as unknown malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7333.png', 'ScreenshotCaption': '1.a.1 - timestamp included for user execution alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7333.png', 'ScreenshotCaption': '1.a.1 - timestamp included for user execution alert'}, {'ScreenshotName': 'Cybereason-APT29-7330.png', 'ScreenshotCaption': '1.a.1 - process tree for user execution'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated identifying rcs.3aka3.doc as malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11822.png', 'ScreenshotCaption': 'Information about the payload'}], 'Footnotes': ['According to the vendor, this would have been prevented due to rcs.3aka3.doc being identified as malware.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "process spawning with an uncommon file extension" occurred containing evidence of explorer.exe executing rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12895.png', 'ScreenshotCaption': 'MSSP - A1 - Alert + Correlation view'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11820.png', 'ScreenshotCaption': 'A1/2 - explorer executing payload and file type information\n\nRemove from General in 1.A'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity) was generated for the execution of a malicious file (rcs.3aka3.doc). ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1173.png', 'ScreenshotCaption': '(use this pic) Malicious file execution (revolver view) showing the file type as executable'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1173.png', 'ScreenshotCaption': '(use this pic) Malicious file execution (revolver view) showing the file type as executable'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated for rcs.3aka3.doc being identified as a "rare process executed."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-9985.png', 'ScreenshotCaption': 'process tree detection information, rare process executed with command line from pam desktop, explorere.exe executing .doc'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of user Pam executing rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11250.png', 'ScreenshotCaption': 'MSSP - a2/3 - rtlo and network connection '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-9989.png', 'ScreenshotCaption': 'process name is different from full path name'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Execution from User Directory" was generated due to the rcs.3aka3.doc process executing from a user\'s desktop.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10838.png', 'ScreenshotCaption': '1.A.1 - explorer.exe executing rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for a new application in AppCompat, indicating an application executing for the first time.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11717.png', 'ScreenshotCaption': 'CC - 1.A.1 - New App in AppCompat alert for rcs.3aka3.doc. Indicating rcs.3aka3.doc is an application that has not been run on the system before.'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for user Pam executing rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12976.png', 'ScreenshotCaption': 'MSSP - 1.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10846.png', 'ScreenshotCaption': 'Another of explorer.exe with PRS to doc file, indicates presence. PRS  is related to the RTLO, that this process generated a presence based IOC alert'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10819.png', 'ScreenshotCaption': 'relationship view showing full step 1 process tree. red dots indicate alerts. '}, {'ScreenshotName': 'GoSecure-APT29-10812.png', 'ScreenshotCaption': 'Process create for 1.a.1 of explorer.exe launching .doc'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3429.png', 'ScreenshotCaption': '1.A.1 - explorer.exe as parent process of rcs.3aka3.doc'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; medium severity) called "User Execution" was generated due to execution of rcs.3aka3.doc file by explorer.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2623.png', 'ScreenshotCaption': '1.a.1 - explorer.exe executing payload'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of "User Execution" due to execution of rcs.3aka3.doc by explorer.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17985.png', 'ScreenshotCaption': 'new MSSP 1a1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2623.png', 'ScreenshotCaption': '1.a.1 - explorer.exe executing payload'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2586.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe executing rcs.3aka3.doc'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called "Running Process(es) with suspicious name" was generated for the execution of a process with a suspicious name.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1665.png', 'ScreenshotCaption': 'suspicious name indicated in investigation UI #2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1399.png', 'ScreenshotCaption': 'Pam executing file with encoded name #1'}, {'ScreenshotName': 'McAfee-APT29-1403.png', 'ScreenshotCaption': 'rcs.3aka3.doc launched by explorer.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated for rcs.3aka3.doc that was identified as "patpoopy" backdoor during execution.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-351.png', 'ScreenshotCaption': 'AV detection of rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-352.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe creating process rcs.3aka3.doc with pam as the listed user'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for rcs.3aka3.doc being tagged as malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2611.png', 'ScreenshotCaption': 'Wildfire sample analysis timestamp. Payload would have been blocked if it is rendered as "Malware"'}], 'Footnotes': ['According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the user Pam executing the malicious document rcs.3aka3.doc file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13200.png', 'ScreenshotCaption': '1.A.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2605.png', 'ScreenshotCaption': '1 - Explorer is spawning the payload process.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue/yellow indicators) was generated identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-17.png', 'ScreenshotCaption': 'better screenshot, blue and yellow trigger colors (denote imapct on system)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-20.png', 'ScreenshotCaption': 'process create of the doc, doesnt show RTLO'}, {'ScreenshotName': 'ReaQta-APT29-17.png', 'ScreenshotCaption': 'better screenshot, blue and yellow trigger colors (denote imapct on system)'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Execution - User Execution" occurred containing evidence of explorer.exe executing rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12582.png', 'ScreenshotCaption': 'MSSP - SW - 1a1-1a3; 1b1-1b2 - overview'}, {'ScreenshotName': 'SecureWorks-APT29-12782.png', 'ScreenshotCaption': '1.A.1 - MSSP attack mapping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6506.png', 'ScreenshotCaption': 'Process Tree - related process to the alert, username there too, covering user execution and masquerading'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "ProcessCreationExtra" was generated for explorer.exe executing rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14532.png', 'ScreenshotCaption': '1.A.1 - Execution for explorer.exe starting rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of explorer.exe executing rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12790.png', 'ScreenshotCaption': 'A1 - MSSP - explorer.exe executing rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6457.png', 'ScreenshotCaption': 'A.1 - Showing explorer execution by 3aka3'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for "malicious file ???.cod.3aka3.scr with heuristic signature SONAR.ProcHijack!g31".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17516.png', 'ScreenshotCaption': '1a1 - malicious file ???.cod.3aka3.scr with heuristic signature SONAR.ProcHijack!g31'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7346.png', 'ScreenshotCaption': 'Forensics Report for rcs.3aka3.doc'}, {'ScreenshotName': 'Symantec-APT29-7342.png', 'ScreenshotCaption': 'List of events related to rcs.3aka3.doc'}], 'Footnotes': ['Vendor stated a protection capability would have blocked execution of the malicious file.']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (suspicious severity) was generated for rcs.3aka3.doc being a suspicious process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17544.png', 'ScreenshotCaption': '1a1/2 - better process tree - with command line args and suspicious tag - best photo (apex1 RCA tool)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for user Pam executing rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12674.png', 'ScreenshotCaption': 'MSSP - 1A1 - 1A3 - 1B1 - 2A1/2 - 2A4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17544.png', 'ScreenshotCaption': '1a1/2 - better process tree - with command line args and suspicious tag - best photo (apex1 RCA tool)'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for rcs.3aka3.doc being tagged as suspicious.  ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3707.png', 'ScreenshotCaption': 'heuristic falg on rcs static analysi'}, {'ScreenshotName': 'Carbon Black-APT29-3714.png', 'ScreenshotCaption': 'process tree with int level'}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Suspect Malware from executing.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for the execution of the malicious document rcs.3aka3.doc file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12751.png', 'ScreenshotCaption': '1.a.1 - 2.a.5 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing rcs.3aka3.doc. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3702.png', 'ScreenshotCaption': 'rcs on desktop- this is just telemetry'}], 'Footnotes': []}]}]}]}, {'Substep': '1.A.2', 'Procedure': 'Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)', 'Criteria': 'Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)', 'Techniques': [{'TechniqueId': 'T1036', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "RLOCharacterProcessCreate" was generated due to a a file being executed with the RTLO character in its name, hiding its extension. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1060.png', 'ScreenshotCaption': 'process tree with rlo in file name'}, {'ScreenshotName': 'Bitdefender-APT29-1062.png', 'ScreenshotCaption': '"alert" of file being executed with rlo in the file name'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Masquerading" was generated when an executable ran containing a RTLO character.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10177.png', 'ScreenshotCaption': '1.A.2 on both write and execution for masquerading'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was received that included details of the file rcs.3aka3.doc and identified it as an portable executable.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10183.png', 'ScreenshotCaption': 'MSSP Alert showing explorer.exe executing the rcs.3aka3.doc file.'}, {'ScreenshotName': 'CrowdStrike-APT29-10188.png', 'ScreenshotCaption': 'MSSP Alert for the rcs.3aka3.doc file.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (purple severity) was generated for rcs.3aka.doc, identified as an EXE.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2048.png', 'ScreenshotCaption': 'Identifies the file as an EXE. Level 10 is highest degree of risk. File based alert. (Out of scope)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was received that included details of the file rcs.3aka3.doc and identified it as an EXE.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12471.png', 'ScreenshotCaption': '1.A.2 - MDR Executive Summary, rcs.3aka3.doc'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': "A Technique alert detection (red indicator) was generated for a payload using the RTLO character to manipulate and obscure the payload's extension.", 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7328.png', 'ScreenshotCaption': '1.a.2 - fill Alert details for the .scr file'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection  (low severity) called "Process Without Common Executable Extension" was generated when an executable file ran without a valid signature created a process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11819.png', 'ScreenshotCaption': 'explorer executing payload'}, {'ScreenshotName': 'Cylance-APT29-11818.png', 'ScreenshotCaption': 'A2 - File is a PE with wrong file type'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Process Without Common Executable Extension" occurred containing evidence of an executable file ran without a valid signature creating a process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12895.png', 'ScreenshotCaption': 'MSSP - A1 - Alert + Correlation view'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "Process with Left-to-Right Encoding Character " was generated for rcs.3aka3.doc execution.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-18054.png', 'ScreenshotCaption': 'cc flex demo new alert after firing - config change new rule logic'}], 'Footnotes': ['Configuration changes were made to add detection logic. ']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file type .doc was an executable, and that the filename included the unicode character for RTLO.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1173.png', 'ScreenshotCaption': '(use this pic) Malicious file execution (revolver view) showing the file type as executable'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred showing the original filename:\u200b cod.3aka.scr.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11250.png', 'ScreenshotCaption': 'MSSP - a2/3 - rtlo and network connection '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process "?cod.3aka" with filename "rcs.3aka.doc", indicative of masquerading.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-9989.png', 'ScreenshotCaption': 'process name is different from full path name'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "RTL OVERRIDE ATTACK (METHODOLOGY)" was generated due to rcs.3aka3.doc containing a RTLO character with an MZ header value.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10835.png', 'ScreenshotCaption': '1.A.2 - RTL Override alert on rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for Generic.Exploit.Shellcode on rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10832.png', 'ScreenshotCaption': '1.A.2 - Generic Exploit Shellcode on rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the RTLO character in rcs.3aka.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12976.png', 'ScreenshotCaption': 'MSSP - 1.A'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Masqurading contained evidence that showed the original file name cod.3aka3.scr.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12697.png', 'ScreenshotCaption': '1.a.2 MSSP Alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the original filename cod.3aka.scr.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10819.png', 'ScreenshotCaption': 'relationship view showing full step 1 process tree. red dots indicate alerts. '}, {'ScreenshotName': 'GoSecure-APT29-10813.png', 'ScreenshotCaption': 'network connection event. showing IP and port for 1.a.3, called relationship graph ---- also shows the non-obfuscated file name as well (1.a.2)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called Masquerading was generated due to the presence of the RTLO character.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3433.png', 'ScreenshotCaption': '1.A.2 - Masquerading (T1036) mapping'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; medium severity) called Masquerading was generated due to altered file name by the RTLO character.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2631.png', 'ScreenshotCaption': 'Threat hunting views, "medium alert" for the technique, "yellow means medium"'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of "Defense Evasion" contained evidence of RTLO character in rcs.3aka.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17986.png', 'ScreenshotCaption': 'new mssp 1a2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the original filename\u200b cod.3aka.scr as well as the RTLO ASCII characters.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2631.png', 'ScreenshotCaption': 'Threat hunting views, "medium alert" for the technique, "yellow means medium"'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Masquerading was generated due to rcs.3aka.doc having a .doc extension but running as an executable.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2587.png', 'ScreenshotCaption': 'Technique detection for Masquerading'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Masquerading" was generated due to the Suspicious Indicator "Executed process with left to right character override."', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1962.png', 'ScreenshotCaption': 'CC - 1.a.2 alert left to right override indicated'}], 'Footnotes': ['The vendor added a new detection for the technique.']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Masquerading was generated due to Right-to-Left -Override (RLO) technique being observed on rcs.3aka3.doc', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13972.png', 'ScreenshotCaption': 'Masquerading'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) was generated for rcs.3aka3.doc, identified as a screensaver process, executing from users or temporary folder.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2649.png', 'ScreenshotCaption': 'Malicious payload highlighted in bright red. The unicode character is rendered and an alert fires on the screensaver executable extension (scr).'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Masquerading "(T1036\u200b)" occurred containing evidence of of the RLO character to obfuscate payload file name\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13200.png', 'ScreenshotCaption': '1.A.1 - MSSP'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Right-to-Left Override" was generated due a process event with RTLO.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7194.png', 'ScreenshotCaption': '1.a.1/2 - alert details right-to-left override, full process tree (RE TEST)'}, {'ScreenshotName': 'SecureWorks-APT29-7192.png', 'ScreenshotCaption': '1.a.1/2 - alert details right-to-left override (RE TEST) - technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-7191.png', 'ScreenshotCaption': '1.a.1/2 - alert details right-to-left override (RE TEST)'}, {'ScreenshotName': 'SecureWorks-APT29-7193.png', 'ScreenshotCaption': '1.a.1/2 - alert details right-to-left override - process overview (RE TEST)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the original filename: cod.3aka.scr.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12582.png', 'ScreenshotCaption': 'MSSP - SW - 1a1-1a3; 1b1-1b2 - overview'}, {'ScreenshotName': 'SecureWorks-APT29-12782.png', 'ScreenshotCaption': '1.A.1 - MSSP attack mapping'}, {'ScreenshotName': 'SecureWorks-APT29-12584.png', 'ScreenshotCaption': 'MSSP - SW - 1a2 - alert screenshot; shows og file name .scr'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the right-to-left override character (U+202E) in rcs.3aka.doc and the original filename.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13733.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Masquerading" was generated for "SuspiciousCharInPath" observed on rcs.3aka.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6463.png', 'ScreenshotCaption': 'A.2 - Specifically shows and describes masquerading via a specific character'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for the RTLO character in [?]cod.3aka3.scr was used to masquerade as rcs.3aka.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12369.png', 'ScreenshotCaption': 'A2 - MSSP - Description of LTR override char'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for "Suspicious File Detected rcs.3aka3.doc" due to machine learning identifying the payload as a PE32 executable and analyzing it.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17521.png', 'ScreenshotCaption': '1a2 - Suspicious File Detected rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed original filename of cod.3aka.scr and it was a Windows PE file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9898.png', 'ScreenshotCaption': 'File details assumed it was PE file, and stated attributes of it.'}, {'ScreenshotName': 'Symantec-APT29-9896.png', 'ScreenshotCaption': 'In Incident Report, report of a malicious file with the RTL override showing up as unknown Unicode characters.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "RTLO.Masquerading T1036" was generated when an executable ran containing a RTLO character.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12293.png', 'ScreenshotCaption': 'CC - RTLO.Masquerading Grey Detection'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the original filename\u200b cod.3aka.scr, which became rcs.3aka.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11813.png', 'ScreenshotCaption': 'shows command line args - new file name and og'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that the file was a .scr binary, and that the filename included the unicode character for RTLO.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3713.png', 'ScreenshotCaption': 'deskotop path for rcs'}], 'Footnotes': []}]}]}]}, {'Substep': '1.A.3', 'Procedure': 'Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234', 'Criteria': 'Established network channel over port 1234', 'Techniques': [{'TechniqueId': 'T1065', 'TechniqueName': 'Uncommonly Used Port', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-647.png', 'ScreenshotCaption': 'see the connections being made by binary with ip and port'}, {'ScreenshotName': 'Bitdefender-APT29-644.png', 'ScreenshotCaption': 'alert for network connection over port 1234'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10190.png', 'ScreenshotCaption': 'MSSP alert showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10192.png', 'ScreenshotCaption': 'Telemetry showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Uncommonly Used Port" was received that included a description of rcs.3aka3.doc and explained that it established a network connection to 192.168.0.5:1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-11803.png', 'ScreenshotCaption': '1.A.1, 1.A.3 - MDR Report Day 1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2051.png', 'ScreenshotCaption': 'Network connection of malicious file. Identifies IP and port of C2 server. Also identifies Process Injection and other stuff by monitoring suspicious use of API calls. Suspicious code markings are memory locations with suspicious code.'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7334.png', 'ScreenshotCaption': '1.a.3 - process details showing the network connection over port 1234'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (low severity) called "Unsigned Application Network Beaconing" was generated when the rcs.3aka3.doc process made a network connection.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11817.png', 'ScreenshotCaption': 'A3/4 - Unsigned network application beaconing alert'}, {'ScreenshotName': 'Cylance-APT29-11816.png', 'ScreenshotCaption': 'A3 - IP and port information'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Unsigned Application Network Beaconing" occurred containing evidence of rcs.3aka3.doc process connecting to C2(192.168.0.5) on port 1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12896.png', 'ScreenshotCaption': 'MSSP - Network info'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1177.png', 'ScreenshotCaption': 'double check to make sure i got network connection info. '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of cod.3aka3.scr connecting to 192.168.0.5 on port 1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11250.png', 'ScreenshotCaption': 'MSSP - a2/3 - rtlo and network connection '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a network connection to 192.168.0.5 over port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-9993.png', 'ScreenshotCaption': '1234 port'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Uncommon Port Connection" was generated due to  rcs.3aka3.doc connecting to remote port 1234.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11721.png', 'ScreenshotCaption': 'CC - 1.A.3 - Uncommon Port Connection for 1234'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12976.png', 'ScreenshotCaption': 'MSSP - 1.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10843.png', 'ScreenshotCaption': '1.A.3 - Network connection to 192.168.0.5:1234'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "T1043: Commonly Used Port" showed rcs.3aka3.doc connecting to 192.168.0.5 on TCP port 1234. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10814.png', 'ScreenshotCaption': 'network event enrichment showing commonly used port TID'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10813.png', 'ScreenshotCaption': 'network connection event. showing IP and port for 1.a.3, called relationship graph ---- also shows the non-obfuscated file name as well (1.a.2)'}, {'ScreenshotName': 'GoSecure-APT29-10814.png', 'ScreenshotCaption': 'network event enrichment showing commonly used port TID'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3435.png', 'ScreenshotCaption': '1.A.3 - rcs.3aka3.doc connecting to 192.168.0.5 on port 1234'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2632.png', 'ScreenshotCaption': '1.a.3 - connection to 192.168.0.5:1234'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (blue indicator) called "Commonly Used Port" showed rcs.3aka3.doc connecting to 192.168.0.5 on TCP port 1234. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1401.png', 'ScreenshotCaption': 'payload opening connection over common port - common port is in their UI, but would 1234 be considered common?'}, {'ScreenshotName': 'McAfee-APT29-1402.png', 'ScreenshotCaption': 'connection on port 1234'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1402.png', 'ScreenshotCaption': 'connection on port 1234'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Uncommonly Used Port" was generated due to rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13973.png', 'ScreenshotCaption': 'MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-353.png', 'ScreenshotCaption': 'Telemetry showing rcs.3aka3.doc process connecting to 192.168.0.5 over TCP port 1234'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for an Uncommonly used port "(T1065)" occurred containing evidence of rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13200.png', 'ScreenshotCaption': '1.A.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2651.png', 'ScreenshotCaption': 'Telemetry showing rcs.3aka3.doc establishing a connection to 192.168.0.5 over TCP port 1234.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (blue/yellow indicators) for "Uncommonly Used Port" was generated for the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-19.png', 'ScreenshotCaption': 'shows all alerts and data; shows origin process tree'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-15.png', 'ScreenshotCaption': 'step 1; network connection'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12582.png', 'ScreenshotCaption': 'MSSP - SW - 1a1-1a3; 1b1-1b2 - overview'}, {'ScreenshotName': 'SecureWorks-APT29-12782.png', 'ScreenshotCaption': '1.A.1 - MSSP attack mapping'}, {'ScreenshotName': 'SecureWorks-APT29-12782.png', 'ScreenshotCaption': '1.A.1 - MSSP attack mapping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7230.png', 'ScreenshotCaption': '1.a.3 - netflow event details 1234 (retest)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "T1065 - Uncommonly Used Port" was generated for rcs.3aka3.doc due to TCP port 1234 being used.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6462.png', 'ScreenshotCaption': 'Shows full story at a higher level in the UI'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14534.png', 'ScreenshotCaption': 'MSSP - 1.A.3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6468.png', 'ScreenshotCaption': 'A.3 - Shows uncommon port'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Attack, Backdoor" was generated when rcs.3aka3.doc connected to 192.168.0.5 on port 1234.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7338.png', 'ScreenshotCaption': '1.A.1 details of pupy execution'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7338.png', 'ScreenshotCaption': '1.A.1 details of pupy execution'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12674.png', 'ScreenshotCaption': 'MSSP - 1A1 - 1A3 - 1B1 - 2A1/2 - 2A4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11815.png', 'ScreenshotCaption': '1a3 - process tree - common port'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12751.png', 'ScreenshotCaption': '1.a.1 - 2.a.5 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 over TCP port 1234.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3709.png', 'ScreenshotCaption': 'C2 connection'}, {'ScreenshotName': 'Carbon Black-APT29-3717.png', 'ScreenshotCaption': 'better netcon view'}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office Documents making network connections.']}]}]}]}, {'Substep': '1.A.4', 'Procedure': 'Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic', 'Criteria': 'Evidence that the network data sent over the C2 channel is encrypted', 'Techniques': [{'TechniqueId': 'T1032', 'TechniqueName': 'Standard Cryptographic Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-15010.png', 'ScreenshotCaption': '1a4- new vendor screenshot'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7335.png', 'ScreenshotCaption': '1.a.4 - process details showing rc4 encryption'}, {'ScreenshotName': 'Cybereason-APT29-7334.png', 'ScreenshotCaption': '1.a.3 - process details showing the network connection over port 1234'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14343.png', 'ScreenshotCaption': '1A4 - new pic - EG client DLLs'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17345.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the rcs.3aka3.doc process using rc4 encryption for network communication.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12976.png', 'ScreenshotCaption': 'MSSP - 1.A'}], 'Footnotes': []}, {'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11720.png', 'ScreenshotCaption': 'CC - 1.A.4 - Cryptographic Library Load (top)'}, {'ScreenshotName': 'FireEye-APT29-11707.png', 'ScreenshotCaption': '1.A.4 - rcs.3aka3.doc loading bcrypt.dll, crypt32.dll, cryptbase.dll'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2656.png', 'ScreenshotCaption': 'Telemetry showing rcs.3aka3.doc loading cryptographic libraries.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6470.png', 'ScreenshotCaption': 'A.4 - Specifically shows the library that was alerted on'}, {'ScreenshotName': 'SentinelOne-APT29-6469.png', 'ScreenshotCaption': 'A.4 - Shows that a cryptographic protocol was used'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3718.png', 'ScreenshotCaption': 'cryptbase dll load'}], 'Footnotes': []}]}]}]}, {'Substep': '1.B.1', 'Procedure': 'Spawned interactive cmd.exe', 'Criteria': 'cmd.exe\xa0spawning from the rcs.3aka3.doc\u200b process', 'Techniques': [{'TechniqueId': 'T1059', 'TechniqueName': 'Command-Line Interface', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13416.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-651.png', 'ScreenshotCaption': 'powershell '}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10196.png', 'ScreenshotCaption': 'Process tree showing rcs.3aka3.doc\u200b spawning cmd.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (yellow indicator) for "Execution" was generated for cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2201.png', 'ScreenshotCaption': 'cmd.exe running from doc file'}, {'ScreenshotName': 'CyCraft-APT29-2200.png', 'ScreenshotCaption': 'command execution'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for was received that included a description of rcs.3aka3.doc spawning cmd.exe interactively.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-11805.png', 'ScreenshotCaption': '1.B.1, 1.B.2 - MDR Report Day 1'}, {'ScreenshotName': 'CyCraft-APT29-11806.png', 'ScreenshotCaption': '1.B.1, 1.B.2 - MDR Report Day 1 (2)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10771.png', 'ScreenshotCaption': 'MSSP - b1, b2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7351.png', 'ScreenshotCaption': '1.b.1 - payload spawns cmd.exe (process tree) telemetry'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12895.png', 'ScreenshotCaption': 'MSSP - A1 - Alert + Correlation view'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11830.png', 'ScreenshotCaption': 'B1/2 - correlated Graphical view'}, {'ScreenshotName': 'Cylance-APT29-11827.png', 'ScreenshotCaption': 'B1 - cmd.exe spawning from rcs.3aka3.doc\u200b alert'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for a "Suspicious Parent of Built-in Shells." The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1674.png', 'ScreenshotCaption': 'cc (strictness modification) suspicious parent of built-in shells alert'}], 'Footnotes': ['Configuration changes were made to loosen rule logic and/or black lists.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka.doc spawning cmd.exe. The telemetry was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1189.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for an anomalous script occurred containing evidence of cmd spawning from rcs.3aka3.doc\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11252.png', 'ScreenshotCaption': 'MSSP - cmd launched (not sure its close enough to what we are looking for)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for Abnormal File Modification.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10004.png', 'ScreenshotCaption': 'cmd parent to powershel, 3aka3 spawning cmd.'}, {'ScreenshotName': 'F-Secure-APT29-9996.png', 'ScreenshotCaption': 'process tree with cmd.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "CMD Execution" was generated due to cmd.exe spawning from rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10857.png', 'ScreenshotCaption': '1.B.1 - CMD Execution from parent rcs.3aka3.doc (bottom)'}, {'ScreenshotName': 'FireEye-APT29-10856.png', 'ScreenshotCaption': '1.B.1 - CMD Execution from parent rcs.3aka3.doc (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for cmd.exe spawning from rcs.3aka3.doc\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12978.png', 'ScreenshotCaption': 'MSSP - 1.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc spawning from cmd.exe\u200b. This was correlated to a parent alert on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10861.png', 'ScreenshotCaption': '1.B.1 - Triage view of cmd.exe from rcs.3aka3.doc'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Command-Line Interface" was generated due to cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for rcs.3aka3.doc spawning explorer.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10820.png', 'ScreenshotCaption': 'showing malicious  process identified based on alerts previously  shown'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10827.png', 'ScreenshotCaption': 'process injection for step 1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (reminder severity) called "CommandLine Interface" was generated due to execution of cmd.exe by rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3441.png', 'ScreenshotCaption': '1.B.1 - ATT&CK technique mapping to Command-Line Interface'}, {'ScreenshotName': 'HanSight-APT29-3443.png', 'ScreenshotCaption': '1.B.1 - cmd.exe process with rcs.3aka3.doc as the parent process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; medium severity) called  "Command Line Interface" was generated due to cmd.exe spawning from rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2636.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of rcs.3aka3.doc\u200b spawning cmd.exe', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17987.png', 'ScreenshotCaption': 'new mssp 1b1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2636.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The telemetry was correlated to a parent detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2588.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe spawning from rcs.3aka3.doc.'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc spawning cmd.exe. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1425.png', 'ScreenshotCaption': 'doc launching cmd'}, {'ScreenshotName': 'McAfee-APT29-1429.png', 'ScreenshotCaption': 'process tree cmd to cmd to powershell overall'}, {'ScreenshotName': 'McAfee-APT29-1436.png', 'ScreenshotCaption': 'walking the process tree - cmd.exe launching powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. This event was correlated to a Technique detection for masquerading.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13974.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-13975.png', 'ScreenshotCaption': 'Correlation'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for a command line interface spawned from a process identified as malware with an active network connection.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-14271.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-14274.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Command Line Interfaces "(T1059)" occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13201.png', 'ScreenshotCaption': '1.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2666.png', 'ScreenshotCaption': 'Telemetry showing the process tree of the rcs.3aka.doc spawning cmd.exe, which spawns cmd.exe, and finally spawns powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-24.png', 'ScreenshotCaption': 'process tree of cmd spawning from doc '}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Screensaver file launches shell" was generated due to cmd.exe spawning from rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7198.png', 'ScreenshotCaption': '1.b.1 - pupyRAT Commadn shell process tree full (re-test)'}, {'ScreenshotName': 'SecureWorks-APT29-7197.png', 'ScreenshotCaption': '1.b.1 - pupyRAT Command shell alert details, process overview (re-test)'}, {'ScreenshotName': 'SecureWorks-APT29-6504.png', 'ScreenshotCaption': 'alert - screensaver file launches shell (cmd/powershell)'}, {'ScreenshotName': 'SecureWorks-APT29-7196.png', 'ScreenshotCaption': '1.b.1 - pupyRAT Commadn shell alert details, technique mappings (re-test)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12582.png', 'ScreenshotCaption': 'MSSP - SW - 1a1-1a3; 1b1-1b2 - overview'}, {'ScreenshotName': 'SecureWorks-APT29-12782.png', 'ScreenshotCaption': '1.A.1 - MSSP attack mapping'}, {'ScreenshotName': 'SecureWorks-APT29-12782.png', 'ScreenshotCaption': '1.A.1 - MSSP attack mapping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7213.png', 'ScreenshotCaption': '1.b.2 event details powershell command line, full process tree (retest)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "ProcessCreationExtra" was generated for rcs.3aka3.doc\u200b spawning cmd.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17871.png', 'ScreenshotCaption': '1.B.1 - rcs.3aka3.doc executing cmd.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for “T1059” contained evidence of cmd.exe spawning from rcs.3aka3.doc\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12794.png', 'ScreenshotCaption': 'B1/2 - MSSP - Command-line interface/powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b.The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-16471.png', 'ScreenshotCaption': 'Detailed view of B1/2'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc executing cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7357.png', 'ScreenshotCaption': 'list of execution events related to doc execution'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14004.png', 'ScreenshotCaption': 'MSSP - 1.B.1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11836.png', 'ScreenshotCaption': 'b1 - pipe command line args'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12751.png', 'ScreenshotCaption': '1.a.1 - 2.a.5 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3724.png', 'ScreenshotCaption': 'doc spawns cmd'}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office documents or untrusted applications spawning command interpreters.']}]}]}]}, {'Substep': '1.B.2', 'Procedure': 'Spawned interactive powershell.exe', 'Criteria': 'powershell.exe\xa0spawning from cmd.exe', 'Techniques': [{'TechniqueId': 'T1086', 'TechniqueName': 'PowerShell', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated for powershell.exe being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13415.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13416.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-653.png', 'ScreenshotCaption': 'powershell connected to .scr'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated when powershell.exe spawned from cmd.exe. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10204.png', 'ScreenshotCaption': 'A general detection showing powershell.exe spawning from cmd.exe.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10204.png', 'ScreenshotCaption': 'A general detection showing powershell.exe spawning from cmd.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "Powershell" was generated when cmd.exe spawned powershell.exe. The alert was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2056.png', 'ScreenshotCaption': 'Additional call-graph information for seeing the payload spawning cmd and  powershell'}, {'ScreenshotName': 'CyCraft-APT29-2057.png', 'ScreenshotCaption': 'Clear demonstration of relationships between processes, including logs of PowerShell execution mapped to ATT&CK techniques'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell" was received that included a description of PowerShell execution and an explanation of the commands executed through it.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12220.png', 'ScreenshotCaption': '1.B.2 - MDR Report Day 1'}, {'ScreenshotName': 'CyCraft-APT29-12222.png', 'ScreenshotCaption': '1.B.2 - MDR Report Day 1 (2)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe spawning from cmd.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10771.png', 'ScreenshotCaption': 'MSSP - b1, b2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7352.png', 'ScreenshotCaption': '1.b.2 - same process tree view (telemetry) showing cmd.exe spawns powershell'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (info severity) called "Win_User_Execution_MITRET1204" was generated due to a process targeting an *.exe filename.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11832.png', 'ScreenshotCaption': 'B2 - proccess tree of Powershell.exe spawning'}, {'ScreenshotName': 'Cylance-APT29-11833.png', 'ScreenshotCaption': 'B2 - detailed view of powershell spawning'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "ATT&CK T1086 PowerShell" was generated for the execution of PowerShell. The event was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1190.png', 'ScreenshotCaption': 'powershell enrichment with selection in resolver view (purple dot) enriched from malicious file detection (correlated)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe executing powershell.exe. The telemetry was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1190.png', 'ScreenshotCaption': 'powershell enrichment with selection in resolver view (purple dot) enriched from malicious file detection (correlated)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for Abnormal Process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10004.png', 'ScreenshotCaption': 'cmd parent to powershel, 3aka3 spawning cmd.'}, {'ScreenshotName': 'F-Secure-APT29-10571.png', 'ScreenshotCaption': 'powershell part of tree spawning from .doc'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell Execution" was generated due to powershell.exe spawning from cmd.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10853.png', 'ScreenshotCaption': '1.B.2 - PowerShell Execution from parent cmd.exe'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for cmd.exe spawning a child process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10860.png', 'ScreenshotCaption': '1.B.2 - CMD Child Process of powershell.exe (bottom)'}, {'ScreenshotName': 'FireEye-APT29-10859.png', 'ScreenshotCaption': '1.B.2 - CMD Child Process of powershell.exe (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe spawning from cmd.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12978.png', 'ScreenshotCaption': 'MSSP - 1.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "PowerShell process created" was generated due to powershell.exe spawning from cmd.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10816.png', 'ScreenshotCaption': 'cmd launching powershell for 1.b.2 event'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10820.png', 'ScreenshotCaption': 'showing malicious  process identified based on alerts previously  shown'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "PowerShell" was generated when cmd.exe spawned powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3447.png', 'ScreenshotCaption': '1.B.2 - powershell.exe spawning from cmd.exe'}, {'ScreenshotName': 'HanSight-APT29-3446.png', 'ScreenshotCaption': '1.B.2 - Technique named PowerShell with ATT&CK ID T1086'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing powershell.exe spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; medium severity) called PowerShell was generated due to the execution of powershell.exe by cmd.exe. The alert was correlated to a parent alert for command line execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2637.png', 'ScreenshotCaption': '1.b.2 ps launced'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of cmd.exe spawning powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-11767.png', 'ScreenshotCaption': 'MSSP Report Page 4 - Step 1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2637.png', 'ScreenshotCaption': '1.b.2 ps launced'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2593.png', 'ScreenshotCaption': 'cmd spawning powershell'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (blue indicator) called "PowerShell" was generated due to the PowerShell command being executed from another process. The technique was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1429.png', 'ScreenshotCaption': 'process tree cmd to cmd to powershell overall'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe launching powershell.exe. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1436.png', 'ScreenshotCaption': 'walking the process tree - cmd.exe launching powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe spawning powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13980.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Powershell "(T1086)" occurred containing evidence of powershell.exe spawning from cmd.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13201.png', 'ScreenshotCaption': '1.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2666.png', 'ScreenshotCaption': 'Telemetry showing the process tree of the rcs.3aka.doc spawning cmd.exe, which spawns cmd.exe, and finally spawns powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "PowerShell" was generated when cmd.exe spawned powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-27.png', 'ScreenshotCaption': 'shows mitre att&ck powershell technique'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for cmd.exe spawning powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12782.png', 'ScreenshotCaption': '1.A.1 - MSSP attack mapping'}, {'ScreenshotName': 'SecureWorks-APT29-12582.png', 'ScreenshotCaption': 'MSSP - SW - 1a1-1a3; 1b1-1b2 - overview'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7213.png', 'ScreenshotCaption': '1.b.2 event details powershell command line, full process tree (retest)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "ProcessCreationExtra" was generated for powershell.exe spawning from cmd.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14541.png', 'ScreenshotCaption': '1.B.2 - Execution for powershell.exe spawning from cmd.exe.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for “T1086” contained evidence of powershell.exe spawning from cmd.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12795.png', 'ScreenshotCaption': 'B2 - MSSP - powershell'}, {'ScreenshotName': 'SentinelOne-APT29-12794.png', 'ScreenshotCaption': 'B1/2 - MSSP - Command-line interface/powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6477.png', 'ScreenshotCaption': 'B.2 - Shows all process spawning with additional information about the execution - shows powershell'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "PowerShell" was generated when cmd.exe spawned powershell.exe. The event was correlated to a parent detection cod.3aka.scr as a suspicious file.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7357.png', 'ScreenshotCaption': 'list of execution events related to doc execution'}, {'ScreenshotName': 'Symantec-APT29-12868.png', 'ScreenshotCaption': 'Incident Report showing correlation of powershell execution with cod.3aka.scr'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell" was received that included a description of the PowerShell commands executed by the adversary.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-13030.png', 'ScreenshotCaption': 'MSSP Day 1: automated file collection script'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12868.png', 'ScreenshotCaption': 'Incident Report showing correlation of powershell execution with cod.3aka.scr'}, {'ScreenshotName': 'Symantec-APT29-7357.png', 'ScreenshotCaption': 'list of execution events related to doc execution'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11836.png', 'ScreenshotCaption': 'b1 - pipe command line args'}, {'ScreenshotName': 'TrendMicro-APT29-17549.png', 'ScreenshotCaption': 'ps > cmd'}, {'ScreenshotName': 'TrendMicro-APT29-17548.png', 'ScreenshotCaption': 'use this for 1B2'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for "AMSI - Abnormal Fileless command-line length being executed." The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3737.png', 'ScreenshotCaption': 'alert with link to amsi threat intel report for powershell spawning from cmd.exe'}, {'ScreenshotName': 'Carbon Black-APT29-3733.png', 'ScreenshotCaption': 'powershell alert abnormal command line length, length in bytes that typical powershell execution should not be more than 200 bytes'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for cmd.exe spawning powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12751.png', 'ScreenshotCaption': '1.a.1 - 2.a.5 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showing powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3727.png', 'ScreenshotCaption': 'cmd spawning powershell'}, {'ScreenshotName': 'Carbon Black-APT29-3723.png', 'ScreenshotCaption': 'cmd invoked cmd and powershell'}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office documents or untrusted applications spawning command interpreters.']}]}]}]}, {'Substep': '2.A.1', 'Procedure': 'Searched filesystem for document and media files using PowerShell\xa0', 'Criteria': 'powershell.exe executing (Get-)ChildItem', 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) was generated for PowerShell enumerating files and directories using environment variables. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1054.png', 'ScreenshotCaption': 'config change - mapped to att&ck'}, {'ScreenshotName': 'Bitdefender-APT29-14019.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1118.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10208.png', 'ScreenshotCaption': 'Telemetry showing the Powershell script that was executed.  View in process explorer allows you to see that the script was executed from the Powershell process.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (purple indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2203.png', 'ScreenshotCaption': 'File and Directory Discovery. Searching files through powershell.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File and Directory Discovery" was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12220.png', 'ScreenshotCaption': '1.B.2 - MDR Report Day 1'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for powershell.exe executing Get-ChildItem.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9952.png', 'ScreenshotCaption': '2.a.1/2 - get-ChildItem powershell (cc)'}], 'Footnotes': ['A sensor policy update that enables deeper PowerShell visibility was re-applied.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell activity looking for files in a directory" occurred containing evidence of a file event for powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10773.png', 'ScreenshotCaption': 'MSSP - a2 (child item in blue box), a3 (pam file reads)'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Win_AutomatedCollection_DirScanART_MITRET1119" occurred containing evidence of powershell.exe executing Get-ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12898.png', 'ScreenshotCaption': 'MSSP - SBL'}, {'ScreenshotName': 'Cylance-APT29-12897.png', 'ScreenshotCaption': 'MSSP - Automated collection'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11837.png', 'ScreenshotCaption': 'A1/2/5 - Powershell event showing SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1198.png', 'ScreenshotCaption': 'should be the same as the first screen, but showing script block again. '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the Childitem cmdlet. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11254.png', 'ScreenshotCaption': 'MSSP - get-childitem and compress archive scriptblock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of ChildItem. \n', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10008.png', 'ScreenshotCaption': 'command start for childitem'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12979.png', 'ScreenshotCaption': 'MSSP - 2.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10881.png', 'ScreenshotCaption': '2.A - Get-ChildItem from PowerShell'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12745.png', 'ScreenshotCaption': '2.a MSSP alert'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3470.png', 'ScreenshotCaption': 'PowerShell executing Get-ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery occurred containing evidence that "PowerShell ran commands to query files with multiple extensions and compress the found files into a zip file."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17383.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-362.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Get-ChildItem'}, {'ScreenshotName': 'Microsoft-APT29-367.png', 'ScreenshotCaption': 'Advanced hunting query interface showing executed script block for what files were searched'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for PowerShell executing suspicious File and Directory Discovery commands. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-14305.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-14307.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for File and Directory Discovery "(T1083)" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13202.png', 'ScreenshotCaption': '2.A - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13640.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-233.png', 'ScreenshotCaption': 'cc - childitem; compress-archive; scriptblock with draft.zip'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred showing evidence of powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13734.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6534.png', 'ScreenshotCaption': 'details of powershell script, 2.a.1, 2.a.2, 2.a.4,2.b.1: - getchild-items here under event details '}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "File Enumeration" under "Discovery {T1083}" was generated when powershell.exe executed Get-ChildItem. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6487.png', 'ScreenshotCaption': 'A.3 - Shows that file enumeration took place'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Enumeration" occurred containing evidence of PowerShell searching the filesystem. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12796.png', 'ScreenshotCaption': 'A1 - MSSP - File Enumeration alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6485.png', 'ScreenshotCaption': 'A.1/2 Shows -childitem call'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data from Local System" contained evidence of PowerShell executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12974.png', 'ScreenshotCaption': 'MSSP Day 1: automated file collection script'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell execution of ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9905.png', 'ScreenshotCaption': "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]"}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "PS1.DiscoverCollectLocal T1083" was generated for PowerShell enumerating files and directories using ChildItem recursively.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17552.png', 'ScreenshotCaption': 'CC - PS1.DiscoverCollectLocal Grey Detection'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred showing evidence of PowerShell looking for certain files in a directory. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12674.png', 'ScreenshotCaption': 'MSSP - 1A1 - 1A3 - 1B1 - 2A1/2 - 2A4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11846.png', 'ScreenshotCaption': 'a1/2/4 - child item and compress archive blob/scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for the use of ChildItem. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12751.png', 'ScreenshotCaption': '1.a.1 - 2.a.5 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3750.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-3751.png', 'ScreenshotCaption': 'script load content and the -2.png image as well'}], 'Footnotes': []}]}]}]}, {'Substep': '2.A.2', 'Procedure': 'Scripted search of filesystem for document and media files using PowerShell\xa0', 'Criteria': 'powershell.exe executing (Get-)ChildItem', 'Techniques': [{'TechniqueId': 'T1119', 'TechniqueName': 'Automated Collection', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1118.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (purple hexagon) called "Automated Collection" was generated when powershell.exe executed an automated search routine with Get-ChildItem. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10205.png', 'ScreenshotCaption': 'A Technique detection called "Automated Collection" showing powershell executed an automated collection routine.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP alert was generated when a portable executable file used a script to collected various filetypes found on the filesystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10262.png', 'ScreenshotCaption': 'An MSSP alert showing a powershell script collecting data for file types from the filesystem.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10208.png', 'ScreenshotCaption': 'Telemetry showing the Powershell script that was executed.  View in process explorer allows you to see that the script was executed from the Powershell process.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (purple indicator) showed powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2203.png', 'ScreenshotCaption': 'File and Directory Discovery. Searching files through powershell.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12220.png', 'ScreenshotCaption': '1.B.2 - MDR Report Day 1'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "malicious command" was generated on powershell.exe executing Get-ChildItem.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9952.png', 'ScreenshotCaption': '2.a.1/2 - get-ChildItem powershell (cc)'}], 'Footnotes': ['A sensor policy update that enables deeper PowerShell visibility was re-applied.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell activity looking for files in a directory" occurred containing evidence of a file event and powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10773.png', 'ScreenshotCaption': 'MSSP - a2 (child item in blue box), a3 (pam file reads)'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_AutomatedCollection_DirScanART_MITRET1119" was generated due to powershell.exe executing Get-ChildItem. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11838.png', 'ScreenshotCaption': 'A3 - Directory scan alert referencing T1119'}, {'ScreenshotName': 'Cylance-APT29-11839.png', 'ScreenshotCaption': 'A3 - Shows destination payload of files that will be created'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Win_AutomatedCollection_DirScanART_MITRET1119" occurred containing evidence of powershell.exe executing Get-ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12897.png', 'ScreenshotCaption': 'MSSP - Automated collection'}, {'ScreenshotName': 'Cylance-APT29-12898.png', 'ScreenshotCaption': 'MSSP - SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11837.png', 'ScreenshotCaption': 'A1/2/5 - Powershell event showing SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1198.png', 'ScreenshotCaption': 'should be the same as the first screen, but showing script block again. '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the Childitem. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11254.png', 'ScreenshotCaption': 'MSSP - get-childitem and compress archive scriptblock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the execution of the ChildItem. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10008.png', 'ScreenshotCaption': 'command start for childitem'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12979.png', 'ScreenshotCaption': 'MSSP - 2.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10881.png', 'ScreenshotCaption': '2.A - Get-ChildItem from PowerShell'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12745.png', 'ScreenshotCaption': '2.a MSSP alert'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3470.png', 'ScreenshotCaption': 'PowerShell executing Get-ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Collection occurred containing evidence that "PowerShell ran commands to query files with multiple extensions and compressed the found files into a zip file."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17383.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-362.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Get-ChildItem'}, {'ScreenshotName': 'Microsoft-APT29-367.png', 'ScreenshotCaption': 'Advanced hunting query interface showing executed script block for what files were searched'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Automated Collection "(T1119)" occurred containing evidence that a discovery script was using Get-Childitem to search the filesystem to specific file patterns.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13202.png', 'ScreenshotCaption': '2.A - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13640.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-233.png', 'ScreenshotCaption': 'cc - childitem; compress-archive; scriptblock with draft.zip'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred showing evidence of powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13734.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6534.png', 'ScreenshotCaption': 'details of powershell script, 2.a.1, 2.a.2, 2.a.4,2.b.1: - getchild-items here under event details '}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Automated Collection" was generated on powershell.exe executing Get-ChildItem after a short delay. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Delayed (Processing)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6498.png', 'ScreenshotCaption': 'A.1/2/3 - Shows high level representation of Automated Collection - May take a few minutes to populate'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "InteractivePSCommand" contained evidence of powershell.exe executing ChildItem. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12797.png', 'ScreenshotCaption': 'A2/3 - MSSP - ChildItem call'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6485.png', 'ScreenshotCaption': 'A.1/2 Shows -childitem call'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data from Local System" contained evidence of PowerShell executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12974.png', 'ScreenshotCaption': 'MSSP Day 1: automated file collection script'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell execution of ChildItem. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9905.png', 'ScreenshotCaption': "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]"}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "PS1.DiscoverCollectLocal T1119" was generated for PowerShell enumerating files and directories using ChildItem recursively.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17552.png', 'ScreenshotCaption': 'CC - PS1.DiscoverCollectLocal Grey Detection'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred showing evidence of powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14011.png', 'ScreenshotCaption': 'MSSP - 2.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11846.png', 'ScreenshotCaption': 'a1/2/4 - child item and compress archive blob/scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for the use of ChildItem. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12751.png', 'ScreenshotCaption': '1.a.1 - 2.a.5 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3750.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-3751.png', 'ScreenshotCaption': 'script load content and the -2.png image as well'}], 'Footnotes': []}]}]}]}, {'Substep': '2.A.3', 'Procedure': 'Recursively collected files found in C:\\Users\\Pam\\ using PowerShell', 'Criteria': 'powershell.exe reading files in C:\\Users\\Pam\\', 'Techniques': [{'TechniqueId': 'T1005', 'TechniqueName': 'Data from Local System', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13417.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file opens of C:\\Users\\Pam\\*. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10221.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe reading files from  C:\\Users\\Pam\\*.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell activity looking for files in a directory T1005" occurred containing evidence of a file event for powershell.exe reading files from Pam\'s system.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10773.png', 'ScreenshotCaption': 'MSSP - a2 (child item in blue box), a3 (pam file reads)'}, {'ScreenshotName': 'Cybereason-APT29-10772.png', 'ScreenshotCaption': 'MSSP - a5 (draft.zip create)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file opens of C:\\Users\\Pam\\*. The event was correlated to a parent General detection rcs.3aka3.doc being identified as unknown malware.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9887.png', 'ScreenshotCaption': '2.a.3 powershell executed process, opened files (cc)'}, {'ScreenshotName': 'Cybereason-APT29-9889.png', 'ScreenshotCaption': '2.a.3 - files from pams system (cc)'}], 'Footnotes': ['A sensor policy update that enables file read event collection was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file reads of C:\\Users\\Pam\\*. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1200.png', 'ScreenshotCaption': 'files found from the file read for 2.a.3 (users\\pam)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection for "T1119 Possible Data Collection (file reads)" was generated on file reads of C:\\Users\\Pam\\*.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11673.png', 'ScreenshotCaption': 'config change (2a3) file read of bing.url by powershell labeled as a possible data collection) added in a condition to look for file reads in the PAM directory'}], 'Footnotes': ["Configuration changed to monitor Pam's user directory."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11673.png', 'ScreenshotCaption': 'config change (2a3) file read of bing.url by powershell labeled as a possible data collection) added in a condition to look for file reads in the PAM directory'}], 'Footnotes': ["Configuration changed to monitor Pam's user directory."]}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Data From Local System "(T1005)" occurred containing evidence that a discovery script was executed file read operations on local folder \u200bC:\\Users\\Pam. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13202.png', 'ScreenshotCaption': '2.A - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2679.png', 'ScreenshotCaption': 'Telemetry showing file read operations from C:\\users\\pam.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file reads of C:\\Users\\Pam\\*. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-42.png', 'ScreenshotCaption': '2.a.3; file read example '}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Data from Local System {T1005}" was generated on powershell.exe executing Get-ChildItem and reading C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7164.png', 'ScreenshotCaption': 'CC - A3 - All files being read in C:\\users\\pam\\links\\*'}, {'ScreenshotName': 'SentinelOne-APT29-7161.png', 'ScreenshotCaption': 'CC - A3 - File open alert of file in C:\\users\\pam\\links\\desktop.lnk'}], 'Footnotes': ['A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005).']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell is seen enumerating the system and searching for files" contained evidence of file reads to C:/Users/Pam/*.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12797.png', 'ScreenshotCaption': 'A2/3 - MSSP - ChildItem call'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe reading files from C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7164.png', 'ScreenshotCaption': 'CC - A3 - All files being read in C:\\users\\pam\\links\\*'}], 'Footnotes': ['A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005).']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11845.png', 'ScreenshotCaption': 'a3 - file reads (accesses) for pam'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '2.A.4', 'Procedure': 'Compressed and stored files into ZIP (Draft.zip) using PowerShell', 'Criteria': 'powershell.exe executing\xa0Compress-Archive', 'Techniques': [{'TechniqueId': 'T1002', 'TechniqueName': 'Data Compressed', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) was generated for PowerShell being used to created a compressed archive. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13420.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-13419.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1118.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10216.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe compressing via Compress-Archive.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (purple indicator) was generated for powershell.exe executing Compress-Archive. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2205.png', 'ScreenshotCaption': 'Compress Archive for Data Compressed'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data Compressed" was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6) and then archive them as DRAFT.ZIP.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12220.png', 'ScreenshotCaption': '1.B.2 - MDR Report Day 1'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell activity looking for files in a directory" occurred containing evidence of powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10772.png', 'ScreenshotCaption': 'MSSP - a5 (draft.zip create)'}, {'ScreenshotName': 'Cybereason-APT29-10773.png', 'ScreenshotCaption': 'MSSP - a2 (child item in blue box), a3 (pam file reads)'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_Data_Compressed_ART_MITRET1002"  was generated due to PowerShell payload containing "Compress-Archive" and "-DestinationPath".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11834.png', 'ScreenshotCaption': 'A4 - Data compression alert derived from the compress-archive cmdlet'}, {'ScreenshotName': 'Cylance-APT29-11837.png', 'ScreenshotCaption': 'A1/2/5 - Powershell event showing SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-Archive. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Data Compressed" was generated for powershell.exe compressing via Compress-Archive. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1195.png', 'ScreenshotCaption': 'data compressed  enrichment, showing the childitem - since it stemed  off the malicious file execution and enrichments, correlated to that'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1195.png', 'ScreenshotCaption': 'data compressed  enrichment, showing the childitem - since it stemed  off the malicious file execution and enrichments, correlated to that'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the Compress-Archive cmdlet being executed.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11254.png', 'ScreenshotCaption': 'MSSP - get-childitem and compress archive scriptblock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10009.png', 'ScreenshotCaption': 'Draft.Zip at the end of the CommandStart'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "ZIP Archive Created - T1002" was generated due to Draft.zip being identified as compressed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10871.png', 'ScreenshotCaption': '2.A.5 - ZIP Archive Created for Draft.zip (bottom)'}, {'ScreenshotName': 'FireEye-APT29-10870.png', 'ScreenshotCaption': '2.A.5 - ZIP Archive Created for Draft.zip (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12979.png', 'ScreenshotCaption': 'MSSP - 2.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10884.png', 'ScreenshotCaption': '2.A.4 - PowerShell executing Compress-Archive in script block'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12745.png', 'ScreenshotCaption': '2.a MSSP alert'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (reminder severity) called "Data Compress via PowerShell" was generated due to powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3459.png', 'ScreenshotCaption': '2.A.4 - Data Compress via PowerShell alert with ATT&CK ID mapping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green indicator; low severity) called Data Compressed was generated due to the creation of Draft.Zip by powershell.exe.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3419.png', 'ScreenshotCaption': '2.a.5 - CC ps creates Draft.Zip - details'}], 'Footnotes': ['Additional PowerShell logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of draft.zip being created and compressed by PowerShell. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17988.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell creating a compressed archive. The event was correlated to a parent Technique detection for Masquerading on rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2392.png', 'ScreenshotCaption': 'alert for data staged (2a5)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.', 'Exiting event details shows correlation of detections.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery occurred containing evidence that PowerShell ran commands to query files with certain extensions and compress the found files into a zip file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17383.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-363.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Compress-Archive.'}, {'ScreenshotName': 'Microsoft-APT29-367.png', 'ScreenshotCaption': 'Advanced hunting query interface showing executed script block for what files were searched'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Scripting engine creates compressed file under suspicious folder" was generated due identifying Draft.zip as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2674.png', 'ScreenshotCaption': 'A technique detection for draft.zip creation (2).'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Data Compressed "(T1002)" occurred containing evidence that the files "C:\\Users\\pam\\Links\\Downloads.lnk, C:\\Users\\pam\\Links\\Desktop.lnk, C:\\Users\\pam\\Favorites\\Bing.url, and C:\\Users\\pam\\Desktop\\Microsoft Edge.lnk" were compressed into a zip file draft.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13202.png', 'ScreenshotCaption': '2.A - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13640.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-233.png', 'ScreenshotCaption': 'cc - childitem; compress-archive; scriptblock with draft.zip'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred showing evidence of powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13734.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6534.png', 'ScreenshotCaption': 'details of powershell script, 2.a.1, 2.a.2, 2.a.4,2.b.1: - getchild-items here under event details '}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Data Compressed. MITRE Exfiltration {T1002}" was generated on powershell.exe compressing via Compress-Archive. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6486.png', 'ScreenshotCaption': 'A.4 - Shows that data compression has occurred'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14546.png', 'ScreenshotCaption': 'MSSP - 2.A.4'}, {'ScreenshotName': 'SentinelOne-APT29-14545.png', 'ScreenshotCaption': 'MSSP - 2.A.4'}, {'ScreenshotName': 'SentinelOne-APT29-14544.png', 'ScreenshotCaption': 'MSSP - 2.A.4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14542.png', 'ScreenshotCaption': '2.A.4 - Script block'}, {'ScreenshotName': 'SentinelOne-APT29-14543.png', 'ScreenshotCaption': '2.A.4 - Script block expanded'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Data Compressed" was generated when Draft.zip was identified as compressed. The event was correlated to a parent detection cod.3aka.scr as a malicious file.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17539.png', 'ScreenshotCaption': 'A Technique detection + correlation'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data Compressed "was received that included an explanation of the PowerShell script used to compress files and store the results in Draft.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9903.png', 'ScreenshotCaption': 'Powershell Scriptblock log for all commands used in 2.A. Human generated mappings based on the evidence included in the report.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9905.png', 'ScreenshotCaption': "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]"}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred showing evidence of powershell.exe compressing via Compress-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14011.png', 'ScreenshotCaption': 'MSSP - 2.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11846.png', 'ScreenshotCaption': 'a1/2/4 - child item and compress archive blob/scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Data Compressed via Command Interpreter for Staging" was generated for a file modification with the .zip extension. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3776.png', 'ScreenshotCaption': 'data compressed *.zip'}, {'ScreenshotName': 'Carbon Black-APT29-3779.png', 'ScreenshotCaption': '*.zip filemod'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3751.png', 'ScreenshotCaption': 'script load content and the -2.png image as well'}, {'ScreenshotName': 'Carbon Black-APT29-3759.png', 'ScreenshotCaption': 'compression.dll modload'}], 'Footnotes': []}]}]}]}, {'Substep': '2.A.5', 'Procedure': 'Staged files for exfiltration into ZIP (Draft.zip) using PowerShell', 'Criteria': 'powershell.exe creating the file draft.zip', 'Techniques': [{'TechniqueId': 'T1074', 'TechniqueName': 'Data Staged', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-654.png', 'ScreenshotCaption': 'draft.zip being written'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of Draft.zip.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10759.png', 'ScreenshotCaption': 'Telemetry showing the draft.zip file being written.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Data Staged occurred containing evidence of the creation of the file Draft.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10772.png', 'ScreenshotCaption': 'MSSP - a5 (draft.zip create)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7372.png', 'ScreenshotCaption': '2.a.5 - file create event for draft.zip file'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of Draft.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11841.png', 'ScreenshotCaption': 'A5 - File write event for draft.zip'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Data Staged" was generated due to the NtCreateFile API being used to create Draft.zip. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1679.png', 'ScreenshotCaption': 'cc i think, showing enrichments for data staged and data compressed. '}], 'Footnotes': ['Configuration changes were made to increase detection capability, specifically additional API monitoring. ']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of Draft.zip. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1196.png', 'ScreenshotCaption': 'file create event - showing the file created (zip) coming off of powershell. '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of Draft.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14964.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for file creation of Draft.zip', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10869.png', 'ScreenshotCaption': '2.A.5 - PowerShell File Write for Draft.zip (bottom)'}, {'ScreenshotName': 'FireEye-APT29-10868.png', 'ScreenshotCaption': '2.A.5 - PowerShell File Write for Draft.zip (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the file creation of Draft.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12979.png', 'ScreenshotCaption': 'MSSP - 2.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of Draft.zip. This was correlated to prior a detection of the parent PowerShell process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10873.png', 'ScreenshotCaption': '2.A.5 - Triage view of powershell.exe writing Draft.zip with first bytes of the file displayed'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of Draft.Zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12745.png', 'ScreenshotCaption': '2.a MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10822.png', 'ScreenshotCaption': 'draft.zip file create event tagged with technique id for data comppressed, data encrypted. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of Draft.Zip by powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17988.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip. The event was correlated to a parent Technique detection for a suspicious PowerShell process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2650.png', 'ScreenshotCaption': '2.a.5 - Creation of Draft.Zip'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for Data Staged was generated due the creation of Draft.Zip. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Alert', 'Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2392.png', 'ScreenshotCaption': 'alert for data staged (2a5)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.', 'Exiting event details shows correlation of detections.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1448.png', 'ScreenshotCaption': 'creation of Draft.zip file'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery occurred containing evidence that PowerShell ran commands to query files with certain extensions and compress the found files into a zip file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17383.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-364.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating C:\\Users\\pam\\AppData\\Roaming\\Draft.Zip.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Data Staged "(T1074)" occurred containing evidence that there was a compressed zip file created named Draft.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13202.png', 'ScreenshotCaption': '2.A - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2678.png', 'ScreenshotCaption': 'Telemetry showing the File Creation event for Draft.zip. '}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-40.png', 'ScreenshotCaption': 'file write (shows as powershell file create in background as well)'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for the file creation of Draft.zip was received. The alert stated that "C:\\Users\\pam\\AppData\\Roaming\\Draft.zip" file was created.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-10769.png', 'ScreenshotCaption': 'A5 - MSSP - Creation of Draft.zip'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17890.png', 'ScreenshotCaption': '2.A.5 - File Creation for Draft.zip'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17539.png', 'ScreenshotCaption': 'A Technique detection + correlation'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell storing files in a zip file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12674.png', 'ScreenshotCaption': 'MSSP - 1A1 - 1A3 - 1B1 - 2A1/2 - 2A4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11844.png', 'ScreenshotCaption': 'a5 - draft.zip being created'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated referencing the creation of Draft.zip for later exfiltration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12751.png', 'ScreenshotCaption': '1.a.1 - 2.a.5 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3758.png', 'ScreenshotCaption': 'draft.zip file created, opened read and write '}], 'Footnotes': []}]}]}]}, {'Substep': '2.B.1', 'Procedure': 'Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)', 'Criteria': 'The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel', 'Techniques': [{'TechniqueId': 'T1041', 'TechniqueName': 'Exfiltration Over Command and Control Channel', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-658.png', 'ScreenshotCaption': 'ignore - old beacon c2 stuff'}, {'ScreenshotName': 'Bitdefender-APT29-655.png', 'ScreenshotCaption': 'draft.zip being read be .scr'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10192.png', 'ScreenshotCaption': 'Telemetry showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.'}, {'ScreenshotName': 'CrowdStrike-APT29-10254.png', 'ScreenshotCaption': 'Telemetry correlating the draft.zip file read to rcs.3aka3.doc.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-13667.png', 'ScreenshotCaption': '2b1 - draft.zip - vendor provided pic'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port TCP 1234).', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1177.png', 'ScreenshotCaption': 'double check to make sure i got network connection info. '}, {'ScreenshotName': 'Elastic-APT29-1697.png', 'ScreenshotCaption': 'cc ntcreatefile api call (new monitoring) showing the read of draft.zip'}], 'Footnotes': ['Configuration changes were made to increase detection capability, specifically additional API monitoring. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over TCP port 1234).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11676.png', 'ScreenshotCaption': 'file read and network connection in same screenshot (not a config change, just a revist of data)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Exfiltration Over Command and Control Channel "(T1041)" occurred containing evidence that "After the zip file is created, it’s read by \u200bcod.3aka3.scr... [and] the timeline view shows a C2 connection from \u200bnashua \u200bto \u200b192.168.0.5,\u200b in which cod.3aka3.scr s\u200bent 319,936 Bytes."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13203.png', 'ScreenshotCaption': '2.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2651.png', 'ScreenshotCaption': 'Telemetry showing rcs.3aka3.doc establishing a connection to 192.168.0.5 over TCP port 1234.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2699.png', 'ScreenshotCaption': '(1) file read by the pupy process.  if they had the firewall, they would be the ability to capture files over the network'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1041" containing evidence of a cod.3aka3.scr reading Draft.zip and a network connection to C2 (192.168.0.5).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12800.png', 'ScreenshotCaption': 'B1 - MSSP - file read + network connection'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14571.png', 'ScreenshotCaption': '2.B.1 - rcs.3aka3.doc opening Draft.zip'}, {'ScreenshotName': 'SentinelOne-APT29-14572.png', 'ScreenshotCaption': '2.B.1 - rcs.3aka3.doc network connection'}], 'Footnotes': ['A UX Configuration Change was made to bring host file reads into the UI.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file accessed event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11847.png', 'ScreenshotCaption': 'doc accesses the draft.zip with network stuff'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '3.A.1', 'Procedure': 'Dropped stage 2 payload (monkey.png) to disk', 'Criteria': 'The rcs.3aka3.doc process creating the file monkey.png', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-657.png', 'ScreenshotCaption': 'draft.zip being read '}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc reading file monkey.png. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10256.png', 'ScreenshotCaption': 'Telemetry showing a file read operation for the monkey.png by rcs.3aka3.doc.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7379.png', 'ScreenshotCaption': '3.a.1 - monkey png again'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11850.png', 'ScreenshotCaption': 'A1 - File creation event of monkey.png by 3aka3.doc'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1201.png', 'ScreenshotCaption': 'maybe something with monkey.png obfuscated????'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (informational) was generated due to a suspicious download by PowerShell. The detection was correlated to a parent alert for Abnormal File Modification.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10016.png', 'ScreenshotCaption': 'process tree, powershell payload, sus download '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "User Directory File Write" was generated due to the file monkey.png being written to the user\'s desktop.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11729.png', 'ScreenshotCaption': 'CC - 3.A.1 - User Directory File Write for monkey.png'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of rcs.3aka3.doc creating the monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12981.png', 'ScreenshotCaption': 'MSSP - 3.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10900.png', 'ScreenshotCaption': '3.A.1 - rcs.3aka3.doc creating monkey.png'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of rcs.3aka3.doc creating the monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12705.png', 'ScreenshotCaption': '3.a.1-2 MSSP alert #2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10829.png', 'ScreenshotCaption': 'file create  of monkey.png, mis identified as a screen  cap technique. (3.a.1)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3474.png', 'ScreenshotCaption': '3.A.1 - Process path is rcs.3aka3.doc for the same event'}, {'ScreenshotName': 'HanSight-APT29-3473.png', 'ScreenshotCaption': '3.A.1 - File created event for monkey.png'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png. The event was correlated to a parent detection for masquerading. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2681.png', 'ScreenshotCaption': '3.A.1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc writing monkey.png. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2398.png', 'ScreenshotCaption': 'creation of monkey.png'}], 'Footnotes': ['Expanding technique detection for Masquerading for rcs.3aka3.doc shows file write of monkey.png.', 'Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1464.png', 'ScreenshotCaption': 'creation of monkey.png by rcs.3aka3.doc'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Defense Evasion occurred containing evidence of monkey.png being uploaded to Nashua.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-386.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Command and Control and Defense Evasion'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Remote File Copy "(T1105)" occurred containing evidence that cod.3aka3.scr\u200b has downloaded and wrote a file named\u200b monkey.png\u200b to \u200bC:\\Users\\pam\\Downloads.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13195.png', 'ScreenshotCaption': '3.A.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-17855.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-47.png', 'ScreenshotCaption': 'shows the file written in downloads'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1105" occurred containing evidence of rcs.3aka3.doc creating monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12801.png', 'ScreenshotCaption': 'MSSP - A1/2 - File creation and stego'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating new file monkey.png. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6500.png', 'ScreenshotCaption': 'A.1 -Process tree of money.png being created'}, {'ScreenshotName': 'SentinelOne-APT29-6499.png', 'ScreenshotCaption': 'A.1 -  Detailed view of file being created'}, {'ScreenshotName': 'SentinelOne-APT29-6501.png', 'ScreenshotCaption': 'A.1 - File creation of monkey.png'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png, with the file path reversed due to the Unicode right-to-left override character.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9907.png', 'ScreenshotCaption': 'File creation for monkey.png'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11861.png', 'ScreenshotCaption': 'RCA pretty view - scr > monkey and PS accessed the monkey (link to the raw PS that was encoded in the file (could work for 3b2 too)'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3780.png', 'ScreenshotCaption': 'filemod of monkey.png'}], 'Footnotes': []}]}]}]}, {'Substep': '3.A.2', 'Procedure': 'Embedded PowerShell payload in monkey.png using steganography', 'Criteria': 'Evidence that a PowerShell payload was within\xa0monkey.png', 'Techniques': [{'TechniqueId': 'T1027', 'TechniqueName': 'Obfuscated Files or Information', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "PowershellImgObfuscation" was generated due to a payload being loaded from an image via PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-672.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-675.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert (high severity) was generated for PowerShell using obfuscation. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10259.png', 'ScreenshotCaption': '3.b.1 Powershell executing against the obfuscated monkey.png in falcon activity app view'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-15011.png', 'ScreenshotCaption': '3a2 - new vendor screenshot'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (purple indicator) was generated for PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2206.png', 'ScreenshotCaption': 'Threat Activity PowerShell scriptblock log creation of monkey.png, but not File Creation of monkey.png'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Obfuscated Files or Information" occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12231.png', 'ScreenshotCaption': '3.A.2 - MDR Report Day 1'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for a malicious PowerShell process that showed the PowerShell script contained within monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9894.png', 'ScreenshotCaption': '3.a.2 - powershell loaded from monkey. full path from process tree'}, {'ScreenshotName': 'Cybereason-APT29-9895.png', 'ScreenshotCaption': '3.a.2 - malop for malicious process, powershell '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Obfuscated Files or Information" occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10775.png', 'ScreenshotCaption': 'MSSP - a2, PS in monkey'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9893.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11852.png', 'ScreenshotCaption': '-CY-3.A.2 - Stego information via SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14010.png', 'ScreenshotCaption': 'powershell -- monkey.png'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14335.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-11300.png', 'ScreenshotCaption': 'MSSP - executive overview (lots of steps alert) pt1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10021.png', 'ScreenshotCaption': 'script within monkey.png'}, {'ScreenshotName': 'F-Secure-APT29-10022.png', 'ScreenshotCaption': 'new-object moneky.png andthen the script above it '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12983.png', 'ScreenshotCaption': 'MSSP - 3.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10933.png', 'ScreenshotCaption': '3.A.2 - PowerShell extraction and execution on monkey.png'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Obfuscated PowerShell occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12705.png', 'ScreenshotCaption': '3.a.1-2 MSSP alert #2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10851.png', 'ScreenshotCaption': 'sid of powershell which could potentially be used for identifying integrity level. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3478.png', 'ScreenshotCaption': '3.A.2 - Registry value showing PowerShell executing code contained within monkey.png'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; high severity) for suspicious command-line obfuscation was generated for PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for suspicious PowerShell.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2694.png', 'ScreenshotCaption': 'tree for powershell command'}, {'ScreenshotName': 'Kaspersky-APT29-2693.png', 'ScreenshotCaption': 'powershell decoding script from monkey.png (likely 3.b.2)'}, {'ScreenshotName': 'Kaspersky-APT29-2693.png', 'ScreenshotCaption': 'powershell decoding script from monkey.png (likely 3.b.2)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of a PowerShell script in monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17989.png', 'ScreenshotCaption': 'new mssp 3a2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2693.png', 'ScreenshotCaption': 'powershell decoding script from monkey.png (likely 3.b.2)'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2399.png', 'ScreenshotCaption': 'Script that decodes monkey.png payload'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "Data Obfuscation" was generated due to the Suspicious Indicator "Script hidden in bitmap file executed through Powershell..."', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1963.png', 'ScreenshotCaption': 'CC - 3.a.1 alert indicating script hidden in BMP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent alert for rcs.3aka3.doc spawning cmd.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1964.png', 'ScreenshotCaption': 'CC 3.a.2 - new detection finds media file in ps script'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': "A General alert detection (medium severity) for suspicious PowerShell commandline was generated for PowerShell extracting and executing the code embedded within monkey.png. This detection was correlated to a parent General detection of rcs.3aka3.doc being identified as 'patpoopy' backdoor.", 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13981.png', 'ScreenshotCaption': 'General'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Defense Evasion occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-386.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Command and Control and Defense Evasion'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting, allocating memory, and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13982.png', 'ScreenshotCaption': 'Telemetry'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Obfuscated Files or Information" occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13195.png', 'ScreenshotCaption': '3.A.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2719.png', 'ScreenshotCaption': 'powershell process making the registry modification'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2757.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing a connection to 192.168.0.5 over TCP port 443.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-56.png', 'ScreenshotCaption': 'bypass uac'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) was generated for a PowerShell process executing code hidden in images via stenography. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6541.png', 'ScreenshotCaption': 'alert details for 3.A.1, 3.A.2'}, {'ScreenshotName': 'SecureWorks-APT29-6540.png', 'ScreenshotCaption': '3.a.2 - tactic technique categorization'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell script...that decodes malicious code" occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12592.png', 'ScreenshotCaption': 'MSSP - SW - 3A2 - up close alert PS in monkey (#2) (look slike the command line run vs the actual scriptBlock'}, {'ScreenshotName': 'SecureWorks-APT29-12588.png', 'ScreenshotCaption': 'MSSP - SW - 3a/b - PS in monkey; IEX; COM hijack; command value; UAC bypass; control.exe > PS; IP and port; scriptBlock'}, {'ScreenshotName': 'SecureWorks-APT29-12591.png', 'ScreenshotCaption': 'MSSP - SW - 3A2 - up close alert PS in monkey '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13735.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Steganography" was generated when identifying the PowerShell script contained within monkey.png.  The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7279.png', 'ScreenshotCaption': 'CC - A2 - Steganography Alert Generated'}], 'Footnotes': ['A Detection Configuration Change was made to detect common extensions without the appropriate file type content in the file.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1027" occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12802.png', 'ScreenshotCaption': 'MSSP - A2 - Powershell decoding stego'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7278.png', 'ScreenshotCaption': 'A1 - Cleaner view of powershell script generating monkey.png'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for Obfuscated Files or Information was generated for PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file. Detection incurred a delay based on machine learning processing.', 'Modifiers': ['Alert', 'Delayed (Processing)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17553.png', 'ScreenshotCaption': 'tech + delayed + corr'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data Obfuscation" occurred containing evidence of the PowerShell script contained within monkey.png.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9908.png', 'ScreenshotCaption': 'MEDR Report: Contains the powershell scriptblock log for deobfuscating the powershell script in monkey.png. Human analysis explains the script and use of steganography.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17553.png', 'ScreenshotCaption': 'tech + delayed + corr'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17557.png', 'ScreenshotCaption': '2 - PS decoding monkey (script block)'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for the execution of the PowerShell executing a fileless script or command. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3788.png', 'ScreenshotCaption': 'process tree'}, {'ScreenshotName': 'Carbon Black-APT29-3790.png', 'ScreenshotCaption': 'powerhsell executing a fileless script or command alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3793.png', 'ScreenshotCaption': 'control spawning powershell.exe with high integrity'}], 'Footnotes': []}]}]}]}, {'Substep': '3.B.1', 'Procedure': 'Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell', 'Criteria': 'Addition of\xa0the DelegateExecute\xa0\u200bsubkey in\xa0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b', 'Techniques': [{'TechniqueId': 'T1122', 'TechniqueName': 'Component Object Model Hijacking', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecution Registry Value. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1056.png', 'ScreenshotCaption': 'config change - delegateexecution value added'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10257.png', 'ScreenshotCaption': 'Telemetry showing the  registry modification adding the new delegrate execute value'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for the addition of the DelegateExecute Registry Value.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2106.png', 'ScreenshotCaption': 'Registry edits '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Component Object Model Hijacking" was received that included a PowerShell script and explained that it was used to modify a COM component to delegate execution.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12434.png', 'ScreenshotCaption': '3.B.1 - COM Hijacking, Set-ItemProperty'}, {'ScreenshotName': 'CyCraft-APT29-12243.png', 'ScreenshotCaption': '3.B.1, 3.B.2 - MDR Report Day 1'}, {'ScreenshotName': 'CyCraft-APT29-12435.png', 'ScreenshotCaption': '3.B.1 - COM Hijacking, New-Item'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "COM Hijacking (T1122)" occurred containing evidence of the addition of the DelegateExecute Registry Value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10777.png', 'ScreenshotCaption': 'MSSP - b1 - reg key'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9902.png', 'ScreenshotCaption': '3.b.1 - delegate execute registry entry (cc) '}], 'Footnotes': ['For the Configuration Change, the PowerShell detection policy was disabled.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a PowerShell command to add the DelegateExecute Registry Value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12233.png', 'ScreenshotCaption': 'B1 - SBL showing addition of DelegateExecute key'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection (red label) for "Registry Preparation of UAC Bypass" was generated due to the addition of the DelegateExecute Registry Value. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated', 'Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1710.png', 'ScreenshotCaption': 'cc loosening rule logic to get the bypass uac enrichment and new alert. '}], 'Footnotes': ['Configuration changes were made to loosen rule logic and/or black lists.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1204.png', 'ScreenshotCaption': 'showing the registry modified of the delegateexecute'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry Value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14338.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-11300.png', 'ScreenshotCaption': 'MSSP - executive overview (lots of steps alert) pt1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Registry write of the command subkey.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10024.png', 'ScreenshotCaption': 'shell open command reg write'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the addition of the DelegateExecute Registry Value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12984.png', 'ScreenshotCaption': 'MSSP - 3.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10928.png', 'ScreenshotCaption': '3.B.1 - Addition of the DelegateExecute Registry Value'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Component Object Model Hijacking contained evidence of the DelegateExecute subkey added to the Registry.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12702.png', 'ScreenshotCaption': '3.b.1 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11677.png', 'ScreenshotCaption': 'registry modification event, went back on the third day to collect, but not a config change. shows the delegate execute. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3492.png', 'ScreenshotCaption': '3.B.1 - Registry value set for DelegateExecute'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the addition of DelegateExecute value in the Registry.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17990.png', 'ScreenshotCaption': 'new mssp 3b1 '}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1476.png', 'ScreenshotCaption': 'DelegateExecute'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated due to a change in Registry value of command key.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-369.png', 'ScreenshotCaption': 'Detection for Change Default File Association'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Defense Evasion was generated due to a Registry key being enabled to permit Component Object Model Hijacking.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-386.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Command and Control and Defense Evasion'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-377.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe setting registry value DelegateExecute for key HKCU\\Software\\Classes\\Folder\\shell\\open\\command.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated identifying the Registry modification as a malware behavior threat. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13642.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13643.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of addition of DelegateExecute \u200bsubkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13197.png', 'ScreenshotCaption': '3.B.1 (B) - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13196.png', 'ScreenshotCaption': '3.B.1 (A) - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2767.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe creating a persistence key called delegateexecute'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-58.png', 'ScreenshotCaption': 'shows delegateexecute'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of addition of DelegateExecute \u200bsubkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12589.png', 'ScreenshotCaption': 'MSSP - SW - 3a/b - PS in monkey; IEX; COM hijack; command value; UAC bypass; control.exe > PS; IP and port; scriptBlock'}, {'ScreenshotName': 'SecureWorks-APT29-12593.png', 'ScreenshotCaption': 'MSSP - SW - 3B1 - new-item with params for COM hijacking - up close alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command to add DelegateExecute Registry Value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6620.png', 'ScreenshotCaption': 'event details related to 3.b.1 '}, {'ScreenshotName': 'SecureWorks-APT29-6623.png', 'ScreenshotCaption': 'event details for new-item registry key'}, {'ScreenshotName': 'SecureWorks-APT29-6622.png', 'ScreenshotCaption': 'event details 3.b.1'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1122" occurred containing evidence of DelegateExecute subkey being added to the Registry.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12804.png', 'ScreenshotCaption': 'MSSP - B1 - Registry additions'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed addition of the DelegateExecute Registry Value. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6508.png', 'ScreenshotCaption': 'B.1 - shows creation of new regkey, AND mention DelegateExecute'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9910.png', 'ScreenshotCaption': 'powershell.exe creating DelegateExecute registry key'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "Noteworthy Behavior T1122" was generated due to the addition of the DelegateExecute Registry Value. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12314.png', 'ScreenshotCaption': 'CC - 3.B.1 - Noteworthy Behavior T1122 Grey Detection'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry Value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17559.png', 'ScreenshotCaption': 'b1 - command value added to registry'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for the Registry Modification of the command subkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12752.png', 'ScreenshotCaption': '3.b.1-2 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the Registry modifications of the DelegateExecute \u200bRegistry value. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13937.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-3795.png', 'ScreenshotCaption': 'registry scriptload content'}, {'ScreenshotName': 'Carbon Black-APT29-3797.png', 'ScreenshotCaption': 'deletegateexecute registry '}], 'Footnotes': []}]}]}]}, {'Substep': '3.B.2', 'Procedure': 'Executed elevated PowerShell payload', 'Criteria': 'High integrity powershell.exe spawning from\xa0control.exe\u200b\u200b (spawned from sdclt.exe)', 'Techniques': [{'TechniqueId': 'T1088', 'TechniqueName': 'Bypass User Account Control', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for Bypass User Account Control was generated for sdclt.exe being executed with a higher integrity level than its parent process. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13421.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-664.png', 'ScreenshotCaption': 'sdclt suspicious process elevation execution'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for powershell.exe being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-662.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe spawning a powershell.exe tagged as High Integrity level and possessing elevated process access privileges.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (purple hexagon) called "Bypass User Account Control" was generated when control.exe spawned an elevated PowerShell payload. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10265.png', 'ScreenshotCaption': 'Technique detection for "Bypass User Account Control" showing control.exe spawning an elevated powershell correlated with res.3aka3.doc.'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (purple hexagon) called "Defense Evasion" was generated when a process reflectively loaded a DLL associated with meterpreter using the PowerShell payload. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10261.png', 'ScreenshotCaption': '3.b.2 incident view mode for monkey file being read by Powershell to deobfuscate'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10272.png', 'ScreenshotCaption': 'Telemetry showing the integrity level of the elevated powershell process running.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "Bypass UAC" was generated when sdclt.exe was executed in a high integrity context by cmd.exe. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2208.png', 'ScreenshotCaption': 'CyCarrier: UAC Bypass detection'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (yellow indicator) was generated for an unprivileged process executing another program with SYSTEM permissions.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2083.png', 'ScreenshotCaption': 'Bypass UAC.  Shows moving from different CyCarrier: process integrity levels'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Bypass User Account Control" was received that explained that cmd.exe (medium integrity) executed sdclt.exe (high integrity) to facilitate a UAC bypass resulting in execution of powershell.exe (High Integrity).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12243.png', 'ScreenshotCaption': '3.B.1, 3.B.2 - MDR Report Day 1'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red; unique symbol) for malicious PowerShell was generated for new high integrity PowerShell callback spawning from control.exe\u200b\u200b. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7389.png', 'ScreenshotCaption': '3.b.2 - high integrity proess'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7389.png', 'ScreenshotCaption': '3.b.2 - high integrity proess'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed control.exe spawning powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11862.png', 'ScreenshotCaption': 'B2 - Control.exe spawning powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1207.png', 'ScreenshotCaption': 'powershell running with unusual arguments execution alert'}, {'ScreenshotName': 'Elastic-APT29-1208.png', 'ScreenshotCaption': 'endgame client search to show integrity levels of powershell. shows high, and all others medium'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity) was generated due to powershell.exe running with parameters associated with post exploitation payloads.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14966.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for User DMEVALS\\pam launching a command prompt from which the sdclt.exe program was used. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11267.png', 'ScreenshotCaption': 'MSSP - bypass uac '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17347.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sdclt Child Process" was generated due to sdclt.exe spawning control.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10908.png', 'ScreenshotCaption': '3.B.2 - Sdclt Child Process for sdclt.exe spawning control.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for a new high integrity PowerShell callback spawned from control.exe\u200b\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12984.png', 'ScreenshotCaption': 'MSSP - 3.B'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Bypass User Account Control" was generated due to PowerShell spawning from control.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10841.png', 'ScreenshotCaption': 'related  behavior is bypass uac, shows the execution of monkey.png (3.b.2)  coming from controll.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10841.png', 'ScreenshotCaption': 'related  behavior is bypass uac, shows the execution of monkey.png (3.b.2)  coming from controll.exe'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Bypass UAC Attempt by TokenElevationType" was generated due to control.exe spawning powershell.exe with high privilege.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3482.png', 'ScreenshotCaption': '3.B.2 - Bypass UAC alert with control.exe executing powershell.exe with high integrity'}, {'ScreenshotName': 'HanSight-APT29-3486.png', 'ScreenshotCaption': '3.B.2 - Bypass UAC alert with sdclt.exe executing control.exe with high integrity'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-15120.png', 'ScreenshotCaption': '3B2 - new vendor pic - scriptBlock high IL, control.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red; high severity) for "Suspicious PowerShell" was generated due to execution of powershell.exe by control.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2709.png', 'ScreenshotCaption': '3.b.2 - powershell from control with alert'}, {'ScreenshotName': 'Kaspersky-APT29-2710.png', 'ScreenshotCaption': 'There was no indication the PowerShell process was high integrity.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Possible UAC Bypass" contained evidence of a new highiIntegrity PowerShell callback spawning from control.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17991.png', 'ScreenshotCaption': 'new mssp 3b2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell spawning from control.exe\u200b\u200b.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2709.png', 'ScreenshotCaption': '3.b.2 - powershell from control with alert'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1468.png', 'ScreenshotCaption': 'powershell with control.exe parent'}, {'ScreenshotName': 'McAfee-APT29-1467.png', 'ScreenshotCaption': 'powershell with high integrity (3)'}], 'Footnotes': ['MVISION Endpoint would have blocked this step due to a signature-based detection for code being executed in a PowerShell session. ']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for UAC bypass (medium severity) was generated. The detection included  sdclt.exe executing with elevated permissions.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-373.png', 'ScreenshotCaption': 'Detection for UAC bypass (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-381.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing a connection to 192.168.0.5 over TCP port 443.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for for "Bypass User Account Control VIA registry hijack T1088" for control.exe creating a high integrity powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2744.png', 'ScreenshotCaption': '2 - powershell in high-integrity'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2741.png', 'ScreenshotCaption': 'Technique detection for registry set values of the command key.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "UAC bypass (T1088)" occurred for a new high hntegrity PowerShell callback spawning from control.exe\u200b\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13197.png', 'ScreenshotCaption': '3.B.1 (B) - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Bypass User Account Control" was generated due to a high integrity PowerShell spawning from control.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-59.png', 'ScreenshotCaption': 'bypassUAC - high integrity level (PS)'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for a new high integrity PowerShell callback spawned from control.exe\u200b\u200b using sdclt.exe', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12589.png', 'ScreenshotCaption': 'MSSP - SW - 3a/b - PS in monkey; IEX; COM hijack; command value; UAC bypass; control.exe > PS; IP and port; scriptBlock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6544.png', 'ScreenshotCaption': '3.b.2 -sdclt.exe integrity view of process tree - admin'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "TokenManipulation" was generated when user Pam targeted user "NT AUTHORITY\\SYSTEM" in conjunction with "setcbprivilege" usage. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6512.png', 'ScreenshotCaption': 'B2 - shows process integrity level'}, {'ScreenshotName': 'SentinelOne-APT29-6513.png', 'ScreenshotCaption': 'B2 - shows integrity level of "3" '}, {'ScreenshotName': 'SentinelOne-APT29-6516.png', 'ScreenshotCaption': 'B2 - Was able to capture that token manipulation was used to escalate privs'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1088" occurred containing evidence of new high integrity PowerShell callback spawning from control.exe\u200b\u200b (spawned from sdclt.exe).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12805.png', 'ScreenshotCaption': 'MSSP - B2 - UAC Bypass info'}, {'ScreenshotName': 'SentinelOne-APT29-12806.png', 'ScreenshotCaption': 'MSSP - B2 - UAC Bypass info'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new high integrity PowerShell callback spawning from control.exe\u200b\u200b (spawned from sdclt.exe). The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6514.png', 'ScreenshotCaption': 'B2 - Shows tree view of processes and their integrity level. '}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7397.png', 'ScreenshotCaption': 'control.exe executing powershell.exe to decode script from monkey.png'}, {'ScreenshotName': 'Symantec-APT29-7400.png', 'ScreenshotCaption': 'Decoder event with columns for user, integrity evel, pid, and command-line arguments showing the stager'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell callback spawning from control.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11869.png', 'ScreenshotCaption': 'b3/4/5 - powershell and network connection (and port) - RCA '}, {'ScreenshotName': 'TrendMicro-APT29-11867.png', 'ScreenshotCaption': 'b2 - process IL high '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection was generated for "Privilege Escalation" based on suspicious PowerShell behavior.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3799.png', 'ScreenshotCaption': 'privilege escalation alert suspicious powershell'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for the use of sdclt.exe as a high privilege process, which called control.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12752.png', 'ScreenshotCaption': '3.b.1-2 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3793.png', 'ScreenshotCaption': 'control spawning powershell.exe with high integrity'}], 'Footnotes': []}]}]}]}, {'Substep': '3.B.3', 'Procedure': 'Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443', 'Criteria': 'Established network channel over port 443', 'Techniques': [{'TechniqueId': 'T1043', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-668.png', 'ScreenshotCaption': 'remote connection over port 443'}, {'ScreenshotName': 'Bitdefender-APT29-1087.png', 'ScreenshotCaption': 'port 443 in gravity zone - a different detection? no? '}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP report showed sdclt.exe spawned a process that connected to 192.168.0.5 on port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10285.png', 'ScreenshotCaption': 'Telemetry showing an overwatch alert for the outbound connection by powershell.exe.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.  The event was correlated to a parent technique detection for Bypass User Account Control of control.exe spawning powershell.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10275.png', 'ScreenshotCaption': 'Telemetry showing the powershell.exe processing opening and. closing a network connection to 192.168.0.5 on port 443.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert (red indicator) was generated for powershell.exe execution, which included connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2211.png', 'ScreenshotCaption': 'Standard application layer protocol connection to port 443 with enrichments.'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.  The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-7390.png', 'ScreenshotCaption': '3.b.3 - connection over port 443 process details'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (info severity) called "Powershell Network Connections" was generated for PowerShell making a network connection to 192.168.0.5 over port 443.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11851.png', 'ScreenshotCaption': 'B3 - Network information event - PowerShell connects to 192.168.0.5 on TCP 443\n'}, {'ScreenshotName': 'Cylance-APT29-11852.png', 'ScreenshotCaption': '-CY-3.A.2 - Stego information via SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP 443.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) called "Detected Command and Control" was generated due to PowerShell connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14508.png', 'ScreenshotCaption': '3b3 - tactic - vendor new pic'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for the first network connection for a known process. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14509.png', 'ScreenshotCaption': '3b3 - general vendor new pic'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1209.png', 'ScreenshotCaption': 'command and control enrichment'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10035.png', 'ScreenshotCaption': 'port 443 with 192.168.0.5'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for PowerShell making a network connection.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10917.png', 'ScreenshotCaption': '3.B.3 - PowerShell Network Connection'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12985.png', 'ScreenshotCaption': 'MSSP - 3.B'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called Commonly Used Port was generated due to powershell.exe connecting to 192.168.0.5 on TCP port 443. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10849.png', 'ScreenshotCaption': 'network connection  over port 443  (commonly used port tag)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The event is correlated to a parent alert on PowerShell Invoke Expression Launched.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10848.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3498.png', 'ScreenshotCaption': '3.B.3 - powershell.exe connecting to 192.168.0.5 on TCP 443'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; high severity) called "Commonly Used Port" was generated due to powershell.exe connecting to 192.168.0.5 on TCP 443. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2717.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Kaspersky-APT29-2717.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2717.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1467.png', 'ScreenshotCaption': 'powershell with high integrity (3)'}, {'ScreenshotName': 'McAfee-APT29-1477.png', 'ScreenshotCaption': 'commonly used port - 443 (pid 10728 HI PS) '}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Defense Evasion was generated containing evidence monkey.png performed C&C over port 443 to IP address 192.168.0.5.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-386.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Command and Control and Defense Evasion'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-381.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing a connection to 192.168.0.5 over TCP port 443.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Commonly Used Port was\ngenerated containing evidence monkey.png performed C&C over port 443 to IP address 192.168.0.5.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13197.png', 'ScreenshotCaption': '3.B.1 (B) - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2745.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing a connection to 192.168.0.5 over TCP port 443.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2757.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing a connection to 192.168.0.5 over TCP port 443.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "Commonly Used Port" was generated for powershell.exe connecting to 192.168.0.5 on TCP 443. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-59.png', 'ScreenshotCaption': 'bypassUAC - high integrity level (PS)'}, {'ScreenshotName': 'ReaQta-APT29-61.png', 'ScreenshotCaption': '3B3 - common port on right ip'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': ' A General alert detection (medium severity) was generated for PowerShell behaving like a RAT.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13976.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443 using shellcode that loads WinInet.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12589.png', 'ScreenshotCaption': 'MSSP - SW - 3a/b - PS in monkey; IEX; COM hijack; command value; UAC bypass; control.exe > PS; IP and port; scriptBlock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6693.png', 'ScreenshotCaption': 'netflow event continued '}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1043" occurred containing evidence of powershell.exe connecting to 192.168.0.5 on TCP 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12807.png', 'ScreenshotCaption': 'MSSP - B3/4/5 - port information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting outbound to 192.168.0.5 on TCP 443. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6515.png', 'ScreenshotCaption': 'B3/4/5 - Network connection, powershell exchanging data with host over https'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Attack, Backdoor" was generated when PowerShell connected to 192.168.0.5 on port 443.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7402.png', 'ScreenshotCaption': 'Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7402.png', 'ScreenshotCaption': 'Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Commonly Used Port" was generated due to powershell.exe connecting to 192.168.0.5 on TCP 443. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11866.png', 'ScreenshotCaption': 'b3/4/5 - DDI - detection info and network IP (mapped to ATT&CK)'}, {'ScreenshotName': 'TrendMicro-APT29-11869.png', 'ScreenshotCaption': 'b3/4/5 - powershell and network connection (and port) - RCA '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14012.png', 'ScreenshotCaption': 'MSSP - 3.B.3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11869.png', 'ScreenshotCaption': 'b3/4/5 - powershell and network connection (and port) - RCA '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3824.png', 'ScreenshotCaption': 'netconnection 3b3, says there is an active C2'}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell making network connections.']}]}]}]}, {'Substep': '3.B.4', 'Procedure': 'Used HTTPS to transport\xa0C2 (192.168.0.5) traffic', 'Criteria': 'Evidence that the network data sent over the C2 channel is HTTPS', 'Techniques': [{'TechniqueId': 'T1071', 'TechniqueName': 'Standard Application Layer Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SSL network connection to 192.168.0.5 on port 443.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1086.png', 'ScreenshotCaption': 'ssl connection cc'}, {'ScreenshotName': 'Bitdefender-APT29-1088.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell process exchanging data over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17349.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though process memory for the PowerShell process indicated the data exchange was over HTTPS.', 'Modifiers': ['Residual Artifact'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10929.png', 'ScreenshotCaption': '3.B - Parsing strings in process memory for HTTPS reference'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply.']}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Command and Control was generated containing evidence Meterpreter communications were being sent using HTTPS, due to the presence of the WINHTTP_FLAG_SECURE within the embedded shell code.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-579.png', 'ScreenshotCaption': 'HTTP IDA (3b4 3b5)'}, {'ScreenshotName': 'Microsoft-APT29-13989.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443 using shellcode that loads WinInet.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12589.png', 'ScreenshotCaption': 'MSSP - SW - 3a/b - PS in monkey; IEX; COM hijack; command value; UAC bypass; control.exe > PS; IP and port; scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1071" occurred containing evidence of PowerShell process exchanging data with 192.168.0.5 over HTTPS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12807.png', 'ScreenshotCaption': 'MSSP - B3/4/5 - port information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6515.png', 'ScreenshotCaption': 'B3/4/5 - Network connection, powershell exchanging data with host over https'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Attack, Backdoor" was generated when PowerShell process exchanged data with 192.168.0.5 over HTTPS due to network traffic analysis.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7402.png', 'ScreenshotCaption': 'Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7402.png', 'ScreenshotCaption': 'Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Standard Application Layer Protocol" was generated due to the PowerShell process exchanging data with 192.168.0.5 over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11866.png', 'ScreenshotCaption': 'b3/4/5 - DDI - detection info and network IP (mapped to ATT&CK)'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed powershell.exe loading of HTTP and cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3825.png', 'ScreenshotCaption': 'winhttp.dll for network connection'}, {'ScreenshotName': 'Carbon Black-APT29-13938.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '3.B.5', 'Procedure': 'Used HTTPS to encrypt C2 (192.168.0.5) traffic', 'Criteria': 'Evidence that the network data sent over the C2 channel is encrypted', 'Techniques': [{'TechniqueId': 'T1032', 'TechniqueName': 'Standard Cryptographic Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a SSL connection to to 192.168.0.5 on port 443.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1086.png', 'ScreenshotCaption': 'ssl connection cc'}, {'ScreenshotName': 'Bitdefender-APT29-1088.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell process exchanging data over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-15101.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though process memory for the PowerShell process indicated the data exchange was over HTTPS.', 'Modifiers': ['Residual Artifact'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10929.png', 'ScreenshotCaption': '3.B - Parsing strings in process memory for HTTPS reference'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply.']}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Command and Control was generated containing evidence Meterpreter communications are being sent using HTTPS, due to the presence of the WINHTTP_FLAG_SECURE within the embedded shell code.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13989.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-579.png', 'ScreenshotCaption': 'HTTP IDA (3b4 3b5)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1032" occurred containing evidence of the PowerShell process exchanging data with 192.168.0.5 over HTTPS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12807.png', 'ScreenshotCaption': 'MSSP - B3/4/5 - port information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6515.png', 'ScreenshotCaption': 'B3/4/5 - Network connection, powershell exchanging data with host over https'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Attack, Backdoor" was generated when PowerShell process exchanged data with 192.168.0.5 over HTTPS due to network traffic analysis.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7402.png', 'ScreenshotCaption': 'Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7402.png', 'ScreenshotCaption': 'Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Standard Application Layer Protocol" was generated due to the PowerShell process exchanging data with 192.168.0.5 over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11866.png', 'ScreenshotCaption': 'b3/4/5 - DDI - detection info and network IP (mapped to ATT&CK)'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed powershell.exe loading of HTTP and cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13938.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-3825.png', 'ScreenshotCaption': 'winhttp.dll for network connection'}], 'Footnotes': []}]}]}]}, {'Substep': '3.C.1', 'Procedure': 'Modified the Registry to remove artifacts of COM hijacking', 'Criteria': 'Deletion of of\xa0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey', 'Techniques': [{'TechniqueId': 'T1112', 'TechniqueName': 'Modify Registry', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1085.png', 'ScreenshotCaption': 'registry delete'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey. The event was correlated to a parent technique detection for Bypass User Account Control of control.exe spawning powershell.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10282.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe deleting the command subkey.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for the PowerShell command to remove DelegateExecute Registry Value. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2213.png', 'ScreenshotCaption': 'Threat Activity - Remove registry key through PowerShell scriptblock logging'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Modify Registry" was received that included a PowerShell script and explained that it was used to delete previously created registry keys.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12437.png', 'ScreenshotCaption': '3.B.1 - Modify Registry, deleting key'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command to remove the DelegateExecute Registry Value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11892.png', 'ScreenshotCaption': 'C1 - SBL showing removal of regkey'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command to remove DelegateExecute Registry Value.  The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1211.png', 'ScreenshotCaption': 'file deletion  of the registry path from powershell'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the recursive deletion of the registry key.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11275.png', 'ScreenshotCaption': 'MSSP - remove item'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command to remove DelegateExecute Registry Value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17351.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the Deletion of the registry value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12986.png', 'ScreenshotCaption': 'MSSP - 3.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey. This was correlated with a prior detection of the PowerShell parent process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10960.png', 'ScreenshotCaption': '3.C.1 - Triage view of Remove-Item'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10862.png', 'ScreenshotCaption': 'registry delete event for 3.c.1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed deletion of HKCU\\Software\\Classes\\Folder\\shell\\Open\\command value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3500.png', 'ScreenshotCaption': '3.C.1 - Registry object added or deleted for command value'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Defense Evasion was generated containing evidence of the deletion of registry key.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-386.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Command and Control and Defense Evasion'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command to remove DelegateExecute Registry Value. This event was correlated to a previous detection for PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13983.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Modify Registry "(T1070)" occurred for the Deletion of the registry value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13198.png', 'ScreenshotCaption': '3.C.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2768.png', 'ScreenshotCaption': 'Telemetry showing deletion of command value.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command Registry subkey.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-65.png', 'ScreenshotCaption': 'registry value deleted - use this one'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Defense Evasion - Modify Registry" occurred containing evidence of the deletion of the subkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12594.png', 'ScreenshotCaption': 'MSSP - SW - 3C1 - registry change, with alert details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command to remove the DelegateExecute Registry Value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6618.png', 'ScreenshotCaption': 'script block - 3.c.1'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1112" occurred containing evidence of command subkey being removed from the Registry.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12808.png', 'ScreenshotCaption': 'MSSP - C1 - removal of subkey'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6520.png', 'ScreenshotCaption': 'C1 - Shows powershell command used to remove the regkey via TrueContext or UID'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9919.png', 'ScreenshotCaption': 'powershell.exe deleting registry key. Event in question is at the top'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the deletion of the the command subkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11870.png', 'ScreenshotCaption': 'PS deleting command key'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3854.png', 'ScreenshotCaption': 'reg scriptload content'}, {'ScreenshotName': 'Carbon Black-APT29-3851.png', 'ScreenshotCaption': 'delete reg mods'}], 'Footnotes': []}]}]}]}, {'Substep': '4.A.1', 'Procedure': 'Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)', 'Criteria': 'powershell.exe creating the file SysinternalsSuite.zip', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-678.png', 'ScreenshotCaption': 'file write of .zip'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10291.png', 'ScreenshotCaption': 'Telemetry showing ZipFileWritten (file creation) for the zip file SysinternalsSuite.zip.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for malicious PowerShell.  ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9596.png', 'ScreenshotCaption': '4.a.1 - we can see sysinternalsuite.zip in the file event from the process tree'}, {'ScreenshotName': 'Cybereason-APT29-9594.png', 'ScreenshotCaption': '4.a.1 - malicious high integrity powershell'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11889.png', 'ScreenshotCaption': 'A1 - Powershell doing something with SysinternalsSuite.zip (Shows creation time but no create event)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1213.png', 'ScreenshotCaption': 'making sure i got the full file create details for sysinternals zip'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated for PowerShell downloading a significant amount of data using HTTP(S).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10036.png', 'ScreenshotCaption': 'powershell downloaded a significiant amount of data using HTTPS - https based off of '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for a ZIP archive being written to disk. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10943.png', 'ScreenshotCaption': '4.A.1 - Zip Archive Created for SysinternalsSuite.zip (top)'}, {'ScreenshotName': 'FireEye-APT29-10944.png', 'ScreenshotCaption': '4.A.1 - Zip Archive Created for SysinternalsSuite.zip (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of  file write of the ZIP by PowerShell. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12987.png', 'ScreenshotCaption': 'MSSP - 4.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for a PowerShell process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11001.png', 'ScreenshotCaption': '4.A.1 - Triage view of PowerShell creating SysinternalsSuite.zip'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for "File archive created" due to PowerShell creating a compressed archive. The event is correlated to a parent alert on Bypass User Account Control.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10875.png', 'ScreenshotCaption': 'sysinternals zip creation event by powershell 4.a.1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The event is correlated to a parent alert on Bypass User Account Control.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10875.png', 'ScreenshotCaption': 'sysinternals zip creation event by powershell 4.a.1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (reminder severity) was generated for "Data Compress Extension".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3504.png', 'ScreenshotCaption': '4.A.1 - powershell.exe creating file SysinternalsSuite.zip'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the file write of the ZIP by PowerShell. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-11776.png', 'ScreenshotCaption': 'MSSP Report Page 2 - Step 4'}, {'ScreenshotName': 'Kaspersky-APT29-11777.png', 'ScreenshotCaption': 'MSSP Report Page 3 - Step 4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for suspicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2729.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated due to PowerShell creating a compressed archive.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2521.png', 'ScreenshotCaption': 'alert for data staged'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent Technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2522.png', 'ScreenshotCaption': 'File write of sysinternals'}], 'Footnotes': ['Exiting event details shows correlation of detections.', 'Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1508.png', 'ScreenshotCaption': 'SysInternalsSuite.zip written'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-387.png', 'ScreenshotCaption': 'Telemetry showing high integrity powershell.exe creating new file: C:\\Users\\Pam\\Downloads\\SysinternalsSuite.zip'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for the creation of a file identified as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-14322.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-14323.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Remote File Copy "(T1105)" was received. The alert stated the privileged Powershell.exe created a zip file named SysInternalsSuite.zip in the Downloads folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13205.png', 'ScreenshotCaption': '4.A.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2784.png', 'ScreenshotCaption': 'Telemetry showing powershell creating creating SysinternalsSuite.zip.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection alert (orange indicator) was generated for powershell.exe creating a compressed file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process. ', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-73.png', 'ScreenshotCaption': 'two ps instances; data compressed, executable dropped, bypass uac; shows high privilege level for PS - to show high integrity PS'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-76.png', 'ScreenshotCaption': 'shows file create by powershell'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a remote file write of the ZIP by PowerShell. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12595.png', 'ScreenshotCaption': 'MSSP - SW - 4A-B1 - sysinternals being copied via PS; remote file copy; data compressed; discovery; expand archive and get-process commands'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1105" occurred containing evidence of the file write of the ZIP by PowerShell. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12809.png', 'ScreenshotCaption': 'MSSP - A1 - powershell.exe creating SysinternalsSuite.zip '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6521.png', 'ScreenshotCaption': 'A1 - Shows file creation of SysInternalsSuite without .zip'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7416.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Symantec-APT29-7419.png', 'ScreenshotCaption': 'MITRE tagged file creation event for sysinternal.zip file'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the file write of the ZIP by PowerShell. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11872.png', 'ScreenshotCaption': 'a1/2 - PS > sysinternals'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for "Sysinternals Tools Downloaded via Command Interpreter." The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3885.png', 'ScreenshotCaption': 'alerts sysinternals'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3890.png', 'ScreenshotCaption': 'filemod sysinterlassuite.zip'}], 'Footnotes': []}]}]}]}, {'Substep': '4.A.2', 'Procedure': 'Spawned interactive powershell.exe', 'Criteria': 'powershell.exe spawning from powershell.exe', 'Techniques': [{'TechniqueId': 'T1086', 'TechniqueName': 'PowerShell', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe.  The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-680.png', 'ScreenshotCaption': 'powershell calling new ps session'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10290.png', 'ScreenshotCaption': 'Telemetry showing a Powershell.exe process spawning from a powershell.exe process.  Telemetry showing file read operations for the zip file contents.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (yellow indicator) was generated for a new powershell.exe spawning from powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14918.png', 'ScreenshotCaption': '4.b.2 = powershell discovered in high integrity'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; unique symbol) for "Malicious Process powershell.exe" was generated due to suspicious use of PowerShell. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9597.png', 'ScreenshotCaption': '4.a.2 - interactive powershell process details'}, {'ScreenshotName': 'Cybereason-APT29-9594.png', 'ScreenshotCaption': '4.a.1 - malicious high integrity powershell'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12237.png', 'ScreenshotCaption': 'A2 - powershell spawning powershell - tree view'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "ATT&CK T1086 Powershell" was generated when powershell.exe spawned. The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1214.png', 'ScreenshotCaption': 'powersehll technique mapping enrichment'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1214.png', 'ScreenshotCaption': 'powersehll technique mapping enrichment'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for PowerShell (medium severity) was generated due to a suspicious PowerShell command. The detection was correlated to a parent alert for a suspicious download by PowerShell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14969.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for a suspicious download by PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14969.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell Execution" was generated due to the execution of powershell.exe, which was used to execute powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10946.png', 'ScreenshotCaption': '4.A.2 - PowerShell Execution of powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection for PowerShell child process was generated for powershell.exe spawning a child process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10947.png', 'ScreenshotCaption': '4.A.2 - PowerShell Child Process of powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "PowerShell" was generated due to powershell.exe spawning a new powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10877.png', 'ScreenshotCaption': 'powershell spawning powershell 4.a.2  T1086 correctly labeled  intelligence'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The event was correlated to a parent detection on "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10887.png', 'ScreenshotCaption': 'relationship view unexpanded for powershell file creates'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3516.png', 'ScreenshotCaption': '4.A.2 - powershell.exe executing powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; medium severity) called "PowerShell" was generated due to powershell.exe spawning a new powershell.exe. The detection  was correlated to a parent alert for suspicious PowerShell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-13797.png', 'ScreenshotCaption': '4a2 - vendor provided pic'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe spawning from powershell.exe and indicated the new PowerShell process was a meterpreter shell.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-11778.png', 'ScreenshotCaption': 'MSSP Report Page 4 - Step 4'}, {'ScreenshotName': 'Kaspersky-APT29-11777.png', 'ScreenshotCaption': 'MSSP Report Page 3 - Step 4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection  was correlated to a parent alert for suspicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2735.png', 'ScreenshotCaption': '4.a.2 - ps launches ps'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2523.png', 'ScreenshotCaption': 'powershell spawing powershell (4a2)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "PowerShell" was generated due to PowerShell being executed by another script. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1517.png', 'ScreenshotCaption': 'powershell executed - General'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for PowerShell. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1519.png', 'ScreenshotCaption': '4.a.2 new high integrity ps'}, {'ScreenshotName': 'McAfee-APT29-1520.png', 'ScreenshotCaption': '4.a.2 new PS parent process (10728)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-388.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe spawning new interactive PowerShell session with elevated privileges'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a new interactive session of PowerShell being created.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13205.png', 'ScreenshotCaption': '4.A.1 - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13208.png', 'ScreenshotCaption': '4.A.2, 4.A.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2786.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe creating new Powershell.exe process.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-73.png', 'ScreenshotCaption': 'two ps instances; data compressed, executable dropped, bypass uac; shows high privilege level for PS - to show high integrity PS'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6613.png', 'ScreenshotCaption': 'process tree showing powershell 4.a.2'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "ProcessCreationExtra" was generated for powershell.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14583.png', 'ScreenshotCaption': '4.A.2 - Execution of powershell.exe by powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1086" occurred containing evidence of a new interactive session of PowerShell being created.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-11807.png', 'ScreenshotCaption': 'MSSP - A2 - Process creation event'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6524.png', 'ScreenshotCaption': 'A2 - shows HI powershell spawning powershell'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "PowerShell" was generated when powershell.exe spawned powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7421.png', 'ScreenshotCaption': 'powershell spawning powershell, with PIDs'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a new powershell.exe spawning from powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12909.png', 'ScreenshotCaption': 'MSSP Day 1: Remote File Copy of sysinternals tools'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11872.png', 'ScreenshotCaption': 'a1/2 - PS > sysinternals'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3888.png', 'ScreenshotCaption': 'elevated true integrity high'}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Powershell or untrusted applications spawning command interpreters.']}]}]}]}, {'Substep': '4.A.3', 'Procedure': 'Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell', 'Criteria': 'powershell.exe executing Expand-Archive', 'Techniques': [{'TechniqueId': 'T1140', 'TechniqueName': 'Deobfuscate/Decode Files or Information', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for PowerShell writing unknown executable files. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-680.png', 'ScreenshotCaption': 'powershell calling new ps session'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing the files that were decompressed from the ZIP. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-681.png', 'ScreenshotCaption': 'path of .zip download'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The event was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10293.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe decompressing via Expand-Archive.'}, {'ScreenshotName': 'CrowdStrike-APT29-10295.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe file write operations from decompressing via Expand-Archive.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated due to powershell.exe decompressing the ZIP via Expand-Archive. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14998.png', 'ScreenshotCaption': '4a3 -new vendor screenshot correlation'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12439.png', 'ScreenshotCaption': '4.A.3 - MDR Report Day 1, Expand-Archive'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing the files that were decompressed from the ZIP. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9599.png', 'ScreenshotCaption': '4.a.3 - we have the events with the files from the expand archive '}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12329.png', 'ScreenshotCaption': 'A3 - SysinternalsSuite.zip files being created'}, {'ScreenshotName': 'Cylance-APT29-12238.png', 'ScreenshotCaption': 'A3 - SBL of powershell using Expand-Archive'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive. The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1215.png', 'ScreenshotCaption': 'expand archive script block event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell unzipping and moving SysInternals tools.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14345.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10052.png', 'ScreenshotCaption': 'sysinternals exe'}, {'ScreenshotName': 'F-Secure-APT29-17353.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell file write.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10957.png', 'ScreenshotCaption': '4.A.3 - Example write for Bginfo64.exe (bottom)'}, {'ScreenshotName': 'FireEye-APT29-10949.png', 'ScreenshotCaption': '4.A.3 - PowerShell File Write for extraction (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe decompressing files via Expand-Archive. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12987.png', 'ScreenshotCaption': 'MSSP - 4.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent alert for a PowerShell process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10966.png', 'ScreenshotCaption': '4.A.3 - Triage view indicating the alerts for PowerShell File Write'}, {'ScreenshotName': 'FireEye-APT29-10970.png', 'ScreenshotCaption': '4.A.3 - Script block logging for Expand-Archive'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing the files that were decompressed from the ZIP.  The event was correlated to a parent detection on "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10885.png', 'ScreenshotCaption': 'powershell file create event for sdelete'}, {'ScreenshotName': 'GoSecure-APT29-10888.png', 'ScreenshotCaption': 'relationship view with files listed on left from powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (Reminder severity) was generated for powershell.exe decompressing via Expand-Archive in the Downloads directory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3514.png', 'ScreenshotCaption': '4.A.3 - Suspicious PowerShell Download alert generated for Expand-Archive in Downloads'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17993.png', 'ScreenshotCaption': 'new mssp 4A3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing the files that were decompressed from the ZIP. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2734.png', 'ScreenshotCaption': '4.a.3 - files created (22) #2'}, {'ScreenshotName': 'Kaspersky-APT29-2735.png', 'ScreenshotCaption': '4.a.2 - ps launches ps'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing the files that were decompressed from the ZIP.  The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2526.png', 'ScreenshotCaption': 'file writes 1'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.', 'Exiting event details shows correlation of detections.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing the files that were decompressed from the ZIP. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1526.png', 'ScreenshotCaption': 'table view of files created from zip file'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-389.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Expand-Archive'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13208.png', 'ScreenshotCaption': '4.A.2, 4.A.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and the corresponding file writes. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13644.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-2789.png', 'ScreenshotCaption': 'Telemetry showing the execution of Compress-Archive.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-244.png', 'ScreenshotCaption': 'cc - expand archive with details'}, {'ScreenshotName': 'ReaQta-APT29-79.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Defense Evasion - Deobfuscate/Decode Files or Information" occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12597.png', 'ScreenshotCaption': 'MSSP - SW - 4A3 - expand archive scriptBlock'}, {'ScreenshotName': 'SecureWorks-APT29-12595.png', 'ScreenshotCaption': 'MSSP - SW - 4A-B1 - sysinternals being copied via PS; remote file copy; data compressed; discovery; expand archive and get-process commands'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6633.png', 'ScreenshotCaption': '4.a.3 event details expand-archive'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1140" occurred containing evidence of the extracted root folder being created, and the contents extracted.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12810.png', 'ScreenshotCaption': 'MSSP - A3- file unzipping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7187.png', 'ScreenshotCaption': 'CC - A3 - Generic alert created for Expand-Archive execution'}, {'ScreenshotName': 'SentinelOne-APT29-6523.png', 'ScreenshotCaption': 'A3 - Shows the unzipped files being created'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for "PowerShell created a suspicious file" on PowerShell writing the files that were decompressed from the ZIP. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17583.png', 'ScreenshotCaption': 'Gen alert 4a3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing the files that were decompressed from the ZIP. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7411.png', 'ScreenshotCaption': 'List of file creations by powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11875.png', 'ScreenshotCaption': 'raw query - Expand Archive'}, {'ScreenshotName': 'TrendMicro-APT29-11873.png', 'ScreenshotCaption': 'RCA - unzipped files '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) for powershell.exe fileless script or command was generated for "code_drop" and "detected_pup_app". ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3883.png', 'ScreenshotCaption': 'detected pup act, code drop'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell decompressing the ZIP via Expand-Archive as well as the subsequent file writes. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3892.png', 'ScreenshotCaption': '4a expand archive'}, {'ScreenshotName': 'Carbon Black-APT29-13939.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '4.B.1', 'Procedure': 'Enumerated current running processes using PowerShell', 'Criteria': 'powershell.exe executing Get-Process', 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "powershellprocessdiscovery" was generated due to powershell.exe executing Get-Process.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1058.png', 'ScreenshotCaption': 'Powershellprocess discovery'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.', 'PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10298.png', 'ScreenshotCaption': 'Telemetry showing  powershell.exe executing Get-Process. '}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated due to powershell.exe executing Get-Process. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2217.png', 'ScreenshotCaption': 'Get-Process with enrichments'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Win_GetSystemProcess_Powershell-MITRET1057" was generated due to powershell.exe executing Get-Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11904.png', 'ScreenshotCaption': 'B1 - powershell.exe executing Get-Process - GetSystemProcess alert'}, {'ScreenshotName': 'Cylance-APT29-11905.png', 'ScreenshotCaption': 'B1 - powershell.exe executing Get-Process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1220.png', 'ScreenshotCaption': 'get process powershell cmdlet event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10056.png', 'ScreenshotCaption': 'get-process'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12989.png', 'ScreenshotCaption': 'MSSP - 4.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10999.png', 'ScreenshotCaption': '4.B.1 - Script block log showing the execution of Get-Process'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (reminder severity) called "Process Discovery via PowerShell" was generated due to the use of Get-Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3527.png', 'ScreenshotCaption': '4.B.1 - Process Discovery via PowerShell from usage of Get-Process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3526.png', 'ScreenshotCaption': 'Get-Process in the Original_Log'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery was generated containing evidence that multiple local and domain reconnaissance operations were executed. Get-Process was specifically identified in the report.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-402.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (1 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-403.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (2 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-404.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (3 of 3)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13985.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13209.png', 'ScreenshotCaption': '4.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2833.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe executing get-process.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2832.png', 'ScreenshotCaption': 'Telemetry showing powershell executing QueryProcessList system call.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-246.png', 'ScreenshotCaption': 'cc -get process detail'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" occurred containing evidence of powershell.exe executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12596.png', 'ScreenshotCaption': 'MSSP - SW - 4A-B1 - sysinternals being copied via PS; remote file copy; data compressed; discovery; expand archive and get-process commands'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6634.png', 'ScreenshotCaption': 'event details - get-process 4.b.1'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ProcessEnumeration" under "Discovery {T1057}" was generated for PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14654.png', 'ScreenshotCaption': '4.B.1 - Process Discovery from PowerShell'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1057" occurred containing evidence of PowerShell listing current process via “Get-Process”.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12811.png', 'ScreenshotCaption': 'MSSP - B1 - Get-Process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (UX)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7189.png', 'ScreenshotCaption': 'CC - B1 - Generic alert for Execution of Get-Process in UI'}], 'Footnotes': ['A UX Configuration Change was made to bring Get-Process usage from host logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12910.png', 'ScreenshotCaption': 'MSSP Day 1: Process Discovery description'}, {'ScreenshotName': 'Symantec-APT29-12911.png', 'ScreenshotCaption': 'MSSP Day 1: Process Discovery name'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Process Discovery" (low severity) was generated due to powershell.exe executing Get-Process.\n', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12318.png', 'ScreenshotCaption': 'CC - b1 - get process technique'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing Get-Process. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11877.png', 'ScreenshotCaption': 'b1 - raw query - get process'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3902.png', 'ScreenshotCaption': 'get-process'}], 'Footnotes': []}]}]}]}, {'Substep': '4.B.2', 'Procedure': 'Deleted rcs.3aka3.doc on disk using SDelete', 'Criteria': 'sdelete64.exe deleting the file rcs.3aka3.doc', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for an unusual file write in the user directory. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13411.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-684.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for the SDelete process being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-14013.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and subsequently writing to the file. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-706.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-682.png', 'ScreenshotCaption': 'sdelete64 - deleting .scr'}, {'ScreenshotName': 'Bitdefender-APT29-683.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "File Deletion" was generated due to sdelete64.exe deleting rcs.3aka3.doc. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10360.png', 'ScreenshotCaption': '4.b sdelete alert of the suspicious file'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename events. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10296.png', 'ScreenshotCaption': 'Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc.'}, {'ScreenshotName': 'CrowdStrike-APT29-10328.png', 'ScreenshotCaption': 'Telemetry showing the file rename and delete operations for rcs.3aka3.doc.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated due to sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-15479.png', 'ScreenshotCaption': '4b2 - new vendor screen'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9603.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - sdelete deleting files'}, {'ScreenshotName': 'Cybereason-APT29-9601.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - filenames from path'}, {'ScreenshotName': 'Cybereason-APT29-9605.png', 'ScreenshotCaption': '4.b.2 / 3 /4 - sdelete deleting the files'}, {'ScreenshotName': 'Cybereason-APT29-9602.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - sdelete 64 process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Sdelete Usage" was generated due to sdelete64.exe deleting cod.3aka3.scr. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11912.png', 'ScreenshotCaption': 'B2 - Deletion of rcs.3aka3.doc payload'}, {'ScreenshotName': 'Cylance-APT29-11906.png', 'ScreenshotCaption': 'B4 - medium alert for sdelete usage'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Evading Detection" occurred containing evidence of sdelete64.exe deleting files.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12899.png', 'ScreenshotCaption': 'MSSP - sdelete usage'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12240.png', 'ScreenshotCaption': 'B2 - path stomping for rcs.3aka3.doc'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1225.png', 'ScreenshotCaption': 'making sure i got the .scr deletion'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for file deletion (medium severity) was generated due to sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert for PowerShell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10058.png', 'ScreenshotCaption': '.scr sdeletee'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11277.png', 'ScreenshotCaption': 'MSSP - all 3 sdeletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe deleting rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10057.png', 'ScreenshotCaption': 'sdelete doing its thing'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sdelete Command Execution" was generated due to the execution of sdelete64.exe to delete rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10994.png', 'ScreenshotCaption': '4.B.2 - Sdelete Command Execution on rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10988.png', 'ScreenshotCaption': '4.B - PowerShell Child Process of sdelete64.exe (top)'}, {'ScreenshotName': 'FireEye-APT29-10992.png', 'ScreenshotCaption': '4.B.2 - PowerShell Child Process for sdelete64.exe on rcs.3aka3.doc (bottom)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for the execution of a Sysinternals utility.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10986.png', 'ScreenshotCaption': '4.B.2 - Sysinternals Utility Execution for rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting the file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12990.png', 'ScreenshotCaption': 'MSSP - 4.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11005.png', 'ScreenshotCaption': '4.B.2 - Alphabetic rollovers from SDelete of rcs.3aka3.doc'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated due to the use of SDelete to delete rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10890.png', 'ScreenshotCaption': 'b1 will show nothing, but this is b1 with powershell spawning sdelete of scr file. impact tagged at 100  (presumably sdelete caused)'}, {'ScreenshotName': 'GoSecure-APT29-10892.png', 'ScreenshotCaption': '3 sdelete file deletions. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10892.png', 'ScreenshotCaption': '3 sdelete file deletions. '}, {'ScreenshotName': 'GoSecure-APT29-10890.png', 'ScreenshotCaption': 'b1 will show nothing, but this is b1 with powershell spawning sdelete of scr file. impact tagged at 100  (presumably sdelete caused)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "SDelete usage by Process Monitor" was generated due to sdelete64.exe process creation used to delete rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3523.png', 'ScreenshotCaption': '4.B.2 - sdelete64.exe deleting rcs.3aka3.doc'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of sdelete64.exe deleting rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17994.png', 'ScreenshotCaption': 'new mssp 4b2-4 (file deletes)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2752.png', 'ScreenshotCaption': '4.b.2 rcs file deleted'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for File Deletion was generated due to sdelete.exe deleting ?cod.3aka3.scr. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Alert', 'Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2592.png', 'ScreenshotCaption': 'Alert for sdelete'}], 'Footnotes': ['Exiting event details shows correlation of detections.', 'Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2532.png', 'ScreenshotCaption': 'deletion of 3aka3'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated due to sdelete64.exe deleting rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1545.png', 'ScreenshotCaption': 'cod.3aka.scr deleted'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1548.png', 'ScreenshotCaption': 'cod.3aka3.scr deleted'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery was generated containing evidence of sdelete64.exe deleting rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-402.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (1 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-403.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (2 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-404.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (3 of 3)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-391.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating process sdelete64.exe with commandline arguments to delete C:\\Users\\pam\\Desktop\\rcs.3aka3.doc.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting ?cod.3aka.scr.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13211.png', 'ScreenshotCaption': '4.B.2, 4.B.3, 4.B.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2835.png', 'ScreenshotCaption': 'Telemetry showing file rename operations associated with sdelete64 on cod.3aka3.scr.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "File Deletion" was generated for sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-81.png', 'ScreenshotCaption': 'all the file deletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "SDelete64 Usage" was generated due to Sdelete64.exe deleting rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7221.png', 'ScreenshotCaption': '4.b.2 - ?codeaka3.scr alert details sdelete, full process ovreview event (retest)'}, {'ScreenshotName': 'SecureWorks-APT29-7222.png', 'ScreenshotCaption': '4.b.2 - ?codeaka3.scr alert details sdelete, full process tree (retest)'}, {'ScreenshotName': 'SecureWorks-APT29-7220.png', 'ScreenshotCaption': '4.b.2 - ?codeaka3.scr alert details sdelete, technique mappings (retest)'}, {'ScreenshotName': 'SecureWorks-APT29-7218.png', 'ScreenshotCaption': '4.b.2 - ?codeaka3.scr alert details sdelete (retest)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1107" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12814.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt3'}, {'ScreenshotName': 'SentinelOne-APT29-12813.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt2'}, {'ScreenshotName': 'SentinelOne-APT29-12812.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.  The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6527.png', 'ScreenshotCaption': 'B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip'}, {'ScreenshotName': 'SentinelOne-APT29-6528.png', 'ScreenshotCaption': 'B2/3/4 - Deleting files (sdelete.exe writing over path names)'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Defense Evasion" was generated when sdelete64.exe with command-line arguments was used to delete rcs.3aka3.doc.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7428.png', 'ScreenshotCaption': 'Sdelete execution for all files'}, {'ScreenshotName': 'Symantec-APT29-7427.png', 'ScreenshotCaption': 'Sdelete execution for the doc file'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Deletion" occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12912.png', 'ScreenshotCaption': 'MSSP Day 1: File Deletion name'}, {'ScreenshotName': 'Symantec-APT29-12913.png', 'ScreenshotCaption': 'MSSP Day 1: File Deletion description'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7427.png', 'ScreenshotCaption': 'Sdelete execution for the doc file'}, {'ScreenshotName': 'Symantec-APT29-9921.png', 'ScreenshotCaption': 'File deletion events for zip files and pupy payload'}, {'ScreenshotName': 'Symantec-APT29-7428.png', 'ScreenshotCaption': 'Sdelete execution for all files'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "File Deletion" (medium severity) was generated due to sdelete64.exe deleting rcs.3aka3.doc. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11879.png', 'ScreenshotCaption': 'delete for b2'}, {'ScreenshotName': 'TrendMicro-APT29-11886.png', 'ScreenshotCaption': 'process tree view - doc'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14014.png', 'ScreenshotCaption': 'B.2 - related objects Delete action'}, {'ScreenshotName': 'TrendMicro-APT29-11886.png', 'ScreenshotCaption': 'process tree view - doc'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "File Deletion - sdelete execution" was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3915.png', 'ScreenshotCaption': 'accepteula for .doc and other'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3915.png', 'ScreenshotCaption': 'accepteula for .doc and other'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3903.png', 'ScreenshotCaption': '3 sdeletes'}, {'ScreenshotName': 'Carbon Black-APT29-13940.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '4.B.3', 'Procedure': 'Deleted Draft.zip on disk using SDelete', 'Criteria': 'sdelete64.exe deleting the file draft.zip', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-686.png', 'ScreenshotCaption': 'delete .zip'}, {'ScreenshotName': 'Bitdefender-APT29-707.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for user execution of Draft.zip.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10296.png', 'ScreenshotCaption': 'Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated due to sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14996.png', 'ScreenshotCaption': '4b3 new vendor screenshot correlated'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9601.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - filenames from path'}, {'ScreenshotName': 'Cybereason-APT29-9603.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - sdelete deleting files'}, {'ScreenshotName': 'Cybereason-APT29-9602.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - sdelete 64 process tree'}, {'ScreenshotName': 'Cybereason-APT29-9605.png', 'ScreenshotCaption': '4.b.2 / 3 /4 - sdelete deleting the files'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Sdelete Usage" was generated due to sdelete64.exe deleting Draft.Zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11906.png', 'ScreenshotCaption': 'B4 - medium alert for sdelete usage'}, {'ScreenshotName': 'Cylance-APT29-11911.png', 'ScreenshotCaption': 'B3 - Deletion of draft.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Evading Detection" occurred containing evidence of sdelete64.exe deleting files.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12899.png', 'ScreenshotCaption': 'MSSP - sdelete usage'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12241.png', 'ScreenshotCaption': 'B3 - path stomping for roaming/draft.zip'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1226.png', 'ScreenshotCaption': 'draft.zip file deletion'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for file deletion (medium severity) was generated due to sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert for PowerShell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10607.png', 'ScreenshotCaption': 'rdr sysinternals.zip and draft.zip'}, {'ScreenshotName': 'F-Secure-APT29-10059.png', 'ScreenshotCaption': 'the next one for sdelte.command line cut it off'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11277.png', 'ScreenshotCaption': 'MSSP - all 3 sdeletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe deleting Draft.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10057.png', 'ScreenshotCaption': 'sdelete doing its thing'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sdelete Command Execution" was generated due to the execution of sdelete64.exe to delete Draft.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10995.png', 'ScreenshotCaption': '4.B.3 - Sdelete Command Execution on Draft.zip'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10991.png', 'ScreenshotCaption': '4.B.3 -  PowerShell Child Process for sdelete64.exe on Draft.zip (bottom)'}, {'ScreenshotName': 'FireEye-APT29-10988.png', 'ScreenshotCaption': '4.B - PowerShell Child Process of sdelete64.exe (top)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for the execution of a Sysinternals utility.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10985.png', 'ScreenshotCaption': '4.B.3 - Sysinternals Utility Execution for Draft.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12990.png', 'ScreenshotCaption': 'MSSP - 4.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11009.png', 'ScreenshotCaption': '4.B.3 - Alphabetic rollovers from SDelete of Draft.zip'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated due to the use of SDelete to delete rcs.3aka3.doc.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10893.png', 'ScreenshotCaption': 'draft.zip sdelete process create  event (4.b3) (100 impact score)'}, {'ScreenshotName': 'GoSecure-APT29-10892.png', 'ScreenshotCaption': '3 sdelete file deletions. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10893.png', 'ScreenshotCaption': 'draft.zip sdelete process create  event (4.b3) (100 impact score)'}, {'ScreenshotName': 'GoSecure-APT29-10892.png', 'ScreenshotCaption': '3 sdelete file deletions. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "SDelete usage by Process Monitor"  was generated due to sdelete64.exe process creation used to delete Draft.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3522.png', 'ScreenshotCaption': '4.B.3 - sdelete64.exe deleting Draft.zip'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of sdelete64.exe deleting Draft.Zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17994.png', 'ScreenshotCaption': 'new mssp 4b2-4 (file deletes)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2755.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for File Deletion was generated due to sdelete.exe deleting Draft.Zip. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2592.png', 'ScreenshotCaption': 'Alert for sdelete'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.', 'Exiting event details shows correlation of detections.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2530.png', 'ScreenshotCaption': 'deletion of roaming 2 (4b3)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated due to sdelete64.exe deleting Draft.Zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1544.png', 'ScreenshotCaption': 'draft.zip deleted'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1547.png', 'ScreenshotCaption': 'draft.zip deleted'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery was generated containing evidence of sdelete64.exe deleting Draft.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-402.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (1 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-403.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (2 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-404.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (3 of 3)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-392.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating process sdelete64.exe with commandline agruments to delete C:\\Users\\pam\\AppData\\Roaming\\Draft.Zip.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13211.png', 'ScreenshotCaption': '4.B.2, 4.B.3, 4.B.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2830.png', 'ScreenshotCaption': 'Telemetry showing execution of sdelete64.exe to delete the file draft.zip.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2831.png', 'ScreenshotCaption': 'Telemetry showing file rename operations associated with sdelete64 on draft.zip.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "File Deletion" was generated for sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process. ', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-81.png', 'ScreenshotCaption': 'all the file deletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "SDelete64 Usage" was generated due to Sdelete64.exe deleting Draft.Zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7227.png', 'ScreenshotCaption': '4.b.3 - sdlet64 usage alert details draft.zip, full process tree (retest)'}, {'ScreenshotName': 'SecureWorks-APT29-7226.png', 'ScreenshotCaption': '4.b.3 - sdlet64 usage alert details draft.zip, full process overview (retest)'}, {'ScreenshotName': 'SecureWorks-APT29-7223.png', 'ScreenshotCaption': '4.b.3 - sdlet64 usage alert details draft.zip (retest)'}, {'ScreenshotName': 'SecureWorks-APT29-7225.png', 'ScreenshotCaption': '4.b.3 - sdlet64 usage alert details draft.zip, technique mappings (retest)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1107" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12812.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt1'}, {'ScreenshotName': 'SentinelOne-APT29-12814.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt3'}, {'ScreenshotName': 'SentinelOne-APT29-12813.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6527.png', 'ScreenshotCaption': 'B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip'}, {'ScreenshotName': 'SentinelOne-APT29-6528.png', 'ScreenshotCaption': 'B2/3/4 - Deleting files (sdelete.exe writing over path names)'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Defense Evasion" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\Draft.Zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7428.png', 'ScreenshotCaption': 'Sdelete execution for all files'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Deletion" occurred containing evidence of sdelete64.exe deleting Draft.Zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12912.png', 'ScreenshotCaption': 'MSSP Day 1: File Deletion name'}, {'ScreenshotName': 'Symantec-APT29-12913.png', 'ScreenshotCaption': 'MSSP Day 1: File Deletion description'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7428.png', 'ScreenshotCaption': 'Sdelete execution for all files'}, {'ScreenshotName': 'Symantec-APT29-9921.png', 'ScreenshotCaption': 'File deletion events for zip files and pupy payload'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "File Deletion" (medium severity) was generated due to sdelete64.exe deleting Draft.zip. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11882.png', 'ScreenshotCaption': 'draft delete'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.Zip. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11885.png', 'ScreenshotCaption': 'process tree view - draft'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "File Deletion - sdelete execution"  was generated due to Sdelete64.exe deleting Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3911.png', 'ScreenshotCaption': 'sdelete alerts on right'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3911.png', 'ScreenshotCaption': 'sdelete alerts on right'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13941.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-3903.png', 'ScreenshotCaption': '3 sdeletes'}], 'Footnotes': []}]}]}]}, {'Substep': '4.B.4', 'Procedure': 'Deleted SysinternalsSuite.zip on disk using SDelete', 'Criteria': 'sdelete64.exe deleting the file SysinternalsSuite.zip', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-687.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-708.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file rename and delete operations from sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert for user execution of SysinternalsSuite.zip.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10296.png', 'ScreenshotCaption': 'Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) was generated due to sdelete64.exe deleting  SysinternalsSuite.zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14994.png', 'ScreenshotCaption': '4b4 vendor added screenshot correlated'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Deletion" was received that included a PowerShell script and explained that it was used to execute sdelete64.exe to delete SysInternalsSuite.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12440.png', 'ScreenshotCaption': '4.B.4 - MDR Report Day 1, Sdelete of SysInternalsSuite'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9601.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - filenames from path'}, {'ScreenshotName': 'Cybereason-APT29-9603.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - sdelete deleting files'}, {'ScreenshotName': 'Cybereason-APT29-9602.png', 'ScreenshotCaption': '4.b.2 / 3 / 4 - sdelete 64 process tree'}, {'ScreenshotName': 'Cybereason-APT29-9605.png', 'ScreenshotCaption': '4.b.2 / 3 /4 - sdelete deleting the files'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Sdelete Usage" was generated due to sdelete64.exe deleting SysinternalsSuite.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11908.png', 'ScreenshotCaption': 'B4 - Deletion of sysinterals.zip'}, {'ScreenshotName': 'Cylance-APT29-11906.png', 'ScreenshotCaption': 'B4 - medium alert for sdelete usage'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Evading Detection" occurred containing evidence of sdelete64.exe deleting files.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12899.png', 'ScreenshotCaption': 'MSSP - sdelete usage'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12242.png', 'ScreenshotCaption': 'B4 - path stomping for sysinternalssuite.zip'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1228.png', 'ScreenshotCaption': 'delete of sysinternals'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for file deletion  was generated due to sdelete64.exe deleting SysinternalsSuite.zip. This was correlated to a previous detection for PowerShell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10607.png', 'ScreenshotCaption': 'rdr sysinternals.zip and draft.zip'}, {'ScreenshotName': 'F-Secure-APT29-10059.png', 'ScreenshotCaption': 'the next one for sdelte.command line cut it off'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11277.png', 'ScreenshotCaption': 'MSSP - all 3 sdeletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe deleting SysinternalsSuite.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10057.png', 'ScreenshotCaption': 'sdelete doing its thing'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sdelete Command Execution" was generated due to the execution of sdelete64.exe to delete SysinternalsSuite.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10996.png', 'ScreenshotCaption': '4.B.4 - Sdelete Command Execution on SysinternalsSuite.zip'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10990.png', 'ScreenshotCaption': '4.B.4 - PowerShell Child Process for sdelete64.exe on SysinternalsSuite.zip (bottom)'}, {'ScreenshotName': 'FireEye-APT29-10988.png', 'ScreenshotCaption': '4.B - PowerShell Child Process of sdelete64.exe (top)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for the execution of a Sysinternals utility.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-10982.png', 'ScreenshotCaption': '4.B.4 - Sysinternals Utility Execution for SysinternalsSuite.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12990.png', 'ScreenshotCaption': 'MSSP - 4.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11007.png', 'ScreenshotCaption': '4.B.4 - Alphabetic rollovers from SDelete of SysinternalsSuite.zip'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated due to the use of SDelete to delete SysinternalsSuite.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10894.png', 'ScreenshotCaption': 'sysinternalssuite.zip sdelete process create event. 100 impact score)'}, {'ScreenshotName': 'GoSecure-APT29-10892.png', 'ScreenshotCaption': '3 sdelete file deletions. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The event was correlated to a parent detection on "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10892.png', 'ScreenshotCaption': '3 sdelete file deletions. '}, {'ScreenshotName': 'GoSecure-APT29-10894.png', 'ScreenshotCaption': 'sysinternalssuite.zip sdelete process create event. 100 impact score)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "SDelete usage by Process Monitor" was generated due to sdelete64.exe process creation used to delete SysinternalsSuite.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3521.png', 'ScreenshotCaption': '4.B.4 - sdelete64.exe deleting SysinternalsSuite.zip'}, {'ScreenshotName': 'HanSight-APT29-3521.png', 'ScreenshotCaption': '4.B.4 - sdelete64.exe deleting SysinternalsSuite.zip'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of sdelete64.exe deleting SysinternalsSuite.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17994.png', 'ScreenshotCaption': 'new mssp 4b2-4 (file deletes)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2758.png', 'ScreenshotCaption': '4.b.4 - sysinternalssuite.zip deleted'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for File Deletion  was generated due to sdelete.exe deleting SysinternalsSuite.zip. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2592.png', 'ScreenshotCaption': 'Alert for sdelete'}], 'Footnotes': ['Exiting event details shows correlation of detections.', 'Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file . The detection was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2534.png', 'ScreenshotCaption': 'deletion of sysinternals'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated due to sdelete64.exe deleting SysinterlsSuite.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1539.png', 'ScreenshotCaption': 'sysinternalssuite.zip deleted'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1549.png', 'ScreenshotCaption': 'sysinternalssuite.zip deleted'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery was generated containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-403.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (2 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-404.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (3 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-402.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (1 of 3)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-393.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating process sdelete64.exe with commandline arguments to delete C:\\Users\\pam\\Downloads\\SysinternalSuite.zip.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13211.png', 'ScreenshotCaption': '4.B.2, 4.B.3, 4.B.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2829.png', 'ScreenshotCaption': 'Telemetry showing execution of sdelete64.exe to delete the file SysinternalsSuite.zip'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "File Deletion" was generated for sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-81.png', 'ScreenshotCaption': 'all the file deletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "SDelete64 Usage" was generated due to Sdelete64.exe deleting SysinternalsSuite.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6604.png', 'ScreenshotCaption': '4.b.4 technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-6606.png', 'ScreenshotCaption': 'process tree 4.b.4'}, {'ScreenshotName': 'SecureWorks-APT29-6605.png', 'ScreenshotCaption': '4.b.4 process'}, {'ScreenshotName': 'SecureWorks-APT29-6603.png', 'ScreenshotCaption': '4.b.4 alert details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1107" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12813.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt2'}, {'ScreenshotName': 'SentinelOne-APT29-12812.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt1'}, {'ScreenshotName': 'SentinelOne-APT29-12814.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - File delete info pt3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6528.png', 'ScreenshotCaption': 'B2/3/4 - Deleting files (sdelete.exe writing over path names)'}, {'ScreenshotName': 'SentinelOne-APT29-6527.png', 'ScreenshotCaption': 'B2/3/4 - powershell procesess executing sdelete64.exe deleting 3aka3, draft.zip, and SysinternalsSuite.zip'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Defense Evasion" was generated when sdelete64.exe with command-line arguments was used to delete SysinternalsSuite.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7428.png', 'ScreenshotCaption': 'Sdelete execution for all files'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Deletion" occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12912.png', 'ScreenshotCaption': 'MSSP Day 1: File Deletion name'}, {'ScreenshotName': 'Symantec-APT29-12913.png', 'ScreenshotCaption': 'MSSP Day 1: File Deletion description'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7428.png', 'ScreenshotCaption': 'Sdelete execution for all files'}, {'ScreenshotName': 'Symantec-APT29-9921.png', 'ScreenshotCaption': 'File deletion events for zip files and pupy payload'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "File Deletion" (medium severity) was generated due to sdelete64.exe deleting SysinternalsSuite.zip. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11881.png', 'ScreenshotCaption': 'sysinternals delete - use this'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with commTelemetry showed sdelete.exe running with command-line arguments to delete the file. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11883.png', 'ScreenshotCaption': 'process tree view - sysinternals'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "File Deletion - sdelete execution" was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3914.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3914.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for the of SysinternalsSuite.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12754.png', 'ScreenshotCaption': '4.b.4 mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13942.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-3903.png', 'ScreenshotCaption': '3 sdeletes'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.1', 'Procedure': "Enumerated user's temporary directory path using PowerShell", 'Criteria': 'powershell.exe executing\xa0$env:TEMP', 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10305.png', 'ScreenshotCaption': 'Telemetry showing the invoke-discovery script block contents.'}, {'ScreenshotName': 'CrowdStrike-APT29-10306.png', 'ScreenshotCaption': 'Telemetry showing invoke-discovery function executing.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File and Directory Discovery" was received that included a PowerShell script and explained that it was used to obtain the current directory.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12466.png', 'ScreenshotCaption': '4.C.1-8 - MDR Report Day 1, Invoke-Discovery'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Environment Enumeration" occurred containing evidence of "Invoke-Discovery" function definition using $env:TEMP.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12900.png', 'ScreenshotCaption': 'MSSP - Invoke-Discovery SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:TEMP.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11917.png', 'ScreenshotCaption': 'C1-8 - Powershell SBL - SecSoftwareEnum high alert'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:TEMP. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1229.png', 'ScreenshotCaption': '4c1-3 script block'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:TEMP.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10062.png', 'ScreenshotCaption': 'invoke-discovery'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing: $env:TEMP.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12991.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:TEMP.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11015.png', 'ScreenshotCaption': '4.C.1 - Script block for $env:TEMP'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17389.png', 'ScreenshotCaption': 'showing the internal ps1 function of invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:TEMP.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}, {'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1957.png', 'ScreenshotCaption': '4.c.7 av product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:TEMP. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-581.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13646.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13645.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:TEMP.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - File and Directory Discovery" occurred containing evidence of powershell.exe executing: $env:TEMP.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13736.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe executing: $env:TEMP.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}, {'ScreenshotName': 'SecureWorks-APT29-6628.png', 'ScreenshotCaption': 'event details overview - function executed - invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for "basic discovery" containing evidence of $env:TEMP usage.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12815.png', 'ScreenshotCaption': 'MSSP - C1-5 - readme.ps1'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "File and Directory Discovery" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the TempDirectory.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}, {'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}, {'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions. Details showing a PowerShell command containing $env:TEMP were verified.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3935.png', 'ScreenshotCaption': 'invoke discovery better view'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.2', 'Procedure': 'Enumerated the current username using PowerShell', 'Criteria': 'powershell.exe executing $env:USERNAME', 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10305.png', 'ScreenshotCaption': 'Telemetry showing the invoke-discovery script block contents.'}, {'ScreenshotName': 'CrowdStrike-APT29-10306.png', 'ScreenshotCaption': 'Telemetry showing invoke-discovery function executing.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Owner/User Discovery" was received that included a PowerShell script and explained that it was used to obtain the current user name.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12466.png', 'ScreenshotCaption': '4.C.1-8 - MDR Report Day 1, Invoke-Discovery'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - System Owner/User Discovery" occurred containing evidence of PowerShell executing: $env:USERNAME.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10799.png', 'ScreenshotCaption': 'MSSP - c2 invoke discovery Username'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Environment Enumeration" occurred containing evidence of "Invoke-Discovery" function definition using $env:USERNAME.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12900.png', 'ScreenshotCaption': 'MSSP - Invoke-Discovery SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11917.png', 'ScreenshotCaption': 'C1-8 - Powershell SBL - SecSoftwareEnum high alert'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERNAME. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1229.png', 'ScreenshotCaption': '4c1-3 script block'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10062.png', 'ScreenshotCaption': 'invoke-discovery'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing: $env:USERNAME.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12991.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:USERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11016.png', 'ScreenshotCaption': '4.C.2 - Script block for $env:USERNAME'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17389.png', 'ScreenshotCaption': 'showing the internal ps1 function of invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}, {'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1957.png', 'ScreenshotCaption': '4.c.7 av product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:USERNAME. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-581.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13646.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13645.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:USERNAME. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - System Owner/User Discovery" occurred containing evidence of powershell.exe executing: $env:USERNAME.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13736.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe executing: $env:USERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6628.png', 'ScreenshotCaption': 'event details overview - function executed - invoke discovery'}, {'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "basic discovery" containing evidence of $env:USERNAME usage.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12815.png', 'ScreenshotCaption': 'MSSP - C1-5 - readme.ps1'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "System Owner/User Discovery" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the User Name.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}, {'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions. Details showing a PowerShell command containing $env:USERNAME were verified.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3935.png', 'ScreenshotCaption': 'invoke discovery better view'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.3', 'Procedure': 'Enumerated the computer hostname using PowerShell', 'Criteria': 'powershell.exe executing $env:COMPUTERNAME', 'Techniques': [{'TechniqueId': 'T1082', 'TechniqueName': 'System Information Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10306.png', 'ScreenshotCaption': 'Telemetry showing invoke-discovery function executing.'}, {'ScreenshotName': 'CrowdStrike-APT29-10305.png', 'ScreenshotCaption': 'Telemetry showing the invoke-discovery script block contents.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Information Discovery" was received that included a PowerShell script and explained that it was used to obtain the current computer name.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12466.png', 'ScreenshotCaption': '4.C.1-8 - MDR Report Day 1, Invoke-Discovery'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Environment Enumeration" occurred containing evidence of "Invoke-Discovery" function definition using $env:COMPUTERNAME.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12900.png', 'ScreenshotCaption': 'MSSP - Invoke-Discovery SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:COMPUTERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11917.png', 'ScreenshotCaption': 'C1-8 - Powershell SBL - SecSoftwareEnum high alert'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:COMPUTERNAME. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1229.png', 'ScreenshotCaption': '4c1-3 script block'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:COMPUTERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10062.png', 'ScreenshotCaption': 'invoke-discovery'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing: $env:COMPUTERNAME.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12991.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:COMPUTERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11017.png', 'ScreenshotCaption': '4.C.3 - Script block for $env:COMPUTERNAME'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17389.png', 'ScreenshotCaption': 'showing the internal ps1 function of invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:COMPUTERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}, {'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1957.png', 'ScreenshotCaption': '4.c.7 av product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:COMPUTERNAME. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-581.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13646.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13645.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:COMPUTERNAME.\n\n', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - System Information Discovery" occurred containing evidence of powershell.exe executing: $env:COMPUTERNAME.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13736.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe executing: $env:COMPUTERNAME.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}, {'ScreenshotName': 'SecureWorks-APT29-6628.png', 'ScreenshotCaption': 'event details overview - function executed - invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "basic discovery" containing evidence of $env:COMPUTERNAME usage.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12815.png', 'ScreenshotCaption': 'MSSP - C1-5 - readme.ps1'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "System Information Discovery" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the Computer Name.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}, {'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3935.png', 'ScreenshotCaption': 'invoke discovery better view'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.4', 'Procedure': 'Enumerated the current domain name using PowerShell', 'Criteria': 'powershell.exe executing $env:USERDOMAIN', 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10306.png', 'ScreenshotCaption': 'Telemetry showing invoke-discovery function executing.'}, {'ScreenshotName': 'CrowdStrike-APT29-10305.png', 'ScreenshotCaption': 'Telemetry showing the invoke-discovery script block contents.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Owner/User Discovery" was received that included a PowerShell script and explained that it was used to obtain the current environment information.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12466.png', 'ScreenshotCaption': '4.C.1-8 - MDR Report Day 1, Invoke-Discovery'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Environment Enumeration" occurred containing evidence of "Invoke-Discovery" function definition using $env:USERDOMAIN.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12900.png', 'ScreenshotCaption': 'MSSP - Invoke-Discovery SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERDOMAIN.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11917.png', 'ScreenshotCaption': 'C1-8 - Powershell SBL - SecSoftwareEnum high alert'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERDOMAIN. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1230.png', 'ScreenshotCaption': '4c4-6 script block event (same as above)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERDOMAIN.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10062.png', 'ScreenshotCaption': 'invoke-discovery'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing: $env:USERDOMAIN.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12991.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:USERDOMAIN.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11018.png', 'ScreenshotCaption': '4.C.4 - Script block for $env:USERDOMAIN'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17389.png', 'ScreenshotCaption': 'showing the internal ps1 function of invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERDOMAIN.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}, {'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1957.png', 'ScreenshotCaption': '4.c.7 av product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:USERDOMAIN. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-581.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}, {'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13645.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13646.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $env:USERDOMAIN. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - System System Network Configuration Discovery" occurred containing evidence of powershell.exe executing: $env:USERDOMAIN.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13736.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe executing: $env:USERDOMAIN.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}, {'ScreenshotName': 'SecureWorks-APT29-6628.png', 'ScreenshotCaption': 'event details overview - function executed - invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "basic discovery" containing evidence of $env:USERDOMAIN usage.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12815.png', 'ScreenshotCaption': 'MSSP - C1-5 - readme.ps1'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected the user's domain name.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}, {'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}, {'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3935.png', 'ScreenshotCaption': 'invoke discovery better view'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.5', 'Procedure': 'Enumerated the current process ID using PowerShell', 'Criteria': 'powershell.exe executing $PID', 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10305.png', 'ScreenshotCaption': 'Telemetry showing the invoke-discovery script block contents.'}, {'ScreenshotName': 'CrowdStrike-APT29-10306.png', 'ScreenshotCaption': 'Telemetry showing invoke-discovery function executing.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" was received that included a PowerShell script and explained that it was used to obtain the current environment information.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12466.png', 'ScreenshotCaption': '4.C.1-8 - MDR Report Day 1, Invoke-Discovery'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Environment Enumeration" occurred containing evidence of "Invoke-Discovery" function definition using $PID.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12900.png', 'ScreenshotCaption': 'MSSP - Invoke-Discovery SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $PID.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11917.png', 'ScreenshotCaption': 'C1-8 - Powershell SBL - SecSoftwareEnum high alert'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $PID. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1230.png', 'ScreenshotCaption': '4c4-6 script block event (same as above)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $PID.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10062.png', 'ScreenshotCaption': 'invoke-discovery'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing: $PID.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12991.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $PID.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11019.png', 'ScreenshotCaption': '4.C.5 - Script block for $PID'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17389.png', 'ScreenshotCaption': 'showing the internal ps1 function of invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $PID.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}, {'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1957.png', 'ScreenshotCaption': '4.c.7 av product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $PID. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-581.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13646.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13645.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $PID. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - Process Discovery" occurred containing evidence of powershell.exe executing: $env:PID.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13736.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe executing: $env:PID.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6628.png', 'ScreenshotCaption': 'event details overview - function executed - invoke discovery'}, {'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ProcessEnumeration" was generated when PowerShell accessed $PID. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6536.png', 'ScreenshotCaption': 'C5 - Shows general discovery, no mention of environment variable.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "basic discovery" containing evidence of $PID usage.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12815.png', 'ScreenshotCaption': 'MSSP - C1-5 - readme.ps1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: $PID.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected the current PID.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}, {'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3935.png', 'ScreenshotCaption': 'invoke discovery better view'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.6', 'Procedure': 'Enumerated the OS version using PowerShell', 'Criteria': 'powershell.exe executing\u200b Gwmi Win32_OperatingSystem', 'Techniques': [{'TechniqueId': 'T1082', 'TechniqueName': 'System Information Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10306.png', 'ScreenshotCaption': 'Telemetry showing invoke-discovery function executing.'}, {'ScreenshotName': 'CrowdStrike-APT29-10305.png', 'ScreenshotCaption': 'Telemetry showing the invoke-discovery script block contents.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Information Discovery" was received that included a PowerShell script and explained that it was used to obtain the OS system information.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12466.png', 'ScreenshotCaption': '4.C.1-8 - MDR Report Day 1, Invoke-Discovery'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Environment Enumeration" occurred containing evidence of "Invoke-Discovery" function definition using Gwmi Win32_OperatingSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12900.png', 'ScreenshotCaption': 'MSSP - Invoke-Discovery SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11917.png', 'ScreenshotCaption': 'C1-8 - Powershell SBL - SecSoftwareEnum high alert'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Reconnaissance of Multiple WMI Classes" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1237.png', 'ScreenshotCaption': 'detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $Gwmi Win32_OperatingSystem. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1234.png', 'ScreenshotCaption': 'os wmi event'}, {'ScreenshotName': 'Elastic-APT29-1230.png', 'ScreenshotCaption': '4c4-6 script block event (same as above)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "wmi-enumerating-os" was generated due to a WMI query for OS version.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17678.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Gwmi Win32_OperatingSystem', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10061.png', 'ScreenshotCaption': 'wmi stuff (thp firewall, antivirus, os)'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12992.png', 'ScreenshotCaption': 'MSSP - 4.C'}, {'ScreenshotName': 'FireEye-APT29-12991.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11021.png', 'ScreenshotCaption': '4.C.6 - Script block for Gwmi Win32_OperatingSystem'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17389.png', 'ScreenshotCaption': 'showing the internal ps1 function of invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Get System Information" was generated due to a suspicious process querying a WMI object.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}, {'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}, {'ScreenshotName': 'HanSight-APT29-3536.png', 'ScreenshotCaption': '4.C - Alert content for getting system information by querying WMI object'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}, {'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1957.png', 'ScreenshotCaption': '4.c.7 av product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-582.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13212.png', 'ScreenshotCaption': '4.C.6, 4.C.7, 4.C.8, 4.C.9, 4.C.10, 4.C.11 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2870.png', 'ScreenshotCaption': 'Telemetry showing the import of readme.ps1.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2838.png', 'ScreenshotCaption': 'Telemetry shows Powershell.exe executing Invoke-Discovery, Invoke-NetUserGetLocalGroups and Invoke-NetUserGetGroups.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing\u200b Gwmi Win32_OperatingSystem. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) for System Information Discovery was generated for Powershell.exe executing Gwmi Win32_OperatingSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13737.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - System Information Discovery" occurred containing evidence of powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13736.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13738.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Local Environment Information Discovery" specific to WMI was generated when PowerShell executed the suspicious WMI query containing Win32_OperatingSystem. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6535.png', 'ScreenshotCaption': 'C6 - Local environment discovery via Win32_OperatingSystem discovery\n'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "use of Gwmi" occurred containing evidence of WMI query containing Win32_OperatingSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12816.png', 'ScreenshotCaption': 'MSSP - C6 - Gwmi Win32_OperatingSystem\u200b'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing\u200b Gwmi Win32_OperatingSystem.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11876.png', 'ScreenshotCaption': 'c6/7/8 - Os, antivirus, firewall'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3935.png', 'ScreenshotCaption': 'invoke discovery better view'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.7', 'Procedure': 'Enumerated anti-virus software using PowerShell', 'Criteria': 'powershell.exe\xa0executing\u200b Get-WmiObject ...\u200b -Class\xa0AntiVirusProduct', 'Techniques': [{'TechniqueId': 'T1063', 'TechniqueName': 'Security Software Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection (yellow indicator) was generated for Windows Management Instrumentation being used for AV discovery. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1121.png', 'ScreenshotCaption': 'config change'}, {'ScreenshotName': 'Bitdefender-APT29-1124.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.', 'Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10305.png', 'ScreenshotCaption': 'Telemetry showing the invoke-discovery script block contents.'}, {'ScreenshotName': 'CrowdStrike-APT29-10306.png', 'ScreenshotCaption': 'Telemetry showing invoke-discovery function executing.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Security Software Discovery" was received that included a PowerShell script and explained that it was used to detect the installed anti-virus product.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12466.png', 'ScreenshotCaption': '4.C.1-8 - MDR Report Day 1, Invoke-Discovery'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Security Software Discovery occurred containing evidence of powershell executing Get-WmiObject and -Class AntiVirusProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10786.png', 'ScreenshotCaption': 'MSSP - invoke-discovery (firewall, antivirus)'}, {'ScreenshotName': 'Cybereason-APT29-10790.png', 'ScreenshotCaption': 'MSSP - c7 - antivirus'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_SecSoftwareEnum_Powershell_MITRETT1063" was generated when powershell.exe called Get-WMIObject with AntiVirusProduct. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11917.png', 'ScreenshotCaption': 'C1-8 - Powershell SBL - SecSoftwareEnum high alert'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Win_WMI_SecProduct_Enum_NonSYS_MITRET1063" was generated when a WMI query targeted AntiVirusProduct.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11916.png', 'ScreenshotCaption': 'C7 - WMI alert for get anti-virus product'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Environment Enumeration" occurred containing evidence of "Invoke-Discovery" function definition using Get-WMIObject with AntiVirusProduct. An alert for "Win_SecSoftwareEnum_Powershell_MITRETT1063" was shown.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12900.png', 'ScreenshotCaption': 'MSSP - Invoke-Discovery SBL'}, {'ScreenshotName': 'Cylance-APT29-12901.png', 'ScreenshotCaption': 'MSSP - Alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $Gwmi WmiObject ...\u200b -Class AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Reconnaissance of Multiple WMI Classes" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1237.png', 'ScreenshotCaption': 'detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $Gwmi WmiObject ...\u200b -Class AntiVirusProduct. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1233.png', 'ScreenshotCaption': 'antivirus wmi event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection labeled wmi-enumeration-av was generated due to a WMI query for AntivirusProduct.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10081.png', 'ScreenshotCaption': 'wmi stuff, wmi enum'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17355.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12991.png', 'ScreenshotCaption': 'MSSP - 4.C'}, {'ScreenshotName': 'FireEye-APT29-12992.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11025.png', 'ScreenshotCaption': '4.C.7 - Script block for Get-WmiObject ...\u200b -Class AntiVirusProduct'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17389.png', 'ScreenshotCaption': 'showing the internal ps1 function of invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}, {'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1957.png', 'ScreenshotCaption': '4.c.7 av product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-582.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}, {'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) was generated for PowerShell performing suspicious Security Software Discovery.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13648.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13649.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13212.png', 'ScreenshotCaption': '4.C.6, 4.C.7, 4.C.8, 4.C.9, 4.C.10, 4.C.11 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2858.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe executing Get-WMIObject.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2868.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe getting an event log for the AntiVirusProduct query.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell executing Get-WmiObject  ...\u200b -Class AntiVirusProduct.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - Security Software Discovery" occurred containing evidence of powershell.exe Get-WmiObject ...\u200b -Class AntiVirusProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13736.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13738.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Security Software Discovery" specific to WMI was generated when PowerShell executed the suspicious WMI query containing AntiVirusProduct.  The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6532.png', 'ScreenshotCaption': 'C7 - Security software using suspicious wmi query - Antivirus product'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "use of Gwmi" occurred containing evidence of WMI query containing AntiVirusProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12817.png', 'ScreenshotCaption': 'MSSP - C7/8 - Gwmi AntiVirus and Firewall queries.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected information about installed antivirus and firewall products.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}, {'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11876.png', 'ScreenshotCaption': 'c6/7/8 - Os, antivirus, firewall'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3935.png', 'ScreenshotCaption': 'invoke discovery better view'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.8', 'Procedure': 'Enumerated firewall software using PowerShell', 'Criteria': 'powershell.exe\xa0executing Get-WmiObject\xa0...\u200b\u200b -Class\xa0FireWallProduct', 'Techniques': [{'TechniqueId': 'T1063', 'TechniqueName': 'Security Software Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "GenericSoftwareSystemDiscovery" was generated when WMI was used to query information about firewall products. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-15008.png', 'ScreenshotCaption': '4c8 - new vendor screenshot'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class FireWallProduct. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10306.png', 'ScreenshotCaption': 'Telemetry showing invoke-discovery function executing.'}, {'ScreenshotName': 'CrowdStrike-APT29-10305.png', 'ScreenshotCaption': 'Telemetry showing the invoke-discovery script block contents.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Security Software Discovery" was received that included a PowerShell script and explained that it was used to detect the installed firewall product.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12466.png', 'ScreenshotCaption': '4.C.1-8 - MDR Report Day 1, Invoke-Discovery'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Enumeration Invoke-Discovery" occurred containing evidence of powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10786.png', 'ScreenshotCaption': 'MSSP - invoke-discovery (firewall, antivirus)'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Environment Enumeration" occurred containing evidence of "Invoke-Discovery" function definition using Get-WmiObject targeting FireWallProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12900.png', 'ScreenshotCaption': 'MSSP - Invoke-Discovery SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-WmiObject targeting FireWallProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11917.png', 'ScreenshotCaption': 'C1-8 - Powershell SBL - SecSoftwareEnum high alert'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Reconnaissance of Multiple WMI Classes" was generated due to multiple WMI classes being executed in quick succession. The event was correlated to a parent General detection for malicious file execution. The detection was a medium severity alert.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1237.png', 'ScreenshotCaption': 'detected discovery alert based on recon of multiple wmi classes. x number of classes called over a period of time. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing $Gwmi WmiObject ...\u200b -Class FireWallProduct. The event was correlated to a parent General detection for malicious file execution.\t', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1235.png', 'ScreenshotCaption': 'firewall wmi event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for WMI being used to query information about firewall products.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17358.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17360.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12992.png', 'ScreenshotCaption': 'MSSP - 4.C'}, {'ScreenshotName': 'FireEye-APT29-12991.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11023.png', 'ScreenshotCaption': '4.C.8 - Script block for Get-WmiObject ...\u200b\u200b -Class FireWallProduct'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17389.png', 'ScreenshotCaption': 'showing the internal ps1 function of invoke discovery'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Get-WmiObject ... -Class FireWallProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}, {'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1958.png', 'ScreenshotCaption': '4.c.8 fw product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class FireWallProduct. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-582.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}, {'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13212.png', 'ScreenshotCaption': '4.C.6, 4.C.7, 4.C.8, 4.C.9, 4.C.10, 4.C.11 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class FireWallProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2869.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe getting an event log for the FireWallProduct query. '}, {'ScreenshotName': 'Palo Alto Networks-APT29-2858.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe executing Get-WMIObject.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell executing Get-WmiObject ...\u200b\u200b -Class FireWallProduct. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - Security Software Discovery" occurred containing evidence of powershell.exe Get-WmiObject ...\u200b\u200b -Class FireWallProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13736.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-WmiObject ...\u200b\u200b -Class FireWallProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13739.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Security Software Discovery" specific to WMI was generated when PowerShell executed the suspicious WMI query containing FireWallProduct. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6533.png', 'ScreenshotCaption': 'C8 - using suspicious wmi query - Firewall product'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "use of Gwmi" occurred containing evidence of WMI query containing FireWallProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12817.png', 'ScreenshotCaption': 'MSSP - C7/8 - Gwmi AntiVirus and Firewall queries.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected information about installed antivirus and firewall products.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}, {'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12676.png', 'ScreenshotCaption': 'MSSP - 3C1 - 4A1 - 4A3 - 4B1 - 4B2/3/4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11876.png', 'ScreenshotCaption': 'c6/7/8 - Os, antivirus, firewall'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3935.png', 'ScreenshotCaption': 'invoke discovery better view'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.9', 'Procedure': "Enumerated user's domain group membership via the NetUserGetGroups API", 'Criteria': 'powershell.exe\xa0executing the NetUserGetGroups\xa0API', 'Techniques': [{'TechniqueId': 'T1069', 'TechniqueName': 'Permission Groups Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10313.png', 'ScreenshotCaption': 'Telemetry showing the  invoke-netusergetgroups script block contents.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Permission Groups Discovery" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetGroups command to search for domain groups through Win32 API calls.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12465.png', 'ScreenshotCaption': '4.C.9 - MDR Report Day 1, Invoke-NetUserGetGroups'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Enumeration Invoke-Discovery" occurred containing evidence of the NetUserGetGroups API call.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10786.png', 'ScreenshotCaption': 'MSSP - invoke-discovery (firewall, antivirus)'}, {'ScreenshotName': 'Cybereason-APT29-10785.png', 'ScreenshotCaption': 'MSSP - netusergetgroups (9/10)'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though host interrogation was performed to view Invoke-NetUserGetGroups definition and execution.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12244.png', 'ScreenshotCaption': 'C9 - Invoke-NetUserGetGroups function execution'}, {'ScreenshotName': 'Cylance-APT29-12275.png', 'ScreenshotCaption': 'C9/10 - Invoke-NetUserGetGroups function definition'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Invoke-NetUserGetGroups. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1231.png', 'ScreenshotCaption': '4c7-8 script block (same as above, but scrolled down the invoke discovery a little)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetGroups API call. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10064.png', 'ScreenshotCaption': 'Netapi namespace and methodname'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12992.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetGroups API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11031.png', 'ScreenshotCaption': '4.C.9 - Script block for NetUserGetGroups'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17440.png', 'ScreenshotCaption': '4c9-12  new image from feedback'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the NetUserGetGroups API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}, {'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1957.png', 'ScreenshotCaption': '4.c.7 av product'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Yttrium High Active Alert related to Discovery\non a machine in your environment" occurred containing evidence of PowerShell command Invoke-NetUserGetGroups.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1161.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (3 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1159.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (1 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1160.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (2 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1162.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (4 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing:\u200b Invoke-NetUserGetGroups. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-582.png', 'ScreenshotCaption': 'Beautified executed script block with Discovery commands'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13212.png', 'ScreenshotCaption': '4.C.6, 4.C.7, 4.C.8, 4.C.9, 4.C.10, 4.C.11 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13650.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13651.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetGroups API.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'ReaQta-APT29-258.png', 'ScreenshotCaption': 'cc - netusergroup; username - use this one'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetGroups API calls and dll loads.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6581.png', 'ScreenshotCaption': 'invoke -netusergroups content'}, {'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Permissions Groups Discovery" was received that included details about a PowerShell script used for Discovery and mentioned that it collected a list of global groups.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}, {'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing NetUserGetGroups API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11896.png', 'ScreenshotCaption': 'user group raw query view'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3942.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-3938.png', 'ScreenshotCaption': 'netapi32.dll from powershell'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.10', 'Procedure': 'Executed API call by reflectively loading Netapi32.dll', 'Criteria': 'The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll', 'Techniques': [{'TechniqueId': 'T1106', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for PowerShell loading the NetApi module. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13425.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-13424.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Netapi32.dll loaded into powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10308.png', 'ScreenshotCaption': 'Telemetry showing netapi32.dll loading into the powershell.exe process, correlated to the process tree.'}, {'ScreenshotName': 'CrowdStrike-APT29-10307.png', 'ScreenshotCaption': 'Telemetry showing netapi32.dll loading into the powershell.exe process.'}, {'ScreenshotName': 'CrowdStrike-APT29-10313.png', 'ScreenshotCaption': 'Telemetry showing the  invoke-netusergetgroups script block contents.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Permission Groups Discovery" was received that included a PowerShell script and explained that it was used to search for domain groups through Win32 API calls.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12465.png', 'ScreenshotCaption': '4.C.9 - MDR Report Day 1, Invoke-NetUserGetGroups'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Invoke-NetUserGetGroups (psreflect)" occurred containing evidence of the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10785.png', 'ScreenshotCaption': 'MSSP - netusergetgroups (9/10)'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though host interrogation was performed to view Invoke-NetUserGetGroups definition and execution.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12275.png', 'ScreenshotCaption': 'C9/10 - Invoke-NetUserGetGroups function definition'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Netapi32.dll loaded into powershell.exe.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1243.png', 'ScreenshotCaption': '4c11-12 '}, {'ScreenshotName': 'Elastic-APT29-1711.png', 'ScreenshotCaption': 'cc 4c10 config change showing the dll load library (new api monitoring) 4.c.9 not working still'}], 'Footnotes': ['Configuration changes were made to increase detection capability, specifically additional API monitoring. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetGroups API function from Netapi32.dll. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10064.png', 'ScreenshotCaption': 'Netapi namespace and methodname'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell loading Netapi32.dll.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11722.png', 'ScreenshotCaption': 'CC - 4.C.10- PowerShell loading Netapi32.dll'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12992.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11030.png', 'ScreenshotCaption': '4.C - Script block showing the load of Netapi32.dll'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17440.png', 'ScreenshotCaption': '4c9-12  new image from feedback'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-15122.png', 'ScreenshotCaption': '4C10 - vendor new pic - net APIs'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Netapi32.dll loaded into powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13990.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13651.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13650.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-258.png', 'ScreenshotCaption': 'cc - netusergroup; username - use this one'}, {'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'ReaQta-APT29-262.png', 'ScreenshotCaption': 'cc -netapi.dll; main blob with many'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetGroups API function being loaded into PowerShell from Netapi32.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6581.png', 'ScreenshotCaption': 'invoke -netusergroups content'}, {'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Delayed (Manual)', 'Host Interrogation'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3942.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-3938.png', 'ScreenshotCaption': 'netapi32.dll from powershell'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.11', 'Procedure': "Enumerated user's local group membership via\xa0the NetUserGetLocalGroups API", 'Criteria': 'powershell.exe\xa0executing the NetUserGetLocalGroups\xa0API', 'Techniques': [{'TechniqueId': 'T1069', 'TechniqueName': 'Permission Groups Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10312.png', 'ScreenshotCaption': 'Telemetry showing the  invoke-netusergetlocalgroups script block contents.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Permission Groups Discovery" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetLocalGroups command to search for local groups through Win32 API calls.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12467.png', 'ScreenshotCaption': '4.C.9 - MDR Report Day 1, Invoke-NetUserGetLocalGroups'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Invoke-NetUserGetLocalGroups (psreflect)" occurred containing evidence of the NetUserGetLocalGroups API call.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10783.png', 'ScreenshotCaption': 'MSSP - c11 - netusergetlocalgroup'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though host interrogation was performed to view Invoke-NetUserGetLocalGroups definition and execution.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12276.png', 'ScreenshotCaption': 'C11/12 - Invoke-NetUserGetLocalGroups  function definition '}, {'ScreenshotName': 'Cylance-APT29-12246.png', 'ScreenshotCaption': 'C11 - Showing existence of NetUserGetLocalGroups'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Invoke-NetUserGetLocalGroups. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1231.png', 'ScreenshotCaption': '4c7-8 script block (same as above, but scrolled down the invoke discovery a little)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetLocalGroups API call. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10064.png', 'ScreenshotCaption': 'Netapi namespace and methodname'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing the NetUserGetLocalGroups API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12992.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetLocalGroups API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11037.png', 'ScreenshotCaption': '4.C.11 - Script block for NetUserGetLocalGroups'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17440.png', 'ScreenshotCaption': '4c9-12  new image from feedback'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the NetUserGetLocalGroups API. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3532.png', 'ScreenshotCaption': '4.C - PowerShell logging for 4.C'}, {'ScreenshotName': 'HanSight-APT29-3543.png', 'ScreenshotCaption': '4.C - Execution of Invoke-Discovery'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1956.png', 'ScreenshotCaption': '4.c.11-12 detail - note timestamps off by 20 minutes? is it the import not the execution?'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery was generated containing evidence of PowerShell executing Invoke-NetUserGetLocalGroups.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1162.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (4 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1160.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (2 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1159.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (1 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1161.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery (3 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetLocalGroups API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13990.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13651.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13652.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-260.png', 'ScreenshotCaption': 'cc - netusegetlocalgroup'}, {'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetLocalGroups API calls.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6580.png', 'ScreenshotCaption': 'invoke-net usergetlocalgroups'}, {'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Permissions Groups Discovery" was received that included details about a PowerShell script used for Discovery and mentioned that it collected a list of local groups.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12919.png', 'ScreenshotCaption': 'MSSP Day 1: readme.ps1 script contents (2)'}, {'ScreenshotName': 'Symantec-APT29-12921.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12922.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Discovery execution'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing NetUserGetLocalGroups API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11896.png', 'ScreenshotCaption': 'user group raw query view'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3941.png', 'ScreenshotCaption': 'netlocalgroups'}, {'ScreenshotName': 'Carbon Black-APT29-3938.png', 'ScreenshotCaption': 'netapi32.dll from powershell'}], 'Footnotes': []}]}]}]}, {'Substep': '4.C.12', 'Procedure': 'Executed API call by reflectively loading Netapi32.dll', 'Criteria': 'The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll', 'Techniques': [{'TechniqueId': 'T1106', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for PowerShell loading the NetApi module. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated', 'Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13424.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-13425.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Netapi32.dll loaded into powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10312.png', 'ScreenshotCaption': 'Telemetry showing the  invoke-netusergetlocalgroups script block contents.'}, {'ScreenshotName': 'CrowdStrike-APT29-10308.png', 'ScreenshotCaption': 'Telemetry showing netapi32.dll loading into the powershell.exe process, correlated to the process tree.'}, {'ScreenshotName': 'CrowdStrike-APT29-10307.png', 'ScreenshotCaption': 'Telemetry showing netapi32.dll loading into the powershell.exe process.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Permission Groups Discovery" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetLocalGroups command to search for local groups through Win32 API calls.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12467.png', 'ScreenshotCaption': '4.C.9 - MDR Report Day 1, Invoke-NetUserGetLocalGroups'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Invoke-NetUserGetLocalGroups (psreflect)" occurred containing evidence of the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10783.png', 'ScreenshotCaption': 'MSSP - c11 - netusergetlocalgroup'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though host interrogation was performed to view Invoke-NetUserGetLocalGroups definition and execution.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12276.png', 'ScreenshotCaption': 'C11/12 - Invoke-NetUserGetLocalGroups  function definition '}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Netapi32.dll loaded into powershell.exe.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1243.png', 'ScreenshotCaption': '4c11-12 '}, {'ScreenshotName': 'Elastic-APT29-1711.png', 'ScreenshotCaption': 'cc 4c10 config change showing the dll load library (new api monitoring) 4.c.9 not working still'}], 'Footnotes': ['Configuration changes were made to increase detection capability, specifically additional API monitoring. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetLocalGroups API function from Netapi32.dll. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10064.png', 'ScreenshotCaption': 'Netapi namespace and methodname'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell loading Netapi32.dll.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11723.png', 'ScreenshotCaption': 'CC - 4.C.12 - PowerShell loading Netapi32.dll'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12992.png', 'ScreenshotCaption': 'MSSP - 4.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11030.png', 'ScreenshotCaption': '4.C - Script block showing the load of Netapi32.dll'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17440.png', 'ScreenshotCaption': '4c9-12  new image from feedback'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the NetUserGetGroups API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-15122.png', 'ScreenshotCaption': '4C10 - vendor new pic - net APIs'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1956.png', 'ScreenshotCaption': '4.c.11-12 detail - note timestamps off by 20 minutes? is it the import not the execution?'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13988.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-13990.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Netapi32.dll loaded into powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13651.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13652.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-260.png', 'ScreenshotCaption': 'cc - netusegetlocalgroup'}, {'ScreenshotName': 'ReaQta-APT29-13284.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'ReaQta-APT29-262.png', 'ScreenshotCaption': 'cc -netapi.dll; main blob with many'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetUserGetLocalGroups API function being loaded into PowerShell from Netapi32.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6580.png', 'ScreenshotCaption': 'invoke-net usergetlocalgroups'}, {'ScreenshotName': 'SecureWorks-APT29-6627.png', 'ScreenshotCaption': 'invoke discovery event details --  continued'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3938.png', 'ScreenshotCaption': 'netapi32.dll from powershell'}, {'ScreenshotName': 'Carbon Black-APT29-3941.png', 'ScreenshotCaption': 'netlocalgroups'}], 'Footnotes': []}]}]}]}, {'Substep': '5.A.1', 'Procedure': 'Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup', 'Criteria': 'powershell.exe creating the Javamtsup service', 'Techniques': [{'TechniqueId': 'T1050', 'TechniqueName': 'New Service', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "A New Service Has Been Created" was generated due to PowerShell creating the new service javamtsup. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1063.png', 'ScreenshotCaption': 'config change'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command used to create the new service javamtsup. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10338.png', 'ScreenshotCaption': 'Telemetry showing the invoke-persistence step 1 and step 2 scriptblock contents.'}, {'ScreenshotName': 'CrowdStrike-APT29-10337.png', 'ScreenshotCaption': 'Telemetry showing the Invoke-Persistence -PersistStep 1 script executing.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) showed a Registry event for the creation of javamtsup service.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2168.png', 'ScreenshotCaption': 'CyCarrier raw data: registry creation events related to registration of javamtsup service'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "New Service" was received that included events and analysis related to registration and execution of the javamtsup service.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12442.png', 'ScreenshotCaption': '5.A.1 - MDR Report Day 1, Service creation'}, {'ScreenshotName': 'CyCraft-APT29-12441.png', 'ScreenshotCaption': '5.A.1, 5.A.2 - MDR Report Day 1, Service execution, registry run key'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of javamtsup service. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9608.png', 'ScreenshotCaption': '5.a.1 - service details on java '}, {'ScreenshotName': 'Cybereason-APT29-9606.png', 'ScreenshotCaption': '5.a.1 - creation of javamtsup'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_Powershell_NewService_MITRET1050" was generated due to PowerShell creating the new service javamtsup. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11924.png', 'ScreenshotCaption': 'A1 - Powershell SBL with Powershell NewService high alert for new service addition '}, {'ScreenshotName': 'Cylance-APT29-11923.png', 'ScreenshotCaption': 'A1 - Powershell NewService high alert'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Persistence Mechanisms" occurred containing evidence of javamtsup service launching C:\\Windows\\System32\\javamtsup.exe and New-Service cmdlet usage.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12904.png', 'ScreenshotCaption': 'MSSP - Alert + SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "Service Creation/Modification" was generated due to powershell.exe creating the javamtsup.exe service. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1245.png', 'ScreenshotCaption': 'same pric esc alert with the file renamed event.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell created the new service javamtsup. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-15109.png', 'ScreenshotCaption': '5a1 - vendor pic for telem'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Create New Service occurred containing evidence of the javamtsup service being installed. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11279.png', 'ScreenshotCaption': 'MSSP - new service with command line args'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a registry event and service creation of javamtsup.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10073.png', 'ScreenshotCaption': 'javamtsup'}, {'ScreenshotName': 'F-Secure-APT29-10069.png', 'ScreenshotCaption': 'javamtsup service creation'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Service Persistence" was generated due to the modification of Windows service Registry keys when the javamtsup service was created.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11043.png', 'ScreenshotCaption': '5.A.1 - Service Persistence for javamtsup (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11041.png', 'ScreenshotCaption': '5.A.1 - Service Persistence for javamtsup (top)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for javamtsup.exe being classified as malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11077.png', 'ScreenshotCaption': '5.A.1 - Malware signature detection on javamtsup.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the creation of the javamtsup service.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12993.png', 'ScreenshotCaption': 'MSSP - 5.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell created the new service javamtsup.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green indicator) called New Service was generated due to the creation of the javamtsup service. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10920.png', 'ScreenshotCaption': 'registry create showing new service, labeldwith persistence and impact score of 15 -- create and overwrites'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a registry event and service creation of javamtsup.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10920.png', 'ScreenshotCaption': 'registry create showing new service, labeldwith persistence and impact score of 15 -- create and overwrites'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "New Service Creation via Snapshot" was generated due to the creation of the javamtsup service.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3546.png', 'ScreenshotCaption': '5.A.1 - New Service Creation via Snapshot alert for javamtsup'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of the javamtsup service.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17995.png', 'ScreenshotCaption': 'new mssp 5a1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a registry event for the creation of javamtsup service. The event was correlated to a parent General detection for suspicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2798.png', 'ScreenshotCaption': 'javamtsup added to registry in Services -> indicates service is created.'}, {'ScreenshotName': 'Kaspersky-APT29-2777.png', 'ScreenshotCaption': 'javamtsup.exe created - tree'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for a service "never seen in the baseline of the company."', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1609.png', 'ScreenshotCaption': 'javamtsup - service is uncommon'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of javamtsup service.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1609.png', 'ScreenshotCaption': 'javamtsup - service is uncommon'}, {'ScreenshotName': 'McAfee-APT29-1585.png', 'ScreenshotCaption': 'javamtsup service added'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Suspicious Service registration" (medium severity) was generated due to the creation of javamtsup service. This detection was correlated to a parent General detection that rcs.3aka3.doc was identified as a backdoor.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13991.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a registry event for the creation of javamtsup service.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-396.png', 'ScreenshotCaption': 'Created registry key'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell created the new service javamtsup. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13653.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13656.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13666.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13654.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13655.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed the file rename event for the service executable.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-95.png', 'ScreenshotCaption': 'file rename '}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Persistence - New Service" occurred for the creation of the javamtsup service.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13741.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13740.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13742.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the javamtsup service.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6683.png', 'ScreenshotCaption': '5.a.1 - new service creation - javamtsup'}, {'ScreenshotName': 'SecureWorks-APT29-6682.png', 'ScreenshotCaption': '5.a.1 - event details continued service execution'}, {'ScreenshotName': 'SecureWorks-APT29-6681.png', 'ScreenshotCaption': '5.a.1 -  event details - service executable'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ServiceCreate" under "Persistence {T1084}" was generated due to "javamtsup" being added to the "...\\Services" registry path. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6554.png', 'ScreenshotCaption': 'A1 - Detailed view of the new service creation, specifically shows persistence'}, {'ScreenshotName': 'SentinelOne-APT29-6556.png', 'ScreenshotCaption': 'A1 - Reg keys being created'}, {'ScreenshotName': 'SentinelOne-APT29-6555.png', 'ScreenshotCaption': 'A1 -  Reg keys being created'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell initiating a new persistence service "javamtsup". ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12818.png', 'ScreenshotCaption': 'MSSP - A1 - New-Service info pt1'}, {'ScreenshotName': 'SentinelOne-APT29-12819.png', 'ScreenshotCaption': 'MSSP - A1 - New-Service info pt2'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "New Service" was generated due to services.exe creating javamtsup. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7432.png', 'ScreenshotCaption': 'Registry creation events for javamtsup.exe tagged with New Service'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a registry event for the creation of javamtsup service.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7432.png', 'ScreenshotCaption': 'Registry creation events for javamtsup.exe tagged with New Service'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell making a new service named javamtsup. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12678.png', 'ScreenshotCaption': 'MSSP - 5A1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Registry event and service creation of javamtsup.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11898.png', 'ScreenshotCaption': 'raw query - javamtsup in registry'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though a manual query for the showed the new service and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3949.png', 'ScreenshotCaption': 'invoke-persistence - HI'}, {'ScreenshotName': 'Carbon Black-APT29-3957.png', 'ScreenshotCaption': 'javamtsup - HI - OS query'}], 'Footnotes': []}]}]}]}, {'Substep': '5.B.1', 'Procedure': 'Created a LNK file (hostui.lnk) in the Startup folder that executes on login', 'Criteria': 'powershell.exe creating the file hostui.lnk in the Startup folder', 'Techniques': [{'TechniqueId': 'T1060', 'TechniqueName': 'Registry Run Keys / Startup Folder', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called Startup Item was generated due to hostui.lnk being written to the Startup folder. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-727.png', 'ScreenshotCaption': '5b'}, {'ScreenshotName': 'Bitdefender-APT29-724.png', 'ScreenshotCaption': '5b'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-716.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10347.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating hostui.lnk in the start-up folder correlated to the process tree.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green indicator) for "Registry Run Keys / Startup Folder" was generated due to hostui.lnk being written to the Startup folder.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2232.png', 'ScreenshotCaption': 'Registry Creation event for Startup Folder persistence with enrichments.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Registry Run Keys / Startup Folder" was received that included a Registry Created event for addition of hostui.lnk to the Startup folder. Additional analysis was received that included a PowerShell script and explained that it used the Invoke-Persistence command to create a LNK file in the Startup folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12443.png', 'ScreenshotCaption': '5.B.1 - MDR Report Day 1,Startup Folder persistence.'}, {'ScreenshotName': 'CyCraft-APT29-12469.png', 'ScreenshotCaption': '5.B.1 - MDR Supplemental Report, Invoke-Persistence Startup Folder persistence.'}], 'Footnotes': ['MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity.']}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Invoke-Persistence (persistence via shortcut/run key)" occurred containing evidence of the  PowerShell creating the hostui.lnk file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10787.png', 'ScreenshotCaption': 'MSSP - javamtsup executed/created'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9610.png', 'ScreenshotCaption': '5.b.1 - powershell create the file hostui.lnk'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Win_Persist__MITRET1060" was generated due to hostui.lnk being written to the Startup folder. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11927.png', 'ScreenshotCaption': 'B1 - Additional info alert for persistence '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Persistence Mechanisms" occurred containing evidence of hostui.lnk creation in Startup folder with persistence alert.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12907.png', 'ScreenshotCaption': 'MSSP - .lnk'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ATT&CK T1060 Registry Run Keys / Startup Folder" was generated due to powershell.exe creating hostui.lnk. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1251.png', 'ScreenshotCaption': 'hostui enrichments (bottom) shows full startup path and startup folder enrichment'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) for "Shortcut File Written by Suspicious Process" was generated due to powershell.exe creating hostui.lnk. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1252.png', 'ScreenshotCaption': 'shortcut file written alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating the hostui.lnk file in the Startup folder. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1251.png', 'ScreenshotCaption': 'hostui enrichments (bottom) shows full startup path and startup folder enrichment'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated for a shortcut file (hostui.lnk) being modified. The event was correlated to a parent alert for suspicious powershell.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10618.png', 'ScreenshotCaption': 'hostui.lnk rdr'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the creation of the hostui.lnk file in the Startup folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11301.png', 'ScreenshotCaption': 'MSSP - executive overview (lots of steps alert) pt2'}, {'ScreenshotName': 'F-Secure-APT29-11280.png', 'ScreenshotCaption': 'MSSP - hostui stuff'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Startup folder registry modification for hostui.lnk.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10068.png', 'ScreenshotCaption': 'hostui.lnk'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Startup Folder Persistence" was generated due to the creation of a file in the Start Menu Startup folder.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13986.png', 'ScreenshotCaption': '5.B.1 - Startup Folder Persistence (bottom)'}, {'ScreenshotName': 'FireEye-APT29-13984.png', 'ScreenshotCaption': '5.B.1 - Startup Folder Persistence (top)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated due to a suspicious LNK file. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11056.png', 'ScreenshotCaption': '5.B.1 - Suspicious LNK File for hostui.lnk (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11054.png', 'ScreenshotCaption': '5.B.1 - Suspicious LNK File for hostui.lnk (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12994.png', 'ScreenshotCaption': 'MSSP - 5.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell creating the hostui.lnk file in the Startup folder. The event was correlated to a parent detection for PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11062.png', 'ScreenshotCaption': '5.B.1 - Triage view of the file write of hostui.lnk to the startup folder'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "Registry Run Keys or Startup Folder" was generated due to the creation of hostui.lnk in the Startup folder.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10937.png', 'ScreenshotCaption': 'hostui.lnk file create event. labeled with registry run key, persistence, impact score of 75'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of hostui.lnk in the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10937.png', 'ScreenshotCaption': 'hostui.lnk file create event. labeled with registry run key, persistence, impact score of 75'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Startup Folder Object Creation" was generated due to the file creation of hostui.lnk in the Startup folder.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3554.png', 'ScreenshotCaption': '5.B.1 - Startup Folder Object Creation alert for hostui.lnk'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-15123.png', 'ScreenshotCaption': '5B1 - new vendor pic - hostui.lnk file create'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of hostui.lnk.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17996.png', 'ScreenshotCaption': 'new mssp 5b'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating the hostui.lnk file in the Startup folder. The event was correlated to a parent General detection for suspicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2798.png', 'ScreenshotCaption': 'javamtsup added to registry in Services -> indicates service is created.'}, {'ScreenshotName': 'Kaspersky-APT29-2802.png', 'ScreenshotCaption': '5.b.1 hostui.lnk file created'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Registry Run Keys/Startup Folder was generated due to the creation of hostui.lnk in the StartUp folder. The event was correlated to a parent Technique detection for masquerading for rcs.3aka3.doc.', 'Modifiers': ['Alert', 'Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-9979.png', 'ScreenshotCaption': 'Alert view'}, {'ScreenshotName': 'MalwareBytes-APT29-2525.png', 'ScreenshotCaption': '.lnk creation (5b1)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Registry Run Keys / Startup Folder" was generated due to an application being set to run when Windows starts. \n', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-14580.png', 'ScreenshotCaption': '5b - vendor new pic - registry run key '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of hostui.lnk in the Startup folder. The event was correlated to a parent alert for a suspicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1604.png', 'ScreenshotCaption': 'hostui.lnk created'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': "A Technique alert detection (medium severity) for Registry Run Keys/Startup Folder was generated due to the file write of hostui.lnk in the Startup folder. This detection was correlated to a parent General detection of rcs.3aka3.doc being identified as 'patpoopy' backdoor.", 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-574.png', 'ScreenshotCaption': 'Detection for uncommon file was created and added to startup folder'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated for "a link file (LNK) with unusual characteristics was opened." This detection was correlated to a parent General detection that rcs.3aka3.doc was identified as a patpoopy.backdoor.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-573.png', 'ScreenshotCaption': 'Detection for link file (LNK) with unusual characteristics was opened'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Persistence was generated due to hostui.lnk being placed inside the Startup folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13992.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "registry run key or file in start up folder created - T1060" was generated due to powershell.exe creating the hostui.lnk file. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2935.png', 'ScreenshotCaption': 'start-up folder persistence in XDR'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2924.png', 'ScreenshotCaption': '2 - lnk file creation and the alerting on the t1060'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13199.png', 'ScreenshotCaption': '5.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for hostui.lnk in the Startup folder. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2933.png', 'ScreenshotCaption': 'file creation alert in XDR for the startup persistence'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-1154.png', 'ScreenshotCaption': 'powershell creating hostui.lnk'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Persistence - Registry Run Keys / Startup Folder" occurred for the creation of the hostui.lnk file in the Startup folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13741.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13742.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13740.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6677.png', 'ScreenshotCaption': '5.b.1 - shortcut info -continued, screenshot 4'}, {'ScreenshotName': 'SecureWorks-APT29-6673.png', 'ScreenshotCaption': '5.b.1 - event details - shortcut info'}, {'ScreenshotName': 'SecureWorks-APT29-6676.png', 'ScreenshotCaption': '5.b.1 - event details shortcut info - continued'}, {'ScreenshotName': 'SecureWorks-APT29-6672.png', 'ScreenshotCaption': '5.b.1 - event details - continued'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "StartupDirectory" under was generated due to the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6559.png', 'ScreenshotCaption': 'B1 - Additional indicator of persistence '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1060" occurred containing evidence of PowerShell placing LNK in startup folder, gaining persistence to launch hostui.bat.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12820.png', 'ScreenshotCaption': 'MSSP - B1 - houstui.lnk/.bat/.exe'}, {'ScreenshotName': 'SentinelOne-APT29-12821.png', 'ScreenshotCaption': 'MSSP - B1 - powershell SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of hostui.lnk in the Startup folder. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14685.png', 'ScreenshotCaption': '5.B.1 - File Creation for hostui.lnk in Startup'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Registry Run Keys / Startup Folder" was generated due to powershell.exe creating the hostui.lnk file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7433.png', 'ScreenshotCaption': 'File creation of hostui.lnk in startup folder, tagged with "Registry Run Keys / Startup Folder".'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of hostui.lnk in the Startup folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7433.png', 'ScreenshotCaption': 'File creation of hostui.lnk in startup folder, tagged with "Registry Run Keys / Startup Folder".'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Registry Run Keys / Startup Folder" was generated due to PowerShell creating the hostui.lnk file. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11900.png', 'ScreenshotCaption': 'technique for hostui.lnk'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell dropping the hostui.lnk file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12679.png', 'ScreenshotCaption': 'MSSP - 5B1 - 6A1 - 6A3 - 6B1 - 6C1 - 7A1/2/3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Persistence - PowerShell Startup Folder" was generated due to hostui.lnk being written to the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3985.png', 'ScreenshotCaption': 'powershell startup folder 5b with tids'}, {'ScreenshotName': 'Carbon Black-APT29-3984.png', 'ScreenshotCaption': 'persistence pwersehell startup folder - 5b '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3983.png', 'ScreenshotCaption': 'filemod of hostui.lnk - 5b'}], 'Footnotes': []}]}]}]}, {'Substep': '6.A.1', 'Procedure': 'Read the Chrome SQL database file to extract encrypted credentials', 'Criteria': 'accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\', 'Techniques': [{'TechniqueId': 'T1081', 'TechniqueName': 'Credentials in Files', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13426.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe reading the Chrome database file for credentials. Detection incurred a delay based on accesschk.exe executing in a malware detonation chamber where the results were later available to an analyst.', 'Modifiers': ['Delayed (Processing)'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10377.png', 'ScreenshotCaption': 'Telemetry from malware detonation chamber showing strings containing PDB pathways.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9912.png', 'ScreenshotCaption': '6.a.1 - accesschk.exe tre (cc)'}], 'Footnotes': ['A sensor policy update that enables file read event collection was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ATT&CK 1081 Credentials in Files" was generated for accesschk.exe reading the Chrome database file for credentials . The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1720.png', 'ScreenshotCaption': 'cc - new api monitoring on ntcreate file credential in files tag. (blacklist update + enrichment rule)'}], 'Footnotes': ['Configuration changes were made to increase detection capability, specifically additional API monitoring. ']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe reading the Chrome database file for credentials. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-15105.png', 'ScreenshotCaption': '6a1 - better pic - shows correlated'}], 'Footnotes': ['Configuration changes were made to increase detection capability, specifically additional API monitoring. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe copying Chrome\'s credential database file. The event was correlated to a parent detection on "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10942.png', 'ScreenshotCaption': 'crypt32.dll load on accesscheck with data encrypted (dll load) intelligence  label'}, {'ScreenshotName': 'GoSecure-APT29-11680.png', 'ScreenshotCaption': 'accesschk file copy of the passwordsdb to sysinternals (third day of testing they dont think it is any config change that caused it, but like the screenshot more) the data is specifically during retest though. no idea why that would be the case, outside of possible event loss on day 1. analyst looked at it, day 3 ended up being a trace, so additional events were collected. not sure why the trace happened on third day and not first. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Credential Access was generated containing evidence the Chrome database was read from the machine using accesschk.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17390.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Browser login data access by non-browser process" was generated when accesschk.exe accessed the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2943.png', 'ScreenshotCaption': 'Alert showing Accesschk.exe accessing browser login data.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for accesschk.exe reading the Chrome database file for credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13214.png', 'ScreenshotCaption': '6.A.1, 6.A.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2942.png', 'ScreenshotCaption': 'Telemetry showing accesscheck reading the chrome user data file.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe reading the Chrome database file for credentials. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-103.png', 'ScreenshotCaption': 'file read'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred identifying the executed accesschk.exe binary as a tool for reading the Chrome database file for credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13743.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "BrowserInfoStealing" under "Collection {T1213}" was generated when accesschk.exe read the Chrome database file for credentials. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6564.png', 'ScreenshotCaption': 'A1 - Browser info stealing via accesschk.exe '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1081" occurred containing evidence of accesschk.exe reading the Chrome database file for credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12822.png', 'ScreenshotCaption': 'MSSP - A1/3 - asscesschk.exe usage and alerts'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for accesschk.exe reading the Chrome database file for credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12679.png', 'ScreenshotCaption': 'MSSP - 5B1 - 6A1 - 6A3 - 6B1 - 6C1 - 7A1/2/3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11907.png', 'ScreenshotCaption': 'a1 - accesschk reading file - RCA'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed a file write of the passwordsdb output.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3981.png', 'ScreenshotCaption': 'file mod to passwordsdb'}], 'Footnotes': ['The vendor states that this activity would have been blocked. ']}]}]}]}, {'Substep': '6.A.2', 'Procedure': 'Executed the CryptUnprotectedData API call to decrypt Chrome passwords', 'Criteria': 'accesschk.exe executing the CryptUnprotectedData API', 'Techniques': [{'TechniqueId': 'T1003', 'TechniqueName': 'Credential Dumping', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for accesschk.exe making Windows API call: CryptUnprotectedData.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12996.png', 'ScreenshotCaption': 'MSSP - 6.A'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Credential Dumping" contained evidence of accesschk.exe dumping credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12696.png', 'ScreenshotCaption': '6.a.2 MSSP Alert #2'}, {'ScreenshotName': 'GoSecure-APT29-12695.png', 'ScreenshotCaption': '6.a.2 MSSP Alert #1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Credential Access was generated containing evidence the CryptUnprotectData API was invoked in order to perform decryption on password data.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17390.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for the execution of accesschk.exe to dump passwords.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12755.png', 'ScreenshotCaption': '6.a.2 mssp alert'}], 'Footnotes': []}]}]}]}, {'Substep': '6.A.3', 'Procedure': 'Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool', 'Criteria': 'Evidence that accesschk.exe is not the legitimate Sysinternals tool', 'Techniques': [{'TechniqueId': 'T1036', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe is not a signed Microsoft binary which can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-711.png', 'ScreenshotCaption': 'process tree'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection called "HashPupAdwareCrowdStrikeSha256" was generated when accesschk.exe matched known malicious payload hashes. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10366.png', 'ScreenshotCaption': 'Technique detection showing  showing accesschk.exe matching HashPupAdwareCrowdStrikeSha256 event.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Masquerading" was received that included an execution event for accesschk.exe and explained that the file was masquerading as a legitimate SysInternals tool. Additional data was received that included details of the file accesscheck.exe such as the hash, company name, and signer. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12444.png', 'ScreenshotCaption': '6.A.1 - MDR Report Day 1, accesschk.exe'}, {'ScreenshotName': 'CyCraft-APT29-12472.png', 'ScreenshotCaption': '6.A.3 - MDR Executive Summary, accesscheck.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for accesschk.exe being an unsigned file with a known signed version. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9615.png', 'ScreenshotCaption': 'generic alert for unsigned file with a known signed version'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe is not a signed Microsoft binary with hash value provided. This can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11929.png', 'ScreenshotCaption': 'A3 - Non signed version of accesschk.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity; red indicator) for "Malicious File" was generated for accesschk.exe execution. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1255.png', 'ScreenshotCaption': 'same  accesschk alert, but showing the hash for masquerading'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1255.png', 'ScreenshotCaption': 'same  accesschk alert, but showing the hash for masquerading'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated identifying accesschk.exe as potentially unwanted application (PUA). This indicates that the file is not the legitimate Sysinternals tool.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10077.png', 'ScreenshotCaption': 'bad bad file kibana pua for accesschk'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sysinternals Masquerade" was generated due to the process accesschk.exe executing without accepting the EULA.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11728.png', 'ScreenshotCaption': 'CC - 6.A.3 - Sysinternal Masquerade alert for accesschk.exe'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12996.png', 'ScreenshotCaption': 'MSSP - 6.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11079.png', 'ScreenshotCaption': '6.A.3 - PowerShell Child Process for accseschk.exe execution showing hash (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11067.png', 'ScreenshotCaption': '6.A.3 - PowerShell Child Process for accseschk.exe execution (top)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10956.png', 'ScreenshotCaption': 'av coverage (VT) score that shows it is suspicioous (6a3) score of 4 for  av'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hash of accesschk.exe, which can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3557.png', 'ScreenshotCaption': '6.A.3 - file hash of accesschk.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence showing accesschk.exe is not the legitimate Sysinternals tool.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17997.png', 'ScreenshotCaption': 'new mssp 6a3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2804.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hash of accesschk.exe, which can be used to verify it is not the legitimate Sysinternals tool. The event was correlated to a parent Technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2536.png', 'ScreenshotCaption': 'accesschk.exe running with hash (6a3)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for "Malicious file(s) reputation report(s)" on accesschk.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1631.png', 'ScreenshotCaption': 'investigator - with VT link'}], 'Footnotes': ['Since the investigation was manually started, delaying the detection, it is identified as Delayed (Manual). ']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-14603.png', 'ScreenshotCaption': '6a3 - vendor pic for Telem'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for accesschk.exe being detected as "Hacktool:Win32/ChromePassRecovery.A."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-405.png', 'ScreenshotCaption': 'General detection for accesschk.exe as ChromePassRecovery'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hash of accesschk.exe, which can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-405.png', 'ScreenshotCaption': 'General detection for accesschk.exe as ChromePassRecovery'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Windows process masquerading by an unsigned process" was generated when accesschk.exe was identified as an unsigned executable and the hash did not match the valid accesschk.exe hash. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2944.png', 'ScreenshotCaption': 'Alert showing Accesschk.exe is masquerading as a legitimate sysinterals tool.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13214.png', 'ScreenshotCaption': '6.A.1, 6.A.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2942.png', 'ScreenshotCaption': 'Telemetry showing accesscheck reading the chrome user data file.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-100.png', 'ScreenshotCaption': 'hash of accesschk'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Masquerading occurred containing evidence that accesschk.exe is not the legitimate Sysinternals tool.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12606.png', 'ScreenshotCaption': 'MSSP - SW - 6A3 - alert detail view'}, {'ScreenshotName': 'SecureWorks-APT29-12605.png', 'ScreenshotCaption': 'MSSP - SW - 6A - (6a3)accesschk not legit ; ignore the chrome password stuff'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that accesschk.exe is not the legitimate Sysinternals tool by comparing the hashes.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6643.png', 'ScreenshotCaption': 'process tree - 6.a.3 accessck.exe '}, {'ScreenshotName': 'SecureWorks-APT29-6642.png', 'ScreenshotCaption': '6.a.3 - process details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1036" occurred containing evidence of accesschk.exe with an MD5 value which was also found publicly and is known to be malicious.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12822.png', 'ScreenshotCaption': 'MSSP - A1/3 - asscesschk.exe usage and alerts'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe is not a signed Microsoft binary with hash value provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6562.png', 'ScreenshotCaption': 'A3 - Shows Sysinternals is not signed'}, {'ScreenshotName': 'SentinelOne-APT29-6569.png', 'ScreenshotCaption': 'Showing hash value of Sysinternals'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for "Potential risk found" on accesschk.exe receiving a reputation report that indicated it was known to be an untrusted file with the maximum suspicion rating, which indicates it is not a legitimate Sysinternals tool.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7436.png', 'ScreenshotCaption': 'Reputation request for accesschck.exe showing low reputation, indicative of not being the correct file'}, {'ScreenshotName': 'Symantec-APT29-7437.png', 'ScreenshotCaption': 'hid_level 500 showing that accesschk.exe is very suspicious. Essentially a score, which triggers can be based on.'}, {'ScreenshotName': 'Symantec-APT29-7438.png', 'ScreenshotCaption': 'context for accesschck.exe'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (suspicious severity) called "Low global prevalence without signer" was generated for accesscheck.exe, indicating it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11909.png', 'ScreenshotCaption': 'a3 - alert for not signed'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for accesschk.exe not being the legitimate Sysinternals tool due to a low census prevalence and the binary was unsigned.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12679.png', 'ScreenshotCaption': 'MSSP - 5B1 - 6A1 - 6A3 - 6B1 - 6C1 - 7A1/2/3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that accesschk.exe received a reputation report that indicated it was known to be an untrusted file with the maximum suspicion rating, which indicates it is not a legitimate Sysinternals tool. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11909.png', 'ScreenshotCaption': 'a3 - alert for not signed'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a "PUP or Potentially Unwanted Program (PUP: ChromePassRecovery)".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3976.png', 'ScreenshotCaption': '6A3 - General alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-3975.png', 'ScreenshotCaption': 'accesschk binary details, pup '}], 'Footnotes': []}]}]}]}, {'Substep': '6.B.1', 'Procedure': 'Exported a local certificate to a PFX file using PowerShell', 'Criteria': 'powershell.exe creating a certificate file exported from the system', 'Techniques': [{'TechniqueId': 'T1145', 'TechniqueName': 'Private Keys', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "privatekeyread" was generated due to the $RandomFileName.pfx file being accessed by an uncommon process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-696.png', 'ScreenshotCaption': '.pfx - correct file name - access by powershell privatekeyread'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-714.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9616.png', 'ScreenshotCaption': 'file event details with random file name from process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Win_PrivateKey_Modification_MITRET1145"  was generated when the new $RandomFileName.pfx file was created.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11935.png', 'ScreenshotCaption': 'B1 - Medium alert for private key modification as well as creation of .pfx file'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ATT&CK T1145 Private Keys" was generated for powershell.exe creating the $RandomFileName.pfx file. The event was correlated to a parent General detection for malicious file execution.\t', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1258.png', 'ScreenshotCaption': 'pfx file creation with private keys enrichment '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating the $RandomFileName.pfx file. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1260.png', 'ScreenshotCaption': 'whole message of script block for get privatekeys'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the Master File Table (MFT) was manually pulled in order to locate the written pfx private key file.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10632.png', 'ScreenshotCaption': 'grepping the table for the pfx'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Private Key - T1145" was generated due to the creation of the $RandomFileName.pfx file. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11091.png', 'ScreenshotCaption': '6.B.1 - Private Key alert with the pfx file creation'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for the creation of the $RandomFileName.pfx file. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12998.png', 'ScreenshotCaption': 'MSSP - 6.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "T1145: Private Keys" was generated due to a file create event for the $RandomFileName.pfx file by powershell.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10961.png', 'ScreenshotCaption': 'pfx file creation with impact score of 30 and intelligence of private keys t1145'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file creation event for the $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent detection on "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10961.png', 'ScreenshotCaption': 'pfx file creation with impact score of 30 and intelligence of private keys t1145'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3560.png', 'ScreenshotCaption': '6.B.1 - File created event for the .pfx file'}, {'ScreenshotName': 'HanSight-APT29-3559.png', 'ScreenshotCaption': '6.B.1 - Process path is powershell.exe for file creation of the .pfx file'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent General detection for suspicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2821.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent Technique detection for Masquerading on rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2550.png', 'ScreenshotCaption': 'creation of pfx'}], 'Footnotes': ['Exiting event details shows correlation of detections.', 'Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Private Keys" was generated due to Suspicious Indicator "A new Private Key file with pfx/p12 extension was created."', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1965.png', 'ScreenshotCaption': 'CC 6.b.1 - alert that pfx was created - new logic'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for PowerShell. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1642.png', 'ScreenshotCaption': 'pfx file created'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Credential Access was generated containing evidence the private key was exported using PowerShell to the user download folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-415.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Credential Access (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-413.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Credential Access (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-576.png', 'ScreenshotCaption': 'Telemetry showing the powershell.exe creating 0u5ouywbqqs.pfx.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "New certificate file has been created" was generated for the file creation event of the lotu40lg.b0j.pfx file.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2954.png', 'ScreenshotCaption': 'Alert showing a new certificate file has been created.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for the creation of the $RandomFileName.pfx file. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13215.png', 'ScreenshotCaption': '6.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2979.png', 'ScreenshotCaption': 'Telemetry showing the creation of a  lotu40lg.b0j.pfx file.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-109.png', 'ScreenshotCaption': 'powershell writing content ; pfx file shown'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed the execution of the PowerShell function to locate and export private keys.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13745.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13746.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6570.png', 'ScreenshotCaption': 'B1 - File creation of $RandomFileName.pfx with full path'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Private Keys" occurred containing evidence of readme.ps1 analysis indicating Get-PrivateKeys execution writing a .pfx file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17593.png', 'ScreenshotCaption': 'MSSP - 6B1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9927.png', 'ScreenshotCaption': '6B1 - powershell creating PFX file'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Private Keys"  was generated due to Export-PfxCertificate. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12330.png', 'ScreenshotCaption': 'CC - new technique mapping, but not the pfx file create - they made an alert based on Export-pfx'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the function Get-Private keys used to create $RandomFileName.pfx. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12679.png', 'ScreenshotCaption': 'MSSP - 5B1 - 6A1 - 6A3 - 6B1 - 6C1 - 7A1/2/3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12270.png', 'ScreenshotCaption': 'rca - PS > pfx'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for "PFX Extraction via PowerShell" on filemod of the $RandomFileName.pfx file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4015.png', 'ScreenshotCaption': 'pfgx extraction alert'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated for a file create event of $RandomFileName.pfx file by powershell.exe. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12756.png', 'ScreenshotCaption': '6.b.1 mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13943.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4016.png', 'ScreenshotCaption': 'filemod of pfx'}], 'Footnotes': []}]}]}]}, {'Substep': '6.C.1', 'Procedure': 'Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe', 'Criteria': 'powershell.exe injecting into lsass.exe OR lsass.exe\xa0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\', 'Techniques': [{'TechniqueId': 'T1003', 'TechniqueName': 'Credential Dumping', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for Credential Dumping was generated for injection into Lsass.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13427.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated due to process injection into lsass.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-735.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red hexagon indicator) for "Credential Dumping" was generated when powershell.exe injected into LSASS. The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10389.png', 'ScreenshotCaption': 'Telemetry showing detections associated with powershell.exe dumping credentials from LSASS.'}, {'ScreenshotName': 'CrowdStrike-APT29-10386.png', 'ScreenshotCaption': 'Technique detection showing credential dump and access alerts correlated to the initial incident.'}, {'ScreenshotName': 'CrowdStrike-APT29-10395.png', 'ScreenshotCaption': 'Technique detection logic showing powershell.exe dumping credentials.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "Credential Dumping" was generated when powershell.exe attempted to read the lsass.exe process memory. The event was correlated to a parent Technique detection for User Execution on rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2233.png', 'ScreenshotCaption': 'Threat Activity for PS dumping lsass process memory.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Credential Dumping" was received that described PowerShell dumping credentials from LSASS process memory.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12445.png', 'ScreenshotCaption': '6.C.1 - MDR Report Day 1, Credential Dumping.'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; unique symbol) called "Credential Theft" was generated due to powershell.exe injection into lsass.exe. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9619.png', 'ScreenshotCaption': 'evidence behind the process'}, {'ScreenshotName': 'Cybereason-APT29-9618.png', 'ScreenshotCaption': 'alert for powershell credential theft'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_lsass_Injection_MITRET1003" was generated when powershell.exe targeted and injected into lsass.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11937.png', 'ScreenshotCaption': 'C1 - High alert for injection into lsass.exe'}], 'Footnotes': ['According to the vendor, this  behavior would have been blocked.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe injecting a malicious payload into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12349.png', 'ScreenshotCaption': 'C1 - Event for powershell injecting into lsass'}], 'Footnotes': ['According to the vendor, this  behavior would have been blocked.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "Credential Dumping" was generated for lsass.exe memory access. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1262.png', 'ScreenshotCaption': 'cred dumping alert - shows its high'}, {'ScreenshotName': 'Elastic-APT29-1263.png', 'ScreenshotCaption': 'cred dumping alert - shows lsass.exe is the target'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "Credential Access: SAM Registry Reads" was generated for lsass.exe reading the SAM database through the registry.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1729.png', 'ScreenshotCaption': 'cc  - cred access alert (existing) fired because of fixing black list - \n alert for sam registry reads'}], 'Footnotes': ['Configuration changes were made to loosen rule logic and/or black lists.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed lsass.exe accessing the NtOpenKey API. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1729.png', 'ScreenshotCaption': 'cc  - cred access alert (existing) fired because of fixing black list - \n alert for sam registry reads'}], 'Footnotes': ['Configuration changes were made to loosen rule logic and/or black lists.']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for a possible LSASS memory dump was generated due powershell.exe opening handles to lsass.exe in a pattern that happens when a minidump of a process is generated.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10626.png', 'ScreenshotCaption': 'rdr lsass'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection in Process Guard Watcher was generated due to powershell.exe injecting into lsass.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11716.png', 'ScreenshotCaption': '6.C.1 - Shows agent ID corresponds to Nashua'}, {'ScreenshotName': 'FireEye-APT29-11715.png', 'ScreenshotCaption': '6.C.1 - Process Guard Watcher showing powershell.exe accessing lsass.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection identified PowerShell injecting into the LSASS process. This activity was labeled as credential harvesting.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-12999.png', 'ScreenshotCaption': 'MSSP - 6.C - Analysis based on Process Guard Watcher detection'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Credential Theft" was generated due to lsass.exe reading SAM Registry keys.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11695.png', 'ScreenshotCaption': 'CC - 6.c.1 - removed lsass reg read event exclusion (noisy); now see reads of registry'}], 'Footnotes': ["Lsass.exe Registry read event exclusion was removed from the configuration. The exclusion is in place because it's noisy."]}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed lsass.exe reading SAM Registry keys.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11696.png', 'ScreenshotCaption': 'CC - 6.c.1 - additional registry reads'}], 'Footnotes': ["Lsass.exe Registry read event exclusion was removed from the configuration. The exclusion is in place because it's noisy."]}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Unable to test because execution blocked by the vendor solution.']}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Credential Dumping" was generated due to Suspicious Indicator "LSASS process memory read by another process." ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1646.png', 'ScreenshotCaption': 'cred dumping'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) for "suspicious process injection was observed" was generated due to powershell.exe injecting into lsass.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13993.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry shows powershell.exe using CreateRemoteThread API call to inject into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-624.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing commands used to dump credentials.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Credentials in Registry" was generated due to a group owner child process querying the User SAM registry keys. Detection incurred a delay based on additional data processing to generate the behavioral threat.', 'Modifiers': ['Delayed (Processing)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2959.png', 'ScreenshotCaption': 'Threat overview'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2958.png', 'ScreenshotCaption': 'Credentials in Registry is marked in the technique by identifying suspicious activites that are collated together. Querying value with local RPC'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Mimikatz" was received that described PowerShell dumping credentials from LSASS process memory.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13216.png', 'ScreenshotCaption': '6.C.1 - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13214.png', 'ScreenshotCaption': '6.A.1, 6.A.3 - MSSP'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called "Cross-Process Operation" was generated due to powershell.exe injecting into lsass.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-117.png', 'ScreenshotCaption': 'cross-process operation; attack view'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Credential Dumping T1003" was generated due to powershell.exe injecting into lsass.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6639.png', 'ScreenshotCaption': 'powershell injection into lsass.exe, technique mapping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe injecting into lsass.exe', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6641.png', 'ScreenshotCaption': 'raw event with pids and process info'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "SensitiveMemoryAccess" under "Credential Access {T1003}" was generated when PowerShell read sensitive information from LSASS. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6573.png', 'ScreenshotCaption': 'C1 - Shows powershell doing sensitive memory access '}], 'Footnotes': ['This activity would have been blocked.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1003" occurred containing evidence of credential dumping as indicated by “Infostealer.”', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12823.png', 'ScreenshotCaption': 'MSSP - C1 - lsass access info'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry shows a remote process injection into lsass.exe by powershell.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17881.png', 'ScreenshotCaption': '6.C.1 - RemoteInjection into LSASS'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Credential Dumping" was generated when PowerShell attempted injection into lsass.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17862.png', 'ScreenshotCaption': '6c1 - tech alert for inject lsass'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Process Injection" was generated on "PowerShell injected into Microsoft signed process".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7446.png', 'ScreenshotCaption': 'Powershell injecting into lsass.exe tagged with Tactic and Technique.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe injecting into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7446.png', 'ScreenshotCaption': 'Powershell injecting into lsass.exe tagged with Tactic and Technique.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red \'x\' indicator; high severity) called "Credential Dumping (lsass read)" was generated due to powershell.exe calling ReadProcessMemory on lsass.exe. \n', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11918.png', 'ScreenshotCaption': 'lsass reading memory'}, {'ScreenshotName': 'TrendMicro-APT29-11919.png', 'ScreenshotCaption': 'RCA - credential dumping and process injection'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection identified PowerShell injecting into the LSASS process. This activity was labeled as Credential Dumping.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14015.png', 'ScreenshotCaption': 'MSSP - 6.C.1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe calling ReadProcessMemory on lsass.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11918.png', 'ScreenshotCaption': 'lsass reading memory'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe opening a handle to a lsass.exe thread. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4017.png', 'ScreenshotCaption': 'lsass - '}], 'Footnotes': []}]}]}]}, {'Substep': '7.A.1', 'Procedure': 'Captured and saved screenshots using PowerShell', 'Criteria': 'powershell.exe executing the CopyFromScreen function from System.Drawing.dll', 'Techniques': [{'TechniqueId': 'T1113', 'TechniqueName': 'Screen Capture', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) was generated for PowerShell being used to take a screenshot. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13429.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-13430.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.', 'Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe triggered a ScreenshotTakenETW event. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10405.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe caused a ScreenshotTakenEtw event.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for suspicious threat activity for PowerShell calling CopyFromScreen.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2137.png', 'ScreenshotCaption': 'CyCarrier raw data: Threat Activity alert for PowerShell script that ran collection. All three types'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Screen Capture" occurred containing evidence of screen capture.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12446.png', 'ScreenshotCaption': '7.A.1 - MDR Report Day 1, Screen Capture (2)'}, {'ScreenshotName': 'CyCraft-APT29-12449.png', 'ScreenshotCaption': '7.A.1 - MDR Report Day 1, Screen Capture (3)'}, {'ScreenshotName': 'CyCraft-APT29-12447.png', 'ScreenshotCaption': '7.A.1 - MDR Report Day 1, Screen Capture (1)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12249.png', 'ScreenshotCaption': 'A1 - Invoke-ScreenCapture SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "Screen Capture" was generated for powershell.exe calling the NtGdiCreateCompatibleBitmap API. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13630.png', 'ScreenshotCaption': 'CC - not new rule, just updated blacklist  to show screen cap alert enrichment is same logic (some enrichments would be tagged as alert)'}], 'Footnotes': ['Configuration changes were made to loosen rule logic and/or black lists.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14951.png', 'ScreenshotCaption': '7A1 - vendor pic for Telem '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell taking screenshots.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11283.png', 'ScreenshotCaption': 'MSSP - invoke screen capture (a1)'}, {'ScreenshotName': 'F-Secure-APT29-11301.png', 'ScreenshotCaption': 'MSSP - executive overview (lots of steps alert) pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10630.png', 'ScreenshotCaption': 'CopyFromScreen'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell System.Drawing Load" was generated due to powershell.exe loading System.Drawing.ni.dll, indicating possible Screen Capture.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11725.png', 'ScreenshotCaption': 'CC - 7.A.1 - PowerShell System.Drawing Load'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing Invoke-ScreenCapture to capture screen shots.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13000.png', 'ScreenshotCaption': 'MSSP - 7.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11113.png', 'ScreenshotCaption': '7.A.1 - Script block for CopyFromScreen'}, {'ScreenshotName': 'FireEye-APT29-11112.png', 'ScreenshotCaption': '7.A.1 - powershell.exe loading System.Drawing.ni.dll'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called Screen Capture was generated due to the load of System.Drawing.dll.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11697.png', 'ScreenshotCaption': 'CC - 7.a.1 - added change looking for the system.drawing dll; tagged with Screen Capture (DLL Load) intel; impact 0'}], 'Footnotes': ['Configuration changed to look for System.Drawing.dll loads.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe loading the System.Drawing.dll.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11697.png', 'ScreenshotCaption': 'CC - 7.a.1 - added change looking for the system.drawing dll; tagged with Screen Capture (DLL Load) intel; impact 0'}], 'Footnotes': ['Configuration changed to look for System.Drawing.dll loads.']}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3569.png', 'ScreenshotCaption': '7.A.1 - powershell.exe executing CopyFromScreen from System.Drawing.dll'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell loading .Net assemblies to capture screenshots.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17998.png', 'ScreenshotCaption': 'new mssp 7a1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['MVISION Endpoint would have blocked this activity. ']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Collection was generated containing evidence that a malicious PowerShell script was executed capturing current screen state.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-416.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-417.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13994.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Screen Capture - T1056" was generated for powershell.exe making the GdiBitBlt API call. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2967.png', 'ScreenshotCaption': 'Behavior threat alert showing screen capture from powershell.exe via API call to GDIBitBlt.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2969.png', 'ScreenshotCaption': 'Behavior threat alert showing screen capture from powershell.exe.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing performing a Screen Capture.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13217.png', 'ScreenshotCaption': '7.A.1, 7.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-265.png', 'ScreenshotCaption': 'cc - copyfromscreen'}], 'Footnotes': ["Vendor stated that more information for this behavior would be available using their NanoOS capability, which did not run under the evaluation's Hyper-Visor. ", 'PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Collection - Screen Capture"  occurred showing evidence of a PowerShell script attempting to take screenshots.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12608.png', 'ScreenshotCaption': 'MSSP - SW - 7A1 - screen capture description with event details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13747.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Screenshot" generated due to CopyFromScreen API execution. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7239.png', 'ScreenshotCaption': 'CC - A1 - Screencapture alert generated'}, {'ScreenshotName': 'SentinelOne-APT29-7238.png', 'ScreenshotCaption': 'CC - A1 - Invoke-Screencapture powershell function call'}], 'Footnotes': ['A Detection Configuration Change was made to align CopyFromScreen usage with "Screenshot".']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1113" occurred containing evidence of System.Drawing.dll being loaded and Invoke-ScreenCapture called.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12825.png', 'ScreenshotCaption': 'MSSP - A1 - SBL of invoke-screencapture'}, {'ScreenshotName': 'SentinelOne-APT29-12824.png', 'ScreenshotCaption': 'MSSP - A1 - system.drawing.dll loading'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7219.png', 'ScreenshotCaption': 'CC - A1 - CopyFromScreen in script block'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Screen Capture" was received that included details about a PowerShell script used to collect screenshots.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12931.png', 'ScreenshotCaption': 'MSSP Day 1: Screen Capture Technique'}, {'ScreenshotName': 'Symantec-APT29-12930.png', 'ScreenshotCaption': 'MSSP Day 1: psversion.ps1 script contents (2)'}, {'ScreenshotName': 'Symantec-APT29-12932.png', 'ScreenshotCaption': 'MSSP Day 1: Screen Capture description'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "PS1.ScreenCapture T1113" was generated due to CopyFromScreen API execution.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11931.png', 'ScreenshotCaption': '7.A.1 - PS1.ScreenCapture Grey Detection'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator)  called "Screen Capture using Powershell" was generated for a powershell.exe modload for gdiplus.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4004.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of PowerShell capturing screenshots.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12757.png', 'ScreenshotCaption': '7.a.1-3 mssp alert #1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4007.png', 'ScreenshotCaption': 'powershell executing, 300 seconds'}], 'Footnotes': []}]}]}]}, {'Substep': '7.A.2', 'Procedure': 'Captured clipboard contents using PowerShell', 'Criteria': 'powershell.exe executing Get-Clipboard', 'Techniques': [{'TechniqueId': 'T1115', 'TechniqueName': 'Clipboard Data', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "ClipboardAction" was generated due to a process collecting Windows clipboard data. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-732.png', 'ScreenshotCaption': 'clipboard action alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10413.png', 'ScreenshotCaption': 'Telemetry showing Get-Clipboard and Get-Keystrokes executing.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14850.png', 'ScreenshotCaption': 'Get-Clipboard with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a PowerShell script used to gather information from the clipboard.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12448.png', 'ScreenshotCaption': '7.A.2 - MDR Report Day 1, Clipboard Data'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_Clipboard_Execution_MITRET1115" was generated due to a PowerShell payload containing Get-Clipboard.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11941.png', 'ScreenshotCaption': 'A2 - High alert for Clipboard execution on powershell executing Get-Clipboard'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "ATT&CK T1115 Clipboard Data" was generated for powershell.exe calling the NtUserGetClipboardData API. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1272.png', 'ScreenshotCaption': 'clipboard collection alert and enrichment based on api call'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe calling the NtUserGetClipboardData API. The detection was correlated to a parent alert for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1272.png', 'ScreenshotCaption': 'clipboard collection alert and enrichment based on api call'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10091.png', 'ScreenshotCaption': 'get-clipboard '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing Get-Clipboard.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13000.png', 'ScreenshotCaption': 'MSSP - 7.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11103.png', 'ScreenshotCaption': '7.A.2 - Script block for Get-Clipboard'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Get-ClipboardContents" was generated due to powershell.exe executing Get-Clipboard.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4133.png', 'ScreenshotCaption': 'CC 7.A.2 - Get-ClipboardContents with ATT&CK mapping'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Collection was generated containing evidence that a malicious PowerShell script was executed capturing clipboard information.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-417.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-416.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-408.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Get-Clipboard.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "clipboard data accessed" was generated due to the use of getclipboarddata API.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2964.png', 'ScreenshotCaption': '2 - get clipboard rule '}, {'ScreenshotName': 'Palo Alto Networks-APT29-2965.png', 'ScreenshotCaption': '2 - API call for get-clipboard to get clipboard data'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13217.png', 'ScreenshotCaption': '7.A.1, 7.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-269.png', 'ScreenshotCaption': 'cc - get clipboard'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Collection - Clipboard Data" occurred containing evidence of powershell.exe executing Get-Clipboard.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12609.png', 'ScreenshotCaption': 'MSSP - SW - 7A2 - clipboard'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6667.png', 'ScreenshotCaption': '7.a.2 get-clipboard event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ClipBoardAccess" was generated due to PowerShell executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7216.png', 'ScreenshotCaption': 'CC - A2/3 - Alerts for Clipboard Access'}], 'Footnotes': ['A Detection Configuration Change was made to align Get-Clipboard cmdlet usage with "ClipBoardAccess".']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7206.png', 'ScreenshotCaption': 'CC - A2 - Powershell calling Get-Clipboard'}], 'Footnotes': ['A UX Configuration Change was made to bring Get-Clipboard usage from host logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Clipboard Data" was received for PowerShell executing "Get-Clipboard" to retrieve clipboard contents.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12933.png', 'ScreenshotCaption': 'MSSP Day 1: Clipboard Data'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection mapped to "T1115"(Clipboard Data) was generated due to powershell.exe executing Get-Clipboard.\n', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11934.png', 'ScreenshotCaption': 'console view with attack mappings'}, {'ScreenshotName': 'TrendMicro-APT29-11932.png', 'ScreenshotCaption': '2 - xml export - getClipBoard with technique'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "AMSI - Clipboard Monitoring" was generated for fileless_scriptload of Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4011.png', 'ScreenshotCaption': 'amsi clipboard monitoring alert'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12757.png', 'ScreenshotCaption': '7.a.1-3 mssp alert #1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4012.png', 'ScreenshotCaption': 'get-clipboard'}], 'Footnotes': []}]}]}]}, {'Substep': '7.A.3', 'Procedure': 'Captured user keystrokes using the GetAsyncKeyState API', 'Criteria': 'powershell.exe executing the GetAsyncKeyState API', 'Techniques': [{'TechniqueId': 'T1056', 'TechniqueName': 'Input Capture', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1125.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Input Capture" was generated when a process performed reads of the user key buffers. The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10414.png', 'ScreenshotCaption': 'Telemetry showing the GetAsyncKeyStateEtwBatch caused the technique detection.'}, {'ScreenshotName': 'CrowdStrike-APT29-10408.png', 'ScreenshotCaption': 'A Technique detection for "Input Capture" showing powershell used GetAsyncKeyState API.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10414.png', 'ScreenshotCaption': 'Telemetry showing the GetAsyncKeyStateEtwBatch caused the technique detection.'}, {'ScreenshotName': 'CrowdStrike-APT29-10413.png', 'ScreenshotCaption': 'Telemetry showing Get-Clipboard and Get-Keystrokes executing.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for Threat Activity (red indicator) was generated for PowerShell calling the GetAsyncKeyState API.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14846.png', 'ScreenshotCaption': 'CyCarrier raw data: Threat Activity alert containing powershell for collection\n'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Input Capture" occurred containing evidence of key logging.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12451.png', 'ScreenshotCaption': '7.A.3 - MDR Report Day 1, Input Capture (2)'}, {'ScreenshotName': 'CyCraft-APT29-12450.png', 'ScreenshotCaption': '7.A.3 - MDR Report Day 1, Input Capture'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12250.png', 'ScreenshotCaption': 'A3 - powershell making GetAsyncKeyState windows API call'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ATT&CK T1056 Input Capture" (low severity) was generated for powershell.exe calling the NtUserGetAsyncKeyState API. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1271.png', 'ScreenshotCaption': 'alert for keyboard, encriched with input capture based on api event '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe calling the NtUserGetAsyncKeyState. API. The event was correlated to a parent General detection for malicious file execution. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1271.png', 'ScreenshotCaption': 'alert for keyboard, encriched with input capture based on api event '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called dotnet-keylogging (medium severity) was generated for use of the GetAsyncKeyState API.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10099.png', 'ScreenshotCaption': 'get async keystate'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10093.png', 'ScreenshotCaption': '7a3'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "PowerShell Loading User32.dll" was generated due to powershell.exe loading user32.dll, indicating possible Input Capture.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11727.png', 'ScreenshotCaption': 'CC - 7.A.3 - PowerShell Loading User32.dll'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of keylogging.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13000.png', 'ScreenshotCaption': 'MSSP - 7.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11106.png', 'ScreenshotCaption': '7.A.3 - Script block for GetAsyncKeyState'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing evidence of API execution was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10981.png', 'ScreenshotCaption': 'getasynckeystate function call in the ps1 file'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Keylogger with Powershell" was generated due to PowerShell making use of GetAsyncKeyState.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3576.png', 'ScreenshotCaption': '7.A.3 - Keylogger with PowerShell alert'}, {'ScreenshotName': 'HanSight-APT29-3577.png', 'ScreenshotCaption': '7.A.3 - PowerShell making Windows API call GetAsyncKeyState'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell loading .NET assemblies to capture key strokes.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17999.png', 'ScreenshotCaption': 'new mssp 7a3'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Input Capture" was generated due to PowerShell key logging module activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1662.png', 'ScreenshotCaption': 'alert that ps is performing key logging due to ps using the native interface dll == system.drawing.ni.dll'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for Input Capture (high severity) was generated due to powershell.exe using APIs that are commonly abused by malicious applications to log keystrokes.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-406.png', 'ScreenshotCaption': 'Technique detection for possible keylogging activity'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed API calls for GetAsyncKeyState. Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Input Capture" was generated due to powershell.exe making the GetAsyncKeyState API call. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2961.png', 'ScreenshotCaption': 'Behavioral threat alert for input capture from a child process of the causality group owner.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-2963.png', 'ScreenshotCaption': 'Behavioral threat alert for the GetAsyncKeyState API call.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of key logging.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13218.png', 'ScreenshotCaption': '7.A.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-273.png', 'ScreenshotCaption': 'cc - getasynckeystate'}], 'Footnotes': ["Vendor stated that more information for this behavior would be available using their NanoOS capability, which did not run under the evaluation's Hyper-Visor. "]}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of input capture.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12610.png', 'ScreenshotCaption': 'MSSP - SW - 7A3 - input capture'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6656.png', 'ScreenshotCaption': 'raw events - function getkeystrokes'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "SuspiciousKeylogging" was generated due to GetAsyncKeyState execution. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7214.png', 'ScreenshotCaption': 'CC - A2/3 - Alerts for Suspicious keylogging and screenshots'}], 'Footnotes': ['A Detection Configuration Change was made to align GetAsyncKeyState usage with "SuspiciousKeylogging" under "Collection {T1056}".']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1056" occurred containing evidence of GetAsyncKeyState API calls and Get-Keystrokes function call.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12826.png', 'ScreenshotCaption': 'MSSP - A3 - KeyLogging alert'}, {'ScreenshotName': 'SentinelOne-APT29-12827.png', 'ScreenshotCaption': 'MSSP - A3 - SBL GetSyncState'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (UX)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7211.png', 'ScreenshotCaption': 'CC - A3 - Powershell script using the GetAsyncKeyState API call'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Input Capture" occurred containing evidence of Get-Keystrokes function execution from psversion.ps1.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17628.png', 'ScreenshotCaption': 'MSSP - get keystrokes'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection mapped to "T1056" (Input Capture) was generated due to powershell.exe executing GetAsyncKeyState. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11934.png', 'ScreenshotCaption': 'console view with attack mappings'}, {'ScreenshotName': 'TrendMicro-APT29-11933.png', 'ScreenshotCaption': '3 - xml export - getAsync'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of key logging.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12757.png', 'ScreenshotCaption': '7.a.1-3 mssp alert #1'}, {'ScreenshotName': 'Carbon Black-APT29-12758.png', 'ScreenshotCaption': '7.a.1-3 mssp alert #2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4008.png', 'ScreenshotCaption': 'GetAsyncKeyState'}], 'Footnotes': []}]}]}]}, {'Substep': '7.B.1', 'Procedure': "Read data in the user's Downloads directory using PowerShell", 'Criteria': 'powershell.exe reading files in C:\\Users\\pam\\Downloads\\', 'Techniques': [{'TechniqueId': 'T1005', 'TechniqueName': 'Data from Local System', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called PowerShell Read Document was generated for powershell.exe process reading file contents. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-745.png', 'ScreenshotCaption': 'bmp'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for User Execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10433.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe reading files from C:\\Users\\pam\\Downloads.'}, {'ScreenshotName': 'CrowdStrike-APT29-10427.png', 'ScreenshotCaption': 'Telemetry showing the Invoke-Exfil script block contents.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9966.png', 'ScreenshotCaption': ' full path sysinternalssuite.zip (cc)'}, {'ScreenshotName': 'Cybereason-APT29-9965.png', 'ScreenshotCaption': ' files from powershell sysinterals (cc) '}], 'Footnotes': ['A sensor policy update that enables file read event collection was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11698.png', 'ScreenshotCaption': 'config change they maded a change to look at files under users pam. 7b1 powershell reading the files. '}], 'Footnotes': ["Configuration changed to monitor Pam's user directory."]}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of  powershell.exe accessing files from C:\\Users\\pam\\Downloads.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13219.png', 'ScreenshotCaption': '7.B.1, 7.B.2, 7.B.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2983.png', 'ScreenshotCaption': 'Telemetry showing file read operations from the downloads folder.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-122.png', 'ScreenshotCaption': 'many file reads (but cant see the full path)'}, {'ScreenshotName': 'ReaQta-APT29-126.png', 'ScreenshotCaption': 'monkey read with full path from downlaods'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Data from Local System {T1005}" was generated due to powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14732.png', 'ScreenshotCaption': '7.B.1 - Process file reads in Downloads'}], 'Footnotes': ['A Detection Configuration Change was made to align PowerShell process file reads with Data from Local System (T1005)']}, {'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showing file reads was retrieved from the encrypted cache on the host by an analyst.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6686.png', 'ScreenshotCaption': 'B1 - Host query of to be zipped files being accessed'}], 'Footnotes': ['The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of  powershell.exe accessing files from C:\\Users\\pam\\Downloads. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12680.png', 'ScreenshotCaption': 'MSSP - 7B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe accessing files from C:\\Users\\pam\\Downloads. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11947.png', 'ScreenshotCaption': '1 - PS reading pam downloads - raw query'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '7.B.2', 'Procedure': "Compressed\xa0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", 'Criteria': 'powershell.exe creating the file OfficeSupplies.7z', 'Techniques': [{'TechniqueId': 'T1002', 'TechniqueName': 'Data Compressed', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for Data Compressed was generated due to PowerShell loading a module capable of zipping files.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1129.png', 'ScreenshotCaption': '7zip dll config change'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for OfficeSupplies.7z. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-739.png', 'ScreenshotCaption': 'officesupplies.7z'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for OfficeSupplies.7z. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10432.png', 'ScreenshotCaption': '7zip compress and file open (7zipfilewritten)'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9623.png', 'ScreenshotCaption': '7.b.2 - office supplies.7z information from events'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for OfficeSupplies.7z.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12253.png', 'ScreenshotCaption': 'B2 - File create event for OfficeSupplies.7z'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for malicious file execution.\t', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1280.png', 'ScreenshotCaption': 'file create for officesupplies.7z'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "7-Zip Archive Created" was generated due a 7-Zip file being written to disk.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11129.png', 'ScreenshotCaption': '7.B.2 - 7-Zip Archive Created for OfficeSupplies.7z'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13002.png', 'ScreenshotCaption': 'MSSP - 7.B'}, {'ScreenshotName': 'FireEye-APT29-13001.png', 'ScreenshotCaption': 'MSSP - 7.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for OfficeSupplies.7z. This detection was correlated to a parent alert on the parent PowerShell process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11138.png', 'ScreenshotCaption': '7.B.2 - Triage view for file creation of OfficeSupplies.7z'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for Data Compressed was generated due to the file creation event for OfficeSupplies.7z. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10997.png', 'ScreenshotCaption': 'file save to webdav and deleted, tagged with data exfiltration, data compressed, data encrypted'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file creation event for OfficeSupplies.7z. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10997.png', 'ScreenshotCaption': 'file save to webdav and deleted, tagged with data exfiltration, data compressed, data encrypted'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (reminder severity) called "Data Compress Extension" was generated due to creation of a compressed file.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4137.png', 'ScreenshotCaption': 'CC - 7.B.2 - Data Compress Extension alert'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18000.png', 'ScreenshotCaption': 'new mssp 7b2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for OfficeSupplies.7z. The detection was correlated to a parent alert for suspicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2861.png', 'ScreenshotCaption': '7.b.2 - officesupplies.7z file created'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for OfficeSupplies.7z. The event was correlated to a parent technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2553.png', 'ScreenshotCaption': 'Creation of 7z (7b2)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.', 'Exiting event details shows correlation of detections.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for OfficeSupplies.7z.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1690.png', 'ScreenshotCaption': 'officesupplies.7z created (followed by net connection indicating file exfil)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for OfficeSupplies.7z.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-409.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating OfficeSupplies.7z.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Scripting engine creates compressed file under suspicious location" was generated for the file creation event of a .7z file in %APPDATA%. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2976.png', 'ScreenshotCaption': 'Alert file creation of a .7z extension in %APPDATA%.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13219.png', 'ScreenshotCaption': '7.B.1, 7.B.2, 7.B.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2975.png', 'ScreenshotCaption': 'Telemetry showing OfficeSupplies.7z being written to WebDAV share.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for OfficeSupplies.7z.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-127.png', 'ScreenshotCaption': 'file write - office supplies to appdata'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "exfiltrate" occurred containing evidence of OfficeSupplies.7z being created.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12828.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6670.png', 'ScreenshotCaption': 'B2 - Powershell file creation of OfficeSupplies.7z'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Data Compressed" was generated when powershell.exe created OfficeSupplies.7z.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7447.png', 'ScreenshotCaption': 'temporary zip created, 7ZIP installation'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for "Data Compressed" containing evidence of Invoke-Exfil function using 7-zip with password "lolol" to compressed downloads directory into OfficeSupplies.7z.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17645.png', 'ScreenshotCaption': 'MSSP - data compression'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of OfficeSupplies.7z.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7447.png', 'ScreenshotCaption': 'temporary zip created, 7ZIP installation'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the OfficeSupplies.7z file create. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12680.png', 'ScreenshotCaption': 'MSSP - 7B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for OfficeSupplies.7z. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11940.png', 'ScreenshotCaption': 'raw query - file create for offic supplies'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file creation event for OfficeSupplies.7z. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4028.png', 'ScreenshotCaption': 'create of officesupplies.7z for 7b'}], 'Footnotes': []}]}]}]}, {'Substep': '7.B.3', 'Procedure': "Encrypted data from the user's Downloads directory using PowerShell", 'Criteria': 'powershell.exe executing Compress-7Zip with the password argument used for encryption', 'Techniques': [{'TechniqueId': 'T1022', 'TechniqueName': 'Data Encrypted', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent alert for User Execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10426.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Invoke-Exfil.'}, {'ScreenshotName': 'CrowdStrike-APT29-10427.png', 'ScreenshotCaption': 'Telemetry showing the Invoke-Exfil script block contents.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) was generated due to powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14984.png', 'ScreenshotCaption': '7b3 and 7b1 vendor submitted screenshot'}, {'ScreenshotName': 'CyCraft-APT29-14986.png', 'ScreenshotCaption': '7b3 new vendor screen correlation'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12202.png', 'ScreenshotCaption': 'B1/3 - powershell.exe executing Compress-7Zip shown in SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe executing Compress-7Zip ... -password "lolol". The event was correlated to a parent General detection for malicious file execution.\t', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1281.png', 'ScreenshotCaption': 'powershel cmdlet with compress-7zip (7b3)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell compressing and encrypting contents of the downloads folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11301.png', 'ScreenshotCaption': 'MSSP - executive overview (lots of steps alert) pt2'}, {'ScreenshotName': 'F-Secure-APT29-11285.png', 'ScreenshotCaption': 'MSSP - invoke exfil '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17366.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence Invoke-Exfil was used to compress and encrypt data for exfiltration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13001.png', 'ScreenshotCaption': 'MSSP - 7.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11139.png', 'ScreenshotCaption': '7.B.3 - Script block for Compress-7Zip ... lolol'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing evidence of compress-7zip execution with password was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11003.png', 'ScreenshotCaption': 'compress zip call in the ps1 file and invoke exfil function'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3595.png', 'ScreenshotCaption': '7.B - script block contains Compress-7Zip with password as well as Copy-Item to WebDAV'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2863.png', 'ScreenshotCaption': 'Pulled the powershell script off the end system'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure though script block log were manually recovered from the system, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1675.png', 'ScreenshotCaption': '7.b.3 compress with password'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-411.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Compress-7Zip (full script)'}, {'ScreenshotName': 'Microsoft-APT29-410.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Compress-7Zip (beautified)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-275.png', 'ScreenshotCaption': 'cc - compress 7zip; webdav\n'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe compressing and encrypting data for exfiltration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13748.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6741.png', 'ScreenshotCaption': 'invoke-exfil function - event details'}, {'ScreenshotName': 'SecureWorks-APT29-6740.png', 'ScreenshotCaption': ' 7.b.1 - event details invokeExfil'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Exfiltrate" occurred containing evidence of Compress-7zip compressing and encrypting the download directory with 7z using the password “lolol."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12828.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7224.png', 'ScreenshotCaption': 'CC - B3 - Alert for powershell execution showing Compress-Zip with password'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence that data was compressed and password encrypted for exfiltration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12937.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Exfil details'}, {'ScreenshotName': 'Symantec-APT29-12936.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Exfil execution'}, {'ScreenshotName': 'Symantec-APT29-12935.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Exfil'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence that the 7z file was password protected.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12680.png', 'ScreenshotCaption': 'MSSP - 7B'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4026.png', 'ScreenshotCaption': 'good screenshot of lololol'}, {'ScreenshotName': 'Carbon Black-APT29-13944.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '7.B.4', 'Procedure': 'Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell', 'Criteria': 'powershell executing Copy-Item pointing to an attack-controlled WebDav\xa0network share (192.168.0.4:80)', 'Techniques': [{'TechniqueId': 'T1048', 'TechniqueName': 'Exfiltration Over Alternative Protocol', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for a compressed file being transferred over the network.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13434.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for a network connection to remote WebDav network share.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1079.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an event for PowerShell reading OfficeSupplies.7z as well as an active connection to a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-754.png', 'ScreenshotCaption': 'webdav officesupplies netconnection '}, {'ScreenshotName': 'Bitdefender-APT29-742.png', 'ScreenshotCaption': 'officesupplies.7z'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network to a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10442.png', 'ScreenshotCaption': 'overwatch information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell Copy-Item to a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10426.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Invoke-Exfil.'}, {'ScreenshotName': 'CrowdStrike-APT29-10427.png', 'ScreenshotCaption': 'Telemetry showing the Invoke-Exfil script block contents.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated due to rundll32.exe executing the API Call DavSetCookie in daclnt.dll to map a share using WebDav.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2242.png', 'ScreenshotCaption': 'rundll mapping the webdav share'}, {'ScreenshotName': 'CyCraft-APT29-2241.png', 'ScreenshotCaption': 'webdav screenshot 7.b.4'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9623.png', 'ScreenshotCaption': '7.b.2 - office supplies.7z information from events'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (info severity) was generated for Powershell making a network connection.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11952.png', 'ScreenshotCaption': 'B4 -  Network connection from nashua to redirector over port 80'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11950.png', 'ScreenshotCaption': 'B4 - Medium alert for CopyOperation based on Copy-Item'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4). The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1282.png', 'ScreenshotCaption': 'copy item to webdav (4)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PoweShell Copy-Item to remote WebDav network share (192.168.0.4)', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11285.png', 'ScreenshotCaption': 'MSSP - invoke exfil '}, {'ScreenshotName': 'F-Secure-APT29-11301.png', 'ScreenshotCaption': 'MSSP - executive overview (lots of steps alert) pt2'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "WebDav Network Request" was generated due to a WebDav user-agent being used to PUT OfficeSupplies.7z on a WebDav network share.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11125.png', 'ScreenshotCaption': '7.B.4 - WebDav Network Request to PUT OfficeSupplies.7z'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for the file write of OfficeSupplies.7z to a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11127.png', 'ScreenshotCaption': '7.B.4 - File write of OfficeSupplies.7z to the WebDav network share '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of OfficeSupplies.7z being uploaded to 192.168.0.4 using WebDav.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13002.png', 'ScreenshotCaption': 'MSSP - 7.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-10997.png', 'ScreenshotCaption': 'file save to webdav and deleted, tagged with data exfiltration, data compressed, data encrypted'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell Copy-Item used to mount a remote WebDav network share (192.168.0.4) as well as the network share connection to 192.168.0.4:80.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3595.png', 'ScreenshotCaption': '7.B - script block contains Compress-7Zip with password as well as Copy-Item to WebDAV'}, {'ScreenshotName': 'HanSight-APT29-3582.png', 'ScreenshotCaption': '7.B.4 - powershell.exe with network connection to 192.168.0.4:80'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of OfficeSupplies.7z being uploaded to 192.168.0.4 using WebDav.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-11792.png', 'ScreenshotCaption': 'MSSP Report Page 6 - Step 7'}], 'Footnotes': []}, {'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2864.png', 'ScreenshotCaption': '7.b.3 - pwd lolol'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated due to rundll32.exe connecting to 192.168.0.4 via WebDav.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1966.png', 'ScreenshotCaption': 'CC 7.b.4  - file copy to webdav over http'}], 'Footnotes': ['The vendor added a new detection for the technique.']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-412.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe writing OfficeSupplies.7z to \\\\192.168.0.4\\webdav.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called "File being written to remote path" was generated for the file OfficeSupplies.7z being written a WebDav share at 192.168.0.4.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2977.png', 'ScreenshotCaption': 'Alert for "file written to remote path."'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network via WebDav to 192.168.0.4. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13219.png', 'ScreenshotCaption': '7.B.1, 7.B.2, 7.B.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-2975.png', 'ScreenshotCaption': 'Telemetry showing OfficeSupplies.7z being written to WebDAV share.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4) as well as the network share connection to 192.168.0.4:80.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-128.png', 'ScreenshotCaption': 'network connection - port 80'}, {'ScreenshotName': 'ReaQta-APT29-275.png', 'ScreenshotCaption': 'cc - compress 7zip; webdav\n'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Exfiltration - Exfiltration Over Alternative Protocol" occurred containing evidence of PoweShell Copy-Item to remote WebDav network share (192.168.0.4:80).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13749.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6741.png', 'ScreenshotCaption': 'invoke-exfil function - event details'}, {'ScreenshotName': 'SecureWorks-APT29-6740.png', 'ScreenshotCaption': ' 7.b.1 - event details invokeExfil'}, {'ScreenshotName': 'SecureWorks-APT29-6760.png', 'ScreenshotCaption': '7.b.4 event details C2 connection'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of exfiltration via WebDav.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12829.png', 'ScreenshotCaption': 'MSSP - B4 - wmi and network connection'}, {'ScreenshotName': 'SentinelOne-APT29-12828.png', 'ScreenshotCaption': 'MSSP - B2/3/4 - Invoke-Exfil SBL and OfficeSupplies.zip creation'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7231.png', 'ScreenshotCaption': 'CC - B4 -Powershell alert containing Copy-Item and also password used by redteam'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Exfiltration over Alternative Protocol" occurred containing evidence of exfiltration to remote WebDav network share (192.168.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12935.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Exfil'}, {'ScreenshotName': 'Symantec-APT29-12936.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Exfil execution'}, {'ScreenshotName': 'Symantec-APT29-12937.png', 'ScreenshotCaption': 'MSSP Day 1: Invoke-Exfil details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a .7z file creation to a remote file share.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17654.png', 'ScreenshotCaption': 'telem - file write of .7z to fileshare'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Suspicious Behavior" (low severity) was generated due to OfficeSupplies.7z being copied to remote WebDav network share (192.168.0.4:80).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11943.png', 'ScreenshotCaption': '4 - DDI - with user agent string '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4).', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4028.png', 'ScreenshotCaption': 'create of officesupplies.7z for 7b'}], 'Footnotes': []}]}]}]}, {'Substep': '8.A.1', 'Procedure': 'Enumerated remote systems using LDAP queries', 'Criteria': 'powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)', 'Techniques': [{'TechniqueId': 'T1018', 'TechniqueName': 'Remote System Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4).', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1081.png', 'ScreenshotCaption': 'ldap'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10454.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing network connections over port 5985 and port 389.'}, {'ScreenshotName': 'CrowdStrike-APT29-10451.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Invoke-Command and Ad-Search.  (no execution on the Scranton host yet?)'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Remote System Discovery" was received that explained that the Ad-Search PowerShell command was used to discover remote systems in the domain.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12452.png', 'ScreenshotCaption': '8.A.1 - MDR Report Day 1, Remote System Discovery'}, {'ScreenshotName': 'CyCraft-APT29-12453.png', 'ScreenshotCaption': '8.A.1 - MDR Report Day 1, Remote System Discovery (2)'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (info severity) was generated for Powershell making a network connection.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12203.png', 'ScreenshotCaption': 'A1 - Powershell connecting to 10.0.0.4 over port 389'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389.  The detection was correlated to a parent alert for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1286.png', 'ScreenshotCaption': 'port 389 - data transfer to DC ESTABLISHED CONNECTION \nshowed terminated because it had data transfer'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10107.png', 'ScreenshotCaption': 'port 389 for 10.0.0.4'}, {'ScreenshotName': 'F-Secure-APT29-10113.png', 'ScreenshotCaption': 'invoke command script block get-process'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for LDAP connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) over port 389.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11146.png', 'ScreenshotCaption': '8.A.1 - LDAP Network Connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) (top)'}, {'ScreenshotName': 'FireEye-APT29-11145.png', 'ScreenshotCaption': '8.A.1 - LDAP Network Connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell being used to enumerate Active Directory hosts.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13003.png', 'ScreenshotCaption': 'MSSP - 8.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11022.png', 'ScreenshotCaption': 'tcp connection over port 389 for ldap (8a1)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection identified as LDAP over TCP port 389 to NewYork (10.0.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3604.png', 'ScreenshotCaption': '8.A.1 - network protocol marked as ldap'}, {'ScreenshotName': 'HanSight-APT29-3602.png', 'ScreenshotCaption': '8.A.1 - powershell.exe as process path'}, {'ScreenshotName': 'HanSight-APT29-3603.png', 'ScreenshotCaption': '8.A.1 - network connection using port 389'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2875.png', 'ScreenshotCaption': '8.a.1 - connection to 10.0.0.4:389'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1714.png', 'ScreenshotCaption': 'ps 3572 parent'}, {'ScreenshotName': 'McAfee-APT29-1712.png', 'ScreenshotCaption': '8.A.1 and 8.A.2 connections to NewYork on 389 (LDAP) and  5985'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of LDAP queries from Nashua to NewYork (Domain Controller - 10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13998.png', 'ScreenshotCaption': 'MSSP 2'}, {'ScreenshotName': 'Microsoft-APT29-13997.png', 'ScreenshotCaption': 'MSSP 1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the results of the LDAP query issued by Ad-Search.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-419.png', 'ScreenshotCaption': 'Advanced hunting query interface showing specific LDAP queries'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3000.png', 'ScreenshotCaption': '1 - powershell making outbound network connection to newyork '}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-129.png', 'ScreenshotCaption': 'table view '}, {'ScreenshotName': 'ReaQta-APT29-131.png', 'ScreenshotCaption': 'see new york domain DNS request result'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - Remote System Discovery" occurred containing evidence of LDAP queries from Nashua to NewYork (Domain Controller - 10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13750.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6742.png', 'ScreenshotCaption': 'event details - adsearch computer name * 8.a.1'}, {'ScreenshotName': 'SecureWorks-APT29-6775.png', 'ScreenshotCaption': '8.a.1 timestamps network connection'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1018" occurred containing evidence of Ad-Search function definition along with LDAP network connection to NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12830.png', 'ScreenshotCaption': 'MSSP - ldap, wsman, SBL of AD-Search'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4). The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6690.png', 'ScreenshotCaption': 'A1 - Shows LDAP connection from Nashua to Scranton'}, {'ScreenshotName': 'SentinelOne-APT29-6692.png', 'ScreenshotCaption': 'A1 - Specifically identifies protocol as LDAP'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Remote System Discovery" was received that included PowerShell commands run by the adversary and an explanation of those commands.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12941.png', 'ScreenshotCaption': 'MSSP Day 1: Remote System Discovery'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9930.png', 'ScreenshotCaption': 'powershell.exe connecting to DC via LDAP. Also, registry value creation and set events for LDAP queries'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection for "Suspicious Behavior" was generated due to LDAP queries to NewYork (10.0.0.4) over port 389. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11957.png', 'ScreenshotCaption': 'a1 - DDI - LDAP queries with attack tagging'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4029.png', 'ScreenshotCaption': 'ldap connection and winrm port'}], 'Footnotes': []}]}]}]}, {'Substep': '8.A.2', 'Procedure': 'Established WinRM connection to remote host Scranton (10.0.1.4)', 'Criteria': 'Network connection to Scranton (10.0.1.4) over port 5985', 'Techniques': [{'TechniqueId': 'T1028', 'TechniqueName': 'Windows Remote Management', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}, {'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "powershellinvokedwinrm" was generated for Windows Remote Management Service Invoked by PowerShell script.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1072.png', 'ScreenshotCaption': 'powershellinvokedwinrm'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "remotepowershellsession" was generated for WSMProvHost Process Started that could indicate a remote PowerShell command has been executed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-750.png', 'ScreenshotCaption': 'powershell remote session'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-759.png', 'ScreenshotCaption': 'winrm'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connection to remote host Scranton (10.0.1.4) over port 5985. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10454.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing network connections over port 5985 and port 389.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Windows Remote Management" was generated due to the connection to remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9632.png', 'ScreenshotCaption': '8.a.2 - powershell and local address with port 5985'}, {'ScreenshotName': 'Cybereason-APT29-9633.png', 'ScreenshotCaption': '8.a.2 -  see loaded ps'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Windows Remote Management" occurred containing evidence of the connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10779.png', 'ScreenshotCaption': 'MSSP - a2, winRM'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9632.png', 'ScreenshotCaption': '8.a.2 - powershell and local address with port 5985'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Lateral Movement" occurred containing evidence of Invoke-WinRMSession with a "Win_WinRM_Invoke-Command_MITRET1028" alert.  ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12908.png', 'ScreenshotCaption': 'MSSP - alert + SBL.'}, {'ScreenshotName': 'Cylance-APT29-13186.png', 'ScreenshotCaption': 'MSSP - Lateral Movement description'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12259.png', 'ScreenshotCaption': 'A2 - Powershell encoded command connecting over the network'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator; medium severity) for "WMI Lateral Movement via PowerShell over WinRM" was generated for the user Pam invoking a WMI PowerShell cmdlet. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1293.png', 'ScreenshotCaption': 'wmi invoked on another host alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1287.png', 'ScreenshotCaption': 'port 5985 to DC'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) was generated due to PowerShell using WinRM.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10111.png', 'ScreenshotCaption': 'Invoke command username powershell'}, {'ScreenshotName': 'F-Secure-APT29-10110.png', 'ScreenshotCaption': 'using winrm detection'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Invoke-Command and connected to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10109.png', 'ScreenshotCaption': '5985 port number'}, {'ScreenshotName': 'F-Secure-APT29-10113.png', 'ScreenshotCaption': 'invoke command script block get-process'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "WinRM Network Connection" was generated due to a connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11153.png', 'ScreenshotCaption': '8.A.2 - WinRM Network Connection to Scranton (10.0.1.4)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell making a URL request, which contained indications the network connection was using WinRM.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11156.png', 'ScreenshotCaption': '8.A.2 - PowerShell URL Request containing WinRM information'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13004.png', 'ScreenshotCaption': 'MSSP - 8.A'}, {'ScreenshotName': 'FireEye-APT29-13003.png', 'ScreenshotCaption': 'MSSP - 8.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called Windows Remote Management was generated due to the connection to Scranton (10.0.1.4) over TCP port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11013.png', 'ScreenshotCaption': '5985 connection with remote share access and winRM technique labeled, 90 impact level, also tagged with lateral movement (8a2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed HTTP connections to remote host Scranton (10.0.1.4) over TCP port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11010.png', 'ScreenshotCaption': 'http requests to port 5985 -- kill this'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "WinRM Remote Execution" was generated due to the execution of wsmprovhost.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3612.png', 'ScreenshotCaption': '8.A.2 - WinRM Remote Execution alert'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; reminder severity) called "WinRM via common port" was generated due a network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3598.png', 'ScreenshotCaption': 'WinRM with port 5985'}, {'ScreenshotName': 'HanSight-APT29-3607.png', 'ScreenshotCaption': '8.A.2 - WinRM via common port alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red; high severity) was generated for "PowerShell with network activity".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2880.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2880.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Kaspersky-APT29-2880.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) on port 5985. The detection was correlated to a parent alert for PowerShell. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1718.png', 'ScreenshotCaption': '8.a.2 connection to 10.0.1.4:5985'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over TCP port 5985. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17395.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13221.png', 'ScreenshotCaption': '8.A.2, 8.A.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from a temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3001.png', 'ScreenshotCaption': '2 - outbound network connection to scranton'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-132.png', 'ScreenshotCaption': 'scranton - see attack technique uncommon port'}, {'ScreenshotName': 'ReaQta-APT29-133.png', 'ScreenshotCaption': 'win rm port 5985'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Windows Remote Management - WinRM Usage" was generated due to a connection to remote host Scranton over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6701.png', 'ScreenshotCaption': 'winrm alert details 8.a.2'}, {'ScreenshotName': 'SecureWorks-APT29-6703.png', 'ScreenshotCaption': 'process event 8.a.2'}, {'ScreenshotName': 'SecureWorks-APT29-6702.png', 'ScreenshotCaption': 'technique mapping 8.a.2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over TCP port 5985. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6902.png', 'ScreenshotCaption': '8.a.2 process info from event details'}, {'ScreenshotName': 'SecureWorks-APT29-6900.png', 'ScreenshotCaption': '8.a.2 - network connection 5985'}, {'ScreenshotName': 'SecureWorks-APT29-6904.png', 'ScreenshotCaption': '8.a.2 event details continued'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "WinRMSession" under "Lateral Movement {T1028}" was generated when a connection to remote host Scranton (10.0.1.4) from host Nashua (10.0.1.6) over port 5985 using the wsman protocol was issued.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6698.png', 'ScreenshotCaption': 'A2 -  Connection from Nashua to Scranton over port 5985'}, {'ScreenshotName': 'SentinelOne-APT29-6695.png', 'ScreenshotCaption': 'A2 - wmirm alert - Lateral movement'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1028" occurred containing evidence of Lateral Movement via WinRM with wsman network connection to host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12830.png', 'ScreenshotCaption': 'MSSP - ldap, wsman, SBL of AD-Search'}, {'ScreenshotName': 'SentinelOne-APT29-12831.png', 'ScreenshotCaption': 'MSSP - More WinRM alerts and Get-Process'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over port 5985 via HTTP.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9931.png', 'ScreenshotCaption': 'powershell.exe connected to scranton on port 5985, via service HTTP (WinRM)'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Powershell Remote Command Execution Via WinRM" was generated due to a connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11959.png', 'ScreenshotCaption': '2 - DDI - winRm tagging + network connection'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a connection to Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for "Powershell or WinRM remoting activity" based on wsmprovhost.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4040.png', 'ScreenshotCaption': 'suspicious fileless execution not originating from powershell'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "Remote powershell activity" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14749.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-14748.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "Remote Services" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4036.png', 'ScreenshotCaption': 'remote services alert'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for suspicious fileless execution not originating from PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4040.png', 'ScreenshotCaption': 'suspicious fileless execution not originating from powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4034.png', 'ScreenshotCaption': 'invoke command amsi  and then establish a connection'}], 'Footnotes': []}]}]}]}, {'Substep': '8.A.3', 'Procedure': 'Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell', 'Criteria': 'powershell.exe executing Get-Process', 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for the execution of a PowerShell process discovery command. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13435.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-13436.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1071.png', 'ScreenshotCaption': 'Get-Process'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10451.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Invoke-Command and Ad-Search.  (no execution on the Scranton host yet?)'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for "PowerShell" was generated due to powershell.exe using Invoke-Command to remotely execute Get-Process on host Scranton (10.0.1.4). The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc\u200b.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2244.png', 'ScreenshotCaption': 'Get-Process from Nashua to Scranton'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" was received that included a PowerShell script and explained that it was used to execute Get-Process on host Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12454.png', 'ScreenshotCaption': '8.A.3 - MDR Report Day 1, Process Discovery'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "Malicious Command" was generated for wsmprovhost.exe executing Get-Process.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9967.png', 'ScreenshotCaption': '8.a.3 - malicious command alert - Get-Process (cc)'}], 'Footnotes': ['A sensor policy update that enables deeper PowerShell visibility was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Win_GetSystemProcess_Powershell_MITRET1057"  was generated due to a PowerShell payload containing Get-Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11960.png', 'ScreenshotCaption': 'A3 - Nashua - Low alert for GetSystemProcess via powershell SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe executing Get-Process. The event was correlated to a parent General detection for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1291.png', 'ScreenshotCaption': 'Get-process'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell being used to get process information from the remote system Scranton.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11289.png', 'ScreenshotCaption': 'MSSP '}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10113.png', 'ScreenshotCaption': 'invoke command script block get-process'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13003.png', 'ScreenshotCaption': 'MSSP - 8.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11163.png', 'ScreenshotCaption': '8.A.3 - Script block for Get-Process'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Process Discovery via Powershell" (reminder severity) was generated due to powershell.exe executing Get-Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3616.png', 'ScreenshotCaption': '8.A.3 - Process Discovery via Powershell alert'}, {'ScreenshotName': 'HanSight-APT29-3620.png', 'ScreenshotCaption': '8.A.3 - Get-Process execution on Scranton (10.0.1.4)'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-421.png', 'ScreenshotCaption': 'Telemetry showing wsmprovhost.exe executing Get-Process'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Process Discovery with PowerShell" was generated due to powershell.exe executing Get-Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3005.png', 'ScreenshotCaption': 'Alert showing powershell process discovery on Scranton.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3004.png', 'ScreenshotCaption': 'Behavioral threat showing the script block executed on Scranton.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3003.png', 'ScreenshotCaption': 'Behavioral threat showing process discovery on Scranton (part 1).'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13221.png', 'ScreenshotCaption': '8.A.2, 8.A.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3007.png', 'ScreenshotCaption': 'Alert showing the get-process start and stop times for process discovery.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-279.png', 'ScreenshotCaption': 'cc - invoke computer name'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell cmdlet with Get-Process" occurred containing evidence of powershell.exe executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12618.png', 'ScreenshotCaption': 'MSSP - SW - 8a2-3 - invoke command, get-process - overview'}, {'ScreenshotName': 'SecureWorks-APT29-12619.png', 'ScreenshotCaption': 'MSSP - SW - 8a2-3 - event detail view'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6746.png', 'ScreenshotCaption': '8.a.3 get-process '}, {'ScreenshotName': 'SecureWorks-APT29-6747.png', 'ScreenshotCaption': 'event details 8.a.2 and 8.a.3 combined'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ProcessEnumeration" under "Discovery {T1057}" was generated due to Invoke-Command executing Get-Process. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6696.png', 'ScreenshotCaption': 'A3 - wmirm alert - Process enumeration'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "ProcessEnumeration" occurred containing evidence of WinRM alerting on Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12831.png', 'ScreenshotCaption': 'MSSP - More WinRM alerts and Get-Process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7233.png', 'ScreenshotCaption': 'CC - A3 - Powershell using Get-Process'}], 'Footnotes': ['A UX Configuration Change was made to bring Get-Process usage from host logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" was received that included PowerShell commands run by the adversary and explained that they were used to enumerate running processes on remote host Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12975.png', 'ScreenshotCaption': 'MSSP Day 1: remote process discovery'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Process Discovery" was generated due to powershell.exe executing Get-Process. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12324.png', 'ScreenshotCaption': 'CC - 3 - get-process'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11962.png', 'ScreenshotCaption': 'a3 - get process - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for Powershell or WinRM remoting activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4041.png', 'ScreenshotCaption': 'Get-Process'}], 'Footnotes': []}]}]}]}, {'Substep': '8.B.1', 'Procedure': 'Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)', 'Criteria': 'The file python.exe created on Scranton (10.0.1.4)', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a suspicious file being written/accesses through the SMB protocol. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13440.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-13439.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for Antimalware was generated identifying the resource download as malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-752.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the HTTP GET request for python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-752.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event of python.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10457.png', 'ScreenshotCaption': 'Telemetry showing a PeFileWritten and NewExecutableWritten events on Scranton for python.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) for "Remote Access" was generated for the file copy of python.exe from host Nashua (10.0.1.6) to host Scranton (10.0.1.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14872.png', 'ScreenshotCaption': 'Remotely copying Python.exe from Nashua to Scranton'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) for "File Creation" for the file create event of python.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14901.png', 'ScreenshotCaption': 'File Creation event for python.exe. Enriched as Software Packing'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event of python.exe. The detection was correlated to a parent alert for malicious PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9635.png', 'ScreenshotCaption': '8.b.1 - copies of each other ^^'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated identifying python.exe as malware. Detection incurred a delay due to file being uploaded for sandbox analysis.', 'Modifiers': ['Delayed (Processing)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11967.png', 'ScreenshotCaption': 'B1 - Python.exe scanned as malicious '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event of python.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11973.png', 'ScreenshotCaption': 'B1 - python.exe existing on Scranton'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity; red indicator) was generated for the malicious file create event of python.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1302.png', 'ScreenshotCaption': 'python.exe in temp - malicious file '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event of python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1302.png', 'ScreenshotCaption': 'python.exe in temp - malicious file '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence that python.exe was copied to remote host Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-11294.png', 'ScreenshotCaption': 'MSSP - webdav stuff'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event of python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10112.png', 'ScreenshotCaption': 'python.exe file create'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "File Write to Network Share" was generated due to a file write event for python.exe to a remote network share.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11170.png', 'ScreenshotCaption': '8.B.1 - File Write to Network Share for python.exe'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "WebDav Network Request" was generated due to a WebDav user-agent used to GET python.exe from a WebDav network share.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11169.png', 'ScreenshotCaption': '8.B.1 - WebDav Network Request to GET python.exe'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for classifying python.exe as malware, which also showed it was written by PowerShell to a remote network share.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11177.png', 'ScreenshotCaption': '8.B.1 - Malware detection for python.exe (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11178.png', 'ScreenshotCaption': '8.B.1 - Malware detection for python.exe (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection showed the file write event of python.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13006.png', 'ScreenshotCaption': 'MSSP - 8.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event of python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11172.png', 'ScreenshotCaption': '8.B.1 - Triage view of PowerShell writing python.exe over a network share'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (skull indicator) called "hiddenShare.admin" was generated due to the file creation of python.exe in an admin share.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11038.png', 'ScreenshotCaption': 'powershell writing python behavior with 60 impact score'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event of python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11038.png', 'ScreenshotCaption': 'powershell writing python behavior with 60 impact score'}, {'ScreenshotName': 'GoSecure-APT29-11035.png', 'ScreenshotCaption': 'since  network drive, see nt creating the python.exe file on scranton. show packed when in memory, so  might show then'}, {'ScreenshotName': 'GoSecure-APT29-11034.png', 'ScreenshotCaption': 'file create of python.exe w/impact of 15  caused by powershell'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event of python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3622.png', 'ScreenshotCaption': '8.B.1 - File creation event for python.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18002.png', 'ScreenshotCaption': 'new mssp 8b1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Remote File Copy was generated due to the creation of python.exe. The event was correlated to a parent Technique detection for Masquerading for rcs.3aka3.doc.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2537.png', 'ScreenshotCaption': 'file write of python'}, {'ScreenshotName': 'MalwareBytes-APT29-9980.png', 'ScreenshotCaption': 'Alert view'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event of python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1727.png', 'ScreenshotCaption': '8.b.1 - python.exe created unc to scranton - telemetry'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event of python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-13999.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called “Executable copied to remote host via $ share” was generated for python.exe being copied from Nashua to Scranton. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3008.png', 'ScreenshotCaption': 'Remote file copy alert showing the powershell.exe process that copied the file.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Remote File Copy" was generated for python.exe being copied Scranton (10.0.1.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3010.png', 'ScreenshotCaption': 'Behavioral threat alert showing remote file copy to Scranton.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13222.png', 'ScreenshotCaption': '8.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event of python.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection for "AdminShareAccess" was generated when python.exe was written from host Nashua (10.0.1.6) to the ADMIN$ share on host Scranton (10.0.1.4), indicating Lateral Movement.  The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6697.png', 'ScreenshotCaption': 'A1 extra info - Shows access to the share'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1105" occurred containing evidence of python.exe file creation. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12832.png', 'ScreenshotCaption': 'MSSP - B1 - file write of python.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event of python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6699.png', 'ScreenshotCaption': 'Unknown File creation (does show "related to threat" as false)'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Remote File Copy" was generated data being sent over SMB2 to Scranton (10.0.1.4) creating a .exe file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17664.png', 'ScreenshotCaption': '8b1 - technique remote file copy'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Malicious file detected python.exe" was generated on sandbox detection evaluation of python.exe. Detection incurred a delay based on sandbox detonation processing.', 'Modifiers': ['Delayed (Processing)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17662.png', 'ScreenshotCaption': '8b1-general delayed sandbox detonation'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (suspicious severity) was generated for the file write event of python.exe. The detection was correlated to a parent alert for a suspicious process on rcs.3aka3.doc.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11965.png', 'ScreenshotCaption': '1 - python create'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for python.exe being a potential virus or malware. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11968.png', 'ScreenshotCaption': 'virus detection on python (sig based rule)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event of python.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the filemod event for the creation of python.exe on the remote host Scranton (10.0.1.4). Telemetry also showed the file write from the local host. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4044.png', 'ScreenshotCaption': 'file write python.exe'}, {'ScreenshotName': 'Carbon Black-APT29-4042.png', 'ScreenshotCaption': 'python.exe file mod'}], 'Footnotes': []}]}]}]}, {'Substep': '8.B.2', 'Procedure': 'python.exe payload was packed with UPX', 'Criteria': 'Evidence that the file python.exe is packed', 'Techniques': [{'TechniqueId': 'T1045', 'TechniqueName': 'Software Packing', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for python.exe being identified as a packed payload. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-764.png', 'ScreenshotCaption': 'software packing'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Software Packing" was generated when python.exe was written to disk. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10468.png', 'ScreenshotCaption': 'defense evasion via software packing'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a packed executable written event for python.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10458.png', 'ScreenshotCaption': 'Telemetry showing PackedExecutableWritten on Nashua matching the PeFileWritten on Scranton.'}, {'ScreenshotName': 'CrowdStrike-APT29-10461.png', 'ScreenshotCaption': 'Telemetry showing the FileSubType_decimal is 4 (UPX) for python.exe.'}], 'Footnotes': ['A FileSubType_decimal value of 4 is a PE_PACKER_UPX reference in documentation.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "Software Packing" was generated for the file creation event for python.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14901.png', 'ScreenshotCaption': 'File Creation event for python.exe. Enriched as Software Packing'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Defense Evasion - Software Packing" showed python.exe was packed.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10780.png', 'ScreenshotCaption': 'MSSP - b2 - python is packed'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe was packed via static analysis. Detection incurred a delay due to file being uploaded for sandbox analysis.', 'Modifiers': ['Delayed (Processing)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12205.png', 'ScreenshotCaption': 'B2 - Evidence report view showing UPX packing of python.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though python.exe was manually recovered from the system by the analyst, and it was identified as UPX packed. This is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-18080.png', 'ScreenshotCaption': '8b2 rebuttal pic of hunt'}, {'ScreenshotName': 'Elastic-APT29-18081.png', 'ScreenshotCaption': '8b2-rebuttal pic details'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the analyst was able to retrieve the file, and demonstrate that it is UPX packed, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10126.png', 'ScreenshotCaption': 'UPX - downloaded file and looking at binary'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13006.png', 'ScreenshotCaption': 'MSSP - 8.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that python.exe had entropy, indicating the file was packed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11174.png', 'ScreenshotCaption': '8.B.2 - Entropy value near 1 suggests python.exe is packed'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2887.png', 'ScreenshotCaption': '8.b.2 - file hex dump shows upx (host interrogation)'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-426.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Defense Evasion (1 of 2)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Software Packing - T1045" was generated for the file creation event for python.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3013.png', 'ScreenshotCaption': '2 - pyinstaller /python packed'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3012.png', 'ScreenshotCaption': '2 - tracked object features of the object. Review file type Mz indicating a '}, {'ScreenshotName': 'Palo Alto Networks-APT29-3014.png', 'ScreenshotCaption': '2 - wildfire flagged as malware after analysis'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13223.png', 'ScreenshotCaption': '8.B.2 - MSSP'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12622.png', 'ScreenshotCaption': 'MSSP - SW - 8B2 - python upx packed '}, {'ScreenshotName': 'SecureWorks-APT29-12623.png', 'ScreenshotCaption': 'MSSP - SW - 8B2 - alert event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "UPXProcess" under "Defense Evasion {T1045}" was generated due to python.exe being packed with UPX.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6725.png', 'ScreenshotCaption': 'B2 - UPX Packing Alert'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12833.png', 'ScreenshotCaption': 'MSSP - B2 - python.exe being packed'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Software Packing" was generated when python.exe was executed by PSExec.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7457.png', 'ScreenshotCaption': 'Software packing tag for python.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry from automated file analysis showed python.exe was UPX packed. Detection incurred a delay based on additional data processing of python.exe to determine it was UPX packed.', 'Modifiers': ['Delayed (Processing)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7488.png', 'ScreenshotCaption': 'identification of python.exe as UPX packed'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12787.png', 'ScreenshotCaption': 'MSSP - 8B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe is packed. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11970.png', 'ScreenshotCaption': 'b2 - python being UPX packed'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '8.C.1', 'Procedure': 'Logged on to remote host Scranton (10.0.1.4) using\xa0valid credentials for user Pam', 'Criteria': 'Successful logon as user Pam on\xa0Scranton (10.0.1.4) ', 'Techniques': [{'TechniqueId': 'T1078', 'TechniqueName': 'Valid Accounts', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.\t', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10476.png', 'ScreenshotCaption': 'Telemetry showing valid logon on Scranton (10.0.1.4) as user Pam.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) was generated showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2253.png', 'ScreenshotCaption': 'Remote Logon from Nashua to Scranton as Pam within proper timestamp'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Valid Accounts" was received that showed execution of PSExec64.exe using Pam\'s valid credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12455.png', 'ScreenshotCaption': '8.C.1, 8.C.3 - MDR Report Day 1, PSExec64 execution'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam. The detection was correlated to a parent alert for malicious PowerShell. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9641.png', 'ScreenshotCaption': '8.c.1 - process tree for logon session'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11982.png', 'ScreenshotCaption': 'C1/3 - Logon information and psexecsvc.exe and python.exe started'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1315.png', 'ScreenshotCaption': 'admin logons - 8c1 tele'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-11295.png', 'ScreenshotCaption': 'MSSP - command line arg for lateral movement via psexec'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10125.png', 'ScreenshotCaption': '4624 logon events of pam on scranton'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the successful logon of Pam on Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13013.png', 'ScreenshotCaption': 'MSSP - 8.C'}, {'ScreenshotName': 'FireEye-APT29-13008.png', 'ScreenshotCaption': 'MSSP - 8.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an account logged on to Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11202.png', 'ScreenshotCaption': '8.C.1 - Account logged on to Scranton (10.0.1.4) as user Pam.'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of Pam successfully logging on to Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12747.png', 'ScreenshotCaption': '8.c.1 MSSP alert #1 redo'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "Logon Event Detected" was generated due to the user Pam logging on to Scranton (10.0.1.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3624.png', 'ScreenshotCaption': '8.C.1 - Pam logon to Scranton (10.0.1.4)'}, {'ScreenshotName': 'HanSight-APT29-3627.png', 'ScreenshotCaption': '8.C.1 - Logon Event Detected with Valid Accounts mapping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18003.png', 'ScreenshotCaption': 'new mssp 8C1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2891.png', 'ScreenshotCaption': 'Seeing event 4624 in windows event log'}, {'ScreenshotName': 'Kaspersky-APT29-13410.png', 'ScreenshotCaption': '8C3 - vendor provided screenshot, use this'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1731.png', 'ScreenshotCaption': '8.c.1 - pam login to scranton (device in upper left)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-629.png', 'ScreenshotCaption': 'Telemetry showing user Pam logging into Scranton.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-141.png', 'ScreenshotCaption': 'target username and ip'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13751.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection "UserLogin" under "Valid Accounts {T1078}" showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17872.png', 'ScreenshotCaption': '8.C.1 - Valid Accounts for pam login'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12942.png', 'ScreenshotCaption': 'MSSP Day 1: PSExec for lateral movement'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed PsExec64.exe executing python.exe with pam's login credentials on Scranton. A Kerberos ticket was generated on Scranton for pam.", 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17670.png', 'ScreenshotCaption': '8c1 - telemetry of pam login'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "ATT&CK T1078 Windows Logon Success" was generated due to a valid logon on Scranton (10.0.1.4) as user Pam. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11972.png', 'ScreenshotCaption': '1 - valid logon of pam - mapped to attack'}, {'ScreenshotName': 'TrendMicro-APT29-11971.png', 'ScreenshotCaption': '1 - successful logon event'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the analyst was able to query to get a list of users logged on to remote host Scranton (10.0.1.4).', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4056.png', 'ScreenshotCaption': 'pam logging in\n'}], 'Footnotes': []}]}]}]}, {'Substep': '8.C.2', 'Procedure': "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", 'Criteria': 'SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share', 'Techniques': [{'TechniqueId': 'T1077', 'TechniqueName': 'Windows Admin Shares', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for Windows Admin Shares was generated for PSExec using credentials to execute a remote command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13442.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for PsExec64.exe writing a file to a remote admin share through the SMB protocol.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-767.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Windows Admin Shares" was generated when python.exe was copied to Scranton via SMB.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10491.png', 'ScreenshotCaption': 'A Technique detection called "Windows Admin Shares" created from an executable file being written via SMB.  A technique detection called "Automated Collection" created when powershell.exe ran an automated search routine. A technique detection called "Data Compressed" created when a Rar archive was written with suspicious command line arguments.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10491.png', 'ScreenshotCaption': 'A Technique detection called "Windows Admin Shares" created from an executable file being written via SMB.  A technique detection called "Automated Collection" created when powershell.exe ran an automated search routine. A technique detection called "Data Compressed" created when a Rar archive was written with suspicious command line arguments.'}, {'ScreenshotName': 'CrowdStrike-APT29-10483.png', 'ScreenshotCaption': 'Telemetry showing connection from nashua to 10.0.1.4 over port 135.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for "Remote Accessed."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2254.png', 'ScreenshotCaption': 'PSExecSVC.exe remote access NASHUA > Scranton as Pam'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for malicious PowerShell. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9644.png', 'ScreenshotCaption': '8.c.2 - connection on port 135'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Win_NetDrive_DataInteraction_MITRET1039" was generated due to a PowerShell targeting a network drive.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11977.png', 'ScreenshotCaption': 'C2 - Medium NetDrive DataInteration powershell SBL of PsExec64'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (info severity) called "Win_Network_CommonPorts_MitreT1043" was generated due to Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11979.png', 'ScreenshotCaption': 'C2 - Network information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for malicious file execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1318.png', 'ScreenshotCaption': 'smb connection - 8c2 tactic'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10124.png', 'ScreenshotCaption': '135 port for SMB '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for network traffic from Nashua (10.0.1.6) to Scranton (10.0.1.4) over a port associated with DCOM RPC traffic.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11184.png', 'ScreenshotCaption': '8.C.2 - DCOM RPC network traffic (top)'}, {'ScreenshotName': 'FireEye-APT29-11185.png', 'ScreenshotCaption': '8.C.2 - DCOM RPC network traffic (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13008.png', 'ScreenshotCaption': 'MSSP - 8.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Windows Admin Shares" was generated due to access of a remote admin share.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11057.png', 'ScreenshotCaption': 'psexec connection  over port 135  for remote share access. '}, {'ScreenshotName': 'GoSecure-APT29-11052.png', 'ScreenshotCaption': 'showing admin share  and  commandline of psexec to  show pam  logon. tagged  with psexec, a impact level 50, remote execution. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11057.png', 'ScreenshotCaption': 'psexec connection  over port 135  for remote share access. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Windows Share by Shared Folder Access Monitor" was generated due to remote access to a Windows admin share.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3634.png', 'ScreenshotCaption': '8.C.2 - Windows Admin Share alert'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (warning severity) called "Lateral Movement with PsExec" was generated due to PsExec64.exe executing a remote command from Nashua (10.0.1.6) to Scranton (10.0.1.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3628.png', 'ScreenshotCaption': '8.C.2 - Lateral Movement with PsExec alert'}, {'ScreenshotName': 'HanSight-APT29-3629.png', 'ScreenshotCaption': '8.C.2 - Network information without port in alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of psexec64 establishing an IPC share on Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18004.png', 'ScreenshotCaption': 'new mssp 8c2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2895.png', 'ScreenshotCaption': 'Saw connection over SMB between systems'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': "A Technique alert detection (medium severity) for Windows Admin Shares  was generated due to PSEXEC connecting to Scranton's IPC$ share. The event was correlated to a parent Technique detection for Masquerading for rcs.3aka3.doc.", 'Modifiers': ['Alert', 'Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2538.png', 'ScreenshotCaption': 'write of psexec (8c3)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.', 'Exiting event details shows correlation of detections.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for PowerShell. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1743.png', 'ScreenshotCaption': '8.c.2 - net connection from nashua to 10.0.1.4:135'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP 135.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-437.png', 'ScreenshotCaption': 'Telemetry showing PsExec64.exe establishing a network connection to 10.0.1.4 over TCP 135'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for network share access was generated due to remote access to a Windows admin share.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3018.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-3019.png', 'ScreenshotCaption': '2 - windows admin share'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for an executable being copied to a remote host via a share. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3016.png', 'ScreenshotCaption': '1 - remote copy and execution of psexec'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13225.png', 'ScreenshotCaption': '8.C.2, 8.C.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3022.png', 'ScreenshotCaption': '2 - RPC calls to scranton from xdr view'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135. The detection was correlated to a parent alert identifying rcs.3aka3.doc as a suspicious, previously unseen process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-138.png', 'ScreenshotCaption': 'traces of psexec; shows network connection; wrong TID'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Lateral Movement - Windows Admin Shares" occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13755.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6756.png', 'ScreenshotCaption': '8.c.2 netflow 135'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "AdminShareAccess" was generated due to PSEXESVC.exe being copied to $ADMIN on Scranton (10.0.1.4). The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6721.png', 'ScreenshotCaption': 'Admin share access alert from psexec64'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1077" occurred containing evidence of  PsExec64.exe establishing SMB session to Scranton\'s IPC$ share, and writes PSEXESVC.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12834.png', 'ScreenshotCaption': 'MSSP - C2 - network information'}, {'ScreenshotName': 'SentinelOne-APT29-12835.png', 'ScreenshotCaption': 'MSSP - C2/3 -network info + psexec + admin share access'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135 identified as RPC.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6718.png', 'ScreenshotCaption': 'C2 - SMB session being established'}, {'ScreenshotName': 'SentinelOne-APT29-14733.png', 'ScreenshotCaption': '8.C.2 - rpc network connection correlated'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7461.png', 'ScreenshotCaption': 'network connections from nashua showing PSExec connection to scranon on port 445 and connection to domain controller on port 389'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Executable file dropped in administrative share"  was generated due PSEXESVC.exe being copied to Scranton.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11975.png', 'ScreenshotCaption': '2 - smb network connection, labeled lat movement'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13945.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '8.C.3', 'Procedure': 'Executed python.exe using PSExec', 'Criteria': 'python.exe spawned by PSEXESVC.exe', 'Techniques': [{'TechniqueId': 'T1035', 'TechniqueName': 'Service Execution', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "PSExecLateralMovement" was generated for unusual markers of PSExec being used for lateral movement.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-765.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PSEXESVC.exe with command-line arguments to execute python.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-761.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-766.png', 'ScreenshotCaption': 'psexpect with creds'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ServiceExecOnSMBFile" was generated due to PsExec running a python.exe remotely. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-15006.png', 'ScreenshotCaption': '8c3 - new vendor screenshot'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned from PSEXESVC.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10474.png', 'ScreenshotCaption': 'Telemetry showing python.exe spawned by PSEXESVC.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Service Execution" was generated for the execution of python.exe by PSEXECSVC.exe on host Scranton (10.0.1.4) as SYSTEM.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2255.png', 'ScreenshotCaption': 'PSExecSvc executing python.exe on Scranton as SYSTEM'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Service Execution" occurred containing evidence of PSEXESVC.exe executing python.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12456.png', 'ScreenshotCaption': '8.C.3 - MDR Report Day 1, PSExec description'}, {'ScreenshotName': 'CyCraft-APT29-12457.png', 'ScreenshotCaption': '8.C.3 - MDR Report Day 1, PSEXECSVC.exe execution'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (red icon) called "ATT&CK: Execution" was generated due to PSEXESVC.exe attempting to execute a malicious file. The detection was correlated to a parent alert for malicious PowerShell. ', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9648.png', 'ScreenshotCaption': '8.c.3 - process details with the suspicious '}, {'ScreenshotName': 'Cybereason-APT29-9647.png', 'ScreenshotCaption': '8.c.3 - full proces tree with suspicious for python.exe info'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe. The detection was correlated to a parent alert for malicious PowerShell. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9647.png', 'ScreenshotCaption': '8.c.3 - full proces tree with suspicious for python.exe info'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11981.png', 'ScreenshotCaption': 'C3 - Proccess tree showing psexecsvc.exe executing python.exe along with network connections'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "ATT&CK T1035 Service Execution" for PsExec64.exe calling the CreateServiceW API. The detection was correlated to a parent alert for malicious file execution.\t', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1307.png', 'ScreenshotCaption': 'service executed tag for psexec64 - 8.c.3 technique alert'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "Service Creation/Modification" was generated due to PsExec64.exe creating the psexesvc.exe service.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1308.png', 'ScreenshotCaption': 'service created/executed alert for psexec64  - 8.c.3 technique'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PSEXESVC.exe executing python.exe. The detection was correlated to a parent alert for the "First Seen Process in an Environment". ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1310.png', 'ScreenshotCaption': 'python executed better view - 8.c.3'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "Service Execution" was generated due to PsExec running a process remotely. The event was correlated to parent alert for Abnormal File Modification.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10135.png', 'ScreenshotCaption': 'with att&ck ids'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PSEXESVC.exe executing python.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-11295.png', 'ScreenshotCaption': 'MSSP - command line arg for lateral movement via psexec'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10134.png', 'ScreenshotCaption': 'psexec executing python'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PsExec Execution" was generated due to PSEXESVC.exe spawning the child process python.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11196.png', 'ScreenshotCaption': '8.C.3 - PSEXESVC.exe executing python.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13008.png', 'ScreenshotCaption': 'MSSP - 8.C'}, {'ScreenshotName': 'FireEye-APT29-13013.png', 'ScreenshotCaption': 'MSSP - 8.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection was generated due to PsExec tool detected process created labeled "Lateral Movement with Remote Execution." The event was correlated to a parent detection for "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11052.png', 'ScreenshotCaption': 'showing admin share  and  commandline of psexec to  show pam  logon. tagged  with psexec, a impact level 50, remote execution. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe. The event was correlated to a parent General detection for a suspicious process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11049.png', 'ScreenshotCaption': 'relationship graph showing psexec launch python.exe (8c3)'}, {'ScreenshotName': 'GoSecure-APT29-11052.png', 'ScreenshotCaption': 'showing admin share  and  commandline of psexec to  show pam  logon. tagged  with psexec, a impact level 50, remote execution. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PSEXESVC.exe executing python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3642.png', 'ScreenshotCaption': '8.C.3 - python.exe process execution'}, {'ScreenshotName': 'HanSight-APT29-3643.png', 'ScreenshotCaption': '8.C.3 - PSEXESVC.exe as parent process'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the execution of psexecsvc.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-11796.png', 'ScreenshotCaption': 'MSSP Report Page 3 - Step 8'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PSEXESVC.exe with command-line arguments to execute python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-13410.png', 'ScreenshotCaption': '8C3 - vendor provided screenshot, use this'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1750.png', 'ScreenshotCaption': '8.c.3 - psexecsvc parent to python.exe'}], 'Footnotes': ['The malicious Python process would have been blocked by MVISION Endpoint  by a Real Protect machine learning model based on process behavior. ']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PSEXESVC.exe creating process python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-438.png', 'ScreenshotCaption': 'Telemetry showing PSEXESVC.exe creating process python.exe.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Service Execution Start service T1050" was generated due to psexec.exe spawning python.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3023.png', 'ScreenshotCaption': 'Behavioral threat alert for psexec64.exe starting python.exe.'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated due to an unsigned process running from a temporary directory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3025.png', 'ScreenshotCaption': 'Process diagram showing psexec64.exe launching the python.exe process.'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for "Lateral Movement" was generated due to PSEXE64.exe execution with plain-text credentials from Nashua as the user Pam. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3016.png', 'ScreenshotCaption': '1 - remote copy and execution of psexec'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PSEXESVC.exe being copied to a remote host. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3016.png', 'ScreenshotCaption': '1 - remote copy and execution of psexec'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13225.png', 'ScreenshotCaption': '8.C.2, 8.C.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe and originated from a RPC call originating on the remote host Nashua (10.0.1.6).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13658.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-3025.png', 'ScreenshotCaption': 'Process diagram showing psexec64.exe launching the python.exe process.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-142.png', 'ScreenshotCaption': 'psexec on scranton'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Lateral Movement showed python.exe spawned by PSEXESVC.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13755.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6780.png', 'ScreenshotCaption': '8.c.3 process tree psexec executed python'}, {'ScreenshotName': 'SecureWorks-APT29-6781.png', 'ScreenshotCaption': 'process event for 8.c.3 psexec executing python.exe'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "ProcessCreationExtra" was generated due to PSEXESVC.exe executing python.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14734.png', 'ScreenshotCaption': '8.C.3 - Execution of python.exe from PSEXESVC.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1035" occurred containing evidence of PsExec executing python.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12835.png', 'ScreenshotCaption': 'MSSP - C2/3 -network info + psexec + admin share access'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6727.png', 'ScreenshotCaption': 'C3 - PSEXECSVC being spawned from python.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "PsExec interacted with services - SONAR.PsExeSvc!gen1" was generated on PsExecSvc targeting python.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7458.png', 'ScreenshotCaption': 'PSExec executing python.exe on scranton'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Service Execution" occurred containing evidence of PSEXECSVC.exe executing python.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12942.png', 'ScreenshotCaption': 'MSSP Day 1: PSExec for lateral movement'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PSEXECSVC.exe executing python.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7466.png', 'ScreenshotCaption': 'python.exe running as pam, and psexec64.exe running as pam with command line arguments'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "Service Execution" was generated due to PSEXESVC.exe executing python.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11986.png', 'ScreenshotCaption': 'c3 - service execution technique '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11989.png', 'ScreenshotCaption': 'c3 - telemetry - Psexec created psexec launches python'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "T1035 & T1077 - Service Execution - psexec - target" was generated due to a process running remotely with PsExec.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4055.png', 'ScreenshotCaption': 'psex service execution '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe spawned by PSEXESVC.exe', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4055.png', 'ScreenshotCaption': 'psex service execution '}], 'Footnotes': []}]}]}]}, {'Substep': '9.A.1', 'Procedure': 'Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\xa0', 'Criteria': 'python.exe creating the file rar.exe', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an executable file write event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-770.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an executable file write event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10487.png', 'ScreenshotCaption': 'Telemetry showing python.exe writing Rar.exe and sdelete64.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a create file event for python.exe creating rar.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9650.png', 'ScreenshotCaption': '9.a.1 and 2 rar.exe and sdeltee64 file vents'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11999.png', 'ScreenshotCaption': 'A1 - File creation event for python.exe creating rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file created event for python.exe creating rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1324.png', 'ScreenshotCaption': 'rar.exe created ignore some of the ones above he moved fast '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence that rar.exe was copied to remote host Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11297.png', 'ScreenshotCaption': 'MSSP - pythong and rar'}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed FILE_CREATE event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10136.png', 'ScreenshotCaption': 'file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "Temp Directory PE Write" was generated due to python.exe writing rar.exe to C:\\Windows\\Temp.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11742.png', 'ScreenshotCaption': 'CC - 9.A.1 - Temp Directory PE Write for Rar.exe'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for python.exe creating rar.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13014.png', 'ScreenshotCaption': 'MSSP - 9.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file write event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11206.png', 'ScreenshotCaption': '9.A - python.exe file writes for Rar.exe and sdelete64.exe'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for python.exe creating rar.exe downloaded from 192.164.0.4 port 8443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11066.png', 'ScreenshotCaption': 'rar.exe file create'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3651.png', 'ScreenshotCaption': '9.A.1 - File created event for Rar.exe'}, {'ScreenshotName': 'HanSight-APT29-3650.png', 'ScreenshotCaption': '9.A.1 - For same event has python.exe as process'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of rar.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18005.png', 'ScreenshotCaption': 'new mssp 9a1 - remote file copy'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-13798.png', 'ScreenshotCaption': '9a1 - vendor better pic'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file created event for rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1751.png', 'ScreenshotCaption': '9.a.1 - rar.exe created; python.exe pid is 10228 and shown as parent'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for suspicious activity was generated containing evidence of python.exe uploading rar.exe. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed created file event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-628.png', 'ScreenshotCaption': 'Telemetry showing python.exe creating new file: C:\\Windows\\Temp\\rar.exe.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for python.exe writing rar.exe to C:\\Windows\\Temp. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3032.png', 'ScreenshotCaption': '1 - remote file copy xdr view'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for python.exe creating rar.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13226.png', 'ScreenshotCaption': '9.A.1, 9.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event for python.exe creating rar.exe from a named pipe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13659.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13661.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an Executable Dropped event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-147.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Python spawns PowerShell which then writes rar.exe and sdelete64.exe" occurred containing evidence of file write events for rar.exe and sdelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12836.png', 'ScreenshotCaption': 'MSSP - A1/2 - File writes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file creation event for python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6738.png', 'ScreenshotCaption': 'A1 - python processes creating rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Remote File Copy - Suspicious N-Gram" was generated when python.exe connected to 192.168.0.4 port 8443 and then immediately created rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17864.png', 'ScreenshotCaption': '9a1 - ngram + technique'}, {'ScreenshotName': 'Symantec-APT29-17864.png', 'ScreenshotCaption': '9a1 - ngram + technique'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe creating rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7468.png', 'ScreenshotCaption': 'list of rar.exe creations and python.exe connected, with remote file copy'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for python.exe creating rar.exe. The detection was correlated to a parent alert for service execution on python.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11993.png', 'ScreenshotCaption': 'RCA view - python created rar and sdelete'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for rar.exe by python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4058.png', 'ScreenshotCaption': 'sdelete file write, rar.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '9.A.2', 'Procedure': 'Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\xa0', 'Criteria': 'python.exe creating the file sdelete64.exe', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Executable File Write event for python.exe creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-771.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Executable File Write event for python.exe creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10487.png', 'ScreenshotCaption': 'Telemetry showing python.exe writing Rar.exe and sdelete64.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a create file event for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9650.png', 'ScreenshotCaption': '9.a.1 and 2 rar.exe and sdeltee64 file vents'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Create event for python.exe creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-11998.png', 'ScreenshotCaption': 'A2 - File creation event for sdelete64 being created by python.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Created event for python.exe creating sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1325.png', 'ScreenshotCaption': 'sdelete created'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence that sdelete.exe was copied to remote host Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14495.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed FILE_CREATE event for python.exe creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10136.png', 'ScreenshotCaption': 'file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "Temp Directory PE Write" was generated due to python.exe writing sdelete64.exe to C:\\Windows\\Temp.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11743.png', 'ScreenshotCaption': 'CC - 9.A.2 - Temp Directory PE Write for sdelete64.exe'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for python.exe creating sdelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13014.png', 'ScreenshotCaption': 'MSSP - 9.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Write event for python.exe creating sdelete64.exe', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11206.png', 'ScreenshotCaption': '9.A - python.exe file writes for Rar.exe and sdelete64.exe'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Create event for python.exe creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11070.png', 'ScreenshotCaption': 'file create of sdelete by python.exe'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for python.exe creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3648.png', 'ScreenshotCaption': '9.A.2 - File created event for sdelete64.exe by python.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of sdelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18006.png', 'ScreenshotCaption': 'new mssp 9a2 sdelete create'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for python.exe creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2917.png', 'ScreenshotCaption': '9.a.2 - python.exe creating sdelete64.exe'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Created event for sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1752.png', 'ScreenshotCaption': '9.a.2 - sdelete64.exe created ; python.exe pid is 10228 and shown as parent'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for suspicious activity was generated containing evidence of python.exe uploading sdelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Created File event for python.exe creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-439.png', 'ScreenshotCaption': 'Telemetry showing python.exe creating sdelete64.exe.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for python.exe creating sdelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13226.png', 'ScreenshotCaption': '9.A.1, 9.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Write/Create events for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3036.png', 'ScreenshotCaption': '2 - sdelete file copy operation in the xdr view'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an Executable Dropped event for python.exe, connected to 192.168.0.4 port 8443, creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-145.png', 'ScreenshotCaption': 'python executing rar and sdelete'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Python spawns PowerShell which then writes Rar.exe and sdelete64.exe" occurred containing evidence of file write events for rar.exe and sdelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12836.png', 'ScreenshotCaption': 'MSSP - A1/2 - File writes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Creation event for python.exe creating sdelete64.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6739.png', 'ScreenshotCaption': 'A2 - python processes creating sdelete64.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Suspicious N-Gram" was generated when python.exe connected to 192.168.0.4 port 8443 and then immediately created sdelete64.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17867.png', 'ScreenshotCaption': '9a2 - ngram + general'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Created File event for python.exe connecting to 192.168.0.4 port 8443 and then immediately creating sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7471.png', 'ScreenshotCaption': 'python.exe created file sdelete.exe'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed File Create event for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for service execution on python.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11993.png', 'ScreenshotCaption': 'RCA view - python created rar and sdelete'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for sdelete64.exe by python.exe.  The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4058.png', 'ScreenshotCaption': 'sdelete file write, rar.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '9.B.1', 'Procedure': 'Spawned interactive powershell.exe', 'Criteria': 'powershell.exe\u200b spawning from python.exe', 'Techniques': [{'TechniqueId': 'T1086', 'TechniqueName': 'PowerShell', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetery showed python.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-772.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Python.exe executing powershell.exe\u200b.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10489.png', 'ScreenshotCaption': 'Telemetry showing Python.exe executing powershell.exe\u200b.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "PowerShell" was generated when python.exe spawned powershell.exe. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2257.png', 'ScreenshotCaption': 'python.exe executed powershell.exe on Scranton with enrichments.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell" was received that showed execution of powershell.exe by python.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12461.png', 'ScreenshotCaption': '9.B.5 - MDR Report Day 1, execution of rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9651.png', 'ScreenshotCaption': '9.b.1 - python spawning powershell'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (info severity) called "Win_User_Execution_MITRET1204" was generated due to a process targeting an *.exe filename.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12008.png', 'ScreenshotCaption': 'B1 - Python.exe executing powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "T1086 PowerShell" was generated due to powershell.exe executing. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1326.png', 'ScreenshotCaption': 'python executing powershell with att&ck enrichment (9b1)'}, {'ScreenshotName': 'Elastic-APT29-1326.png', 'ScreenshotCaption': 'python executing powershell with att&ck enrichment (9b1)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetery showed python.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1326.png', 'ScreenshotCaption': 'python executing powershell with att&ck enrichment (9b1)'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe. This event was correlated to prior detection for the python.exe process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10138.png', 'ScreenshotCaption': 'process tree showing python spawning powershell'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell Execution" was generated due to python.exe spawning powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11207.png', 'ScreenshotCaption': '9.B.1 - PowerShell Execution for python.exe spawning powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for python.exe executing powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13015.png', 'ScreenshotCaption': 'MSSP - 9.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetery showed python.exe executing powershell.exe. This event was correlated to prior detection for the python.exe process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11222.png', 'ScreenshotCaption': '9.B - Triage view with python.exe executing powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called PowerShell was generated due to python.exe spawning powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11078.png', 'ScreenshotCaption': 'python.exe  with  the powershell process create impact score of 25'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe. The event was correlated to a parent detection on "Bypass User Account Control".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11078.png', 'ScreenshotCaption': 'python.exe  with  the powershell process create impact score of 25'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3652.png', 'ScreenshotCaption': '9.B.1 - Python as parent process of powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; medium severity) called "T1086_PowerShell" was generated due to python.exe spawning powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2926.png', 'ScreenshotCaption': 'Medium level alert on powershell'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of python spawning powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18007.png', 'ScreenshotCaption': 'new mssp 9B1 and 9B5'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2926.png', 'ScreenshotCaption': 'Medium level alert on powershell'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1755.png', 'ScreenshotCaption': '9.b.1 - python running powershell'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of python.exe executing powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-441.png', 'ScreenshotCaption': 'Telemetry showing python.exe executing powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of python spawning powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13228.png', 'ScreenshotCaption': '9.B.2, 9.B.4, 9.B.5 - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13228.png', 'ScreenshotCaption': '9.B.2, 9.B.4, 9.B.5 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3041.png', 'ScreenshotCaption': 'Python.exe executing powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe\u200b. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-150.png', 'ScreenshotCaption': '8443 with python connection'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Execution - PowerShell" occurred containing evidence of python.exe executing powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12629.png', 'ScreenshotCaption': 'MSSP - SW - 9B1 '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6790.png', 'ScreenshotCaption': '9.b.1 process event with process tree'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1086" occurred containing evidence of python.exe executing powershell.exe\u200b.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12837.png', 'ScreenshotCaption': 'MSSP - B1 - process tree'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe\u200b. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6753.png', 'ScreenshotCaption': 'B1 - Process tree of python executing powershell'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for PowerShell was generated when python.exe spawned powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7472.png', 'ScreenshotCaption': 'Execution of powershell.exe, tagged with PowerShell'}, {'ScreenshotName': 'Symantec-APT29-7475.png', 'ScreenshotCaption': 'python.exe executing powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe. The telemetry was correlated to a parent detection python.exe as a suspicious file.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17683.png', 'ScreenshotCaption': '9b1 - telemetry + correlation'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe\u200b. The detection was correlated to a parent alert for service execution on python.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-11995.png', 'ScreenshotCaption': 'b1 - python > PS'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for the execution of a abnormal fileless command-line length. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13946.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4059.png', 'ScreenshotCaption': 'powershell executing from python'}], 'Footnotes': []}]}]}]}, {'Substep': '9.B.2', 'Procedure': 'Searched filesystem for document and media files using PowerShell', 'Criteria': 'powershell.exe executing (Get-)ChildItem\u200b', 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for PowerShell enumerating files and directories using environment variables.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1130.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.', 'PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10490.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe executing Get-ChildItem\u200b.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2258.png', 'ScreenshotCaption': 'File Discovery and Automated Collection through PowerShell scriptblock logging. Contains Compress-Archive.'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for powershell.exe executing Get-ChildItem\u200b. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-13287.png', 'ScreenshotCaption': '9.b.2/3 - malware alert malicious command (cc)'}], 'Footnotes': ['A sensor policy update that enables deeper PowerShell visibility was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Win_AutomatedCollection_DirScanART_MITRET1119" occurred containing evidence of powershell.exe executing Get-ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12914.png', 'ScreenshotCaption': 'MSSP - alert'}, {'ScreenshotName': 'Cylance-APT29-12915.png', 'ScreenshotCaption': 'MSSP - SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12005.png', 'ScreenshotCaption': 'B2/3/4 - High alert for automated collection on Powershell SBL via Get-ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1330.png', 'ScreenshotCaption': 'get-child item with att&ck enrichment for data compressed'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing ChildItem to search the file system.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11293.png', 'ScreenshotCaption': 'MSSP - raw command - childitem'}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10140.png', 'ScreenshotCaption': 'CommandStart ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13017.png', 'ScreenshotCaption': 'MSSP - 9.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11224.png', 'ScreenshotCaption': '9.B.2/3 - Script block for ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3660.png', 'ScreenshotCaption': '9.B - powershell.exe executing Get-ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-445.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing Get-ChildItem to search filesystem for document and media files'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell looking for certain files in a directory. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13228.png', 'ScreenshotCaption': '9.B.2, 9.B.4, 9.B.5 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3042.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing get-childitem.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-284.png', 'ScreenshotCaption': 'cc - child item'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - File and Directory Discovery" occurred containing evidence of powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12631.png', 'ScreenshotCaption': 'MSSP - SW - 9B2-4 - event details'}, {'ScreenshotName': 'SecureWorks-APT29-12630.png', 'ScreenshotCaption': 'MSSP - SW - 9B2-4 '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6795.png', 'ScreenshotCaption': '9.b.2 and 9.b.3 get childitem event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "File Enumeration" under "Discovery {T1083}" was generated when powershell.exe executed Get-ChildItem. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6751.png', 'ScreenshotCaption': 'B2/3/4 - File Enumeration Alert'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1083" occurred containing evidence of enumerating directories in search for specific files. The function “ChildItem” is observed.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12838.png', 'ScreenshotCaption': 'MSSP - B2/3 -  child-item'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing ChildItem\u200b. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (UX)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7235.png', 'ScreenshotCaption': 'CC - B2/3 - Powershell Calling child-item - Generic powershell alert'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Collection" was received that included ChildItem command execution searching for document and media files.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17686.png', 'ScreenshotCaption': '9b2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17689.png', 'ScreenshotCaption': '9b2 - telemetry'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "PS1.DiscoverCollectLocal T1083" was generated for PowerShell enumerating files and directories using ChildItem recursively.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14022.png', 'ScreenshotCaption': 'CC - 9.B - Grey Detections'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell looking for certain files in a directory. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12788.png', 'ScreenshotCaption': 'MSSP - ChildItem'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem\u200b.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12002.png', 'ScreenshotCaption': 'b2/3 - ChildItem - scriptBlock '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4061.png', 'ScreenshotCaption': 'Scriptblock of 9b2,3'}], 'Footnotes': []}]}]}]}, {'Substep': '9.B.3', 'Procedure': 'Scripted search of filesystem for document and media files using PowerShell\xa0', 'Criteria': 'powershell.exe executing (Get-)ChildItem\u200b', 'Techniques': [{'TechniqueId': 'T1119', 'TechniqueName': 'Automated Collection', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem\u200b.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1130.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Automated Collection" was generated when powershell.exe executed Get-ChildItem. The event was correlated to a parent Technique detection for Windows Admin Shares.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10491.png', 'ScreenshotCaption': 'A Technique detection called "Windows Admin Shares" created from an executable file being written via SMB.  A technique detection called "Automated Collection" created when powershell.exe ran an automated search routine. A technique detection called "Data Compressed" created when a Rar archive was written with suspicious command line arguments.'}, {'ScreenshotName': 'CrowdStrike-APT29-10493.png', 'ScreenshotCaption': 'A Technique detection showing powershell.exe creating the zip file using Rar.exe.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe executing ChildItem\u200b.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10490.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe executing Get-ChildItem\u200b.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2258.png', 'ScreenshotCaption': 'File Discovery and Automated Collection through PowerShell scriptblock logging. Contains Compress-Archive.'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "malicious command" was generated on powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-13287.png', 'ScreenshotCaption': '9.b.2/3 - malware alert malicious command (cc)'}], 'Footnotes': ['A sensor policy update that enables deeper PowerShell visibility was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_AutomatedCollection_DirScanART_MITRET1119" , was generated due to powershell.exe executing Get-ChildItem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12005.png', 'ScreenshotCaption': 'B2/3/4 - High alert for automated collection on Powershell SBL via Get-ChildItem'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Win_AutomatedCollection_DirScanART_MITRET1119" occurred containing evidence of powershell.exe executing Get-ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12914.png', 'ScreenshotCaption': 'MSSP - alert'}, {'ScreenshotName': 'Cylance-APT29-12915.png', 'ScreenshotCaption': 'MSSP - SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. This event was correlated to a General detection for the execution of a malicious file (python.exe).', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1330.png', 'ScreenshotCaption': 'get-child item with att&ck enrichment for data compressed'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing ChildItem to search the file system.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11293.png', 'ScreenshotCaption': 'MSSP - raw command - childitem'}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10140.png', 'ScreenshotCaption': 'CommandStart ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13017.png', 'ScreenshotCaption': 'MSSP - 9.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11224.png', 'ScreenshotCaption': '9.B.2/3 - Script block for ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3660.png', 'ScreenshotCaption': '9.B - powershell.exe executing Get-ChildItem'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-14000.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Automated Collection "(T1119)" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13228.png', 'ScreenshotCaption': '9.B.2, 9.B.4, 9.B.5 - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13228.png', 'ScreenshotCaption': '9.B.2, 9.B.4, 9.B.5 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3041.png', 'ScreenshotCaption': 'Python.exe executing powershell.exe'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-284.png', 'ScreenshotCaption': 'cc - child item'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Collection - Automated Collection" occurred containing evidence of powershell.exe executing ChildItem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12630.png', 'ScreenshotCaption': 'MSSP - SW - 9B2-4 '}, {'ScreenshotName': 'SecureWorks-APT29-12631.png', 'ScreenshotCaption': 'MSSP - SW - 9B2-4 - event details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed Powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6795.png', 'ScreenshotCaption': '9.b.2 and 9.b.3 get childitem event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Automated Collection" was generated when powershell.exe accessed multiple files when using ChildItem. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17873.png', 'ScreenshotCaption': '9.B.3 - Automated Collection for gathering files in Pam'}], 'Footnotes': ['A UX Configuration Change was made to bring host file reads into the UI.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1119" occurred containing evidence of enumerating directories in search for specific files. The function “ChildItem” is observed.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12838.png', 'ScreenshotCaption': 'MSSP - B2/3 -  child-item'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing ChildItem\u200b. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7235.png', 'ScreenshotCaption': 'CC - B2/3 - Powershell Calling child-item - Generic powershell alert'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Collection" was received that included ChildItem command execution searching for document and media files.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17686.png', 'ScreenshotCaption': '9b2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17689.png', 'ScreenshotCaption': '9b2 - telemetry'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "PS1.DiscoverCollectLocal T1119" was generated for PowerShell enumerating files and directories using ChildItem recursively.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14022.png', 'ScreenshotCaption': 'CC - 9.B - Grey Detections'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell looking for certain files in a directory. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12788.png', 'ScreenshotCaption': 'MSSP - ChildItem'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem\u200b.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12002.png', 'ScreenshotCaption': 'b2/3 - ChildItem - scriptBlock '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4061.png', 'ScreenshotCaption': 'Scriptblock of 9b2,3'}], 'Footnotes': []}]}]}]}, {'Substep': '9.B.4', 'Procedure': 'Recursively collected files found in C:\\Users\\Pam\\ using PowerShell', 'Criteria': 'powershell.exe reading files in C:\\Users\\Pam\\', 'Techniques': [{'TechniqueId': 'T1005', 'TechniqueName': 'Data from Local System', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file opens of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9973.png', 'ScreenshotCaption': '9.b.4 - (cc)'}, {'ScreenshotName': 'Cybereason-APT29-9972.png', 'ScreenshotCaption': '9.b.4 - process tree (cc)'}], 'Footnotes': ['A sensor policy update that enables file read event collection was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file reads of C:\\Users\\Pam\\*. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1337.png', 'ScreenshotCaption': 'compress-archive powershell event -- 9b4'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection for "T1119 Possible Data Collection (file reads)" was generated on file reads of C:\\Users\\Pam\\*.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11699.png', 'ScreenshotCaption': "config change file read of bing.url because of monitoring of pam's directory. tagged with possible data collection"}], 'Footnotes': ["Configuration changed to monitor Pam's user directory."]}, {'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed file reads by powershell.exe in Pam's user directory. The event was correlated to parent alert on New Windows Service Created.", 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11699.png', 'ScreenshotCaption': "config change file read of bing.url because of monitoring of pam's directory. tagged with possible data collection"}], 'Footnotes': ["Configuration changed to monitor Pam's user directory."]}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for powershell.exe reading files in C:\\Users\\Pam.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13228.png', 'ScreenshotCaption': '9.B.2, 9.B.4, 9.B.5 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3045.png', 'ScreenshotCaption': 'Telemetry showing file reads of C:\\Users\\Pam\\*.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file reads of C:\\Users\\Pam\\*. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-151.png', 'ScreenshotCaption': 'pam one drive'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "OpenedFile" under "Data from Local System {T1005}" was generated when a known malicious powershell.exe read files in C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7240.png', 'ScreenshotCaption': 'CC - B4 -  enumeration of C:/users/pam via OpenFile alert'}, {'ScreenshotName': 'SentinelOne-APT29-7241.png', 'ScreenshotCaption': 'CC - B4 -  enumeration of C:/users/pam via OpenFile alert'}], 'Footnotes': ['A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005).']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file accesses of C:\\Users\\Pam\\*.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12009.png', 'ScreenshotCaption': 'b4 - pam file accesses'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '9.B.5', 'Procedure': 'Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell', 'Criteria': 'powershell.exe creating the file working.zip', 'Techniques': [{'TechniqueId': 'T1074', 'TechniqueName': 'Data Staged', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1078.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a ZipFileWritten event for the creation of working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10496.png', 'ScreenshotCaption': 'Telemetry showing ZipFileWritten event.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Create File event for powershell.exe creating working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9653.png', 'ScreenshotCaption': '9.b.5 file creating with app data roaming file'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) called "Win_FileExtensions_LocalSystemCollection_NonSys_MITRET1005"  was generated for file activity involving draft.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12014.png', 'ScreenshotCaption': 'B5 - medium alert for LocalSystemCollection on working.zip file creation'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a File Write event for powershell.exe creating working.zip.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a File Created event for powershell.exe creating working.zip. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1327.png', 'ScreenshotCaption': 'working.zip file created'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell staging files into working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11293.png', 'ScreenshotCaption': 'MSSP - raw command - childitem'}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a FILE_CREATE event for powershell.exe creating working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10136.png', 'ScreenshotCaption': 'file creations of sdelete.exe, rar.exe, also rar.exe creating working.zip'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "ZIP Archive Created" "T1074" was generated due to the file creation of the ZIP file working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11209.png', 'ScreenshotCaption': '9.B.5 - ZIP Archive Created for working.zip (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11208.png', 'ScreenshotCaption': '9.B.5 - ZIP Archive Created for working.zip (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for file create of working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13017.png', 'ScreenshotCaption': 'MSSP - 9.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for working.zip.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a File Create event for powershell.exe creating working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11081.png', 'ScreenshotCaption': 'working.zip file creation with data exfiltration and archiving label'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18007.png', 'ScreenshotCaption': 'new mssp 9B1 and 9B5'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for powershell.exe creating working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2929.png', 'ScreenshotCaption': 'Triggering on  creation of a powershell process'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a File Created event for powershell.exe creating working.zip. The detection was correlated to a parent alert for PowerShell. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1787.png', 'ScreenshotCaption': '9.b.5 -monitoring'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for suspicious activity was generated containing evidence PowerShell created working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a created file event for powershell.exe creating working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-446.png', 'ScreenshotCaption': 'Telemetry showing rar.exe creating working.zip.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "Collection" was generated due to working.zip file creation in %APPDATA%\\roaming folder. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3049.png', 'ScreenshotCaption': '5 - working.zip file create in the xdr view'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13228.png', 'ScreenshotCaption': '9.B.2, 9.B.4, 9.B.5 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create of working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13663.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-3052.png', 'ScreenshotCaption': '5 - file create'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe creating working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-150.png', 'ScreenshotCaption': '8443 with python connection'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1074" occurred containing evidence of working.zip creation from file creation events.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12839.png', 'ScreenshotCaption': 'MSSP - B5/6 - file creation event'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a File Creation event for powershell.exe creating working.zip.The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6743.png', 'ScreenshotCaption': 'B5 - File creation of working.zip'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Created File event for powershell.exe creating working.zip. The event was correlated to a parent General detection for a suspicious PowerShell process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17692.png', 'ScreenshotCaption': '9b5 - telem + correlation'}, {'ScreenshotName': 'Symantec-APT29-7473.png', 'ScreenshotCaption': 'powershell.exe created working.zip'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell creating working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12788.png', 'ScreenshotCaption': 'MSSP - ChildItem'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a File Created event for powershell.exe creating working.zip. The detection was correlated to a parent alert for service execution on python.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12001.png', 'ScreenshotCaption': 'b5 - working.zip'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a filemod event for powershell.exe creating working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4064.png', 'ScreenshotCaption': 'filemod of working.zip'}], 'Footnotes': []}]}]}]}, {'Substep': '9.B.6', 'Procedure': 'Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe', 'Criteria': 'powershell.exe executing rar.exe with the -a parameter for a password to use for encryption', 'Techniques': [{'TechniqueId': 'T1022', 'TechniqueName': 'Data Encrypted', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Data Encrypted T1022" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of encryption.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-777.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-774.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to a parent Technique detection for Windows Admin Shares.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10493.png', 'ScreenshotCaption': 'A Technique detection showing powershell.exe creating the zip file using Rar.exe.'}, {'ScreenshotName': 'CrowdStrike-APT29-10491.png', 'ScreenshotCaption': 'A Technique detection called "Windows Admin Shares" created from an executable file being written via SMB.  A technique detection called "Automated Collection" created when powershell.exe ran an automated search routine. A technique detection called "Data Compressed" created when a Rar archive was written with suspicious command line arguments.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "T1022 Data Encrypted" was generated when rar.exe was used to create an encrypted zip archive. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2262.png', 'ScreenshotCaption': 'Executing rar.exe from powershell with enrichments'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9655.png', 'ScreenshotCaption': '9.b.6 / 7 powershell executing rar.exe in process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Win_Data_Encryption_MITRET1022" was generated when rar.exe used "-hp" command-line arguments.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12007.png', 'ScreenshotCaption': 'B6 - Informational alert for data encryption triggered on rar.exe '}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) called "One-Liner ML Module" was generated when machine learning determined the command was suspicious.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12006.png', 'ScreenshotCaption': 'B6/7 - Low alert for suspicious One-Liner on powershell executing rar.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator; medium severity) for "Encrypting Files with WinRar" "T1022 Data Encrypted" was generated when rar.exe used "-hp" command-line arguments. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1334.png', 'ScreenshotCaption': 'encrypting alert detail with rar.rexe data encrypted process terminated'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1336.png', 'ScreenshotCaption': 'powershell encrypted arguments for zipping file '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence that rar.exe was used to compress and encrypt working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11293.png', 'ScreenshotCaption': 'MSSP - raw command - childitem'}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a previous detection for Abnormal File Modification.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10139.png', 'ScreenshotCaption': 'rar.exe with command line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Encrypted RAR Archive Command" "T1022" was generated when rar.exe used "-hp" command-line arguments.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11214.png', 'ScreenshotCaption': '9.B.6 - Encrypted RAR Archive Command'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13017.png', 'ScreenshotCaption': 'MSSP - 9.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "T1022 Data Encrypted" was generated when rar.exe created working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11082.png', 'ScreenshotCaption': 'other working.zip  file creation intelligence for exfil, archiving, data  compressed, data encrypted. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to parent alert on New Windows Service Created.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11083.png', 'ScreenshotCaption': 'winrar commandline execution showing password'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3664.png', 'ScreenshotCaption': '9.B - powershell.exe executing Rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green; low severity) called Data Encrypted was generated due to powershell.exe executing rar.exe with command-line arguments to encrypt working.zip. The event was correlated to a parent Technique detection on powershell.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2931.png', 'ScreenshotCaption': '9.b.5-7 - rar compressing files and encrypting with password'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18008.png', 'ScreenshotCaption': 'new mssp 9b6 and 7'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1764.png', 'ScreenshotCaption': '9.b.6-7 - ps executing rar with process tree - investigating view'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for suspicious activity was generated containing evidence a PowerShell command executed rar.exe to encrypt with password hpfGzq5yKw.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-446.png', 'ScreenshotCaption': 'Telemetry showing rar.exe creating working.zip.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13229.png', 'ScreenshotCaption': '9.B.6, 9.B.7 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3050.png', 'ScreenshotCaption': '6 - powershell executing the rar.exe command'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-148.png', 'ScreenshotCaption': 'powershell with rar relationship with password and data compressed'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Suspicious RAR Archive Command 8 Data Encrypted (T1022)\u200b\u200b" was generated when rar.exe was used to create an encrypted zip archive. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6801.png', 'ScreenshotCaption': '9.b.6/7 process tree rar.exe'}, {'ScreenshotName': 'SecureWorks-APT29-6799.png', 'ScreenshotCaption': '9.b.6 and 9.b.7 alert details rar.exe '}, {'ScreenshotName': 'SecureWorks-APT29-6800.png', 'ScreenshotCaption': '9.b.6/7 technique mappings'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1022" occurred containing evidence of rar.exe being executed with an encryption password parameter passed.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12839.png', 'ScreenshotCaption': 'MSSP - B5/6 - file creation event'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6744.png', 'ScreenshotCaption': 'B6/7 - powershell executing rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection for "Exfiltration" was generated when rar.exe executed with command-line arguments creating working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17694.png', 'ScreenshotCaption': '9b6 - tactic'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Data Encrypted" was received included the command used by the adversary to execute Rar.exe and explained that it was used to compress data into an encrypted ZIP file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12946.png', 'ScreenshotCaption': 'MSSP Day 1: PowerShell Collection (1)'}, {'ScreenshotName': 'Symantec-APT29-12945.png', 'ScreenshotCaption': 'MSSP Day 1: PowerShell Collection (2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7479.png', 'ScreenshotCaption': 'powershell.exe executing rar.exe with arguments'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for rar.exe executing with command line arguments. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12685.png', 'ScreenshotCaption': 'MSSP - 9B6/7/8 - 9C DELETES'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for service execution on python.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12004.png', 'ScreenshotCaption': 'b6 - better pic'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13948.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4060.png', 'ScreenshotCaption': 'rar command line arguments'}], 'Footnotes': []}]}]}]}, {'Substep': '9.B.7', 'Procedure': 'Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe', 'Criteria': 'powershell.exe executing rar.exe', 'Techniques': [{'TechniqueId': 'T1002', 'TechniqueName': 'Data Compressed', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Data Compressed T1002" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-776.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-774.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (purple indicator) called "Data Compressed" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. The event was correlated to a parent Technique detection for Windows Admin Shares.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10493.png', 'ScreenshotCaption': 'A Technique detection showing powershell.exe creating the zip file using Rar.exe.'}, {'ScreenshotName': 'CrowdStrike-APT29-10491.png', 'ScreenshotCaption': 'A Technique detection called "Windows Admin Shares" created from an executable file being written via SMB.  A technique detection called "Automated Collection" created when powershell.exe ran an automated search routine. A technique detection called "Data Compressed" created when a Rar archive was written with suspicious command line arguments.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.The event was correlated to a parent Technique detection for Windows Admin Shares.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10491.png', 'ScreenshotCaption': 'A Technique detection called "Windows Admin Shares" created from an executable file being written via SMB.  A technique detection called "Automated Collection" created when powershell.exe ran an automated search routine. A technique detection called "Data Compressed" created when a Rar archive was written with suspicious command line arguments.'}, {'ScreenshotName': 'CrowdStrike-APT29-10492.png', 'ScreenshotCaption': '9.b.5/6/7 rar creating the rar file and being spawn from powershell in the activity app'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "T1002 Data Compressed" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.  The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2262.png', 'ScreenshotCaption': 'Executing rar.exe from powershell with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data Compressed" was received that showed execution of rar.exe by powershell.exe and explained that it was used to compress data for exfiltration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12461.png', 'ScreenshotCaption': '9.B.5 - MDR Report Day 1, execution of rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9655.png', 'ScreenshotCaption': '9.b.6 / 7 powershell executing rar.exe in process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) called "One-Liner ML Module" was generated when machine learning determined the command was suspicious.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12006.png', 'ScreenshotCaption': 'B6/7 - Low alert for suspicious One-Liner on powershell executing rar.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12007.png', 'ScreenshotCaption': 'B6 - Informational alert for data encryption triggered on rar.exe '}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "T1002 Data Compressed" was generated when rar.exe used "-hp" command-line arguments. This event was correlated to a General detection for the execution of a malicious file (python.exe).', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1335.png', 'ScreenshotCaption': 'another working.zip file file create with enrichments for data compressed, data encrypted'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a General detection for the execution of a malicious file (python.exe).', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1332.png', 'ScreenshotCaption': 'encrypted rar command line args tele'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence that rar.exe was used to compress and encrypt working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11293.png', 'ScreenshotCaption': 'MSSP - raw command - childitem'}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a previous detection for Abnormal File Modification.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10138.png', 'ScreenshotCaption': 'process tree showing python spawning powershell'}, {'ScreenshotName': 'F-Secure-APT29-10139.png', 'ScreenshotCaption': 'rar.exe with command line arguments'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Rar Execution" "T1002" was generated when powershell.exe executed rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11212.png', 'ScreenshotCaption': '9.B.7 - Rar used to compress data'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13017.png', 'ScreenshotCaption': 'MSSP - 9.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "T1002 Data Compressed" was generated when rar.exe created working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11082.png', 'ScreenshotCaption': 'other working.zip  file creation intelligence for exfil, archiving, data  compressed, data encrypted. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to parent alert on New Windows Service Created.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11083.png', 'ScreenshotCaption': 'winrar commandline execution showing password'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (reminder severity) called "Data Compress Extension" "T1002" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. ', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4140.png', 'ScreenshotCaption': 'CC - 9.B - Data Compress Extension alert for working.zip creation'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3664.png', 'ScreenshotCaption': '9.B - powershell.exe executing Rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green; low severity) called "T1002_Data_Compressed" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2931.png', 'ScreenshotCaption': '9.b.5-7 - rar compressing files and encrypting with password'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18008.png', 'ScreenshotCaption': 'new mssp 9b6 and 7'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1764.png', 'ScreenshotCaption': '9.b.6-7 - ps executing rar with process tree - investigating view'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for suspicious activity was generated containing evidence rar.exe compressed files into working.zip', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-446.png', 'ScreenshotCaption': 'Telemetry showing rar.exe creating working.zip.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Scripting engine creates compressed file under suspicious folder" was generated when rar.exe was used to create an compressed zip archive in %APPDATA%. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3051.png', 'ScreenshotCaption': 'Python.exe executing powershell.exe which executes rar.exe to encrypt and stage working.zip.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13229.png', 'ScreenshotCaption': '9.B.6, 9.B.7 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3050.png', 'ScreenshotCaption': '6 - powershell executing the rar.exe command'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Data Compressed" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-148.png', 'ScreenshotCaption': 'powershell with rar relationship with password and data compressed'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (medium severity) called "Suspicious RAR Archive Command 8 Data Compressed (T1002)\u200b\u200b" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6884.png', 'ScreenshotCaption': '9.b.7 process tree'}, {'ScreenshotName': 'SecureWorks-APT29-6883.png', 'ScreenshotCaption': '9.b.7 - alert technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-6885.png', 'ScreenshotCaption': '9.b.7 - full process tree'}, {'ScreenshotName': 'SecureWorks-APT29-6882.png', 'ScreenshotCaption': '9.b.7 - alert details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Compression" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14735.png', 'ScreenshotCaption': '9.B.7 - Data Compressed into Desktop\\working.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1002" occurred containing evidence of powershell.exe executing rar.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12839.png', 'ScreenshotCaption': 'MSSP - B5/6 - file creation event'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6744.png', 'ScreenshotCaption': 'B6/7 - powershell executing rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for Data Compressed was generated when rar.exe created working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7479.png', 'ScreenshotCaption': 'powershell.exe executing rar.exe with arguments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Data Staged" was received included the command used by the adversary to execute Rar.exe and explained that it was used to compress compress data into working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12945.png', 'ScreenshotCaption': 'MSSP Day 1: PowerShell Collection (2)'}, {'ScreenshotName': 'Symantec-APT29-12946.png', 'ScreenshotCaption': 'MSSP Day 1: PowerShell Collection (1)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7479.png', 'ScreenshotCaption': 'powershell.exe executing rar.exe with arguments'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for Data Compressed generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12685.png', 'ScreenshotCaption': 'MSSP - 9B6/7/8 - 9C DELETES'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe. The detection was correlated to a parent alert for service execution on python.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12004.png', 'ScreenshotCaption': 'b6 - better pic'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Data Compressed via Command Interpreter for Staging" was generated due to powershell.exe executing rar.exe creating a filemod event for working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4070.png', 'ScreenshotCaption': 'data compressed for staging'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4060.png', 'ScreenshotCaption': 'rar command line arguments'}, {'ScreenshotName': 'Carbon Black-APT29-13948.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '9.B.8', 'Procedure': 'Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)', 'Criteria': 'python.exe\xa0reading the file working.zip while connected to the C2 channel', 'Techniques': [{'TechniqueId': 'T1041', 'TechniqueName': 'Exfiltration Over Command and Control Channel', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe reading working.zip and an existing C2 channel (192.168.0.4 over port 8443).', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1077.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-1078.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed python.exe reading working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-13668.png', 'ScreenshotCaption': '9b8 - vendor provided pic'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over TCP port 8443).  This event was correlated to a General detection for the execution of a malicious file (python.exe).', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13617.png', 'ScreenshotCaption': 'port 8443 connection '}], 'Footnotes': ['Configuration changes were made to increase detection capability, specifically additional API monitoring. ']}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed a connection to TCP port 8443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10143.png', 'ScreenshotCaption': 'port 8443 for 9b8'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of python.exe reading working.zip with established network connection to TCP port 8443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12704.png', 'ScreenshotCaption': '9.b.8 MSSP alert'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3057.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-3058.png', 'ScreenshotCaption': '8 - file read operation with network connection'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1041" occurred containing evidence of the C2 instance of Python.exe being observed establishing a network connection to 192.168.0.4 on port 8443 (https). ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-13193.png', 'ScreenshotCaption': 'MSSP - B8 - network connection'}, {'ScreenshotName': 'SentinelOne-APT29-12839.png', 'ScreenshotCaption': 'MSSP - B5/6 - file creation event'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over TCP port 8443).', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6748.png', 'ScreenshotCaption': 'B8 - Python connecting to 192.168.0.4 over 8443'}, {'ScreenshotName': 'SentinelOne-APT29-7242.png', 'ScreenshotCaption': 'CC - B8 - Python.exe opening working.zip'}], 'Footnotes': ['A UX Configuration Change was made to bring host file reads into the UI.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for service execution on python.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12010.png', 'ScreenshotCaption': 'b8 - python accessing working.zip'}, {'ScreenshotName': 'TrendMicro-APT29-12012.png', 'ScreenshotCaption': 'b8 - network connection over 8443'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '9.C.1', 'Procedure': 'Deleted rar.exe on disk using SDelete', 'Criteria': 'sdelete64.exe deleting the file rar.exe', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-782.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10511.png', 'ScreenshotCaption': 'Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe.'}, {'ScreenshotName': 'CrowdStrike-APT29-10512.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe spawning sdelete64.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "File Deletion T1107" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14982.png', 'ScreenshotCaption': '9c1-vendor submitted screenshot'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Deletion" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12464.png', 'ScreenshotCaption': '9.C.1 - MDR Report Day 1, description'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9661.png', 'ScreenshotCaption': '9c1 / 2 sdelete deleting the rar.exe file and working.zip file'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Sdelete Usage" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12026.png', 'ScreenshotCaption': 'C1 - medium alert for sdelete usage to delete rar.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Evading Detection" occurred containing evidence of sdelete64.exe deleting files.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12916.png', 'ScreenshotCaption': 'MSSP - sdelete usage'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12028.png', 'ScreenshotCaption': 'C1 - Delete event for rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "ATT&CK T1107 File Deletion" was generated when sdelete64.exe made a NtSetInformationFile API call deleting rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1766.png', 'ScreenshotCaption': 'cc - file deletion enrichment for 9.c.3 based on api monitoring'}], 'Footnotes': ['Configuration changes were made to add detection logic. ']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1341.png', 'ScreenshotCaption': 'rar.exe file delete'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Sdelete file removal" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10145.png', 'ScreenshotCaption': 'rar.exe and working.zip'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to a Technique detection on python.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10144.png', 'ScreenshotCaption': 'sdeltee rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sdelete Command Execution T1107" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13995.png', 'ScreenshotCaption': '9.C.1 - Sdelete Command Execution for Rar.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the file deletion of rar.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13019.png', 'ScreenshotCaption': 'MSSP - 9.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technnique alert detection (red indicator) called "Sdelete Tool Ran" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11089.png', 'ScreenshotCaption': '3 sdeletes of rar, working.zip ,and the appdata (zzzzz)'}, {'ScreenshotName': 'GoSecure-APT29-11090.png', 'ScreenshotCaption': 'rar and appdata sdelete, with 100 impact score, caused  by  use of sdelete'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the deletion of Rar.exe by SDelete.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12703.png', 'ScreenshotCaption': '9.c.1-3 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to parent alert on New Windows Service Created.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11090.png', 'ScreenshotCaption': 'rar and appdata sdelete, with 100 impact score, caused  by  use of sdelete'}, {'ScreenshotName': 'GoSecure-APT29-11089.png', 'ScreenshotCaption': '3 sdeletes of rar, working.zip ,and the appdata (zzzzz)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Indicator Removal on Host" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3671.png', 'ScreenshotCaption': '9.C.1 - sdelete64.exe deleting Rar.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments used to delete rar.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2949.png', 'ScreenshotCaption': '9.c.3 - sdelete64 deleting roaming\\working.zip'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1771.png', 'ScreenshotCaption': '9.c.1 - rar deleted with more data'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to a parent alerts of a suspicious python.exe process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1779.png', 'ScreenshotCaption': '9.c.1 rar.exe deleted cmd line'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for suspicious activity was generated containing evidence sdelete64.exe deleted rar.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-450.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe creating process sdelete64.exe with commandline arguments to delete C:\\Windows\\Temp\\Rar.exe.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the deletion of Rar.exe by SDelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13230.png', 'ScreenshotCaption': '9.C.1, 9.C.2, 9.C.3, 9.C.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3066.png', 'ScreenshotCaption': '1 - rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe. The detection was correlated to a parent alert for powershell.exe compressing data.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-153.png', 'ScreenshotCaption': 'all file deletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (low severity) called "SDelete64 Usage" "File Deletion T1107" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13760.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13759.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13758.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "sdelete" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12840.png', 'ScreenshotCaption': 'MSSP - C1 - sdelete'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file deletion event for secure file delete deleting rar.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6767.png', 'ScreenshotCaption': 'C1 - sdelete64 removing Temp/rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Defense Evasion" was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17696.png', 'ScreenshotCaption': '9c1/2/3 - tactic/technique '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe executing with command-line arguments to delete Rar.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17696.png', 'ScreenshotCaption': '9c1/2/3 - tactic/technique '}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "SysInternal Tools License Suppression" (low severity) was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14024.png', 'ScreenshotCaption': '9.C.1 - SysInternal Tools License Suppression for rar.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the file deletion of rar.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14023.png', 'ScreenshotCaption': 'MSSP - 9.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe deleting rar.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12013.png', 'ScreenshotCaption': 'file delete raw data (working.zip and rar, zzzzzz)'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13949.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13949.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13951.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-13950.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4078.png', 'ScreenshotCaption': 'rar.exe deltee'}, {'ScreenshotName': 'Carbon Black-APT29-4074.png', 'ScreenshotCaption': 'sdeletes delting working, rar.exe, python invoked cmd.exe'}], 'Footnotes': []}]}]}]}, {'Substep': '9.C.2', 'Procedure': 'Deleted working.zip (from Desktop) on disk using SDelete', 'Criteria': 'sdelete64.exe deleting the file \\Desktop\\working.zip', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-785.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10511.png', 'ScreenshotCaption': 'Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe.'}, {'ScreenshotName': 'CrowdStrike-APT29-10512.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe spawning sdelete64.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "File Deletion T1107" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2266.png', 'ScreenshotCaption': 'sdelete Desktop\\working.zip with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Deletion" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration, including C:\\Users\\pam\\Desktop\\working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12464.png', 'ScreenshotCaption': '9.C.1 - MDR Report Day 1, description'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9661.png', 'ScreenshotCaption': '9c1 / 2 sdelete deleting the rar.exe file and working.zip file'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Sdelete Usage" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12025.png', 'ScreenshotCaption': 'C2 - medium alert for sdelete usage to delete Desktop/working.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Evading Detection" occurred containing evidence of sdelete64.exe deleting files.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12916.png', 'ScreenshotCaption': 'MSSP - sdelete usage'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12030.png', 'ScreenshotCaption': 'C2 - Sdelete usage on desktop/working.zip'}, {'ScreenshotName': 'Cylance-APT29-12031.png', 'ScreenshotCaption': 'C2 - Sdelete usage on desktop/working.zip'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-15005.png', 'ScreenshotCaption': '9c2 - file delete working.zip'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Sdelete file removal" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10146.png', 'ScreenshotCaption': 'working .zip being delteed twice.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete deleting Desktop\\working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11298.png', 'ScreenshotCaption': 'MSSP - file deletes'}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to a Technique detection on python.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10144.png', 'ScreenshotCaption': 'sdeltee rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sdelete Command Execution T1107" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11232.png', 'ScreenshotCaption': '9.C.2 - Sdelete Command Execution for C:\\Users\\pam\\Desktop\\working.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the file deletion of Desktop\\working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13019.png', 'ScreenshotCaption': 'MSSP - 9.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technnique alert detection (red indicator) called "Sdelete Tool Ran" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11092.png', 'ScreenshotCaption': 'sdelete process of working.zip on desktop, 100 impact score because sdelete'}, {'ScreenshotName': 'GoSecure-APT29-11089.png', 'ScreenshotCaption': '3 sdeletes of rar, working.zip ,and the appdata (zzzzz)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the deletion of working.zip by SDelete.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12703.png', 'ScreenshotCaption': '9.c.1-3 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to parent alert on New Windows Service Created.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11092.png', 'ScreenshotCaption': 'sdelete process of working.zip on desktop, 100 impact score because sdelete'}, {'ScreenshotName': 'GoSecure-APT29-11089.png', 'ScreenshotCaption': '3 sdeletes of rar, working.zip ,and the appdata (zzzzz)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Indicator Removal on Host" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3672.png', 'ScreenshotCaption': '9.C.2 - sdelete64.exe deleting C:\\Users\\pam\\Desktop\\working.zip'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments used to delete Desktop\\working.zip.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2952.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1773.png', 'ScreenshotCaption': '9.c.2 - working.zip deleted from desktop'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to a parent alerts of a suspicious python.exe process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1775.png', 'ScreenshotCaption': '9.c.2 - working.zip deleted from desktop cmd line'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for suspicious activity was generated containing evidence sdelete64.exe deleted working.zip from Desktop.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to Desktop\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17398.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "file deletion T1107"  was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3086.png', 'ScreenshotCaption': 'File deletion of working.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the deletion of Desktop\\working.zip by SDelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13230.png', 'ScreenshotCaption': '9.C.1, 9.C.2, 9.C.3, 9.C.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed file delete event for sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3088.png', 'ScreenshotCaption': 'Telemetry showing sdelete64.exe deleting working.zip.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The detection was correlated to a parent alert for powershell.exe compressing data.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'syoder-1-RQ-9.C.1-T1107-1.png', 'ScreenshotCaption': 'all file deletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (low severity) called "SDelete64 Usage" "File Deletion T1107" was generated  when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6819.png', 'ScreenshotCaption': '9.c.3 working.zip alert details'}, {'ScreenshotName': 'SecureWorks-APT29-6818.png', 'ScreenshotCaption': '9.c.2 full process tree'}, {'ScreenshotName': 'SecureWorks-APT29-6816.png', 'ScreenshotCaption': '9.c.2 technique mappings - file deletion, data destruction, indicator removal on host'}, {'ScreenshotName': 'SecureWorks-APT29-6817.png', 'ScreenshotCaption': '9.c.2 process overview'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "sdelete" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12840.png', 'ScreenshotCaption': 'MSSP - C1 - sdelete'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to Desktop\\working.zip. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6765.png', 'ScreenshotCaption': 'C2 - sdelete64.exe removing of Desktop/working.zip '}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Defense Evasion" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17696.png', 'ScreenshotCaption': '9c1/2/3 - tactic/technique '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe executing with command-line arguments to delete Desktop\\working.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17696.png', 'ScreenshotCaption': '9c1/2/3 - tactic/technique '}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "SysInternal Tools License Suppression" (low severity) was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14025.png', 'ScreenshotCaption': '9.C.2 - SysInternal Tools License Suppression for Desktop/working.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the file deletion of Desktop\\working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14023.png', 'ScreenshotCaption': 'MSSP - 9.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe deleting Desktop\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12013.png', 'ScreenshotCaption': 'file delete raw data (working.zip and rar, zzzzzz)'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4075.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4075.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13950.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-13951.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4074.png', 'ScreenshotCaption': 'sdeletes delting working, rar.exe, python invoked cmd.exe'}, {'ScreenshotName': 'Carbon Black-APT29-4075.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '9.C.3', 'Procedure': 'Deleted working.zip (from AppData directory) on disk using SDelete', 'Criteria': 'sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "Unusual File Written in User Directory" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-784.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-783.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10511.png', 'ScreenshotCaption': 'Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe.'}, {'ScreenshotName': 'CrowdStrike-APT29-10512.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe spawning sdelete64.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "File Deletion T1107" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2265.png', 'ScreenshotCaption': 'sdelete appdata working.zip with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Deletion" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12464.png', 'ScreenshotCaption': '9.C.1 - MDR Report Day 1, description'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9664.png', 'ScreenshotCaption': '9.c.3 sdelete deleting appdata working zip file'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Evading Detection" occurred containing evidence of sdelete64.exe deleting files.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12916.png', 'ScreenshotCaption': 'MSSP - sdelete usage'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12029.png', 'ScreenshotCaption': 'C3 - Sdelete usage on appdata/working.zip'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "ATT&CK T1107 File Deletion" was generated when sdelete64.exe made a NtSetInformationFile API call deleting Roaming\\working.zip. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1766.png', 'ScreenshotCaption': 'cc - file deletion enrichment for 9.c.3 based on api monitoring'}], 'Footnotes': ['Configuration changes were made to increase detection capability, specifically additional API monitoring. ']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1767.png', 'ScreenshotCaption': 'cc - commandline for the  enrichment above'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Sdelete file removal" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10146.png', 'ScreenshotCaption': 'working .zip being delteed twice.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of sdelete deleting Roaming\\working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11298.png', 'ScreenshotCaption': 'MSSP - file deletes'}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to a Technique detection on python.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10144.png', 'ScreenshotCaption': 'sdeltee rar.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sdelete Command Execution T1107" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13996.png', 'ScreenshotCaption': '9.C.3 - Sdelete Command Execution for C:\\Users\\pam\\AppData\\Roaming\\working.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the file deletion of Roaming\\working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13019.png', 'ScreenshotCaption': 'MSSP - 9.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. This event was correlated to a prior detection on the python.exe parent process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11241.png', 'ScreenshotCaption': '9.C.3 - Triage view of sdelete64.exe deleting C:\\Users\\pam\\AppData\\Roaming\\working.zip and associated alphabetical rollovers'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technnique alert detection (red indicator) called "Sdelete Tool Ran" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11092.png', 'ScreenshotCaption': 'sdelete process of working.zip on desktop, 100 impact score because sdelete'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the deletion of working.zip by SDelete.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12703.png', 'ScreenshotCaption': '9.c.1-3 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to parent alert on New Windows Service Created.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11092.png', 'ScreenshotCaption': 'sdelete process of working.zip on desktop, 100 impact score because sdelete'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Indicator Removal on Host" was generated when sdelete64.exe with command-line arguments was used to delete working.zip. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3673.png', 'ScreenshotCaption': '9.C.3 - sdelete64.exe deleting C:\\Users\\pam\\AppData\\Roaming\\working.zip'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete working.zip. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2950.png', 'ScreenshotCaption': 'Similar false positive with Data Compressed, likely due to zip in the filename.'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1772.png', 'ScreenshotCaption': '9.c.3 - working.zip deleted from roaming'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to a parent alerts of a suspicious python.exe process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1777.png', 'ScreenshotCaption': '9.c.2 - working.zip deleted from roaming cmd line'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for suspicious activity was generated containing evidence sdelete64.exe deleted working.zip from C:\\Users\\USER_NAME\\AppData\\Roaming.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1135.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1134.png', 'ScreenshotCaption': 'MSSP detection - "Yttrium High Active Alert related to Command and Control, Collection, Exfiltration, and Defense Evasion" (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to Roaming\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-14001.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the deletion of roaming\\working.zip by SDelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13230.png', 'ScreenshotCaption': '9.C.1, 9.C.2, 9.C.3, 9.C.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3085.png', 'ScreenshotCaption': 'Telemetry showing sdelete64.exe deleting working.zip.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. The detection was correlated to a parent alert for powershell.exe compressing data.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'syoder-1-RQ-9.C.1-T1107-1.png', 'ScreenshotCaption': 'all file deletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (low severity) called "SDelete64 Usage" "File Deletion T1107" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6822.png', 'ScreenshotCaption': '9.c.3 full process tree'}, {'ScreenshotName': 'SecureWorks-APT29-6820.png', 'ScreenshotCaption': '9.c.3 technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-6819.png', 'ScreenshotCaption': '9.c.3 working.zip alert details'}, {'ScreenshotName': 'SecureWorks-APT29-6821.png', 'ScreenshotCaption': '9.c.3 process overview'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "sdelete" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12840.png', 'ScreenshotCaption': 'MSSP - C1 - sdelete'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6769.png', 'ScreenshotCaption': 'C3 - sdelete64.exe removing of appdata/working.zip '}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Defense Evasion" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17696.png', 'ScreenshotCaption': '9c1/2/3 - tactic/technique '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe executing with command-line arguments to delete Roaming\\working.zip. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17696.png', 'ScreenshotCaption': '9c1/2/3 - tactic/technique '}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Possible SDELETE" (medium severity) was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14026.png', 'ScreenshotCaption': '9.C.3 - Possible SDELETE for Roaming\\working.zip'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for the file deletion of Roaming\\working.zip.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14023.png', 'ScreenshotCaption': 'MSSP - 9.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe deleting Roaming\\working.zip.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12017.png', 'ScreenshotCaption': 'c3 - full path for 3'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13951.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-13950.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4076.png', 'ScreenshotCaption': 'woring.zip delete'}, {'ScreenshotName': 'Carbon Black-APT29-13952.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '9.C.4', 'Procedure': 'Deleted SDelete on disk using cmd.exe del command', 'Criteria': 'cmd.exe deleting the file sdelete64.exe', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed an ExecutableDeleted event for sdelete64.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10511.png', 'ScreenshotCaption': 'Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for psexec.exe executing a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-13290.png', 'ScreenshotCaption': '9.c.4 cmd.exe deleting the sdelete'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a DeleteOnClose event for cmd.exe removing sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12027.png', 'ScreenshotCaption': 'C4 - cmd.exe deleteing sdelete (Shown through DeleteOnClose event type)'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ATT&CK T1107 File Deletion" was generated when cmd.exe deleted sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1340.png', 'ScreenshotCaption': 'sdlete64.exe file delete '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe deleting sdelete64.exe. This event was correlated to a Technique detection for the creation of psexesvc.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1341.png', 'ScreenshotCaption': 'rar.exe file delete'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the deletion of sdelete.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14496.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-14494.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file deletion of sdelete64.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10148.png', 'ScreenshotCaption': 'deted a file - sdelete64.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The event was correlated to parent alert on New Windows Service Created.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11094.png', 'ScreenshotCaption': 'file deletion  event for sdelete64 (command prompt is what is causing  the delete)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed deletion of sdelete64.exe. The event was correlated to a parent alerts of a suspicious python.exe process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1781.png', 'ScreenshotCaption': '9.c.4 - sdelete deleted via cmd.exe'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "file deletion T1107" was generated when cmd.exe deleted sdelete.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13664.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the deletion of SDelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13230.png', 'ScreenshotCaption': '9.C.1, 9.C.2, 9.C.3, 9.C.4 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3089.png', 'ScreenshotCaption': 'Telemetry showing cmd.exe deleting sdelete64.exe.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "File Deletion" was generated when cmd.exe used to delete sdelete64.exe. The detection was correlated to a parent alert for powershell.exe compressing data.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'syoder-1-RQ-9.C.1-T1107-1.png', 'ScreenshotCaption': 'all file deletes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe deleting sdelete64.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "executing a deletion" occurred containing evidence of cmd.exe being run to delete sdelete64.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12840.png', 'ScreenshotCaption': 'MSSP - C1 - sdelete'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file deletion event on "Windows Command Processor" deleting sdelete64.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6766.png', 'ScreenshotCaption': 'C4 - "Windows Command Processor" removing Temp/sdelete64.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe deleting sdelete64.exe. Processing was triggered by human action and not initiated automatically.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17698.png', 'ScreenshotCaption': '9c4 - telem - delayed'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13950.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-13951.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed cmd.exe deleting sdelete64.exe and filemod(delete) event. The detection was correlated to a parent alert on psexesvc.exe for service execution.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4079.png', 'ScreenshotCaption': 'deleted sdelete'}], 'Footnotes': []}]}]}]}, {'Substep': '10.A.1', 'Procedure': 'Executed persistent service (javamtsup) on system startup', 'Criteria': 'javamtsup.exe spawning from services.exe', 'Techniques': [{'TechniqueId': 'T1035', 'TechniqueName': 'Service Execution', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Service Execution" was generated when services.exe spawned javamtsup.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2267.png', 'ScreenshotCaption': 'javamtsup execution by services.exe, with enrichments. '}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of javamtsup.exe spawning from services.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12574.png', 'ScreenshotCaption': '10.a.1 mssp report #2'}, {'ScreenshotName': 'Kaspersky-APT29-12573.png', 'ScreenshotCaption': '10.a.1 mssp report #1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed javamtsup.exe with parent process services.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-2982.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['This activity would have been blocked by Microsoft Defender.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed javamtsup.exe with the parent process services.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-159.png', 'ScreenshotCaption': 'javamtsup child of services'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the javamtsup.exe processes executing as a persistent service.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13761.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13762.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "ProcessCreationExtra" was generated when services.exe executed javamtsup.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14736.png', 'ScreenshotCaption': '10.A.1 - Execution of javamtsup.exe by services.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1035" occurred containing evidence of javamtsup.exe with parent process services.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12841.png', 'ScreenshotCaption': 'MSSP - A1 - process tree'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed javamtsup.exe with parent process services.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6770.png', 'ScreenshotCaption': 'A1 - javamtsup.exe with parent process services.exe via process tree flow'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for services.exe accessing javamtsup.exe. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12682.png', 'ScreenshotCaption': 'MSSP - 8C1 - 10A1 - 10B1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed  javamtsup.exe with parent process services.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12251.png', 'ScreenshotCaption': 'raw data - services > svchost'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe with a parent process of javamtsup.exe (identified as being spawned from services.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4101.png', 'ScreenshotCaption': 'execution through API alert'}], 'Footnotes': []}]}]}]}, {'Substep': '10.B.1', 'Procedure': 'Executed LNK payload (hostui.lnk) in Startup Folder on user login', 'Criteria': 'Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder', 'Techniques': [{'TechniqueId': 'T1060', 'TechniqueName': 'Registry Run Keys / Startup Folder', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hostui.lnk executing from the Startup Folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10552.png', 'ScreenshotCaption': 'Telemetry showing hostui.lnk executing from the startup folder and launch cmd to spawn hostui.bat.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Registry Run Keys / Startup Folder" occurred containing evidence of hostui.lnk executing from Startup Folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10781.png', 'ScreenshotCaption': 'MSSP - b1 - .lnk in startup folder'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1343.png', 'ScreenshotCaption': 'hostui.bat '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11284.png', 'ScreenshotCaption': '10.B.1 - Audit Viewer for explorer.exe spawning cmd.exe to run hostui.bat'}, {'ScreenshotName': 'FireEye-APT29-11259.png', 'ScreenshotCaption': '10.B.1 - explorer.exe spawning cmd.exe to run hostui.bat'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11100.png', 'ScreenshotCaption': 'explorer launching cmd.exe to launch .bat. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2541.png', 'ScreenshotCaption': 'process tree - host.exe'}], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['This activity would have been blocked by Microsoft Defender.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for hostui.lnk executing from Startup Folder. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13232.png', 'ScreenshotCaption': '10.B.1 - MSSP'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hostui.bat executing from a persistent Startup Menu shortcut.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13763.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "StartedFromLnk" under "Registry Run Keys / Startup Folder {T1060}" was generated due to hostui.lnk triggering on login from the StartUp Folder.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7243.png', 'ScreenshotCaption': 'CC - B1 - hostui.lnk in startup folder - StartedFromLnk indicator'}], 'Footnotes': ['A Detection Configuration Change was made to capture .lnk files triggering on login from the StartUp folder. Aligned usage with "StartedFromLnk" under "Registry Run Keys / Startup Folder {T1060}".']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "startup persistence" occurred containing evidence of hostui.lnk executing from Startup Folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12842.png', 'ScreenshotCaption': 'MSSP - B1 - .lnk '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hostui.lnk executing from the Startup Folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7243.png', 'ScreenshotCaption': 'CC - B1 - hostui.lnk in startup folder - StartedFromLnk indicator'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7495.png', 'ScreenshotCaption': 'explorer launched cmd.exe to run hostui.bat'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for hostui.lnk executing from Startup Folder. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12682.png', 'ScreenshotCaption': 'MSSP - 8C1 - 10A1 - 10B1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hostui.lnk executing from the Startup Folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12042.png', 'ScreenshotCaption': 'b1 - hostui.lnk from startup'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13953.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '10.B.2', 'Procedure': 'Executed PowerShell payload via the CreateProcessWithToken API', 'Criteria': 'hostui.exe executing the\nCreateProcessWithToken API', 'Techniques': [{'TechniqueId': 'T1106', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a process created with CreateProcessWithToken.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-790.png', 'ScreenshotCaption': 'caption update here'}, {'ScreenshotName': 'Bitdefender-APT29-795.png', 'ScreenshotCaption': 'another caption update'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9674.png', 'ScreenshotCaption': '10.b.2 - creation from svchostexe process '}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hostui.exe executing powershell.exe via CreateProcessWithTokenW. This event was correlated to a General detection for the execution of a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1345.png', 'ScreenshotCaption': 'hostui createprocesswithtokenW'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10173.png', 'ScreenshotCaption': 'seclogon'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1800.png', 'ScreenshotCaption': 'svchost to ps tree'}, {'ScreenshotName': 'McAfee-APT29-1793.png', 'ScreenshotCaption': '10.b.2 - svchost with seclogon'}], 'Footnotes': ['MVISION Endpoint would have blocked this activity. ']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-570.png', 'ScreenshotCaption': 'Telemetry showing  powershell.exe spawning from svchost.exe -k netsvcs -p seclogon, which is a result of CreateProcessWithToken'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13233.png', 'ScreenshotCaption': '10.B.3 - MSSP'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-7498.png', 'ScreenshotCaption': 'services.exe launched svchost.exe with seclogon command line parameters'}, {'ScreenshotName': 'Symantec-APT29-7499.png', 'ScreenshotCaption': 'sequence of process creation.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "Noteworthy Behavior T1134" was generated for token manipulation with the low level ZwDuplicateToken (NtDuplicateToken) API, which is invoked by the CreateProcessWithToken API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12039.png', 'ScreenshotCaption': '10.B.3. - Access Token Manipulation for ZwDuplicateToken API'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed svchost.exe interacting with powershell.exe via OpenProcess.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13954.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '10.B.3', 'Procedure': 'Manipulated the token of the PowerShell payload via the CreateProcessWithToken API', 'Criteria': 'hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe', 'Techniques': [{'TechniqueId': 'T1134', 'TechniqueName': 'Access Token Manipulation', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) was generated for PowerShell being identified as having fake parent process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-791.png', 'ScreenshotCaption': 'more stuff here'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a process created with CreateProcessWithToken.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-795.png', 'ScreenshotCaption': 'another caption update'}, {'ScreenshotName': 'Bitdefender-APT29-790.png', 'ScreenshotCaption': 'caption update here'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Access Token Manipulation" was generated for token stealing activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10557.png', 'ScreenshotCaption': 'Technique detection for access token manipulation tied to the powershell.exe in process tree.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing with the same token (identified by the AuthenticationID) as explorer.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10562.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing with explorer.exe token.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Access Token Manipulation" was generated when hostui.exe created a powershell.exe process with the CreateProcessWithToken WinAPI function.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2269.png', 'ScreenshotCaption': 'hostui.exe executing from powershell.exe. Because token changed, got Access Token Manipulation enrichment'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called was generated for a mismatch between the parent and creator process on PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9675.png', 'ScreenshotCaption': '10.b.2 - evidence of powershell process'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed hostui.exe manipulating powershell.exe token via CreateProcessWithTokenW and that the authentication ID was that of explorer.exe. This event was correlated to a General detection for the execution of a malicious file. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1345.png', 'ScreenshotCaption': 'hostui createprocesswithtokenW'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Access Token Manipulation" was generated for thread impersonation.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3102.png', 'ScreenshotCaption': '3 - createprocesswithtoken discussion'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3110.png', 'ScreenshotCaption': '3 - createprocesswithtoken discussion'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3103.png', 'ScreenshotCaption': '3 - createprocesswithtoken discussion'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13233.png', 'ScreenshotCaption': '10.B.3 - MSSP'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "TokenMismatch" under "Privilege Escalation {T1134}" was generated when the parent process\'s, hostui.exe, token did not match the child token process\'s, powershell.exe, token. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6772.png', 'ScreenshotCaption': 'B2/3 - hostui.exe executing powershell. Token mismatch alert'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry shows powershell.exe's security_descriptor obtaining the same value as explorer.exe.", 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17702.png', 'ScreenshotCaption': '10b3 - telemetry on powershell security descriptor manipulation'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "Noteworthy Behavior T1134" was generated for token manipulation with the low level ZwDuplicateToken (NtDuplicateToken) API, which is invoked by the CreateProcessWithToken API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12039.png', 'ScreenshotCaption': '10.B.3. - Access Token Manipulation for ZwDuplicateToken API'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '11.A.1', 'Procedure': 'User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk', 'Criteria': 'powershell.exe spawning from explorer.exe', 'Techniques': [{'TechniqueId': 'T1204', 'TechniqueName': 'User Execution', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identifying the powershell.exe process as malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-799.png', 'ScreenshotCaption': 'alerts on powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe spawning powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-801.png', 'ScreenshotCaption': 'Get-Content 2016 Election (no IEX)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10567.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe executing powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) for "User Execution" was generated when the .lnk file was executed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2417.png', 'ScreenshotCaption': 'Execution of LNK with enrichments'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated identifying explorer.exe executing powershell.exe as threat activity. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2279.png', 'ScreenshotCaption': 'CyCarrier Raw Data: Threat Activity alert for initial powershell execution'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "User Execution" was received that described the user executing 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk to launch powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12473.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, executed powershell'}, {'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for malicious use of powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9685.png', 'ScreenshotCaption': '11.a.1 - process tree spawning powershell, malops'}, {'ScreenshotName': 'Cybereason-APT29-9687.png', 'ScreenshotCaption': '11.a.1/2 - get-content '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe spawning powershell.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Fileless Powershell Malware" was generated due to PowerShell invoking a script in a temporary directory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12053.png', 'ScreenshotCaption': 'A1/2 - High alert for fileless powershell malware showing explorer.exe executing powershell executing get-content via IEX'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for "Suspicious Windows Script from Parent Process" for explorer.exe executing powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1352.png', 'ScreenshotCaption': 'Resolver view of suspicious windows script from parent process -- shows explorer starting powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1354.png', 'ScreenshotCaption': 'showing the get content commandline in powershell'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11304.png', 'ScreenshotCaption': 'MSSP - lnk file details '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10228.png', 'ScreenshotCaption': 'explorer launching powershell'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13023.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11346.png', 'ScreenshotCaption': '11.A - PowerShell Get-Content Command with schemas IEX'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17445.png', 'ScreenshotCaption': '11A1, 11A2: Telemetry showing explorer.exe spawning powershell.exe. Includes powershell command line arguments.'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (warning severity) was generated for "Suspicious Powershell Commandline".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3701.png', 'ScreenshotCaption': '11.A - Explorer.exe spawning PowerShell alert'}, {'ScreenshotName': 'HanSight-APT29-3699.png', 'ScreenshotCaption': '11.A - PowerShell execution of schemas ADS with parent explorer.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3701.png', 'ScreenshotCaption': '11.A - Explorer.exe spawning PowerShell alert'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow tag) called "User Execution" was generated due to the execution of powershell.exe from explorer.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3118.png', 'ScreenshotCaption': '11.a.2 - ps exec schemas ads'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe spawning powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-13802.png', 'ScreenshotCaption': '11a12 - vendor pic PS tag - technique'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2557.png', 'ScreenshotCaption': 'Execution with get-content (11a1 and 2)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1814.png', 'ScreenshotCaption': '11.a.1 explorer launches powershell'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for a "Suspicious Powershell commandline."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-464.png', 'ScreenshotCaption': 'General detection for Suspicious Powershell commandline (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Execution" was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1137.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Persistence and Execution (2 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-1136.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Persistence and Execution (1 of 3)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-464.png', 'ScreenshotCaption': 'General detection for Suspicious Powershell commandline (1 of 2)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3125.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe executing powershell.exe.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13234.png', 'ScreenshotCaption': '11.A.1, 11.A.2, 11.A.12 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3125.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe executing powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-166.png', 'ScreenshotCaption': 'alert on powershell, and certutil and get-content in command line'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Execution - User Execution" occurred containing evidence of  explorer.exe executing powershell.exe (Get-Content…).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13764.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6929.png', 'ScreenshotCaption': '11.a.1/2/12 - process tree'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called "ProcessCreationExtra" was generated when explorer.exe executed powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14963.png', 'ScreenshotCaption': '11.A.1 - Execution for explorer.exe spawning powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for a suspicious powershell.exe process spawning. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6787.png', 'ScreenshotCaption': 'A1 - True context start point'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1204" occurred containing evidence of powershell.exe execution targeting .lnk payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12843.png', 'ScreenshotCaption': 'MSSP - A1/2 - powershell and SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6783.png', 'ScreenshotCaption': 'A1 - Process tree showing explorer.exe executing  powershell calling Get-Content'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Execution" was generated when explorer.exe executed powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17704.png', 'ScreenshotCaption': '11a1- better tactic SS'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9704.png', 'ScreenshotCaption': 'explorer.exe launched powershell.exe with ADS reader. Shows the decoded output.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12060.png', 'ScreenshotCaption': 'a1 - exploreer > PS - RCA'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for the execution of powershell.exe from explorer.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4112.png', 'ScreenshotCaption': 'Get-Content Powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed explorer.exe spawning powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4112.png', 'ScreenshotCaption': 'Get-Content Powershell'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.2', 'Procedure': 'Executed an alternate data stream (ADS) using PowerShell', 'Criteria': 'powershell.exe executing the schemas ADS via Get-Content and IEX', 'Techniques': [{'TechniqueId': 'T1096', 'TechniqueName': 'NTFS File Attributes', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-801.png', 'ScreenshotCaption': 'Get-Content 2016 Election (no IEX)'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10569.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing schemas ADS via Get-Content and IEX.'}, {'ScreenshotName': 'CrowdStrike-APT29-10568.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing schemas ADS via Get-Content and IEX.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) was generated NTFS File Attributes for 2016_UNITED_STATES_PRESEDENTIAL_ELECTION_-_WIKIPEDIA.HTML:SCHEMAS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14981.png', 'ScreenshotCaption': '11a2-vendor submitted screenshot'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated identifying powershell.exe executing the schemas ADS with Get-Content and IEX as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2432.png', 'ScreenshotCaption': 'powershell get-content of html file'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "NTFS File Attributes" was received that described a PowerShell script reading another script from the schemas Alternate Data Stream in 2016_United_States_presidential_election_-_Wikipedia.html and executing it via IEX.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9689.png', 'ScreenshotCaption': '11.a.2 - commandline, schemas, etc. from process tree'}, {'ScreenshotName': 'Cybereason-APT29-9687.png', 'ScreenshotCaption': '11.a.1/2 - get-content '}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity) called "Fileless Powershell Malware" was generated due to PowerShell executing a paylaod with IEX and Get-Content.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12053.png', 'ScreenshotCaption': 'A1/2 - High alert for fileless powershell malware showing explorer.exe executing powershell executing get-content via IEX'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "Suspicious Read from Alternate Data Streams (ADS)" was generated for powershell.exe accessing an NTFS ADS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1381.png', 'ScreenshotCaption': 'suspicisos read from ADS alert with enrichment expanded. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1354.png', 'ScreenshotCaption': 'showing the get content commandline in powershell'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) was generated due to PowerShell running a script from an ADS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10230.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing schemas ADS via Get-Content and IEX.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11305.png', 'ScreenshotCaption': 'MSSP - lnk being executed with iex/schemas'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10223.png', 'ScreenshotCaption': 'thp get-content '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "ADS Code Exec (Methodology)" was generated due to PowerShell\'s use of command-line arguments associated with executing alternate data streams.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11347.png', 'ScreenshotCaption': '11.A.2 - ADS Code Exec for schemas stream'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': "A General alert detection was generated for suspicious usage of PowerShell's Get-Content command.", 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11346.png', 'ScreenshotCaption': '11.A - PowerShell Get-Content Command with schemas IEX'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13020.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "NTFS File Attributes" was generated due to PowerShell executing the schemas ADS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17445.png', 'ScreenshotCaption': '11A1, 11A2: Telemetry showing explorer.exe spawning powershell.exe. Includes powershell command line arguments.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17445.png', 'ScreenshotCaption': '11A1, 11A2: Telemetry showing explorer.exe spawning powershell.exe. Includes powershell command line arguments.'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (warning severity) called "Suspicious Powershell Commandline" was generated for powershell.exe executing the schemas ADS via Get-Content and IEX.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3699.png', 'ScreenshotCaption': '11.A - PowerShell execution of schemas ADS with parent explorer.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; medium severity) called NTFS File Attributes was generated due to execution of schemas ADS by powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3118.png', 'ScreenshotCaption': '11.a.2 - ps exec schemas ads'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12375.png', 'ScreenshotCaption': '11.a.2 - MSSP report #4'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3118.png', 'ScreenshotCaption': '11.a.2 - ps exec schemas ads'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2557.png', 'ScreenshotCaption': 'Execution with get-content (11a1 and 2)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "NTFS File Attributes" was generated due to execution of schemas ADS by powershell.exe.\n', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-2006.png', 'ScreenshotCaption': 'CC 11.a.2 NTFS file atrribs #2'}], 'Footnotes': ['The vendor added a new detection for the technique.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1817.png', 'ScreenshotCaption': 'ps ads schemas - historical search'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for a "Suspicious Powershell commandline."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-464.png', 'ScreenshotCaption': 'General detection for Suspicious Powershell commandline (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-464.png', 'ScreenshotCaption': 'General detection for Suspicious Powershell commandline (1 of 2)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13234.png', 'ScreenshotCaption': '11.A.1, 11.A.2, 11.A.12 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3126.png', 'ScreenshotCaption': 'Telemetry showing explorer.exe executing powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-286.png', 'ScreenshotCaption': 'cc - get content schemas / iex - not for a1'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Defense Evasion - NTFS File Attributes" occurred containing evidence of PowerShell executing schemas ADS via Get-Content and IEX.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6929.png', 'ScreenshotCaption': '11.a.1/2/12 - process tree'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1096" occurred containing evidence of powershell.exe executing schemas ADS via Get-Content and IEX.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12843.png', 'ScreenshotCaption': 'MSSP - A1/2 - powershell and SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6785.png', 'ScreenshotCaption': 'A1/2 - Process tree showing explorer.exe executing  powershell calling Get-Content'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "NTFS File Attributes"  was received that included the PowerShell command used by the adversary and explained that it was used to retrieve the PowerShell script from the schemas Alternate Data Stream and execute it.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12947.png', 'ScreenshotCaption': 'MSSP Day 1: NTFS File Attributes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9697.png', 'ScreenshotCaption': 'powershell.exe obtaining the script from the Alternate Data Stream and executing it.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "NTFS File Attributes" was generated due to PowerShell executing the schemas ADS. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12062.png', 'ScreenshotCaption': 'a2  - ntfs alert '}, {'ScreenshotName': 'TrendMicro-APT29-12064.png', 'ScreenshotCaption': '2/12 - RCA view html > schemas '}, {'ScreenshotName': 'TrendMicro-APT29-12063.png', 'ScreenshotCaption': 'a2 - ntfs alt data stream alert - RCA view'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell accessing Alternative Data Streams (ADS) and executing its content. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12049.png', 'ScreenshotCaption': 'a1/2/12 - raw data - get-content; PS>explorer; schemas/IEX '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for the use of PowerShell executing with Invoke-Expression. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4113.png', 'ScreenshotCaption': 'alerts'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4112.png', 'ScreenshotCaption': 'Get-Content Powershell'}, {'ScreenshotName': 'Carbon Black-APT29-4162.png', 'ScreenshotCaption': 'get-content IEX'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.3', 'Procedure': 'Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell', 'Criteria': 'powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS', 'Techniques': [{'TechniqueId': 'T1497', 'TechniqueName': 'Virtualization/Sandbox Evasion', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for getting the BIOS version via Windows Management Instrumentation.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1090.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.', 'PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Virtualization/Sandbox Evasion" was generated for the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2419.png', 'ScreenshotCaption': 'Powershell wmi query of bios with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Virtualization/Sandbox Evasion" was received that included a PowerShell script and explained that it was used to check for virtualization.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12475.png', 'ScreenshotCaption': '11.A.3 - MDR Report Day 2, virtualization'}, {'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) for a WMI query operation via PowerShell was generated for a PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12051.png', 'ScreenshotCaption': 'A3/4 - Medium alert for GWMI query on  wmi query for win32_bios '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) called "Reconnaissance of Multiple WMI Classes" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1364.png', 'ScreenshotCaption': 'alert for multiple wmi discovery techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1358.png', 'ScreenshotCaption': 'bios wmi event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11306.png', 'ScreenshotCaption': 'MSSP - enumeration - bios, pnpentity, computer system, process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10234.png', 'ScreenshotCaption': '11a3-8 - thp - wmi stuff'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13023.png', 'ScreenshotCaption': 'MSSP - 11.A'}, {'ScreenshotName': 'FireEye-APT29-13024.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11343.png', 'ScreenshotCaption': '11.A - gwmi query for Win32_BIOS'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3720.png', 'ScreenshotCaption': '11.A - gwmi query for Win32_BIOS'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18009.png', 'ScreenshotCaption': 'new mssp 11a3 and 11a4'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': "An MSSP detection for Discovery was generated containing evidence PowerShell ran command to check BIOS version\nand serial numbers gwmi -namespace root\\cimv2\n-query 'SELECT * FROM Win32_BIOS'.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1141.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (3 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1140.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (2 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1139.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (1 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-469.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with various PowerShell gwmi queries'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "System Information Discovery" was generated for a PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3129.png', 'ScreenshotCaption': 'A technique detection showing system information discovery for gwmi queries for win32_BIOS.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13236.png', 'ScreenshotCaption': '11.A.3, 11.A.4, 11.A.5, 11.A.6, 11.A.7, 11.A.8 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-287.png', 'ScreenshotCaption': 'cc - 11.3 - bios'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "WMI Queries Win32_Bios" was generated for a PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6931.png', 'ScreenshotCaption': '11.a3/4 alert details'}, {'ScreenshotName': 'SecureWorks-APT29-6934.png', 'ScreenshotCaption': '11.a.3/4 - correlated pid, might not need'}, {'ScreenshotName': 'SecureWorks-APT29-6932.png', 'ScreenshotCaption': '11.a.3/4 alert details - technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-6933.png', 'ScreenshotCaption': '11.a.3/4 - raw event details with the operation/line'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - Virtualization/Sandbox Evasion" occurred for the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17607.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17610.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17607.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection for "Discovery" under "SuspiciousWMIQuery" was generated on a suspicious WMI query targeting Win32_BIOS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6791.png', 'ScreenshotCaption': 'A3/4 - WMI win32_bios '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1497" occurred containing evidence of WMI query targeting Win32_BIOS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12844.png', 'ScreenshotCaption': 'MSSP - bios and computer system'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Virtualization/Sandbox Evasion" was received that included a PowerShell command executed by the adversary and explained that it was used to query BIOS information.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12949.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery description'}, {'ScreenshotName': 'Symantec-APT29-12948.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery Techniques'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing Win32_BIOS. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12071.png', 'ScreenshotCaption': '3/4/5/6/7 - gwmi queries - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4163.png', 'ScreenshotCaption': 'Win32_BIOS'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.4', 'Procedure': 'Enumerated computer manufacturer, model, and version information using PowerShell', 'Criteria': 'powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem', 'Techniques': [{'TechniqueId': 'T1082', 'TechniqueName': 'System Information Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for execution of a WMI system discovery command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-811.png', 'ScreenshotCaption': 'incident with IEX with att&ck techniques'}, {'ScreenshotName': 'Bitdefender-APT29-798.png', 'ScreenshotCaption': 'alerts on powershell'}, {'ScreenshotName': 'Bitdefender-APT29-809.png', 'ScreenshotCaption': 'computer system 11.a.4'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for getting the BIOS version via Windows Management Instrumentation.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1090.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.', 'Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identifying the PowerShell gwmi queries for Win32_ComputerSystem as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2421.png', 'ScreenshotCaption': 'Powershell wmi query of computersystem with enrichments'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identifying the PowerShell gwmi query for Win32_BIOS as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2421.png', 'ScreenshotCaption': 'Powershell wmi query of computersystem with enrichments'}, {'ScreenshotName': 'CyCraft-APT29-2419.png', 'ScreenshotCaption': 'Powershell wmi query of bios with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Information Discovery" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12476.png', 'ScreenshotCaption': '11.A.4 - MDR Report Day 2, Win32_computersystem'}, {'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) for WMI query operations via PowerShell was generated for a PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12051.png', 'ScreenshotCaption': 'A3/4 - Medium alert for GWMI query on  wmi query for win32_bios '}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) for WMI query operations via PowerShell was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12054.png', 'ScreenshotCaption': 'A4/6/7 - Medium alert for GWMI query on wmi query for win32_computer system'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ATT&CK T1082 System Info Discovery" was generated for powershell.exe querying Win32_ComputerSystem and Win32_BIOS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1362.png', 'ScreenshotCaption': 'win32 computersystem wmi event  (sys info enrichment)'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) called "Reconnaissance of Multiple WMI Classes"  was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1364.png', 'ScreenshotCaption': 'alert for multiple wmi discovery techniques'}, {'ScreenshotName': 'Elastic-APT29-1364.png', 'ScreenshotCaption': 'alert for multiple wmi discovery techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1358.png', 'ScreenshotCaption': 'bios wmi event'}, {'ScreenshotName': 'Elastic-APT29-1361.png', 'ScreenshotCaption': 'win32 computersystem wmi event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11306.png', 'ScreenshotCaption': 'MSSP - enumeration - bios, pnpentity, computer system, process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10234.png', 'ScreenshotCaption': '11a3-8 - thp - wmi stuff'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13023.png', 'ScreenshotCaption': 'MSSP - 11.A'}, {'ScreenshotName': 'FireEye-APT29-13024.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11389.png', 'ScreenshotCaption': '11.A - gwmi query for Win32_ComputerSystem'}, {'ScreenshotName': 'FireEye-APT29-11343.png', 'ScreenshotCaption': '11.A - gwmi query for Win32_BIOS'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Get System Information" was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4210.png', 'ScreenshotCaption': 'CC - 11.A.4 - Get System Information'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3721.png', 'ScreenshotCaption': '11.A - gwmi for Win32_ComputerSystem'}, {'ScreenshotName': 'HanSight-APT29-3720.png', 'ScreenshotCaption': '11.A - gwmi query for Win32_BIOS'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18009.png', 'ScreenshotCaption': 'new mssp 11a3 and 11a4'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Discovery was generated containing evidence PowerShell ran commands to check BIOS version and obtain system information.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1141.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (3 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1139.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (1 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1140.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (2 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-469.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with various PowerShell gwmi queries'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "System Information Discovery" was generated for a PowerShell gwmi query for Win32_BIOS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3129.png', 'ScreenshotCaption': 'A technique detection showing system information discovery for gwmi queries for win32_BIOS.'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3132.png', 'ScreenshotCaption': '4/6/7 - win32_computersystem'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3132.png', 'ScreenshotCaption': '4/6/7 - win32_computersystem'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13236.png', 'ScreenshotCaption': '11.A.3, 11.A.4, 11.A.5, 11.A.6, 11.A.7, 11.A.8 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13687.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-287.png', 'ScreenshotCaption': 'cc - 11.3 - bios'}, {'ScreenshotName': 'ReaQta-APT29-289.png', 'ScreenshotCaption': 'cc - computer system'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "WMI Queries Win32_Bios" was generated due to PowerShell gwmi queries for Win32_BIOS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6934.png', 'ScreenshotCaption': '11.a.3/4 - correlated pid, might not need'}, {'ScreenshotName': 'SecureWorks-APT29-6931.png', 'ScreenshotCaption': '11.a3/4 alert details'}, {'ScreenshotName': 'SecureWorks-APT29-6933.png', 'ScreenshotCaption': '11.a.3/4 - raw event details with the operation/line'}, {'ScreenshotName': 'SecureWorks-APT29-6932.png', 'ScreenshotCaption': '11.a.3/4 alert details - technique mappings'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "WMI Queries Win32_ComputerSystem" was generated due to PowerShell gwmi queries for Win32_ComputerSystem .', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6944.png', 'ScreenshotCaption': '11.a.4/6/7  - technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-6945.png', 'ScreenshotCaption': '11.a.4/6/7 - more details with the client process id'}, {'ScreenshotName': 'SecureWorks-APT29-6943.png', 'ScreenshotCaption': '11.a.4/6/7 - alert details'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - System Information Discovery" occurred for the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17611.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17612.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17610.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17607.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection for "Discovery" was generated on a suspicious WMI query targeting Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6793.png', 'ScreenshotCaption': 'A4/6/7 - WMI win32_computer system'}, {'ScreenshotName': 'SentinelOne-APT29-6791.png', 'ScreenshotCaption': 'A3/4 - WMI win32_bios '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1082" occurred containing evidence of WMI query targeting Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12844.png', 'ScreenshotCaption': 'MSSP - bios and computer system'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Information Discovery" was received that included a PowerShell command executed by the adversary and explained that it was used to collect information about the local system.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12949.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery description'}, {'ScreenshotName': 'Symantec-APT29-12948.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery Techniques'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12071.png', 'ScreenshotCaption': '3/4/5/6/7 - gwmi queries - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4165.png', 'ScreenshotCaption': 'computersystem'}, {'ScreenshotName': 'Carbon Black-APT29-4163.png', 'ScreenshotCaption': 'Win32_BIOS'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.5', 'Procedure': 'Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell', 'Criteria': 'powershell.exe executing a Get-WmiObject query for Win32_PnPEntity', 'Techniques': [{'TechniqueId': 'T1120', 'TechniqueName': 'Peripheral Device Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for getting the plug and play devices via Windows Management Instrumentation.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1093.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.', 'Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identifying a PowerShell gwmi query for Win32_PnPEntity as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2423.png', 'ScreenshotCaption': 'Powershell wmi query of pnpentity with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Peripheral Device Discovery" was received that included a PowerShell script and explained that it was used to query Win32_PnPEntity via WMI.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12477.png', 'ScreenshotCaption': '11.A.5 - MDR Report Day 2, Win32_PnPEntity'}, {'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) for WMI query operations via PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12055.png', 'ScreenshotCaption': 'A5/6 - Medium alert for GWMI query on win32_pnp entity'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1363.png', 'ScreenshotCaption': 'win32 pnpentity wmi event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11306.png', 'ScreenshotCaption': 'MSSP - enumeration - bios, pnpentity, computer system, process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10234.png', 'ScreenshotCaption': '11a3-8 - thp - wmi stuff'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13024.png', 'ScreenshotCaption': 'MSSP - 11.A'}, {'ScreenshotName': 'FireEye-APT29-13023.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11390.png', 'ScreenshotCaption': '11.A.5 - gwmi query for Win32_PnPEntity'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (reminder severity) called "Peripheral Device Discovery" was generated for a PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4212.png', 'ScreenshotCaption': 'CC - 11.A.5 - Peripheral Device Discovery'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3722.png', 'ScreenshotCaption': '11.A - gwmi for Win32_PnPEntity'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence for the execution of an WMI query for Win32_PnPEntity.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12376.png', 'ScreenshotCaption': '11.a.3-5 MSSP report'}, {'ScreenshotName': 'Kaspersky-APT29-12376.png', 'ScreenshotCaption': '11.a.3-5 MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': "An MSSP detection for Discovery was generated  containing evidence PowerShell ran commands to pull properties of Plug and Play devices: gwmi -namespace root\\cimv2 -query 'SELECT * FROM Win32_PnPEntity'.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1141.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (3 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1139.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (1 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1140.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (2 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-469.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with various PowerShell gwmi queries'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence execution of an WMI query for Win32_PnPEntity.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13236.png', 'ScreenshotCaption': '11.A.3, 11.A.4, 11.A.5, 11.A.6, 11.A.7, 11.A.8 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13686.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-288.png', 'ScreenshotCaption': 'cc - periferal device'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (info severity) called "WMI Queries Win32_PnPEntity" was generated due to the WMI query for Win32_PnPEntity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6935.png', 'ScreenshotCaption': '11.a.5 - alert details win32pnpentity'}, {'ScreenshotName': 'SecureWorks-APT29-6937.png', 'ScreenshotCaption': '11.a.5 event details'}, {'ScreenshotName': 'SecureWorks-APT29-6936.png', 'ScreenshotCaption': '11.a.5 - technique mappings'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - Peripheral Device Discovery" occurred for the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17625.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17626.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "SuspiciousWMIQuery" under "{T1120}" (Peripheral Device Discovery) was generated due to a suspicious WMI query for Win32_PnPEntity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6792.png', 'ScreenshotCaption': 'A5 - WMI win32_pnpEntity'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1120" occurred containing evidence of WMI query targeting Win32_PnPEntity.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12845.png', 'ScreenshotCaption': 'MSSP - pnp, process enumeration, win32_process, file enumeration'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Peripheral Device Discovery" was received that included a PowerShell command executed by the adversary and explained that it was used to enumerate Plug and Play devices.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12949.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery description'}, {'ScreenshotName': 'Symantec-APT29-12948.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery Techniques'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing Win32_PnPEntity. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12071.png', 'ScreenshotCaption': '3/4/5/6/7 - gwmi queries - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4164.png', 'ScreenshotCaption': 'n32_pnPEntitty'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.6', 'Procedure': 'Checked that the username is not related to admin or a generic value (ex: user) using PowerShell', 'Criteria': 'powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem', 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for the execution of a WMI system discovery command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-809.png', 'ScreenshotCaption': 'computer system 11.a.4'}, {'ScreenshotName': 'Bitdefender-APT29-811.png', 'ScreenshotCaption': 'incident with IEX with att&ck techniques'}, {'ScreenshotName': 'Bitdefender-APT29-798.png', 'ScreenshotCaption': 'alerts on powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identying a PowerShell gwmi query for Win32_ComputerSystem as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2421.png', 'ScreenshotCaption': 'Powershell wmi query of computersystem with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Owner/User Discovery" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12476.png', 'ScreenshotCaption': '11.A.4 - MDR Report Day 2, Win32_computersystem'}, {'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) for a suspicious WMI query operation was generated for a WMI operation via PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12054.png', 'ScreenshotCaption': 'A4/6/7 - Medium alert for GWMI query on wmi query for win32_computer system'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) called "Reconnaissance of Multiple WMI Classes" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1364.png', 'ScreenshotCaption': 'alert for multiple wmi discovery techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1361.png', 'ScreenshotCaption': 'win32 computersystem wmi event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11306.png', 'ScreenshotCaption': 'MSSP - enumeration - bios, pnpentity, computer system, process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10234.png', 'ScreenshotCaption': '11a3-8 - thp - wmi stuff'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13024.png', 'ScreenshotCaption': 'MSSP - 11.A'}, {'ScreenshotName': 'FireEye-APT29-13023.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11389.png', 'ScreenshotCaption': '11.A - gwmi query for Win32_ComputerSystem'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.\n', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (warning severity) called "Get System Information" was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4210.png', 'ScreenshotCaption': 'CC - 11.A.4 - Get System Information'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3721.png', 'ScreenshotCaption': '11.A - gwmi for Win32_ComputerSystem'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18010.png', 'ScreenshotCaption': 'new mssp 11a5-7'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': "An MSSP detection for Discovery was generated containing evidence PowerShell ran commands to obtain system information: gwmi -namespace root\\cimv2 -query 'Select * from Win32_ComputerSystem'.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1140.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (2 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1139.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (1 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1141.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (3 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-469.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with various PowerShell gwmi queries'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3132.png', 'ScreenshotCaption': '4/6/7 - win32_computersystem'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3132.png', 'ScreenshotCaption': '4/6/7 - win32_computersystem'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13236.png', 'ScreenshotCaption': '11.A.3, 11.A.4, 11.A.5, 11.A.6, 11.A.7, 11.A.8 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13687.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-289.png', 'ScreenshotCaption': 'cc - computer system'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "WMI Queries Win32_ComputerSystem" was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6943.png', 'ScreenshotCaption': '11.a.4/6/7 - alert details'}, {'ScreenshotName': 'SecureWorks-APT29-6945.png', 'ScreenshotCaption': '11.a.4/6/7 - more details with the client process id'}, {'ScreenshotName': 'SecureWorks-APT29-6944.png', 'ScreenshotCaption': '11.a.4/6/7  - technique mappings'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - System Owner/User Discovery" occurred for the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17612.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17611.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection for "Discovery" was generated on a suspicious WMI query targeting Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6793.png', 'ScreenshotCaption': 'A4/6/7 - WMI win32_computer system'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "information discovery" occurred containing evidence of WMI query targeting Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12845.png', 'ScreenshotCaption': 'MSSP - pnp, process enumeration, win32_process, file enumeration'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17530.png', 'ScreenshotCaption': '11.A.7 - WMIOperation for Win32_ComputerSystem'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Owner/User Discovery" was received that included a PowerShell command executed by the adversary and explained that it was used to query the system owner.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12948.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12949.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery description'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing Win32_ComputerSystem. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12071.png', 'ScreenshotCaption': '3/4/5/6/7 - gwmi queries - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4165.png', 'ScreenshotCaption': 'computersystem'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.7', 'Procedure': 'Checked that the computer is joined to a domain using PowerShell', 'Criteria': 'powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem', 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for the execution of a WMI system discovery command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-809.png', 'ScreenshotCaption': 'computer system 11.a.4'}, {'ScreenshotName': 'Bitdefender-APT29-798.png', 'ScreenshotCaption': 'alerts on powershell'}, {'ScreenshotName': 'Bitdefender-APT29-811.png', 'ScreenshotCaption': 'incident with IEX with att&ck techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identying a PowerShell gwmi query for Win32_ComputerSystem as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2421.png', 'ScreenshotCaption': 'Powershell wmi query of computersystem with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Network Configuration Discovery" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}, {'ScreenshotName': 'CyCraft-APT29-12476.png', 'ScreenshotCaption': '11.A.4 - MDR Report Day 2, Win32_computersystem'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) for a suspicious WMI query operation was generated for a WMI operation via PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12054.png', 'ScreenshotCaption': 'A4/6/7 - Medium alert for GWMI query on wmi query for win32_computer system'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) called "Reconnaissance of Multiple WMI Classes" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1364.png', 'ScreenshotCaption': 'alert for multiple wmi discovery techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1361.png', 'ScreenshotCaption': 'win32 computersystem wmi event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11306.png', 'ScreenshotCaption': 'MSSP - enumeration - bios, pnpentity, computer system, process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10234.png', 'ScreenshotCaption': '11a3-8 - thp - wmi stuff'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13023.png', 'ScreenshotCaption': 'MSSP - 11.A'}, {'ScreenshotName': 'FireEye-APT29-13024.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11389.png', 'ScreenshotCaption': '11.A - gwmi query for Win32_ComputerSystem'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (warning severity) called "Get System Information" was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4210.png', 'ScreenshotCaption': 'CC - 11.A.4 - Get System Information'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3721.png', 'ScreenshotCaption': '11.A - gwmi for Win32_ComputerSystem'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18010.png', 'ScreenshotCaption': 'new mssp 11a5-7'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': "An MSSP detection for Discovery was generated containing evidence PowerShell runs command to obtain system information: gwmi -namespace root\\cimv2 -query 'Select * from Win32_ComputerSystem'.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1139.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (1 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1141.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (3 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1140.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (2 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-469.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with various PowerShell gwmi queries'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3132.png', 'ScreenshotCaption': '4/6/7 - win32_computersystem'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13236.png', 'ScreenshotCaption': '11.A.3, 11.A.4, 11.A.5, 11.A.6, 11.A.7, 11.A.8 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13687.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-289.png', 'ScreenshotCaption': 'cc - computer system'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "WMI Queries Win32_ComputerSystem" was generated for a PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6944.png', 'ScreenshotCaption': '11.a.4/6/7  - technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-6945.png', 'ScreenshotCaption': '11.a.4/6/7 - more details with the client process id'}, {'ScreenshotName': 'SecureWorks-APT29-6943.png', 'ScreenshotCaption': '11.a.4/6/7 - alert details'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - System Network Configuration Discovery" occurred for the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17612.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17611.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "SuspiciousWMIQuery" under "Discovery {T1016}" was generated on a suspicious WMI query targeting Win32_ComputerSystem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6793.png', 'ScreenshotCaption': 'A4/6/7 - WMI win32_computer system'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "information discovery" occurred containing evidence of WMI query targeting Win32_ComputerSystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12845.png', 'ScreenshotCaption': 'MSSP - pnp, process enumeration, win32_process, file enumeration'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17530.png', 'ScreenshotCaption': '11.A.7 - WMIOperation for Win32_ComputerSystem'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Network Configuration Discovery" was received that included a PowerShell command executed by the adversary and explained that it was used to query the system\'s network configuration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12949.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery description'}, {'ScreenshotName': 'Symantec-APT29-12948.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery Techniques'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing Win32_ComputerSystem. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12071.png', 'ScreenshotCaption': '3/4/5/6/7 - gwmi queries - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4165.png', 'ScreenshotCaption': 'computersystem'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.8', 'Procedure': 'Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell', 'Criteria': 'powershell.exe executing a Get-WmiObject query for Win32_Process', 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for the execution of a process discovery command via Windows Management Instrumentation.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-812.png', 'ScreenshotCaption': 'win32 process'}, {'ScreenshotName': 'Bitdefender-APT29-800.png', 'ScreenshotCaption': 'alerts on powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Process Discovery" was generated for a PowerShell gwmi query for Win32_Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2424.png', 'ScreenshotCaption': 'Powershell wmi query of running processes with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" was received that included a PowerShell script and explained that it was used to query Win32_Process via WMI.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12478.png', 'ScreenshotCaption': '11.A.8 - MDR Report Day 2, Win32_Process'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Win32 process executing...attempting to retrieve users" occurred containing evidence of the PowerShell gwmi query for Win32_Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10788.png', 'ScreenshotCaption': 'MSSP - a8 '}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) for a suspicious WMI query operation was generated for a WMI operation via PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12056.png', 'ScreenshotCaption': 'A8 - Medium alert for GWMI query on win32_process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium severity) called "Reconnaissance of Multiple WMI Classes" was generated for powershell.exe enumerating WMI classes associated with System Information Discovery.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1364.png', 'ScreenshotCaption': 'alert for multiple wmi discovery techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1365.png', 'ScreenshotCaption': 'win32 process wmi event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11306.png', 'ScreenshotCaption': 'MSSP - enumeration - bios, pnpentity, computer system, process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10234.png', 'ScreenshotCaption': '11a3-8 - thp - wmi stuff'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell gwmi query for Win32_Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13023.png', 'ScreenshotCaption': 'MSSP - 11.A'}, {'ScreenshotName': 'FireEye-APT29-13024.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11391.png', 'ScreenshotCaption': '11.A.8 - gwmi query for Win32_Process'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing a gwmi query for Win32_Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12709.png', 'ScreenshotCaption': '11.a MSSP alert #2'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "Process Discovery via Powershell" was generated for a PowerShell gwmi query for Win32_Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3732.png', 'ScreenshotCaption': '11.A - Process Discovery via Powershell'}, {'ScreenshotName': 'HanSight-APT29-3734.png', 'ScreenshotCaption': '11.A.8 - gwmi for Win32_Process as Process Discovery'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of execution of an WMI query for Win32_Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18011.png', 'ScreenshotCaption': 'new mssp 11a8'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1928.png', 'ScreenshotCaption': '11.a.8 win32_process'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': "An MSSP detection for Discovery was generated containing evidence PowerShell ran commands to get process information on the machine: gwmi -namespace root\\cimv2 -query 'SELECT * FROM Win32_Process'.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1141.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (3 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1139.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (1 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1140.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (2 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-469.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with various PowerShell gwmi queries'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "process discovery - T1057" was generated for a PowerShell gwmi query for Win32_Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3137.png', 'ScreenshotCaption': 'A technique detection for process discovery based upon Win32_Process query.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing a gwmi query for Win32_Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13236.png', 'ScreenshotCaption': '11.A.3, 11.A.4, 11.A.5, 11.A.6, 11.A.7, 11.A.8 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-290.png', 'ScreenshotCaption': 'cc - win32 process - does have bios, move back to list'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "WMI Queries Win32_Process", was generated for a PowerShell gwmi query for Win32_Process..', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6946.png', 'ScreenshotCaption': '11.a.8 - alert details overview'}, {'ScreenshotName': 'SecureWorks-APT29-6947.png', 'ScreenshotCaption': '11.a.8 -technique mappings  - WMI, Process Discovery'}, {'ScreenshotName': 'SecureWorks-APT29-6948.png', 'ScreenshotCaption': '11.a.8 - raw event details, client process id'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - Process Discovery" occurred for the PowerShell gwmi query for Win32_Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17633.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17634.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ProcessEnumeration" under "Discovery {T1057}" was generated due to the PowerShell gwmi query for Win32_Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-14983.png', 'ScreenshotCaption': '11.A.8 - Process Discovery'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection for "Discovery" under "SuspiciousWMIQuery" was generated on a suspicious WMI query targeting Win32_Process. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6794.png', 'ScreenshotCaption': 'A8 - WMI win32_process'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "information discovery" occurred containing evidence of Process Enumeration relating to WMI query targeting Win32_Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12845.png', 'ScreenshotCaption': 'MSSP - pnp, process enumeration, win32_process, file enumeration'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17534.png', 'ScreenshotCaption': '11.A.8 - WMIOperation for Win32_Process'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" was received that included a PowerShell command executed by the adversary and explained that it was used to enumerate running processes on the local system.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12949.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery description'}, {'ScreenshotName': 'Symantec-APT29-12948.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery Techniques'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing Win32_Process. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12071.png', 'ScreenshotCaption': '3/4/5/6/7 - gwmi queries - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for Win32_Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4167.png', 'ScreenshotCaption': 'win32 process'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.9', 'Procedure': 'Checked that the payload is not inside a folder path that contains "sample" or is the length of a hash value using PowerShell', 'Criteria': 'powershell.exe executing (Get-Item -Path ".\\" -Verbose).FullName', 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1095.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for PowerShell executing Get-Item for the current path.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2285.png', 'ScreenshotCaption': 'CyCarrier Raw Data: Powershell Get-Item for curent path'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" was received that included a PowerShell script and explained that it was used to to obtain the current path.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12479.png', 'ScreenshotCaption': '11.A.9 - MDR Report Day 2, getting path'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12283.png', 'ScreenshotCaption': 'A9 - Get-Item in powershell SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1367.png', 'ScreenshotCaption': 'get item powershell cmdlet'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10237.png', 'ScreenshotCaption': 'Get-Item'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell query for current path: (Get-Item -Path ".\\" -Verbose).FullName.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13024.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11393.png', 'ScreenshotCaption': '11.A.9 - Script block for Get-Item -Path ".\\" -Verbose).FullName'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3736.png', 'ScreenshotCaption': '11.A.9 - Get-Item -Path'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': "An MSSP detection for Discovery was generated containing evidence PowerShell ran commands to enumerate files and\ndirectories: (Get-Item -Path '.\\' -Verbose).FullName.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1141.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (3 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1139.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (1 of 4)'}, {'ScreenshotName': 'Microsoft-APT29-1140.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Discovery,\nDefense Evasion, and Persistence (2 of 4)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-470.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with PowerShell query for current path: (Get-Item -Path ".\\" -Verbose).FullName.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though events showed PowerShell executing the Get-Item cmdlet.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3394.png', 'ScreenshotCaption': 'CC 9 - get-item stopped'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3395.png', 'ScreenshotCaption': 'CC 9 - get-item started'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-291.png', 'ScreenshotCaption': 'cc - get item'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - File and Directory Discovery" occurred for the PowerShell executing Get-Item to query the current path.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13765.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "information discovery" occurred containing evidence of File Enumeration relating to Get-Item function.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12846.png', 'ScreenshotCaption': 'MSSP - SBL of all the above'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': ['Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7244.png', 'ScreenshotCaption': 'CC - A9 - Get-Item-Path on generic powershell alert'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File and Directory Discovery" was received that included a PowerShell command executed by the adversary and explained that it was used to perform discovery of the file and directory list from the local filesystem.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12948.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery Techniques'}, {'ScreenshotName': 'Symantec-APT29-12949.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery description'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ADS.Discover T1083" was generated for PowerShell executing Get-Item from an Alternate Data Stream (ADS).', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12338.png', 'ScreenshotCaption': 'CC - ADS.Discover for Get-Item in ADS'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Item for the current path.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4168.png', 'ScreenshotCaption': 'Get-Item'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.10', 'Procedure': 'Decoded an embedded DLL payload to disk using certutil.exe', 'Criteria': 'certutil.exe decoding kxwn.lock', 'Techniques': [{'TechniqueId': 'T1140', 'TechniqueName': 'Deobfuscate/Decode Files or Information', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) was generated for cerutil.exe decoding a payload. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13412.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-13413.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated for the execution of the certutil.exe process, which was identified as suspicious.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-803.png', 'ScreenshotCaption': 'certutil.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-804.png', 'ScreenshotCaption': 'known.lock '}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called “Deobfuscate/Decode Files or Information” was generated when certutil.exe decoded a malicious payload.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10581.png', 'ScreenshotCaption': 'A technique detection called “Deobfuscate/Decode Files or Information” on the certutil.exe process.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding PE file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10585.png', 'ScreenshotCaption': 'Telemetry showing certutil.exe decoding kwxn.lock. Telemetry showing powershell.exe making a network connection to 192.168.0.4 to port 443.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (purple indicator) was generated identifying the execution of certutil.exe with command-line parameters for decoding the payload as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2426.png', 'ScreenshotCaption': 'execution of certutil with enrichments'}, {'ScreenshotName': 'CyCraft-APT29-2427.png', 'ScreenshotCaption': 'Powershell execution of certutil decoding lock file '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}, {'ScreenshotName': 'CyCraft-APT29-12480.png', 'ScreenshotCaption': '11.A.10 - MDR Report Day 2, decoding base64'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Certutil.exe used to decode data" was generated for certutil decoding the payload with command-line arguments.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9691.png', 'ScreenshotCaption': '11.a.10 - evidence, commandline of certutil and decode'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9691.png', 'ScreenshotCaption': '11.a.10 - evidence, commandline of certutil and decode'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Win_Certutil_Deobfuscation-DecodeFilesOrInformation_MITRET1140" was generated when certutil.exe decoded the payload with command-line arguments.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12045.png', 'ScreenshotCaption': 'A10 - Medium Alert for CertUtilObfuscation - Command line arguments for certutil.exe execution'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "ATT&CK T1140 Deobfuscate/Decode Files or Information" was generated for certutil.exe encoding or decoding files.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1371.png', 'ScreenshotCaption': 'command line of known.lock'}, {'ScreenshotName': 'Elastic-APT29-1372.png', 'ScreenshotCaption': 'certutil.exe enrihment for deobfuscae/decode files'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1370.png', 'ScreenshotCaption': 'decoding via certutil alert with file created of known.lock'}, {'ScreenshotName': 'Elastic-APT29-1371.png', 'ScreenshotCaption': 'command line of known.lock'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) was generated for certutil with decode switch usage.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-15053.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP occurred containing evidence of certutil.exe decoding kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11307.png', 'ScreenshotCaption': 'MSSP - certutil (a10)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10243.png', 'ScreenshotCaption': 'certuil summary'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Certutil Decode" was generated due to the use of certutil to decode file content.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11349.png', 'ScreenshotCaption': '11.A.10 - Certutil Decode on blob to kxwn.lock'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for certutil.exe writing a fake certificate identified as an encoded binary.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11374.png', 'ScreenshotCaption': 'CERTUTIL with fake cert with encoded header'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for certutil.exe decoding kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13026.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Deobfuscate/Decode Files or Information (Certutil executed with suspicious commands)" was generated for certutil decoding the payload with command-line arguments.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11330.png', 'ScreenshotCaption': 'certutil.exe process event, with impact score of 50. intelligence for deobfusacte/decode files. (11.a.10)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11332.png', 'ScreenshotCaption': 'certutil creating the kxwn.lock file'}, {'ScreenshotName': 'GoSecure-APT29-11330.png', 'ScreenshotCaption': 'certutil.exe process event, with impact score of 50. intelligence for deobfusacte/decode files. (11.a.10)'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (Warning severity) was generated for certutil usage.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3744.png', 'ScreenshotCaption': '11.A.10 - certutil decoding payload and writing to .lock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow; medium severity) called "suspicious_certutil_usage_decoding" was generated due to certutil.exe decoding kxwn.lock. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3145.png', 'ScreenshotCaption': '11.a.10 - certutil cmd line decode'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of certutil.exe decoding the kxwn.lock payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18012.png', 'ScreenshotCaption': 'new mssp 11a10'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3145.png', 'ScreenshotCaption': '11.a.10 - certutil cmd line decode'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2560.png', 'ScreenshotCaption': 'certutil decode (11a10)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection was generated for a file being decoded via certutil. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-14747.png', 'ScreenshotCaption': '11a10 - general certutil - vendor pic'}], 'Footnotes': ['The vendor added a new detection for the technique.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1823.png', 'ScreenshotCaption': '11.a.10 certutil decode'}], 'Footnotes': ['MVISION Endpoint would have blocked this activity due to an Adaptive Threat Protection signature for execution of certutil.exe. ']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Deobfuscate/Decode Files or Information" was generated due to certutil.exe decoding kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-475.png', 'ScreenshotCaption': 'Detection for suspicious usage of certutil.exe to decode and executable'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-475.png', 'ScreenshotCaption': 'Detection for suspicious usage of certutil.exe to decode and executable'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for "encoding information using Windows certificate management tool" was generated due to certutil decoding the kwxn.lock payload.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3149.png', 'ScreenshotCaption': 'File write operation for kxwn.lock file.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for certutil.exe decoding kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13237.png', 'ScreenshotCaption': '11.A.10, 11.A.11 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3153.png', 'ScreenshotCaption': '10 - file write of the kxwn.lock file'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Deobfuscate/Decode Files or Information" was generated due to "suspicious file deobfuscation" via certutil.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-166.png', 'ScreenshotCaption': 'alert on powershell, and certutil and get-content in command line'}, {'ScreenshotName': 'ReaQta-APT29-172.png', 'ScreenshotCaption': 'certutil.exe detection strategy - suspicius file alert name'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Certutil Decode Command Execution" was generated due to process activity associated with the certutil decode command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6975.png', 'ScreenshotCaption': '11.a.10 - alert details for certutil.exe'}, {'ScreenshotName': 'SecureWorks-APT29-6977.png', 'ScreenshotCaption': '11.a.10 - process overview'}, {'ScreenshotName': 'SecureWorks-APT29-6976.png', 'ScreenshotCaption': '11.a.10 - technique mappings'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Defense Evasion- Deobfuscate/Decode Files or Information" occurred for the cerutil utility decoding a writing a payload to disk.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process decoding the kxwn.lock payload. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17638.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1140" occurred containing evidence of certutil.exe decoding kxwn.lock with command-line arguments.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12848.png', 'ScreenshotCaption': 'MSSP - A10/11/12'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6784.png', 'ScreenshotCaption': 'A10 - Certutil calling decode on kxwn.lock'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Deobfuscate/Decode Files or Information" was generated when certutil decoded data and created an executable file.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12850.png', 'ScreenshotCaption': 'Incident Report showing events related to explorer.exe executing powershell.exe from initial execution'}, {'ScreenshotName': 'Symantec-APT29-9709.png', 'ScreenshotCaption': 'Certutil execeution, created an executable file. Tagged with Deobfuscated File or Information'}, {'ScreenshotName': 'Symantec-APT29-12902.png', 'ScreenshotCaption': 'Incident Report showing events related to explorer.exe executing powershell.exe from initial execution'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Deobfuscate/Decode Files or Information" was received that included details on execution of certutil.exe by the adversary and explained that it was used to decode a fake certificate file into a DLL.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12951.png', 'ScreenshotCaption': 'MSSP Day 1: Deobfuscate description'}, {'ScreenshotName': 'Symantec-APT29-12950.png', 'ScreenshotCaption': 'MSSP Day 1: Deobfuscate'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12850.png', 'ScreenshotCaption': 'Incident Report showing events related to explorer.exe executing powershell.exe from initial execution'}, {'ScreenshotName': 'Symantec-APT29-12902.png', 'ScreenshotCaption': 'Incident Report showing events related to explorer.exe executing powershell.exe from initial execution'}, {'ScreenshotName': 'Symantec-APT29-9709.png', 'ScreenshotCaption': 'Certutil execeution, created an executable file. Tagged with Deobfuscated File or Information'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity) called "Certutil Execution (Suspicious use)" was generated identifying suspicious use of certutil.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12065.png', 'ScreenshotCaption': '10 - RCA - technique - certutil'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for certutil.exe being used to decode the payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12688.png', 'ScreenshotCaption': 'MSSP - 11A10-15 - all have evidence raw data'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Deobfuscate/Decode Files or Information - certuil" was generated for the use of certutil.exe decoding a payload.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4126.png', 'ScreenshotCaption': 'alerts for deobfuscate '}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Deobfuscate/Decode Files or Information" was generated for the use of certutil.exe decoding a payload.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4126.png', 'ScreenshotCaption': 'alerts for deobfuscate '}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a executable file found in memory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14754.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12763.png', 'ScreenshotCaption': '11.a.10 mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4127.png', 'ScreenshotCaption': 'file mod of kxwn.lock'}, {'ScreenshotName': 'Carbon Black-APT29-4170.png', 'ScreenshotCaption': 'certuil decode'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.11', 'Procedure': 'Established Registry Run key persistence using PowerShell', 'Criteria': 'Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run', 'Techniques': [{'TechniqueId': 'T1060', 'TechniqueName': 'Registry Run Keys / Startup Folder', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "RegSigStartup" was generated for Registry Run Keys / Startup Folder persistence.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-800.png', 'ScreenshotCaption': 'alerts on powershell'}, {'ScreenshotName': 'Bitdefender-APT29-815.png', 'ScreenshotCaption': 'att&ck wit hreg startup for iex'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a suspicious process writing a Startup item Registry key.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-800.png', 'ScreenshotCaption': 'alerts on powershell'}, {'ScreenshotName': 'Bitdefender-APT29-820.png', 'ScreenshotCaption': 'runkeywirittenbysus process reg key stuff based on sus powershhell process'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection was generated showing Registry write event of the Webcache subkey by powershell.exe, identified as a Startup or Autorun.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-813.png', 'ScreenshotCaption': 'remove'}, {'ScreenshotName': 'Bitdefender-APT29-814.png', 'ScreenshotCaption': 'rundll32 startup or autorun webcache'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10574.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe added a Webcache subkey added to Registry.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Registry Run Keys / Startup Folder" was generated for a Registry Creation event associated with establishing Registry Run Key persistence.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2437.png', 'ScreenshotCaption': 'Creation of .lock file with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Registry Run Keys / Startup Folder" was received that included a PowerShell script and explained that it was used to establish Registry Run Key persistence.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}, {'ScreenshotName': 'CyCraft-APT29-12497.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, registry key created'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Registry key modification (ATT&CK Persistence)" was generated when the Webcache subkey was added to the Registry Run key. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9696.png', 'ScreenshotCaption': '11.a.11 - registry event with more details, machine name, process name'}, {'ScreenshotName': 'Cybereason-APT29-9693.png', 'ScreenshotCaption': '11.a.11 - registry technique, process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Win_Persist_MITRET1060" was generated when Webcache subkey was added to the Registry Run key.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12050.png', 'ScreenshotCaption': 'A10/11 - Informational win persist alert - kxwn.lock existance and reg adding webcache subkey addition'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ATT&CK T1060 Registry Run Keys / Startup Folder" was generated for powershell.exe adding Run key persistence into the Registry', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1375.png', 'ScreenshotCaption': 'registry modify for kxwn.lock with enrichment'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1375.png', 'ScreenshotCaption': 'registry modify for kxwn.lock with enrichment'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) was generated for a detected process performing a Registry write that looks like a launchpoint. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10246.png', 'ScreenshotCaption': 'possible persistence, .lock file'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the creation of a registry value named "Webcache."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11308.png', 'ScreenshotCaption': 'MSSP - a11 - webcache'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Registry write event of the Webcache subkey identified as an Autorun.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10248.png', 'ScreenshotCaption': 'webcache '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Run Key Persistence" was generated due to the modification of "run" Registry persistence keys.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11352.png', 'ScreenshotCaption': '11.A.11 - Run Key Persistence for Webcache subkey (top)'}, {'ScreenshotName': 'FireEye-APT29-11353.png', 'ScreenshotCaption': '11.A.11 - Run Key Persistence for Webcache subkey (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13025.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green indicator) called "Registry Run Keys / Startup Folder" was generated due to Run key persistence added into the Registry', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11331.png', 'ScreenshotCaption': 'registry write for webcache intelligence showing persistence, registry run key, impact score of 15. also see the .lock value. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11331.png', 'ScreenshotCaption': 'registry write for webcache intelligence showing persistence, registry run key, impact score of 15. also see the .lock value. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Warning severity) for "Registry Run Keys" was generated due to the the Webcache subkey being added as a Registry run key.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3745.png', 'ScreenshotCaption': '11.A.11 - Webcache registry run key'}, {'ScreenshotName': 'HanSight-APT29-3746.png', 'ScreenshotCaption': '11.A.11 - Registry Run Keys/Startup Folder'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow tag) called Registy Run Keys Startup Folder  was generated due to powershell.exe adding the Webcache subkey Run key persistence into the Registry. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3152.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Kaspersky-APT29-3155.png', 'ScreenshotCaption': '11.a.12 - exec of schemas ads would be blocked'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18013.png', 'ScreenshotCaption': 'new mssp 11a11'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3155.png', 'ScreenshotCaption': '11.a.12 - exec of schemas ads would be blocked'}, {'ScreenshotName': 'Kaspersky-APT29-3117.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for Registry Run Keys/Startup Folder was generated due to the addition of the Run key persistence into the Registry. ', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2594.png', 'ScreenshotCaption': 'Addition of webcache'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Execution was generated containing evidence a Registry key was created for persistence under HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1136.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Persistence and Execution (1 of 3)'}, {'ScreenshotName': 'Microsoft-APT29-1137.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Persistence and Execution (2 of 3)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-479.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with powershell.exe adding subkey Webcache to HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "commonly abused process creates a new autostart Registry key" was generated for powershell.exe adding Run key persistence into the Registry.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3163.png', 'ScreenshotCaption': 'A technique detection showing powershell setting webcache registry key.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3164.png', 'ScreenshotCaption': 'A technique detection showing powershell setting webcache registry key.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "New entry added to startup related Registry keys by signed binary" was generated for powershell.exe adding Run key persistence into the Registry.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3164.png', 'ScreenshotCaption': 'A technique detection showing powershell setting webcache registry key.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3163.png', 'ScreenshotCaption': 'A technique detection showing powershell setting webcache registry key.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13237.png', 'ScreenshotCaption': '11.A.10, 11.A.11 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) was generated for "Registry Run Keys / Startup Folder" based on the Webcache subkey addition.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-166.png', 'ScreenshotCaption': 'alert on powershell, and certutil and get-content in command line'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-292.png', 'ScreenshotCaption': 'cc - new item prop'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Powerduke Persistence 2"  was generated for a persistence event associated with a run key used by PowerDuke.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6970.png', 'ScreenshotCaption': '11.a.11 - alert details, powerduke persistence'}, {'ScreenshotName': 'SecureWorks-APT29-6972.png', 'ScreenshotCaption': '11.a.11 - raw event details, runkey path'}, {'ScreenshotName': 'SecureWorks-APT29-6971.png', 'ScreenshotCaption': '11.a.11 technique mapping'}, {'ScreenshotName': 'SecureWorks-APT29-6973.png', 'ScreenshotCaption': '11.a.11 - raw event details, runkey continued, persistence event within alert'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Persistence- Registry Run Keys / Startup Folder" occurred for PowerShell registering a Registry Run key.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6974.png', 'ScreenshotCaption': '11.a.11 - script block event details  run key'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "RegistryAutorun" under "Persistence {T1060}" was generated for powershell.exe adding Run key persistence into the Registry.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6786.png', 'ScreenshotCaption': 'A11 - Regkey software/windows/CurrentVersion/run being added'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1060" occurred containing evidence of Webcache subkey added to Registry.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12848.png', 'ScreenshotCaption': 'MSSP - A10/11/12'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6786.png', 'ScreenshotCaption': 'A11 - Regkey software/windows/CurrentVersion/run being added'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Registry Run Keys / Startup Folder" was generated for powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9714.png', 'ScreenshotCaption': 'powershell.exe setting registry key, tagged with Registry Run Key persistence.'}, {'ScreenshotName': 'Symantec-APT29-9713.png', 'ScreenshotCaption': 'Details of registry key creation event.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Registry Run Keys / Startup Folder" was received that included a PowerShell command executed by the adversary and explained that it was used to set a Registry Run Key. A detailed analysis of the malicious payload was also provided. [SE: see comment]', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12952.png', 'ScreenshotCaption': 'MSSP Day 1: Registry Run Keys'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9716.png', 'ScreenshotCaption': 'powershel.exe setting registry value for persistence with kxwn.lock file, tagged with Registry Run Keys / Startup Folder'}, {'ScreenshotName': 'Symantec-APT29-9714.png', 'ScreenshotCaption': 'powershell.exe setting registry key, tagged with Registry Run Key persistence.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Registry Run Keys / Startup Folder" was generated for powershell.exe adding Run key persistence into the Registry.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12067.png', 'ScreenshotCaption': '11 - run key - technique'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell creating persistence by modifying the Registry which launches at startup. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12688.png', 'ScreenshotCaption': 'MSSP - 11A10-15 - all have evidence raw data'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for Registry Run Keys was generated based on powershell.exe modifying the Run key.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4124.png', 'ScreenshotCaption': 'powershell registry run keys'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe adding Run key persistence into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4171.png', 'ScreenshotCaption': 'new reg key web cache'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.12', 'Procedure': 'Executed PowerShell stager payload', 'Criteria': 'powershell.exe spawning from from the schemas ADS (powershell.exe)', 'Techniques': [{'TechniqueId': 'T1086', 'TechniqueName': 'PowerShell', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for powershell.exe executed with a suspicious large command line, which led to the powershell.exe process being identified as malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-816.png', 'ScreenshotCaption': 'suspicious large command-line for 2016 IEX'}, {'ScreenshotName': 'Bitdefender-APT29-797.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for powershell.exe launched with the encoded command parameter.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-805.png', 'ScreenshotCaption': 'powershell stager 11.a.12'}, {'ScreenshotName': 'Bitdefender-APT29-817.png', 'ScreenshotCaption': 'encoded command'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-802.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called “PowerShell” was generated for the executed PowerShell stager matching existing malware characteristics. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10588.png', 'ScreenshotCaption': 'A Technique detection called “PowerShell” on the powershell.exe process.'}, {'ScreenshotName': 'CrowdStrike-APT29-10582.png', 'ScreenshotCaption': 'A Technique detection called “PowerShell” on the powershell.exe process.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called “PowerShell” was generated for powershell.exe run with a hidden window and encoded commands.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10587.png', 'ScreenshotCaption': 'A Technique detection called “PowerShell” on the powershell.exe process.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10582.png', 'ScreenshotCaption': 'A Technique detection called “PowerShell” on the powershell.exe process.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "PowerShell" was generated for powershell.exe spawned from a PowerShell stager.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2436.png', 'ScreenshotCaption': 'Connection to C2 over port 443. Just from PowerShell scriptblock logging'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was received that included a PowerShell script and explained that it was used to download and execute another script via IEX.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}, {'ScreenshotName': 'CyCraft-APT29-12483.png', 'ScreenshotCaption': '11.A.12-15 - MDR Report Day 2, staging remote PowerShell'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; unique symbol) called "ATT&CK Execution: PowerShell" was generated due to powershell.exe spawned from a PowerShell stager.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9695.png', 'ScreenshotCaption': '11.a.12 - powershell iex stager'}, {'ScreenshotName': 'Cybereason-APT29-9689.png', 'ScreenshotCaption': '11.a.2 - commandline, schemas, etc. from process tree'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9689.png', 'ScreenshotCaption': '11.a.2 - commandline, schemas, etc. from process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Win_Powershell_Base64_MITRE1027" was generated on PowerShell usage of base64 encoding or decoding.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12057.png', 'ScreenshotCaption': 'A12 - Medium alert for powershell base64 - PowerShell stager executing (IEX) from schemas\n'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) was generated for powershell.exe executed with unusual arguments.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13683.png', 'ScreenshotCaption': 'second powershell alert - arguments, obfuscated, network activity'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) was generated for powershell.exe executing an obfuscated command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1368.png', 'ScreenshotCaption': 'obfustacted cmdlet alert'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection  for "ATT&CK T1086 PowerShell" was generated for powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1373.png', 'ScreenshotCaption': 'for 12 the powershell staging'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1373.png', 'ScreenshotCaption': 'for 12 the powershell staging'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity)  for a Powershell script launched from ads was generated due to a PowerShell script launched from an ADS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10249.png', 'ScreenshotCaption': 'ads with schemas'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10249.png', 'ScreenshotCaption': 'ads with schemas'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "POWERSHELL.EXE IEX ENCODED COMMAND (METHODOLOGY)" was generated due to encoded PowerShell IEX execution.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11346.png', 'ScreenshotCaption': '11.A - PowerShell Get-Content Command with schemas IEX'}, {'ScreenshotName': 'FireEye-APT29-11359.png', 'ScreenshotCaption': '11.A.12 - PowerShell IEX Encoded Command (top)'}, {'ScreenshotName': 'FireEye-APT29-11360.png', 'ScreenshotCaption': '11.A.12 - PowerShell IEX Encoded Command (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell stager executing (IEX) from schemas.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13023.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "PowerShell with Invoke Expression Launched" was generated due to the PowerShell stager executing (IEX) from schemas. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17445.png', 'ScreenshotCaption': '11A1, 11A2: Telemetry showing explorer.exe spawning powershell.exe. Includes powershell command line arguments.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-17445.png', 'ScreenshotCaption': '11A1, 11A2: Telemetry showing explorer.exe spawning powershell.exe. Includes powershell command line arguments.'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Suspicious Powershell Commandline" was generated due to powershell.exe execution and use of IEX.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3701.png', 'ScreenshotCaption': '11.A - Explorer.exe spawning PowerShell alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) for "PowerShell" was generated for powershell.exe spawned from a PowerShell stager. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-13810.png', 'ScreenshotCaption': '11a12 - vendor pic PS tag - technique'}, {'ScreenshotName': 'Kaspersky-APT29-13802.png', 'ScreenshotCaption': '11a12 - vendor pic PS tag - technique'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity) called "PDM:Exploit.Win32.Generic" was generated for a potential threat.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3155.png', 'ScreenshotCaption': '11.a.12 - exec of schemas ads would be blocked'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing from schemas ADS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18014.png', 'ScreenshotCaption': 'new mssp 11a12'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-13802.png', 'ScreenshotCaption': '11a12 - vendor pic PS tag - technique'}, {'ScreenshotName': 'Kaspersky-APT29-13810.png', 'ScreenshotCaption': '11a12 - vendor pic PS tag - technique'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for PowerShell was generated due to a suspicious PowerShell command. ', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2600.png', 'ScreenshotCaption': 'Technique detection for a suspicious powershell command'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "PowerShell" was generated for powershell.exe spawned from a PowerShell stager.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1817.png', 'ScreenshotCaption': 'ps ads schemas - historical search'}, {'ScreenshotName': 'McAfee-APT29-1824.png', 'ScreenshotCaption': '11.a.12 - iex of streams ads'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-483.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with powershell.exe executing script content via IEX.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing from schemas ADS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13238.png', 'ScreenshotCaption': '11.A.13 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3142.png', 'ScreenshotCaption': 'Telemetry showing a powershell process spawning and making a remote connection to the C2 server.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-166.png', 'ScreenshotCaption': 'alert on powershell, and certutil and get-content in command line'}, {'ScreenshotName': 'ReaQta-APT29-293.png', 'ScreenshotCaption': 'cc - iex'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called PowerShell Downloading Remote Resource was generated due to PowerShell stager executing (IEX) from schemas.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6996.png', 'ScreenshotCaption': '11.a.12 - technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-6993.png', 'ScreenshotCaption': '11.a.12 - alert details, relevant for the stager'}, {'ScreenshotName': 'SecureWorks-APT29-6995.png', 'ScreenshotCaption': '11.a.12 - alert details'}, {'ScreenshotName': 'SecureWorks-APT29-6998.png', 'ScreenshotCaption': '11.a.12 - full process tree'}, {'ScreenshotName': 'SecureWorks-APT29-6997.png', 'ScreenshotCaption': '11.a.12 - process overview'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Exeuction - PowerShell" occurred for PowerShell executing a stager with Invoke-Expression.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6855.png', 'ScreenshotCaption': '11.a.1 process tree 2'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1086" occurred containing evidence of PowerShell stager executing (IEX) from schemas via script block logs.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12848.png', 'ScreenshotCaption': 'MSSP - A10/11/12'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6785.png', 'ScreenshotCaption': 'A1/2 - Process tree showing explorer.exe executing  powershell calling Get-Content'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Powershell" was generated for powershell.exe spawned from a PowerShell stager.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12850.png', 'ScreenshotCaption': 'Incident Report showing events related to explorer.exe executing powershell.exe from initial execution'}, {'ScreenshotName': 'Symantec-APT29-9700.png', 'ScreenshotCaption': 'powershell.exe executing ADS'}, {'ScreenshotName': 'Symantec-APT29-9706.png', 'ScreenshotCaption': 'Incident report for execution of suspicious powershell.exe usage'}, {'ScreenshotName': 'Symantec-APT29-9705.png', 'ScreenshotCaption': 'powershell.exe launching powershell.exe stager.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell" was received that included a PowerShell command executed by the adversary and explained that it was used to download and execute a PoshC2 stager located on a remote server.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12953.png', 'ScreenshotCaption': 'MSSP Day 1: PowerShell & C2 techniques'}, {'ScreenshotName': 'Symantec-APT29-12954.png', 'ScreenshotCaption': 'MSSP Day 1: stager script explanation'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9705.png', 'ScreenshotCaption': 'powershell.exe launching powershell.exe stager.'}, {'ScreenshotName': 'Symantec-APT29-9700.png', 'ScreenshotCaption': 'powershell.exe executing ADS'}, {'ScreenshotName': 'Symantec-APT29-12850.png', 'ScreenshotCaption': 'Incident Report showing events related to explorer.exe executing powershell.exe from initial execution'}, {'ScreenshotName': 'Symantec-APT29-9706.png', 'ScreenshotCaption': 'Incident report for execution of suspicious powershell.exe usage'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing IEX. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12687.png', 'ScreenshotCaption': 'MSSP - 11A1-8 - no evidence for 1/2 ; evidence shown for wmi queries'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12049.png', 'ScreenshotCaption': 'a1/2/12 - raw data - get-content; PS>explorer; schemas/IEX '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4123.png', 'ScreenshotCaption': 'encoded commands'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for powershell.exe executing encoded instructions.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4121.png', 'ScreenshotCaption': 'Powershell executed with encoded instructions'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from a PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4121.png', 'ScreenshotCaption': 'Powershell executed with encoded instructions'}], 'Footnotes': []}]}]}]}, {'Substep': '11.A.13', 'Procedure': 'Established C2 channel (192.168.0.4) via PowerShell payload over port 443', 'Criteria': 'Established network channel over port 443', 'Techniques': [{'TechniqueId': 'T1043', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-807.png', 'ScreenshotCaption': 'network connection over port 443 to 0.4'}, {'ScreenshotName': 'Bitdefender-APT29-819.png', 'ScreenshotCaption': 'network connection details'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10575.png', 'ScreenshotCaption': '11.a.13 - connection activity app view'}, {'ScreenshotName': 'CrowdStrike-APT29-10585.png', 'ScreenshotCaption': 'Telemetry showing certutil.exe decoding kwxn.lock. Telemetry showing powershell.exe making a network connection to 192.168.0.4 to port 443.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was received that included a PowerShell script and explained that it was used to download and execute another script from 192.168.0.4 over port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2503.png', 'ScreenshotCaption': '11.A.1 - MDR Report Day 2, summary'}, {'ScreenshotName': 'CyCraft-APT29-12483.png', 'ScreenshotCaption': '11.A.12-15 - MDR Report Day 2, staging remote PowerShell'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9723.png', 'ScreenshotCaption': '11.a.13 - connection over port 443, process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Win_Network_CommonPorts_MITRET1043"  was generated when powershell.exe made a network connection to C2 (192.168.0.4) over port 443.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12059.png', 'ScreenshotCaption': 'A13 - informational alert of "Common Port" showing Powershell making a network connection to 192.168.0.4 over port 443'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (medium detection) for "Command and Control" with the rule name "PowerShell Network Activity" was generated for powershell.exe opening a network connection.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1380.png', 'ScreenshotCaption': 'same alert at (30) but with full tele view'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1377.png', 'ScreenshotCaption': 'powershell network comms over 443 with enrichment of c2'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP occurred containing evidence of a connection back to the C2 server 192.168.0.4 over port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11305.png', 'ScreenshotCaption': 'MSSP - lnk being executed with iex/schemas'}, {'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14657.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell making a network connection.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11386.png', 'ScreenshotCaption': '11.A.13 - PowerShell Network Connection, with port 443'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell making network connection to C2 (192.168.0.4) over port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13022.png', 'ScreenshotCaption': 'MSSP - 11.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "Commonly Used Port (Outbound connection established)" was generated due to PowerShell making network connection to C2 (192.168.0.4) over TCP port 443.\n', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11333.png', 'ScreenshotCaption': 'a13 - powershell creating a connection over power 443. impact score of 90 because powershell accessing the internet in this environment they deem abnormal. '}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) called "Powershell: established network connections" was generated due to PowerShell making network connection to C2 (192.168.0.4) over TCP port 443.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11333.png', 'ScreenshotCaption': 'a13 - powershell creating a connection over power 443. impact score of 90 because powershell accessing the internet in this environment they deem abnormal. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11333.png', 'ScreenshotCaption': 'a13 - powershell creating a connection over power 443. impact score of 90 because powershell accessing the internet in this environment they deem abnormal. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3749.png', 'ScreenshotCaption': '11.A.13 - powershell with C2 connection'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called Commonly Used Port was generated for powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3172.png', 'ScreenshotCaption': '11.a.13 - connection to 192.168.0.4:443 - tree'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12385.png', 'ScreenshotCaption': '11.a.13-5 MSSP report #2'}, {'ScreenshotName': 'Kaspersky-APT29-18015.png', 'ScreenshotCaption': 'new mssp 11a13'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3166.png', 'ScreenshotCaption': '11.a.13 - connection to 192.168.0.4:443'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection was generated identifying a socket opened by a process that normally does not.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1827.png', 'ScreenshotCaption': '11.a.13 connect to 192.168.0.4:443 '}, {'ScreenshotName': 'McAfee-APT29-1834.png', 'ScreenshotCaption': '11.a.13 connect to 192.168.0.4:443'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-484.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe making network connection to 192.168.0.4 over TCP port 443.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13238.png', 'ScreenshotCaption': '11.A.13 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3142.png', 'ScreenshotCaption': 'Telemetry showing a powershell process spawning and making a remote connection to the C2 server.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3140.png', 'ScreenshotCaption': '13 - commonly used port xdr'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Commonly Used Port" was generated for PowerShell making a network connection to the C2 server (192.168.0.4) over port 443.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-166.png', 'ScreenshotCaption': 'alert on powershell, and certutil and get-content in command line'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': ' A General alert detection (medium severity) was generated for PowerShell behaving like a RAT.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-173.png', 'ScreenshotCaption': 'powershell as RAT with detail'}, {'ScreenshotName': 'ReaQta-APT29-13977.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Command and Control - Commonly Used Port" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13766.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13767.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13768.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-6999.png', 'ScreenshotCaption': '11.a.13 - event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1043" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12849.png', 'ScreenshotCaption': 'MSSP - A13/14/15 - network information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6786.png', 'ScreenshotCaption': 'A11 - Regkey software/windows/CurrentVersion/run being added'}, {'ScreenshotName': 'SentinelOne-APT29-6810.png', 'ScreenshotCaption': 'A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Commonly Used Port" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 over port 443. A detailed analysis of the script was also provided.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12954.png', 'ScreenshotCaption': 'MSSP Day 1: stager script explanation'}, {'ScreenshotName': 'Symantec-APT29-12953.png', 'ScreenshotCaption': 'MSSP Day 1: PowerShell & C2 techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9867.png', 'ScreenshotCaption': 'Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Commonly Used Port" was generated due for powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12075.png', 'ScreenshotCaption': '13/14/15 - DDI - shows network connection and attack mapping'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the network connection over port 443. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12688.png', 'ScreenshotCaption': 'MSSP - 11A10-15 - all have evidence raw data'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12061.png', 'ScreenshotCaption': '13 - RCA view'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for .NET attempting to make suspicious network connections.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4119.png', 'ScreenshotCaption': 'alerts'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4110.png', 'ScreenshotCaption': 'connection to 443'}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell making network connections.']}]}]}]}, {'Substep': '11.A.14', 'Procedure': 'Used HTTPS to transport\xa0C2 (192.168.0.4) traffic', 'Criteria': 'Established network channel over the HTTPS protocol', 'Techniques': [{'TechniqueId': 'T1071', 'TechniqueName': 'Standard Application Layer Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an network connection to C2 (192.168.0.4) over port 443, which was identified as using the SSL protocol.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1097.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed powershell.exe loading http libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10589.png', 'ScreenshotCaption': 'Telemetry showing http module loads for powershell.exe process.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.\t', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so detection does not apply.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14657.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12385.png', 'ScreenshotCaption': '11.a.13-5 MSSP report #2'}, {'ScreenshotName': 'Kaspersky-APT29-12384.png', 'ScreenshotCaption': '11.a.13-5 MSSP report #1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply.']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1071" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12849.png', 'ScreenshotCaption': 'MSSP - A13/14/15 - network information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6810.png', 'ScreenshotCaption': 'A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Standard Application Layer Protocol" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 using HTTPS. A detailed analysis of the script was also provided.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12953.png', 'ScreenshotCaption': 'MSSP Day 1: PowerShell & C2 techniques'}, {'ScreenshotName': 'Symantec-APT29-12954.png', 'ScreenshotCaption': 'MSSP Day 1: stager script explanation'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting and sending data to 192.168.0.4 via TLS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9867.png', 'ScreenshotCaption': 'Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Standard Application Layer Protocol" was generated due to PowerShell making network connection to C2 (192.168.0.4) over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12075.png', 'ScreenshotCaption': '13/14/15 - DDI - shows network connection and attack mapping'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the network connection over HTTPS. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12688.png', 'ScreenshotCaption': 'MSSP - 11A10-15 - all have evidence raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '11.A.15', 'Procedure': 'Used HTTPS to encrypt C2 (192.168.0.4) traffic', 'Criteria': 'Evidence that the network data sent over the C2 channel is encrypted', 'Techniques': [{'TechniqueId': 'T1032', 'TechniqueName': 'Standard Cryptographic Protocol', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making an network connection to C2 (192.168.0.4) over port 443, which was identified as using the SSL protocol.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1097.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP alert showed outbound connection with Cryptographic API calls to C2 server.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10579.png', 'ScreenshotCaption': 'An MSSP alert showing outbound connection with Cryptographic API calls to c2 server.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.\t', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed the loading of cryptographic libraries.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so detection does not apply.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14657.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply.']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1032" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12849.png', 'ScreenshotCaption': 'MSSP - A13/14/15 - network information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6810.png', 'ScreenshotCaption': 'A13/14/15 - Connection information including, IP, port, protocol, and encryption dectection'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Standard Application Layer Protocol" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 using HTTPS. A detailed analysis of the script was also provided.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12954.png', 'ScreenshotCaption': 'MSSP Day 1: stager script explanation'}, {'ScreenshotName': 'Symantec-APT29-12953.png', 'ScreenshotCaption': 'MSSP Day 1: PowerShell & C2 techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe connecting and sending data to 192.168.0.4 via TLS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9867.png', 'ScreenshotCaption': 'Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Standard Cryptographic Protocol" was generated due to PowerShell making network connection to C2 (192.168.0.4) over HTTPS.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12075.png', 'ScreenshotCaption': '13/14/15 - DDI - shows network connection and attack mapping'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the network connection over HTTPS. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12688.png', 'ScreenshotCaption': 'MSSP - 11A10-15 - all have evidence raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed powershell.exe loading cryptographic libraries.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13955.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '12.A.1', 'Procedure': 'Enumerated the System32 directory using PowerShell', 'Criteria': "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", 'Techniques': [{'TechniqueId': 'T1083', 'TechniqueName': 'File and Directory Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell enumeration of System32.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1099.png', 'ScreenshotCaption': 'Telemetry showing the call of the timestomp function with command-line arguments'}, {'ScreenshotName': 'Bitdefender-APT29-1098.png', 'ScreenshotCaption': 'Telemetry showing the loading of the timestomp function'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell enumeration of System32. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10598.png', 'ScreenshotCaption': 'Telemetry showing powershell executing timestomp to enumerate System32: (gci ((gci env:windir).Value + ‘\\system32’).'}, {'ScreenshotName': 'CrowdStrike-APT29-10599.png', 'ScreenshotCaption': 'Telemetry showing timestomp script block which enumerates System32: (gci ((gci env:windir).Value + ‘\\system32’).'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection for Discovery (blue icon) was genereated due to PowerShell enumeration of System32.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2438.png', 'ScreenshotCaption': 'gci with enrichments'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_AutomatedCollection_DirScanART_MITRET1119" (high severity; red indicator), was generated due to powershell.exe executing Get-ChildItem.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12066.png', 'ScreenshotCaption': 'A1 - High alert for automated collection showing get-childitem on env:windir'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed PowerShell enumeration of System32:(gci ((gci env:windir).Value + '\\system32').", 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12286.png', 'ScreenshotCaption': 'A2 - SBL of timestop definition'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Stealthy PowerShell Commands" (medium severity) was generated for PowerShell executing the timestomp function. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1388.png', 'ScreenshotCaption': 'stealthy powershell commands alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe enumerating System32. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1391.png', 'ScreenshotCaption': 'timestomp function in powershell event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell enumeration of System32.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14497.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-11309.png', 'ScreenshotCaption': 'MSSP - timestomp'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell enumeration of the System32 directory. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10268.png', 'ScreenshotCaption': 'function timestomp in thp'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the PowerShell enumeration of System32.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13027.png', 'ScreenshotCaption': 'MSSP - 12.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell enumeration of System32.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11408.png', 'ScreenshotCaption': '12.A.1 - Script block for gci enumeration of System32'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "File and Directory Discovery with Powershell" was generated due to PowerShell enumeration of env:windir.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4214.png', 'ScreenshotCaption': 'CC - 12.A.1 - File and Directory Discovery alert'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell enumeration of System32.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3767.png', 'ScreenshotCaption': '12.A - timestomp function definition, contains gci env:windir'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for suspicious PowerShell commandline.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-14016.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Timestomping was generated containing evidence of PowerShell enumeration of System32.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1143.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Defense\nEvasion using Timestomp technique (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1144.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Defense\nEvasion using Timestomp technique (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry via the advanced hunting query interface showed executed script block with PowerShell enumeration of System32.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-488.png', 'ScreenshotCaption': "Telemetry in the advanced hunting query interface showing executed script block with PowerShell enumeration of System32: (gci ((gci env:windir).Value + '\\system32')."}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Timestomping was generated containing evidence of PowerShell enumeration of System32.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13239.png', 'ScreenshotCaption': '12.A.1 - MSSP'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell enumeration of System32. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-295.png', 'ScreenshotCaption': 'cc - function timestomp'}, {'ScreenshotName': 'ReaQta-APT29-298.png', 'ScreenshotCaption': 'cc - .lock file'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Discovery - File and Directory Discovery" occurred containing evidence of PowerShell enumeration of System32.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12639.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - overview (pt1)'}, {'ScreenshotName': 'SecureWorks-APT29-12640.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - overview (pt2)'}, {'ScreenshotName': 'SecureWorks-APT29-12642.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - event details (pt1)'}, {'ScreenshotName': 'SecureWorks-APT29-12643.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - event details (pt2)'}, {'ScreenshotName': 'SecureWorks-APT29-12641.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - overview (pt3)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell enumeration of System32.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7015.png', 'ScreenshotCaption': '12.a.1 - script details with timestomp function'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1083" occurred containing evidence of PowerShell enumeration of System32.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12852.png', 'ScreenshotCaption': 'MSSP - A1 - FileEnum + gci SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell enumeration of System32.', 'Modifiers': ['Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7245.png', 'ScreenshotCaption': 'CC - A1 - Powershell timestop function via generic powershell alert'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File and Directory Discovery" was received that noted a PowerShell command was used to find a random file in the System32 folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12955.png', 'ScreenshotCaption': 'MSSP Day 1: File discovery and Timestomp techniques'}, {'ScreenshotName': 'Symantec-APT29-12956.png', 'ScreenshotCaption': 'MSSP Day 1: File discovery and Timestomp explanations'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell performing numerous file reads in the System32 directory. The detection was correlated to a parent alert for  PowerShell executing an ADS.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12271.png', 'ScreenshotCaption': 'rca - PS enumerating the system32 issue - look into how  to handle this'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell enumeration of System32. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4145.png', 'ScreenshotCaption': 'timestop fileless_scriptload '}], 'Footnotes': []}]}]}]}, {'Substep': '12.A.2', 'Procedure': 'Modified the time attributes of the kxwn.lock persistence payload using PowerShell', 'Criteria': 'powershell.exe modifying the creation, last access, and last write times of kxwn.lock', 'Techniques': [{'TechniqueId': 'T1099', 'TechniqueName': 'Timestomp', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with commands to timestomp kxwn.lock.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1098.png', 'ScreenshotCaption': 'Telemetry showing the loading of the timestomp function'}, {'ScreenshotName': 'Bitdefender-APT29-1099.png', 'ScreenshotCaption': 'Telemetry showing the call of the timestomp function with command-line arguments'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with commands to timestomp kxwn.lock. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10598.png', 'ScreenshotCaption': 'Telemetry showing powershell executing timestomp to enumerate System32: (gci ((gci env:windir).Value + ‘\\system32’).'}, {'ScreenshotName': 'CrowdStrike-APT29-10599.png', 'ScreenshotCaption': 'Telemetry showing timestomp script block which enumerates System32: (gci ((gci env:windir).Value + ‘\\system32’).'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (purple icon) for "Timestomp" was generated when the kxwn.lock was created with falsified creation, last access, and last write times.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2437.png', 'ScreenshotCaption': 'Creation of .lock file with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Timestomp" occured that noted modified timestamp of kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12485.png', 'ScreenshotCaption': '12.A.1 - MDR Report Day 2, summary and timestomp'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. However, manually viewing kxwn.lock on the impacted host showed that it had been modified, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9726.png', 'ScreenshotCaption': '12.a.2 - lock file was created'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Evading Detection" occurred containing evidence of "timestomp" function definition.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12917.png', 'ScreenshotCaption': 'MSSP - timestomp SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with commands to timestomp kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12286.png', 'ScreenshotCaption': 'A2 - SBL of timestop definition'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) for "Timestomping" was generated for the modification of the timestamp of kxwn.lock. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1387.png', 'ScreenshotCaption': 'better timestomp aler - expanded showing API event. '}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "ATT&CK T1099 Timestomp" was generated for PowerShell calling the NtSetInformationFile API. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1387.png', 'ScreenshotCaption': 'better timestomp aler - expanded showing API event. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the modification of the timestamp of kxwn.lock, as well as the contents of the timestomp function. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14989.png', 'ScreenshotCaption': '12a2 - timestomp telemetry'}, {'ScreenshotName': 'Elastic-APT29-1391.png', 'ScreenshotCaption': 'timestomp function in powershell event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the Powershell function "timestomp" being called to modify the creation time of kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11309.png', 'ScreenshotCaption': 'MSSP - timestomp'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the LastWriteTime of kxwn.lock being accessed. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10264.png', 'ScreenshotCaption': 'timestop being called, and access to LastWriteTime '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for file timestamp modification on the kxwn.lock file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13027.png', 'ScreenshotCaption': 'MSSP - 12.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed modification of creation, last access, and last write times of kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11415.png', 'ScreenshotCaption': '12.A.2 - Modification of timestamp values on kxwn.lock'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for evidence of file timestamp manipulation.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12736.png', 'ScreenshotCaption': '12.a.2 MSSP alert'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the timestomp function being used to modify attributes of kxwn.lock along with the details of the function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3768.png', 'ScreenshotCaption': '12.A.2 - timestomp function called on the .lock file'}, {'ScreenshotName': 'HanSight-APT29-3767.png', 'ScreenshotCaption': '12.A - timestomp function definition, contains gci env:windir'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of timestomping of kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12388.png', 'ScreenshotCaption': '12.a.2 MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for suspicious PowerShell commandline.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-14016.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Timestomping was generated due to time attributes being modified on kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1144.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Defense\nEvasion using Timestomp technique (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1143.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Defense\nEvasion using Timestomp technique (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a timestamp modification event for kxwn.lock as well as specific time modifications. The activity is correlated to a previous General detection on kxwn.lock.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-490.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing specific time modifications'}, {'ScreenshotName': 'Microsoft-APT29-489.png', 'ScreenshotCaption': 'Telemetry showing a timestamp modification event for kxwn.lock with correlation to previous alert'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "ioc.Timestomp_T1099" (high severity) was generated due to PowerShell modifying timestamps on kxwn.lock file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13688.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-3178.png', 'ScreenshotCaption': 'A technique detection for timestomping showing the modified timestamps for kwxn.lock. (1/2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed scriptblock with commands to timestomp kxwn.lock.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with commands to timestomp kxwn.lock.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-295.png', 'ScreenshotCaption': 'cc - function timestomp'}, {'ScreenshotName': 'ReaQta-APT29-298.png', 'ScreenshotCaption': 'cc - .lock file'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "FileTimestomped" was generated due to timestamp modifications of kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7018.png', 'ScreenshotCaption': '12.a.2 - red cloak screenshot of rule result - filetimestomped'}, {'ScreenshotName': 'SecureWorks-APT29-7019.png', 'ScreenshotCaption': '12.a.2 -  red cloak'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Defense Evasion - Timestomp" occurred containing evidence of the modification of creation, last access, and last write times of kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12639.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - overview (pt1)'}, {'ScreenshotName': 'SecureWorks-APT29-12640.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - overview (pt2)'}, {'ScreenshotName': 'SecureWorks-APT29-12643.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - event details (pt2)'}, {'ScreenshotName': 'SecureWorks-APT29-12641.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - overview (pt3)'}, {'ScreenshotName': 'SecureWorks-APT29-12642.png', 'ScreenshotCaption': 'MSSP - SW - 12A1-2 - event details (pt1)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with commands to timestomp kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13769.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13770.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "FileTimeCopied" was generated due to GetCreationTime API call targeting kxwn.lock. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6828.png', 'ScreenshotCaption': 'Powershell parent process'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1099" occurred containing evidence of timestamp modifications of kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12852.png', 'ScreenshotCaption': 'MSSP - A1 - FileEnum + gci SBL'}, {'ScreenshotName': 'SentinelOne-APT29-12853.png', 'ScreenshotCaption': 'MSSP - A2 - FileTime alerts'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Timestomp" occurred containing evidence of timestamp modifications of kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12956.png', 'ScreenshotCaption': 'MSSP Day 1: File discovery and Timestomp explanations'}, {'ScreenshotName': 'Symantec-APT29-12955.png', 'ScreenshotCaption': 'MSSP Day 1: File discovery and Timestomp techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe setting the file attributes of kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9869.png', 'ScreenshotCaption': 'powershell.exe set attributes of kxwn.lock file'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Timestomping" was generated due to time modification of kxwn.lock. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12079.png', 'ScreenshotCaption': '2 - MDR - raw data - timstomp rule - kwxn.lock file'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for evidence of file timestamp manipulation.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12689.png', 'ScreenshotCaption': 'MSSP - 12A2 - 12B1 ; timestomp doesnt have evidence'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with commands to timestomp kxwn.lock.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell modifying filesystem access and write times of the kxwn.lock file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14755.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with commands to timestomp kxwn.lock as well as the execution of the timestomp function against the kxwn.lock file. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4145.png', 'ScreenshotCaption': 'timestop fileless_scriptload '}, {'ScreenshotName': 'Carbon Black-APT29-4146.png', 'ScreenshotCaption': 'timestomp executing .lock'}], 'Footnotes': []}]}]}]}, {'Substep': '12.B.1', 'Procedure': 'Enumerated registered AV products using PowerShell', 'Criteria': 'powershell.exe executing a Get-WmiObject query for AntiVirusProduct', 'Techniques': [{'TechniqueId': 'T1063', 'TechniqueName': 'Security Software Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "WMIAntiVirusDiscovery" was generated due to PowerShell gwmi query for AntiVirusProduct. The alert was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-868.png', 'ScreenshotCaption': 'Process tree view showing "WMIAntiVirusDiscovery" alert correlated to a parent alert identifying the powershell.exe process as malware'}, {'ScreenshotName': 'Bitdefender-APT29-871.png', 'ScreenshotCaption': 'Technique alert for "WMIAntiVirusDiscovery" mapped to the correct ATT&CK Tactic (Discovery) and Technique (Security Software Discovery)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called “GenericSecuritySoftwareDiscovery” was generated due to PowerShell gwmi query for AntiVirusProduct. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10603.png', 'ScreenshotCaption': 'A Technique detection called “GenericSecuritySoftwareDiscovery” on powershell.exe process when the detectav function is loaded.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10603.png', 'ScreenshotCaption': 'A Technique detection called “GenericSecuritySoftwareDiscovery” on powershell.exe process when the detectav function is loaded.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red icon) for "Security Software Discovery" was generated due to powershell.exe loading a custom script that contained code to detect installed antivirus products.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2439.png', 'ScreenshotCaption': 'detectav with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Security Software Discovery" was received that included PowerShell gwmi query for AntiVirusProduct', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12487.png', 'ScreenshotCaption': '12.B.1 - MDR Report Day 2, detectav & software scriptblock'}, {'ScreenshotName': 'CyCraft-APT29-12485.png', 'ScreenshotCaption': '12.A.1 - MDR Report Day 2, summary and timestomp'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Win_WMI_SecProduct_Enum_NonSYS_MITRET1063" was generated due to PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12072.png', 'ScreenshotCaption': 'B1 - medium alert for wmi sec product enumeration showing gwmi query for AntiVirusProduct'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection (medium severity) for "ATT&CK T1063 Security Software Discovery"  was generated due to PowerShell executing the detectav function. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1807.png', 'ScreenshotCaption': 'cc - powershell enrichment change to security software discovery. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1395.png', 'ScreenshotCaption': 'wmi  event for av product'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (informational severity) was generated for for WMI querying information about anti-virus products. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14505.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}, {'ScreenshotName': 'F-Secure-APT29-11310.png', 'ScreenshotCaption': 'MSSP - detectav '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10270.png', 'ScreenshotCaption': 'antivirusproduct'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13028.png', 'ScreenshotCaption': 'MSSP - 12.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11421.png', 'ScreenshotCaption': '12.B.1 - gwmi query for AntiVirusProduct'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of security software discovery attempts. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12744.png', 'ScreenshotCaption': '12.b.1 MSSP alert'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Critical severity) called "Anti-Virus Software Discovery" was generated due to the gwmi query for AntiVirusProduct.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4216.png', 'ScreenshotCaption': 'CC - 12.B.1 - Anti-Virus Software Discovery'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3770.png', 'ScreenshotCaption': '12.B.1 - detectav function definition'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of a PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12389.png', 'ScreenshotCaption': '12.b.1 MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for script with suspicious content.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-14017.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-492.png', 'ScreenshotCaption': 'Beautified script block with gwmi query for AntiVirusProduct'}, {'ScreenshotName': 'Microsoft-APT29-493.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with powershell.exe executing gwmi query for AntiVirusProduct with command line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Security Software Discovery" was generated due to powershell executing a gwmi query for AntiVirusProduct.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3183.png', 'ScreenshotCaption': 'Decoded powershell script block.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3180.png', 'ScreenshotCaption': 'A technique detection for Security Software Discovery  with high severity. Tactic detection for Discovery for other powershell functions.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred containing evidence of security software discovery attempts. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13240.png', 'ScreenshotCaption': '12.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-300.png', 'ScreenshotCaption': 'cc - detectav details'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Security Software Discovery - Enumerating AntiVirus Software" was generated due to the PowerShell  gwmi query for AntiVirusProduct.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7023.png', 'ScreenshotCaption': '12.b.1 - tehcnique mappings'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7024.png', 'ScreenshotCaption': '12.b.1 - raw events, script,pid wont show here'}, {'ScreenshotName': 'SecureWorks-APT29-7026.png', 'ScreenshotCaption': '12.b.1 - event details, script details, detect av'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "SuspiciousWMIQuery" under "Discovery {T1063}" was generated when PowerShell gwmi queried for AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6830.png', 'ScreenshotCaption': 'B1 - Suspicious WMI alert with query for AntiVirusProduct'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of gwmi query being used to enumerate AV software via "detectav" PowerShell function.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12854.png', 'ScreenshotCaption': 'MSSP - B1 - General WMI alert'}, {'ScreenshotName': 'SentinelOne-APT29-12855.png', 'ScreenshotCaption': 'MSSP  - B1 - SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Security Software Discovery" was occurred containing evidence WMI was used to enumerate installed AntiVirus products.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12957.png', 'ScreenshotCaption': 'MSSP Day 1: Security Software Discovery'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell enumerating registered AV products. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12689.png', 'ScreenshotCaption': 'MSSP - 12A2 - 12B1 ; timestomp doesnt have evidence'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12058.png', 'ScreenshotCaption': '12B1 - antivirus '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4150.png', 'ScreenshotCaption': 'detectav'}, {'ScreenshotName': 'Carbon Black-APT29-4151.png', 'ScreenshotCaption': 'detectav execution'}], 'Footnotes': []}]}]}]}, {'Substep': '12.C.1', 'Procedure': 'Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell', 'Criteria': 'powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall', 'Techniques': [{'TechniqueId': 'T1012', 'TechniqueName': 'Query Registry', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1101.png', 'ScreenshotCaption': 'Telemetry showing the loading and call of the software function'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed scriptblock with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10605.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe calling the software function.'}, {'ScreenshotName': 'CrowdStrike-APT29-10604.png', 'ScreenshotCaption': 'Telemetry showing the powershell script block for the software module.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for the script block with registry query for installed software. The event was correlated to a previous detection for "Security Software Discovery."', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2440.png', 'ScreenshotCaption': 'scriptblock logging with enrichments containing registry manipulation'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Query Registry" was received that included a PowerShell script and explained that it was used to detect installed software.', 'Modifiers': ['Delayed (Processing)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12488.png', 'ScreenshotCaption': '12.B.1 - MDR Report Day 2, detectav & software scriptblock'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12287.png', 'ScreenshotCaption': 'C1/2 - software function definition in SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1398.png', 'ScreenshotCaption': 'microsoft reg key in powershell data'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of Powershell functions which queried the WMI security centre class and also the software uninstall registry keys.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}, {'ScreenshotName': 'F-Secure-APT29-11311.png', 'ScreenshotCaption': 'MSSP - reg key queries'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10289.png', 'ScreenshotCaption': 'uninstall reg key'}, {'ScreenshotName': 'F-Secure-APT29-10287.png', 'ScreenshotCaption': 'OpenSubKey'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the registry query for installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13029.png', 'ScreenshotCaption': 'MSSP - 12.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed scriptblock with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11423.png', 'ScreenshotCaption': '12.C.1 - Script block for registry query'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-15131.png', 'ScreenshotCaption': '12C1 - new vendor pic - OpenSubKey with reg key scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for a script with suspicious content.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-14018.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed registry query for installed software. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-492.png', 'ScreenshotCaption': 'Beautified script block with gwmi query for AntiVirusProduct'}, {'ScreenshotName': 'Microsoft-APT29-493.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with powershell.exe executing gwmi query for AntiVirusProduct with command line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-14500.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (high severity) called for Discovery was generated when the software function was executed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3183.png', 'ScreenshotCaption': 'Decoded powershell script block.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3180.png', 'ScreenshotCaption': 'A technique detection for Security Software Discovery  with high severity. Tactic detection for Discovery for other powershell functions.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the registry query for installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13241.png', 'ScreenshotCaption': '12.C.1 (A), 12.C.2 (A) - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13242.png', 'ScreenshotCaption': '12.C.1 (B), 12.C.2 (B) - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-302.png', 'ScreenshotCaption': 'cc - shows all'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Discovery - PowerShell Querying the Registry Key" was generated due to the registry query for installed software.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7028.png', 'ScreenshotCaption': '12.c.1/2 - script raw events'}, {'ScreenshotName': 'SecureWorks-APT29-10444.png', 'ScreenshotCaption': '12.c.1/2 alert details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17644.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1012" occurred containing scriptblock with registry query for installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12856.png', 'ScreenshotCaption': 'MSSP - C1/2 - SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7246.png', 'ScreenshotCaption': 'CC - C1 - Powershell alert showing query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Query Registry" occurred that containing registry query for installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12958.png', 'ScreenshotCaption': 'MSSP Day 1: Query Registry technique'}, {'ScreenshotName': 'Symantec-APT29-12959.png', 'ScreenshotCaption': 'MSSP Day 1: Query Registry description'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence PowerShell checked for installed software by querying the registry. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12690.png', 'ScreenshotCaption': 'MSSP - 12C1 - 13 - 14A1/2/3 - 14B2/3/4 ; do not talk about win32_audit code, only show raw data, so not counting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12221.png', 'ScreenshotCaption': '1/2 - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell querying the registry.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14755.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13956.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-13958.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '12.C.2', 'Procedure': 'Enumerated installed software via the Registry (Uninstall key) using PowerShell', 'Criteria': 'powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall', 'Techniques': [{'TechniqueId': 'T1012', 'TechniqueName': 'Query Registry', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed scriptblock with registry query for installed software.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1101.png', 'ScreenshotCaption': 'Telemetry showing the loading and call of the software function'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10604.png', 'ScreenshotCaption': 'Telemetry showing the powershell script block for the software module.'}, {'ScreenshotName': 'CrowdStrike-APT29-10605.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe calling the software function.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for the scriptblock with registry query for installed software. The event was correlated to a previous detection for "Security Software Discovery."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2440.png', 'ScreenshotCaption': 'scriptblock logging with enrichments containing registry manipulation'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Query Registry" was received that included a PowerShell script and explained that it was used to detect installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12488.png', 'ScreenshotCaption': '12.B.1 - MDR Report Day 2, detectav & software scriptblock'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12287.png', 'ScreenshotCaption': 'C1/2 - software function definition in SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1398.png', 'ScreenshotCaption': 'microsoft reg key in powershell data'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of Powershell functions which queried the WMI security centre class and also the software uninstall registry keys.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}, {'ScreenshotName': 'F-Secure-APT29-11311.png', 'ScreenshotCaption': 'MSSP - reg key queries'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10289.png', 'ScreenshotCaption': 'uninstall reg key'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the registry query for installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13029.png', 'ScreenshotCaption': 'MSSP - 12.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11422.png', 'ScreenshotCaption': '12.C.2 - Script block for registry query'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-15131.png', 'ScreenshotCaption': '12C1 - new vendor pic - OpenSubKey with reg key scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for a script with suspicious content.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-14018.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed registry query for installed software. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-492.png', 'ScreenshotCaption': 'Beautified script block with gwmi query for AntiVirusProduct'}, {'ScreenshotName': 'Microsoft-APT29-493.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with powershell.exe executing gwmi query for AntiVirusProduct with command line arguments'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-14500.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (high severity) for Discovery was generated when the software function was executed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3180.png', 'ScreenshotCaption': 'A technique detection for Security Software Discovery  with high severity. Tactic detection for Discovery for other powershell functions.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3183.png', 'ScreenshotCaption': 'Decoded powershell script block.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the registry query for installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13241.png', 'ScreenshotCaption': '12.C.1 (A), 12.C.2 (A) - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13242.png', 'ScreenshotCaption': '12.C.1 (B), 12.C.2 (B) - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed scriptblock with registry query for installed software.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-302.png', 'ScreenshotCaption': 'cc - shows all'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) called "Discovery - PowerShell Querying the Registry Key" was generated due to the registry query for installed software.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7028.png', 'ScreenshotCaption': '12.c.1/2 - script raw events'}, {'ScreenshotName': 'SecureWorks-APT29-10444.png', 'ScreenshotCaption': '12.c.1/2 alert details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17644.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1012" occurred containing scriptblock with registry query for installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12856.png', 'ScreenshotCaption': 'MSSP - C1/2 - SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed scriptblock with registry query for installed software. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7247.png', 'ScreenshotCaption': 'CC - C2 - powershell alert showing query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Query Registry" occurred that containing registry query for installed software.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12958.png', 'ScreenshotCaption': 'MSSP Day 1: Query Registry technique'}, {'ScreenshotName': 'Symantec-APT29-12959.png', 'ScreenshotCaption': 'MSSP Day 1: Query Registry description'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence PowerShell checked for installed software by querying the registry. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12690.png', 'ScreenshotCaption': 'MSSP - 12C1 - 13 - 14A1/2/3 - 14B2/3/4 ; do not talk about win32_audit code, only show raw data, so not counting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12221.png', 'ScreenshotCaption': '1/2 - raw data'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell querying the registry.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14755.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13958.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-13956.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '13.A.1', 'Procedure': 'Enumerated the computer name using the GetComputerNameEx API', 'Criteria': 'powershell.exe executing the GetComputerNameEx API', 'Techniques': [{'TechniqueId': 'T1082', 'TechniqueName': 'System Information Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10608.png', 'ScreenshotCaption': 'Telemetry showed the powershell script block calling the GetComputerNameEx API.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated due to the execution of the comp function.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2441.png', 'ScreenshotCaption': 'GetComputerNameEx with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Information Discovery" occurred containing evidence of PowerShell calling the GetComputerNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12489.png', 'ScreenshotCaption': '13.A.1 - MDR Report Day 2, summary and GetComputerNameEx'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for GetComputerNameEx being executed by powershell.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9928.png', 'ScreenshotCaption': '13.a.1 - malicious command alert for GetComputerNameEx (cc)'}], 'Footnotes': ['For the Configuration Change, the PowerShell detection policy was disabled.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Information Discovery" occurred containing evidence of the GetComputerNameEx API call.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10791.png', 'ScreenshotCaption': 'MSSP - computername API'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12288.png', 'ScreenshotCaption': 'A1 - comp function definition in SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1404.png', 'ScreenshotCaption': 'powershell cmdlet of getcomputernameex'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell calling the GetComputerNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11312.png', 'ScreenshotCaption': 'MSSP - 13a/b/c/d - function imports '}, {'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10303.png', 'ScreenshotCaption': 'API calls'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing the GetComputerNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13031.png', 'ScreenshotCaption': 'MSSP - 13.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11429.png', 'ScreenshotCaption': '13.A.1 - Script block for GetComputerNameEx API'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3772.png', 'ScreenshotCaption': '13.A.1 - GetComputerNameEx'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing the GetComputerNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12390.png', 'ScreenshotCaption': '13.a.1 MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1931.png', 'ScreenshotCaption': '13.a.1 - getcomputernameex'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for "Suspicious Powershell commandline."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-499.png', 'ScreenshotCaption': 'General detection for Suspicious Powershell commandline'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-494.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with GetComputerNameEx'}, {'ScreenshotName': 'Microsoft-APT29-495.png', 'ScreenshotCaption': 'Beautified script block with GetComputerNameEx'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13689.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-305.png', 'ScreenshotCaption': 'cc - getcomputername function'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection  occurred containing evidence of PowerShell calling the GetComputerNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13771.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7033.png', 'ScreenshotCaption': '13.a.1 - script block continued, comp'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1082" occurred containing evidence of PowerShell calling the GetComputerNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12857.png', 'ScreenshotCaption': 'MSSP - A1 - SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7248.png', 'ScreenshotCaption': 'CC - A1 - GetComputerNameEx in powershell alert'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Information Discovery" occurred containg evidence of PowerShell calling the GetComputerNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12960.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery techniques'}, {'ScreenshotName': 'Symantec-APT29-12961.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery script details'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12266.png', 'ScreenshotCaption': 'all the scripts pulled from disk'}], 'Footnotes': ['The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4182.png', 'ScreenshotCaption': 'function comp, alert for length of it'}, {'ScreenshotName': 'Carbon Black-APT29-13959.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '13.B.1', 'Procedure': 'Enumerated the domain name using the NetWkstaGetInfo API', 'Criteria': 'powershell.exe executing the NetWkstaGetInfo API', 'Techniques': [{'TechniqueId': 'T1016', 'TechniqueName': 'System Network Configuration Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though alerts were generated for PowerShell compiling a DLL file using csc.exe and a suspicious binary write by csc.exe with a PowerShell parent.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-830.png', 'ScreenshotCaption': 'Alert for PowerShell compiling a DLL file using csc.exe, does not count as a detection'}, {'ScreenshotName': 'Bitdefender-APT29-833.png', 'ScreenshotCaption': 'Alert for a suspicious binary write by csc.exe with a PowerShell parent, does not count as a detection'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10611.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe calling the domain function.'}, {'ScreenshotName': 'CrowdStrike-APT29-10612.png', 'ScreenshotCaption': 'Telemetry showed the powershell script block calling the NetWkstaGetInfo API.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for Threat Activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2442.png', 'ScreenshotCaption': 'NetWkstaGetInfo with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Network Configuration Discovery" was received that included a PowerShell script and explained that it was used to obtain the domain name.', 'Modifiers': ['Delayed (Processing)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12490.png', 'ScreenshotCaption': '13.B.1 - MDR Report Day 2, summary and NetWkstaGetInfo '}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10792.png', 'ScreenshotCaption': 'MSSP - API call'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12289.png', 'ScreenshotCaption': 'B1 - domain definition in SBL and NetSkstaGetInfo api call'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1412.png', 'ScreenshotCaption': 'netwrksta powershell event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11312.png', 'ScreenshotCaption': 'MSSP - 13a/b/c/d - function imports '}, {'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the NetWkstaGetInfo API call. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10303.png', 'ScreenshotCaption': 'API calls'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell loading netapi32.dll, which contains functions for user and group discovery, including NetWkstaGetInfo.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11754.png', 'ScreenshotCaption': 'CC - 13.B.1 - PowerShell loading netapi32.dll'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11431.png', 'ScreenshotCaption': '13.B.1 - Script block for NetWkstaGetInfo API'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the execution of PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12713.png', 'ScreenshotCaption': '13.b, 13.c MSSP alert #2'}, {'ScreenshotName': 'GoSecure-APT29-12712.png', 'ScreenshotCaption': '13.b, 13.c MSSP alert #1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3774.png', 'ScreenshotCaption': '13.B.1 - NetWkstaGetInfo API'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing the NetWKstaGetInfo API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18016.png', 'ScreenshotCaption': 'new mssp 13B1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1934.png', 'ScreenshotCaption': '13.b.1 - detail'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-495.png', 'ScreenshotCaption': 'Beautified script block with GetComputerNameEx'}, {'ScreenshotName': 'Microsoft-APT29-494.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with GetComputerNameEx'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13689.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-306.png', 'ScreenshotCaption': 'cc - netwkstaget'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection  occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13771.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7034.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17874.png', 'ScreenshotCaption': '13.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7249.png', 'ScreenshotCaption': 'CC - B1 - Generic powershell alert showing NetWkstaGetInfo call'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Network Configuration Discovery" occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12960.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery techniques'}, {'ScreenshotName': 'Symantec-APT29-12961.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery script details'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12266.png', 'ScreenshotCaption': 'all the scripts pulled from disk'}], 'Footnotes': ['The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4182.png', 'ScreenshotCaption': 'function comp, alert for length of it'}, {'ScreenshotName': 'Carbon Black-APT29-4191.png', 'ScreenshotCaption': 'domain as well'}], 'Footnotes': []}]}]}]}, {'Substep': '13.C.1', 'Procedure': 'Enumerated the current username using the GetUserNameEx API', 'Criteria': 'powershell.exe executing the GetUserNameEx API', 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the GetUserNameEx API. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10616.png', 'ScreenshotCaption': 'Telemetry showed the powershell script block calling the GetUserNameEx API.'}, {'ScreenshotName': 'CrowdStrike-APT29-10613.png', 'ScreenshotCaption': 'Telemetry showed powershell.exe calling the user function.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for powershell.exe executing the script which contained GetUserNameEx API function. The event was correlated to a parent Technique detection for PowerShell.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2443.png', 'ScreenshotCaption': 'GetUserNameEx with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Owner/User Discovery" was received that included a PowerShell script and explained that it was used enumerate users.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12489.png', 'ScreenshotCaption': '13.A.1 - MDR Report Day 2, summary and GetComputerNameEx'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for a PowerShell process occurred containing evidence of the GetUserNameEx API call.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10793.png', 'ScreenshotCaption': 'MSSP - API call'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block log function definition of "user" containing the GetUserNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12291.png', 'ScreenshotCaption': 'C1 - function definition of user function in SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the GetUserNameEx API. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1418.png', 'ScreenshotCaption': 'script block of getusernameex'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell calling the GetUserNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11312.png', 'ScreenshotCaption': 'MSSP - 13a/b/c/d - function imports '}, {'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the GetUserNameEx API call. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10303.png', 'ScreenshotCaption': 'API calls'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the GetUserNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11433.png', 'ScreenshotCaption': '13.C.1 - Script block for GetUserNameEx API'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the execution of the GetUserNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12713.png', 'ScreenshotCaption': '13.b, 13.c MSSP alert #2'}, {'ScreenshotName': 'GoSecure-APT29-12712.png', 'ScreenshotCaption': '13.b, 13.c MSSP alert #1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the GetUserNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3775.png', 'ScreenshotCaption': '13.C - GetUserNameEx API'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing the GetUserNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12393.png', 'ScreenshotCaption': '13.c.1 MSSP report #1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1936.png', 'ScreenshotCaption': '13.c.1 - getusernameex detail'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed executed PowerShell script block with GetUserNameEx. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-14021.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-14020.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13689.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the GetUserNameEx API.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-308.png', 'ScreenshotCaption': 'cc - C - shows function'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection  occurred containing evidence of PowerShell calling the GetUserNameEx API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13771.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetUserNameEx API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7036.png', 'ScreenshotCaption': '13.c.1 - user function from script block event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block log with function definition of "user" which calls GetUserNameEx API. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (UX)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7250.png', 'ScreenshotCaption': 'CC - C1 - Powershell alert of GetUserNameEx API being used'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Owner/User Discovery" was received that included a PowerShell command executed by the adversary and explained that it was used to obtain the username.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12960.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery techniques'}, {'ScreenshotName': 'Symantec-APT29-12961.png', 'ScreenshotCaption': 'MSSP Day 1: Discovery script details'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12266.png', 'ScreenshotCaption': 'all the scripts pulled from disk'}], 'Footnotes': ['The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4182.png', 'ScreenshotCaption': 'function comp, alert for length of it'}, {'ScreenshotName': 'Carbon Black-APT29-4189.png', 'ScreenshotCaption': 'user & pslist being called'}], 'Footnotes': []}]}]}]}, {'Substep': '13.D.1', 'Procedure': 'Enumerated running processes using the CreateToolhelp32Snapshot API', 'Criteria': 'powershell.exe executing the CreateToolhelp32Snapshot API', 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "findprocess" was generated due to PowerShell querying the list of running processes. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-843.png', 'ScreenshotCaption': 'Technique alert for PowerShell querying the list of running processes, mapped to the correct ATT&CK Technique (Discovery)'}, {'ScreenshotName': 'Bitdefender-APT29-870.png', 'ScreenshotCaption': 'Process tree view showing PowerShell process discovery command alert correlated to a parent alert identifying the powershell.exe process as malware'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for the execution of a PowerShell process discovery command.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1115.png', 'ScreenshotCaption': 'Technique alert for the execution of a PowerShell process discovery command, mapped to the correct ATT&CK Technique (Discovery)'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10615.png', 'ScreenshotCaption': 'Telemetry showed the powershell script block calling the CreateToolhelp32Snapshot API.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for Threat Activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2316.png', 'ScreenshotCaption': 'CyCarrier Raw Data: CreateToolHelp32Snapshot in scriptblock'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" occurred with evidence of a PowerShell script used to enumerate processes.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12489.png', 'ScreenshotCaption': '13.A.1 - MDR Report Day 2, summary and GetComputerNameEx'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for a PowerShell process occurred containing evidence of the CreateToolhelp32Snapshot API call.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10794.png', 'ScreenshotCaption': 'MSSP - API call'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block log function definition of "pslist" containing the CreateToolhelp32Snapshot API.', 'Modifiers': ['Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12303.png', 'ScreenshotCaption': 'D1 - CC - function definition of plist function in SBL with api call'}], 'Footnotes': ['A UX Configuration Change was made to update PowerShell script block logging truncation length. ']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14973.png', 'ScreenshotCaption': '13d1 - better vendor pic'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell calling the CreateToolhelp32Snapshot API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}, {'ScreenshotName': 'F-Secure-APT29-11312.png', 'ScreenshotCaption': 'MSSP - 13a/b/c/d - function imports '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the CreateToolhelp32Snapshot API call.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10304.png', 'ScreenshotCaption': 'api calls with powershell'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11436.png', 'ScreenshotCaption': '13.D.1 - Script block for CreateToolhelp32Snapshot API'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3777.png', 'ScreenshotCaption': '13.D.1 - CreateToolhelp32Snapshot API'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing the CreateToolhelp32Snapshot API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18017.png', 'ScreenshotCaption': 'new mssp 13d1'}, {'ScreenshotName': 'Kaspersky-APT29-12396.png', 'ScreenshotCaption': '13.d.1 MSSP report #2'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1938.png', 'ScreenshotCaption': '13.d.1 createtoolhelp32snapshot detail'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-494.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with GetComputerNameEx'}, {'ScreenshotName': 'Microsoft-APT29-495.png', 'ScreenshotCaption': 'Beautified script block with GetComputerNameEx'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13689.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-14501.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-310.png', 'ScreenshotCaption': 'cc - createtool api'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection  occurred containing evidence of PowerShell calling the CreateToolhelp32Snapshot API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13771.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7039.png', 'ScreenshotCaption': '13.d.1 - full script pslist function'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ProcessEnumeration" was generated due to running processes being enumerated. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6846.png', 'ScreenshotCaption': 'D1 - Alert generated for process enumeration'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1057" occurred containing evidence of Process Enumeration and "pslist" function which calls CreateToolhelp32Snapshot API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12859.png', 'ScreenshotCaption': 'MSSP - D1 - pslist SBL and alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7252.png', 'ScreenshotCaption': 'CC - D1 - Powershell alert containing call to CreateToolhelp32Snapshot API'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" occurred containing evidence of an executed PowerShell command used to enumerate running processes on the local machine.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12965.png', 'ScreenshotCaption': 'MSSP Day 1: Process Discovery'}, {'ScreenshotName': 'Symantec-APT29-12962.png', 'ScreenshotCaption': 'MSSP Day 1: wmidump'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the API call in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12266.png', 'ScreenshotCaption': 'all the scripts pulled from disk'}], 'Footnotes': ['The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4189.png', 'ScreenshotCaption': 'user & pslist being called'}, {'ScreenshotName': 'Carbon Black-APT29-4186.png', 'ScreenshotCaption': 'function pslist 13D'}], 'Footnotes': []}]}]}]}, {'Substep': '14.A.1', 'Procedure': 'Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell', 'Criteria': 'Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command', 'Techniques': [{'TechniqueId': 'T1122', 'TechniqueName': 'Component Object Model Hijacking', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (red indicator) was generated for the setting of a Registry key used by User Account Control (UAC). The alert was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-845.png', 'ScreenshotCaption': 'some bypass auc stuff'}, {'ScreenshotName': 'Bitdefender-APT29-852.png', 'ScreenshotCaption': 'bypass uac alerts need integrity from tomorrow'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value. The telemetry was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-844.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10619.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe calling the bypass function.'}, {'ScreenshotName': 'CrowdStrike-APT29-10627.png', 'ScreenshotCaption': 'Telemetry showing the powershell script block for the bypass function.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for powershell.exe loading code that creates the DelegateExecute Registry key. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2319.png', 'ScreenshotCaption': 'CyCarrier Raw Data: setting DelegateExecute key'}, {'ScreenshotName': 'CyCraft-APT29-2446.png', 'ScreenshotCaption': 'Addition of DelegateExecute registry key through powershell scriptblok logging with enrichments'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block to add the DelegateExecute subkey into the Registry.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12077.png', 'ScreenshotCaption': 'A1/3 - High alert for file deletion on Powershell event showing the addition and then deletion of DelegateExecute'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1439.png', 'ScreenshotCaption': 'registry modify event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of executed function "bypass."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}, {'ScreenshotName': 'F-Secure-APT29-11313.png', 'ScreenshotCaption': 'MSSP - raw function'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a Registry command to add a new value, DelegateExecute. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10309.png', 'ScreenshotCaption': 'function bypass'}, {'ScreenshotName': 'F-Secure-APT29-10311.png', 'ScreenshotCaption': 'delegateexecute and sdclt and open command'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': ' An MSSP detection occurred for the addition of the DelegateExecute Registry value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13032.png', 'ScreenshotCaption': 'MSSP - 14.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11455.png', 'ScreenshotCaption': '14.A.1 - Script block for bypass function (bottom), DelegateExecute value above Remote-Item highlight'}, {'ScreenshotName': 'FireEye-APT29-11452.png', 'ScreenshotCaption': '14.A.1 - Script block for bypass function (top)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (green indicator) called "T1088: User Account Control Bypass (\\Folder\\shell\\open\\command registry key)" was generated for the setting of a Registry key used by User Account Control (UAC).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11392.png', 'ScreenshotCaption': 'regsitry create of open command key, tagged with uac bypass technique, impact of 15'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11392.png', 'ScreenshotCaption': 'regsitry create of open command key, tagged with uac bypass technique, impact of 15'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3785.png', 'ScreenshotCaption': '14.A.1 - CreateKey event'}, {'ScreenshotName': 'HanSight-APT29-3813.png', 'ScreenshotCaption': '14.A.1 - PowerShell command value for DelegateExecute'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence for a well-known UAC bypass technique. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12397.png', 'ScreenshotCaption': '14.a.1-3 MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1847.png', 'ScreenshotCaption': '14.a.1 - delegateexecute added'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated due to a change in Registry value of command key.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-500.png', 'ScreenshotCaption': 'Detection for Suspicious Change Default File Association'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-501.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe setting registry value DelegateExecute for key HKCU\\Software\\Classes\\Folder\\shell\\open\\command.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the addition of DelegateExecute subkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13244.png', 'ScreenshotCaption': '14.A.1, 14.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3186.png', 'ScreenshotCaption': 'Telemetry showing powershell setting and deleting the registry value. (1/2)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3187.png', 'ScreenshotCaption': 'Telemetry showing powershell setting and deleting the registry value. (2/2)'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-177.png', 'ScreenshotCaption': 'reg'}, {'ScreenshotName': 'ReaQta-APT29-178.png', 'ScreenshotCaption': 'reg details'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the addition of DelegateExecute subkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12650.png', 'ScreenshotCaption': 'MSSP - SW - 14A1-3 - overview '}, {'ScreenshotName': 'SecureWorks-APT29-12651.png', 'ScreenshotCaption': 'MSSP - SW - 14A1-3 - event detail'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute subkey.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7056.png', 'ScreenshotCaption': '14.a.1/3 - script block'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1122" occurred containing evidence of "bypass" function definition with Software\\classes\\folder Registry key being modified and leveraged in COM hijacking.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12863.png', 'ScreenshotCaption': 'MSSP - HI PowerShell, SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell function definition of "bypass" which adds the DelegateExecute subkey. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7254.png', 'ScreenshotCaption': 'CC - A1/3 - Powershell alert of bypass function containing add and delete'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9870.png', 'ScreenshotCaption': 'powershell.exe set DelegateExecute registry value'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the addition of the DelegateExecute subkey to enable COM hijacking. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12690.png', 'ScreenshotCaption': 'MSSP - 12C1 - 13 - 14A1/2/3 - 14B2/3/4 ; do not talk about win32_audit code, only show raw data, so not counting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12091.png', 'ScreenshotCaption': '1 - delegate execute'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12767.png', 'ScreenshotCaption': '14.a.1-3 mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13960.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4206.png', 'ScreenshotCaption': 'bypass '}, {'ScreenshotName': 'Carbon Black-APT29-4207.png', 'ScreenshotCaption': 'bypaass'}], 'Footnotes': []}]}]}]}, {'Substep': '14.A.2', 'Procedure': 'Executed elevated PowerShell payload', 'Criteria': 'High integrity powrshell.exe spawning from\xa0control.exe\u200b\u200b (spawned from sdclt.exe)', 'Techniques': [{'TechniqueId': 'T1088', 'TechniqueName': 'Bypass User Account Control', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Bypass User Account Control" was generated for a suspicious process elevation.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-862.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed control.exe spawning a powershell.exe tagged as High Integrity level and possessing elevated process access privileges.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-863.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called “Bypass User Account Control” was generated when the parent powershell.exe process of sdclt.exe attempted to escalated privileges with UAC bypass or UAC elevation. The event was correlated to a parent Technique detection for PowerShell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10625.png', 'ScreenshotCaption': 'A Technique detection called “Bypass User Account Control” from the parent powershell.exe process of sdclt.exe attempting to escalated privileges with UAC bypass or UAC elevation.'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (red indicator) called “Privilege Escalation – Access Token Manipulation” was generated powershell.exe impersonated another user via access token manipulation. The event was correlated to a parent technique detection for PowerShell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10620.png', 'ScreenshotCaption': 'Tactic detection for “Privilege Escalation – Access Token Manipulation” from a powershell.exe process escalating privileges via UAC elevation or token theft. Tactic detection for “Privilege Escalation – Access Token Manipulation” from powershell.exe impersonating another user via access token manipulation.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).  The event was correlated to a parent technique detection for PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10629.png', 'ScreenshotCaption': 'Telemetry showing high integrity powershell spawned.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated showing a new High Integrity PowerShell callback spawned from control.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2320.png', 'ScreenshotCaption': 'CyCarrier Raw Data: sdlct.exe executed in high integrity from powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Bypass User Account Control" was received that included a PowerShell script and explained that it was used to bypass UAC.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12495.png', 'ScreenshotCaption': '14.A.1 - MDR Report Day 2, summary'}, {'ScreenshotName': 'CyCraft-APT29-12498.png', 'ScreenshotCaption': '14.A.2 - MDR Report Day 2, UAC bypass'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red; unique symbol) was generated for "malicious use of powershell.exe" that showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9734.png', 'ScreenshotCaption': '14.a.2 - process details'}, {'ScreenshotName': 'Cybereason-APT29-9731.png', 'ScreenshotCaption': '14.a.2 - powershell.exe malicious use, process tree view'}, {'ScreenshotName': 'Cybereason-APT29-9733.png', 'ScreenshotCaption': '14.a.2 - high integrity from behavior'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9731.png', 'ScreenshotCaption': '14.a.2 - powershell.exe malicious use, process tree view'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed sdclt.exe spawning control.exe, which then spawns powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12298.png', 'ScreenshotCaption': 'A2 - Process tree view of sdclt->control->powershell'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).  The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14971.png', 'ScreenshotCaption': '14a2 - better pic for EG client'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (high severity) was generated due to powershell.exe running with parameters associated with post exploitation payloads.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-15071.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of executed function "bypass."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}, {'ScreenshotName': 'F-Secure-APT29-11313.png', 'ScreenshotCaption': 'MSSP - raw function'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (indicated by the true "elev" flag).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10317.png', 'ScreenshotCaption': 'true elevated tag '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Sdclt Child Process" was generated due to sdclt.exe spawning control.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11441.png', 'ScreenshotCaption': '14.A.2 - Sdclt Child Process of control.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13033.png', 'ScreenshotCaption': 'MSSP - 14.A'}, {'ScreenshotName': 'FireEye-APT29-13032.png', 'ScreenshotCaption': 'MSSP - 14.A'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green indicator) called "User Account Control Bypass" was generated due to the PowerShell callback spawned from control.exe. The event was correlated to a parent General detection for a suspicious process', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11394.png', 'ScreenshotCaption': 'sdclt spawning control.exe'}, {'ScreenshotName': 'GoSecure-APT29-11392.png', 'ScreenshotCaption': 'regsitry create of open command key, tagged with uac bypass technique, impact of 15'}, {'ScreenshotName': 'GoSecure-APT29-11396.png', 'ScreenshotCaption': 'same relationship graph with the control.exe  highlighted. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The event was correlated to a parent General detection for a suspicious process', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11396.png', 'ScreenshotCaption': 'same relationship graph with the control.exe  highlighted. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection "Bypass UAC Attempt by TokenElevationType" (warning severity) was generated due to control.exe spawning powershell.exe with high privileges.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3818.png', 'ScreenshotCaption': '14.A.2 - UAC bypass for control.exe spawning high integrity powershell.exe'}, {'ScreenshotName': 'HanSight-APT29-3821.png', 'ScreenshotCaption': '14.A.2 - Bypass User Account Control'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red; high severity) for "Suspicious PowerShell" was generated due to execution of powershell.exe by control.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-17915.png', 'ScreenshotCaption': '14a2 - new vendor pic'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12397.png', 'ScreenshotCaption': '14.a.1-3 MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1844.png', 'ScreenshotCaption': '14.a.2 - control.exe'}], 'Footnotes': ['MVISION Endpoint would have blocked the malicious script from running in the PowerShell session due to a Real Protect machine learning model detection. ']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for UAC bypass (medium severity) was generated. The detection included  sdclt.exe executing with elevated permissions.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17381.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Microsoft-APT29-502.png', 'ScreenshotCaption': 'Detection for UAC bypass (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a High Integrity powershell.exe process executing from control.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-503.png', 'ScreenshotCaption': 'Detection for UAC bypass (2 of 2)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13244.png', 'ScreenshotCaption': '14.A.1, 14.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3379.png', 'ScreenshotCaption': 'Telemetry showing the elevated powershell spawning from sdclt.exe.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3380.png', 'ScreenshotCaption': 'Telemetry showing the elevated powershell integrity level.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection (orange indicator) called "Bypass User Account Control" was generated on the PowerShell callback spawned from control.exe. The detection was correlated to a parent alert for suspicious file deobfuscation via certutil.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-176.png', 'ScreenshotCaption': 'sdclt > control.exe > powershell (all those with red alerts); have command line; bypass uac mitre tag; network connection'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell elevated privileges by bypassing UAC.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13772.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-12785.png', 'ScreenshotCaption': '14.a.3 - mssp report attack mapping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7055.png', 'ScreenshotCaption': '14.a.2 - process tree with pid showing admin value'}, {'ScreenshotName': 'SecureWorks-APT29-7051.png', 'ScreenshotCaption': '14.a.2 - process tree'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1088" occurred containing evidence of a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe) with TokenMismatch indicator.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12863.png', 'ScreenshotCaption': 'MSSP - HI PowerShell, SBL'}, {'ScreenshotName': 'SentinelOne-APT29-12860.png', 'ScreenshotCaption': 'MSSP - TokenMissmatch, new ps session, sdlc.exe usage (medium integrity)'}, {'ScreenshotName': 'SentinelOne-APT29-12861.png', 'ScreenshotCaption': 'MSSP - sdclt -> control.exe, sdclt (high integ)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6850.png', 'ScreenshotCaption': 'A2 - Detailed process creation of control.exe at HI as well as encoded powershell command being executed'}, {'ScreenshotName': 'SentinelOne-APT29-6851.png', 'ScreenshotCaption': 'A2 - Process tree of HI powershell spawned from control.exe spawned from sdclt.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "UAC Bypass" was generated when the setting of registry values associated with COM Hijacking was followed by execution of a program known to be associated with UAC bypasses. The event was correlated to a parent Tactic detection called "Execution" that was generated when explorer.exe executed powershell.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9740.png', 'ScreenshotCaption': 'Suspected UAC bypass in the context of an Incident Report. Detection is based on COM Hijacking followed by execution of UAC "bypassable" executables'}, {'ScreenshotName': 'Symantec-APT29-9737.png', 'ScreenshotCaption': 'Suspected UAC Bypass, with execution of powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9752.png', 'ScreenshotCaption': 'Shows lineage of processes, with change in integrity levels, and command-line arguments showing the stager.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for sdclt.exe spawning a High Integrity level PowerShell. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12690.png', 'ScreenshotCaption': 'MSSP - 12C1 - 13 - 14A1/2/3 - 14B2/3/4 ; do not talk about win32_audit code, only show raw data, so not counting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent alert for  PowerShell executing an ADS.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12143.png', 'ScreenshotCaption': 'a2 - view for sdclt > control > powershell'}, {'ScreenshotName': 'TrendMicro-APT29-12099.png', 'ScreenshotCaption': '2 - IL for PS'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for bypassing UAC with sdclt.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4195.png', 'ScreenshotCaption': 'sdclt alert details'}, {'ScreenshotName': 'Carbon Black-APT29-4194.png', 'ScreenshotCaption': 'UAC alert'}, {'ScreenshotName': 'Carbon Black-APT29-4193.png', 'ScreenshotCaption': 'uac bypass sdclt alert'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection was generated for supicious privilege escalation process behavior by PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4193.png', 'ScreenshotCaption': 'uac bypass sdclt alert'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell elevating privileges via a UAC bypass using sdclt.exe and control.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12767.png', 'ScreenshotCaption': '14.a.1-3 mssp alert'}], 'Footnotes': []}]}]}]}, {'Substep': '14.A.3', 'Procedure': 'Modified the Registry to remove artifacts of COM hijacking using PowerShell', 'Criteria': 'Deletion of\xa0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\xa0subkey', 'Techniques': [{'TechniqueId': 'T1112', 'TechniqueName': 'Modify Registry', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-884.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10619.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe calling the bypass function.'}, {'ScreenshotName': 'CrowdStrike-APT29-10627.png', 'ScreenshotCaption': 'Telemetry showing the powershell script block for the bypass function.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was received that included a PowerShell script and explained that it was used to clean the Registry after a UAC Bypass.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12498.png', 'ScreenshotCaption': '14.A.2 - MDR Report Day 2, UAC bypass'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command to delete the Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12077.png', 'ScreenshotCaption': 'A1/3 - High alert for file deletion on Powershell event showing the addition and then deletion of DelegateExecute'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the system was interrogated and the Registry key could not be found indicating it had been deleted, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13682.png', 'ScreenshotCaption': 'endgame client reg delete maybe??'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the deletion of the Registry value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11313.png', 'ScreenshotCaption': 'MSSP - raw function'}, {'ScreenshotName': 'F-Secure-APT29-11302.png', 'ScreenshotCaption': 'MSSP - day2 executive summary pt1'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the deletion of the command subkey Registry value. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13033.png', 'ScreenshotCaption': 'MSSP - 14.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell command to delete the Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11456.png', 'ScreenshotCaption': '14.A.3 - Script block for Remove-Item on Registry'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Registry key deleted" was generated due to the deletion of the Registry value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11397.png', 'ScreenshotCaption': 'registry delete 14.a.3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11397.png', 'ScreenshotCaption': 'registry delete 14.a.3'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3786.png', 'ScreenshotCaption': '14.A.3 - DeleteKey event'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-504.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing the deletion of HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3187.png', 'ScreenshotCaption': 'Telemetry showing powershell setting and deleting the registry value. (2/2)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3186.png', 'ScreenshotCaption': 'Telemetry showing powershell setting and deleting the registry value. (1/2)'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-179.png', 'ScreenshotCaption': 'reg del'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Defense Evasion - Modify Registry" occurred containing evidence of deletion of Registry value using Remote-Item.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12651.png', 'ScreenshotCaption': 'MSSP - SW - 14A1-3 - event detail'}, {'ScreenshotName': 'SecureWorks-APT29-12785.png', 'ScreenshotCaption': '14.a.3 - mssp report attack mapping'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the DelegateExecute subkey.\t\n', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7056.png', 'ScreenshotCaption': '14.a.1/3 - script block'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1112" occurred containing evidence of "bypass" function definition removing Registry subkey.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12863.png', 'ScreenshotCaption': 'MSSP - HI PowerShell, SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe deleting the command subkey. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7254.png', 'ScreenshotCaption': 'CC - A1/3 - Powershell alert of bypass function containing add and delete'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Modify Registry" was received that included a PowerShell command executed by the adversary and explained that it was used to delete the Registry Key.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12963.png', 'ScreenshotCaption': 'MSSP Day 1: UAC Bypass techniques and description'}, {'ScreenshotName': 'Symantec-APT29-12964.png', 'ScreenshotCaption': 'MSSP Day 1: UAC Bypass details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9871.png', 'ScreenshotCaption': 'powershell.exe deleted registry key'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell removing the Registry value. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12690.png', 'ScreenshotCaption': 'MSSP - 12C1 - 13 - 14A1/2/3 - 14B2/3/4 ; do not talk about win32_audit code, only show raw data, so not counting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for  PowerShell executing an ADS.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12098.png', 'ScreenshotCaption': '3 - PS deleting reg key - RCA'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the deletion of the DelegateExecute Registry value.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12767.png', 'ScreenshotCaption': '14.a.1-3 mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4205.png', 'ScreenshotCaption': 'deleted registry keys'}, {'ScreenshotName': 'Carbon Black-APT29-4207.png', 'ScreenshotCaption': 'bypaass'}], 'Footnotes': []}]}]}]}, {'Substep': '14.B.1', 'Procedure': 'Created and executed a WMI class using PowerShell', 'Criteria': 'WMI Process (WmiPrvSE.exe) executing powershell.exe', 'Techniques': [{'TechniqueId': 'T1047', 'TechniqueName': 'Windows Management Instrumentation', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a local process created using WMI. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-888.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-874.png', 'ScreenshotCaption': 'local porocess call '}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a WMI action using a custom provider. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-907.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-875.png', 'ScreenshotCaption': 'wmiaction that is using a custom provider'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for PowerShell executed using WMI. The alert was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13414.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-905.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert was generated for the creation of a new WMI class. The alert was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-886.png', 'ScreenshotCaption': 'auditcode'}, {'ScreenshotName': 'Bitdefender-APT29-874.png', 'ScreenshotCaption': 'local porocess call '}, {'ScreenshotName': 'Bitdefender-APT29-887.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for execution via PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10633.png', 'ScreenshotCaption': 'Telemetry showing WmiPrvSE.exe executed powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Execution" with "T1047 Windows Management Instrumentation" label was generated for WmiPrvSE.exe executing powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-14976.png', 'ScreenshotCaption': '14b1_1 new image from vendor'}, {'ScreenshotName': 'CyCraft-APT29-14975.png', 'ScreenshotCaption': '14b1_2 new image from vendor'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Windows Management Instrumentation" was received that included a PowerShell script and explained that it was used to set up execution of Mimikatz.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12499.png', 'ScreenshotCaption': '14.B.1 - MDR Report Day 2, WMI dump'}, {'ScreenshotName': 'CyCraft-APT29-12500.png', 'ScreenshotCaption': '14.B.1 - MDR Report Day 2, invoke wmidump'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9749.png', 'ScreenshotCaption': '14.b.1 - process tree with wmiprvse.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) called "GUARD: Unusual Powershell Parent Process" was generated on powershell.exe with parent process WmiPrvSE.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12083.png', 'ScreenshotCaption': 'B1 - Medium alert for Unusual powershell parent process - WmiPrvSE.exe executing powershell.exe\n'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Potential Code Execution via WMI-based PowerShell Cmdlet" was generated for PowerShell using WMI. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1444.png', 'ScreenshotCaption': 'potential code execution via wmi alert'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Suspicious Execution via WMI" was generated for PowerShell using WMI. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1462.png', 'ScreenshotCaption': 'suspicious execution via wmi (from powershell) win32 process create'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ATT&CK T1047 Windows Management Instrumentation" was generated for PowerShell using WMI. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1445.png', 'ScreenshotCaption': 'process created via wmi event for child powershell with wmi enrichment'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1444.png', 'ScreenshotCaption': 'potential code execution via wmi alert'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Windows Management Instrumentation was generated due to WMI starting a system process it normally doesn’t start.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10342.png', 'ScreenshotCaption': 'wmi doest start a process it normally starts'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17370.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell WMI Activity" was generated for WmiPrvSE.exe executing powershell.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11470.png', 'ScreenshotCaption': '14.B.1 - PowerShell WMI Activity'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "WMI Process Creation" was generated due to a process being started by WMI.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11467.png', 'ScreenshotCaption': '14.B.1 - WMI Process Creation of powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11398.png', 'ScreenshotCaption': 'wmi  spawning powershell, impact 100 (encoded command), obfustacted files and powershell technique intelligence. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "WMI create child process" (Warning severity) was generated for WmiPrvSE.exe executing powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3829.png', 'ScreenshotCaption': '14.B.1 - WmiPrvSe.exe spawning powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; high severity) called "commandline_wmi_event_consumer_triggered"  was generated due to WmiPrvSE.exe executing powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3210.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Kaspersky-APT29-3208.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of WmiPrvSE.exe executing powershell.exe to execute the Win32_AuditCode WMI class.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12398.png', 'ScreenshotCaption': '14.b.1 MSSP report #1'}, {'ScreenshotName': 'Kaspersky-APT29-12399.png', 'ScreenshotCaption': '14.b.1 MSSP report #2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3210.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1854.png', 'ScreenshotCaption': '14.b.1 - wmiprvse launches ps'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Windows Management Instrumentation was generated from WmiPrvSE.exe executing powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-506.png', 'ScreenshotCaption': 'Technique detection for suspicious WMI process creation'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17400.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe executed by WMI. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3383.png', 'ScreenshotCaption': 'CC-1 - process spawning powershell'}], 'Footnotes': ['The way this data was presented was altered after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red incator) called "WMI Process Created" was generated for WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for suspicious file deobfuscation via certutil.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-180.png', 'ScreenshotCaption': 'red ps; wmi process create; spawns ps'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7067.png', 'ScreenshotCaption': '14.b.1 - event details execution powershell'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "WMI Operation" under "Execution {T1047}" was generated on Win32_AuditCode usage. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6874.png', 'ScreenshotCaption': 'B1/5/6 - WMI operation has occured'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "WMI Operation" occurred containing evidence of Win32_AuditCode usage. WmiPrvSE.exe executed powershell.exe with decoded payload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12864.png', 'ScreenshotCaption': 'MSSP - B1 - WMI usage'}, {'ScreenshotName': 'SentinelOne-APT29-12865.png', 'ScreenshotCaption': 'MSSP - SBL and process creation'}, {'ScreenshotName': 'SentinelOne-APT29-12866.png', 'ScreenshotCaption': 'MSSP - powershell parent process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6880.png', 'ScreenshotCaption': 'B1- wmiPrvSe.exe executing powershell'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic detection called "Execution" was generated when wmiprvse.exe launched powershell.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17707.png', 'ScreenshotCaption': '14b1 - tactic execution'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "WMI" was received that included a PowerShell command executed by the adversary and explained that it was used to execute PowerShel through WMI that downloads and executes mimikatz.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12962.png', 'ScreenshotCaption': 'MSSP Day 1: wmidump'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9755.png', 'ScreenshotCaption': 'wmiprvse.exe executing powershell.exe stager'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Windows Management Instrumentation" was generated due to WmiPrvSE.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12096.png', 'ScreenshotCaption': 'alert wmiprsv'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17676.png', 'ScreenshotCaption': '14.B.1 - RCA view of WmiPrvSE.exe executing PS'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for Windows Management Instrumentation was generated for WmiPrvSE.exe executing powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4236.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4235.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for Privilege Escalation was generated for suspicious PowerShell behavior. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4232.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSe.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4223.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4221.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '14.B.2', 'Procedure': 'Enumerated and tracked PowerShell processes using PowerShell', 'Criteria': 'powershell.exe executing Get-Process', 'Techniques': [{'TechniqueId': 'T1057', 'TechniqueName': 'Process Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert was generated for the execution of a PowerShell process discovery command.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1103.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-1102.png', 'ScreenshotCaption': 'config change'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.', 'Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10647.png', 'ScreenshotCaption': 'Telemetry showing PowerShell executing Get-Process. Telemetry showing PowerShell executing Get-WmiObject to read encoded content from Win32_AuditCode.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Process Discovery" was generated for PowerShell executing Get-Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2456.png', 'ScreenshotCaption': 'get-wmiobject with enrichments in graph view'}, {'ScreenshotName': 'CyCraft-APT29-2450.png', 'ScreenshotCaption': 'Get-process with enrichments'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Process Discovery" occurred containing evidence of PowerShell Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10795.png', 'ScreenshotCaption': 'MSSP - get process '}, {'ScreenshotName': 'Cybereason-APT29-10796.png', 'ScreenshotCaption': 'MSSP - description of get-process'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Win_GetSystemProcess_Powershell_MITRET1057" was generated due to powershell.exe executing Get-Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12087.png', 'ScreenshotCaption': 'B2 - Medium GetSystemProcess alert and SBL showing Get-Process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Process Discovery via WMI" was generated for PowerShell executing Get-Process. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13697.png', 'ScreenshotCaption': 'process discovery via wmi alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1449.png', 'ScreenshotCaption': 'get process from script block event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10335.png', 'ScreenshotCaption': 'get process'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13036.png', 'ScreenshotCaption': 'MSSP - 14.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11500.png', 'ScreenshotCaption': '14.B.2 - Script block for Get-Process'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (reminder severity) called "Process Discovery via PowerShell"  was generated due to PowerShell executing Get-Process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3844.png', 'ScreenshotCaption': '14.B.2 - ATT&CK mapping'}, {'ScreenshotName': 'HanSight-APT29-3843.png', 'ScreenshotCaption': '14.B.2 - Get-Process used'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell collecting information about running processes.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12402.png', 'ScreenshotCaption': '14.b.2 - MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process. Script preview was truncated so an alternate view was shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-510.png', 'ScreenshotCaption': 'Beautified script block with Get-Process'}, {'ScreenshotName': 'Microsoft-APT29-509.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with Get-Process.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-314.png', 'ScreenshotCaption': 'cc - get process'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - Process Discovery" occurred containing evidence of PowerShell Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12652.png', 'ScreenshotCaption': 'MSSP - SW - 14AB2 - win32 audit code and commands '}, {'ScreenshotName': 'SecureWorks-APT29-12653.png', 'ScreenshotCaption': 'MSSP - SW - 14AB2 - event detail'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7057.png', 'ScreenshotCaption': '14.b.1 - wmidump function'}, {'ScreenshotName': 'SecureWorks-APT29-7062.png', 'ScreenshotCaption': '14.b.1/2/6 - wmidump event details'}, {'ScreenshotName': 'SecureWorks-APT29-7061.png', 'ScreenshotCaption': '14.b.1/2/6 -getwmiobject from full script picture'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "ProcessEnumeration" under "Discovery {T1057}" was generated for PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6876.png', 'ScreenshotCaption': 'B2 - Process enumeration alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7258.png', 'ScreenshotCaption': 'CC - B2 - Powershell alert of command containing get-process'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "PS1.ProcessDiscover T1057" was generated due to powershell.exe executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12110.png', 'ScreenshotCaption': '14.B.1 - PS1.ProcessDiscover Grey Detection'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing Get-Process.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12690.png', 'ScreenshotCaption': 'MSSP - 12C1 - 13 - 14A1/2/3 - 14B2/3/4 ; do not talk about win32_audit code, only show raw data, so not counting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12104.png', 'ScreenshotCaption': 'b2 - Get-Process - scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) was generated for PowerShell enumerating processes. The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4223.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Get-Process.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}]}]}, {'Substep': '14.B.3', 'Procedure': 'Downloaded and dropped Mimikatz (m.exe) to disk', 'Criteria': 'powershell.exe downloading and/or the file write of m.exe', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Command and Control', 'TacticId': 'TA0011'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection was generated for a resource being downloaded via HTTP.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-896.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for powershell.exe writing a binary in a suspicious location. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-876.png', 'ScreenshotCaption': 'alerts'}, {'ScreenshotName': 'Bitdefender-APT29-894.png', 'ScreenshotCaption': 'sus binary with att&ck'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a HTTP GET request over port 8080 to download m.exe. Telemetry also showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-879.png', 'ScreenshotCaption': 'm.exe downloaded port'}, {'ScreenshotName': 'Bitdefender-APT29-897.png', 'ScreenshotCaption': 'signed file'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection called "NewExecutableWritten" was generated was generated for the PowerShell command to download m.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-15003.png', 'ScreenshotCaption': '14b3-new vendor screenshot'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert for Execution via Powershell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10634.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe with an executable write and a file written event for m.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (purple indicator) was generated identifying the PowerShell command to download m.exe as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2339.png', 'ScreenshotCaption': 'CyCarrier Raw Data: scriptblock for wmidump, 3,5.'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (purple indicator) was generated showed the file write event for m.exe into the System32 folder.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2452.png', 'ScreenshotCaption': 'File Creation of m.exe with enrichments'}, {'ScreenshotName': 'CyCraft-APT29-2342.png', 'ScreenshotCaption': 'CyCarrier Raw Data: File creation of m.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': "A General alert detection (unique symbol) was generated for using PowerShell to execute suspicious 'download' commands. The detection was correlated to a parent alert for the malicious use of powershell.exe. ", 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9742.png', 'ScreenshotCaption': '14.b.3 - alerts list, mimikatz'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file create event for m.exe into the System32 folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12082.png', 'ScreenshotCaption': 'B3/5 - Medium alert for powershell base64 execution showing SBL and Set-WmiInstance'}, {'ScreenshotName': 'Cylance-APT29-13860.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) for "Suspicious Download Command via PowerShell" was generated for the PowerShell command to download m.exe. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13638.png', 'ScreenshotCaption': 'suspicious download alert pulling down mimikatz'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1450.png', 'ScreenshotCaption': 'm file create event from powershell'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) was generated for a suspicious download by PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10250.png', 'ScreenshotCaption': 'ip address and port 443 and HTTPS '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the download and file write of m.exe into System32 folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-13276.png', 'ScreenshotCaption': 'MSSP Summary'}, {'ScreenshotName': 'F-Secure-APT29-11314.png', 'ScreenshotCaption': 'MSSP - wc function - no context'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for m.exe in the System32 folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10346.png', 'ScreenshotCaption': 'file create of m.exe'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell File Write" was generated for PowerShell writing m.exe to disk.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11484.png', 'ScreenshotCaption': '14.B.3 - PowerShell File Write for m.exe (top)'}, {'ScreenshotName': 'FireEye-APT29-11485.png', 'ScreenshotCaption': '14.B.3 - PowerShell File Write for m.exe (bottom)'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell URL Request" was generated due to a URL request from PowerShell for m.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11473.png', 'ScreenshotCaption': '14.B.3 - PowerShell URL Request for m.exe'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for suspicious PowerShell usage with encoded commands associated with download cradles.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11463.png', 'ScreenshotCaption': '14.B.1 - PowerShell Encoded Remote Download (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11462.png', 'ScreenshotCaption': '14.B.1 - PowerShell Encoded Remote Download (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of m.exe in the System32 folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13035.png', 'ScreenshotCaption': 'MSSP - 14.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file write event for m.exe into the System32 folder.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of m.exe in the System32 folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12714.png', 'ScreenshotCaption': '14.b.3-4 MSSP alert #1'}, {'ScreenshotName': 'GoSecure-APT29-12715.png', 'ScreenshotCaption': '14.b.3-4 MSSP alert #2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for m.exe into the System32 folder. The event was correlated to a parent detection on "PowerShell with Encoded Command Launched."', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11399.png', 'ScreenshotCaption': 'file create of m.exe, with score of 69% (malicious file based ono md5). '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "Suspicious Powershell Download" was generated for the PowerShell command to download m.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3847.png', 'ScreenshotCaption': '14.B.3 - powershell.exe download of m.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell command to download m.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for m.exe into the System32 folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3227.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Kaspersky-APT29-3225.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for m.exe into the System32 folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1850.png', 'ScreenshotCaption': '14.b.3 - m.exe with original name mimikatz'}], 'Footnotes': ['MVISION Endpoint would have blocked the malicious script thanks to a signature-based detection for code being executed in a PowerShell session.']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for m.exe into the System32 folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-511.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating C:\\Windows\\System32\\m.exe.'}], 'Footnotes': ['This activity would have been blocked by Microsoft Defender.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for an executable created by a Windows scripting engine. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13720.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of m.exe in the System32 folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13245.png', 'ScreenshotCaption': '14.B.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell command to download m.exe as well as the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13715.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-3189.png', 'ScreenshotCaption': 'Telemetry showing file create and write of m.exe.'}], 'Footnotes': ['According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware.']}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated for "Executable Dropped," which showed the download and file write of m.exe into the System32 folder via PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-181.png', 'ScreenshotCaption': 'ps branch (branched from other screenshot); has executable dropped, and connection'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for m.exe into the System32 folder.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of Powershell creating m.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13773.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell command to download m.exe into the System32 folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7069.png', 'ScreenshotCaption': '14.b.3/5/6 script event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "FileModification" occurred containing evidence of file write and analysis of m.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12867.png', 'ScreenshotCaption': 'MSSP - powershell, get-process, m.exe being dropped.'}, {'ScreenshotName': 'SentinelOne-APT29-12869.png', 'ScreenshotCaption': 'MSSP - M.exe analysis'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17875.png', 'ScreenshotCaption': '14.B.3 - File creation for m.exe'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Remote File Copy" was generated when powershell.exe generated network traffic immediately followed by creation of an executable file. The event was correlated to a previous event showing wmiprvse.exe executing powershell.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12906.png', 'ScreenshotCaption': 'Incident report showing events correlated to wmiprvse.exe executing powershell.exe'}, {'ScreenshotName': 'Symantec-APT29-9759.png', 'ScreenshotCaption': 'Shows sequence of network connection and file creation of m.exe'}, {'ScreenshotName': 'Symantec-APT29-9758.png', 'ScreenshotCaption': 'Highlighted text indicates that Remote File Copy tag was due to network traffic immediately followed by file creation.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Remote File Copy" was received that included a PowerShell command executed by the adversary and explained that it was used to download m.exe from a remote server.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12962.png', 'ScreenshotCaption': 'MSSP Day 1: wmidump'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for m.exe into the System32 folder.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9757.png', 'ScreenshotCaption': 'reputation request and file creation event for m.exe, tagged with Remote File Copy'}, {'ScreenshotName': 'Symantec-APT29-9759.png', 'ScreenshotCaption': 'Shows sequence of network connection and file creation of m.exe'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for "Malicious content" due to the HTTP download of m.exe. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12365.png', 'ScreenshotCaption': 'CC - 3 - mimikatz download - DDI '}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell downloading m.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12690.png', 'ScreenshotCaption': 'MSSP - 12C1 - 13 - 14A1/2/3 - 14B2/3/4 ; do not talk about win32_audit code, only show raw data, so not counting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for  PowerShell executing an ADS.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12100.png', 'ScreenshotCaption': '3/4 - PS > m.exe with command line args'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for .Net attempting suspicious network connections. The detection was correlated to a parent alert for Windows Management Instrumentation.\t', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4232.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.\t', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14756.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for PowerShell with network connections spawned by WMI. The detection was correlated to a parent alert for Windows Management Instrumentation.\t', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4237.png', 'ScreenshotCaption': 'netconns launched'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4242.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4219.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '14.B.4', 'Procedure': 'Dumped plaintext credentials using Mimikatz (m.exe)', 'Criteria': 'm.exe injecting into lsass.exe to dump credentials', 'Techniques': [{'TechniqueId': 'T1003', 'TechniqueName': 'Credential Dumping', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a process memory read. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-902.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-881.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-901.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for m.exe loading a credential related DLL, identified as a possible attempt to dump credentials. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-900.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-881.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identifying powershell.exe executing m.exe as Mimikatz malware. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-878.png', 'ScreenshotCaption': 'mimi'}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called “Credential Dumping” was generated LSASS process was accessed by Mimikatz (m.exe). The detection was correlated to a parent alert for Execution via Powershell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10635.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for m.exe reading LSASS memory. A Technique detection called “Credential Dumping” for mimikatz (m.exe) accessing LSASS process.'}, {'ScreenshotName': 'CrowdStrike-APT29-10641.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for mimikatz (m.exe) accessing LSASS process. A General detection called “Machine Learning via Sensor-based ML” for m.exe meeting on-sensor AV protection’s high confidence threshold for malicious files.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called “Credential Dumping” was generated when m.exe read LSASS memory. The detection was correlated to a parent alert for Execution via Powershell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10635.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for m.exe reading LSASS memory. A Technique detection called “Credential Dumping” for mimikatz (m.exe) accessing LSASS process.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called “Credential Dumping” was generated when Mimikatz (m.exe) launched. The detection was correlated to a parent alert for Execution via Powershell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10643.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for mimikatz (m.exe) launching. A Technique detection called “Credential Dumping” for an encoded powershell payload script launching a mimikatz process (m.exe).'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called “Credential Dumping” was generated when the encoded powershell payload script launched a mimikatz process (m.exe) . The detection was correlated to a parent alert for Execution via Powershell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10643.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for mimikatz (m.exe) launching. A Technique detection called “Credential Dumping” for an encoded powershell payload script launching a mimikatz process (m.exe).'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called “Machine Learning via Sensor-based ML” was generated when m.exe met machine learning-based on-sensor AV protection’s high confidence threshold for malicious files. The detection was correlated to a parent alert for Execution via Powershell.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10641.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for mimikatz (m.exe) accessing LSASS process. A General detection called “Machine Learning via Sensor-based ML” for m.exe meeting on-sensor AV protection’s high confidence threshold for malicious files.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) of "Credential Dumping" was generated for command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2453.png', 'ScreenshotCaption': 'execution of m.exe with enrichments in graph view'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) of "Credential Dumping" was generated for dumping credentials/keys from Lsass process memory', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2454.png', 'ScreenshotCaption': 'Threat activity alert for m.exe with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Credential Dumping" was received that described the adversary executing m.exe to access LSASS process memory.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12501.png', 'ScreenshotCaption': '14.B.3,4 - MDR Report Day 2, m.exe creation & access lsass'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Credential Theft" was generated for command-line arguments indicative of Mimikatz credential dumping and accessing Lsass. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9750.png', 'ScreenshotCaption': '14.b.4 - commandline with sekurlsa logonpasswords'}, {'ScreenshotName': 'Cybereason-APT29-9751.png', 'ScreenshotCaption': '14.b.4 - evidence with process access to lsass'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "GUARD: Possible Mimikatz" was generated when command-line arguments contained "sekurlsa".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12081.png', 'ScreenshotCaption': 'B4 - High alert for possible execution of mimikatz with CLI args'}], 'Footnotes': ['According to the vendor, this would have been prevented due to sekurlsa usage.']}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) called "Win_Process_Dump_MITRET1005" was generated based on the detection of the dumping of process memory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12086.png', 'ScreenshotCaption': 'B4 - Medium Alert for process dump'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "Credential Dumping" was generated for the execution of m.exe executing with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1452.png', 'ScreenshotCaption': 'cred dumping alert, shows high sev'}, {'ScreenshotName': 'Elastic-APT29-1453.png', 'ScreenshotCaption': 'cred dumping alert for m.exe-lsass.exe,  showing details'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Mimikatz command line parameters" was generated due to m.exe executing with command-line arguments indicative of Mimikatz credential dumping. This detection was correlated to a parent alert for privilege escalation.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10348.png', 'ScreenshotCaption': 'm.exe executing password udmper executed'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Password Dumper Executed" was generated due to a known password hash dumper running. This detection was correlated to a parent alert for privilege escalation.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10348.png', 'ScreenshotCaption': 'm.exe executing password udmper executed'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of Mimikatz execution.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-13276.png', 'ScreenshotCaption': 'MSSP Summary'}, {'ScreenshotName': 'F-Secure-APT29-11314.png', 'ScreenshotCaption': 'MSSP - wc function - no context'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "MIMIKATZ SUSPICIOUS PROCESS ARGUMENTS A (METHODOLOGY)" was generated for the execution of m.exe executing with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11474.png', 'ScreenshotCaption': '14.B.4 - Process arguments indicating Mimikatz'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "Vaultcli.dll Load" was generated due to a non-standard process, m.exe, loading vaultcli.dll.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11482.png', 'ScreenshotCaption': '14.B.4 - Vaultcli.dll load by m.exe (top)'}, {'ScreenshotName': 'FireEye-APT29-11483.png', 'ScreenshotCaption': '14.B.4 - Vaultcli.dll load by m.exe (bottom)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for m.exe being Mimikatz malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11491.png', 'ScreenshotCaption': '14.B.4 - Mimikatz malware alert for m.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of Mimikatz dumping credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13036.png', 'ScreenshotCaption': 'MSSP - 14.B'}, {'ScreenshotName': 'FireEye-APT29-13035.png', 'ScreenshotCaption': 'MSSP - 14.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process access into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11489.png', 'ScreenshotCaption': '14.B.4 - Process Guard Watcher for m.exe access to lsass.exe'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a "Malicious file executed" for the execution of m.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11402.png', 'ScreenshotCaption': 'another view of the process create, other one probably better for tags) note it could have been blocked. '}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the execution of m.exe with Mimikatz arguments.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12714.png', 'ScreenshotCaption': '14.b.3-4 MSSP alert #1'}, {'ScreenshotName': 'GoSecure-APT29-12715.png', 'ScreenshotCaption': '14.b.3-4 MSSP alert #2'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Warning severity) called "Credential Dumping Commandline" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3863.png', 'ScreenshotCaption': '14.B.4 - Credential Dumping Commandline for Mimikatz '}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Warning severity) called "Credential Dumping via lsass access" was generated due to m.exe requesting access to lsass.exe with Access Mask 0x1010.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3859.png', 'ScreenshotCaption': '14.B.4 - Access permission 0x1010 with operation target lsass.exe'}, {'ScreenshotName': 'HanSight-APT29-3857.png', 'ScreenshotCaption': '14.B.4 - Credential Dumping via lsass access'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; high severity) called "mimikatz_command_patterns" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3231.png', 'ScreenshotCaption': '14.b.4 - m.exe with cmd line args'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of Mimikatz dumping credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12403.png', 'ScreenshotCaption': '14.b.4 MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Credential Dumping"  was generated due to m.exe executing with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2571.png', 'ScreenshotCaption': 'Credential dumping alert'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "Credential Dumping" was generated due the suspicious indicator "Mimikatz executed a credential dumping module."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1851.png', 'ScreenshotCaption': '14.b.4 - cred dump'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Credential Dumping" was generated due the suspicious indicator "LSASS process memory read by other process."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1852.png', 'ScreenshotCaption': '14.b.4 - cred dump #2'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "Credential Dumping"  was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-515.png', 'ScreenshotCaption': 'Technique detection for malicious credential theft tool execution detected'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Credential Dumping"  was generated due to suspected credential theft activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-514.png', 'ScreenshotCaption': 'Technique detection for suspected credential theft activity'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe opening lsass.exe with OpenProcess.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17882.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for Credential Dumping was generated for PowerShell reading credentials from Lsass memory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3192.png', 'ScreenshotCaption': 'Technique detection of Credential Dumping for m.exe reading credentials from lsass memory. (2/2)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3191.png', 'ScreenshotCaption': 'Technique detection of Credential Dumping for m.exe reading credentials from lsass memory. (1/2)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3193.png', 'ScreenshotCaption': 'Technique detection for Credential Dumping overview.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Command line arguments matching Mimikatz execution" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3190.png', 'ScreenshotCaption': 'Tactic detection of Credential Access by m.exe in the process tree.'}], 'Footnotes': ['According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware.']}, {'DetectionType': 'General', 'DetectionNote': 'A General alert was generated identifying m.exe as malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13719.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of m.exe in the System32 folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13250.png', 'ScreenshotCaption': '14.B.4, 14.B.5 (B) - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13246.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed a process event for m.exe (identified as Mimikatz) with command-line arguments and binary metadata.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-183.png', 'ScreenshotCaption': 'clean view - mimikatz'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Credential Dumping" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7071.png', 'ScreenshotCaption': '14.b.4 - alert details mimikatz activity sekurlsa'}, {'ScreenshotName': 'SecureWorks-APT29-7074.png', 'ScreenshotCaption': '14.b.4 - process tree'}, {'ScreenshotName': 'SecureWorks-APT29-7073.png', 'ScreenshotCaption': '14.b.4 - process overview'}, {'ScreenshotName': 'SecureWorks-APT29-7072.png', 'ScreenshotCaption': '14.b.1/4 - technique mappings credential dumping'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Credential Dumping" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7077.png', 'ScreenshotCaption': '14.b.4 - technique mappings from alert'}, {'ScreenshotName': 'SecureWorks-APT29-7078.png', 'ScreenshotCaption': '14.b.4 - process overview sekurlsa logonpasswords'}, {'ScreenshotName': 'SecureWorks-APT29-7079.png', 'ScreenshotCaption': '14.b.4 - full process tree'}, {'ScreenshotName': 'SecureWorks-APT29-7080.png', 'ScreenshotCaption': '14.b.4 - alert details mimikatz activity-privilege'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing Mimikatz to obtain login credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12656.png', 'ScreenshotCaption': 'MSSP - SW - 14AB5-6 - overview'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "SensitiveMemoryAccess" under "Credential Access {T1003}" was generated when m.exe read sensitive memory from lsass.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6870.png', 'ScreenshotCaption': 'B4 - Sensitive memory Access alert for m.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1003" occurred containing evidence of Mimikatz sekurlsa::logonpasswords usage via m.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12870.png', 'ScreenshotCaption': 'MSSP - m.exe CLI args, wmidump call/definition'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry shows a remote process injection into lsass.exe by Mimikatz. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Credential Dumping" was generated when m.exe read Lsass memory. The detection was correlated to a parent alert for wmiprvse.exe executing powershell.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17709.png', 'ScreenshotCaption': '14b4 - technique - reading of lsass'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Credential Dumping" was generated when powershell.exe loaded cryptography DLLs and attempted to inject into lsass.exe, and again when powershell.exe successfully injected into lsass.exe. The detection was correlated to a parent alert for wmiprvse.exe executing powershell.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9762.png', 'ScreenshotCaption': 'Incident report including triggering event of execution of mimikatx, preceded by file execution'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Credential Dumping" was received that included a PowerShell command executed by the adversary to download Mimikatz and execute it with a sequence of commands.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12962.png', 'ScreenshotCaption': 'MSSP Day 1: wmidump'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Credential Dumping" was generated due for a Lsass read.\n', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12097.png', 'ScreenshotCaption': '4 - cred dumping alert'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for Mimikatz (m.exe) being used to access credentials in memory. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12690.png', 'ScreenshotCaption': 'MSSP - 12C1 - 13 - 14A1/2/3 - 14B2/3/4 ; do not talk about win32_audit code, only show raw data, so not counting'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a process accessing lsass.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Credential Dumping" was generated for command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4238.png', 'ScreenshotCaption': 'cred dumping #2 , mimikatz'}, {'ScreenshotName': 'Carbon Black-APT29-4239.png', 'ScreenshotCaption': 'm.exe with command line args'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4219.png', 'ScreenshotCaption': ''}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell from executing untrusted applications or blocking PUP applications from executing. Credential dumping can be blocked by preventing untrusted applications from reading the memory of other processes.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing Mimikatz to obtain login credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12768.png', 'ScreenshotCaption': '14.b.3-4 mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4225.png', 'ScreenshotCaption': 'active client'}], 'Footnotes': []}]}]}]}, {'Substep': '14.B.5', 'Procedure': 'Encoded and wrote Mimikatz output to a WMI class property using PowerShell', 'Criteria': 'powershell.exe executing Set-WmiInstance', 'Techniques': [{'TechniqueId': 'T1027', 'TechniqueName': 'Obfuscated Files or Information', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10653.png', 'ScreenshotCaption': 'Telemetry showing PowerShell executing Set-WmiObject to write encoded content from Win32_AuditCode via the download cradle.'}, {'ScreenshotName': 'CrowdStrike-APT29-10649.png', 'ScreenshotCaption': 'Telemetry showing PowerShell executing Set-WmiObject to write encoded content from Win32_AuditCode.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated showing PowerShell writing encoded content into the WMI class.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2455.png', 'ScreenshotCaption': 'set-wmiinstance with enrichments in graph view'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Obfuscated Files or Information" was received that included a PowerShell script and explained that it was used to write the Mimikatz payload to Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12502.png', 'ScreenshotCaption': '14.B.5 - MDR Report Day 2, writing mimikatz output'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for Set-WmiInstance (by suspicious process). The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9929.png', 'ScreenshotCaption': '14.b.5 - alert for the Set-WmiInstance (cc)'}], 'Footnotes': ['A sensor policy update that enables deeper PowerShell visibility was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Win_Powershell_Base64_MITRE1027" was generated due to PowerShell encoding base64 information.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12082.png', 'ScreenshotCaption': 'B3/5 - Medium alert for powershell base64 execution showing SBL and Set-WmiInstance'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content to the WMI class. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ATT&CK T1027 Obfuscated Files or Information" was generated for PowerShell executing Set-WmiInstance. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1811.png', 'ScreenshotCaption': 'cc - metadata upgrade - new wmi and obfuscated enrichment for put instance. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1458.png', 'ScreenshotCaption': 'b5 script block for set wmiinstance'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell Set-WmiInstance to write encoded content to Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11314.png', 'ScreenshotCaption': 'MSSP - wc function - no context'}, {'ScreenshotName': 'F-Secure-APT29-13276.png', 'ScreenshotCaption': 'MSSP Summary'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10359.png', 'ScreenshotCaption': 'wmiaudit code'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell Set-WmiInstance writing encoded content to Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13035.png', 'ScreenshotCaption': 'MSSP - 14.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11505.png', 'ScreenshotCaption': '14.B.5 - Script block for Set-WmiInstance'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12714.png', 'ScreenshotCaption': '14.b.3-4 MSSP alert #1'}, {'ScreenshotName': 'GoSecure-APT29-12715.png', 'ScreenshotCaption': '14.b.3-4 MSSP alert #2'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3866.png', 'ScreenshotCaption': '14.B.5 - Encoded value written'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1940.png', 'ScreenshotCaption': '14.b.1-3 in detail'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. Script preview was truncated so an alternate view was shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-518.png', 'ScreenshotCaption': 'Beautified script block with Set-WmiInstance'}, {'ScreenshotName': 'Microsoft-APT29-516.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with Set-WmiInstance'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13251.png', 'ScreenshotCaption': '14.B.5 (A) - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13715.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Defense Evasion - Obfuscated Files or Information" occurred containing evidence of PowerShell Set-WmiInstance to write encoded content to Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12658.png', 'ScreenshotCaption': 'MSSP - SW - 14AB5-6 - event details (2)'}, {'ScreenshotName': 'SecureWorks-APT29-12656.png', 'ScreenshotCaption': 'MSSP - SW - 14AB5-6 - overview'}, {'ScreenshotName': 'SecureWorks-APT29-12657.png', 'ScreenshotCaption': 'MSSP - SW - 14AB5-6 - event details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7069.png', 'ScreenshotCaption': '14.b.3/5/6 script event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1027" occurred containing evidence of "wmidump" function definition and WMI indicators writing to Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12871.png', 'ScreenshotCaption': 'MSSP - WMI write audit of code'}, {'ScreenshotName': 'SentinelOne-APT29-12872.png', 'ScreenshotCaption': 'MSSP - WMIDUMP SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7260.png', 'ScreenshotCaption': 'CC - B5 - Powershell alert of Set-WmiInstance'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17711.png', 'ScreenshotCaption': '14b5 - telemetry for win_audit code'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12107.png', 'ScreenshotCaption': '5 - scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4241.png', 'ScreenshotCaption': 'wmiinstance'}], 'Footnotes': []}]}]}]}, {'Substep': '14.B.6', 'Procedure': 'Read and decoded Mimikatz output from a WMI class property using PowerShell', 'Criteria': 'powershell.exe executing Get-WmiInstance', 'Techniques': [{'TechniqueId': 'T1140', 'TechniqueName': 'Deobfuscate/Decode Files or Information', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1105.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10647.png', 'ScreenshotCaption': 'Telemetry showing PowerShell executing Get-Process. Telemetry showing PowerShell executing Get-WmiObject to read encoded content from Win32_AuditCode.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for PowerShell reading encoded content from the WMI class. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2456.png', 'ScreenshotCaption': 'get-wmiobject with enrichments in graph view'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Obfuscated Files or Information" was received that included a PowerShell script and explained that it was used to write the Mimikatz payload to Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12502.png', 'ScreenshotCaption': '14.B.5 - MDR Report Day 2, writing mimikatz output'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Deobfuscate/Decode Files or Information" occurred containing evidence of the PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10798.png', 'ScreenshotCaption': 'MSSP - auditcode, not what were testing for directly, but capturing for now'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12089.png', 'ScreenshotCaption': 'B6 - Get-Wmiobject SBL'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class.  The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1457.png', 'ScreenshotCaption': 'b6 get wmi object in cmdlet event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10362.png', 'ScreenshotCaption': 'getwmiobject'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13036.png', 'ScreenshotCaption': 'MSSP - 14.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11508.png', 'ScreenshotCaption': '14.B.6 - Script block for Get-WmiObject'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3867.png', 'ScreenshotCaption': '14.B.6 - Get-WmiObject for Win32_AuditCode class'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1945.png', 'ScreenshotCaption': '14.b.6 get-wmiobject with win32_auditcode'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. Script preview was truncated so an alternate view was shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-517.png', 'ScreenshotCaption': 'Beautified script block with Get-WmiObject'}, {'ScreenshotName': 'Microsoft-APT29-516.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with Set-WmiInstance'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13252.png', 'ScreenshotCaption': '14.B.6 - MSSP'}, {'ScreenshotName': 'Palo Alto Networks-APT29-13247.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-316.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell reading encoded content from the WMI class. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13774.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7061.png', 'ScreenshotCaption': '14.b.1/2/6 -getwmiobject from full script picture'}, {'ScreenshotName': 'SecureWorks-APT29-7057.png', 'ScreenshotCaption': '14.b.1 - wmidump function'}, {'ScreenshotName': 'SecureWorks-APT29-7062.png', 'ScreenshotCaption': '14.b.1/2/6 - wmidump event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1027" occurred containing evidence of "wmidump" function definition and WMI indicators reading from Win32_AuditCode.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12873.png', 'ScreenshotCaption': 'MSSP - WMI read audit of code'}, {'ScreenshotName': 'SentinelOne-APT29-12872.png', 'ScreenshotCaption': 'MSSP - WMIDUMP SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7261.png', 'ScreenshotCaption': 'CC - B6 - Powershell alert of Get-WmiObject'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12108.png', 'ScreenshotCaption': '6 - sciptBlock - wmiobject, audit code'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4244.png', 'ScreenshotCaption': 'wmidump'}], 'Footnotes': []}]}]}]}, {'Substep': '15.A.1', 'Procedure': 'Enumerated logged on users using PowerShell', 'Criteria': 'powershell.exe executing $env:UserName', 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10656.png', 'ScreenshotCaption': 'Telemetry showing wmi script block which executes $env:Username.'}, {'ScreenshotName': 'CrowdStrike-APT29-10657.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing wmi function.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated when powershell.exe ran the script, which obtained the name of the current user. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2457.png', 'ScreenshotCaption': 'env username with enrichments'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12304.png', 'ScreenshotCaption': 'A1 - SBL showing $env.username'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1484.png', 'ScreenshotCaption': 'script block of username'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing $env:UserName.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10669.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for PowerShell executing $env:UserName.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13037.png', 'ScreenshotCaption': 'MSSP - 15.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11510.png', 'ScreenshotCaption': '15.A.1 - Script block for PowerShell executing $env:UserName'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-15132.png', 'ScreenshotCaption': '15A1 - new vendor pic - function wmi scriptBlock'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1949.png', 'ScreenshotCaption': '15.a.1 $env in detail'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName. The script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-520.png', 'ScreenshotCaption': 'Telemetry in the advanced query interface showing executed script block enumerate logged on user via the wmi function Win32_LoggedOnUser.'}, {'ScreenshotName': 'Microsoft-APT29-522.png', 'ScreenshotCaption': 'Beautified script block enumerate logged on user via the wmi function Win32_LoggedOnUser'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing $env:UserName.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13248.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-13254.png', 'ScreenshotCaption': '15.A.1, 15.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3400.png', 'ScreenshotCaption': 'Telemetry showing powershell executing $env:UserName and setting the Wmi event subscription.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-320.png', 'ScreenshotCaption': 'cc - userName highlighted'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - System Owner/User Discovery" occurred containing evidence of PowerShell $env:UserName.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12659.png', 'ScreenshotCaption': 'MSSP - SW - 15A1 - overview and alert detes'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13776.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13777.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7262.png', 'ScreenshotCaption': 'CC - A1 - Powershell alert of wmi function definition which shows  $env:Username reference '}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12119.png', 'ScreenshotCaption': '1 - username '}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4258.png', 'ScreenshotCaption': 'wmi function'}], 'Footnotes': []}]}]}]}, {'Substep': '15.A.2', 'Procedure': 'Established WMI event subscription persistence using PowerShell', 'Criteria': 'powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription', 'Techniques': [{'TechniqueId': 'T1084', 'TechniqueName': 'Windows Management Instrumentation Event Subscription', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated due to the creation of a new WMI consumer. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-918.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-913.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated due to the creation of a new WMI filter. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-913.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-918.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated due to the creation of a new WMI subscription. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-922.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-913.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-923.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-928.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-919.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "WmiFilterConsumerBind" was generated due to the WindowsParentalControlMigration event filter creation. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-15451.png', 'ScreenshotCaption': '15a2 - new vendor screen'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10655.png', 'ScreenshotCaption': 'Telemetry showing WMI filter command line.'}, {'ScreenshotName': 'CrowdStrike-APT29-10654.png', 'ScreenshotCaption': 'Telemetry showing WMI filter, consumer, and binding created in root/subscription.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red alert icon) for "Windows Management Instrumentation Event Subscription" was generated due to the WindowsParentalControlMigration event filter creation. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2458.png', 'ScreenshotCaption': 'Alert for WMI persistenct with powershell command and enrichments.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Windows Management Instrumentation Event Subscription" was occurred containing evidence of a PowerShell script and explained that it was used establish persistence.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12504.png', 'ScreenshotCaption': '15.A.2 - MDR Report Day 2, WMI persistence command set'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Windows Management Instrumentation Event Subscription" occurred containing evidence of WindowsParentalControlMigration WMI filter.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10801.png', 'ScreenshotCaption': 'MSSP - a2 - better pic'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_WMI_EventSubscription_Persistence_MITRET1084" was generated due to WMI operations subscribing to an event.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12094.png', 'ScreenshotCaption': 'A2 - WindowsParental ControlMigration  WMI filter, consumer, and binding created in root/subscription\n'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12304.png', 'ScreenshotCaption': 'A1 - SBL showing $env.username'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "Windows Management Instrumentation Consumer Binding" was generated due to the modification a WMI filter. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1494.png', 'ScreenshotCaption': 'wmi persistence via consumer binding  alert'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ATT&CK T1084 Windows Management Instrumentation Event Subscription" was generated due to a PowerShell script containing WindowsParentalControlMigration. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1481.png', 'ScreenshotCaption': 'powershell event enrichment tag for peristence - T1084 wmi event subscription '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a PowerShell script containing WindowsParentalControlMigration. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1484.png', 'ScreenshotCaption': 'script block of username'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of WMI persistence being installed using the PowerShell function "wmi."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11316.png', 'ScreenshotCaption': 'MSSP - raw wmi function'}, {'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-17372.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'F-Secure-APT29-10381.png', 'ScreenshotCaption': 'wmi stuff'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of WMI persistence established for user Oscar.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13037.png', 'ScreenshotCaption': 'MSSP - 15.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11512.png', 'ScreenshotCaption': '15.A.2 - Script block for the WMI event filter'}, {'ScreenshotName': 'FireEye-APT29-11513.png', 'ScreenshotCaption': '15.A.2 - Script block for the WMI event consumer'}, {'ScreenshotName': 'FireEye-APT29-11514.png', 'ScreenshotCaption': '15.A.2 - Script block for the binding'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for WMI event subscription being used for a persistence mechanism. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12716.png', 'ScreenshotCaption': '15.a.2 MSSP alert #1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Critical severity) called "WMI Event Filter Creation" was generated due to the creation of a new WMI event filter.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3876.png', 'ScreenshotCaption': '15.A.2 - WMI Event Filter Creation'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "WMI __EventConsumer" was generated due to the creation of a new WMI event consumer.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3873.png', 'ScreenshotCaption': '15.A.2 - WMI_EventConsumer created'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-4229.png', 'ScreenshotCaption': 'Same note as before, new details (expanded). Has Technique name as WMI'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of WMI persistence established for user Oscar.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12405.png', 'ScreenshotCaption': '15.a.2 MSSP report #2'}, {'ScreenshotName': 'Kaspersky-APT29-12404.png', 'ScreenshotCaption': '15.a.2 MSSP report #1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Windows Management Instrumentation Event Subscription" was generated due to the Suspicious Indicator "Detected WMI event subscription."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1855.png', 'ScreenshotCaption': '15.a.2 - wmi alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1856.png', 'ScreenshotCaption': '15.a.2 - wmi filter, consumer, binding create'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Windows Management Instrumentation Event Subscription was generated due to a WMI event filter being bound to a suspicious event consumer.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-618.png', 'ScreenshotCaption': 'Technique detection for WMI event filter was bound to a suspicious event consumer'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': "An MSSP detection for Persistence was generated containing evidence PowerShell commands were executed to use WMI to subscribe to the WindowsParentalControlMigration scheduled task start event for user 'Oscar'.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1145.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Persistence (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1146.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Persistence (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-621.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with WMI persistence functions.'}, {'ScreenshotName': 'Microsoft-APT29-523.png', 'ScreenshotCaption': 'Beautified script block with WMI persistence functions.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for PowerShell creating a WMI event subscription.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13724.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-14507.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of WMI persistence established for user Oscar.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13254.png', 'ScreenshotCaption': '15.A.1, 15.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3400.png', 'ScreenshotCaption': 'Telemetry showing powershell executing $env:UserName and setting the Wmi event subscription.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green indicator) called "WMI Event Consumer" was generated due to the WMI subscription creation. The detection was correlated to a parent alert for WmiPrvSE.exe executing powershell.exe.', 'Modifiers': ['Alert', 'Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-185.png', 'ScreenshotCaption': 'cc - see full function'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green indicator) called "WMI Event Filter" was generated due to the WMI subscription creation. The detection was correlated to a parent alert for WmiPrvSE.exe executing powershell.exe.', 'Modifiers': ['Alert', 'Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-185.png', 'ScreenshotCaption': 'cc - see full function'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell commands to generate the WMI subscription.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-319.png', 'ScreenshotCaption': 'cc - windowsparental control function'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (high severity) called "WMI Persistence for Encoded PowerShell 2" was generated due to the WindowsParentalControlMigration WMI filter and consumer.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13779.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13778.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (info severity) called "WMI event consumer with base64 content" was generated due to the WindowsParentalControlMigration WMI filter and consumer.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7108.png', 'ScreenshotCaption': '15.a.2 - raw event details with query language powershell encoded, event filter in consumers'}, {'ScreenshotName': 'SecureWorks-APT29-7105.png', 'ScreenshotCaption': '15.a.2 - wmi event consumer - alert details'}, {'ScreenshotName': 'SecureWorks-APT29-7106.png', 'ScreenshotCaption': '15.a.2 - technique mappings - deobfuscate'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (info severity) called "WMI Filter to Consumer Binding" was generated due to the WindowsParentalControlMigration WMI filter and consumer.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13791.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13790.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13776.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13777.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "WMI" under "Persistence {T1084}" was generated when a WMI binding was created under root/subscription. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6895.png', 'ScreenshotCaption': 'A2 - WMI Persistence Alert of root/subscription'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General detection for a suspicious "WMIOperation" showed WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6896.png', 'ScreenshotCaption': 'A2 - Specific WindowsParentalControlMigration in root/subscription'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1084" occurred containing evidence of WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12875.png', 'ScreenshotCaption': 'MSSP - A2 - WMI info pt2'}, {'ScreenshotName': 'SentinelOne-APT29-12876.png', 'ScreenshotCaption': 'MSSP - A1/2 - SBL'}, {'ScreenshotName': 'SentinelOne-APT29-12874.png', 'ScreenshotCaption': 'MSSP - A2 - WMI info'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "WMI Event Subscriptionmodule WindowsParentalControlMigration contains suspicious argument" was generated on WMIProcessCreationEvent and WMIConsumerEvent being created in root/subscription. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17713.png', 'ScreenshotCaption': '15a2 - technique '}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "SEP detected: CLDownloader!gen1" was generated on subscription:CommandLineEventConsumer.Name=WindowsParentalControlMigration.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17715.png', 'ScreenshotCaption': '15a2 - General'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "WMI Event Subscription" was received that included a PowerShell command executed by the adversary and explained that it was used to establish persistence through a WMI Event Subscription that executes upon user logon.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12966.png', 'ScreenshotCaption': 'MSSP Day 1: WMI Event Subscription'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium risk) called "Windows Management Instrumentation Event Subscription" was generated due to the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12123.png', 'ScreenshotCaption': '2 - RCA - technique'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12120.png', 'ScreenshotCaption': '2 - raw data - consumer'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for PowerShell establishing WMI event subscription persistence.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13961.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell establishing WMI event subscription persistence.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12769.png', 'ScreenshotCaption': '15.a.2 mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4258.png', 'ScreenshotCaption': 'wmi function'}, {'ScreenshotName': 'Carbon Black-APT29-4264.png', 'ScreenshotCaption': 'oscar root/subscription'}], 'Footnotes': []}]}]}]}, {'Substep': '16.A.1', 'Procedure': 'Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries', 'Criteria': 'powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll', 'Techniques': [{'TechniqueId': 'T1018', 'TechniqueName': 'Remote System Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the System.DirectoryServices.dll module loaded by powershell.exe as well as powershell.exe executing the Get-NetDomainController cmdlet. The detection was correlated to a parent alert on PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10659.png', 'ScreenshotCaption': 'Telemetry showing Powershell.exe executed get-netdomaincontrollers script.'}, {'ScreenshotName': 'CrowdStrike-APT29-10664.png', 'ScreenshotCaption': 'Telemetry showing network connections from Utica to NewYork on port 135.'}, {'ScreenshotName': 'CrowdStrike-APT29-10662.png', 'ScreenshotCaption': 'Telemetry showing System.DirectoryServices.dll module loaded by powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for powershell.exe executing the Get-NetDomainController command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2463.png', 'ScreenshotCaption': 'Get-NetDomainController with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Remote System Discovery" was received that included a PowerShell script and explained that it was used to discover a remote system.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12506.png', 'ScreenshotCaption': '16.A.1 - MDR Report Day 2, summary & Get-NetDomainController'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9767.png', 'ScreenshotCaption': '16.a.1 - network connection details'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though an alert was generated for PowerShell executing the Get-NetDomainController cmdlet.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12125.png', 'ScreenshotCaption': 'A1 - Medium alert for Powerview on  Get-NetDomainController'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the Get-NetDomainController cmdlet then subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1496.png', 'ScreenshotCaption': 'get forestdomain powershel cmdlet with the  discovery  tag for powershell  (tactic tags is changing  for powershell)'}, {'ScreenshotName': 'Elastic-APT29-1497.png', 'ScreenshotCaption': 'endgame client view showing the ldap queries (port 389)'}, {'ScreenshotName': 'Elastic-APT29-1498.png', 'ScreenshotCaption': 'script block  for get-netdomaincontroller'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10397.png', 'ScreenshotCaption': 'port 389 '}, {'ScreenshotName': 'F-Secure-APT29-10401.png', 'ScreenshotCaption': 'function API names being called'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell making a LDAP network connections over port 389 to the domain controller NewYork (10.0.0.4)', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11531.png', 'ScreenshotCaption': '16.A.1 - LDAP Network Connection (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11530.png', 'ScreenshotCaption': '16.A.1 - LDAP Network Connection (top)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell making a network connection over port 389 to the domain controller NewYork (10.0.0.4). ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for suspicious activity indicative of remote discovery attempts. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12721.png', 'ScreenshotCaption': '16.a.1 MSSP alert #1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell making a network connection over port 389 to the domain controller NewYork (10.0.0.4). The event was correlated to a parent detection on "PowerShell with Execution Bypass Command Launched."', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11406.png', 'ScreenshotCaption': 'powershell port 389 network connection and tagged with comonly used port. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of System.DirectoryServices.ni.dll loaded into PowerShell, which can be used to execute LDAP queries.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18018.png', 'ScreenshotCaption': 'new mssp 16a1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though a real time search showed that the System.DirectoryServices.dll module was loaded by powershell.exe.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1860.png', 'ScreenshotCaption': '16.a.1 - ps 1196 system.directoryservices.ni.dll'}], 'Footnotes': ['MVISION Endpoint would have blocked this activity. ']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for powershell.exe making a "suspicious LDAP query."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-524.png', 'ScreenshotCaption': 'General detection for Suspicious LDAP query'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though events showed the execution of the PowerShell Get-DomainController function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13726.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the Get-NetDomainController cmdlet and subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-187.png', 'ScreenshotCaption': 'network conns established'}, {'ScreenshotName': 'ReaQta-APT29-322.png', 'ScreenshotCaption': 'cc - get domain funciton'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - Remote System Discovery" occurred containing evidence of PowerShell executing LDAP queries via functions from System.DirectoryServices namespace.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13780.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the Get-NetDomainController cmdlet and subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7111.png', 'ScreenshotCaption': '16.a.1 - get-netdomaincontroller sciprt block'}, {'ScreenshotName': 'SecureWorks-APT29-7115.png', 'ScreenshotCaption': '16.a.1 - utica network connection (right one)'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell loading System.DirectoryServices.dll and making a network connection to the domain controller NewYork (10.0.0.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6906.png', 'ScreenshotCaption': 'A1 - System.directoryservices.dll being loaded by powershell'}, {'ScreenshotName': 'SentinelOne-APT29-6899.png', 'ScreenshotCaption': 'A1 -  LDAP network connection information'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': "Telemetry showed PowerShell making a network connection to the domain controller NewYork (10.0.0.4) over LDAP port 389. Additionally, Oscar's Kerberos ticket was seen in memory on NewYork. ", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17718.png', 'ScreenshotCaption': '16a1 - telem - delayed search query'}, {'ScreenshotName': 'Symantec-APT29-17717.png', 'ScreenshotCaption': '16a1 - telem - delayed forensic report '}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection alert (informational severity) called "LDAP SASL Connection Detected" was generated for PowerShell  making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12138.png', 'ScreenshotCaption': 'raw data for get-domaincontroller - out of scope, but capturing'}, {'ScreenshotName': 'TrendMicro-APT29-12140.png', 'ScreenshotCaption': 'LDAP query - DDI'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the Get-NetDomainController cmdlet and subsequently making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4267.png', 'ScreenshotCaption': 'ldap'}, {'ScreenshotName': 'Carbon Black-APT29-4292.png', 'ScreenshotCaption': '16.a.1 - modload for system.directoryservices.ni.dll'}, {'ScreenshotName': 'Carbon Black-APT29-14757.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '16.B.1', 'Procedure': 'Enumerated the domain SID (from current user SID) using\xa0the ConvertSidToStringSid API', 'Criteria': 'powershell.exe executing the ConvertSidToStringSid API', 'Techniques': [{'TechniqueId': 'T1033', 'TechniqueName': 'System Owner/User Discovery', 'Tactics': [{'TacticName': 'Discovery', 'TacticId': 'TA0007'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1107.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10666.png', 'ScreenshotCaption': 'Telemetry showing ConvertSidToStringSid script block which calls ConvertSidToStringSid API.'}, {'ScreenshotName': 'CrowdStrike-APT29-10667.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing siduser function (which calls ConvertSidToStringSid function).'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) for threat activity was generated for PowerShell executing the ConvertSidToStringSid API function.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2357.png', 'ScreenshotCaption': 'CyCarrier Raw Data: ConvertSidToString'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "System Owner/User Discovery" was received that included a PowerShell script and explained that it was used to obtain the domain SID from the current user\'s SID.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12506.png', 'ScreenshotCaption': '16.A.1 - MDR Report Day 2, summary & Get-NetDomainController'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Account Discovery occurred containing evidence of the ConvertSidToStringSid API call.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10802.png', 'ScreenshotCaption': 'MSSP - api call'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_Domain_SidToUser_MITRET1082" was generated when PowerShell accessed SID. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12135.png', 'ScreenshotCaption': 'B1 - high alert for Win Domain SIDtoUser'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll in order to execute the ConvertSidToStringSid API function.', 'Modifiers': ['Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12340.png', 'ScreenshotCaption': 'B2 - CC - SBL showing use of advapi32.dll'}, {'ScreenshotName': 'Cylance-APT29-12339.png', 'ScreenshotCaption': 'B1 - CC - SBL showing use of ConvertSidToStringSid'}], 'Footnotes': ['A UX Configuration Change was made to update PowerShell script block logging truncation length. ']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1506.png', 'ScreenshotCaption': 'convertsidtostringsid script block'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10401.png', 'ScreenshotCaption': 'function API names being called'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for powershell.exe executing the ConvertSidToStringSid API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13039.png', 'ScreenshotCaption': 'MSSP - 16.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11544.png', 'ScreenshotCaption': '16.B.1 - Script block for the ConvertSidToStringSid API'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the execution of the ConvertSidToStringSid API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12725.png', 'ScreenshotCaption': '16.b.1-2 MSSP alert #1'}, {'ScreenshotName': 'GoSecure-APT29-12726.png', 'ScreenshotCaption': '16.b.1-2 MSSP alert #2'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3894.png', 'ScreenshotCaption': '16.B - ConvertSidtToStringSid and Advapi32'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1953.png', 'ScreenshotCaption': '16.b.1 in detail'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for a script with suspicious content being observed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-527.png', 'ScreenshotCaption': 'General detection for a script with suspicious content being observed'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-526.png', 'ScreenshotCaption': 'Beautified executed script block with ConvertSidToStringSid command'}, {'ScreenshotName': 'Microsoft-APT29-17402.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13255.png', 'ScreenshotCaption': '16.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3390.png', 'ScreenshotCaption': 'Telemetry showing powershell starting ConvertSidToStringSid call.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-326.png', 'ScreenshotCaption': 'cc - convert sid to strings'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Discovery - System Owner/User Discovery" occurred containing evidence of PowerShell reflectively loading Advapi32.dll and executing APIs to identify the current user\'s SID.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13781.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7112.png', 'ScreenshotCaption': '16.b.1 -siduser function call'}, {'ScreenshotName': 'SecureWorks-APT29-7114.png', 'ScreenshotCaption': '16.b.1/2 - function siduser script block, command to invoke function'}, {'ScreenshotName': 'SecureWorks-APT29-7155.png', 'ScreenshotCaption': '16.b.1/2 - reflective loading api functions'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1033" occurred containing evidence of ConvertSidToStringSid API usage.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12877.png', 'ScreenshotCaption': 'MSSP - ConvertSidToStringSid, Advapi32.dll'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (UX)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7265.png', 'ScreenshotCaption': 'CC - B1/2 - powershell alert of siduser function definition '}, {'ScreenshotName': 'SentinelOne-APT29-7264.png', 'ScreenshotCaption': 'CC - B1/2 - Powershell alert of ConvertSidToStringSid being used in script'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for PowerShell executing siduser.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12691.png', 'ScreenshotCaption': 'MSSP - 15A1 (NEED VARIABLES) - 16C1/2- 17A1 - 17B - 17C'}], 'Footnotes': []}, {'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the API function was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12267.png', 'ScreenshotCaption': 'pulled the step_sixteen from system'}], 'Footnotes': ['The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4293.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '16.B.2', 'Procedure': 'Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll', 'Criteria': 'powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll', 'Techniques': [{'TechniqueId': 'T1106', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1107.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that PowerShell loaded Advapi32.dll in order to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10666.png', 'ScreenshotCaption': 'Telemetry showing ConvertSidToStringSid script block which calls ConvertSidToStringSid API.'}, {'ScreenshotName': 'CrowdStrike-APT29-10668.png', 'ScreenshotCaption': 'Telemetry showing advapi32.dll was loaded by powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for the PowerShell script which contained ConvertSidToStringSid API function being loaded.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2357.png', 'ScreenshotCaption': 'CyCarrier Raw Data: ConvertSidToString'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Execution through API" was received that included a PowerShell script and explained that it was used to execute the ConvertSidToStringSid API function from Advapi32.dll.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12506.png', 'ScreenshotCaption': '16.A.1 - MDR Report Day 2, summary & Get-NetDomainController'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though data showed that PowerShell loaded Advapi32.dll.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9773.png', 'ScreenshotCaption': '16.b.2 - advapi32.dll loaded module from powershell'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll in order to execute the ConvertSidToStringSid API function.', 'Modifiers': ['Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12340.png', 'ScreenshotCaption': 'B2 - CC - SBL showing use of advapi32.dll'}, {'ScreenshotName': 'Cylance-APT29-12339.png', 'ScreenshotCaption': 'B1 - CC - SBL showing use of ConvertSidToStringSid'}], 'Footnotes': ['A UX Configuration Change was made to update PowerShell script block logging truncation length. ']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1506.png', 'ScreenshotCaption': 'convertsidtostringsid script block'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed that PowerShell loaded Advapi32.dll in order to execute the ConvertSidToStringSid API function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10401.png', 'ScreenshotCaption': 'function API names being called'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell Loading Advapi32.dll" was generated for PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11757.png', 'ScreenshotCaption': 'CC - 16.B.2 - PowerShell Loading Advapi32.dll'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the ConvertSidToStringSid API function loaded into PowerShell from Advapi32.dll.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13039.png', 'ScreenshotCaption': 'MSSP - 16.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11546.png', 'ScreenshotCaption': '16.B.2 - Script block for PowerShell loading advapi32.dll'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (green indicator) called "Execution through API (DLL Load)" was generated for PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The event was correlated to a parent detection on "PowerShell with Encoded Command Launched."', 'Modifiers': ['Alert', 'Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11672.png', 'ScreenshotCaption': 'config change started monitoring dll loads for advapi32 into powerhshell. they did not see for the retest (based on time stamps), but  did see the even earlier in the day for some reason. was tagged with impact 20 and execution through api intelligence tag. ----- not a detection but shows they could detect. not really sure why they didnt detect, outside of maybe it was already loaded. '}], 'Footnotes': ['Configuration changed to add monitoring of specific API. ']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the load of the ConvertSidToStringSid API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12725.png', 'ScreenshotCaption': '16.b.1-2 MSSP alert #1'}, {'ScreenshotName': 'GoSecure-APT29-12726.png', 'ScreenshotCaption': '16.b.1-2 MSSP alert #2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The event was correlated to a parent detection on "PowerShell with Encoded Command Launched."', 'Modifiers': ['Correlated', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11672.png', 'ScreenshotCaption': 'config change started monitoring dll loads for advapi32 into powerhshell. they did not see for the retest (based on time stamps), but  did see the even earlier in the day for some reason. was tagged with impact 20 and execution through api intelligence tag. ----- not a detection but shows they could detect. not really sure why they didnt detect, outside of maybe it was already loaded. '}], 'Footnotes': ['Configuration changed to add monitoring of specific API. ']}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Critical severity) was generated for reflective loading of a PE file by PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3895.png', 'ScreenshotCaption': '16.B.2 - Process Injection for reflective PE load'}, {'ScreenshotName': 'HanSight-APT29-3896.png', 'ScreenshotCaption': '16.B.2 - Use of cmdlet Invoke-ReflectivePEInjection'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3894.png', 'ScreenshotCaption': '16.B - ConvertSidtToStringSid and Advapi32'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1954.png', 'ScreenshotCaption': '16.b.2 in detail'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll in order to execute the ConvertSidToStringSid API function. Script preview was truncated so an alternate view is shown.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-526.png', 'ScreenshotCaption': 'Beautified executed script block with ConvertSidToStringSid command'}, {'ScreenshotName': 'Microsoft-APT29-17402.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13255.png', 'ScreenshotCaption': '16.B.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3390.png', 'ScreenshotCaption': 'Telemetry showing powershell starting ConvertSidToStringSid call.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-326.png', 'ScreenshotCaption': 'cc - convert sid to strings'}, {'ScreenshotName': 'ReaQta-APT29-327.png', 'ScreenshotCaption': 'cc - highlighting advapi32'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Execution - Execution through API" occurred containing evidence of PowerShell reflectively loading Advapi32.dll and executing APIs.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12661.png', 'ScreenshotCaption': 'MSSP - SW - 16B1-2 - overview'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-10676.png', 'ScreenshotCaption': '16.b.1 - script block'}, {'ScreenshotName': 'SecureWorks-APT29-10675.png', 'ScreenshotCaption': '16.b.1 - event details'}, {'ScreenshotName': 'SecureWorks-APT29-7155.png', 'ScreenshotCaption': '16.b.1/2 - reflective loading api functions'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1106" occurred containing evidence of ConvertSidToStringSid API with Advapi32.dll.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12877.png', 'ScreenshotCaption': 'MSSP - ConvertSidToStringSid, Advapi32.dll'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7265.png', 'ScreenshotCaption': 'CC - B1/2 - powershell alert of siduser function definition '}, {'ScreenshotName': 'SentinelOne-APT29-7264.png', 'ScreenshotCaption': 'CC - B1/2 - Powershell alert of ConvertSidToStringSid being used in script'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Execution through API" was received that included a PowerShell command executed by the adversary and explained that it was used to execute the GetTokenInformation API call from Advapi32.dll.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12967.png', 'ScreenshotCaption': 'MSSP Day 1: siduser techniques'}, {'ScreenshotName': 'Symantec-APT29-12968.png', 'ScreenshotCaption': 'MSSP Day 1: siduser description'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12267.png', 'ScreenshotCaption': 'pulled the step_sixteen from system'}], 'Footnotes': ['The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation. ']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4293.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '16.C.1', 'Procedure': 'Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ', 'Criteria': 'Network connection to NewYork (10.0.0.4) over port 5985', 'Techniques': [{'TechniqueId': 'T1028', 'TechniqueName': 'Windows Remote Management', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}, {'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated on NewYork (10.0.0.4) for a remote PowerShell session based on the identification of the WinRM process (wsmprovhost.exe).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-938.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-940.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-934.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-993.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-1000.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called “GenericWinRMLateralMovement” was generated when powershell.exe executed Invoke-WinRMSession to connect to remote host NewYork (10.0.0.4) with credentials for user MScott. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10672.png', 'ScreenshotCaption': 'Telemetry showing powershell executing invoke-winrmsession to NewYork (10.0.0.4). A Technique detection called “GenericWinRMLateralMovement” for powershell.exe executing invoke-winrmsession to connect to NewYork (10.0.0.4) with credentials for user MScott.'}, {'ScreenshotName': 'CrowdStrike-APT29-10678.png', 'ScreenshotCaption': 'A Technique detection called “GenericWinRMLateralMovement” for powershell.exe executing logging onto NewYork successfully with user MScott.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10679.png', 'ScreenshotCaption': 'Telemetry showing powershell connecting to NewYork (10.0.0.4) on port 5985. Telemetry showing a successful logon on NewYork as MScott.'}, {'ScreenshotName': 'CrowdStrike-APT29-10672.png', 'ScreenshotCaption': 'Telemetry showing powershell executing invoke-winrmsession to NewYork (10.0.0.4). A Technique detection called “GenericWinRMLateralMovement” for powershell.exe executing invoke-winrmsession to connect to NewYork (10.0.0.4) with credentials for user MScott.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) for threat activity was generated for powershell.exe executing the Invoke-WinRMSession command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2358.png', 'ScreenshotCaption': 'CyCarrier Raw Data: invoke-winrm with credentials and IP'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Windows Remote Management" was received that included a PowerShell command and explained that it was used to create a WinRM session to host Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12506.png', 'ScreenshotCaption': '16.A.1 - MDR Report Day 2, summary & Get-NetDomainController'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10805.png', 'ScreenshotCaption': 'MSSP - c1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9779.png', 'ScreenshotCaption': '16.c.1 - port 5985 details from the process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) called "Win_WinRM_Invoke-Command_MITRET1028"  was generated for the PowerShell Invoke-Command WinRM cmdlet.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12137.png', 'ScreenshotCaption': 'C1 - medium alert for WinRM Invoke-Command and SBL'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Lateral Movement" occurred containing evidence of Invoke-WinRMSession with a "Win_WinRM_Invoke-Command_MITRET1028" alert. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-13187.png', 'ScreenshotCaption': 'MSSP - Lateral Movement description'}, {'ScreenshotName': 'Cylance-APT29-12923.png', 'ScreenshotCaption': 'MSSP - Alert + SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12308.png', 'ScreenshotCaption': 'C1 - powershell connection to 10.0.0.4 over 5985'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "WMI Lateral Movement via PowerShell over WinRM" was generated for WMI invoked on another host via a PowerShell WMI cmdlet. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1511.png', 'ScreenshotCaption': 'wmi lateral movement via powershell over winrm alert'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) for "First Seen Process in an Environment" was generated for the execution of the WinRM process (wsmprovhost.exe).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1514.png', 'ScreenshotCaption': 'mscott on new york execution alert - first seen process in environment alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for a suspicious Windows script.\t\n', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1521.png', 'ScreenshotCaption': 'endgame client view  showing port 5985'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (informational severity) for Windows Remote Management was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-14506.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10418.png', 'ScreenshotCaption': '5985 again, ty Skype, ty Microsoft'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "WinRM Network Connection" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11555.png', 'ScreenshotCaption': '16.C.1 - WinRM Network Connection to NewYork (10.0.0.4)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for a PowerShell URL request to NewYork (10.0.0.4) on port 5895.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11556.png', 'ScreenshotCaption': '16.C.1 - PowerShell URL Request to NewYork (10.0.0.4)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of a WinRM connection on NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13040.png', 'ScreenshotCaption': 'MSSP - 16.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Windows Remote Management wsman in HTTP Request" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The event was correlated to a parent detection on "PowerShell with Execution Bypass Command Launched."\n', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11424.png', 'ScreenshotCaption': 'http request network traffic for winRM, intelligence labeled with win RM, commonly used port 16c1'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.  The event was correlated to a parent detection on "PowerShell with Execution Bypass Command Launched."', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11424.png', 'ScreenshotCaption': 'http request network traffic for winRM, intelligence labeled with win RM, commonly used port 16c1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "WinRM via common port" was generated due to WinRM usage to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3905.png', 'ScreenshotCaption': '16.C.1 - WinRM via common port to NewYork (10.0.0.4)'}, {'ScreenshotName': 'HanSight-APT29-3906.png', 'ScreenshotCaption': '16.C.1 - WinRM via common port 5985'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection alert (red; high severity) for PowerShell with network activity was generated for to powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3256.png', 'ScreenshotCaption': '16.c.1 - connection with full tree'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of a WinRM connection on NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12408.png', 'ScreenshotCaption': '16.c.1-2 MSSP report'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18093.png', 'ScreenshotCaption': '16C2 - new vendor pic with port'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection alert (orange indicator) called "Windows Remote Management" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1867.png', 'ScreenshotCaption': '16.c.1 - winrm alert 2nd run'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1869.png', 'ScreenshotCaption': '16.1.c - net connect 5985 (HI pid)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-532.png', 'ScreenshotCaption': 'Telemetry showing successful logon on 10.0.0.4 as user MScott.'}, {'ScreenshotName': 'Microsoft-APT29-529.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing a connection to remote host NewYork (10.0.0.4) over TCP port 5985.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13256.png', 'ScreenshotCaption': '16.C.1, 16.C.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3249.png', 'ScreenshotCaption': 'Telemetry showing powershell making outbound network connections to 10.0.0.4 on port 5985. (1/2)'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-189.png', 'ScreenshotCaption': 'ps network connection w 5985'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Execution - Windows Remote Management" occurred containing evidence of PowerShell executing the PowerShell Invoke-Command WinRM cmdlet then the subsequent connection to remote host NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13782.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the PowerShell Invoke-Command WinRM cmdlet then the subsequent connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7117.png', 'ScreenshotCaption': '16.c.1 - network connection 5985'}, {'ScreenshotName': 'SecureWorks-APT29-7119.png', 'ScreenshotCaption': '16.c.1 function invoke winrmsession - event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "WinRMSession" was generated for the creation of a WinRM session. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6913.png', 'ScreenshotCaption': 'C1 - WinRM Session alert generated'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1028" occurred containing evidence of a connection to remote host NewYork (10.0.0.4) over port 5985 using the wsman protocol, and a WinRM indicator for Lateral Movement.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12879.png', 'ScreenshotCaption': 'MSSP - network information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed connection to remote host NewYork (10.0.0.4) over port 5985 using the wsman protocol. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6910.png', 'ScreenshotCaption': 'C1 - Connection to NewYork over 5985'}, {'ScreenshotName': 'SentinelOne-APT29-15014.png', 'ScreenshotCaption': '16.C.1 - Correlation of WinRM to prior context'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of WinRM usage via invoke-winrmsession with command-line arguments.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17722.png', 'ScreenshotCaption': '16c1 - mssp - winrm'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9872.png', 'ScreenshotCaption': 'powershell.exe connected to 10.0.0.4 over port 5985 via HTTP (WinRM)'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Powershell Remote Command Execution Via WinRM" (low severity) was generated due to a connection to host NewYork (10.0.0.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14498.png', 'ScreenshotCaption': '16.C.1 - PowerShell WinRM in DDI'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "WinRM Service Detected" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12130.png', 'ScreenshotCaption': '1 - winRm technique with port'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for "Powershell remote command execution via WinRM". ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12691.png', 'ScreenshotCaption': 'MSSP - 15A1 (NEED VARIABLES) - 16C1/2- 17A1 - 17B - 17C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated on NewYork (10.0.0.4) for a remote PowerShell session based on the identification of the WinRM process (wsmprovhost.exe).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4302.png', 'ScreenshotCaption': '16.c - winrm alert for mscott'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (yellow indicator) was generated for powershell.exe accessing the network. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4298.png', 'ScreenshotCaption': '16.c.1 - connection to 10.0.0.4:5985'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4298.png', 'ScreenshotCaption': '16.c.1 - connection to 10.0.0.4:5985'}], 'Footnotes': []}]}]}]}, {'Substep': '16.C.2', 'Procedure': 'Logged on to the domain controller host NewYork (10.0.0.4) using\xa0valid credentials for user MScott\xa0', 'Criteria': 'Successful logon as user MScott on NewYork (10.0.0.4) ', 'Techniques': [{'TechniqueId': 'T1078', 'TechniqueName': 'Valid Accounts', 'Tactics': [{'TacticName': 'Privilege Escalation', 'TacticId': 'TA0004'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10679.png', 'ScreenshotCaption': 'Telemetry showing powershell connecting to NewYork (10.0.0.4) on port 5985. Telemetry showing a successful logon on NewYork as MScott.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) was generated for the successful logon event  on NewYork (10.0.0.4) as user MScott.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2362.png', 'ScreenshotCaption': 'CyCarrier Raw Data: Remote Logon from powershell'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Valid Accounts" was received that described the adversary establishing a WinRM session with MScott\'s credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12506.png', 'ScreenshotCaption': '16.A.1 - MDR Report Day 2, summary & Get-NetDomainController'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Valid Accounts occurred containing evidence of the Successful logon on NewYork as user MScott.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10803.png', 'ScreenshotCaption': 'MSSP - mscott logging onto newYork via winRM'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9782.png', 'ScreenshotCaption': '16.c.2 - details for 1 logon session'}, {'ScreenshotName': 'Cybereason-APT29-9783.png', 'ScreenshotCaption': '16.c.2 - user details'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Lateral Movement" occurred containing evidence of logon for user MScott on NewYork through additional analysis.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12925.png', 'ScreenshotCaption': 'MSSP - Login event ID'}, {'ScreenshotName': 'Cylance-APT29-13187.png', 'ScreenshotCaption': 'MSSP - Lateral Movement description'}], 'Footnotes': []}, {'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though Host Interrogation was used to pull logon event logs.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12311.png', 'ScreenshotCaption': 'to be included in MBR - manual delayed/host interr'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1525.png', 'ScreenshotCaption': 'remote logon event of mscott onto new york'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of lateral movement from utica to new york as the user mscott.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11317.png', 'ScreenshotCaption': 'MSSP - winrmsession raw function'}, {'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10423.png', 'ScreenshotCaption': 'logon events '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the successful logon of MScott on NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13040.png', 'ScreenshotCaption': 'MSSP - 16.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11549.png', 'ScreenshotCaption': '16.C.2 - Logon Tracker showing the mscott logon to NewYork (10.0.0.4)'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the successful logon on NewYork (10.0.0.4) as user mscott. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12729.png', 'ScreenshotCaption': '16.c.2 MSSP alert #3'}, {'ScreenshotName': 'GoSecure-APT29-12728.png', 'ScreenshotCaption': '16.c.2 MSSP alert #2'}, {'ScreenshotName': 'GoSecure-APT29-12727.png', 'ScreenshotCaption': '16.c.2 MSSP alert #1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "Logon Event Detected" was generated due to a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3899.png', 'ScreenshotCaption': '16.C.2 - Logon Event for MScott to NewYork (10.0.0.4)'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the successful logon of MScott on NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12408.png', 'ScreenshotCaption': '16.c.1-2 MSSP report'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3246.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1871.png', 'ScreenshotCaption': '16.c.2 - mscott login (HI pid)'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-532.png', 'ScreenshotCaption': 'Telemetry showing successful logon on 10.0.0.4 as user MScott.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3302.png', 'ScreenshotCaption': 'Telemetry showing mscott authenticating on 10.0.0.4.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3300.png', 'ScreenshotCaption': 'Telemetry showing mscott logging and being assigned permissions.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-192.png', 'ScreenshotCaption': 'all events'}, {'ScreenshotName': 'ReaQta-APT29-191.png', 'ScreenshotCaption': 'account logon'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Privilege Escalation- Valid Accounts" occurred containing evidence of PowerShell executing the PowerShell Invoke-Command WinRM cmdlet with valid credentials then logging onto the remote host NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13782.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7143.png', 'ScreenshotCaption': '16.c.2 - account was successfully logged on - hostname at bottom'}, {'ScreenshotName': 'SecureWorks-APT29-7118.png', 'ScreenshotCaption': '16.c.2 - login by mscott event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "UserLogin" was generated when valid user MScott was used to log onto NewYork (10.0.0.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6915.png', 'ScreenshotCaption': 'C2 - UserLogin Alert generated'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1078" occurred containing evidence of process wsmprovhost.exe creation by mscott on remote host proving valid logon.\n', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12880.png', 'ScreenshotCaption': 'MSSP - login justification'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe successfully executing a program as user MScott, indicating that a valid user session was created through WinRM.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9787.png', 'ScreenshotCaption': 'm.exe injected into lsass.exe, tagged with Credential Dumping'}, {'ScreenshotName': 'Symantec-APT29-9778.png', 'ScreenshotCaption': 'Shows the user context for the file copy and execution of m.exe using mscott'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Windows Logon Success" was generated for the successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12134.png', 'ScreenshotCaption': '2 - event logon mscott - with technique'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for valid MScott credentials being used to logon to NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12691.png', 'ScreenshotCaption': 'MSSP - 15A1 (NEED VARIABLES) - 16C1/2- 17A1 - 17B - 17C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the analyst was able to query the DC to get a list of users logged on.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4300.png', 'ScreenshotCaption': '16.c.2 - mscott logon #2 (live query -- host interrogation) ONLY a list of users not a log of logon'}], 'Footnotes': []}]}]}]}, {'Substep': '16.D.1', 'Procedure': 'Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection', 'Criteria': 'File write of m.exe by the WinRM process (wsmprovhost.exe)', 'Techniques': [{'TechniqueId': 'T1105', 'TechniqueName': 'Remote File Copy', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell writing a file to an uncommon location.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1001.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event for m.exe (identified as Mimikatz by the file metadata) in the System32 directory.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-941.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write of m.exe to System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10683.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe copied m.exe to winrm session.'}, {'ScreenshotName': 'CrowdStrike-APT29-10689.png', 'ScreenshotCaption': 'Telemetry showing a file write of m.exe to System32 directory by wsmprovhost.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (purple indicator) for File Movement was generated indicating that m.exe was moved from host Utica (10.0.1.5) to host NewYork (10.0.0.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2473.png', 'ScreenshotCaption': 'File movement of m.exe from UTICA to NEWYORK'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Remote File Copy" was received that described the adversary moving m.exe from host Utica (10.0.1.5) to host NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12511.png', 'ScreenshotCaption': '16.D.1 - MDR Report Day 2, file creation'}, {'ScreenshotName': 'CyCraft-APT29-12510.png', 'ScreenshotCaption': '16.D.1 - MDR Report Day 2, m.exe movement'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of m.exe to the System32 directory by wsmprovhost.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9790.png', 'ScreenshotCaption': '16.d.1 - file event wsmprovhost.exe process tree, process marked as malicious'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for m.exe in the System32 directory.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12142.png', 'ScreenshotCaption': 'D1 - File creation event of m.exe and injection into lsass event'}], 'Footnotes': ['According to the vendor, this would have been prevented due to m.exe being identified as malware.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for the creation of a malicious file (m.exe). The detection was correlated to a parent alert for the "First Seen Process  in an Environment".', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1531.png', 'ScreenshotCaption': 'and better still with the file create of wsmprovhost.exe'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event for m.exe in the System32 directory by wsmprovhost.exe. The detection was correlated to a parent alert for the "First Seen Process  in an Environment".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1531.png', 'ScreenshotCaption': 'and better still with the file create of wsmprovhost.exe'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of the file write of m.exe to System32.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11318.png', 'ScreenshotCaption': 'MSSP - copy item'}, {'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create of m.exe in the System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10428.png', 'ScreenshotCaption': 'm.exe file create'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13042.png', 'ScreenshotCaption': 'MSSP - 16.D'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file write of m.exe to System32 directory by wsmprovhost.exe. The detection was correlated to parent alert on the wsmprovhost.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11575.png', 'ScreenshotCaption': '16.D.1 - Triage view of the m.exe file write'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) for a malicious file was generated for the file create of m.exe in the System32 directory by wsmprovhost.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11427.png', 'ScreenshotCaption': 'alt view of malicious file create alert, with impact score of 100. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create of m.exe in the System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11425.png', 'ScreenshotCaption': 'file create event for wsmprovhost of m.exe, malware score of 69'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event of m.exe in the System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3920.png', 'ScreenshotCaption': '16.D.1 - File created event for m.exe creation by wsmprovhost.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12409.png', 'ScreenshotCaption': '16.d.1-2 MSSP report'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3263.png', 'ScreenshotCaption': '16.d.1 - details'}, {'ScreenshotName': 'Kaspersky-APT29-3261.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed creation of m.exe (identified as Mimikatz by the file metadata) in the System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1872.png', 'ScreenshotCaption': '16.d.1 m.exe created; labeled as mimikatz'}, {'ScreenshotName': 'McAfee-APT29-1876.png', 'ScreenshotCaption': '16.d.1 wsmprovhost as parent to m.exe'}], 'Footnotes': ['MVISION Endpoint would have blocked the malicious file m.exe due to a cloud-based classification detected by Advanced Threat Protection signature.']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) "Hacktool Mimikatz detected" was generated when m.exe was written to disk.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-536.png', 'ScreenshotCaption': 'General detection for Hacktool Mimikatz detected'}], 'Footnotes': ['Alert occurred when the file was written to disk.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-537.png', 'ScreenshotCaption': 'Telemetry showing wsmprovhost.exe creating m.exe.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13257.png', 'ScreenshotCaption': '16.D.1 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3280.png', 'ScreenshotCaption': 'Telemetry showing a file create event for m.exe.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Executable Dropped" was generated for wsmprvhost.exe creating m.exe (identified as Mimikatz by the file metadata).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-195.png', 'ScreenshotCaption': 'm.exe created'}, {'ScreenshotName': 'ReaQta-APT29-196.png', 'ScreenshotCaption': 'createremote thread - wsm > m.exe > process injection w/ command line and lsass'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event for m.exe in the System32 directory.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated identifying m.exe as a threat file.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6917.png', 'ScreenshotCaption': 'Summary view m.exe is actually mimikatz'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "File Creation" occurred containing evidence of file write of m.exe to System32 directory by WinRM.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12881.png', 'ScreenshotCaption': 'MSSP - file creation, cli args, '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file write event for m.exe in the System32 directory by "Host process for WinRM plug-ins". The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6918.png', 'ScreenshotCaption': 'D1 - m.exe being dropped to disk'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Remote File Copy" was generated when SMB traffic from another host was received and then immediately followed by a file write for m.exe by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9735.png', 'ScreenshotCaption': 'Incident Report for Credential Dumping, including execution of m.exe. Done from HI  powershell.exe process'}, {'ScreenshotName': 'Symantec-APT29-9774.png', 'ScreenshotCaption': 'Remote File Copy event, and network connection from utice > newyork. File Copy tag is based on network connection followed by file creation by wsmprovhost.'}, {'ScreenshotName': 'Symantec-APT29-9775.png', 'ScreenshotCaption': 'Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "Malicious file detected" was generated on sandbox detection analysis of m.exe. Detection incurred a delay based on sandbox detonation processing.', 'Modifiers': ['Delayed (Processing)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17725.png', 'ScreenshotCaption': '16d1 - general - sandbox detection'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Remote File Copy" was received that included a PowerShell command executed by the adversary and explained that it was used to copy mimikatz to a remote PowerShell session.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12969.png', 'ScreenshotCaption': 'MSSP Day 1: remote mimikatz copy techniques'}, {'ScreenshotName': 'Symantec-APT29-12970.png', 'ScreenshotCaption': 'MSSP Day 1: remote mimikatz copy description'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a file create event for m.exe in the System32 directory by "Host process for WinRM plug-ins".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9775.png', 'ScreenshotCaption': 'Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for "Microsoft Windows - System .dll or .exe files modified".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12148.png', 'ScreenshotCaption': '1 - m being written by wsm; check attack mapping - deep security'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for "Suspicious Files Detected in Operating System Directories".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-14499.png', 'ScreenshotCaption': '16.D.1 - Suspicious Files in OS Directories for m.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the file write of m.exe to remote host NewYork (10.0.0.4). ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12694.png', 'ScreenshotCaption': 'MSSP - 16D'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed  the file write of m.exe to System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a code drop of m.exe (identified as Mimikatz by the file metadata).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4271.png', 'ScreenshotCaption': 'detected_up_app D'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a filemod for the creation of m.exe in the System32 directory by wsmprovhost.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4308.png', 'ScreenshotCaption': 'm.exe written to disk'}], 'Footnotes': []}]}]}]}, {'Substep': '16.D.2', 'Procedure': 'Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)', 'Criteria': 'm.exe injecting into lsass.exe to dump credentials', 'Techniques': [{'TechniqueId': 'T1003', 'TechniqueName': 'Credential Dumping', 'Tactics': [{'TacticName': 'Credential Access', 'TacticId': 'TA0006'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called  "ReadProcessMemoryCritical" was generated for m.exe reading memory from a critical process. The alert was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4).', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-946.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-932.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for injection into the lsass.exe process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-956.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a m.exe (Mimikatz) loading a credentials-related DLL (samlib.dll), identified as a possible attempt to dump credentials. The detection was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4).', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-932.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-944.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for injection into a critical system process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-961.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identifying m.exe as the Mimikatz malware. The detection was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4).', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13444.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called “Credential Dumping” was generated when a remote thread was written to LSASS memory by m.exe (mimikatz).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10687.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for a thread injecting into LSASS from a signed executable with untrusted root authority. A Technique detection called “Credential Dumping” for a remote thread was being written to LSASS memory by m.exe (mimikatz).'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called “Credential Dumping” was generated when a thread was injected into LSASS from a signed executable with untrusted root authority.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10687.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for a thread injecting into LSASS from a signed executable with untrusted root authority. A Technique detection called “Credential Dumping” for a remote thread was being written to LSASS memory by m.exe (mimikatz).'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called “Credential Dumping” was generated when m.exe allocated executable memory inside of LSASS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10686.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for m.exe accessing LSASS memory. A Technique detection called “Credential Dumping” for m.exe injecting code into the LSASS process. A Technique detection called “Credential Dumping” for m.exe allocating executable memory inside of LSASS.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called “Credential Dumping” was generated when m.exe injected code into the LSASS process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10686.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for m.exe accessing LSASS memory. A Technique detection called “Credential Dumping” for m.exe injecting code into the LSASS process. A Technique detection called “Credential Dumping” for m.exe allocating executable memory inside of LSASS.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection  (orange indicator) called “Credential Dumping” was generated when m.exe (mimikatz) accessed LSASS memory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10686.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for m.exe accessing LSASS memory. A Technique detection called “Credential Dumping” for m.exe injecting code into the LSASS process. A Technique detection called “Credential Dumping” for m.exe allocating executable memory inside of LSASS.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called “Credential Dumping” was generated when m.exe read LSASS memory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10685.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for mimikatz (m.exe) read LSASS process memory. A General detection called “Machine Learning via Sensor-based ML” for m.exe meeting on-sensor AV protection’s high confidence threshold for malicious files. A Technique detection called “Credential Dumping” for a signed executable with untrusted root authority accessing LSASS.'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) called “Credential Dumping” was generated identifying m.exe as Mimikatz.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10688.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for m.exe (mimikatz) was launching.'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) called “Machine Learning via Sensor-based ML” was generated when m.exe met machine learning-based on-sensor AV protection’s high confidence threshold for malicious files.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10685.png', 'ScreenshotCaption': 'A Technique detection called “Credential Dumping” for mimikatz (m.exe) read LSASS process memory. A General detection called “Machine Learning via Sensor-based ML” for m.exe meeting on-sensor AV protection’s high confidence threshold for malicious files. A Technique detection called “Credential Dumping” for a signed executable with untrusted root authority accessing LSASS.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Credential Dumping" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2475.png', 'ScreenshotCaption': 'Execution of m.exe on NEWYORK'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated identifying m.exe as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2474.png', 'ScreenshotCaption': 'Threat Activity alery for execution of m.exe on NEWYORK'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Credential Dumping" was received that described the adversary remotely executing m.exe to dump the krbtgt hash.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12513.png', 'ScreenshotCaption': '16.D.1 - MDR Report Day 2, invoke-command & lsass access'}, {'ScreenshotName': 'CyCraft-APT29-12506.png', 'ScreenshotCaption': '16.A.1 - MDR Report Day 2, summary & Get-NetDomainController'}, {'ScreenshotName': 'CyCraft-APT29-12514.png', 'ScreenshotCaption': '16.D.1 - MDR Report Day 2, execution & behavior of m.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red, unique symbol) called Credential Theft was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9794.png', 'ScreenshotCaption': '16.d.2 - command line with the lsadump injection from the process details'}, {'ScreenshotName': 'Cybereason-APT29-9795.png', 'ScreenshotCaption': '16.d.2 - suspicion highlighted'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "GUARD: Possible Mimikatz" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12139.png', 'ScreenshotCaption': 'D1/2 - High alert for possible mimikatz usage - wsmprovhost.exe executing m.exe'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated identifying an exploit attempt when m.exe attempted to create a remote thread.\t\n', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12141.png', 'ScreenshotCaption': 'D2 - m.exe using CreateRemoteThread'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data Theft and Exfiltration" occurred containing evidence of "lsadump" with command-line arguments identified as Possible Mimikatz usage.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12926.png', 'ScreenshotCaption': 'MSSP - alert + CLI args'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe injecting a thread into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12142.png', 'ScreenshotCaption': 'D1 - File creation event of m.exe and injection into lsass event'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Process Injection" was generated for the injection into lsass.exe. The detection was correlated to a parent alert for the "First Seen Process in an Environment".', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13700.png', 'ScreenshotCaption': 'target of process injection  with timstomping alert'}, {'ScreenshotName': 'Elastic-APT29-1532.png', 'ScreenshotCaption': 'process injection alert related to cred dump'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "Credential Dumping" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for the "First Seen Process in an Environment".', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1534.png', 'ScreenshotCaption': 'and now with cmdline'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for Credential Dumping was generated due to a known password dumper being executed. This event was correlated to a parent detection for privilege escalation.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10438.png', 'ScreenshotCaption': 'more mimi process tree'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "Credential Dumping" was generated due to lsass memory dump. This detection was correlated to a parent detection for privilege escalation.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10441.png', 'ScreenshotCaption': 'best mimikatz view lsass stuff too'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for "Credential Dumping" was generated due to Mimikatz command-line parameters being executed. This event was correlated to a parent detection for privilege escalation.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10441.png', 'ScreenshotCaption': 'best mimikatz view lsass stuff too'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of Mimikatz dumping the KRBTGT hash.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}, {'ScreenshotName': 'F-Secure-APT29-11318.png', 'ScreenshotCaption': 'MSSP - copy item'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe injecting a thread into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10435.png', 'ScreenshotCaption': 'threat injection lsass'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "MIMIKATZ SUSPICIOUS PROCESS ARGUMENTS A (METHODOLOGY)" was generated due to command line arguments indicating the use of Mimikatz.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11562.png', 'ScreenshotCaption': '16.D.2 - Mimikatz detection via process arguments'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Vaultcli.dll Load" was generated due to a non-standard process, m.exe, loading a Windows credential management library (vaultcli.dll).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11564.png', 'ScreenshotCaption': '16.D.2 - m.exe loading vaultcli.dll (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11563.png', 'ScreenshotCaption': '16.D.2 - m.exe loading vaultcli.dll (top)'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for m.exe being identified as Mimikatz malware.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11568.png', 'ScreenshotCaption': '16.D.2 - Mimikatz malware alert, with signature information (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11567.png', 'ScreenshotCaption': '16.D.2 - Mimikatz malware alert (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for Mimikatz usage to dump credentials for the krbtgt account.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13042.png', 'ScreenshotCaption': 'MSSP - 16.D'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called "Malicious File Executed" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11430.png', 'ScreenshotCaption': 'process create with the 100 impact score for m.exe launch. '}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called "Remote Process Compromise" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11432.png', 'ScreenshotCaption': 'thread create of m.exe into lsass, alert for remote process compromise. behavior view. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Warning severity) called "Credential Dumping via lsass access" was generated due to m.exe accessing to lsass.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3925.png', 'ScreenshotCaption': '16.D.2 - Access permission 0x143a with operation target lsass.exe'}, {'ScreenshotName': 'HanSight-APT29-3927.png', 'ScreenshotCaption': '16.D.2 - Credential Dumping via lsass access on NewYork (10.0.0.4)'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; high severity) for Credential Dumping was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3265.png', 'ScreenshotCaption': '16.d.2 - both detections based on command pattern'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12409.png', 'ScreenshotCaption': '16.d.1-2 MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for credential dumping was generated for m.exe  executing with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2580.png', 'ScreenshotCaption': 'Credential dumping alert 2'}, {'ScreenshotName': 'MalwareBytes-APT29-2579.png', 'ScreenshotCaption': 'Credential dumping alert 1'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Credential Dumping" was generated due to the Suspicious Indicator "LSASS process memory read by other process." ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1873.png', 'ScreenshotCaption': '16.d.2 cred dumping with lsadump::lsa ...'}], 'Footnotes': ['MVISION Endpoint would have blocked the malicious file m.exe due to a cloud-based classification detected by Advanced Threat Protection signature.']}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) called "Credential Access" was generated for m.exe injecting code into a foreign process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1875.png', 'ScreenshotCaption': '16.d.2 - cred dump by m.exe'}], 'Footnotes': ['MVISION Endpoint would have blocked the malicious file m.exe due to a cloud-based classification detected by Advanced Threat Protection signature.']}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for Credential Dumping  was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-535.png', 'ScreenshotCaption': 'Technique detection for malicious credential theft tool execution detected (16d2)'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Credential Dumping was generated due to suspected credential theft activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-534.png', 'ScreenshotCaption': 'Technique detection for suspected credential theft activity'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe opening lsass.exe with OpenProcess.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17884.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Command line arguments matching Mimikatz execution" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3282.png', 'ScreenshotCaption': 'Tactic detection of lateral movement via wsmprovhost.exe.  A technique detection showing Commandline arguments matching Mimikatz execution.'}], 'Footnotes': ['According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware.']}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Credential Dumping" was generated for m.exe reading lsass.exe process memory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3271.png', 'ScreenshotCaption': 'Technique detection for credential dumping showing m.exe execute lsadump. (overview)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3273.png', 'ScreenshotCaption': 'Technique detection for credential dumping showing m.exe execute lsadump. (2/6)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3272.png', 'ScreenshotCaption': 'Technique detection for credential dumping showing m.exe execute lsadump. (1/6)'}], 'Footnotes': ['According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware.']}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "heuristic.b.mimikatz_lsadump_inject" was generated for possible Mimikatz activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3285.png', 'ScreenshotCaption': '2 - XDR mimikatz access'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a rare child process spawned from wsmprovhost.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3282.png', 'ScreenshotCaption': 'Tactic detection of lateral movement via wsmprovhost.exe.  A technique detection showing Commandline arguments matching Mimikatz execution.'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13258.png', 'ScreenshotCaption': '16.D.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe injecting a thread into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3283.png', 'ScreenshotCaption': 'Telemetry showing m.exe was injected into a thread.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated for m.exe injecting into a process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-196.png', 'ScreenshotCaption': 'createremote thread - wsm > m.exe > process injection w/ command line and lsass'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Mimikatz Activity - lsadump" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.  ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7132.png', 'ScreenshotCaption': '16.d.2 - full process tree lsadump inject'}, {'ScreenshotName': 'SecureWorks-APT29-7130.png', 'ScreenshotCaption': '16.d.2 - lsadump alert technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-7129.png', 'ScreenshotCaption': '16.d.2 - mimikattz activity lsadump alert '}, {'ScreenshotName': 'SecureWorks-APT29-7131.png', 'ScreenshotCaption': '16.d.2 - alert details, process overview/tree'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Mimikatz Activity - privilege" was generated for m.exe with command-line arguments indicative of Mimikatz credential theft.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13783.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13784.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) called "Mimikatz lsadump PowerShell Script Block" was generated due to a script block event associated with Mimikatz dumping local secrets.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7127.png', 'ScreenshotCaption': '16.d.2 - technique mappings - credential dumping/powershell'}, {'ScreenshotName': 'SecureWorks-APT29-7128.png', 'ScreenshotCaption': '16.d.2 - raw event details from alert '}, {'ScreenshotName': 'SecureWorks-APT29-7126.png', 'ScreenshotCaption': '16.d.2 - Alert details mimikatz lsadump powershell script'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe injecting a thread into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13786.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13785.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "SensitiveMemoryAccess" under "Credential Access {T1003}" was generated when m.exe read sensitive memory from lsass.exe. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6922.png', 'ScreenshotCaption': 'D2 - Sensitive memory access alert or LSASS'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "SensitiveMemoryAccess" occurred containing evidence of mimikatz lsadump::lsa /inject /name:krbtgt via m.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12882.png', 'ScreenshotCaption': 'MSSP - SensitiveMemoryAccess'}, {'ScreenshotName': 'SentinelOne-APT29-12881.png', 'ScreenshotCaption': 'MSSP - file creation, cli args, '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry shows a remote process injection into lsass.exe by Mimikatz. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17880.png', 'ScreenshotCaption': '16.D.2 - RemoteInjection into LSASS'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Credential Dumping" was generated for a suspicious injection into LSASS.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9775.png', 'ScreenshotCaption': 'Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Credential Dumping" was generated when a suspicious process loaded a cryptographic DLL and accessed LSASS memory.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9775.png', 'ScreenshotCaption': 'Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Credential Dumping" was generated when a suspicious process opened LSASS and wrote to a file.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9775.png', 'ScreenshotCaption': 'Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Credential Dumping" was generated when m.exe injected into lsass.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9787.png', 'ScreenshotCaption': 'm.exe injected into lsass.exe, tagged with Credential Dumping'}, {'ScreenshotName': 'Symantec-APT29-9735.png', 'ScreenshotCaption': 'Incident Report for Credential Dumping, including execution of m.exe. Done from HI  powershell.exe process'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "Process Injection" was generated on "Untrusted process attempted to open a thread in a Microsoft process".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17724.png', 'ScreenshotCaption': '16d2 - general + correlation -  suspected mimikatz credential theft'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for a "Suspected Mimikatz credential theft activity". The event was correlated to a parent General detection on m.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17724.png', 'ScreenshotCaption': '16d2 - general + correlation -  suspected mimikatz credential theft'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Credential Dumping" was received that included a PowerShell command executed by the adversary and explained that it was used to execute mimikatz to retrieve the krbtgt hash from host NewYork (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12970.png', 'ScreenshotCaption': 'MSSP Day 1: remote mimikatz copy description'}, {'ScreenshotName': 'Symantec-APT29-12969.png', 'ScreenshotCaption': 'MSSP Day 1: remote mimikatz copy techniques'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe injecting into lsass.exe', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9775.png', 'ScreenshotCaption': 'Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "Credential Dumping" was generated due to LSASS having a suspicious process access mask. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12149.png', 'ScreenshotCaption': '2 - credential dumping - lsass - deep security'}, {'ScreenshotName': 'TrendMicro-APT29-12150.png', 'ScreenshotCaption': 'detection overview - deep security'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Credential Dumping" was generated for command-line arguments indicative of Mimikatz credential dumping.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13962.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for process injection by m.exe. The detection was correlated to a parent alert for a code drop of m.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4274.png', 'ScreenshotCaption': 'm.exe process inject'}], 'Footnotes': ['According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking PUP applications from executing. Credential dumping can be prevented by implementing rules blocking untrusted applications reading the memory of another process.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for a code drop of m.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4271.png', 'ScreenshotCaption': 'detected_up_app D'}], 'Footnotes': []}]}]}]}, {'Substep': '17.A.1', 'Procedure': 'Dumped messages from the local Outlook inbox using PowerShell', 'Criteria': 'outlook.exe spawning from svchost.exe or powershell.exe', 'Techniques': [{'TechniqueId': 'T1114', 'TechniqueName': 'Email Collection', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-968.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10694.png', 'ScreenshotCaption': 'Telemetry showing outlook.exe spawning from svchost.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) for "Email Collection" was generated when powershell.exe loaded an Outlook DLL.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2478.png', 'ScreenshotCaption': 'psemail scriptblock with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Email Collection" was received that included a PowerShell script and explained that it was used to obtain the collect emails.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2479.png', 'ScreenshotCaption': '17.A.1 - MDR Report Day 2, summary and psemail'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red, unique symbol) called "PowerShell access to Outlook mailbox data (ATT&CK: Collection)" was generated due a process having access to Outlook mailbox data through use of a PowerShell script. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-13286.png', 'ScreenshotCaption': '17.a.1 - malop powershell.exe detectied as malicious'}, {'ScreenshotName': 'Cybereason-APT29-9798.png', 'ScreenshotCaption': '17.a.1 - powershell access to outlook under suspicions, marked on poewrshell not outlook.exe process'}, {'ScreenshotName': 'Cybereason-APT29-9797.png', 'ScreenshotCaption': '17.a.1- process tree and evidence'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9797.png', 'ScreenshotCaption': '17.a.1- process tree and evidence'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_Email_Collection_Subfolders_MitreT1114"  was generated due to the executed PowerShell script containing "Outlook.Application."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12144.png', 'ScreenshotCaption': 'A1 - high alert for email collection subfolders with SBL'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection for "Data Theft and Exfiltration" occurred containing evidence of email collection via PowerShell.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12927.png', 'ScreenshotCaption': 'MSSP - outlook subfolder alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12315.png', 'ScreenshotCaption': 'A1 - Process tree view of outlook spawining svchost.exe'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for the "First Seen Process in an Environment".', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1562.png', 'ScreenshotCaption': 'new screenshot of outlook spawning from svhost with file created event. '}, {'ScreenshotName': 'Elastic-APT29-1555.png', 'ScreenshotCaption': 'psemail script block with contents'}, {'ScreenshotName': 'Elastic-APT29-1559.png', 'ScreenshotCaption': 'outlook spawning from  svchost.exe'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of psemail Powershell function being used to read email for the user.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}, {'ScreenshotName': 'F-Secure-APT29-11319.png', 'ScreenshotCaption': 'MSSP - raw psemail function'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10446.png', 'ScreenshotCaption': 'svchost launching outlook.exe  telemetry'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "Unusual Outlook Parent Process" was generated due to Outlook being launched by a process other than explorer.exe.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11760.png', 'ScreenshotCaption': 'CC - 17.A.1 - Unusual Outlook Parent Process'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell collected email information from Outlook.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13045.png', 'ScreenshotCaption': 'MSSP - 17.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11581.png', 'ScreenshotCaption': '17.A.1 - outlook.exe with parent process svchost.exe'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Email Collection" was generated due to PowerShell copying the HTML file. The event was correlated to a parent detection on "Bypass User Account Control."', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11453.png', 'ScreenshotCaption': 'b1 - file read - powershell copying the html file from documents to temp, with an impact score of 40. and tagged with email collection'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of email collection.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12730.png', 'ScreenshotCaption': '17.a.1 MSSP alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11445.png', 'ScreenshotCaption': 'svchost launching outlook. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3930.png', 'ScreenshotCaption': '17.A.1 - svchost.exe spawning outlook.exe'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell interacting with Outlook.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12410.png', 'ScreenshotCaption': '17.b.1 MSSP report'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3289.png', 'ScreenshotCaption': '17.a.1  details'}, {'ScreenshotName': 'Kaspersky-APT29-3287.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1878.png', 'ScreenshotCaption': '17.a.1 svchost launching outlook'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': "An MSSP detection for Suspicious Activity was generated containing evidence that PowerShell function 'psemail' was used to copy emails from an Outlook inbox.", 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1148.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection and Defense Evasion (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1147.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection and Defense Evasion (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-538.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe spawning outlook.exe with commandline arguments.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from powershell.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13727.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-3291.png', 'ScreenshotCaption': 'Telemetry showing outlook.exe being spawned by powershell.exe.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-198.png', 'ScreenshotCaption': 'powershell on oscar'}, {'ScreenshotName': 'ReaQta-APT29-199.png', 'ScreenshotCaption': 'outlook.exe (with blue indicator) from svchost '}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell enumerating Outlook emails via COM.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13787.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe with command-line arguments.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7146.png', 'ScreenshotCaption': '17.a.1 - event details for process outlook'}, {'ScreenshotName': 'SecureWorks-APT29-7147.png', 'ScreenshotCaption': '17.a.1 - full process tree outlook.exe  launched from svchost'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1114" occurred containing evidence of Outlook process being started from the parent process “svchost.exe” along with the function definition for "psemail".', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12883.png', 'ScreenshotCaption': 'MSSP - outlook access and SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6925.png', 'ScreenshotCaption': 'A1 - outlook.exe spawning from svchost.exe(OSParent name)/powershell(Parent name)'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Email Collection" was generated containing evidence of email collection.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12971.png', 'ScreenshotCaption': 'MSSP Day 1: Email Collection'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9835.png', 'ScreenshotCaption': 'svchost.exe executed outlook.exe'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': ' An MSSP detection occurred for outlook using function psemail to dump outlook messages.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12691.png', 'ScreenshotCaption': 'MSSP - 15A1 (NEED VARIABLES) - 16C1/2- 17A1 - 17B - 17C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17561.png', 'ScreenshotCaption': 'RCA view - svchost > outlook'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Fileless Reconnaissance of Outlook Folder data"  was generated for powershell.exe interacting with Outlook.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4319.png', 'ScreenshotCaption': 'outlook alerts'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called "Suspicious loading of Outlook .NET assembly"  was generated for powershell.exe interacting with an Outlook DLL.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4319.png', 'ScreenshotCaption': 'outlook alerts'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell collecting emails.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14758.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4315.png', 'ScreenshotCaption': 'svcohst --> outlook'}, {'ScreenshotName': 'Carbon Black-APT29-4322.png', 'ScreenshotCaption': 'psemail'}], 'Footnotes': []}]}]}]}, {'Substep': '17.B.1', 'Procedure': 'Read and collected a local file using PowerShell', 'Criteria': 'powershell.exe reading the file MITRE-ATTACK-EVALS.HTML', 'Techniques': [{'TechniqueId': 'T1005', 'TechniqueName': 'Data from Local System', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell opening MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for malicious use of PowerShell.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9934.png', 'ScreenshotCaption': '17.b.1 - malops 2 processes (cc)'}, {'ScreenshotName': 'Cybereason-APT29-9935.png', 'ScreenshotCaption': '17.b.1 - full path (cc)'}], 'Footnotes': ['A sensor policy update that enables file read event collection was re-applied.']}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. PowerShell execution of Copy-Item was observed, but this does not count as a detection since file activity was not observed.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-539.png', 'ScreenshotCaption': 'Executed script block with Copy-Item'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file read of MITRE-ATTACK-EVALS.HTML. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-201.png', 'ScreenshotCaption': 'file read'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for Data from Local System was generated for a process reading MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7266.png', 'ScreenshotCaption': 'CC - B1 - File Read to C:\\Windows\\Temp\\WindowsParentalControlMigration\\ MITRE-ATTACK-EVALS.HTML'}], 'Footnotes': ['The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for a file collected from C:\\Users\\oscar\\Documents. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12691.png', 'ScreenshotCaption': 'MSSP - 15A1 (NEED VARIABLES) - 16C1/2- 17A1 - 17B - 17C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file access of MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for  PowerShell executing an ADS.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17563.png', 'ScreenshotCaption': 'RCA view - copying the html file'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '17.B.2', 'Procedure': 'Staged collected file into directory using PowerShell', 'Criteria': 'powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML', 'Techniques': [{'TechniqueId': 'T1074', 'TechniqueName': 'Data Staged', 'Tactics': [{'TacticName': 'Collection', 'TacticId': 'TA0009'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection called "PowerShell Suspicious Write" was generated due to a PowerShell file write to an uncommon location.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1002.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9799.png', 'ScreenshotCaption': '17.b.2 - file event with the powershell process tree and html file '}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12317.png', 'ScreenshotCaption': 'B2 - File creation event for MITRE-ATTACK-EVALS.HTML '}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file creation event for MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent General detection for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1564.png', 'ScreenshotCaption': '17b2 file create of ATTCK Evals html'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of MITRE-ATTACK-EVALS.html being copied into the Temp folder.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}, {'ScreenshotName': 'F-Secure-APT29-11320.png', 'ScreenshotCaption': 'MSSP - move to B- copy-item'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell writing the MITRE-ATTACK-EVALS.HTML file to disk.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11585.png', 'ScreenshotCaption': '17.B.2 - PowerShell File Write for MITRE-ATTACK-EVALS.HTML (top)'}, {'ScreenshotName': 'FireEye-APT29-11584.png', 'ScreenshotCaption': '17.B.2 - PowerShell File Write for MITRE-ATTACK-EVALS.HTML (bottom)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. This event was correlated to parent alerts relating to the PowerShell process that carried out the file write.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11589.png', 'ScreenshotCaption': '17.B.2 - Triage view of the file write for MITRE-ATTACK-EVALS.HTML'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) called "Email Collection (email file copy)" was generated for the file copy MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent detection on "Bypass User Account Control."', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11453.png', 'ScreenshotCaption': 'b1 - file read - powershell copying the html file from documents to temp, with an impact score of 40. and tagged with email collection'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The event was correlated to a parent detection on "Bypass User Account Control."', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11453.png', 'ScreenshotCaption': 'b1 - file read - powershell copying the html file from documents to temp, with an impact score of 40. and tagged with email collection'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3931.png', 'ScreenshotCaption': 'B.2 - File created event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing the file write event for WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18020.png', 'ScreenshotCaption': 'new mssp or recrop current'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3296.png', 'ScreenshotCaption': '17.b.2 - tree'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence PowerShell executed a command to copy a malicious HTML file to a TEMP folder with a different name.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1147.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection and Defense Evasion (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1148.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection and Defense Evasion (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-542.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe creating file C:\\Windows\\Temp\\WindowsParentalControlMigration\\ MITRE-ATTACK-EVALS.HTML'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3297.png', 'ScreenshotCaption': 'Telemetry showing powershell writing MITRE-ATTACK-EVALS.HTML.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3298.png', 'ScreenshotCaption': 'Telemetry showing powershell writing MITRE-ATTACK-EVALS.HTML.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-202.png', 'ScreenshotCaption': 'file write; for 17.b.2'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1074" occurred containing evidence of Copy-Item with ..\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML being the destination file. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12884.png', 'ScreenshotCaption': 'MSSP - Copy-Item'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.  The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6938.png', 'ScreenshotCaption': 'B2 - File Write to C:\\Windows\\Temp\\WindowsParentalControlMigration\\ MITRE-ATTACK-EVALS.HTML'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9874.png', 'ScreenshotCaption': 'powershell.exe created and modified html file'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'A MSSP detection occurred for a file collected then staged. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12691.png', 'ScreenshotCaption': 'MSSP - 15A1 (NEED VARIABLES) - 16C1/2- 17A1 - 17B - 17C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for  PowerShell executing an ADS.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17563.png', 'ScreenshotCaption': 'RCA view - copying the html file'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell staging a collected file into a directory.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14758.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4330.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '17.C.1', 'Procedure': 'Compressed a staging directory using PowerShell', 'Criteria': 'powershell.exe executing the ZipFile.CreateFromDirectory .NET method', 'Techniques': [{'TechniqueId': 'T1002', 'TechniqueName': 'Data Compressed', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for Powershell creating a compressed archive.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13445.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1108.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method and the subsequent ZipFileWritten event. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10701.png', 'ScreenshotCaption': 'Telemetry showing ZipFileWritten event for powershell on WindowsParentalControlMigration. Telemetry showing PowerShell prepending the GIF file header to the compressed file.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for the PowerShell script which included compressing collection via the ZipFile.CreateFromDirectory .NET method.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2481.png', 'ScreenshotCaption': 'zip scriptblock log with enrichments'}, {'ScreenshotName': 'CyCraft-APT29-2386.png', 'ScreenshotCaption': 'CyCarrier Raw Data: PowerShell execution of zip command'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of data compression.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12516.png', 'ScreenshotCaption': '17.B.1 - MDR Report Day 2,staging obfsucation and collection'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Data Compressed occurred containing evidence of PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10807.png', 'ScreenshotCaption': 'MSSP - function zip - c1'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "GUARD: Common File Archive Exfiltration Staging"  was generated due to the zip archive creation.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12151.png', 'ScreenshotCaption': 'C1 - Low alert for Common File Archive Exfiltration Staging on file creation'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data Theft and Exfiltration" occurred containing evidence of zip archive creation.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12928.png', 'ScreenshotCaption': 'MSSP - GUARD alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1568.png', 'ScreenshotCaption': 'zipfilename powershell script block event'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell compressing WindowsParentalControlMigration.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}, {'ScreenshotName': 'F-Secure-APT29-11320.png', 'ScreenshotCaption': 'MSSP - move to B- copy-item'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10453.png', 'ScreenshotCaption': 'set-content'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Zip Archive Created" was generated due to the creation of the ZIP archive WindowsParentalControlMigration.tmp on disk.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11591.png', 'ScreenshotCaption': '17.C.1 - Zip Archive Creation (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11590.png', 'ScreenshotCaption': '17.C.1 - Zip Archive Creation (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of data compression.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13046.png', 'ScreenshotCaption': 'MSSP - 17.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11602.png', 'ScreenshotCaption': '17.C.1 - Script block for the "zip" function'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3937.png', 'ScreenshotCaption': '17.C - CreateFromDirectory usage and set-content with GIF Magic Bytes'}, {'ScreenshotName': 'HanSight-APT29-3937.png', 'ScreenshotCaption': '17.C - CreateFromDirectory usage and set-content with GIF Magic Bytes'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred contained evidence of data compression.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12412.png', 'ScreenshotCaption': '17.c.1 - MSSP report'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1885.png', 'ScreenshotCaption': 'PS data compressed'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-540.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block with zip command.'}, {'ScreenshotName': 'Microsoft-APT29-541.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block prepending 0x47,0x49,0x46,0x38,0x39,0x61 to zip file via Set-Content.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for Data Staged was generated when the WindowsParentalControlMigration.tmp file was compressed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3305.png', 'ScreenshotCaption': 'Telemetry showing data staged in the .tmp zip folder. (2/2)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3303.png', 'ScreenshotCaption': 'Telemetry showing data staged in the .tmp zip folder. (1/2)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of data compression.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13259.png', 'ScreenshotCaption': '17.C.1, 17.C.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-17857.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-333.png', 'ScreenshotCaption': 'cc - createfromdirectory'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell compressing collection.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13787.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7153.png', 'ScreenshotCaption': '17.c.1/2 - zip function, byte array, set-content'}, {'ScreenshotName': 'SecureWorks-APT29-7152.png', 'ScreenshotCaption': '17.c.1/2 - zip command event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for "Data Compressed" was generated due to an entropy calculation of WindowsParentalControlMigration.tmp. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6950.png', 'ScreenshotCaption': 'C1 - Alert showing file is compressed'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1002" occurred containing evidence of "zip" function compressing collection via ZipFile.CreateFromDirectory .NET method.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12885.png', 'ScreenshotCaption': 'MSSP - alert, SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7273.png', 'ScreenshotCaption': 'CC - C2 - powershell alert showing zip function definition '}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of commands used to copy and compress data.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12972.png', 'ScreenshotCaption': 'MSSP Day 1: zip function'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of data compression.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12691.png', 'ScreenshotCaption': 'MSSP - 15A1 (NEED VARIABLES) - 16C1/2- 17A1 - 17B - 17C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell loading a DLL associated with compression and the subsequent creation of the tmp folder (identified as a ZIP).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17565.png', 'ScreenshotCaption': '1 - showing the tmp file is a zip'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell compressed a staging directory.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14758.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4326.png', 'ScreenshotCaption': 'function zip'}, {'ScreenshotName': 'Carbon Black-APT29-4331.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '17.C.2', 'Procedure': 'Prepended the GIF file header to a compressed staging file using PowerShell', 'Criteria': 'powershell.exe executing Set-Content', 'Techniques': [{'TechniqueId': 'T1027', 'TechniqueName': 'Obfuscated Files or Information', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1108.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10701.png', 'ScreenshotCaption': 'Telemetry showing ZipFileWritten event for powershell on WindowsParentalControlMigration. Telemetry showing PowerShell prepending the GIF file header to the compressed file.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated for the PowerShell script, which included PowerShell appending the GIF file header to the compressed file.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2481.png', 'ScreenshotCaption': 'zip scriptblock log with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Obfuscated Files or Information" occurred containing evidence PowerShell was used to add noisy data (GIF89) to an archive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12516.png', 'ScreenshotCaption': '17.B.1 - MDR Report Day 2,staging obfsucation and collection'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Obfuscated Files or Information" occurred containing evidence of PowerShell appending the GIF file header to the compressed file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10808.png', 'ScreenshotCaption': 'MSSP - set content - c2'}, {'ScreenshotName': 'Cybereason-APT29-10807.png', 'ScreenshotCaption': 'MSSP - function zip - c1'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12152.png', 'ScreenshotCaption': 'C2 - Medium alert on base64 powershell and SBL showing GIF header via set-content'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13979.png', 'ScreenshotCaption': '17C2 - vendor pic - set-content'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell appending the GIF file header to the compressed file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11320.png', 'ScreenshotCaption': 'MSSP - move to B- copy-item'}, {'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10453.png', 'ScreenshotCaption': 'set-content'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell writing the WindowsParentalControlMigration.tmp file to disk with the GIF89a header present in the textAtLowestOffset field.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11592.png', 'ScreenshotCaption': '17.C.2 - PowerShell File Write for WindowsParentalControlMigration.tmp (top)'}, {'ScreenshotName': 'FireEye-APT29-11596.png', 'ScreenshotCaption': '17.C.2 - PowerShell File Write for WindowsParentalControlMigration.tmp (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13046.png', 'ScreenshotCaption': 'MSSP - 17.C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11601.png', 'ScreenshotCaption': '17.C.2 - Script block for set-content on header bytes'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though file was manually pulled to show the GIF89 header, it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11461.png', 'ScreenshotCaption': 'manually pulled the file, and exploring in sublime, see the gif89 prepend. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3937.png', 'ScreenshotCaption': '17.C - CreateFromDirectory usage and set-content with GIF Magic Bytes'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence that WindowsParentalControlMigration.tmp was a ZIP archive with a gif file header.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12414.png', 'ScreenshotCaption': '17.c.2 MSSP report #2'}, {'ScreenshotName': 'Kaspersky-APT29-12413.png', 'ScreenshotCaption': '17.c.2 MSSP report #1'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation.', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1888.png', 'ScreenshotCaption': '17.c.2 GIF89 pre-pended to zip file - RT search'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Suspicious Activity was generated containing evidence PowerShell appended bytes from a GIF file header format to WindowsParentalControlMigration.tmp.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1148.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection and Defense Evasion (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1147.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Collection and Defense Evasion (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-541.png', 'ScreenshotCaption': 'Telemetry in the advanced hunting query interface showing executed script block prepending 0x47,0x49,0x46,0x38,0x39,0x61 to zip file via Set-Content.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13259.png', 'ScreenshotCaption': '17.C.1, 17.C.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13729.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-17857.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-334.png', 'ScreenshotCaption': 'cc - setcontent (same function as earlier)'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell appending the GIF file header to the compressed file.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13787.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7152.png', 'ScreenshotCaption': '17.c.1/2 - zip command event details'}, {'ScreenshotName': 'SecureWorks-APT29-7153.png', 'ScreenshotCaption': '17.c.1/2 - zip function, byte array, set-content'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "HeaderExtensionMismatch" was generated due to file header not matching file extension. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7274.png', 'ScreenshotCaption': 'CC - C2 - HeaderExtensionMismatch alert generated'}], 'Footnotes': ['A Detection Configuration Change was made to identify "HeaderExtensionMismatch", generated on file header not matching file extension.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence that additional bytes were used to disguise a zip as a GIF image format.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12885.png', 'ScreenshotCaption': 'MSSP - alert, SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-15041.png', 'ScreenshotCaption': '17.C.2 - zip function being called'}, {'ScreenshotName': 'SentinelOne-APT29-15040.png', 'ScreenshotCaption': '17.C.2 - zip function definition script block'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure. PowerShell was seen modifying WindowsParentalControlMigration.tmp and increasing the file size by 6 bytes but there is no indication addition is for obfuscation.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9884.png', 'ScreenshotCaption': 'powershell.exe modified tmp file, adding 6 bytes'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of WindowsParentalControlMigration.tmp changing from PKZIP to GIF. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12691.png', 'ScreenshotCaption': 'MSSP - 15A1 (NEED VARIABLES) - 16C1/2- 17A1 - 17B - 17C'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WindowsParentalControlMigration.tmp filetype changing from PKZIP to GIF.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17567.png', 'ScreenshotCaption': '2 - show file type change from zip to gif'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4326.png', 'ScreenshotCaption': 'function zip'}], 'Footnotes': []}]}]}]}, {'Substep': '18.A.1', 'Procedure': 'Mapped a network drive to an online OneDrive account using PowerShell', 'Criteria': 'net.exe with command-line arguments then making a network connection to a public IP over port 443', 'Techniques': [{'TechniqueId': 'T1102', 'TechniqueName': 'Web Service', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) was generated for an attempt to connect to a remote share via net.exe. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-984.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-977.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert identifying the powershell.exe process as malware.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-973.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-989.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-1003.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent technique detection for PowerShell.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10709.png', 'ScreenshotCaption': 'Telemetry showing net.exe making network connections to public IP over port 443.'}, {'ScreenshotName': 'CrowdStrike-APT29-10708.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe with command line arguments.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Web Service" was received that described the adversary mapping OneDrive as a network device and exfiltrating data to it.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12518.png', 'ScreenshotCaption': '18.A.1 - MDR Report Day 2, summary & powershell execution of net use'}, {'ScreenshotName': 'CyCraft-APT29-12519.png', 'ScreenshotCaption': '18.A.1 - MDR Report Day 2, net use execution and copy-item'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated due to net.exe conducting suspicious activity and connecting to a well known port. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9812.png', 'ScreenshotCaption': '18.a.1 - network connection over port 443'}, {'ScreenshotName': 'Cybereason-APT29-9807.png', 'ScreenshotCaption': '18.a.1 - net process tree'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) called "One-Liner ML Module" was generated for a suspicious use of a scripting engine.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12154.png', 'ScreenshotCaption': 'A1 - Low alert for suspicious online-liner ML on net use command'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data Theft and Exfiltration" occurred containing evidence of "One-Liner ML Module" that identified details of mapping a OneDrive URL to the Y: drive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12934.png', 'ScreenshotCaption': 'MSSP - ML alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12319.png', 'ScreenshotCaption': 'A1 - Network connection info for net.exe - check pub ip'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) for "Accessing Windows Network Shares" was generated for net.exe with command-line arguments. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14357.png', 'ScreenshotCaption': 'port 443 connetion from net'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-14357.png', 'ScreenshotCaption': 'port 443 connetion from net'}, {'ScreenshotName': 'Elastic-APT29-14378.png', 'ScreenshotCaption': 'scriptblock net use command'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (informational severity) was generated for net.exe making a network connection. It included details of net.exe executing and connecting to a public IP over port 443. This is correlated to a previous detection for PowerShell.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10478.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of file exfiltration to a Microsoft OneDrive that is mapped as a share drive "Y:".', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11320.png', 'ScreenshotCaption': 'MSSP - move to B- copy-item'}, {'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10462.png', 'ScreenshotCaption': 'a1 - remote ip and port'}, {'ScreenshotName': 'F-Secure-APT29-10460.png', 'ScreenshotCaption': 'a1 - net use '}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Web Service C2" was generated due to an abnormal application making requests for common web services.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11761.png', 'ScreenshotCaption': 'CC - 18.A.1 - Web Service C2 from net.exe'}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for execution of the "net use" command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11610.png', 'ScreenshotCaption': '18.A - Net Use Command Execution'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for WebDav activity when mapping the OneDrive URL.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11611.png', 'ScreenshotCaption': '18.A - WebDav activity to OneDrive'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for net.exe connecting to a OneDrive URL.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13047.png', 'ScreenshotCaption': 'MSSP - 18.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. This detection was correlated to a parent alert for a PowerShell process than ran net.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11623.png', 'ScreenshotCaption': '18.A.1 - Triage view of net.exe making connections to public IPs on port 443'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) was generated for an outbound connection network operation over a commonly used port. The event was correlated to a parent detection on "Bypass User Account Control."', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11487.png', 'ScreenshotCaption': 'net.exe connection over port 443. tagged with commonly used port. '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The event was correlated to a parent detection on "Bypass User Account Control."', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11487.png', 'ScreenshotCaption': 'net.exe connection over port 443. tagged with commonly used port. '}, {'ScreenshotName': 'GoSecure-APT29-11472.png', 'ScreenshotCaption': 'net event,  with mapped onedrive, tagged with remote system discovery, create account, credentials in files, impact of 75. '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3948.png', 'ScreenshotCaption': '18.A.1 - net.exe making network connection to public IP over port 443'}, {'ScreenshotName': 'HanSight-APT29-3950.png', 'ScreenshotCaption': '18.A.1 - powershell.exe as parent process of net.exe command'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-13803.png', 'ScreenshotCaption': '18a1 - telemetry - vendor pic'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for a "data gathering PowerShell command" was generated for net.exe with command-line arguments to connect to a OneDrive URL.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2572.png', 'ScreenshotCaption': 'net.exe'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (yellow indicator) called "Collection" was generated for net.exe having active network connections. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1905.png', 'ScreenshotCaption': '18.a.1 - net use alert with caption'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for a socket opened by a "process that commonly does not do it".', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1898.png', 'ScreenshotCaption': '18.a.1 - net connection to port 443'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1898.png', 'ScreenshotCaption': '18.a.1 - net connection to port 443'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated by Microsoft Cloud App Security due to an unsanctioned or unknown Cloud app (identified as Microsoft OneDrive) being accessed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17404.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-543.png', 'ScreenshotCaption': 'Telemetry showing net.exe establishing connection to 40.90.23.153 over TCP port 443.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called "Non-browser access to a web service" was generated when net.exe made an HTTPS connection to a OneDrive URL. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3318.png', 'ScreenshotCaption': 'Technique detection showing "Non-browser access to web service."'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) called "WebDAV drive mount from net.exe over HTTPS" was generated when net.exe made an HTTPS connection. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3318.png', 'ScreenshotCaption': 'Technique detection showing "Non-browser access to web service."'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of net.exe connection to OneDrive over TCP port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13260.png', 'ScreenshotCaption': '18.A.1, 18.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3318.png', 'ScreenshotCaption': 'Technique detection showing "Non-browser access to web service."'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for suspicious file deobfuscation via certutil.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-209.png', 'ScreenshotCaption': 'red powershell spawning net.exe; shows net use with creds; shows connections to ip'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of net.exe mounting a share from OneDrive and connecting to a Microsoft IP.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13787.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7170.png', 'ScreenshotCaption': '18.a.1 - another netflow event around 443, maybe ignore this one use other'}, {'ScreenshotName': 'SecureWorks-APT29-7174.png', 'ScreenshotCaption': '18.a.1 - net use command, script block event details'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1102" occurred containing evidence of net.exe with command-line arguments connecting to OneDrive public IP and URL over port 443 using HTTPS.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12887.png', 'ScreenshotCaption': 'MSSP - Outlook network information'}, {'ScreenshotName': 'SentinelOne-APT29-12886.png', 'ScreenshotCaption': 'MSSP - net.exe CLI ARGs'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6952.png', 'ScreenshotCaption': 'A1 - net.exe making connection to OneDrive domain'}, {'ScreenshotName': 'SentinelOne-APT29-6955.png', 'ScreenshotCaption': 'A1 - Network connection information port, ip, protocol using Net Command and shows HTTPS'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Web Service" was received that included a PowerShell command executed by the adversary and explained that it was used to exfiltrate locally staged data to a remote WebDav share.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12973.png', 'ScreenshotCaption': 'MSSP Day 1: Exfil using Web Service'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9839.png', 'ScreenshotCaption': 'powershell.exe executed net.exe to map the OneDrive share'}, {'ScreenshotName': 'Symantec-APT29-9838.png', 'ScreenshotCaption': 'Shows lineage of events related to mapping the network drive from the WebDav share on OneDrive'}, {'ScreenshotName': 'Symantec-APT29-9885.png', 'ScreenshotCaption': 'net.exe connection to internet, followed by transfer of data via TLS'}], 'Footnotes': ['The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual).']}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) for "Shared Resource Mapping (net use)" was generated for net.exe making a network connection to public IP over port 443.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12173.png', 'ScreenshotCaption': 'windows admin share alert - net.exe lat movement '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for  PowerShell executing an ADS.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12200.png', 'ScreenshotCaption': 'RCA view for net.exe with port - telem'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for net.exe making network connections. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14759.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4334.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4333.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}, {'Substep': '18.A.2', 'Procedure': 'Exfiltrated staged collection to an online OneDrive account using PowerShell', 'Criteria': 'powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account', 'Techniques': [{'TechniqueId': 'T1048', 'TechniqueName': 'Exfiltration Over Alternative Protocol', 'Tactics': [{'TacticName': 'Exfiltration', 'TacticId': 'TA0010'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1109.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10704.png', 'ScreenshotCaption': 'Telemetry from Scriptblock logging showing powershell.exe executing Copy-Item.'}], 'Footnotes': ['All activity associated with an alert is grouped and correlated via the relevant detection tree.']}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated identifying PowerShell executing Copy-Item as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2485.png', 'ScreenshotCaption': 'copy-item of .tmp file with enrichment'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Exfiltration Over Alternative Protocol" was received that described the adversary mapping OneDrive as a network device and exfiltrating data to it.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12518.png', 'ScreenshotCaption': '18.A.1 - MDR Report Day 2, summary & powershell execution of net use'}, {'ScreenshotName': 'CyCraft-APT29-12519.png', 'ScreenshotCaption': '18.A.1 - MDR Report Day 2, net use execution and copy-item'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (unique symbol) was generated for PowerShell executing a malicious command. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9942.png', 'ScreenshotCaption': '18.a.2 - malicious command  Alert (cc)'}, {'ScreenshotName': 'Cybereason-APT29-9814.png', 'ScreenshotCaption': '18.a.2 - malicious powershell process tree with tmp file from the command line'}], 'Footnotes': ['A sensor policy update that enables deeper PowerShell visibility was re-applied.']}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Exfiltration Over Alternative Protocol occurred containing evidence of PowerShell using Copy-Item to the Y drive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-10809.png', 'ScreenshotCaption': 'MSSP - a2'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) called "Win_CopyOperation_MITRET1074" was generated for PowerShell copying files.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12155.png', 'ScreenshotCaption': 'A2 - Medium alert for Copy Operation showing powershell using Copy-Item to Y drive'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Data Theft and Exfiltration" occurred containing evidence of Copy-Item to the Y drive.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12940.png', 'ScreenshotCaption': 'MSSP - copy-item alert + SBL'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent alert for a suspicious Windows script.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1588.png', 'ScreenshotCaption': 'copy item script block'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of file exfiltration to a Microsoft OneDrive that is mapped as a share drive "Y:".', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11320.png', 'ScreenshotCaption': 'MSSP - move to B- copy-item'}, {'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10464.png', 'ScreenshotCaption': 'a2 - copy item of the .tmp'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection alert was generated for a file write to a network share.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11618.png', 'ScreenshotCaption': '18.A.2 - File Write to Network Share for WindowsParentalControlMigration.tmp (top)'}, {'ScreenshotName': 'FireEye-APT29-11619.png', 'ScreenshotCaption': '18.A.2 - File Write to Network Share for WindowsParentalControlMigration.tmp (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the WindowsParentalControlMigration.tmp file being written to the mapped OneDrive network share.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13047.png', 'ScreenshotCaption': 'MSSP - 18.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent alert on the PowerShell process.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11622.png', 'ScreenshotCaption': '18.A.2 - Triage view of PowerShell copying WindowsParentalControlMigration.tmp to the Y drive'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the exfiltrated data within the mapped OneDrive directory. The event was correlated to a parent detection for "Bypass User Account Control."', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11477.png', 'ScreenshotCaption': 'file copy of tmp file to onedrive, tagged with ntfs/ads and impact score of 20'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3951.png', 'ScreenshotCaption': '18.A.2 - Copy-Item to Y drive'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Network data collection was not active at the time of the evaluation due to ongoing product enhancements.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.  ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) was generated by Microsoft Cloud App Security due to an unsanctioned or unknown Cloud app (identified as Microsoft OneDrive) being accessed.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-17404.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence  WindowsParentalControlMigration.tmp file was written to the mapped OneDrive network share.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13260.png', 'ScreenshotCaption': '18.A.1, 18.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the creation of the exfiltrated data within the mapped OneDrive directory. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3321.png', 'ScreenshotCaption': 'Telemetry showing powershell creating the tmp file in the Y drive.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-336.png', 'ScreenshotCaption': 'cc - copy-item command'}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13787.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-16055.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1048" occurred containing evidence of PowerShell executing Copy-Item on WindowsParentalControlMigration.tmp.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12887.png', 'ScreenshotCaption': 'MSSP - Outlook network information'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': ['Correlated', 'Configuration Change (UX)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7282.png', 'ScreenshotCaption': 'CC - A2 - Generic powershell alert showing Copy-Item call'}], 'Footnotes': ['A UX Configuration Change was made to bring PowerShell script block logs into the user interface.']}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Exfiltration Over Alternative Protocol" was received that included a PowerShell command executed by the adversary and explained that it was used to copy a file to a drive mapped to a WebDav share.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-12973.png', 'ScreenshotCaption': 'MSSP Day 1: Exfil using Web Service'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure, though events showed the creation of the exfiltrated data within the previously mapped Y drive.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17569.png', 'ScreenshotCaption': '2 - rca - ps > y:drive'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-14758.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a OneDrive account, along with the creation of the exfiltrated data within the OneDrive. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4344.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4341.png', 'ScreenshotCaption': 'copy-item'}], 'Footnotes': []}]}]}]}, {'Substep': '19.A.1', 'Procedure': 'Deleted Mimikatz (m.exe) on disk using SDelete', 'Criteria': 'File delete event for C:\\Windows\\System32\\m.exe', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '19.A.2', 'Procedure': 'Reflectively injected SDelete binary into PowerShell', 'Criteria': 'Injection into PowerShell via Invoke-ReflectivePEInjection', 'Techniques': [{'TechniqueId': 'T1055', 'TechniqueName': 'Process Injection', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '19.B.1', 'Procedure': 'Deleted exfiltrated data on disk using SDelete', 'Criteria': 'File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '19.B.2', 'Procedure': 'Reflectively injected SDelete binary into PowerShell', 'Criteria': 'Injection into PowerShell via Invoke-ReflectivePEInjection', 'Techniques': [{'TechniqueId': 'T1055', 'TechniqueName': 'Process Injection', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '19.C.1', 'Procedure': 'Deleted staged data on disk using SDelete', 'Criteria': 'File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML', 'Techniques': [{'TechniqueId': 'T1107', 'TechniqueName': 'File Deletion', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '19.C.2', 'Procedure': 'Reflectively injected SDelete binary into PowerShell', 'Criteria': 'Injection into PowerShell via Invoke-ReflectivePEInjection', 'Techniques': [{'TechniqueId': 'T1055', 'TechniqueName': 'Process Injection', 'Tactics': [{'TacticName': 'Defense Evasion', 'TacticId': 'TA0005'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': 'Due to execution inconsistencies Step 19 has been omitted from the evaluation results.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}]}]}, {'Substep': '20.A.1', 'Procedure': 'Executed Run key persistence payload on user login using RunDll32', 'Criteria': 'rundll32.exe executing kxwn.lock', 'Techniques': [{'TechniqueId': 'T1085', 'TechniqueName': 'Rundll32', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for "rundll32uncommonload" due to rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1016.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10738.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing kxwn.lock.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2491.png', 'ScreenshotCaption': 'rundll32 executing lock file with enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Rundll32" described rundll32.exe executing kxwn.lock, triggered by Registry Run Keys / Startup Folder persistence.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12521.png', 'ScreenshotCaption': '20.A.1, 20.B.1 - MDR Report Day 2, summary and rundll32 execution of kxwn.lock'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9830.png', 'ScreenshotCaption': '20.a.1 - command line from properties from process'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Win_Rundll32_Usage_MitreT1085" was generated due to Rundll32 executing a DLL. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12169.png', 'ScreenshotCaption': 'A1 - low alert for Rundll32 usage and rundll32.exe executing kxwn.lock with CLI arguments'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "RunDLL32 with Suspicious DLL Location" was generated for rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1613.png', 'ScreenshotCaption': 'rundll32 with suspicious dll location alert, showing command line with .lock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1613.png', 'ScreenshotCaption': 'rundll32 with suspicious dll location alert, showing command line with .lock'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Rare DLL explicitly loaded by rundll32" was generated due to rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10499.png', 'ScreenshotCaption': '20a1 - detection name, rundll32 /kxwn from explorer  - need to move'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Rundll32 launching a DLL in the AppData directory" was generated due to rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10526.png', 'ScreenshotCaption': 'poshc2 tag'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10518.png', 'ScreenshotCaption': 'rundll32 .lock'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Rundll32 Execution" was generated due to the execution of rundll32.exe on kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11664.png', 'ScreenshotCaption': '20.A.1 - Rundll32 execution on kxwn.lock (top)'}, {'ScreenshotName': 'FireEye-APT29-11665.png', 'ScreenshotCaption': '20.A.1 - Rundll32 execution on kxwn.lock (bottom)'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Rundll32 Not Running DLL" was generated due to rundll32.exe executing kxwn.lock, which did not have a .dll extension.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11662.png', 'ScreenshotCaption': '20.A.1 - Rundll32 not running file with a .dll extension (top)'}, {'ScreenshotName': 'FireEye-APT29-11663.png', 'ScreenshotCaption': '20.A.1 - Rundll32 not running file with a .dll extension (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for rundll32.exe executing kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13054.png', 'ScreenshotCaption': 'MSSP - 20.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for rundll32.exe executing kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12737.png', 'ScreenshotCaption': '20.a.1 MSSP alert #1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "Rundll32" was generated due to rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3963.png', 'ScreenshotCaption': '20.A.1 - Rundll32 executing kxwn.lock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock. ', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow, medium severity) called Rundll32 Execution was generated due to rundll32.exe executing kxwn.lock. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3355.png', 'ScreenshotCaption': '20.a.1 - rundll32 exec kxwn.lock'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of rundll32.exe executing kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12421.png', 'ScreenshotCaption': '20.a.1 MSSP report'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3355.png', 'ScreenshotCaption': '20.a.1 - rundll32 exec kxwn.lock'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "rundll32 abuse" was generated due to rundll32.exe executing kxwn.lock.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2567.png', 'ScreenshotCaption': 'rundll32.exe executing kxwn.lock (20a1) - staging environment'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange; medium risk) called "Rundll32" was generated due to rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-14750.png', 'ScreenshotCaption': '20A1 - rundll32 vendor pic'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1915.png', 'ScreenshotCaption': '20.a.1 - rundll32 exec kxwn.lock #2'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange, suspicious tag) was generated for kxwn.lock being potential malware. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-548.png', 'ScreenshotCaption': 'Detection for vigorf malware'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Execution was generated containing evidence that rundll32.exe executed the VoidFunc function from file kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1150.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Execution\nand Persistence (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1149.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Execution\nand Persistence (1 of 2)'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of rundll32.exe executing kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-15751.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3322.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing kxwn.lock.'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3325.png', 'ScreenshotCaption': 'Telemetry showing rundll32.exe executing kxwn.lock.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Rundll32" was generated due to rundll32.exe executing kxwn.lock. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-223.png', 'ScreenshotCaption': 'full tree capture - rundll32'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) for Rundll32 called "PowerDuke DLL Name" was generated due to rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7268.png', 'ScreenshotCaption': '20.a.1 - technique mappings from alert '}, {'ScreenshotName': 'SecureWorks-APT29-7267.png', 'ScreenshotCaption': '20.a.1 - powerduke DLL name alert details'}, {'ScreenshotName': 'SecureWorks-APT29-7269.png', 'ScreenshotCaption': '20.a.1 - procss overview from alert'}, {'ScreenshotName': 'SecureWorks-APT29-7271.png', 'ScreenshotCaption': '20.a.1 - full process tree voidfunc'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17650.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1085" occurred containing evidence of rundll32.exe executing kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12891.png', 'ScreenshotCaption': 'MSSP - rundll32.exe executing kxwn.lock'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6980.png', 'ScreenshotCaption': 'A1 - rundll32.exe process spawning and executing kxwn.lock'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Rundll32" was generated on "malicious file kxwn.lock with heuristic signature SONAR.Module!gen3".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17729.png', 'ScreenshotCaption': '20a1 - technique detection on SONAR TRIGGERING EVENT'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "SONAR - RunDLL32 loaded a suspicious DLL" was generated due to rundll32.exe executing kxwn.lock.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9853.png', 'ScreenshotCaption': 'Rundll32 loaded a suspicious DLL alert, tagged with Rundll32'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9853.png', 'ScreenshotCaption': 'Rundll32 loaded a suspicious DLL alert, tagged with Rundll32'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for a previously planted persistence mechanism executing rundll32.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12693.png', 'ScreenshotCaption': 'MSSP - 20A1 - 20B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17571.png', 'ScreenshotCaption': '1 - rundll > kxwn'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of rundll32.exe executing kxwn.lock.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12778.png', 'ScreenshotCaption': '20.a mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed rundll32.exe executing kxwn.lock.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4364.png', 'ScreenshotCaption': 'rundll32.exe executing .lock'}], 'Footnotes': []}]}]}]}, {'Substep': '20.A.2', 'Procedure': 'Executed WMI persistence on user login', 'Criteria': 'The WMI process (wmiprvse.exe) executing powershell.exe', 'Techniques': [{'TechniqueId': 'T1084', 'TechniqueName': 'Windows Management Instrumentation Event Subscription', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "executepowershellthroughwmi" was generated due to PowerShell being executed by WMI.', 'Modifiers': ['Configuration Change (Detections)', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1110.png', 'ScreenshotCaption': ''}], 'Footnotes': ['The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "WmiFilterConsumerBind" was generated due to PowerShell being executed by WMI. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-15009.png', 'ScreenshotCaption': '20a2 - new vendor screenshot'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10739.png', 'ScreenshotCaption': 'Telemetry showing WmiPrvSE.exe executing powershell.exe. Telemetry showing a SYSTEM-level PowerShell spawned from wmiprvse.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red alert icon) for "Windows Management Instrumentation Event Subscription" was generated for wmiprvse.exe executing the PowerShell stager.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-15516.png', 'ScreenshotCaption': '20a2  -  new screenshot from feedback'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Windows Management Instrumentation Event Subscription" was received that described the triggering of a WMI Event Subscription upon logon of user Oscar in order to execute powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12521.png', 'ScreenshotCaption': '20.A.1, 20.B.1 - MDR Report Day 2, summary and rundll32 execution of kxwn.lock'}, {'ScreenshotName': 'CyCraft-APT29-12522.png', 'ScreenshotCaption': '20.A.1 - MDR Report Day 2, execution of WMI event persistence'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9831.png', 'ScreenshotCaption': '20.a.2 - process tree with wmiprvse and powershell'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General detection was generated for PowerShell having an unusual parent.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12170.png', 'ScreenshotCaption': 'A2/3 - Medium alert for unusual powershell parent  process - wmiprvse.exe executing powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ATT&CK T1047 Windows Management Instrumentation" was generated for PowerShell being executed via WMI. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1618.png', 'ScreenshotCaption': 'wmi taggin of parent powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1617.png', 'ScreenshotCaption': 'showing lineage with process tree. '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': "A General alert detection (medium severity) was generated for WMI starting a system process it normally doesn't start.", 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10698.png', 'ScreenshotCaption': 'wmi spawning powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WmiPrvSE executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10515.png', 'ScreenshotCaption': 'wmiprvse executing powershell'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "WMI Process Creation" was generated due to wmiprvse.exe executing the PowerShell stager as a child process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11645.png', 'ScreenshotCaption': '20.A.2 - WMI Process Creation for the PowerShell stager (top)'}, {'ScreenshotName': 'FireEye-APT29-11646.png', 'ScreenshotCaption': '20.A.2 - WMI Process Creation for the PowerShell stager (bottom)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the WMI event subscription WindowsParentalControlMigration executing PowerShell upon user logon.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13054.png', 'ScreenshotCaption': 'MSSP - 20.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Warning severity) was generated for WMI creation of a suspicious child powershell.exe process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3965.png', 'ScreenshotCaption': '20.A - wmiprvse.exe executing SYSTEM PowerShell stager'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-15134.png', 'ScreenshotCaption': '20A3 - new vendor pic - scriptBlock with integrety level and wmiprvse'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; high severity) called "WMI Event Consumer Triggered" was generated due to wmiprvse.exe executing powershell.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3360.png', 'ScreenshotCaption': '20.a.2 Detection of powershell obfuscation came from unpacking of command line base64 payload by their tool'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of wmiprvse.exe executing the PowerShell stager.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12422.png', 'ScreenshotCaption': '20.a.2 MSSP report'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3357.png', 'ScreenshotCaption': '20.a.2 - wmiprvse exe ps tree'}, {'ScreenshotName': 'Kaspersky-APT29-3360.png', 'ScreenshotCaption': '20.a.2 Detection of powershell obfuscation came from unpacking of command line base64 payload by their tool'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2584.png', 'ScreenshotCaption': 'wmiprvse.exe executing PowerShell stager'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1916.png', 'ScreenshotCaption': '20.a.2 - wmiprvse launching ps'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for execution was generated containing evidence of the execution of malicious staging payload via WMI persistence, triggered by the logon of user Oscar.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1149.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Execution\nand Persistence (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1150.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Execution\nand Persistence (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-547.png', 'ScreenshotCaption': 'General detection for Suspicious PowerShell commandline'}], 'Footnotes': ['This activity would have been blocked by Microsoft Defender configured with Attack Surface Reduction.']}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called was generated for PowerShell executing as part of a Windows Management Instrumentation Event Subscription.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3326.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe executing powershell stager. (1/2)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3327.png', 'ScreenshotCaption': 'Telemetry showing svchost.exe executing powershell stager. (2/2)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of powershell.exe executing from Windows Management Instrumentation Event Subscription.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-15752.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-222.png', 'ScreenshotCaption': 'wmi spawning powershell with command line args and network connections'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) was generated for WMI launching a PowerShell downloader.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7277.png', 'ScreenshotCaption': '20.a.2 - process overview '}, {'ScreenshotName': 'SecureWorks-APT29-7276.png', 'ScreenshotCaption': '20.a.2 - alert details, technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-7275.png', 'ScreenshotCaption': '20.a.2 -Alert details wmi launches powershell downloader'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17653.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-17652.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of wmiprvse.exe executing the PowerShell stager.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-17876.png', 'ScreenshotCaption': '20.A.2 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the WMI Provider Host executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6992.png', 'ScreenshotCaption': 'A2/3 - Detailed wmiprvse.exe executing powershell stager'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9856.png', 'ScreenshotCaption': 'Shows wmiprvse.exe executing powershell.exe, which then executes the powershell stager.'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for WMI event subscription executing the PowerShell. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12693.png', 'ScreenshotCaption': 'MSSP - 20A1 - 20B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing powershell.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12206.png', 'ScreenshotCaption': 'a2/3 - wmi > PS - shows PS as system - telemetry'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for a PowerShell with network connections launched by WMI.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13964.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for Windows Management Instrumentation based on wmiprvse.exe executing PowerShell stager.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13963.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell having an unusual parent.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4371.png', 'ScreenshotCaption': 'hidden powershell with unusual parent'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing the PowerShell stager.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4358.png', 'ScreenshotCaption': 'process tree'}], 'Footnotes': []}]}]}]}, {'Substep': '20.A.3', 'Procedure': 'Executed PowerShell payload from WMI event subscription persistence', 'Criteria': 'SYSTEM-level powershell.exe spawned from the powershell.exe', 'Techniques': [{'TechniqueId': 'T1086', 'TechniqueName': 'PowerShell', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for powershell.exe launched with the encoded command parameter.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1027.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for powershell.exe due to "Suspicious Large Command Line".', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1024.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for the execution of a suspicious user process.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-13447.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-13448.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow unique icon) called “PowerShell” was generated when powershell was executed with a hidden window and encoded commands. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10735.png', 'ScreenshotCaption': 'A Technique detection called “PowerShell” for WmiPrvSE.exe executing powershell with a hidden window and encoded commands.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called “PShellExploitKit2” was generated by wmiprvse.exe executing powershell.exe as SYSTEM.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10740.png', 'ScreenshotCaption': 'A General detection called “PShellExploitKit2” for wmiprvse.exe executing powershell.exe as SYSTEM.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a SYSTEM-level PowerShell spawning from wmiprvse.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10739.png', 'ScreenshotCaption': 'Telemetry showing WmiPrvSE.exe executing powershell.exe. Telemetry showing a SYSTEM-level PowerShell spawned from wmiprvse.exe.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicatorl) for "Powershell" was generated due to  a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2494.png', 'ScreenshotCaption': 'wmiprvse.exe executing powershell.exe'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell" was received that described execution of powershell.exe triggered by a WMI Event Subscription.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12522.png', 'ScreenshotCaption': '20.A.1 - MDR Report Day 2, execution of WMI event persistence'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red, unique symbol) called "ATT&CK Execution: PowerShell" was generated due to a SYSTEM-level PowerShell spawned from wmiprvse.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9832.png', 'ScreenshotCaption': '20.a.3 - malops and suspicions'}, {'ScreenshotName': 'Cybereason-APT29-9834.png', 'ScreenshotCaption': '20.a.3 - process details and tree with system '}, {'ScreenshotName': 'Cybereason-APT29-9836.png', 'ScreenshotCaption': '20.a.3 - system user from evidence'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from WMI event subscription (wmiprvse.exe) as SYSTEM.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9834.png', 'ScreenshotCaption': '20.a.3 - process details and tree with system '}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Win_Powershell_Base64_MITRET1027" was generated for PowerShell decoding base64 information.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12172.png', 'ScreenshotCaption': 'A3 - SYSTEM level powershell and medium alert for base64 encoded powershell'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) called "Unusual PowerShell Parent Processes" was generated for wmiprvse.exe spawning powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12170.png', 'ScreenshotCaption': 'A2/3 - Medium alert for unusual powershell parent  process - wmiprvse.exe executing powershell'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange, medium severity) for "PowerShell with Unusual Arguments" was generated for the execution of PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13691.png', 'ScreenshotCaption': 'powershell with unusual arguements alert'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "ATT&CK T1085 PowerShell" was generated due to the execution of PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-13691.png', 'ScreenshotCaption': 'powershell with unusual arguements alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawned from WMI event subscription (wmiprvse.exe) as SYSTEM. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1618.png', 'ScreenshotCaption': 'wmi taggin of parent powershell'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) was generated for powershell.exe running with parameters that are typically used in post-exploitation payloads.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10698.png', 'ScreenshotCaption': 'wmi spawning powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell spawned from WMI event subscription (wmiprvse.exe).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10515.png', 'ScreenshotCaption': 'wmiprvse executing powershell'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "PowerShell Network Connection" was generated due to the SYSTEM level PowerShell spawned from wmiprvse.exe making a network connection.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11667.png', 'ScreenshotCaption': '20.A.3 - PowerShell Network Connection for the SYSTEM level PowerShell spawned from wmiprvse.exe (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11666.png', 'ScreenshotCaption': '20.A.3 - PowerShell Network Connection for the SYSTEM level PowerShell spawned from wmiprvse.exe (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for a SYSTEM-level PowerShell spawned from the WindowsParentalControlMigration WMI event subscription.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13054.png', 'ScreenshotCaption': 'MSSP - 20.A'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed SYSTEM-level PowerShell spawned from wmiprvse.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11668.png', 'ScreenshotCaption': '20.A.3 - Triage view of wmiprvse.exe spawning SYSTEM level PowerShell callbacks'}, {'ScreenshotName': 'FireEye-APT29-11670.png', 'ScreenshotCaption': '20.A.3 - Triage view of network connections made by those SYSTEM level callbacks'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (warning severity) was generated for a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3965.png', 'ScreenshotCaption': '20.A - wmiprvse.exe executing SYSTEM PowerShell stager'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red; high severity) called PowerShell was generated due to powershell executing a SYSTEM-level powershell.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3363.png', 'ScreenshotCaption': '2nd ps with SYSTEM user'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of PowerShell spawned from a WMI event subscription.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18022.png', 'ScreenshotCaption': 'new mssp 20A3'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed execution of SYSTEM level PowerShell.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3363.png', 'ScreenshotCaption': '2nd ps with SYSTEM user'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) was generated due to a suspicious PowerShell command.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2577.png', 'ScreenshotCaption': 'executing pshel stager (20a2)'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (yellow indicator) was generated by a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1916.png', 'ScreenshotCaption': '20.a.2 - wmiprvse launching ps'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a SYSTEM-level PowerShell spawning from wmiprvse.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1917.png', 'ScreenshotCaption': '20.a.2 - wmiprvse launching ps #2'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for PowerShell (medium severity) was generated due to a suspicious PowerShell command-line.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-547.png', 'ScreenshotCaption': 'General detection for Suspicious PowerShell commandline'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for execution was generated containing evidence a SYSTEM-level PowerShell process spawned and\nexecuted the malicious payload after wmiprvse.exe executed malicious staging\npayload.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1150.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Execution\nand Persistence (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1149.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Execution\nand Persistence (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wmiprvse.exe executing powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-547.png', 'ScreenshotCaption': 'General detection for Suspicious PowerShell commandline'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of powershell.exe executing another powershell.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-15752.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a SYSTEM-level PowerShell spawning from a svchost.exe associated with the WMI service.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13731.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "PowerShell" was generated due to a SYSTEM-level PowerShell spawning from wmiprvse.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-222.png', 'ScreenshotCaption': 'wmi spawning powershell with command line args and network connections'}], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a SYSTEM-level PowerShell spawning from wmiprvse.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7285.png', 'ScreenshotCaption': '20.a.3 (2 as well maybe) - full process tree, pid 4004'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "PowerShell" occurred containing evidence of WMI Provider Host spawning PowerShell.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12892.png', 'ScreenshotCaption': 'MSSP - WMI -> powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a SYSTEM-level powershell.exe spawning from wmiprvse.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-6992.png', 'ScreenshotCaption': 'A2/3 - Detailed wmiprvse.exe executing powershell stager'}, {'ScreenshotName': 'SentinelOne-APT29-6991.png', 'ScreenshotCaption': 'A3 - wmiprvse.exe Process tree overview of spawning processes'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "PowerShell" was generated due to wmiprvse.exe spawning powershell.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17733.png', 'ScreenshotCaption': '20A3 - technique'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General detection called "powershell.exe contains suspicious argument" was generated on a SYSTEM-level powershell.exe spawning from wmiprvse.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9859.png', 'ScreenshotCaption': 'Forensics Report with process tree of wmiprvse.exe resulting in powershell callback as SYSTEM'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called "PowerShell" was generated due to a SYSTEM-level PowerShell spawned from wmiprvse.exe.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17575.png', 'ScreenshotCaption': '3 - RCA -  greyDeteciton - wmi > PS'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for WMI event subscription executing a SYSTEM-level PowerShell instance. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12693.png', 'ScreenshotCaption': 'MSSP - 20A1 - 20B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed a SYSTEM-level powershell.exe spawning from wmiprvse.exe. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12206.png', 'ScreenshotCaption': 'a2/3 - wmi > PS - shows PS as system - telemetry'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4371.png', 'ScreenshotCaption': 'hidden powershell with unusual parent'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for a hidden PowerShell with an Unusual Parent.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4371.png', 'ScreenshotCaption': 'hidden powershell with unusual parent'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed powershell.exe spawning from wmiprvse.exe with SYSTEM-level integrity.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4375.png', 'ScreenshotCaption': 'sytsem integrity level'}], 'Footnotes': []}]}]}]}, {'Substep': '20.B.1', 'Procedure': 'Created Kerberos Golden Ticket using\xa0Invoke-Mimikatz', 'Criteria': 'powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket', 'Techniques': [{'TechniqueId': 'T1097', 'TechniqueName': 'Pass the Ticket', 'Tactics': [{'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for the use of a golden ticket. The detection was correlated to a parent alert for powershell.exe executing with suspicious large command line.', 'Modifiers': ['Alert', 'Configuration Change (Detections)', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1113.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-1111.png', 'ScreenshotCaption': ''}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a credential related module loaded by an unusual process. The detection was correlated to a parent alert for powershell.exe executing with suspicious large command line.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1112.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-1041.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.', 'Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into current session.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10745.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing the Invoke-Mimikatz command through PowerShell Command Logging.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called of "Pass the Ticket" was generated when the user MScott forged a suspicious Kerberos ticket with the domain krbtgt.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2495.png', 'ScreenshotCaption': 'Suspicious ticket forgery with enrichments'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated identifying PowerShell executing Invoke-Mimikatz as threat activity.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2496.png', 'ScreenshotCaption': 'Invoke-mimikatz with arguments and enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Pass the Ticket" was received that described the adversary using Mimikatz to forge a golden ticket.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12521.png', 'ScreenshotCaption': '20.A.1, 20.B.1 - MDR Report Day 2, summary and rundll32 execution of kxwn.lock'}, {'ScreenshotName': 'CyCraft-APT29-12523.png', 'ScreenshotCaption': '20.B.1 - MDR Report Day 2, pass the ticket, enter-pssession, account creation'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for attempted credential theft. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9840.png', 'ScreenshotCaption': '20.b.1 - malops for powershell and credential theft, command and control'}, {'ScreenshotName': 'Cybereason-APT29-13712.png', 'ScreenshotCaption': '20b1 - vendor pic - process tree with evidence'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) called "Win_Mimikatz_Empire_MITRET1003" was generated for PowerShell using Empire.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12178.png', 'ScreenshotCaption': 'Medium Alert for Mimikatz empire on mimikatz execution '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12322.png', 'ScreenshotCaption': 'B1 - SBL showing invoke-mimikatz execution'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) for "Credential Access via PowerShell Cmdlets"  was generated for PowerShell executing Invoke-Mimikatz.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1623.png', 'ScreenshotCaption': 'same as above with powershell enrichments'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (medium severity) was generated for a suspicious PowerShell command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10524.png', 'ScreenshotCaption': '1 - invoke mimikatax'}, {'ScreenshotName': 'F-Secure-APT29-10522.png', 'ScreenshotCaption': 'suspicious PS command'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of Mimikatz being used to execute a golden ticket attack impersonating mscott.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11323.png', 'ScreenshotCaption': 'MSSP - invoke mimikatz and toby useradd'}, {'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10534.png', 'ScreenshotCaption': 'golden ticket invoke mimi'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for a non-standard process loading the Windows credential management library vaultcli.dll.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11685.png', 'ScreenshotCaption': '20.B.1 - PowerShell loading vaultcli.dll (bottom)'}, {'ScreenshotName': 'FireEye-APT29-11684.png', 'ScreenshotCaption': '20.B.1 - PowerShell loading vaultcli.dll (top)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for Invoke-Mimikatz (kerberos::golden) to create and inject a golden ticket into the current session.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13055.png', 'ScreenshotCaption': 'MSSP - 20.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into current session.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11701.png', 'ScreenshotCaption': '20.B.1 - Script block for Mimikatz use of kerberos::golden to create a golden ticket'}], 'Footnotes': []}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for evidence of pass the ticket.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-12734.png', 'ScreenshotCaption': '20.b.1 MSSP alert #2'}, {'ScreenshotName': 'GoSecure-APT29-12735.png', 'ScreenshotCaption': '20.b.1 MSSP alert #3'}, {'ScreenshotName': 'GoSecure-APT29-12733.png', 'ScreenshotCaption': '20.b.1 MSSP alert #1'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (Critical severity) was generated for a suspicious process loading Mimikatz with PowerShell.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3973.png', 'ScreenshotCaption': '20.B.1 - Mimikatz Load with Powershell'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3977.png', 'ScreenshotCaption': '20.B.1 - Invoke-Mimikatz command line arguments'}], 'Footnotes': []}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of use of a suspicious Kerberos ticket.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-3414.png', 'ScreenshotCaption': 'successful logon of mscott on scranton & new york with event type 13'}, {'ScreenshotName': 'Kaspersky-APT29-3413.png', 'ScreenshotCaption': '20.b.1 - kerberos ticket age alert'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for Suspected Golden Ticket Usage was generated by Azure ATP due to mscott using a weaker encryption method (RC4) in the Kerberos service request.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-550.png', 'ScreenshotCaption': 'Technique detection for Suspected Golden Ticket usage'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection was generated containing evidence of powershell.exe executing Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-15752.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (critical severity) was generated for "Mimikatz Creating Golden Ticket."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7291.png', 'ScreenshotCaption': '20.b.1 - raw events from alert'}, {'ScreenshotName': 'SecureWorks-APT29-7290.png', 'ScreenshotCaption': '20.b.1 - technique mappings'}, {'ScreenshotName': 'SecureWorks-APT29-7288.png', 'ScreenshotCaption': '20.b.1 - Alert details mimikatz creating golden tickets'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-17657.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection for "TokenPrivAdd" under "Privilege Escalation/Defense Evation {T1134} " was generated when Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session was executed. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7011.png', 'ScreenshotCaption': 'B1 - Token Manipulation alert generated'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1097" occurred containing evidence of  Invoke-Mimikatz (kerberos::golden) usage along with Token Manipulation indicator.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12893.png', 'ScreenshotCaption': 'MSSP - Invoke + indicator'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed WinRM activity as MScott from Scranton (10.0.1.4) to Utica (10.0.1.5) with a Kerberos ticket in memory for MScott on Scranton (10.0.1.4). ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-17735.png', 'ScreenshotCaption': '20b1 - multiple telemetry bundled up'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for a golden ticket being created and used.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12693.png', 'ScreenshotCaption': 'MSSP - 20A1 - 20B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12217.png', 'ScreenshotCaption': '1/3 - scriptBlock raw text - command line args - mimikatz running'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a Credential Theft Application Running. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4386.png', 'ScreenshotCaption': 'mimikatz saved'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for PowerShell running Mimikatz.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4386.png', 'ScreenshotCaption': 'mimikatz saved'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12778.png', 'ScreenshotCaption': '20.a mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session. The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4391.png', 'ScreenshotCaption': 'invoke mimi'}, {'ScreenshotName': 'Carbon Black-APT29-4390.png', 'ScreenshotCaption': 'invoke mimi'}], 'Footnotes': []}]}]}]}, {'Substep': '20.B.2', 'Procedure': 'Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials', 'Criteria': 'Network connection to Scranton (10.0.1.4) over port 5985', 'Techniques': [{'TechniqueId': 'T1028', 'TechniqueName': 'Windows Remote Management', 'Tactics': [{'TacticName': 'Execution', 'TacticId': 'TA0002'}, {'TacticName': 'Lateral Movement', 'TacticId': 'TA0008'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for the opening of a WinRM connection. The alert showed an outbound network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1046.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Bitdefender-APT29-1045.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for the WSMProvHost process on the remote host Scranton (10.0.1.4), which is indicative of the execution of a remote PowerShell command.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1048.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called “Execution via Windows Remote Management” was generated for WinRM execution based on the WSMProvHost process on the remote host Scranton (10.0.1.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10753.png', 'ScreenshotCaption': ' A technique detection called “Execution via Windows Remote Management” for WinRM executing net.exe on Scranton.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called “GenericWinRMLateralMovement” was generated based on PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10746.png', 'ScreenshotCaption': 'A Technique detection called “GenericWinRMLateralMovement” for powershell.exe executing Enter-PSSession to Scranton, then invoking a command.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10751.png', 'ScreenshotCaption': 'activity app network connections from powershell'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': 'A General alert detection (blue indicator) was generated identifying PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4) as threat activity. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2498.png', 'ScreenshotCaption': 'enter-pssession with enrichments'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (orange indicator) for execution and tagged with "Windows Remote Management" was generated when net.exe was executed remotely on Scranton by wsmprovhost.exe.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2500.png', 'ScreenshotCaption': 'net.exe with parent process of wsmprovhost.exe and enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Windows Remote Management" was received that described the adversary using a golden ticket to establish a WinRM session to Scranton (10.0.1.4)', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12521.png', 'ScreenshotCaption': '20.A.1, 20.B.1 - MDR Report Day 2, summary and rundll32 execution of kxwn.lock'}, {'ScreenshotName': 'CyCraft-APT29-12523.png', 'ScreenshotCaption': '20.B.1 - MDR Report Day 2, pass the ticket, enter-pssession, account creation'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the malicious use of powershell.exe.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9846.png', 'ScreenshotCaption': '20.b.2 process tree with the connection details over port 5985'}, {'ScreenshotName': 'Cybereason-APT29-9845.png', 'ScreenshotCaption': '20.b.2 - connection details contin'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Win_WinRM_Invoke-Command_MitreT1028" was generated when PowerShell executed a command on the remote host Scranton (10.0.1.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12182.png', 'ScreenshotCaption': 'B3 - Medium alert for WinRM Invoke-Command with SBL showing addition of toby'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell execution of Enter-PSSession and the corresponding powershell.exe network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12333.png', 'ScreenshotCaption': 'B2 - connection to 10.0.1.4 over port 5985'}, {'ScreenshotName': 'Cylance-APT29-12323.png', 'ScreenshotCaption': 'B2 -  SBL showing Enter-PSsession execution'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) for "WMI Lateral Movement via PowerShell over WinRM" was generated for PowerShell executing on a remote host over WinRM. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1624.png', 'ScreenshotCaption': 'wmi lateral movement via powershell over winrm, with connection over 5985'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-15096.png', 'ScreenshotCaption': '20b2 - telemetry '}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (informational severity) was generated for PowerShell using Windows Remote Management. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10699.png', 'ScreenshotCaption': '2 / 3 '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell execution of Enter-PSSession and the corresponding powershell.exe network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10550.png', 'ScreenshotCaption': 'enter-pssesion'}, {'ScreenshotName': 'F-Secure-APT29-10544.png', 'ScreenshotCaption': '2 - ip and port'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "WinRM Network Connection" was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11688.png', 'ScreenshotCaption': '20.B.2 - WinRM Network Connection for the WinRM connection to Scranton (10.0.1.4) over port 5985'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection was generated for PowerShell making a URL request when the WinRM connection was made to Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11687.png', 'ScreenshotCaption': '20.B.2 - PowerShell URL Request for the WinRM connection'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the WinRM session to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13057.png', 'ScreenshotCaption': 'MSSP - 20.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "Windows Remote Management"  was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.\n', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11550.png', 'ScreenshotCaption': 'winrm traffic with intelligence tags, coming off of the 20a powershell. also shows commonly used port intelligence and impact score of 90'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (orange indicator) called "Powershell: established network connections" was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11550.png', 'ScreenshotCaption': 'winrm traffic with intelligence tags, coming off of the 20a powershell. also shows commonly used port intelligence and impact score of 90'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11550.png', 'ScreenshotCaption': 'winrm traffic with intelligence tags, coming off of the 20a powershell. also shows commonly used port intelligence and impact score of 90'}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (Reminder severity) called "WinRM via common port" was generated due to WinRM being used to access the remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3982.png', 'ScreenshotCaption': '20.B.2 - port 5985 in WinRM alert'}, {'ScreenshotName': 'HanSight-APT29-3980.png', 'ScreenshotCaption': '20.B.2 - WinRM via common port alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-12428.png', 'ScreenshotCaption': '20.b.2-3 MSSP report #1'}, {'ScreenshotName': 'Kaspersky-APT29-12429.png', 'ScreenshotCaption': '20.b.2-3 MSSP report #2'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "Windows Remote Management" was generated for a "PowerShell script doing Windows Remote Management (WinRM) activity."', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1921.png', 'ScreenshotCaption': '20.b.2 - winRM alert'}, {'ScreenshotName': 'McAfee-APT29-1925.png', 'ScreenshotCaption': '20.b.2 - net connect to 10.0.1.4:5985'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1925.png', 'ScreenshotCaption': '20.b.2 - net connect to 10.0.1.4:5985'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Lateral Movement was generated containing evidence a new PowerShell session was initiated from host Utica (10.0.1.5) to Scranton (10.0.1.4) and a session was created under the local administrator account (RID 500).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1151.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Lateral Movement and Persistence (1 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1152.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Lateral Movement and Persistence (2 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-551.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe establishing a connection to remote host Scranton (10.0.1.4) over TCP port 5985'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13261.png', 'ScreenshotCaption': '20.B.2, 20.B.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. Telemetry also showed the WinRM process on Scranton (10.0.1.4) exchanging data with Utica (10.0.1.5).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13732.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Palo Alto Networks-APT29-3351.png', 'ScreenshotCaption': 'Telemetry showing powershell initiating a network connection to remote host Scranton (10.0.1.4) over port 5985'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the Enter-PSSession cmdlet and the subsequent network connection to the remote host Scranton (10.0.1.4).', 'Modifiers': ['Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-341.png', 'ScreenshotCaption': 'cc - enter-pssession scranton'}, {'ScreenshotName': 'ReaQta-APT29-226.png', 'ScreenshotCaption': 'network connection '}], 'Footnotes': ['PowerShell script block logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Windows Remote Management" occurred containing evidence of PowerShell using Enter-PSSession to create WinRM session.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-12672.png', 'ScreenshotCaption': 'MSSP - SW - 20B2 - overview and details'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell execution of Enter-PSSession and the correpsonding powershell.exe network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7312.png', 'ScreenshotCaption': '20.b.2 - event details, network connection 5985'}, {'ScreenshotName': 'SecureWorks-APT29-7298.png', 'ScreenshotCaption': '20.b.2 - enter pssession, script block '}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1028" occurred containing evidence of Enter-PSSession to create WinRM session to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12894.png', 'ScreenshotCaption': 'MSSP - PS-session + user add'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent grouping of malicious activity.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7016.png', 'ScreenshotCaption': 'B2 - Powershell connecting to Scranton over port 5985 via wsman protocol'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'None', 'DetectionNote': 'No detection capability demonstrated for this procedure.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Identified Usage of Windows Remote Management" was generated due to the WinRM session to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17578.png', 'ScreenshotCaption': '2 - RCA - greyDetection details'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (low severity) called "Windows Remote Management" was generated for PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12213.png', 'ScreenshotCaption': '2 - DDI - technique network view'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for a golden ticket being used to establish a WinRM connection to host Scranton (10.0.0.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12693.png', 'ScreenshotCaption': 'MSSP - 20A1 - 20B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) called "Powershell or WinRM remoting activity" was generated for a powershell WinRM session on the remote host Scranton (10.0.1.4).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4387.png', 'ScreenshotCaption': 'winrm alert on scranton'}], 'Footnotes': []}, {'DetectionType': 'Tactic', 'DetectionNote': 'A Tactic alert detection (red indicator) called for remote PowerShell activity was generated for a PowerShell WinRM session. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4387.png', 'ScreenshotCaption': 'winrm alert on scranton'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell create a WinRM session to remote host Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12778.png', 'ScreenshotCaption': '20.a mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4). The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4393.png', 'ScreenshotCaption': 'pssession with connection'}, {'ScreenshotName': 'Carbon Black-APT29-4392.png', 'ScreenshotCaption': 'enter ps session scarnt'}], 'Footnotes': []}]}]}]}, {'Substep': '20.B.3', 'Procedure': 'Added a new user to the remote host Scranton (10.0.1.4) using net.exe', 'Criteria': 'net.exe adding the user Toby ', 'Techniques': [{'TechniqueId': 'T1136', 'TechniqueName': 'Create Account', 'Tactics': [{'TacticName': 'Persistence', 'TacticId': 'TA0003'}], 'Vendors': [{'VendorName': 'Bitdefender', 'DisplayName': 'Bitdefender', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection was generated for local account creation using net.exe. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1050.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert was generated for the net.exe process being used to create a new user. ', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1051.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Bitdefender-APT29-1049.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}, {'VendorName': 'CrowdStrike', 'DisplayName': 'CrowdStrike', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (purple hexagon) called “Create Account” was generated for the addition of the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10748.png', 'ScreenshotCaption': 'A Technique detection called “Create Account” for a user creating a new user account. A Technique detection called “Create Account” for WinRM executing a file to create an account.'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection called “GenericCreateAccountPersistence” was generated for the addition of the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10747.png', 'ScreenshotCaption': 'A Technique detection called “GenericCreateAccountPersistence” for account creation of Toby on Scranton via Invoke-Command.'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'CrowdStrike-APT29-10752.png', 'ScreenshotCaption': 'Telemetry showing powershell.exe executing net.exe to add a user.'}], 'Footnotes': []}]}, {'VendorName': 'CyCraft', 'DisplayName': 'CyCraft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) for "Account Operation" was generated for the addition of the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2500.png', 'ScreenshotCaption': 'net.exe with parent process of wsmprovhost.exe and enrichments'}, {'ScreenshotName': 'CyCraft-APT29-2501.png', 'ScreenshotCaption': 'New account creation with enrichments'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) for "Create Account" was generated for net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for creation of a Windows Remote Management session.', 'Modifiers': ['Alert', 'Correlated'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-2500.png', 'ScreenshotCaption': 'net.exe with parent process of wsmprovhost.exe and enrichments'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "Create Account" was received that described the attacker creating a new account on host Scranton (10.0.1.4) for persistence.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'CyCraft-APT29-12523.png', 'ScreenshotCaption': '20.B.1 - MDR Report Day 2, pass the ticket, enter-pssession, account creation'}], 'Footnotes': []}]}, {'VendorName': 'Cybereason', 'DisplayName': 'Cybereason', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "net.exe is used to create a user or add a user to a group" was generated for net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Correlated', 'Alert'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9849.png', 'ScreenshotCaption': '20.b.3 - commandline with new user created by net.exe'}, {'ScreenshotName': 'Cybereason-APT29-9848.png', 'ScreenshotCaption': '20.b.3 - evidence from net.exe '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for the malicious use of powershell.exe. ', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Cybereason-APT29-9849.png', 'ScreenshotCaption': '20.b.3 - commandline with new user created by net.exe'}], 'Footnotes': []}]}, {'VendorName': 'Cylance', 'DisplayName': 'BlackBerry Cylance', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) called "Win_CreateAccount_Mitre1136" was generated for the addition of the new user Toby based on Windows Event ID 4720.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12183.png', 'ScreenshotCaption': 'B3 - High alert for CreateAccount from lsass'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell command to add the new User Toby to the remote host Scranton (10.0.1.4).', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Cylance-APT29-12182.png', 'ScreenshotCaption': 'B3 - Medium alert for WinRM Invoke-Command with SBL showing addition of toby'}], 'Footnotes': []}]}, {'VendorName': 'Elastic', 'DisplayName': 'Elastic', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "User Account Creation" was generated for the addition of the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1625.png', 'ScreenshotCaption': 'user account creation alert with command line'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Elastic-APT29-1625.png', 'ScreenshotCaption': 'user account creation alert with command line'}], 'Footnotes': []}]}, {'VendorName': 'F-Secure', 'DisplayName': 'F-Secure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (high severity) for net_user_add was generated due to net.exe being used to add a user account.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10530.png', 'ScreenshotCaption': '3 - net exe detection with toby cmd line args'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of new user "Toby" being created with net.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-11323.png', 'ScreenshotCaption': 'MSSP - invoke mimikatz and toby useradd'}, {'ScreenshotName': 'F-Secure-APT29-11303.png', 'ScreenshotCaption': 'MSSP - day2 executive summary - pt2'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the user Toby being created on the scranton host. ', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'F-Secure-APT29-10541.png', 'ScreenshotCaption': 'user create'}], 'Footnotes': []}]}, {'VendorName': 'FireEye', 'DisplayName': 'FireEye', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "Net User Add" was generated for net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11694.png', 'ScreenshotCaption': '20.B.3 - Net User Add for net user add with password redacted'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection called WinRM process activity was generated for for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-11693.png', 'ScreenshotCaption': '20.B.3 - WinRM Process Activity for net user add with password redacted'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for the creation of the user Toby on Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'FireEye-APT29-13057.png', 'ScreenshotCaption': 'MSSP - 20.B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'GoSecure', 'DisplayName': 'GoSecure', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (orange indicator) called "Create Account (Net Use Command)" was generated for net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11551.png', 'ScreenshotCaption': 'net.exe command with the toby user add. impact of 75, tagged with create account, remote system discovery. impact score high due to net  being used to add user.  '}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'GoSecure-APT29-11551.png', 'ScreenshotCaption': 'net.exe command with the toby user add. impact of 75, tagged with create account, remote system discovery. impact score high due to net  being used to add user.  '}], 'Footnotes': []}]}, {'VendorName': 'HanSight', 'DisplayName': 'HanSight', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "Create Account" was generated for net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3995.png', 'ScreenshotCaption': '20.B.3 - Create Account alert'}], 'Footnotes': []}, {'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (warning severity) called "New User Account Creation via Snapshot" was generated due to comparison of existing user accounts between snapshots taken of system account information.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3992.png', 'ScreenshotCaption': '20.B.3 - New User Account Creation via Snapshot'}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (warning severity) was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'HanSight-APT29-3987.png', 'ScreenshotCaption': '20.B.3 - wsmprovhost.exe creating the net.exe process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Kaspersky', 'DisplayName': 'Kaspersky', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Kaspersky-APT29-18023.png', 'ScreenshotCaption': 'new mssp 20b3'}], 'Footnotes': []}]}, {'VendorName': 'Malwarebytes', 'DisplayName': 'Malwarebytes', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection for account creation was generated for net.exe executing with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert', 'Configuration Change (Detections)'], 'Screenshots': [{'ScreenshotName': 'MalwareBytes-APT29-2581.png', 'ScreenshotCaption': 'Account creation'}], 'Footnotes': ['Updates to detections and logging were enabled after the start of the evaluation, so it is identified as a Detection Configuration Change.']}]}, {'VendorName': 'McAfee', 'DisplayName': 'McAfee', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (yellow indicator) called "Create Account" was generated for the addition of the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1923.png', 'ScreenshotCaption': 'account creation on Scranton 20.b.3?'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed addition of the new user Toby based on Windows Event ID 4720.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'McAfee-APT29-1924.png', 'ScreenshotCaption': '20.b.3 - toby account created by mscott on scranton'}, {'ScreenshotName': 'McAfee-APT29-1923.png', 'ScreenshotCaption': 'account creation on Scranton 20.b.3?'}], 'Footnotes': []}]}, {'VendorName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for Lateral Movement was generated containing evidence a new user was created on Scranton with name \'toby\'."', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-1152.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Lateral Movement and Persistence (2 of 2)'}, {'ScreenshotName': 'Microsoft-APT29-1151.png', 'ScreenshotCaption': 'MSSP - Yttrium High Active Alert related to Lateral Movement and Persistence (1 of 2)'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed addition of the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Microsoft-APT29-553.png', 'ScreenshotCaption': 'Telemetry showing user Toby added.'}], 'Footnotes': []}]}, {'VendorName': 'PaloAltoNetworks', 'DisplayName': 'Palo Alto Networks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection called "created account T1136" (high severity) was generated for net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3348.png', 'ScreenshotCaption': 'Technique detection showing "created account" alert. (1/2)'}, {'ScreenshotName': 'Palo Alto Networks-APT29-3349.png', 'ScreenshotCaption': 'Technique detection showing "created account" alert. (2/2)'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4).', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-13261.png', 'ScreenshotCaption': '20.B.2, 20.B.3 - MSSP'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Palo Alto Networks-APT29-3350.png', 'ScreenshotCaption': 'General detection showing wsmprovhost.exe spawned net.exe with command line arguments.'}], 'Footnotes': []}]}, {'VendorName': 'ReaQta', 'DisplayName': 'ReaQta', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (blue indicator) called "Create Account" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'ReaQta-APT29-224.png', 'ScreenshotCaption': 'net.exe user add creation; see create account technique'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [], 'Footnotes': ['Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view.']}]}, {'VendorName': 'Secureworks', 'DisplayName': 'Secureworks', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (info severity) was generated for an account creation.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-13795.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'SecureWorks-APT29-13796.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (low severity) called "Suspicious WinRM Remote PowerShell Net Process" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7303.png', 'ScreenshotCaption': '20.b.3 - Technique mappings - powershell, create account, etc.'}, {'ScreenshotName': 'SecureWorks-APT29-7302.png', 'ScreenshotCaption': '20.b.3 - Alert details, suspicious winrm remote powershell net process'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed addition of the new user Toby based on Windows Event ID 4720.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SecureWorks-APT29-7308.png', 'ScreenshotCaption': '20.b.3 - raw events login my mscott'}], 'Footnotes': []}]}, {'VendorName': 'SentinelOne', 'DisplayName': 'SentinelOne', 'Detections': [{'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection for "T1136" occurred containing evidence of Invoke-Command with command-line arguments adding the user Toby.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-12894.png', 'ScreenshotCaption': 'MSSP - PS-session + user add'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net1.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'SentinelOne-APT29-7041.png', 'ScreenshotCaption': 'B3 - net1.exe creating user toby'}], 'Footnotes': []}]}, {'VendorName': 'Symantec', 'DisplayName': 'Symantec', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique detection for "Create Account" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9862.png', 'ScreenshotCaption': 'wsmprovhost.exe executed net.exe on scranton to add user toby'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'Symantec-APT29-9862.png', 'ScreenshotCaption': 'wsmprovhost.exe executed net.exe on scranton to add user toby'}], 'Footnotes': []}]}, {'VendorName': 'TrendMicro', 'DisplayName': 'Trend Micro', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (medium severity) called "Create Account" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17580.png', 'ScreenshotCaption': '3 - create account alert - RCA view'}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred for a new user Toby being created. ', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-12693.png', 'ScreenshotCaption': 'MSSP - 20A1 - 20B'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.', 'Modifiers': [], 'Screenshots': [{'ScreenshotName': 'TrendMicro-APT29-17582.png', 'ScreenshotCaption': '20.B.3 - net.exe user add for toby'}], 'Footnotes': []}]}, {'VendorName': 'VMware', 'DisplayName': 'VMware Carbon Black', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': 'A Technique alert detection (red indicator) was generated for the creation of a local user with Net.', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13965.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-13966.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'General', 'DetectionNote': 'A General alert detection (red indicator) was generated for a process spawned from PowerShell remoting (WinRM).', 'Modifiers': ['Alert'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-13965.png', 'ScreenshotCaption': ''}], 'Footnotes': []}, {'DetectionType': 'MSSP', 'DetectionNote': 'An MSSP detection occurred containing evidence of PowerShell adding new user to the remote host Scranton (10.0.1.4) using net.exe.', 'Modifiers': ['Delayed (Manual)'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-12778.png', 'ScreenshotCaption': '20.a mssp alert'}], 'Footnotes': []}, {'DetectionType': 'Telemetry', 'DetectionNote': 'Telemetry showed the PowerShell command to add the new User Toby to the remote host Scranton (10.0.1.4). Telemetry also subsequently showed wsmprovhost.exe spawning net.exe with the command-line arguments. The detection was correlated to a parent alert for Windows Management Instrumentation.', 'Modifiers': ['Correlated'], 'Screenshots': [{'ScreenshotName': 'Carbon Black-APT29-4388.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4396.png', 'ScreenshotCaption': ''}, {'ScreenshotName': 'Carbon Black-APT29-4395.png', 'ScreenshotCaption': ''}], 'Footnotes': []}]}]}]}]}
    };

    var current_round = "APT29";
    var selected_round;
    var all_vendors_in_round = [];
    var all_vendors_in_round_lwr = [];
    var vendor_display_names = [];
    var vendor1_selected = false;
    var vendor2_selected = false;
    var global_vendor1 = {};
    var global_vendor2 = {};
    var detection_row_uid = 0;      // All detections rows are unique
    var original_query_string_options = {};
    var load_from_query_string = false;
    var card_open_status = false;

    document.onload = load_initial();

    function load_initial() {
        var round_info = {'APT3': 'Active', 'APT29': 'Active', 'CarbanakFIN7': 'Pending'};

        set_original_query_string_options();

        load_rounds_dropdown(round_info);

        if (selected_round == 'APT3' || selected_round == 'APT29') {
            load_round(selected_round);
        }
        else {
            selected_round = current_round;
            load_round(current_round);
        }
    }

    window.addEventListener('popstate', function (event) {
        window.location = window.location.href;
    });

    function set_original_query_string_options () {
        var url_string = window.location.href;
        var url_obj = new URL(url_string);

        selected_round = url_obj.searchParams.get("round");
        if (selected_round != undefined ) selected_round = selected_round.toUpperCase();
        
        if (url_obj.searchParams.get("vendors")) {
            var vendors = url_obj.searchParams.get("vendors").split(",");
            original_query_string_options["vendor1"] = vendors[0];
            original_query_string_options["vendor2"] = vendors[1];
            load_from_query_string = true;
        }

        if (url_obj.searchParams.get("steps")) {
            original_query_string_options["steps"] = url_obj.searchParams.get("steps");
            load_from_query_string = true;
        }

        if (url_obj.searchParams.get("tactic")) {
            original_query_string_options["tactic"] = url_obj.searchParams.get("tactic");
            load_from_query_string = true;
        }

        if (url_obj.searchParams.get("cards_open")) {
            original_query_string_options["cards_open"] = url_obj.searchParams.get("cards_open");
            load_from_query_string = true;
        }
    }

    function load_rounds_dropdown(round_info) {
        var dropdown = document.getElementById("round_dropdown");
        for (const [round, status] of Object.entries(round_info)) {
            if (status == "Active") {
                var dropitem = document.createElement("a");
                dropitem.appendChild(document.createTextNode(round));
                dropitem.setAttribute("id", round);
                dropitem.setAttribute("class", "dropdown-item");
                dropitem.setAttribute("style", "color: white");
                dropitem.setAttribute("href", "javascript:void(0);");
                dropitem.setAttribute("onclick", "new_round_selected(this.id);");
                dropdown.appendChild(dropitem);                
            }
        }
    }    

    function load_round(round) {
        var vendors_str;
        var vendors;
        var step_to_load;
        var tactics_in_round = [];

        // Set the dropdown button text to the URL Specified round
        btnSelectRound = document.getElementById("btnSelectRound");
        btnSelectRound.innerHTML = "Round: " + round;

        // Load the dropdown options for vendor select with the vendors from that round
        load_vendor_select_dropdowns(round);

        // Load the substep, techniques, procedure, and criteria for the round
        var steps = json_data[round].Steps;
        var div_main = document.getElementById("diff_div_main");

        // Clear the contents of the div to prepare for new round's data.
        div_main.innerHTML = "";

        for (step of steps) {
            let current_substep = step.Substep;
            let current_procedure = step.Procedure;
            let current_criteria = step.Criteria;
            let technique_id = step.Techniques[0].TechniqueId;
            let technique_name = step.Techniques[0].TechniqueName;
            // let step_tid = (current_substep + "_" + technique_id).replaceAll(".", "_");
            let step_tid = custom_replaceAll((current_substep + "_" + technique_id), ".", "_");
            let tactics = step.Techniques[0].Tactics;
            let tactic_ids = "";

            for (tactic_obj of tactics) {
                tactics_in_round.push(tactic_obj);
                tactic_ids += tactic_obj.TacticId + " ";
            }

            // Create a card for each step_tid
            var step_tid_card = document.createElement("div");
            step_tid_card.setAttribute("class", "diff_div_step_tid_card");
            step_tid_card.setAttribute("id", "div_" + step_tid);
            step_tid_card.setAttribute("data-match_status", "match");
            step_tid_card.setAttribute("data-tactic_ids", tactic_ids);

            // Create collapse/expand card for procedure/criteria and diff details
            var div_collapse_card = document.createElement("div");
            div_collapse_card.setAttribute("class", "card w-100");
            div_collapse_card.setAttribute("style", "border: none;");
            var div_collapse_header = document.createElement("div");
            // div_collapse_header.setAttribute("class", "card-header collapsed hoverpointer");
            div_collapse_header.setAttribute("class", "card-header collapsed hoverpointer card-header-text");
            div_collapse_header.setAttribute("id", "div_collapse_header_" + step_tid);
            // div_collapse_header.setAttribute("style", "background-color: white; border: none;");
            div_collapse_header.setAttribute("data-toggle", "collapse");
            div_collapse_header.setAttribute("data-target", "#div_collapse_body_" + step_tid);
            div_collapse_header.setAttribute("aria-expanded", "false");
            div_collapse_header.setAttribute("aria-controls", "div_collapse_body_" + step_tid);
            div_collapse_header.setAttribute("onclick", "check_expand_status(this);");


            // Create step title for header
            var substep_label = document.createElement("h5");
            substep_label.setAttribute("class", "diff_substep_label");
            substep_label.appendChild(document.createTextNode(current_substep));
            div_collapse_header.appendChild(substep_label);

            // Create Technique/TID label for header
            var technique_tid_label = document.createElement("h5");
            technique_tid_label.setAttribute("style", "display: inline-block; margin-left: 40px; margin-bottom: 0;");
            technique_tid_label.appendChild(document.createTextNode(technique_name + " (" + technique_id + ")"));
            div_collapse_header.appendChild(technique_tid_label);

            var div_collapse_body = document.createElement("div");
            div_collapse_body.setAttribute("id", "div_collapse_body_" + step_tid);
            div_collapse_body.setAttribute("class", "collapse");
            div_collapse_body.setAttribute("aria-labelledby", "div_collapse_header_" + step_tid);
            div_collapse_body.setAttribute("style", "border-top: 1px solid rgba(0,0,0,.1);");

            div_collapse_card.appendChild(div_collapse_header);
            div_collapse_card.appendChild(div_collapse_body);
            step_tid_card.appendChild(div_collapse_card);
            
            // Create table for aligning procedure/criteria with diff table
            var table_proc_crit = document.createElement("table");
            var tr_proc = document.createElement("tr");
            var td_diff_placeholder1 = document.createElement("td");
            var td_proc = document.createElement("td");
            var tr_crit = document.createElement("tr");
            var td_diff_placeholder2 = document.createElement("td");
            var td_crit = document.createElement("td");
            
            table_proc_crit.setAttribute("class", "diff_step_tid_table");
            table_proc_crit.setAttribute("style", "margin-bottom: 0px;");
            tr_proc.setAttribute("class", "tr_diff_row");
            tr_crit.setAttribute("class", "tr_diff_row");
            td_diff_placeholder1.setAttribute("class", "td_diff_cell");
            td_diff_placeholder2.setAttribute("class", "td_diff_cell");
            td_diff_placeholder1.setAttribute("style", "visibility: hidden; font-size: 12px;");
            td_diff_placeholder2.setAttribute("style", "visibility: hidden; font-size: 12px;");
            td_diff_placeholder1.appendChild(document.createTextNode("="));
            td_diff_placeholder2.appendChild(document.createTextNode("="));
            td_proc.setAttribute("class", "td_diff_proc_crit");
            td_crit.setAttribute("class", "td_diff_proc_crit");

            // Create Procedure Label
            var procedure_h6 = document.createElement("h6");
            procedure_h6.innerText = "Procedure: " + current_procedure;
            var procedure_label = document.createElement("span");
            procedure_label.appendChild(procedure_h6);
            procedure_label.setAttribute("class", "span_proc_crit_title");

            td_proc.appendChild(procedure_label);
            tr_proc.appendChild(td_diff_placeholder1);
            tr_proc.appendChild(td_proc);
            table_proc_crit.appendChild(tr_proc);

            // Create Criteria Label
            if (selected_round != "APT3") {
                var criteria_h6 = document.createElement("h6");
                criteria_h6.innerText = "Criteria: " + current_criteria;
                var criteria_label = document.createElement("span");
                criteria_label.appendChild(criteria_h6);
                criteria_label.setAttribute("class", "span_proc_crit_title");
                criteria_label.setAttribute("style", "margin-right:42px;");
                
                td_crit.appendChild(criteria_label);
                tr_crit.appendChild(td_diff_placeholder2);
                tr_crit.appendChild(td_crit);
                table_proc_crit.appendChild(tr_crit);
            }
            div_collapse_body.appendChild(table_proc_crit);
            div_main.appendChild(step_tid_card);
        }

        load_tactics_filter_options(tactics_in_round);

        // If there's a query string, load the parameters
        if (load_from_query_string) {
            if (original_query_string_options["cards_open"]) {
                card_open_status = original_query_string_options["cards_open"]
                if (original_query_string_options["cards_open"] == "true") {
                    open_all_cards(false);
                } else {
                    close_all_cards(false);
                }
            }

            if (original_query_string_options["steps"]) {
                var match_filter = document.getElementById("diff_match_filter");
                
                for (var i = 0;  i < match_filter.children.length; i++) {
                    if (match_filter.children[i].value == original_query_string_options["steps"]) {
                        match_filter.selectedIndex = i;
                    }
                }
            }

            if (original_query_string_options["tactic"]) {
                var tactic_filter = document.getElementById("diff_tactic_filter");

                for (var i = 0;  i < tactic_filter.children.length; i++) {
                    if (tactic_filter.children[i].value == original_query_string_options["tactic"]) {
                        tactic_filter.selectedIndex = i;
                    }
                }
            }

            // This is called after vendor_selected already
            // applyFilters();

            if (original_query_string_options["vendor1"] && original_query_string_options["vendor2"]) {

                // Set the vendor select dropdowns
                var v1_select = document.getElementById("diff_vendor1_select");
                var v2_select = document.getElementById("diff_vendor2_select");

                for (var i = 0; i < v1_select.children.length; i++) {
                    if (v1_select.children[i].getAttribute("data-vendorname") == original_query_string_options["vendor1"]) {
                        v1_select.selectedIndex = i;
                        vendor_selected(v1_select.children[i], true);
                        break;
                    }
                }

                for (var i = 0; i < v2_select.children.length; i++) {
                    if (v2_select.children[i].getAttribute("data-vendorname") == original_query_string_options["vendor2"]) {
                        v2_select.selectedIndex = i;
                        last_selected_option = v2_select.children[i];
                        vendor_selected(v2_select.children[i], true);
                        break;
                    }
                }
            }

            load_from_query_string = false;
        }
    }

    function new_round_selected(round) {
        // Reset to allow reloading of vendors that participated in the new round (for dropdowns)
        all_vendors_in_round = [];
        all_vendors_in_round_lwr = [];
        vendor_display_names = [];

        vendor1_selected = false;
        vendor2_selected = false;
        global_vendor1 = {};
        global_vendor2 = {};

        // Reset filters
        document.getElementById("diff_match_filter").selectedIndex = 0;
        document.getElementById("diff_tactic_filter").selectedIndex = 0;

        // Disable Match filter until two vendors are selected
        document.getElementById("diff_match_filter").disabled = true;

        selected_round = round;

        update_url(true);

        load_round(selected_round, null);
    }

    function load_vendor_select_dropdowns(round) {
        var v1_select = document.getElementById("diff_vendor1_select");
        var v2_select = document.getElementById("diff_vendor2_select");
        var vendors_from_round = json_data[round].Steps[0].Techniques[0].Vendors;

        v1_select.setAttribute("onchange", "if (this.selectedOptions) vendor_selected(this.selectedOptions[0], false);");
        v2_select.setAttribute("onchange", "if (this.selectedOptions) vendor_selected(this.selectedOptions[0], false);");

        // Always clear the selects before loading new options
        v1_select.innerHTML = "";
        v2_select.innerHTML = "";

        // Add a default option to both selects
        default_option1 = document.createElement("option");
        default_option1.appendChild(document.createTextNode("Select Vendor"));
        default_option1.setAttribute("class", "default_option");

        default_option2 = document.createElement("option");
        default_option2.appendChild(document.createTextNode("Select Vendor"));
        default_option2.setAttribute("class", "default_option");

        v1_select.appendChild(default_option1);
        v2_select.appendChild(default_option2);

        for (let vendor of vendors_from_round) { 
            // Populate the vendors in the round (in case used elsewhere)
            all_vendors_in_round.push(vendor.VendorName);
            vendor_display_names.push(vendor.DisplayName)
            all_vendors_in_round_lwr.push(vendor.VendorName.toLowerCase());

            // Create an option for vendor 1
            let v1_option_item = document.createElement("option");
            v1_option_item.setAttribute("data-vendorName", vendor.VendorName);
            v1_option_item.setAttribute("data-displayName", vendor.DisplayName);
            v1_option_item.setAttribute("data-vendorTable", "v1")
            v1_option_item.value = vendor.VendorName;
            v1_option_item.appendChild(document.createTextNode(vendor.DisplayName));

            // Create an option for vendor 2, greyed out if url obj is selected already
            let v2_option_item = document.createElement("option");
            v2_option_item.setAttribute("data-vendorName", vendor.VendorName);
            v2_option_item.setAttribute("data-displayName", vendor.DisplayName);
            v2_option_item.setAttribute("data-vendorTable", "v2")
            v2_option_item.value = vendor.VendorName;
            v2_option_item.appendChild(document.createTextNode(vendor.DisplayName));

            v1_select.appendChild(v1_option_item);
            v2_select.appendChild(v2_option_item);
        }
    }

    function vendor_selected(vendor_item, loaded_from_url) {
        var column_uid = vendor_item.parentNode.getAttribute("data-column_uid");
        var vendorName = vendor_item.getAttribute("data-vendorName");
        var displayName = vendor_item.getAttribute("data-displayName");
        // var query_string = window.location.href;

        if (column_uid == 1) {
            global_vendor1 = {"vendorName": vendorName, "displayName": displayName};
        }
        else if (column_uid == 2) {
            global_vendor2 = {"vendorName": vendorName, "displayName": displayName};
        }

        // Remove "Select Vendor" option from the dropdown
        var default_option = vendor_item.parentNode.getElementsByClassName("default_option")[0];
        if (default_option) {
            vendor_item.parentNode.removeChild(default_option);
        }

        if (Object.keys(global_vendor1).length > 0 && Object.keys(global_vendor2).length > 0) {
            // Enable match filter
            document.getElementById("diff_match_filter").disabled = false;

            for (step of json_data[selected_round].Steps) {
                // var detection_counter = 0;
                var substep = step.Substep;
                var tid = step.Techniques[0].TechniqueId;
                // var step_tid = (step.Substep + "_" + tid).replaceAll(".", "_");
                var step_tid = custom_replaceAll((step.Substep + "_" + tid), ".", "_");
                var div_step_tid = document.getElementById("div_" + step_tid);
                
                var div_collapse_body = document.getElementById("div_collapse_body_" + step_tid);
                var diff_table = document.getElementById("diff_table_" + step_tid);
                var horizontal_rule = div_collapse_body.querySelector("#card_hr")

                // If the diff table doesn't exist, create it and fill it. If it does exist, remove it and replace it with a new table.
                if (diff_table) {
                    diff_table.parentNode.removeChild(diff_table);
                }

                diff_table = document.createElement("table");
                diff_table.setAttribute("class", "diff_step_tid_table");
                diff_table.setAttribute("id", "diff_table_" + step_tid);

                var diff_table_header = document.createElement("thead");
                var tr_diff_header_row = document.createElement("tr");
                // var diff_table_th_diff = document.createElement("th");
                var diff_table_th_vendor1 = document.createElement("th");
                var diff_table_th_vendor2 = document.createElement("th");
                var vendor1_h5 = document.createElement("h5");
                var vendor2_h5 = document.createElement("h5");
                var diff_table_body = document.createElement("tbody");

                tr_diff_header_row.setAttribute("class", "tr_diff_row");
                // diff_table_th_diff.setAttribute("class", "th_diff_cell");
                diff_table_th_vendor1.setAttribute("class", "th_v1_detection_cell");
                diff_table_th_vendor2.setAttribute("class", "th_v2_detection_cell");

                vendor1_h5.setAttribute("class", "sub-h5")
                vendor2_h5.setAttribute("class", "sub-h5")
                vendor1_h5.innerText = global_vendor1.displayName;
                vendor2_h5.innerText = global_vendor2.displayName;

                diff_table_th_vendor1.appendChild(vendor1_h5);
                diff_table_th_vendor2.appendChild(vendor2_h5);
                
                // tr_diff_header_row.appendChild(diff_table_th_diff);
                tr_diff_header_row.appendChild(diff_table_th_vendor1);
                tr_diff_header_row.appendChild(diff_table_th_vendor2);

                diff_table_header.appendChild(tr_diff_header_row);
                diff_table.appendChild(diff_table_header);

                var all_detection_rows = [];
                var detection_type_count = 0;
                var vendor1_detections = [];
                var vendor2_detections = [];
                var previous_dtype = "";
                var diff_value;
                var vendor_data_matches = 0;

                // Get the vendors' data from json, makes it easier to work with.
                for (vendor of step.Techniques[0]["Vendors"]) {
                    if (vendor.VendorName == global_vendor1.vendorName) {
                        vendor1_detections = vendor.Detections.slice();
                        vendor_data_matches++;
                    }
                    else if (vendor.VendorName == global_vendor2.vendorName) {
                        vendor2_detections = vendor.Detections.slice();
                        vendor_data_matches++;
                    }

                    if (vendor_data_matches > 1) {
                        break;
                    }
                }
                
                // Keep a record of v2 detections that have already been matched, exclude them from further matching
                var done_indexes = [];

                // For every v1 detection, loop through v2 2 detections and assess diff value.
                // Creates tuple-like arrays (stored in all_detection_rows[]) that will be used to generate table rows later
                for (detection of vendor1_detections) {
                    var v1_dtype = detection.DetectionType;

                    // Check v2 detections for repeats before assessing a new v1 detection type
                    if (previous_dtype && (v1_dtype != previous_dtype)) {
                        for (const [idx, detection2] of vendor2_detections.entries()) {
                            if ((!done_indexes.includes(idx)) && detection2.DetectionType == previous_dtype) {
                                var detection_row = ["no_match", detection2.DetectionType, detection2];
                                all_detection_rows.push(detection_row);
                                done_indexes.push(idx);
                            }
                        }
                    }

                    previous_dtype = v1_dtype;
                    diff_value = "no_match";

                    for (const [idx, detection2] of vendor2_detections.entries()) {
                        // If detection types match, check if modifiers match
                        if ((!done_indexes.includes(idx)) && detection2.DetectionType == v1_dtype) {

                            detection.Modifiers.sort();
                            detection2.Modifiers.sort();

                            if (JSON.stringify(detection.Modifiers) == JSON.stringify(detection2.Modifiers)) {
                                diff_value = "match";
                            }
                            else {
                                diff_value = "partial_match";
                            }

                            var detection_row = [diff_value, detection, detection2];
                            all_detection_rows.push(detection_row);
                            done_indexes.push(idx);
                            break;
                        }
                    }

                    // No match was found, so create a placeholder
                    if (diff_value == "no_match") {
                        var detection_row = ["no_match", detection, detection.DetectionType];
                        all_detection_rows.push(detection_row);
                    }
                }

                // Check vendor 2 detections for leftovers
                for (const [idx, detection] of vendor2_detections.entries()) {
                    if (!done_indexes.includes(idx)) {
                        var detection_row = ["no_match", detection.DetectionType, detection];
                        all_detection_rows.push(detection_row);
                    }
                }

                // Append rows to diff_table and append diff_table to the step_tid card
                var diff_detection = false;
                for (row of all_detection_rows) {
                    if (row[0] == "no_match") {
                        if ((typeof(row[1] == Object) && row[1].DetectionType == "None") || row[1] == "None") {
                            continue;
                        }
                        else if ((typeof(row[2] == Object) && row[2].DetectionType == "None") || row[2] == "None") {
                            continue;
                        }
                    }

                    var diff_row = document.createElement("tr");
                    // var diff_cell = document.createElement("td");
                    var td_v1_detection_cell = document.createElement("td");
                    var td_v2_detection_cell = document.createElement("td");
                    var match_type = row[0];

                    diff_row.setAttribute("class", "tr_diff_row");
                    // diff_cell.setAttribute("class", "td_diff_cell");
                    td_v1_detection_cell.setAttribute("class", "td_v1_detection_cell");
                    td_v2_detection_cell.setAttribute("class", "td_v2_detection_cell");
                    
                    switch(match_type) {
                        case "match":
                            // diff_cell.innerHTML = '=';
                            break;
                        case "partial_match":
                            diff_detection = true;
                            // diff_cell.innerHTML = '&asymp;';
                            // div_step_tid.setAttribute("data-match_status", "no_match");
                            break;
                        default:
                            // no match
                            diff_detection = true;
                            // diff_cell.innerHTML = '&ne;';
                            div_step_tid.setAttribute("data-match_status", "no_match");
                    }
                    td_v1_detection_cell.appendChild(create_detection_card(match_type, row[1], false));
                    td_v2_detection_cell.appendChild(create_detection_card(match_type, row[2], true));

                    // diff_row.appendChild(diff_cell);
                    diff_row.appendChild(td_v1_detection_cell);
                    diff_row.appendChild(td_v2_detection_cell);

                    diff_table_body.appendChild(diff_row);
                }

                // If there was a diff in the step, highlight the card header 
                if (diff_detection) {
                    header = document.getElementById("div_collapse_header_" + step_tid)
                    header.setAttribute("class", "card-header collapsed hoverpointer card-header-text-difference");
                    div_step_tid.setAttribute("data-match_status", "no_match");
                } else {
                    header = document.getElementById("div_collapse_header_" + step_tid)
                    header.setAttribute("class", "card-header collapsed hoverpointer card-header-text");
                    div_step_tid.setAttribute("data-match_status", "match");
                }

                if(!horizontal_rule) {
                    horizontal_rule = document.createElement("hr");
                    horizontal_rule.setAttribute("id", "card_hr");
                    div_collapse_body.appendChild(horizontal_rule);
                }

                diff_table.appendChild(diff_table_body);
                div_collapse_body.appendChild(diff_table);
            }

            applyFilters(false);
            check_expand_status(null);

        }
    }
    
    function create_detection_card(match_type, detection, increment_row_uid) {
        var div_detection_card = document.createElement("div");
        div_detection_card.setAttribute("class", "card w-100");

        var div_card_header = document.createElement("div");
        div_card_header.setAttribute("class", "card-header collapsed hover-pointer");
        // div_card_header.setAttribute("id", "card_header_" + column_uid + "_" + step_tid + "_" + detection_counter_str);
        div_card_header.setAttribute("data-toggle", "collapse");
        div_card_header.setAttribute("data-target", ".detection_" + detection_row_uid + "_body");
        div_card_header.setAttribute("aria-expanded", "false");
        div_card_header.setAttribute("aria-controls", "detection_" + detection_row_uid + "_body");

        // Get Dtype and modifiers for header
        var span_detection_type = document.createElement("h6");
        span_detection_type.setAttribute("class", "mb-0");
        
        if (typeof(detection) == "string") {
            // Detection is missing, so make a blank detection cell
            div_detection_card.setAttribute("style", "background-color: lightgrey");
            span_detection_type.appendChild(document.createTextNode(detection));
            span_detection_type.setAttribute("style", "visibility: hidden;");
            
            // if (detection != "N/A") {
            //     span_detection_type.appendChild(create_detection_icon(detection));
            // }
            
            div_card_header.appendChild(span_detection_type);

            // Placeholder for modifiers so that all cards are the same height
            var span_modifiers = document.createElement("h6");
            span_modifiers.setAttribute("class", "mb-0 sub-h6");
            span_modifiers.appendChild(document.createTextNode("(invisible)"));
            span_modifiers.setAttribute("style", "visibility: hidden;");
            div_card_header.appendChild(span_modifiers);

            div_detection_card.appendChild(div_card_header);
        }
        else if (typeof(detection) == "object") {
            // There's either a match or a modifier difference
            span_detection_type.appendChild(document.createTextNode(detection.DetectionType));

            if (detection.DetectionType != "N/A") {
                span_detection_type.appendChild(create_detection_icon(detection.DetectionType));
            }

            if (match_type == "partial_match" || match_type == "no_match") {
                // span_detection_type.setAttribute("style", "color: pink");
                div_card_header.setAttribute("style", "background-color: lightgrey");
            }

            div_card_header.appendChild(span_detection_type);

            // Always add placeholder so that all cards are the same height.
            var span_modifiers = document.createElement("h6");
            span_modifiers.setAttribute("class", "mb-0 sub-h6");

            var modifiers_text = "placeholder";

            if (detection.Modifiers.length > 0) {
                modifiers_text = "";
                for (const [idx, modifier] of detection.Modifiers.entries()) {
                    modifiers_text += modifier;
                    if (idx < detection.Modifiers.length -1) {
                        modifiers_text += ", ";
                    }
                }

                if (match_type == "partial_match" || match_type == "no_match") {
                    // span_modifiers.setAttribute("style", "color: pink");
                    div_card_header.setAttribute("style", "background-color: lightgrey");
                }
            }
            else {
                span_modifiers.setAttribute("style", "visibility: hidden;");
            }

            span_modifiers.appendChild(document.createTextNode(modifiers_text));
                
            if (detection.Modifiers.length > 0) {
                for (modifier of detection.Modifiers) {
                    span_modifiers.appendChild(create_detection_icon(modifier));
                }
            }

            div_card_header.appendChild(span_modifiers);
            div_detection_card.appendChild(div_card_header);

            // Make detection card body
            let div_card_body = document.createElement("div");
            div_card_body.setAttribute("class", "collapse detection_" + detection_row_uid + "_body");
            // div_card_body.setAttribute("id", "detection_" + detection_row_uid + "_body");
            div_card_body.setAttribute("aria-labelledby", "detection_" + detection_row_uid + "_header");
            
            // Create inner div for detection note
            var div_card_body_inner = document.createElement("div");
            div_card_body_inner.setAttribute("class", "card-body");
            var span_detection_note = document.createElement("span");
            span_detection_note.setAttribute("class", "tc_span_detection_note");
            var detection_note_text = detection.DetectionNote;
            var regex = /\[[A-Z][A-Z]\d+\]/g;
            detection_note_text = detection_note_text.replace(regex, '');
            span_detection_note.appendChild(document.createTextNode(detection_note_text));
            
            // Add footnotes after the detection note
            if (detection.Footnotes) {
                for (let i = 0; i < detection.Footnotes.length; i++) {
                    let a_footnote = document.createElement("a");
                    a_footnote.setAttribute("href", "javascript:void(0);")
                    a_footnote.setAttribute("class", "aFootnote");

                    let i_detection_icon = document.createElement("i");
                    i_detection_icon.setAttribute("class", "fas fa-info-circle mr-1");

                    let span_footnote = document.createElement("span");
                    span_footnote.setAttribute("class", "diff_spanPopup_footnotes");
                    span_footnote.setAttribute("onclick", "return false;");
                    span_footnote.setAttribute("href", "#")
                    span_footnote.appendChild(document.createTextNode(detection.Footnotes[i]));

                    i_detection_icon.appendChild(span_footnote);
                    a_footnote.appendChild(i_detection_icon);
                    span_detection_note.appendChild(a_footnote);
                }
            }

            if (detection.Modifiers) {
                // Add screenshots after detection note and footnotes
                for (i = 0; i < detection.Screenshots.length; i++) {
                    let a_screenshot = document.createElement("a");
                    a_screenshot.setAttribute("href", "https://d1zq5d3dtjfcoj.cloudfront.net/" + detection.Screenshots[i].ScreenshotName);
                    a_screenshot.setAttribute("target", "_blank");
                    a_screenshot.innerHTML = a_screenshot.innerHTML + "<sup>[" + (i + 1) + "]</sup> ";
                    span_detection_note.appendChild(a_screenshot);
                }
            }

            // Append card body elements
            div_card_body_inner.append(span_detection_note);
            div_card_body.appendChild(div_card_body_inner);
            div_detection_card.appendChild(div_card_body);
        }

        if (increment_row_uid) {
            detection_row_uid++;
        } 

        return div_detection_card;
    }

    function create_detection_icon(str_detection_type) {
        let icon = document.createElement("img");
        let icon_dict = {};

        icon_dict['indicator of compromise'] = "https://d1zq5d3dtjfcoj.cloudfront.net/noun_indicator_of_compromise.svg";
        icon_dict['general behavior'] = "https://d1zq5d3dtjfcoj.cloudfront.net/noun_general_behavior.svg";
        icon_dict['specific behavior'] = "https://d1zq5d3dtjfcoj.cloudfront.net/noun_specific_behavior.svg";
        icon_dict['tainted'] = "https://d1zq5d3dtjfcoj.cloudfront.net/noun_tainted.svg";
        icon_dict['enrichment'] = "https://d1zq5d3dtjfcoj.cloudfront.net/noun_enrichment.svg";
        icon_dict['none'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_none.svg";
        icon_dict['telemetry'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_telemetry.svg";
        icon_dict['general'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_general.svg";
        icon_dict['tactic'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_tactic.svg";
        icon_dict['technique'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_technique.svg";
        icon_dict['mssp'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_mssp.svg";

        icon_dict['alert'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_alert.svg";
        icon_dict['correlated'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_correlated.svg";
        icon_dict['delayed'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_delayed.svg";
        icon_dict['host interrogation'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_host_interrogation.svg";
        icon_dict['residual artifact'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_residual_artifact.svg";
        icon_dict['configuration change'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_configuration_change.svg";
        icon_dict['innovative'] = "https://d1zq5d3dtjfcoj.cloudfront.net/round2_distinction.svg";

        if(str_detection_type.includes("(")) {
            str_detection_type = str_detection_type.split("(")[0].trim();
        }

        icon.setAttribute("src", icon_dict[str_detection_type.toLowerCase()]);
        icon.setAttribute("class", "tc_img_detection_icon");
        icon.setAttribute("title", str_detection_type);

        return icon;
    }

    function open_all_cards(filter_applied) {
        var headers = document.getElementsByClassName("card-header");
        for (header of headers) {
            if (header.id.indexOf("div_collapse_header") > -1) {
                var matching_body = document.getElementById(header.id.replace("header", "body"));
                if (!filter_applied) {
                    header.classList.remove("collapsed");
                    header.setAttribute("aria-expanded", "true");
                    matching_body.classList.add("show");
                }
            }
        }
        var expand_btn = document.getElementById("expand");
        var collapse_btn = document.getElementById("collapse");

        expand_btn.setAttribute("style", "display: none;")
        collapse_btn.setAttribute("style", "display: block")

        card_open_status = true;
        update_url(false)

    }

    function close_all_cards(filter_applied) {
        var headers = document.getElementsByClassName("card-header");
        for (header of headers) {
            if (header.id.indexOf("div_collapse_header") > -1) {
                var matching_body = document.getElementById(header.id.replace("header", "body"));
                if (!filter_applied) {
                    header.classList.add("collapsed");
                    header.setAttribute("aria-expanded", "false");
                    matching_body.classList.remove("show");
                }
            }
        }
        var expand_btn = document.getElementById("expand");
        var collapse_btn = document.getElementById("collapse");

        collapse_btn.setAttribute("style", "display: none;")
        expand_btn.setAttribute("style", "display: block")

        card_open_status = false;

        update_url(false)
    }

    function check_expand_status(card_clicked) {
        // Need to get the cards that currently have their display attribute as "block"
        var currently_displayed_cards = $('.diff_div_step_tid_card:visible > div > div.card-header');
        var opened_cards = 0;
        
        // From those cards, check their open status ie. if aria-expanded = true
        for (card of currently_displayed_cards) {
            // If current card matches the card that was clicked, confirm the correct value of aria-expanded into tally
            if(card_clicked && (card == card_clicked)) {
                var clicked_status_post_render = !(card.getAttribute('aria-expanded') == 'true');
                if(clicked_status_post_render) {
                    opened_cards += 1;
                }
            } else {
                if(card.getAttribute('aria-expanded') == 'true') {
                    opened_cards += 1;
                } 
            }
        }

        if(opened_cards == currently_displayed_cards.length) {
            open_all_cards(true);
        } 
        if(opened_cards == 0) {
            close_all_cards(true);
        }
    }

    function update_url(new_round_selected) {
        var vendor1_value = document.getElementById("diff_vendor1_select").selectedOptions[0].value;
        var vendor2_value = document.getElementById("diff_vendor2_select").selectedOptions[0].value;
        var match_filter_value = document.getElementById("diff_match_filter").selectedOptions[0].value;
        var tactic_filter_value = document.getElementById("diff_tactic_filter").selectedOptions[0].value;
        var cards_open_status = card_open_status;
        var base_url = window.location.href;

        if (base_url.indexOf("?") > -1) {
            base_url = base_url.substring(0, base_url.indexOf("?"));
        }

        var query_string = base_url;

        query_string += "?round=" + selected_round;

        if (!new_round_selected) {
            if (vendor1_value != "Select Vendor" && vendor2_value != "Select Vendor") {
                query_string += "&vendors=" + vendor1_value + "," + vendor2_value;
            }
            
            if (match_filter_value == "all_steps" && tactic_filter_value == "all_tactics") {
                // pass
            }
            else {
                query_string += "&steps=" + match_filter_value + "&tactic=" + tactic_filter_value;
            }
        }
        if (cards_open_status) {
            query_string += "&cards_open=true";
        }
        else {
            query_string += "&cards_open=false";
        }

        window.history.pushState({}, "", query_string);
    }


    function applyFilters(filter_selected) {
        update_url(false);
        var all_cards = document.querySelectorAll("[data-match_status]");
        var match_filter = document.getElementById("diff_match_filter");
        var tactic_filter = document.getElementById("diff_tactic_filter");
        var match_filter_value = match_filter.selectedOptions[0].value;
        var tactic_filter_value = tactic_filter.selectedOptions[0].value;

        for (card of all_cards) {
            var match_status = card.getAttribute("data-match_status");
            var tactic_ids = card.getAttribute("data-tactic_ids").trim();
            var show_card = false;

            if (match_filter_value == "all_steps") {
                if (tactic_filter_value == "all_tactics") {
                    show_card = true;
                }
                else if (tactic_ids.indexOf(tactic_filter_value) > -1) {
                    show_card = true;
                }
            }
            else if (match_filter_value == "diffs") {
                if (match_status == "no_match") {
                    if ((tactic_filter_value == "all_tactics") || (tactic_ids.indexOf(tactic_filter_value) > -1)) {
                        show_card = true;
                    }
                }
            }
            else if (match_filter_value == "matches") {
                if (match_status == "match") {
                    if ((tactic_filter_value == "all_tactics") || (tactic_ids.indexOf(tactic_filter_value) > - 1)) {
                        show_card = true;
                    }
                }
            }

            if (show_card) {
                card.setAttribute("style", "display: block;");
            }
            else {
                card.setAttribute("style", "display: none;");
            }
        }

        // Filter isn't being applied for query string, option was selected from dropdowns
        if (filter_selected) {
            close_all_cards(false)
        }
    }

    function load_tactics_filter_options(raw_tactics_in_round) {
        var diff_tactic_filter = document.getElementById("diff_tactic_filter");
        
        // First clear the filter
        diff_tactic_filter.innerHTML = "";
        
        clean_tactics_in_round = [];
        
        for (tactic of raw_tactics_in_round) {
            var tactic_str = tactic.TacticId + "." + tactic.TacticName;

            if (!clean_tactics_in_round.includes(tactic_str)) {
                clean_tactics_in_round.push(tactic_str);
            }
        }

        clean_tactics_in_round.sort();

        var all_tactics_option = document.createElement("option");
        all_tactics_option.value = "all_tactics";
        all_tactics_option.appendChild(document.createTextNode("All tactics"));
        diff_tactic_filter.appendChild(all_tactics_option);

        for (tactic_str of clean_tactics_in_round) {
            var tactic_id = tactic_str.slice(0, tactic_str.indexOf("."));
            var tactic_name = tactic_str.slice(tactic_str.indexOf(".") + 1);
            // var formatted_tactic_str = tactic_name + " (" + tactic_id + ")";
            var formatted_tactic_str = tactic_name;
            var tactic_option = document.createElement("option");
            
            tactic_option.value = tactic_id;
            tactic_option.setAttribute("data-tactic_name", tactic_name);
            tactic_option.appendChild(document.createTextNode(formatted_tactic_str));

            diff_tactic_filter.appendChild(tactic_option);
        }
    }

    // Scroll to top button
    $(window).scroll(function() {
        var height = $(window).scrollTop();
        if (height > 100) {
            $('#scrollUp').fadeIn();
        } else {
            $('#scrollUp').fadeOut();
        }
    });
    $(document).ready(function() {
        $("#scrollUp").click(function(event) {
            event.preventDefault();
            $("html, body").animate({ scrollTop: 0 }, "slow");
            return false;
        });

    });

    
    function custom_replaceAll(string, char_to_replace, replacement_char) {
        let new_str = "";
        
        for (letter of string) {
            if (letter != char_to_replace) {
                new_str += letter;
            }
            else {
                new_str += replacement_char;
            }
        }
        
        return new_str;
    }


    function start_tour() {
        document.getElementById("div_vendor_comparison_main").style.display = "None";
        document.getElementById("div_collapse_body_1_A_2_T1028_tour").classList.remove("show");
        document.getElementById("divTourBody").style.display = "Block";

        run_tour();
    }


    function expand_for_tour(card_type) {
        if (card_type == 'step') {
            document.getElementById("div_collapse_body_1_A_2_T1028_tour").classList.add("show");
        }
        else if (card_type == 'detection') {
            document.getElementById("div_detection1_expand_tour1").classList.remove("collapsed");
            document.getElementById("div_detection1_expand_tour2").classList.add("show");

            document.getElementById("div_detection2_expand_tour1").classList.remove("collapsed");
            document.getElementById("div_detection2_expand_tour2").classList.add("show");
        }
    }


    function end_tour() {
        document.getElementById("div_vendor_comparison_main").style.display = "Block";
        document.getElementById("divTourBody").style.display = "None";
        document.getElementById("tourBackdrop").style.display = "None";

        // Also reset expansion of divs in case the tour is run again
        document.getElementById("div_collapse_body_1_A_2_T1028_tour").classList.remove("show");
        
        document.getElementById("div_detection1_expand_tour1").classList.add("collapsed");
        document.getElementById("div_detection1_expand_tour2").classList.remove("show");
        document.getElementById("div_detection2_expand_tour1").classList.add("collapsed");
        document.getElementById("div_detection2_expand_tour2").classList.remove("show");
    }


    function run_tour() {
        // Instance the tour
        var tour = new Tour({
            framework: 'bootstrap4',   // or "bootstrap4" depending on your version of bootstrap
            storage: false,
            onEnd: function() {end_tour();},
            steps: [
                {
                    // slide 1
                    orphan: true,
                    backdrop: true,
                    title: 'Welcome to the Vendor Comparison tour!',
                    content: 'This guided tour will teach you how to use the Vendor Comparison Tool.'
                },
                {
                    // slide 2
                    element: '#btnSelectRound_tour',
                    title: 'First, select a round.',
                    content: 'If your desired round is not already selected, choose it from this dropdown. Selecting a new round will automatically update the steps shown on the right.'
                },
                {
                    // slide 3
                    element: '#diff_vendor1_select_tour',
                    title: 'Second, select vendors for comparison.',
                    content: 'Here, you can select the two vendors you wish to compare. Once both vendors are selected, the data on the right will automatically be updated.'
                },
                {
                    // slide 4
                    element: '#div_1_A_1_T1032_tour',
                    placement: 'left',
                    title: 'Lastly, view the results!',
                    content: 'The results of your comparison will appear here. If the vendors had identical detection categories for a given step, it will appear in black, like this. If the vendors had any differences in their detection categories, they will appear in purple, like the card below.',
                },
                {
                    // slide 5
                    element: '#div_collapse_header_1_A_2_T1028_tour',
                    placement: 'left',
                    title: 'Expand Details',
                    content: 'If you want to see the details of the comparison, you can click on a result header to expand the card. Clicking the header again will collapse the card details for a more compact view.',
                    onNext: function() {
                        expand_for_tour('step');
                    }
                },
                {
                    // slide 6
                    element: '#same_tour',
                    placement: 'left',
                    title: 'Similar Detection Categories',
                    content: "In this table, you can see the comparison of each vendor's detection categories. Light gray cards like these indicate that the detection categories were the same between the two vendors."
                },
                {
                    // slide 7
                    element: '#different_tour',
                    placement: 'left',
                    title: 'Different Detection Categories or Modifiers',
                    content: 'Here, the dark gray color indicates that there was a difference in detection categories between the two vendors. Similar detection categories with different modifiers are treated as different (not similar) results. You can also click on a detection to expand/collapse the details of that detection.',
                    onNext: function() {
                        expand_for_tour('detection');
                    }
                },
                {
                    // slide 8
                    element: '#div_detection1_expand_tour2',
                    placement: 'left',
                    title: 'Detection Notes',
                    content: 'Clicking on a detection will expand the detection notes section, showing more detail. You can collapse the notes by clicking on the detection header again.',
                },
                {
                    // slide 9
                    element: '#diff_match_filter_tour',
                    title: 'Filters',
                    content: 'At any point in your comparison, you can filter the results with these dropdowns.'
                },
                {
                    // slide 10
                    element: '#expand_tour',
                    title: 'Expand/Collapse Cards',
                    content: 'You can toggle through expanding/collapsing all of the results cards with this button. Please note that this button will only affect the expanding/collapsing of the main results cards and will not affect the appearance of the detection details.'
                },
                {
                    // slide 11
                    orphan: true,
                    backdrop: true,
                    title: 'Conclusion',
                    content: "We hope you have enjoyed this tour of the Vendor Comparison Tool! If you have any feedback or suggestions, please visit the <a href='/contact'>contact page</a> to get in touch.",
                    onShown: function() {
                        document.getElementById("step-10").querySelector("[data-role='next']").style.display = "None";
                    }
                }
            ]
        });

        // Start the tour - note, no call to .init() is required
        tour.start();
    }
    
</script>

<style>
    .popover[class*="tour-"].orphan {
        left: 50% !important;
        top: 50% !important;
        margin-top: 0;
        position: absolute;
        transform: translate(-50%, -50%) !important;
    }
</style>


</div>

<footer>
    <div class="container-fluid border-top pt-4 pb-4">
        <div class="row" style="width: 95%; margin: 0 auto;">
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <p class="footer-links-left"><a class="footer-links-left" href="/terms-of-use.html">Terms and Conditions</a></p>
                <p class="footer-links-left"><a class="footer-links-left" href="/privacy.html">Privacy Policy</a></p>
                <p class="footer-links-left">© 2018 - 2021, The MITRE Corporation and MITRE Engenuity.</p>
                <p class="footer-links-left">MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.</p>
            </div>
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <div class="footer-float-right-responsive">
                    <div class="mb-1">
                        <a href="https://twitter.com/MITREengenuity" class="btn btn-footer w-100">
                            <img src="https://d1zq5d3dtjfcoj.cloudfront.net/twitter.png" class="mr-1" style="vertical-align: top" width="20" height="20">
                            <b>@MITREengenuity</b>
                        </a>
                    </div>
                    <div class="">
                        <a href="/contact.html" class="btn btn-footer w-100">
                            Contact
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
    
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    <script src="/theme/scripts/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap.min.js"></script>
    <script src="/theme/scripts/site.js"></script>

    <script src="/theme/scripts/bootstrap-tourist.js"></script>
    
</body>

<!-- jjli -->

</html>