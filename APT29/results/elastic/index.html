<!DOCTYPE html>
<html lang='en'>

<head>
    <script async src='https://www.googletagmanager.com/gtag/js?id=UA-62667723-5'></script><script src='/theme/scripts/analytics.js'></script>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='shortcut icon' href='https://d1zq5d3dtjfcoj.cloudfront.net/ME_icon.png' type='image/x-icon'>

    <link rel="stylesheet" href="/theme/style/all.css">

    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    
    <title>ATT&CK&reg; EVALUATIONS</title>
    <!-- Bootstrap CSS -->
    <link rel='stylesheet' href='/theme/style/bootstrap.min.css' />
    <link rel='stylesheet' href='/theme/style/bootstrap-glyphicon.min.css' />
    <link href="/theme/style/bootstrap-tourist.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/theme/style.min.css?a678f2af">

    <link rel="stylesheet" type="text/css" href="/theme/overview_charts.min.css?5cc11209">
</head>

<body>
    <header class='pb-5'>
        <nav class='navbar navbar-expand-lg navbar-light fixed-top box-shadow-bottom bg-white'>
        <a class='navbar-brand' href='/'><img src='https://d1zq5d3dtjfcoj.cloudfront.net/MITRE_Engenuity_ATTACK-Evaluations_logo_PMS_purple.jpg' height="50px" alt=''></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse' aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
          <span class='navbar-toggler-icon'></span>
        </button>
        
        <div class='collapse navbar-collapse' id='navbarCollapse'>
          <ul class='nav nav-tabs ml-auto'>
            
            <li class="dropdown-submenu">
               <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Enterprise</strong></a>
                <!-- <ul class="dropdown-menu dropleft"> -->
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <!-- <ul class="dropdown-menu drop_menu_side"> -->
                        <ul class="dropdown-menu drop_menu_side_right">                            
                            <li><a class="dropdown-item" href="/adversary-emulation.html">Adversary Emulation</a></li>
                            <li><a class="dropdown-item" href="/evaluation-process.html">Evaluation Process</a></li>
                            <li><a class="dropdown-item" href="/setup-and-configuration.html">Setup and Configuration</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Methodology Overview
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 50px;">
                            <li><a class="dropdown-item" href="/enterprise/evaluations.html?round=APT3">Results</a></li>
                            <li><a class="dropdown-item" href="/APT3">Overview</a></li>
                            <li><a class="dropdown-item" href="/APT3/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/APT3/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/APT3/scope.html">Technique Scope</a></li>
                            <li><a class="dropdown-item" href="/APT3/operational-flow.html">Operational Flow</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT3 (2018)
                        </a>
                        
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 90px;">
                            <li><a class="dropdown-item" href="/enterprise/evaluations.html?round=APT29">Results</a></li>
                            <li><a class="dropdown-item" href="/APT29">Overview</a></li>
                            <li><a class="dropdown-item" href="/APT29/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/APT29/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/APT29/scope.html">Technique Scope</a></li>
                            <li><a class="dropdown-item" href="/APT29/operational-flow.html">Operational Flow</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            APT29 (2019)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 130px;">
                            <li><a class="dropdown-item" href="/enterprise/evaluations.html?round=carbanak-fin7">Participants</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/">Overview</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/detection-categories.html">Detection Categories</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/protection-categories.html">Protection Categories</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/environment.html">Environment</a></li>
                            <li><a class="dropdown-item" href="/carbanak-fin7/scope.html">Technique Scope</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Carbanak+FIN7 (2020)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 180px;">
                            <li><a class="dropdown-item" href="/get-evaluated.html">Call for Participation</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Wizard Spider and <br> Sandworm (2021)
                        </a>
                    </li>
                </ul>
            </li>

            <li class="dropdown-submenu">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>ICS</strong></a>
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right">
                            <li><a class="dropdown-item" href="/ICS/evaluations.html">Participants</a></li>
                            <li><a class="dropdown-item" href="/TRITON/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            TRITON (2020)
                        </a>
                    </li>
                </ul>
            </li>

            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Tools</strong></a>
                <!-- <div class="dropdown-menu" aria-labelledby="navbarDropdown"> -->
                <div class="dropdown-menu">
                    <a class="dropdown-item" href='/technique_comparison.html'>Technique Comparison Tool </a>
                    <a class="dropdown-item" href='/vendor_comparison.html'>Vendor Comparison Tool </a>
                    <a class="dropdown-item" href='/do-it-yourself.html'>Do It Yourself Evaluations</a>
                    <a class="dropdown-item" href='/data_analysis_tool.html'>Data Analysis Tool</a>
                    <a class="dropdown-item" href='https://github.com/mitre-attack/attack-arsenal'>
                        ATT&CK Arsenal
                        &nbsp;<i class="fas fa-external-link-alt"></i>
                    </a>
                </div>  
            </li>
            <li class='nav-item dropdown'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Resources</strong></a>
                <!-- <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> -->
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/using-attack-evaluations.html">Using ATT&CK Evaluations</a>
                        <a class="dropdown-item" href="/about.html">About ATT&CK</a>
                        <a class="dropdown-item" href="/FAQ.html">FAQ</a>                    
                        <a class="dropdown-item" href="/issues.html">Issue Tracker</a>
                        <a class="dropdown-item" href="https://medium.com/mitre-engenuity/tagged/evaluation" target="_blank"> Blog</strong>&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i> </a>
                    </div>  
                </li> 
            <li class='nav-item'><a  class='nav-link'  href='/get-evaluated.html'><strong>Get Evaluated</strong></a></li>
          </ul>
        </div>
    </nav>
    <div class="div-cfp">
        <h5 class="h5-cfp">
            The 2021 ATT&CK Evaluations for Enterprise Call for Participation is now open. 
            Click <a class="a-click-here" href="/get-evaluated.html">here</a> to learn how to participate.
        </h5>
    </div>
</header>
<div id='content'>
<div class='divEvaluationSummaryBody-oc'>
    <div style='width: 100%; padding-top: 20px;'>
        <table style='width: 100%;'>
            <tr>
                <td style='width: 50%;'>
                    <div style="padding: 0px; width: 100%;"> 
                        <span class="spanBreadcrumbs-results"> 
                            <a href='/'> Home </a> &nbsp;>&nbsp; 
                            <a href='/APT29'> APT29 </a> &nbsp;>&nbsp; 
                            <a href='/enterprise/evaluations.html?round=APT29'> Results </a> &nbsp;>&nbsp;
                            Elastic
                        </span>
                    </div>
                </td>
                <td style='width: 50%;'>
                    <div>
                        
                    </div>
                </td>
            </tr>
        </table>
        <br />
        <br />
        <span class="labSubheader-oc"> 
            Elastic Overview
        </span>
        <span class='tdInnerDetectionNotesSum-oc'>
            <a class='aFootnote' href='javascript:void(0);'><i class="fas fa-info-circle"></i>
                <span class='spanPopup-footnotes' onclick='return false;' href='#'>
                    <strong style="font-size:16px">Overview Page Information</strong><br />
                    <hr style="border:2px solid black;" />
                        <p>
                            The Vendor Overview page displays the detection category distribution across the entirety of the evaluation. This summary is provided as a Step breakdown, as well as Sub-Step breakdown of the detection categories. There are also donut graphs for each detection category that display the type of modifiers it had throughout the evaluation.
                        </p>
                </span>
            </a>
        </span>
        <br />
        <a href="/APT29/results/elastic/configuration.html">Vendor Configuration</a>&nbsp;&nbsp;&nbsp;&nbsp;
        <br />
        <br />
        <table class='tableMatrixLegendExport-oc'>
            <tr>
                <td>
                    <div class='divDisclaimer-oc' style="width: 55%;">
                        <em>MITRE Engenuity does not assign scores, rankings, or ratings. The evaluation results are available to the public, so other organizations may provide their own analysis and interpretation - these are not endorsed or validated by MITRE Engenuity.</em>
                    </div>
                </td>
                <td class='tdLegendExport-oc'>
                    <a class='aLegendExport-oc pl-3' href='/APT29/results/elastic/matrix.html'>Matrix</a>
                    <a class='aLegendExport-oc pl-3' href='/APT29/results/elastic/allresults.html'>All Results</a>
                    <a class='aLegendExport-oc pl-3' href='/Elastic.1.APT29.1_Results.json'>JSON</a>
                    
                </td>
            </tr>
        </table>
        <div class='divCharts-oc'>
            <div class='divChartsTop-oc'>
                <div class="card shadow p-3 mb-5 bg-white rounded" style="flex: 2;">
                    <div class="card-body" style="height: 650px;">
                        <h5 class="card-title">Major Step Breakdown</h5>
                        <div class="legend-block mt-2" id="step_legend">
                        </div>
                        <div class="row mt-4" id="step_breakdown" style="width: 100%; height: 90%">
                        </div>
                    </div>
                </div>
                <div class="card shadow p-3 mb-5 bg-white rounded" style="flex: 1.5;">
                    <div class="card-body">
                        <h5 class="card-title">Modifiers Breakdown</h5>
                        <div class="legend-block mt-2" id="modifier_legend">
                        </div>
                        <div class="donuts-block mt-4" id="modifier_breakdown" >
                        </div>
                    </div>
                </div>
            </div>
            <div class="card shadow p-3 mb-5 bg-white rounded">
                <div class="card-body" style="height: 650px;">
                    <h5 class="card-title">Sub Step Breakdown</h5>
                    <div class="legend-block mt-2" id="substep_legend">
                    </div>
                    <div class="row mt-4" id="substep_breakdown" style="width: 100%; height: 90%">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>

<script>
    var url_string = window.location.href;
    var roundname = "APT29";
    var steps = [{'Step': '1', 'Substeps': [{'Substep': '1.A.1', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '1.A.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Configuration Change (Detections)', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '1.A.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '1.A.4', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '1.B.1', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Configuration Change (Detections)', 'Alert', 'Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '1.B.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}], 'Step_Detection_Counts': {'General': 2, 'Telemetry': 5, 'Technique': 2, 'None': 1}}, {'Step': '2', 'Substeps': [{'Substep': '2.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '2.A.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '2.A.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '2.A.4', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '2.A.5', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Configuration Change (Detections)', 'Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '2.B.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Configuration Change (Detections)']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 6, 'Technique': 2}}, {'Step': '3', 'Substeps': [{'Substep': '3.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '3.A.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '3.B.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Configuration Change (Detections)', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '3.B.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '3.B.3', 'Detections': [{'DetectionType': 'Tactic', 'Modifiers': ['Alert', 'Correlated']}, {'DetectionType': 'General', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Tactic': 1, 'General': 1, 'Telemetry': 1}}, {'Substep': '3.B.4', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '3.B.5', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '3.C.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 6, 'Technique': 1, 'Tactic': 1, 'General': 1, 'None': 2}}, {'Step': '4', 'Substeps': [{'Substep': '4.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.A.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '4.A.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.B.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.B.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.B.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.B.4', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.4', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.5', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.6', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '4.C.7', 'Detections': [{'DetectionType': 'Tactic', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Tactic': 1, 'Telemetry': 1}}, {'Substep': '4.C.8', 'Detections': [{'DetectionType': 'Tactic', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Tactic': 1, 'Telemetry': 1}}, {'Substep': '4.C.9', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.10', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Configuration Change (Detections)']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.11', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '4.C.12', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Configuration Change (Detections)']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 19, 'Technique': 2, 'Tactic': 2}}, {'Step': '5', 'Substeps': [{'Substep': '5.A.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '5.B.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'General', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'General': 1, 'Telemetry': 1}}], 'Step_Detection_Counts': {'Technique': 2, 'Telemetry': 2, 'General': 1}}, {'Step': '6', 'Substeps': [{'Substep': '6.A.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Configuration Change (Detections)']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Configuration Change (Detections)', 'Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '6.A.2', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '6.A.3', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '6.B.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '6.C.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Technique', 'Modifiers': ['Configuration Change (Detections)', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Configuration Change (Detections)']}], 'Substep_Detection_Counts': {'Technique': 2, 'Telemetry': 1}}], 'Step_Detection_Counts': {'Technique': 4, 'Telemetry': 4, 'None': 1, 'General': 1}}, {'Step': '7', 'Substeps': [{'Substep': '7.A.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '7.A.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '7.A.3', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '7.B.1', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '7.B.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '7.B.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '7.B.4', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'Technique': 3, 'Telemetry': 6, 'None': 1}}, {'Step': '8', 'Substeps': [{'Substep': '8.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '8.A.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '8.A.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '8.B.1', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '8.B.2', 'Detections': [{'DetectionType': 'None', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)']}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '8.C.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '8.C.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '8.C.3', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 2, 'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 7, 'Technique': 3, 'General': 1, 'None': 1}}, {'Step': '9', 'Substeps': [{'Substep': '9.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '9.A.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '9.B.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '9.B.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '9.B.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '9.B.4', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '9.B.5', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '9.B.6', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '9.B.7', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '9.B.8', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Configuration Change (Detections)', 'Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '9.C.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '9.C.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '9.C.3', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Configuration Change (Detections)', 'Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '9.C.4', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 14, 'Technique': 6}}, {'Step': '10', 'Substeps': [{'Substep': '10.A.1', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '10.B.1', 'Detections': [{'DetectionType': 'None', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)']}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '10.B.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '10.B.3', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'None': 2, 'Telemetry': 2}}, {'Step': '11', 'Substeps': [{'Substep': '11.A.1', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '11.A.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '11.A.3', 'Detections': [{'DetectionType': 'Tactic', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Tactic': 1, 'Telemetry': 1}}, {'Substep': '11.A.4', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': []}, {'DetectionType': 'Tactic', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Tactic': 1, 'Telemetry': 1}}, {'Substep': '11.A.5', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '11.A.6', 'Detections': [{'DetectionType': 'Tactic', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Tactic': 1, 'Telemetry': 1}}, {'Substep': '11.A.7', 'Detections': [{'DetectionType': 'Tactic', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Tactic': 1, 'Telemetry': 1}}, {'Substep': '11.A.8', 'Detections': [{'DetectionType': 'Tactic', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Tactic': 1, 'Telemetry': 1}}, {'Substep': '11.A.9', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '11.A.10', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '11.A.11', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': []}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '11.A.12', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert']}, {'DetectionType': 'Technique', 'Modifiers': ['Alert']}, {'DetectionType': 'Technique', 'Modifiers': []}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 3, 'Telemetry': 1}}, {'Substep': '11.A.13', 'Detections': [{'DetectionType': 'Tactic', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Tactic': 1, 'Telemetry': 1}}, {'Substep': '11.A.14', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '11.A.15', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}], 'Step_Detection_Counts': {'General': 1, 'Telemetry': 13, 'Technique': 7, 'Tactic': 6, 'None': 2}}, {'Step': '12', 'Substeps': [{'Substep': '12.A.1', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '12.A.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert', 'Correlated']}, {'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 2, 'Telemetry': 1}}, {'Substep': '12.B.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Configuration Change (Detections)', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '12.C.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '12.C.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'General': 1, 'Telemetry': 5, 'Technique': 3}}, {'Step': '13', 'Substeps': [{'Substep': '13.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '13.B.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '13.C.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '13.D.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 4}}, {'Step': '14', 'Substeps': [{'Substep': '14.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '14.A.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '14.A.3', 'Detections': [{'DetectionType': 'None', 'Modifiers': ['Host Interrogation', 'Delayed (Manual)']}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '14.B.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Technique', 'Modifiers': ['Alert', 'Correlated']}, {'DetectionType': 'Technique', 'Modifiers': ['Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 3, 'Telemetry': 1}}, {'Substep': '14.B.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '14.B.3', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Alert', 'Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '14.B.4', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert', 'Correlated']}], 'Substep_Detection_Counts': {'Technique': 1}}, {'Substep': '14.B.5', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Configuration Change (Detections)', 'Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '14.B.6', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 7, 'None': 1, 'Technique': 6, 'General': 1}}, {'Step': '15', 'Substeps': [{'Substep': '15.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '15.A.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Technique', 'Modifiers': ['Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 2, 'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 2, 'Technique': 2}}, {'Step': '16', 'Substeps': [{'Substep': '16.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '16.B.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '16.B.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '16.C.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert', 'Correlated']}, {'DetectionType': 'General', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Technique': 1, 'General': 1, 'Telemetry': 1}}, {'Substep': '16.C.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '16.D.1', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '16.D.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}, {'DetectionType': 'Technique', 'Modifiers': ['Correlated', 'Alert']}], 'Substep_Detection_Counts': {'Technique': 2}}], 'Step_Detection_Counts': {'Telemetry': 6, 'Technique': 3, 'General': 2}}, {'Step': '17', 'Substeps': [{'Substep': '17.A.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '17.B.1', 'Detections': [{'DetectionType': 'None', 'Modifiers': []}], 'Substep_Detection_Counts': {'None': 1}}, {'Substep': '17.B.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '17.C.1', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}, {'Substep': '17.C.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'Telemetry': 4, 'None': 1}}, {'Step': '18', 'Substeps': [{'Substep': '18.A.1', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Alert', 'Correlated']}, {'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'General': 1, 'Telemetry': 1}}, {'Substep': '18.A.2', 'Detections': [{'DetectionType': 'Telemetry', 'Modifiers': ['Correlated']}], 'Substep_Detection_Counts': {'Telemetry': 1}}], 'Step_Detection_Counts': {'General': 1, 'Telemetry': 2}}, {'Step': '19', 'Substeps': [{'Substep': '19.A.1', 'Detections': [{'DetectionType': 'N/A', 'Modifiers': []}], 'Substep_Detection_Counts': {'N/A': 1}}, {'Substep': '19.A.2', 'Detections': [{'DetectionType': 'N/A', 'Modifiers': []}], 'Substep_Detection_Counts': {'N/A': 1}}, {'Substep': '19.B.1', 'Detections': [{'DetectionType': 'N/A', 'Modifiers': []}], 'Substep_Detection_Counts': {'N/A': 1}}, {'Substep': '19.B.2', 'Detections': [{'DetectionType': 'N/A', 'Modifiers': []}], 'Substep_Detection_Counts': {'N/A': 1}}, {'Substep': '19.C.1', 'Detections': [{'DetectionType': 'N/A', 'Modifiers': []}], 'Substep_Detection_Counts': {'N/A': 1}}, {'Substep': '19.C.2', 'Detections': [{'DetectionType': 'N/A', 'Modifiers': []}], 'Substep_Detection_Counts': {'N/A': 1}}], 'Step_Detection_Counts': {'N/A': 6}}, {'Step': '20', 'Substeps': [{'Substep': '20.A.1', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '20.A.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': []}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '20.A.3', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert']}, {'DetectionType': 'Technique', 'Modifiers': []}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 2, 'Telemetry': 1}}, {'Substep': '20.B.1', 'Detections': [{'DetectionType': 'General', 'Modifiers': ['Alert']}], 'Substep_Detection_Counts': {'General': 1}}, {'Substep': '20.B.2', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}, {'Substep': '20.B.3', 'Detections': [{'DetectionType': 'Technique', 'Modifiers': ['Alert']}, {'DetectionType': 'Telemetry', 'Modifiers': []}], 'Substep_Detection_Counts': {'Technique': 1, 'Telemetry': 1}}], 'Step_Detection_Counts': {'Technique': 6, 'Telemetry': 5, 'General': 1}}];
    let step_nums_and_names = [{'step_num': 1, 'step_name': 'Initial Compromise'}, {'step_num': 2, 'step_name': 'Collection and Exfiltration'}, {'step_num': 3, 'step_name': 'Deploy Stealth Toolkit'}, {'step_num': 4, 'step_name': 'Clean Up and Reconnaissance'}, {'step_num': 5, 'step_name': 'Establish Persistence'}, {'step_num': 6, 'step_name': 'Credential Access'}, {'step_num': 7, 'step_name': 'Collection and Exfiltration'}, {'step_num': 8, 'step_name': 'Expand Access'}, {'step_num': 9, 'step_name': 'Clean Up, Collection, and Exfiltration'}, {'step_num': 10, 'step_name': 'Persistence Execution'}, {'step_num': 11, 'step_name': 'Initial Compromise'}, {'step_num': 12, 'step_name': 'Fortify Access'}, {'step_num': 13, 'step_name': 'Reconnaissance'}, {'step_num': 14, 'step_name': 'Elevation & Credential Access'}, {'step_num': 15, 'step_name': 'Establish Persistence'}, {'step_num': 16, 'step_name': 'Expand Access'}, {'step_num': 17, 'step_name': 'Collection'}, {'step_num': 18, 'step_name': 'Exfiltration'}, {'step_num': 19, 'step_name': 'Clean Up (omitted)'}, {'step_num': 20, 'step_name': 'Persistence Execution'}];
    var substepChartTicksHidden = false;
    var allStepChartDetections = ['None', 'Telemetry', 'MSSP', 'General', 'Tactic', 'Technique'];
    var modifiers = ['None', 'Alert', 'Correlated', 'Delayed (Manual)', 'Delayed (Processing)', 'Host Interrogation', 'Residual Artifact', 'Configuration Change (UX)', 'Configuration Change (Detections)', 'Innovative'];
    var modifiers_legend_colors = [];
    var disabledStepChartDetections = [];
    var disabledSubstepChartDetections = [];
    var step_legend_colors = [];
    var step_bar_colors = [];
    var chart_columns = [];
    var substep_bar_colors = [];
    var stepChartHeight;
    var stepChartWidth;
    var stepChartMaxDetections = 0
    var substepChartMaxDetections = 0


    window.onload = function() {
        if (this.roundname == "APT3") {
            this.step_legend_colors = ["#185b85", "#007a9a", "#ffbb05", "#95bd2a", "#00978d", "#05ae6a"];
            this.modifiers_legend_colors = ["#185b85", "#7a5195", "#374c80", "#ff764a", "#fd7e14"];
            this.step_bar_colors = ["#185b85", "#007a9a", "#ffbb05", "#95bd2a", "#00978d", "#05ae6a"];
            this.substep_bar_colors = ["#185b85", "#007a9a", "#ffbb05", "#95bd2a", "#00978d", "#05ae6a"];
            this.chart_columns = ["step", "None", "Telemetry", "Indicator of Compromise", "Enrichment", "General Behavior", "Specific Behavior"]

        }
        else{
            this.step_legend_colors = ["#185b85", "#007a9a", "#ffbb05", "#00978d", "#05ae6a", "#95bd2a"];
            this.modifiers_legend_colors = ["#185b85", "#003f5c", "#374c80", "#7a5195", "#7a5195", "#bc5090", "#ef5675", "#ff764a", "#ff764a", "#ffa600"];
            this.step_bar_colors = ["#185b85", "#007a9a", "#ffbb05", "#00978d", "#05ae6a", "#95bd2a"];
            this.substep_bar_colors = ["#185b85", "#007a9a", "#ffbb05", "#00978d", "#05ae6a", "#95bd2a"];
            this.chart_columns = ['step', 'None', 'Telemetry', 'MSSP', 'General', 'Tactic', 'Technique'];
        }

        load_chart_legend('step_legend');
        load_step_chart();
        load_donuts_legend();
        load_donuts();
        load_substep_chart_legend('substep_legend')
        load_substep_chart();

    };

    function toggleStepFilter(textElement) {
        const stepClicked = textElement.textContent
        if(textElement.getAttribute("data-state") == "enabled") {
            textElement.setAttribute("data-state", "disabled")
            textElement.setAttribute("style", "font-size: 12px; text-decoration: line-through;")
            disabledStepChartDetections.push(stepClicked)
        } else {
            textElement.setAttribute("data-state", "enabled")
            const index = disabledStepChartDetections.indexOf(stepClicked)
            disabledStepChartDetections.splice(index, 1)
            textElement.setAttribute("style", "font-size: 12px;")
        }
        load_step_chart()
    }

    function toggleSubstepFilter(textElement) {
        const substepClicked = textElement.textContent;
        if(textElement.getAttribute("data-state") == "enabled") {
            textElement.setAttribute("data-state", "disabled")
            textElement.setAttribute("style", "font-size: 12px; text-decoration: line-through;")
            disabledSubstepChartDetections.push(substepClicked)
        } else {
            textElement.setAttribute("data-state", "enabled")
            const index = disabledSubstepChartDetections.indexOf(substepClicked)
            disabledSubstepChartDetections.splice(index, 1)
            textElement.setAttribute("style", "font-size: 12px;")
        }
        load_substep_chart()
    }   

    function load_chart_legend(legendContainerID) {
        const stepLegendColors = d3.scaleOrdinal()
            .domain(this.allStepChartDetections)
            .range(this.step_legend_colors)

        var outerLegendContainer = document.getElementById(legendContainerID);

        for ( const [i, detection] of this.allStepChartDetections.entries() ) {
            let legendContainer = document.createElement("div");
            let legendID = legendContainerID + "_container_" + parseInt(i);
            legendContainer.setAttribute("id", legendID);
            legendContainer.setAttribute("class", "legend-container");
            outerLegendContainer.appendChild(legendContainer);

            const svg = d3.select("#" + legendID).append("svg")
                .attr("width", 185)
                .attr("height", 25)
            const legend_item = svg
                .append("g")
                .attr("class", "legend-item")
            const rects = legend_item
                .append("rect")
                .attr("width", 25)
                .attr("height", 15)
                .attr("fill", stepLegendColors(detection));
            const legend_text = legend_item.append("text")
                .attr("onclick", "toggleStepFilter(this)")
                .attr("data-state", "enabled")
                .attr("x", 30)
                .attr("y", 12)
                .style("font-size", "12px")
                .text(detection)
        }
    }

    function load_substep_chart_legend(legendContainerID) {
        const substepLegendColors = d3.scaleOrdinal()
            .domain(this.allStepChartDetections)
            .range(this.step_legend_colors)

        var outerLegendContainer = document.getElementById(legendContainerID);

        for ( const [i, detection] of this.allStepChartDetections.entries() ) {
            let legendContainer = document.createElement("div");
            let legendID = legendContainerID + "_container_" + parseInt(i);
            legendContainer.setAttribute("id", legendID);
            legendContainer.setAttribute("class", "legend-container");
            outerLegendContainer.appendChild(legendContainer);

            const svg = d3.select("#" + legendID).append("svg")
                .attr("width", 185)
                .attr("height", 25)
            const legend_item = svg
                .append("g")
                .attr("class", "legend-item")
            const rects = legend_item
                .append("rect")
                .attr("width", 25)
                .attr("height", 15)
                .attr("fill", substepLegendColors(detection));
            const legend_text = legend_item.append("text")
                .attr("onclick", "toggleSubstepFilter(this)")
                .attr("x", 30)
                .attr("y", 12)
                .attr("data-state", "enabled")
                .style("font-size", "12px")
                .text(detection)
        }
    }

    function load_donuts_legend() {
        const modifierLegendColors = d3.scaleOrdinal()
            .domain(this.modifiers)
            .range(this.modifiers_legend_colors)

        var outerLegendContainer = document.getElementById("modifier_legend");

        for ( const [i, modifier] of this.modifiers.entries() ) {
            let legendContainer = document.createElement("div");
            let legendID = "legend_container_" + parseInt(i);
            legendContainer.setAttribute("id", legendID);
            legendContainer.setAttribute("class", "legend-container");
            outerLegendContainer.appendChild(legendContainer);

            const svg = d3.select("#" + legendID).append("svg")
                .attr("width", 185)
                .attr("height", 35)
            const legend_item = svg
                .append("g")
                .attr("class", "legend-item")
            const rects = legend_item
                .append("rect")
                .attr("width", 25)
                .attr("height", 15)
                .attr("y", 5)
                .attr("fill", modifierLegendColors(modifier));
            if(modifier.length < 25) {
                legend_item.append("text")
                .attr("x", 30)
                .attr("y", 17)
                .style("font-size", "12px")
                .text(modifier)
            } else {
                legend_item.append("text")
                .attr("x", 30)
                .attr("y", 12)
                .style("font-size", "12px")
                .text(modifier.match(/.{1,25}(\s|$)/g)[0])
                legend_item.append("text")
                .attr("x", 30)
                .attr("y", 24)
                .style("font-size", "12px")
                .text(modifier.match(/.{1,25}(\s|$)/g)[1])
            }
        }
    }

    function load_donuts() {
        // Get a count of all modifiers of each detection
        counts = {}
        for (detection_type of this.allStepChartDetections) {
            counts[detection_type] = {}
        }
        for (step of this.steps) {
            for (substep of step.Substeps) {
                for (detection of substep.Detections) {
                    let dtype = detection.DetectionType;
                    if (dtype != 'N/A') {
                        if (detection.Modifiers.length == 0) {
                            counts[dtype]['None'] = counts[dtype]['None'] + 1 || 1
                        } else {
                            for (modifier of detection.Modifiers) {
                                counts[dtype][modifier] = counts[dtype][modifier] + 1 || 1
                            }
                        }
                    }
                }
            }
        }
        // Fill the chart specific data structure
        var chart_input = []
        for (detection_type of this.allStepChartDetections) {
            data = {}
            data.DetectionType = detection_type;
            data.Modifiers = [];
            for (modifier in counts[detection_type]) {
                chart_modifier = {}
                chart_modifier.modifier = modifier
                chart_modifier.count = counts[detection_type][modifier];
                data.Modifiers.push(chart_modifier)
            }
            chart_input.push(data)
        }
        draw_donuts(chart_input);
    }

    function draw_donuts(chart_input) {
        for (const [i, chart] of chart_input.entries()) {
            var stepTacticModifierData = chart.Modifiers;
            if (chart.Modifiers.length == 0) {
                // No detections of this type
                stepTacticModifierData.push({ 'modifier': 'No Detections', 'count': 1 })
            }

            var height = 175;
            var width = 175;
            var radius = (height - 100) / 2;

            const colorModifiers = d3.scaleOrdinal()
                .domain(this.modifiers)
                .range(this.modifiers_legend_colors);
            
            // // Create arcs for donut
            var arc = d3.arc()
                .innerRadius(radius + 5)
                .outerRadius(radius + 50)

            var arcHover = d3.arc().
                innerRadius(radius + 5). 
                outerRadius(radius + 55);	

            var containerDiv = document.getElementById('modifier_breakdown')

            var donutContainer = document.createElement('div');
            let donutID = "donut_container_" + i
            donutContainer.setAttribute("class", 'donut-container')
            donutContainer.setAttribute("id", donutID)

            let detectionHeader = document.createElement('h6');
            detectionHeader.setAttribute("style", "text-align: left;")
            detectionHeader.innerText = chart.DetectionType
            donutContainer.appendChild(detectionHeader)

            containerDiv.appendChild(donutContainer)

            // // Create group for donut, center the origin
            const svg = d3.select("#" + donutID)
                .append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform","translate("+(width+10)/2+","+(height+10)/2+")");

            // // Compute the position of each group on the pie:
            var pie = d3.pie()
                .value(function(d){ return d.value.count;});
            var data_ready = pie(d3.entries(stepTacticModifierData))

            var svgContainer = d3.select("#" + donutID)
            var tooltip = svgContainer                    
                .append('div')                                                
                .attr('id', 'tip-' + i)
                .attr('class', 'donut-tooltip');                                                        
            var tooltipLabel =   tooltip.append('div')                                       
                .attr('class', 'label');

            svg
                .selectAll('div')
                .data(data_ready)
                .enter()
                .append('path')
                .attr('d', arc)
                .attr('fill', function(d){ 
                        if ( d.data.value.modifier == 'No Detections' ) return "#f2f2f2";
                        else return colorModifiers(d.data.value.modifier); 
                    })
                .on('mouseover', function(d) {
                        d3.select(this).transition()
                        .duration(500)
                        .attr("d", arcHover);
                        currentTooltip = this.parentNode.parentNode.parentNode.querySelector('.donut-tooltip');
                        currentLabel = currentTooltip.querySelector('.label');
                        currentTooltip.setAttribute("style", "visibility: visible");
                        if (d.data.value.modifier == "No Detections") {
                            currentLabel.innerText = d.data.value.modifier;
                        } else {
                            if(d.data.value.modifier.length < 25)
                                currentLabel.innerHTML = d.data.value.modifier + " - " + d.data.value.count;
                            else {
                                currentLabel.innerHTML = d.data.value.modifier.match(/.{1,25}(\s|$)/g)[0] + "<br>" + 
                                    d.data.value.modifier.match(/.{1,25}(\s|$)/g)[1] + " - " + d.data.value.count;
                            }
                        }
                        $('#tip-' + i)
                            .attr("transform", "translate(" + d3.event.pageX + "px, " + d3.event.pageY + "px)")
                    })
                .on('mouseout', function() {
                        d3.select(this).transition()
                        .duration(500)
                        .attr("d", arc);	
                        currentTooltip = this.parentNode.parentNode.parentNode.querySelector('.donut-tooltip');
                        currentTooltip.setAttribute("style", "visibility: hidden");
                    })
                .attr("stroke", "#FFFFFF")
                .style("stroke-width", "2px")
        }

    }

    function load_step_chart() {
        d3.select("#step_breakdown").select("svg").remove()

        // Pre-Process the data so that we can use it in the stacked bar chart
        // Dimensions for the svg
        let margin = ({top: 10, right: 10, bottom: 110, left: 40})
        if(!stepChartHeight) {
            stepChartHeight = document.getElementById("step_breakdown").clientHeight
            stepChartWidth = document.getElementById("step_breakdown").clientWidth
        }
        // Function to map the x/y axis ticks
        let yAxis = g => g
            .attr("transform", `translate(${margin.left},0)`)
            .call(d3.axisLeft(y).ticks(null, "s"))
        let xAxis = g => g
            .attr("transform", `translate(0,${stepChartHeight - margin.bottom})`)
            .attr("id", "xTicks")
            .call(d3.axisBottom(x).tickSizeOuter(0))

        // Color mapping between detection types and colors
        let color = d3.scaleOrdinal()
            .domain(this.allStepChartDetections)
            .range(this.step_bar_colors)

        // Pre-Process the data so that we can use it in the stacked bar chart
        let chart_steps = []

        for(step of this.steps) {
            data = {}
            data.step = step.Step
            for(detection of this.allStepChartDetections) {
                // Set the counts or 0
                data[detection] = step.Step_Detection_Counts[detection] || 0
            }
            for(step_obj of step_nums_and_names) {
                if (step_obj.step_num == data.step) {
                    data.step_name = step_obj.step_name
                    break;
                }
            }
            chart_steps.push(data)
        }
        // Sift through the filtered detections and remove them
        var displayedDetections = [...this.chart_columns];
        for(disabledDetection of disabledStepChartDetections) {
            if (displayedDetections.includes(disabledDetection)) {
                let removedIndex = displayedDetections.indexOf(disabledDetection);
                displayedDetections.splice(removedIndex, 1);
            }
        }
        chart_steps.columns = displayedDetections

        // Create a stack generator 
        // Stack().keys([keys]) takes an array of strings as an argument and returns the stack generator Slice(1) because we don't want to include "step" as a key
        let stackGenerator = d3.stack().keys(chart_steps.columns.slice(1))
        // Utilize the stack generator to create arrays for each detection
        // These arrays are parallel. 6 arrays (Detections) containing 20 arrays (Steps)
        // Describes the ranges of where the columns are created
        let series = stackGenerator(chart_steps)
                .map(d => (d.forEach(v => v.key = d.key), d))

        stepChartMaxDetections = Math.max(stepChartMaxDetections, d3.max(series, d => d3.max(d, d => d[1])) + 5)

        let y = d3.scaleLinear()
            .domain([0, stepChartMaxDetections])
            .rangeRound([stepChartHeight - margin.bottom, margin.top])

        let x = d3.scaleBand()
            .domain(chart_steps.map(d => d.step))
            .range([margin.left, stepChartWidth - margin.right])
            .padding(0.1)

        function make_y_gridlines() {		
            return d3.axisLeft(y)
                .ticks(10)
        }

        const svg = d3.select("#step_breakdown")
            .append("svg")
            .attr("width", stepChartWidth)
            .attr("height", stepChartHeight)
            .call(responsivefyStep)
            .style("position", "absolute")
            .style("z-index", 1)

        svg.append("g")			
            .attr("class", "grid")
            .call(make_y_gridlines()
                .tickSize(-stepChartWidth)
                .tickFormat("")
            )

        svg.append("g")
            .selectAll("g")
            .data(series)
            .join("g")
                .attr("fill", d => color(d.key))
            .selectAll("rect")
            .data(d => d)
            .join("rect")
                .attr("x", (d, i) => x(d.data.step))
                .attr("y", d => y(d[1]))
                .attr("height", d => y(d[0]) - y(d[1]))
                .attr("width", x.bandwidth())
                .on("mouseover", function() { tooltip.style("display", null); })
                .on("mouseout", function() { tooltip.style("display", "none"); })
                .on("mousemove", function(d) {
                    tooltip.select("#step_header").text(`Step ${d.data.step} - ${d.data.step_name}`);
                    tooltip.select("#step_detection").text(`${d.key}: ${d.data[d.key]}`);
                })
        svg.append("g")
            .call(xAxis);

        svg.append("g")
            .call(yAxis);

        var tooltip = svg.append("g")
            .attr("class", "stackedBarTooltip")
            .style("display", "none");
                
            tooltip.append("rect")
            .attr("x", 50)
            .attr("rx", 5)
            .attr("ry", 5)
            .attr("width", 260)
            .attr("height", 40)
            .attr("fill", "#1d252c")
            .style("opacity", 0.8);

            tooltip.append("text")
            .attr("x", 70)
            .attr("dy", "1.2em")
            .attr("fill", "white")
            .attr("font-size", "12px")
            .attr("font-weight", "bold")
            .attr("id", "step_header");

            tooltip.append("text")
            .attr("x", 70)
            .attr("y", 20)
            .attr("dy", "1.2em")
            .attr("fill", "white")
            .attr("font-size", "12px")
            .attr("font-weight", "bold")
            .attr("id", "step_detection")

        add_step_labels(chart_steps.map(d => d.step_name))
    }

    function add_step_labels(step_names) {
        var xAxis = document.getElementById('xTicks');
        var ticks = xAxis.querySelectorAll('.tick');
        for (const [i, tick] of ticks.entries()) {
            textElement = tick.querySelector('text')
            if(step_names[i].length < 25) {
                textElement.innerHTML = step_names[i].match(/.{1,25}(\s|$)/g)[0]
                textElement.setAttribute("class", "xTickCenter")
            } else {
                textElement.innerHTML = step_names[i].match(/.{1,25}(\s|$)/g)[0]
                textElement.setAttribute("class", "xTickLeft")

                var secondHalfTextElement = textElement.cloneNode(true);
                secondHalfTextElement.innerHTML = step_names[i].match(/.{1,25}(\s|$)/g)[1]
                secondHalfTextElement.setAttribute("class", "xTickRight");
                tick.appendChild(secondHalfTextElement);
            }
        }
    }

    function load_substep_chart() {
        d3.select("#substep_breakdown").select("svg").remove()

        // Pre-Process the data so that we can use it in the stacked bar chart
        // Dimensions for the svg
        let margin = ({top: 10, right: 10, bottom: 50, left: 40})
        let height = document.getElementById("substep_breakdown").clientHeight - 50
        let width = document.getElementById("substep_breakdown").clientWidth
        // Function to map the x/y axis ticks
        let yAxis = g => g
            .attr("transform", `translate(${margin.left},0)`)
            .call(d3.axisLeft(y).ticks(null, "s"))
        let xAxis = g => g
            .attr("transform", `translate(0,${height - margin.bottom})`)
            .call(d3.axisBottom(x).tickSizeOuter(0))
                .selectAll("text")
                    .attr("dx", "-2em")
                    .attr("transform", "rotate(-55)");

        // Color mapping between detection types and colors
        let color = d3.scaleOrdinal()
            .domain(this.allStepChartDetections)
            .range(this.substep_bar_colors)

        // Pre-Process the data so that we can use it in the stacked bar chart
        let chart_substeps = []

        for(step of this.steps) {
            for(substep of step.Substeps) {
                data = {}
                data.substep = substep.Substep
                for(detection of this.allStepChartDetections) {
                    data[detection] = substep.Substep_Detection_Counts[detection] || 0
                }

                chart_substeps.push(data)
            }
        }
        var displayedDetections = [...this.chart_columns];
        for(disabledDetection of disabledSubstepChartDetections) {
            if (displayedDetections.includes(disabledDetection)) {
                let removedIndex = displayedDetections.indexOf(disabledDetection);
                displayedDetections.splice(removedIndex, 1);
            }
        }
        chart_substeps.columns = displayedDetections

        // // Create a stack generator 
        // // Stack().keys([keys]) takes an array of strings as an argument and returns the stack generator Slice(1) because we don't want to include "step" as a key
        let stackGenerator = d3.stack().keys(chart_substeps.columns.slice(1))
        // // Utilize the stack generator to create arrays for each detection
        // // Describes the ranges of where the columns are created
        let series = stackGenerator(chart_substeps)
                .map(d => (d.forEach(v => v.key = d.key), d))

        substepChartMaxDetections = Math.max(substepChartMaxDetections, d3.max(series, d => d3.max(d, d => d[1])) + 5)

        let y = d3.scaleLinear()
            .domain([0, substepChartMaxDetections])
            .rangeRound([height - margin.bottom, margin.top])

        let x = d3.scaleBand()
            .domain(chart_substeps.map(d => d.substep))
            .range([margin.left, width - margin.right])
            .padding(0.1)

        function make_y_gridlines() {		
            return d3.axisLeft(y)
                .ticks(10)
        }


        const svg = d3.select("#substep_breakdown")
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .call(responsivefySubstep)
            .style("position", "absolute")
            .style("z-index", 1)

        svg.append("g")			
            .attr("class", "grid")
            .call(make_y_gridlines()
                .tickSize(-width)
                .tickFormat("")
            )            

        svg.append("g")
            .selectAll("g")
            .data(series)
            .join("g")
                .attr("fill", d => color(d.key))
            .selectAll("rect")
            .data(d => d)
            .join("rect")
                .attr("x", (d, i) => x(d.data.substep))
                .attr("y", d => y(d[1]))
                .attr("height", d => y(d[0]) - y(d[1]))
                .attr("width", x.bandwidth())
                .on("mouseover", function() { tooltip.style("display", null); })
                .on("mouseout", function() { tooltip.style("display", "none"); })
                .on("mousemove", function(d) {
                    tooltip.select("#substep_header").text(`Substep ${d.data.substep}`);
                    tooltip.select("#substep_detection").text(`${d.key}: ${d.data[d.key]}`);
                })
        svg.append("g")
            .call(xAxis);

        svg.append("g")
            .call(yAxis);
        
        var tooltip = svg.append("g")
            .attr("class", "stackedBarTooltip")
            .style("display", "none")
                
            tooltip.append("rect")
            .attr("x", 50)
            .attr("rx", 5)
            .attr("ry", 5)
            .attr("width", 185)
            .attr("height", 50)
            .attr("fill", "#1d252c")
            .style("opacity", 0.8);

            tooltip.append("text")
            .attr("x", 70)
            .attr("dy", "1.2em")
            .attr("fill", "white")
            .attr("font-size", "13px")
            .attr("font-weight", "bold")
            .attr("id", "substep_header");

            tooltip.append("text")
            .attr("x", 70)
            .attr("y", 25)
            .attr("dy", "1.2em")
            .attr("fill", "white")
            .attr("font-size", "13px")
            .attr("font-weight", "bold")
            .attr("id", "substep_detection")
    }

    function responsivefySubstep(svg) {
        var container = d3.select(svg.node().parentNode);
        width = parseInt(svg.style("width"));
        height = parseInt(svg.style("height"));

        svg.attr("viewBox", "0 0 " + width + " " + height)
            .attr("perserveAspectRatio", "xMinYMid")
            .call(resizeChart);
        
        d3.select(window).on("resize." + container.attr("id"), resizeChart);
        
        function resizeChart() {
            var row = document.getElementById("substep_breakdown")
            var targetWidth = row.clientWidth
            svg.attr("width", targetWidth);

            if(targetWidth < 1500 && !substepChartTicksHidden) {
                var ticks = d3.select("#substep_breakdown").selectAll(".tick text");
                ticks.each(function(_,i){
                    if(i%2 !== 0) 
                        d3.select(this).attr("display", "none");
                });
                substepChartTicksHidden = true;
            }
            if(targetWidth >= 1500 && substepChartTicksHidden) {
                var ticks = d3.select("#substep_breakdown").selectAll(".tick text");
                ticks.each(function(_,i){
                    if(i%2 !== 0) 
                        d3.select(this).attr("display", null);
                });
                substepChartTicksHidden = false;
            }

        }
    }


    function responsivefyStep(svg) {
        var container = d3.select(svg.node().parentNode);
        width = parseInt(svg.style("width"));
        height = parseInt(svg.style("height"));

        svg.attr("viewBox", "0 0 " + width + " " + height)
            .attr("perserveAspectRatio", "xMinYMid")
            .call(resize);
        
        d3.select(window).on("resize." + container.attr("id"), resize);
        
        function resize() {
            var row = document.getElementById("step_breakdown")
            var targetWidth = row.clientWidth;
            stepChartWidth = targetWidth;
            svg.attr("width", targetWidth);
        }
    }

</script>

</div>

<footer>
    <div class="container-fluid border-top pt-4 pb-4">
        <div class="row" style="width: 95%; margin: 0 auto;">
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <p class="footer-links-left"><a class="footer-links-left" href="/terms-of-use.html">Terms and Conditions</a></p>
                <p class="footer-links-left"><a class="footer-links-left" href="/privacy.html">Privacy Policy</a></p>
                <p class="footer-links-left">© 2018 - 2021, The MITRE Corporation and MITRE Engenuity.</p>
                <p class="footer-links-left">MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.</p>
            </div>
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <div class="footer-float-right-responsive">
                    <div class="mb-1">
                        <a href="https://twitter.com/MITREengenuity" class="btn btn-footer w-100">
                            <img src="https://d1zq5d3dtjfcoj.cloudfront.net/twitter.png" class="mr-1" style="vertical-align: top" width="20" height="20">
                            <b>@MITREengenuity</b>
                        </a>
                    </div>
                    <div class="">
                        <a href="/contact.html" class="btn btn-footer w-100">
                            Contact
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
    
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    <script src="/theme/scripts/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap.min.js"></script>
    <script src="/theme/scripts/site.js"></script>

    <script src="/theme/scripts/bootstrap-tourist.js"></script>
    
</body>

<!-- jjli -->

</html>