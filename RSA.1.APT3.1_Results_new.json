{"PublicRelease": "\u00a92019 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 18-4019", "Techniques": [{"TechniqueId": "T1126", "TechniqueName": "Network Share Connection Removal", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed net.exe execution and command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-3.png", "ScreenshotCaption": "Telemetry showing net.exe execution and command-line arguments"}]}]}]}, {"TechniqueId": "T1026", "TechniqueName": "Multiband Communication", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over port 443 and to letsencrypt.org (no protocol was identified for this traffic).", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-11-2.png", "ScreenshotCaption": "Telemetry showing network connections, including over port 443 (does not count as a detection)"}]}]}]}, {"TechniqueId": "T1049", "TechniqueName": "System Network Connections Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe running netstat.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-04-1.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments"}]}]}, {"SubStep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-3.png", "ScreenshotCaption": "Telemetry showing netstat.exe with command-line arguments"}]}]}, {"SubStep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed execution of net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-13-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe and command-line arguments"}]}]}, {"SubStep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure due to event suppression (previously detected).", "DetectionType": "None"}]}]}, {"TechniqueId": "T1132", "TechniqueName": "Data Encoding", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-1.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments"}]}]}, {"SubStep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing arp.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-1.png", "ScreenshotCaption": "Telemetry showing arp.exe with command-line arguments"}]}]}, {"SubStep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe running netsh.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-04-1.png", "ScreenshotCaption": "Telemetry showing netsh.exe with command-line arguments"}]}]}, {"SubStep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing route.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing route.exe with command-line arguments"}]}]}, {"SubStep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing ipconfig.exe with command-line arguments"}]}]}, {"SubStep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1039", "TechniqueName": "Data from Network Shared Drive", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing systeminfo.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing systeminfo.exe"}]}]}, {"SubStep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though a floating code \"IIOC\" module alerted with a elevated risk score for DLL injection. An analyst could explore the module and observe multiple components related to jpegs, which may be related to screenshots, but does not show that execution occurred.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-08-4.png", "ScreenshotCaption": "Floating Code module generated from DLL injection showing multiple jpeg components (does not count as a detection)"}]}]}]}, {"TechniqueId": "T1010", "TechniqueName": "Application Window Discovery", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe creating a remote thread into cmd.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-03-2.png", "ScreenshotCaption": "Telemetry showing powershell.exe creating a remote thread into cmd.exe"}]}]}, {"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though a floating code \"IIOC\" module alerted with a elevated risk score for DLL injection. There was no telemetry available for the processes that were injected to verify its relation this procedure.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-08-4.png", "ScreenshotCaption": "Floating Code module generated from DLL injection showing introspection into the module's characteristics (does not count as a detection)"}]}]}]}, {"TechniqueId": "T1061", "TechniqueName": "Graphical User Interface", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1076", "TechniqueName": "Remote Desktop Protocol", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe connecting to 10.0.0.5 (Conficker) over port 3389.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-06-3.png", "ScreenshotCaption": "Telemetry showing cmd.exe connecting over port 3389 (RDP) to 10.0.0.5 (Conficker)"}]}]}, {"SubStep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \"\\\\conficker\\wormshare\"' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing dir with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-08-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing dir with command-line arguments"}]}]}, {"SubStep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing tree with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-08-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe executing tree with command-line arguments"}]}]}, {"SubStep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "Telemetry showed file write of updater.dll.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-07-1.png", "ScreenshotCaption": "Telemetry showing file write event of updater.dll"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-14-1.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}]}]}, {"SubStep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed file write of autoupdate.vbs.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-5.png", "ScreenshotCaption": "Telemetry showing file write of autoupdate.vbs"}]}]}, {"SubStep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "Telemetry showed a write file event for recycler.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-19-1.png", "ScreenshotCaption": "Telemetry showing file write of recycler.exe"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1135", "TechniqueName": "Network Share Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Detections": [{"DetectionNote": "Telemetry showed the execution of ftp.exe with command-line arguments, including ftp.txt, for exfiltration. The contents of ftp.txt was not seen.", "DetectionType": "Telemetry"}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1201", "TechniqueName": "Password Policy Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1007", "TechniqueName": "System Service Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing sc.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-2.png", "ScreenshotCaption": "Telemetry showing sc.exe with command-line arguments"}]}]}, {"SubStep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of sc.exe to query services on 10.0.0.4 (Creeper).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-7.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to query services on 10.0.0.4 (Creeper)"}]}]}, {"SubStep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of sc.exe to query for the AdobeUpdater service on 10.0.0.4 (Creeper).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-7.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to query the AdobeUpdater service on 10.0.0.4 (Creeper)"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Detections": [{"DetectionNote": "Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services was enabled.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Detections": [{"DetectionNote": "Telemetry showed execution of Resume Viewer.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-01-1.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe execution"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing echo with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-1.png", "ScreenshotCaption": "Telemetry showing echo with command-line arguments"}]}]}, {"SubStep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing whoami.exe with command-line arguments"}]}]}, {"SubStep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of whoami.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-20-1.png", "ScreenshotCaption": "Telemetry showing whoami.exe execution"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-4.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}]}]}, {"SubStep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing reg.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-06-1.png", "ScreenshotCaption": "Telemetry showing reg.exe with command-line arguments"}]}]}, {"SubStep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "13.C.1", "Procedure": "Empire:\u00ef\u00bf\u00bd'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed execution of reg.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-13-1.png", "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments"}]}]}, {"SubStep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Detections": [{"DetectionNote": "Telemetry showed reg.exe executing with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing reg.exe execution"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Detections": [{"DetectionNote": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-1.png", "ScreenshotCaption": "Telemetry showing logon attempts targeting ADMIN$ via net.exe and command-line arguments"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting ADMIN$ via net.exe and command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-2.png", "ScreenshotCaption": "Telemetry showing logon attempt targeting ADMIN$ via net.exe and command-line arguments"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting C$ via net.exe and command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-4.png", "ScreenshotCaption": "Telemetry showing logon attempt targeting C$ via net.exe and command-line arguments"}]}]}]}, {"TechniqueId": "T1110", "TechniqueName": "Brute Force", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00ef\u00bf\u00bdKmitnick, Bob, and Frieda", "Detections": [{"DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-1.png", "ScreenshotCaption": "Telemetry showing logon attempts via net.exe and command-line arguments"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Detections": [{"DetectionNote": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-2.png", "ScreenshotCaption": "Telemetry showing logon attempts via net.exe and command-line arguments"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of sc.exe to create a new service called AdobeUpdater with a binPath set to run cmd.exe and execute update.vbs.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-7.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create the AdobeUpdater service"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00ef\u00bf\u00bd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing autoupdate.vbs via wscript.exe as user Kmitnick", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-6.png", "ScreenshotCaption": "Telemetry showing cmd.exe and executing autoupdate.vbs as user Kmitnick"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed a connection to TCP port 80 (no detection showed HTTP specifically).", "DetectionType": "None"}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making a connection over port 443 to freegoogleadsenseinfo.com (C2 domain).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-11-2.png", "ScreenshotCaption": "Telemetry showing network connections, including over port 443"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-14-1.png", "ScreenshotCaption": "Telemetry showing decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}]}]}]}, {"TechniqueId": "T1053", "TechniqueName": "Scheduled Task", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Detections": [{"DetectionNote": "Telemetry showed the execution of schtasks.exe as well as the full command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-07-2.png", "ScreenshotCaption": "Telemetry showing the schtask.exe and command-line arguments"}]}]}, {"SubStep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe executing updater.dll.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-10-2.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing updater.dll"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS3]", "DetectionType": "Telemetry", "Footnotes": ["Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed."]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Detections": [{"DetectionNote": "Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS3]", "DetectionType": "Telemetry", "Footnotes": ["Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed."]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though a floating code \"IIOC\" module alerted with a elevated risk score for DLL injection. An analyst could explore the module and observe the keylogger aggressor script, but this only showed that there is a potential capability of a keylogger, not that execution occurred.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-08-2.png", "ScreenshotCaption": "Floating Code module output showing keylogger aggressor script (does not count as a detection)"}, {"ScreenshotName": "RSA-08-3.png", "ScreenshotCaption": "Floating Code module output showing keylogger key definitions (does not count as a detection)"}]}]}, {"SubStep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1087", "TechniqueName": "Account Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-4.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of sc.exe to create a new service called AdobeUpdater with a binPath set to run cmd.exe and execute update.vbs as well as set the service description. An analyst can use this information to determine the service is masquerading.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-7.png", "ScreenshotCaption": "Telemetry showing execution of sc.exe to create the AdobeUpdater service and set its description"}]}]}, {"SubStep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.[RS30]", "DetectionType": "None", "Footnotes": ["Telemetry later identified recycler.exe as WinRAR during execution, no detections identified it as WinRAR upon file copy."]}]}, {"SubStep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Detections": [{"DetectionNote": "Telemetry showed execution of recycler.exe with full command-line arguments, including -hp flag, indicating compression and encryption was used with a WinRAR utility.[RS4][RS3]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-19-1.png", "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments indicating it is WinRAR"}], "Footnotes": ["Vendor stated file hash is also available that could be used with sources like Virustotal to identify the binary. YARA is also supported and rules could be created to identify WinRAR.", "Vendor stated alert logic exists for many files being accessed in a short period of time, which was not triggered in the evaluation because only one file was accessed."]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Detections": [{"DetectionNote": "Telemetry showed \\\"unregmp2.exe /FirstLogon\\\" (associated with user logon) as well as the user name \\\"Jesse J\\\" within Machine Properties.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-10-3.png", "ScreenshotCaption": "Telemetry showing \\\"unregmp2.exe /FirstLogon\\\" (associated with user logon)"}, {"ScreenshotName": "RSA-10-4.png", "ScreenshotCaption": "Telemetry showing user name \\\"Jesse J\\\" within Machine Properties"}]}]}, {"SubStep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-2.png", "ScreenshotCaption": "Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick"}]}]}, {"SubStep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Detections": [{"DetectionNote": "Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-4.png", "ScreenshotCaption": "Telemetry showing logon attempts via net.exe using valid credentials of user Kmitnick"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of sc.exe to start the AdobeUpdater service on 10.0.0.4 (Creeper). Telemetry on Creeper showed the execution of cmd.exe to run update.vbs.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-16-9.png", "ScreenshotCaption": "Telemetry showing the execution of sc.exe to start the AdobeUpdater service on 10.0.0.4 (Creeper)"}, {"ScreenshotName": "RSA-16-8.png", "ScreenshotCaption": "Telemetry showing the execution of update.vbs on 10.0.0.4 (Creeper)"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "2.C.2 ", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing tasklist.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-1.png", "ScreenshotCaption": "Telemetry showing tasklist.exe with command-line arguments"}, {"ScreenshotName": "RSA-02-2.png", "ScreenshotCaption": "Additional telemetry showing tasklist.exe with command-line arguments"}]}]}, {"SubStep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-1.png", "ScreenshotCaption": "Telemetry showing qprocess.exe with command-line arguments"}]}]}]}, {"TechniqueId": "T1015", "TechniqueName": "Accessibility Features", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Detections": [{"DetectionNote": "Telemetry showed a file write event on magnify.exe in the system directory. A search for \"cmd\" on CodeRed shows the hash value of magnify.exe matches cmd.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing file write to magnify.exe in the system directory"}, {"ScreenshotName": "RSA-17-2.png", "ScreenshotCaption": "Magnify.exe hash matches cmd.exe (top two hashes in Tracking pane, file names and full hash values cut off)"}]}]}, {"SubStep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed execution of magnify.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-20-1.png", "ScreenshotCaption": "Telemetry showing magnify.exe execution"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Detections": [{"DetectionNote": "Telemetry showed connections over TCP port 80 to freegoogleadsenseinfo.com (C2 domain).", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-06-2.png", "ScreenshotCaption": "Telemetry showing TCP port 80 connections to freegoogleadsenseinfo.com (C2 domain)"}]}]}, {"SubStep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed an outbound network connection over port 443 and to letsencrypt.org (no protocol was identified for this traffic).", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-11-2.png", "ScreenshotCaption": "Telemetry showing network connections, including over port 443 (does not count as a detection)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Detections": [{"DetectionNote": "Telemetry showed network connection to 192.168.0.5 (C2 server) over port 8080. Though it does not count as a detection, telemetry also showed an encoded PowerShell command that could be decoded outside the capability to show the IEX command used to download the file (wdbypass) over HTTP port 8080.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-14-2.png", "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"}, {"ScreenshotName": "RSA-14-1.png", "ScreenshotCaption": "Telemetry of decoded PowerShell showing download request over HTTP (does not count as a detection due to decoding outside of capability)"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" -domain' via cmd", "Detections": [{"DetectionNote": "An \"IIOC\" module called \"Enumerates domain administrators\" was generated and provided enrichment.", "DetectionType": "Enrichment", "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "RSA-02-5.png", "ScreenshotCaption": "Event enrichment from IIOC module \\\"Enumerates domain administrators\\\""}]}, {"DetectionNote": "Telemetry showed cmd.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-02-3.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}, {"ScreenshotName": "RSA-02-5.png", "ScreenshotCaption": "Event enrichment from IIOC module \\\"Enumerates domain administrators\\\""}]}]}, {"SubStep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "12.F.1", "Procedure": "Empire: 'net group \"Domain Admins\" -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "12.F.2", "Procedure": "Empire: 'net\u00ef\u00bf\u00bdlocalgroup\u00ef\u00bf\u00bdadministrators' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-2.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though an alert was created for PowerShell with the -enc command-line argument.", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-03-2.png", "ScreenshotCaption": "Alert for powershell.exe execution with encoded command-line arguments (does not count as a detection)"}]}]}, {"SubStep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.D.1", "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure. [RS2]", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-19-3.png", "ScreenshotCaption": "Master file table on 10.0.1.5 (CodeRed) shows old.rar listed under deleted files (does not count as a detection)"}], "Footnotes": ["The master file table on 10.0.1.5 (CodeRed) was\u00a0inspected through the capability to look for deleted files, showing old.rar."]}]}, {"SubStep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe launching rundll32.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-01-1.png", "ScreenshotCaption": "Telemetry showing execution of Resume Viewer.exe"}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}, {"TechniqueId": "T1222", "TechniqueName": "File and Directory Permissions Modification", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Detections": [{"DetectionNote": "Telemetry showed takeown.exe execution to change the file permissions on magnify.exe.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing takeown.exe execution with magnify.exe in command-line arguments"}]}]}, {"SubStep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Detections": [{"DetectionNote": "Telemetry showed icacls.exe execution to change permissions on magnify.exe granting discretionary access to SYSTEM.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-17-1.png", "ScreenshotCaption": "Telemetry showing icacls.exe execution with magnify.exe in command-line arguments"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Detections": [{"DetectionNote": "Telemetry showed a cmd.exe \"rename to executable\" event for autoupdate.bat in the Startup folder.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-01-1.png", "ScreenshotCaption": "Telemetry showing cmd.exe \\\"rename to executable\\\" event for autoupdate.bat in Startup folder"}]}]}, {"SubStep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-10-1.png", "ScreenshotCaption": "Telemetry showing the execution of autoupdate.bat from the Startup Folder"}]}]}]}, {"TechniqueId": "T1064", "TechniqueName": "Scripting", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though telemetry showed the execution sequence of Resume Viewer.exe executing cmd.exe, which executed rundll32.exe (the pdfhelper.cmd script was not shown).", "DetectionType": "None", "Screenshots": [{"ScreenshotName": "RSA-01-1.png", "ScreenshotCaption": "Telemetry showing Resume Viewer.exe execution (does not count as a detection)"}]}]}, {"SubStep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Detections": [{"DetectionNote": "Telemetry showed wscript.exe executing autoupdate.vbs and the subsequent PowerShell child process. [RS1]", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-11-1.png", "ScreenshotCaption": "Telemetry showing the autoupdate.vbs script executed by wscript.exe"}], "Footnotes": [" Vendor says launch command-line argument truncation resulted in PowerShell not being able to be decoded."]}]}, {"SubStep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Detections": [{"DetectionNote": "Telemetry showed PowerShell running and a PowerShell script being written to disk that coincided with the execution of WinEnum.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-12-3.png", "ScreenshotCaption": "Telemetry showing a PowerShell script written to disk"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe running net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-04-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" -domain' via cmd", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe running net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-04-1.png", "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments"}]}]}, {"SubStep": "13.A.1", "Procedure": "Empire: 'net group \"Domain Computers\" -domain' via PowerShell", "Detections": [{"DetectionNote": "Telemetry showed execution of net.exe with command-line arguments.", "DetectionType": "Telemetry", "Screenshots": [{"ScreenshotName": "RSA-13-1.png", "ScreenshotCaption": "Telemetry showing execution of net.exe and command-line arguments"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}, {"SubStep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None"}]}]}]}