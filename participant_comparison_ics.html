<!DOCTYPE html>
<html lang='en'>

<head>
    <script async src='https://www.googletagmanager.com/gtag/js?id=UA-62667723-5'></script><script src='/theme/scripts/analytics.js'></script>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel='shortcut icon' href='https://d1zq5d3dtjfcoj.cloudfront.net/ME_icon.png' type='image/x-icon'>

    <link rel="stylesheet" href="/theme/style/all.css">

    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    
    <title>ATT&CK&reg; EVALUATIONS</title>
    <!-- Bootstrap CSS -->
    <link rel='stylesheet' href='/theme/style/bootstrap.min.css' />
    <link rel='stylesheet' href='/theme/style/bootstrap-glyphicon.min.css' />
    <link href="/theme/style/bootstrap-tourist.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="/theme/style.min.css?780e9fe1">

    <link rel="stylesheet" type="text/css" href="/theme/participant_comparison.min.css?6f416d19">
</head>

<body>
    <header class=''>
        <nav class='navbar navbar-expand-lg navbar-light fixed-top box-shadow-bottom bg-white'>
        <a class='navbar-brand' href='/'><img src='https://d1zq5d3dtjfcoj.cloudfront.net/MITRE_Engenuity_ATTACK-Evaluations_logo_PMS_purple.jpg' height="50px" alt=''></a>
        <button class='navbar-toggler' type='button' data-toggle='collapse' data-target='#navbarCollapse' aria-controls='navbarCollapse' aria-expanded='false' aria-label='Toggle navigation'>
          <span class='navbar-toggler-icon'></span>
        </button>
        <div class='collapse navbar-collapse' id='navbarCollapse'>
          <ul class='nav nav-tabs ml-auto mr-5'>
            <li class="dropdown-submenu ml-3">
               <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Enterprise</strong></a>
                <!-- <ul class="dropdown-menu dropleft"> -->
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href="/methodology-overview">
                            Methodology Overview
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href='/participant_comparison'>Compare Participants</a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href='/technique_comparison'>Explore Techniques</a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 130px;">
                            <li><a class="dropdown-item" href="/enterprise/wizard-spider-and-sandworm/#participants">Participants</a></li>
                            <li><a class="dropdown-item" href="/enterprise/wizard-spider-and-sandworm/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Wizard Spider and <br> Sandworm (2022)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 180px;">
                            <li><a class="dropdown-item" href="/enterprise/participants/?adversaries=carbanak_fin7">Results</a></li>
                            <li><a class="dropdown-item" href="/enterprise/carbanak_fin7/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            Carbanak+FIN7 (2021)
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href="/enterprise/participants/">
                            View All Participants
                        </a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href="/enterprise/evaluations/">
                            View All Evaluations
                        </a>
                    </li>
                </ul>
            </li>

            <li class="dropdown-submenu ml-3">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>ICS</strong></a>
                <ul class="dropdown-menu dropright">
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href='/participant_comparison_ics'>Compare Participants</a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <a class="dropdown-item" href='/technique_comparison_ics'>Explore Techniques</a>
                    </li>
                    <li class="dropdown-item dropdown-submenu2">
                        <ul class="dropdown-menu drop_menu_side_right" style="margin-top: 85px;">
                            <li><a class="dropdown-item" href="/ics/participants/">Results</a></li>
                            <li><a class="dropdown-item" href="/ics/triton/">Overview</a></li>
                        </ul>
                        <a class="dropdown-item dropdown-toggle" data-toggle="dropdown" href="#">
                            TRITON (2021)
                        </a>
                    </li>
                </ul>
            </li>
            <li class='nav-item dropdown ml-3'>
                <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><strong>Resources</strong></a>
                <!-- <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> -->
                    <div class="dropdown-menu dropdown-menu-right">
                        <a class="dropdown-item" href="/using-attack-evaluations">Using ATT&CK Evaluations</a>
                        <a class="dropdown-item" href="https://medium.com/mitre-engenuity/tagged/evaluation" target="_blank"> Blog</strong>&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i> </a>
                        <a class="dropdown-item" href="/about">About ATT&CK</a>
                        <a class="dropdown-item" href="/FAQ">FAQ</a>
                        <a class="dropdown-item" href='https://github.com/center-for-threat-informed-defense/adversary_emulation_library'>
                            Emulation Plan Library 
                            &nbsp;<i class="fas fa-external-link-alt"></i>
                        </a>
                        <a class="dropdown-item" href="https://mitre-engenuity.org/mad/https://mitre-engenuity.org/mad/https://mitre-engenuity.org/mad/">MITRE ATT&CK Defender Training&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i></a>
                        <a class="dropdown-item" href="https://mitre-engenuity.org/ctid/">Center for Threat-Informed Defense&nbsp;&nbsp;<i class="fas fa-external-link-alt"></i></a>
                    </div>  
                </li> 
            <li class='nav-item ml-4'><button class="btn btn-sm btn-engenuity-purple mt-1" onclick="window.location.href='/get-evaluated'">Get Evaluated</button></li>
          </ul>
        </div>
    </nav>
</header>
<div id='content-width-lock'>
    <div id='content'>


<div class='divEvaluationSummaryBody' id='div_vendor_comparison_main'>
    <div class='diff_div_breadcrumbs_tags'>
        <table style='width: 100%;'>
            <tr>
                <td style='width: 50%;'>
                    <div style="padding: 0px; width: 100%;"> 
                        <span class="spanBreadcrumbs-results"> 
                            <a href='/'> Home </a> &nbsp; > &nbsp; Participant Comparison Tool
                        </span>
                    </div>
                </td>
                <td style='width: 50%; text-align: right;'>
                </td>
            </tr>
        </table>
    </div>

    <div class="ml-1 mt-5">
        <p>
            Need help using this tool? Try <a href="#" onclick="start_tour();">taking our tour</a>! 
        </p>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-3 diff_div_user_options">
                <div class="row diff_menu_section">
                    <div class="dropdown">
                        <div class="btn-group" role="group">
                            <button id="btnSelectRound" type="button" class="btn btn-engenuity-purple dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Select Adversary
                            </button>
                            <div class="dropdown-menu" id="round_dropdown" aria-labelledby="btnSelectRound" style="background-color: rgb(98, 65, 197); position: absolute; transform: translate3d(763px, 152px, 0px); top: 0px; left: 0px;" x-placement="bottom-start">  
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row diff_div_vendor_selects diff_menu_section">
                    <h5 style="margin-bottom: 0; line-height: 2;">Compare</h5>
                    <select class="form-control diff_vendor_select" id="diff_vendor1_select" data-column_uid="1"></select>
                    <h5 style="margin-bottom: 0; line-height: 2;">with </h5>
                    <select class="form-control diff_vendor_select" id="diff_vendor2_select" data-column_uid="2"></select>
                </div>
    
                <div class="row diff_div_filters diff_menu_section">
                    <h5 style="margin-bottom: 0; line-height: 2;">Filter by </h5>
                        <select class="form-control diff_filter" id="diff_match_filter" onchange="applyFilters(true);">
                            <option value="all_steps">All steps</option>
                            <option value="diffs">Different steps only</option>
                            <option value="matches">Matched steps only</option>
                        </select>
                        <select class="form-control diff_filter mt-3" id="diff_tactic_filter" onchange="applyFilters(true);">
                        </select>
                </div>
                <div class="row diff_div_filters diff_menu_section_last">
                        <button class="btn btn-engenuity-purple" style="display: block;" id="expand" onclick="open_all_cards(false)"><i class="fas fa-plus-square" style="margin-right: 5px;"></i>Expand All</button>
                        <button class="btn btn-engenuity-purple" style="display: none;" id="collapse" onclick="close_all_cards(false)"><i class="fas fa-minus-square"style="margin-right: 5px;"></i>Collapse All</button>
                </div>

                
            </div>
            <div class="col-9 diff_div_rhs">
                <div class="diff_div_main" id="diff_div_main"></div>
                <a id="scrollUp" href="#" title="Back to top"><i class="fas fa-arrow-alt-circle-up"></i></a>
            </div>
        </div>

    </div>

</div>

<div class="divEvaluationSummaryBody" id="divTourBody" style="display: none;">
    <div class="diff_div_breadcrumbs_tags">
        <table style="width: 100%;">
            <tbody><tr>
                <td style="width: 50%;">
                    <div style="padding: 0px; width: 100%;"> 
                        <span class="spanBreadcrumbs-results"> 
                            <a href="/"> Home </a> &nbsp; &gt; &nbsp; Participant Comparison Tool
                        </span>
                    </div>
                </td>
                <td style="width: 50%; text-align: right;">
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-2 diff_div_user_options">
                <div class="row diff_menu_section">
                    <div class="dropdown">
                        <div class="btn-group" role="group">
                            <button id="btnSelectRound_tour" type="button" class="btn btn-engenuity-purple dropdown-toggle disabled" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Adversary: Tour</button>
                            <div class="dropdown-menu" id="round_dropdown_tour" aria-labelledby="btnSelectRound" style="background-color: rgb(98, 65, 197); position: absolute; transform: translate3d(763px, 152px, 0px); top: 0px; left: 0px;" x-placement="bottom-start">  
                            <a id="APT3_tour" class="dropdown-item" style="color: white" href="javascript:void(0);" onclick="new_round_selected(this.id);">APT3</a><a id="APT29_tour" class="dropdown-item" style="color: white" href="javascript:void(0);" onclick="new_round_selected(this.id);">APT29</a></div>
                        </div>
                    </div>
                </div>
                
                <div class="row diff_div_vendor_selects diff_menu_section">
                    <h5 style="margin-bottom: 0; line-height: 2;">Compare</h5>
                    <select disabled class="form-control diff_vendor_select" id="diff_vendor1_select_tour" data-column_uid="1" onchange="if (this.selectedOptions) vendor_selected(this.selectedOptions[0], false);"><option data-vendorname="Bitdefender" data-displayname="Bitdefender" data-vendortable="v1" value="Bitdefender">Participant A</option><option data-vendorname="CrowdStrike" data-displayname="CrowdStrike" data-vendortable="v1" value="CrowdStrike">Participant B</option></select>
                    <h5 style="margin-bottom: 0; line-height: 2;">with </h5>
                    <select disabled class="form-control diff_vendor_select" id="diff_vendor2_select_tour" data-column_uid="1" onchange="if (this.selectedOptions) vendor_selected(this.selectedOptions[0], false);"><option data-vendorname="CrowdStrike" data-displayname="CrowdStrike" data-vendortable="v1" value="CrowdStrike">Participant B</option></select>
                </div>
    
                <div class="row diff_div_filters diff_menu_section">
                    <h5 style="margin-bottom: 0; line-height: 2;">Filter by </h5>
                        <select disabled class="form-control diff_filter" id="diff_match_filter_tour" onchange="applyFilters(true);">
                            <option value="all_steps">All steps</option>
                            <option value="diffs">Different steps only</option>
                            <option value="matches">Matched steps only</option>
                        </select>
                        <select disabled class="form-control diff_filter mt-3" id="diff_tactic_filter_tour" onchange="applyFilters(true);"><option value="all_tactics">All tactics</option><option value="TA0002" data-tactic_name="Execution">Execution</option><option value="TA0003" data-tactic_name="Persistence">Persistence</option><option value="TA0004" data-tactic_name="Privilege Escalation">Privilege Escalation</option><option value="TA0005" data-tactic_name="Defense Evasion">Defense Evasion</option><option value="TA0006" data-tactic_name="Credential Access">Credential Access</option><option value="TA0007" data-tactic_name="Discovery">Discovery</option><option value="TA0008" data-tactic_name="Lateral Movement">Lateral Movement</option><option value="TA0009" data-tactic_name="Collection">Collection</option><option value="TA0010" data-tactic_name="Exfiltration">Exfiltration</option><option value="TA0011" data-tactic_name="Command and Control">Command and Control</option></select>
                </div>
                <div class="row diff_div_filters diff_menu_section_last">
                        <button class="btn btn-engenuity-purple disabled" style="display: block" id="expand_tour" onclick="open_all_cards(false)"><i class="fas fa-plus-square" style="margin-right: 5px;"></i>Expand All</button>
                        <button class="btn btn-engenuity-purple disabled" style="display: none;" id="collapse_tour" onclick="close_all_cards(false)"><i class="fas fa-minus-square" style="margin-right: 5px;"></i>Collapse All</button>
                </div>

                
            </div>
            <div class="col-10">
                
                <div class="diff_div_main" id="diff_div_main_tour">

                    <div class="diff_div_step_tid_card" id="div_1_A_1_T1032_tour" data-match_status="match" data-tactic_ids="TA0011" style="display: block;">
                        <div class="card w-100" style="border: none;">
                            <div class="card-header hoverpointer card-header-text collapsed" id="div_collapse_header_1_A_1_T1032_tour"
                                data-toggle="collapse" data-target="#div_collapse_body_1_A_1_T1032_tour" aria-expanded="false"
                                aria-controls="div_collapse_body_1_A_1_T1032_tour" onclick="check_expand_status(this);">
                                <h5 class="diff_substep_label">1.A.1</h5>
                                <h5 style="display: inline-block; margin-left: 40px; margin-bottom: 0;">Standard Cryptographic Protocol
                                    (T1032)</h5>
                            </div>
                            <div id="div_collapse_body_1_A_1_T1032_tour" class="collapse"
                                aria-labelledby="div_collapse_header_1_A_1_T1032_tour"
                                style="border-top: 1px solid rgba(0, 0, 0, 0.1);">
                                <table class="diff_step_tid_table" style="margin-bottom: 0px;">
                                    <tr class="tr_diff_row">
                                        <td class="td_diff_cell" style="visibility: hidden; font-size: 12px;">=</td>
                                        <td class="td_diff_proc_crit"><span class="span_proc_crit_title">
                                                <h6>Procedure: </h6>
                                            </span><span class="span_proc_crit">Used RC4 stream cipher to encrypt C2 (192.168.0.5)
                                                traffic</span></td>
                                    </tr>
                                    <tr class="tr_diff_row">
                                        <td class="td_diff_cell" style="visibility: hidden; font-size: 12px;">=</td>
                                        <td class="td_diff_proc_crit"><span class="span_proc_crit_title" style="margin-right:42px;">
                                                <h6>Criteria: </h6>
                                            </span><span class="span_proc_crit">Evidence that the network data sent over the C2 channel
                                                is encrypted</span></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>



                    

                    <div class="diff_div_step_tid_card" id="div_1_A_2_T1028_tour" data-match_status="no_match" data-tactic_ids="TA0002 TA0008" style="display: block;">
                        <div class="card w-100" style="border: none;">
                            <div class="card-header hoverpointer card-header-text-difference collapsed" id="div_collapse_header_1_A_2_T1028_tour"
                                data-toggle="collapse" data-target="#div_collapse_body_1_A_2_T1028_tour" aria-expanded="true"
                                aria-controls="div_collapse_body_1_A_2_T1028_tour" onclick="check_expand_status(this);">
                                <h5 class="diff_substep_label">1.A.2</h5>
                                <h5 style="display: inline-block; margin-left: 40px; margin-bottom: 0;">Windows Remote Management (T1028)
                                </h5>
                            </div>
                            <div id="div_collapse_body_1_A_2_T1028_tour" class="collapse" aria-labelledby="div_collapse_header_1_A_2_T1028_tour"
                                style="border-top: 1px solid rgba(0,0,0,.1);">
                                <table class="diff_step_tid_table" style="margin-bottom: 0px;">
                                    <tr class="tr_diff_row">
                                        <td class="td_diff_cell" style="visibility: hidden; font-size: 12px;">=</td>
                                        <td class="td_diff_proc_crit"><span class="span_proc_crit_title">
                                                <h6>Procedure: </h6>
                                            </span><span class="span_proc_crit">Established WinRM connection to remote host Scranton
                                                (10.0.1.4)</span></td>
                                    </tr>
                                    <tr class="tr_diff_row">
                                        <td class="td_diff_cell" style="visibility: hidden; font-size: 12px;">=</td>
                                        <td class="td_diff_proc_crit"><span class="span_proc_crit_title" style="margin-right:42px;">
                                                <h6>Criteria: </h6>
                                            </span><span class="span_proc_crit">Network connection to Scranton (10.0.1.4) over port
                                                5985</span></td>
                                    </tr>
                                </table>
                                <hr id="card_hr_tour">
                                <table class="diff_step_tid_table" id="diff_table_1_A_2_T1028_tour">
                                    <thead>
                                        <tr class="tr_diff_row">
                                            <th class="th_v1_detection_cell">
                                                <h5 class="sub-h5">Participant A</h5>
                                            </th>
                                            <th class="th_v2_detection_cell">
                                                <h5 class="sub-h5">Participant B</h5>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="tr_diff_row" id="same_tour">
                                            <td class="td_v1_detection_cell">
                                                <div class="card w-100">
                                                    <div class="card-header hover-pointer collapsed" data-toggle="collapse"
                                                        data-target=".detection_3283_body" aria-expanded="false"
                                                        aria-controls="detection_3283_body">
                                                        <h6 class="mb-0">Technique</h6>
                                                        <h6 class="mb-0 sub-h6">Alert</h6>
                                                    </div>
                                                    <div class="detection_3283_body collapse" aria-labelledby="detection_3283_header"
                                                        style="">
                                                        <div class="card-body"><span class="tc_span_detection_note">A Technique alert
                                                                detection (warning severity) called "WinRM Remote Execution" was generated
                                                                due to the execution of wsmprovhost.exe.<a
                                                                    href="https://d1zq5d3dtjfcoj.cloudfront.net/HanSight-APT29-3612.png"
                                                                    target="_blank"><sup>[1]</sup> </a></span></div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td_v2_detection_cell">
                                                <div class="card w-100">
                                                    <div class="card-header hover-pointer collapsed" data-toggle="collapse"
                                                        data-target=".detection_3283_body" aria-expanded="false"
                                                        aria-controls="detection_3283_body">
                                                        <h6 class="mb-0">Technique</h6>
                                                        <h6 class="mb-0 sub-h6">Alert</h6>
                                                    </div>
                                                    <div class="detection_3283_body collapse" aria-labelledby="detection_3283_header"
                                                        style="">
                                                        <div class="card-body"><span class="tc_span_detection_note">A Technique alert
                                                                detection (red indicator) was generated for "Powershell or WinRM remoting
                                                                activity" based on wsmprovhost.exe.</span></div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr class="tr_diff_row" id="different_tour">
                                            <td class="td_v1_detection_cell">
                                                <div class="card w-100">
                                                    <div class="card-header collapsed hover-pointer" data-toggle="collapse"
                                                        data-target=".detection_3285_body" aria-expanded="false"
                                                        aria-controls="detection_3285_body" style="background-color: lightgrey" id="div_detection1_expand_tour1">
                                                        <h6 class="mb-0">Telemetry</h6>
                                                        <h6 class="mb-0 sub-h6" style="visibility: hidden;">placeholder</h6>
                                                    </div>
                                                    <div class="collapse detection_3285_body" aria-labelledby="detection_3285_header" id="div_detection1_expand_tour2">
                                                        <div class="card-body"><span class="tc_span_detection_note">Telemetry showed network
                                                                connection to a remote host over port TCP 1234.</span></div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="td_v2_detection_cell">
                                                <div class="card w-100">
                                                    <div class="card-header collapsed hover-pointer" data-toggle="collapse"
                                                        data-target=".detection_3285_body" aria-expanded="false"
                                                        aria-controls="detection_3285_body" style="background-color: lightgrey" id="div_detection2_expand_tour1">
                                                        <h6 class="mb-0">Telemetry</h6>
                                                        <h6 class="mb-0 sub-h6">Correlated</h6>
                                                    </div>
                                                    <div class="collapse detection_3285_body" aria-labelledby="detection_3285_header" id="div_detection2_expand_tour2">
                                                        <div class="card-body"><span class="tc_span_detection_note">Telemetry showed network
                                                                connection to a remote host over port TCP 1234. The
                                                                detection was correlated to a parent alert.</div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>







                </div>
            </div>
        </div>

    </div>

</div>


<script type="text/javascript">
    var json_data = {
        "TRITON" : {'Round': 1, 'Steps': [{'Substep': '1.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.1.A.1-190.png'}, {'ScreenshotName': 'system-63-MS-D1.1.A.1-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.1.A.1-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.1.A.1-190.png'}, {'ScreenshotName': 'system-66-DR-D1.1.A.1-190-1.png'}, {'ScreenshotName': 'system-66-DR-D1.1.A.1-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.1.A.1-190.png'}, {'ScreenshotName': 'system-67-II-D1.1.A.1-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D1.1.A.1-190.png'}, {'ScreenshotName': 'system-69-CL-D1.1.A.1-190-1.png'}, {'ScreenshotName': 'system-69-CL-D1.1.A.1-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 3389 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) as RDP.'}, {'Substep': '1.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.1.A.2-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.1.A.2-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.1.A.2-190.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 3389 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via the “mstsc.exe” process as RDP. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '2.B.1', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.2.B.1-177.png'}, {'ScreenshotName': 'system-63-MS-D1.2.B.1-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.2.B.1-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.2.B.1-177.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.2.B.1-177.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D1.2.B.1-177.png'}, {'ScreenshotName': 'system-69-CL-D1.2.B.1-177-1.png'}, {'ScreenshotName': 'system-69-CL-D1.2.B.1-177-2.png'}, {'ScreenshotName': 'system-69-CL-D1.2.B.1-177-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated program upload action of the control PLC (10.0.100.110) to collect the current running configuration (requested from the safety EWS [10.0.100.20]). '}, {'Substep': '3.A.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.3.A.1-156.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.3.A.1-156.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.3.A.1-156.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the newly created files copied from the RDP shared folder into the control EWS Temp SMB directory are not legitimate (“SMBClient.exe”, “SMB_Sync.xml”, and “SMB_Update.xml”).'}, {'Substep': '4.A.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.4.A.1-156.png'}, {'ScreenshotName': 'system-63-MS-D1.4.A.1-156-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.4.A.1-156.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.4.A.1-156.png'}, {'ScreenshotName': 'system-66-DR-D1.4.A.1-156-1.png'}, {'ScreenshotName': 'system-66-DR-D1.4.A.1-156-2.png'}, {'ScreenshotName': 'system-66-DR-D1.4.A.1-156-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the scheduled task “SMB_sync.xml” is not legitimate and was imported into Task Scheduler (the task executes a spoofed plink executable to initiate a reverse shell tunnel).'}, {'Substep': '4.B.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.4.B.1-156.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.4.B.1-156.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.4.B.1-156.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.4.B.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the “SMBClient.exe” process is not legitimate (binary is spoofed plink.exe used to create a SSH tunnel and redirect ports).'}, {'Substep': '4.B.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.4.B.2-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.4.B.2-190.png'}, {'ScreenshotName': 'system-64-AR-D1.4.B.2-190-1.png'}, {'ScreenshotName': 'system-64-AR-D1.4.B.2-190-2.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.4.B.2-190.png'}, {'ScreenshotName': 'system-66-DR-D1.4.B.2-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.4.B.2-190.png'}, {'ScreenshotName': 'system-67-II-D1.4.B.2-190-1.png'}, {'ScreenshotName': 'system-67-II-D1.4.B.2-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D1.4.B.2-190.png'}, {'ScreenshotName': 'system-69-CL-D1.4.B.2-190-1.png'}]}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 from the control EWS (10.0.100.20) to the adversary machine (10.0.100.1) as an outbound SSH tunnel request.'}, {'Substep': '4.C.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.4.C.1-190.png'}, {'ScreenshotName': 'system-63-MS-D1.4.C.1-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.4.C.1-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.4.C.1-190.png'}, {'ScreenshotName': 'system-66-DR-D1.4.C.1-190-1.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 3389 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via the “mstsc.exe” process. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '5.A.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.5.A.1-156.png'}, {'ScreenshotName': 'system-63-MS-D1.5.A.1-156-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.5.A.1-156.png'}, {'ScreenshotName': 'system-64-AR-D1.5.A.1-156-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.5.A.1-156.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.5.A.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the newly created files from the extraction of “csp3.zip” in the Temp Rockwell directory are not legitimate (“csp.exe”, “Install-csp.ps1”, “csp-agent.exe”, “sftp.exe”, etc.).'}, {'Substep': '6.A.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.6.A.1-160.png'}, {'ScreenshotName': 'system-63-MS-D1.6.A.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.6.A.1-160.png'}, {'ScreenshotName': 'system-64-AR-D1.6.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.6.A.1-160.png'}, {'ScreenshotName': 'system-66-DR-D1.6.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.6.A.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the “install-csp.ps1” script was executed on the control EWS (10.0.100.20) via PowerShell (using the bypass execution policy). '}, {'Substep': '6.B.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.6.B.1-156.png'}, {'ScreenshotName': 'system-63-MS-D1.6.B.1-156-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.6.B.1-156.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.6.B.1-156.png'}, {'ScreenshotName': 'system-66-DR-D1.6.B.1-156-1.png'}, {'ScreenshotName': 'system-66-DR-D1.6.B.1-156-2.png'}, {'ScreenshotName': 'system-66-DR-D1.6.B.1-156-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.6.B.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the “rockwell-csp3” service is not legitimate (service is spoofed SSDH, created then executed via Start-Service).'}, {'Substep': '6.C.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.6.C.1-156.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.6.C.1-156.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.6.C.1-156.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.6.C.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the “csp-agent” service is not legitimate (service is spoofed ssh-agent, created then executed via Start-Service).'}, {'Substep': '6.D.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.6.D.1-156.png'}, {'ScreenshotName': 'system-63-MS-D1.6.D.1-156-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.6.D.1-156.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_DR_D1.6.D.1.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.6.D.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the scheduled task “SMB_update.xml” is not legitimate and was imported into Task Scheduler (the task executes a spoofed plink executable to initiate a reverse shell tunnel).'}, {'Substep': '6.E.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.6.E.1-156.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.6.E.1-156.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.6.E.1-156.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.6.E.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the “SMBClient.exe” process is not legitimate (binary is spoofed plink.exe used to create a SSH tunnel and redirect ports).'}, {'Substep': '6.E.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D1.6.E.2-190.png'}, {'ScreenshotName': 'system-63-MS-D1.6.E.2-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D1.6.E.2-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D1.6.E.2-190.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D1.6.E.2-190.png'}, {'ScreenshotName': 'system-67-II-D1.6.E.2-190-1.png'}, {'ScreenshotName': 'system-67-II-D1.6.E.2-190-2.png'}, {'ScreenshotName': 'system-67-II-D1.6.E.2-190-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D1.6.E.2-190.png'}]}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 from the control EWS (10.0.100.20) to the adversary machine (10.0.100.1) as an outbound SSH tunnel request.'}, {'Substep': '7.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.7.A.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_AR_D2.7.A.1.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.7.A.1-190.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D2.7.A.1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D2.7.A.1-190.png'}, {'ScreenshotName': 'system-69-CL-D2.7.A.1-190-1.png'}]}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) tunneling SFTP.'}, {'Substep': '7.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.7.A.2-190.png'}, {'ScreenshotName': 'system-63-MS-D2.7.A.2-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.7.A.2-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.7.A.2-190.png'}, {'ScreenshotName': 'system-66-DR-D2.7.A.2-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.7.A.2-190.png'}, {'ScreenshotName': 'system-67-II-D2.7.A.2-190-1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via the “sftp-server.exe” process. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '7.B.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.7.B.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.7.B.1-190.png'}, {'ScreenshotName': 'system-64-AR-D2.7.B.1-190-1.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.7.B.1-190.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D2.7.B.1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D2.7.B.1-190.png'}, {'ScreenshotName': 'system-69-CL-D2.7.B.1-190-1.png'}]}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) tunneling SSH.'}, {'Substep': '7.B.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.7.B.2-190.png'}, {'ScreenshotName': 'system-63-MS-D2.7.B.2-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.7.B.2-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.7.B.2-190.png'}, {'ScreenshotName': 'system-66-DR-D2.7.B.2-190-1.png'}, {'ScreenshotName': 'system-66-DR-D2.7.B.2-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via “csp.exe”[SSHD]. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '8.A.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.8.A.1-156.png'}, {'ScreenshotName': 'system-63-MS-D2.8.A.1-156-1.png'}, {'ScreenshotName': 'system-63-MS-D2.8.A.1-156-2.png'}, {'ScreenshotName': 'system-63-MS-D2.8.A.1-156-3.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.8.A.1-156.png'}, {'ScreenshotName': 'system-64-AR-D2.8.A.1-156-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.8.A.1-156.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.8.A.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the newly created files from the extraction of “RSLINX_install.zip” in the Temp Rockwell RSLINX directory are not legitimate (“RSLINX.exe” and “LogixMap.exe”).'}, {'Substep': '9.A.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.9.A.1-160.png'}, {'ScreenshotName': 'system-63-MS-D2.9.A.1-160-1.png'}, {'ScreenshotName': 'system-63-MS-D2.9.A.1-160-2.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.A.1-160.png'}, {'ScreenshotName': 'system-64-AR-D2.9.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.A.1-160.png'}, {'ScreenshotName': 'system-66-DR-D2.9.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.A.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the LogixMap.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '9.A.2', 'Techniques': [{'TechniqueId': 'T0846', 'TechniqueName': 'Remote System Discovery', 'Tactics': [{'TacticId': 'TA0102', 'TacticName': 'Discovery'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.9.A.2-153.png'}, {'ScreenshotName': 'system-63-MS-D2.9.A.2-153-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.A.2-153.png'}, {'ScreenshotName': 'system-64-AR-D2.9.A.2-153-1.png'}, {'ScreenshotName': 'system-64-AR-D2.9.A.2-153-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.A.2-153.png'}, {'ScreenshotName': 'system-66-DR-D2.9.A.2-153-1.png'}, {'ScreenshotName': 'system-66-DR-D2.9.A.2-153-2.png'}, {'ScreenshotName': 'system-66-DR-D2.9.A.2-153-3.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.A.2-153.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-1.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-2.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-3.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-4.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-5.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-6.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-7.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-8.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-9.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-10.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-11.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-12.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-13.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-14.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-15.png'}, {'ScreenshotName': 'system-67-II-D2.9.A.2-153-16.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D2.9.A.2-153.png'}, {'ScreenshotName': 'system-69-CL-D2.9.A.2-153-1.png'}, {'ScreenshotName': 'system-69-CL-D2.9.A.2-153-2.png'}, {'ScreenshotName': 'system-69-CL-D2.9.A.2-153-3.png'}, {'ScreenshotName': 'system-69-CL-D2.9.A.2-153-4.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that a network discovery scan for TCP port 44818 was initiated from the control EWS (10.0.100.20) on hosts across the whole subnet (10.0.100.1-10.0.100.255).'}, {'Substep': '9.B.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_MS_D2.9.B.1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.B.1-160.png'}, {'ScreenshotName': 'system-64-AR-D2.9.B.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.B.1-160.png'}, {'ScreenshotName': 'system-66-DR-D2.9.B.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.B.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLINX.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '9.B.2', 'Techniques': [{'TechniqueId': 'T0846', 'TechniqueName': 'Remote System Discovery', 'Tactics': [{'TacticId': 'TA0102', 'TacticName': 'Discovery'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.9.B.2-153.png'}, {'ScreenshotName': 'system-63-MS-D2.9.B.2-153-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.B.2-153.png'}, {'ScreenshotName': 'system-64-AR-D2.9.B.2-153-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.B.2-153.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.B.2-153.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D2.9.B.2-153.png'}, {'ScreenshotName': 'system-69-CL-D2.9.B.2-153-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of the network discovery broadcast request sent from the control EWS (10.0.100.15) over TCP port 44818.'}, {'Substep': '9.C.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.9.C.1-160.png'}, {'ScreenshotName': 'system-63-MS-D2.9.C.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.C.1-160.png'}, {'ScreenshotName': 'system-64-AR-D2.9.C.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.C.1-160.png'}, {'ScreenshotName': 'system-66-DR-D2.9.C.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.C.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLINX.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '9.C.2', 'Techniques': [{'TechniqueId': 'T0888', 'TechniqueName': 'Remote System Information Discovery', 'Tactics': [{'TacticId': 'TA0102', 'TacticName': 'Discovery'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.9.C.2-193.png'}, {'ScreenshotName': 'system-63-MS-D2.9.C.2-193-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.C.2-193.png'}, {'ScreenshotName': 'system-64-AR-D2.9.C.2-193-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.C.2-193.png'}, {'ScreenshotName': 'system-66-DR-D2.9.C.2-193-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D2.9.C.2-193.png'}, {'ScreenshotName': 'system-69-CL-D2.9.C.2-193-1.png'}, {'ScreenshotName': 'system-69-CL-D2.9.C.2-193-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated Get Attribute Single CIP request for the “Device Type” attribute (instance 0x01, class 0x01) of the control PLC (10.0.100.110).'}, {'Substep': '9.D.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.9.D.1-160.png'}, {'ScreenshotName': 'system-63-MS-D2.9.D.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.D.1-160.png'}, {'ScreenshotName': 'system-64-AR-D2.9.D.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.D.1-160.png'}, {'ScreenshotName': 'system-66-DR-D2.9.D.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.D.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLINX.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '9.D.2', 'Techniques': [{'TechniqueId': 'T0868', 'TechniqueName': 'Detect Operating Mode', 'Tactics': [{'TacticId': 'TA0100', 'TacticName': 'Collection'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.9.D.2-174.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.D.2-174.png'}, {'ScreenshotName': 'system-64-AR-D2.9.D.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.D.2-174.png'}, {'ScreenshotName': 'system-66-DR-D2.9.D.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.D.2-174.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D2.9.D.2-174.png'}, {'ScreenshotName': 'system-69-CL-D2.9.D.2-174-1.png'}, {'ScreenshotName': 'system-69-CL-D2.9.D.2-174-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated Get Attribute Single CIP request for the “Status” attribute (attribute 0x05, instance 0x01, class 0x01) of the control PLC (10.0.100.110).'}, {'Substep': '9.E.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_MS_D2.9.E.1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.E.1-160.png'}, {'ScreenshotName': 'system-64-AR-D2.9.E.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.E.1-160.png'}, {'ScreenshotName': 'system-66-DR-D2.9.E.1-160-1.png'}, {'ScreenshotName': 'system-66-DR-D2.9.E.1-160-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.E.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLINX.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '9.E.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D2.9.E.2-177.png'}, {'ScreenshotName': 'system-63-MS-D2.9.E.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D2.9.E.2-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D2.9.E.2-177.png'}, {'ScreenshotName': 'system-66-DR-D2.9.E.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D2.9.E.2-177.png'}, {'ScreenshotName': 'system-67-II-D2.9.E.2-177-1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D2.9.E.2-177-4.png'}, {'ScreenshotName': 'system-69-CL-D2.9.E.2-177-5.png'}, {'ScreenshotName': 'system-69-CL-D2.9.E.2-177-6.png'}, {'ScreenshotName': 'system-69-CL-D2.9.E.2-177.png'}, {'ScreenshotName': 'system-69-CL-D2.9.E.2-177-1.png'}, {'ScreenshotName': 'system-69-CL-D2.9.E.2-177-2.png'}, {'ScreenshotName': 'system-69-CL-D2.9.E.2-177-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that all controller and program tag names were requested over CIP from the control PLC (10.0.100.110) to the control EWS (10.0.100.20).'}, {'Substep': '10.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.10.A.1-190.png'}, {'ScreenshotName': 'system-63-MS-D3.10.A.1-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Configuration Change', 'Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.10.A.1-190.png'}, {'ScreenshotName': 'system-64-AR-D3.10.A.1-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.10.A.1-190.png'}, {'ScreenshotName': 'system-66-DR-D3.10.A.1-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D3.10.A.1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.10.A.1-190.png'}]}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the Control EWS (10.0.100.20) tunneling RDP traffic over SSH.'}, {'Substep': '10.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.10.A.2-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.10.A.2-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.10.A.2-190.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.10.A.2-190.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 3389 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via the “mstsc.exe” process as RDP. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '10.B.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.10.B.1-190.png'}, {'ScreenshotName': 'system-63-MS-D3.10.B.1-190-1.png'}, {'ScreenshotName': 'system-63-MS-D3.10.B.1-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.10.B.1-190.png'}, {'ScreenshotName': 'system-66-DR-D3.10.B.1-190-1.png'}, {'ScreenshotName': 'system-66-DR-D3.10.B.1-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.10.B.1-190.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.10.B.1-190.png'}, {'ScreenshotName': 'system-69-CL-D3.10.B.1-190-1.png'}, {'ScreenshotName': 'system-69-CL-D3.10.B.1-190-2.png'}, {'ScreenshotName': 'system-69-CL-D3.10.B.1-190-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 3389 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) as RDP.'}, {'Substep': '10.B.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.10.B.2-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.10.B.2-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.10.B.2-190.png'}, {'ScreenshotName': 'system-66-DR-D3.10.B.2-190-1.png'}, {'ScreenshotName': 'system-66-DR-D3.10.B.2-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 3389 between the control EWS(10.0.100.20) and the safety EWS (10.0.100.15) via the “mstsc.exe” process as RDP. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '11.A.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.11.A.1-156.png'}, {'ScreenshotName': 'system-63-MS-D3.11.A.1-156-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.11.A.1-156.png'}, {'ScreenshotName': 'system-64-AR-D3.11.A.1-156-1.png'}, {'ScreenshotName': 'system-64-AR-D3.11.A.1-156-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.11.A.1-156.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the newly created files from the extraction of “RSLINX_install.zip” in the Temp Rockwell RSLINX directory are not legitimate (“RSLINX.exe” and “LogixMap.exe”).'}, {'Substep': '11.B.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.11.B.1-160.png'}, {'ScreenshotName': 'system-63-MS-D3.11.B.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.11.B.1-160.png'}, {'ScreenshotName': 'system-64-AR-D3.11.B.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.11.B.1-160.png'}, {'ScreenshotName': 'system-66-DR-D3.11.B.1-160-1.png'}, {'ScreenshotName': 'system-66-DR-D3.11.B.1-160-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.11.B.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the “install-csp.ps1” script was executed on the safety EWS (10.0.100.15) via PowerShell (using the bypass execution policy). '}, {'Substep': '11.C.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.11.C.1-156.png'}, {'ScreenshotName': 'system-63-MS-D3.11.C.1-156-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.11.C.1-156.png'}, {'ScreenshotName': 'system-64-AR-D3.11.C.1-156-1.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.11.C.1-156.png'}, {'ScreenshotName': 'system-66-DR-D3.11.C.1-156-1.png'}, {'ScreenshotName': 'system-66-DR-D3.11.C.1-156-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.11.C.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the services “rockwell-csp3” and “csp-agent” are not legitimate (service is spoofed SSDH and ssh-agent underlying, created then executed via Start-Service).'}, {'Substep': '12.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.12.A.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.12.A.1-190.png'}, {'ScreenshotName': 'system-64-AR-D3.12.A.1-190-1.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.12.A.1-190.png'}, {'ScreenshotName': 'system-66-DR-D3.12.A.1-190-1.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D3.12.A.1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.12.A.1-190.png'}]}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) tunneling SSH.'}, {'Substep': '12.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.12.A.2-190.png'}, {'ScreenshotName': 'system-63-MS-D3.12.A.2-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.12.A.2-190.png'}, {'ScreenshotName': 'system-64-AR-D3.12.A.2-190-1.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.12.A.2-190.png'}, {'ScreenshotName': 'system-66-DR-D3.12.A.2-190-1.png'}, {'ScreenshotName': 'system-66-DR-D3.12.A.2-190-2.png'}, {'ScreenshotName': 'system-66-DR-D3.12.A.2-190-3.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via “csp.exe”[SSHD]. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '13.A.1', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.13.A.1-177.png'}, {'ScreenshotName': 'system-63-MS-D3.13.A.1-177-1.png'}, {'ScreenshotName': 'system-63-MS-D3.13.A.1-177-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.13.A.1-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.13.A.1-177.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.13.A.1-177.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.13.A.1-177-8.png'}, {'ScreenshotName': 'system-69-CL-D3.13.A.1-177.png'}, {'ScreenshotName': 'system-69-CL-D3.13.A.1-177-1.png'}, {'ScreenshotName': 'system-69-CL-D3.13.A.1-177-2.png'}, {'ScreenshotName': 'system-69-CL-D3.13.A.1-177-3.png'}, {'ScreenshotName': 'system-69-CL-D3.13.A.1-177-4.png'}, {'ScreenshotName': 'system-69-CL-D3.13.A.1-177-5.png'}, {'ScreenshotName': 'system-69-CL-D3.13.A.1-177-6.png'}, {'ScreenshotName': 'system-69-CL-D3.13.A.1-177-7.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated program upload action of the safety PLC (10.0.100.105) to collect the current running configuration (requested from the safety EWS [10.0.100.15]). '}, {'Substep': '14.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.14.A.1-190.png'}, {'ScreenshotName': 'system-63-MS-D3.14.A.1-190-1.png'}, {'ScreenshotName': 'system-63-MS-D3.14.A.1-190-2.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.14.A.1-190.png'}, {'ScreenshotName': 'system-64-AR-D3.14.A.1-190-1.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_DR_D3.14.A.1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.14.A.1-190.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) via “scp”. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '14.B.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.14.B.1-156.png'}, {'ScreenshotName': 'system-64-AR-D3.14.B.1-156-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.14.B.1-156.png'}, {'ScreenshotName': 'system-66-DR-D3.14.B.1-156-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the newly created files from the extraction of “RSLINX_install.zip” in the Temp Rockwell RSLINX directory are not legitimate (“RSLINX.exe” and “LogixMap.exe”).'}, {'Substep': '15.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.15.A.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.15.A.1-190.png'}, {'ScreenshotName': 'system-64-AR-D3.15.A.1-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.15.A.1-190.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D3.15.A.1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.15.A.1-190.png'}]}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) as SSH.'}, {'Substep': '15.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.15.A.2-190.png'}, {'ScreenshotName': 'system-63-MS-D3.15.A.2-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.15.A.2-190.png'}, {'ScreenshotName': 'system-64-AR-D3.15.A.2-190-1.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.15.A.2-190.png'}, {'ScreenshotName': 'system-66-DR-D3.15.A.2-190-1.png'}, {'ScreenshotName': 'system-66-DR-D3.15.A.2-190-2.png'}, {'ScreenshotName': 'system-66-DR-D3.15.A.2-190-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) via “csp.exe”[SSHD]. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '16.A.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.16.A.1-160.png'}, {'ScreenshotName': 'system-63-MS-D3.16.A.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.16.A.1-160.png'}, {'ScreenshotName': 'system-64-AR-D3.16.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.16.A.1-160.png'}, {'ScreenshotName': 'system-66-DR-D3.16.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.16.A.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '16.A.2', 'Techniques': [{'TechniqueId': 'T0846', 'TechniqueName': 'Remote System Discovery', 'Tactics': [{'TacticId': 'TA0102', 'TacticName': 'Discovery'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.16.A.2-153.png'}, {'ScreenshotName': 'system-63-MS-D3.16.A.2-153-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.16.A.2-153.png'}, {'ScreenshotName': 'system-64-AR-D3.16.A.2-153-1.png'}, {'ScreenshotName': 'system-64-AR-D3.16.A.2-153-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.16.A.2-153.png'}, {'ScreenshotName': 'system-66-DR-D3.16.A.2-153-1.png'}, {'ScreenshotName': 'system-66-DR-D3.16.A.2-153-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.16.A.2-153.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.16.A.2-153.png'}]}]}]}], 'Criteria': 'Evidence of the network discovery broadcast request sent from the safety EWS (10.0.100.15) over TCP port 44818.'}, {'Substep': '16.B.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.16.B.1-160.png'}, {'ScreenshotName': 'system-63-MS-D3.16.B.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.16.B.1-160.png'}, {'ScreenshotName': 'system-64-AR-D3.16.B.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.16.B.1-160.png'}, {'ScreenshotName': 'system-66-DR-D3.16.B.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.16.B.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '16.B.2', 'Techniques': [{'TechniqueId': 'T0888', 'TechniqueName': 'Remote System Information Discovery', 'Tactics': [{'TacticId': 'TA0102', 'TacticName': 'Discovery'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.16.B.2-193.png'}, {'ScreenshotName': 'system-63-MS-D3.16.B.2-193-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.16.B.2-193.png'}, {'ScreenshotName': 'system-66-DR-D3.16.B.2-193-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.16.B.2-193.png'}]}]}]}], 'Criteria': 'Evidence of an adversary initiated Get Attribute Single CIP request for the “Device Type” attribute (instance 0x01, class 0x01) of the safety PLC (10.0.100.105).'}, {'Substep': '16.C.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.16.C.1-160.png'}, {'ScreenshotName': 'system-63-MS-D3.16.C.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.16.C.1-160.png'}, {'ScreenshotName': 'system-64-AR-D3.16.C.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.16.C.1-160.png'}, {'ScreenshotName': 'system-66-DR-D3.16.C.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.16.C.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '16.C.2', 'Techniques': [{'TechniqueId': 'T0868', 'TechniqueName': 'Detect Operating Mode', 'Tactics': [{'TacticId': 'TA0100', 'TacticName': 'Collection'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.16.C.2-174.png'}, {'ScreenshotName': 'system-63-MS-D3.16.C.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.16.C.2-174.png'}, {'ScreenshotName': 'system-66-DR-D3.16.C.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.16.C.2-174.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.16.C.2-174.png'}]}]}]}], 'Criteria': 'Evidence of an adversary initiated Get Attribute Single CIP request for the “Status” attribute (attribute 0x05, instance 0x01, class 0x01) of the safety PLC (10.0.100.105).'}, {'Substep': '16.D.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D3.16.D.1-160.png'}, {'ScreenshotName': 'system-64-AR-D3.16.D.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D3.16.D.1-160.png'}, {'ScreenshotName': 'system-66-DR-D3.16.D.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.16.D.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '16.D.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D3.16.D.2-177.png'}, {'ScreenshotName': 'system-63-MS-D3.16.D.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_DR_D3.16.D.2.png'}, {'ScreenshotName': 'system-66-DR-D3.16.D.2-177.png'}, {'ScreenshotName': 'system-66-DR-D3.16.D.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D3.16.D.2-177.png'}, {'ScreenshotName': 'system-67-II-D3.16.D.2-177-1.png'}, {'ScreenshotName': 'system-67-II-D3.16.D.2-177-2.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D3.16.D.2-177.png'}, {'ScreenshotName': 'system-69-CL-D3.16.D.2-177-1.png'}]}]}]}], 'Criteria': 'Evidence that all controller and program tag names were requested over CIP from the safety PLC (10.0.100.105) to the safety EWS (10.0.100.15).'}, {'Substep': '17.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.17.A.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.17.A.1-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.17.A.1-190.png'}, {'ScreenshotName': 'system-66-DR-D4.17.A.1-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.17.A.1-190.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via the “sftp-server.exe” process. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '17.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.17.A.2-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Configuration Change', 'Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.17.A.2-190.png'}, {'ScreenshotName': 'system-64-AR-D4.17.A.2-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.17.A.2-190.png'}, {'ScreenshotName': 'system-66-DR-D4.17.A.2-190-1.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D4.17.A.2.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D4.17.A.2-190.png'}, {'ScreenshotName': 'system-69-CL-D4.17.A.2-190-1.png'}, {'ScreenshotName': 'system-69-CL-D4.17.A.2-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) tunneling SFTP.'}, {'Substep': '17.B.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.17.B.1-156.png'}, {'ScreenshotName': 'system-63-MS-D4.17.B.1-156-1.png'}, {'ScreenshotName': 'system-63-MS-D4.17.B.1-156-2.png'}, {'ScreenshotName': 'system-63-MS-D4.17.B.1-156-3.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.17.B.1-156.png'}, {'ScreenshotName': 'system-64-AR-D4.17.B.1-156-1.png'}, {'ScreenshotName': 'system-64-AR-D4.17.B.1-156-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.17.B.1-156.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the newly created files from the extraction of “Install_RSLogix.zip” in the Temp Rockwell RSLogix directory are not legitimate (“RSLogix5000.exe”, “RSComms.exe”, etc.)'}, {'Substep': '18.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.18.A.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.18.A.1-190.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.18.A.1-190.png'}, {'ScreenshotName': 'system-66-DR-D4.18.A.1-190-1.png'}, {'ScreenshotName': 'system-66-DR-D4.18.A.1-190-2.png'}, {'ScreenshotName': 'system-66-DR-D4.18.A.1-190-3.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D4.18.A.1-190.png'}, {'ScreenshotName': 'system-69-CL-D4.18.A.1-190-1.png'}, {'ScreenshotName': 'system-69-CL-D4.18.A.1-190-2.png'}, {'ScreenshotName': 'system-69-CL-D4.18.A.1-190-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) to transfer “Install_GuardLogix.zip” over scp.'}, {'Substep': '18.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.18.A.2-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.18.A.2-190.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.18.A.2-190.png'}, {'ScreenshotName': 'system-66-DR-D4.18.A.2-190-1.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.18.A.2-190.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) via “scp”. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '19.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.19.A.1-190.png'}, {'ScreenshotName': 'system-63-MS-D4.19.A.1-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.19.A.1-190.png'}, {'ScreenshotName': 'system-64-AR-D4.19.A.1-190-1.png'}, {'ScreenshotName': 'system-64-AR-D4.19.A.1-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.19.A.1-190.png'}, {'ScreenshotName': 'system-66-DR-D4.19.A.1-190-1.png'}, {'ScreenshotName': 'system-66-DR-D4.19.A.1-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D4.19.A.1-190.png'}, {'ScreenshotName': 'system-69-CL-D4.19.A.1-190-1.png'}, {'ScreenshotName': 'system-69-CL-D4.19.A.1-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) as SSH.'}, {'Substep': '19.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.19.A.2-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.19.A.2-190.png'}, {'ScreenshotName': 'system-64-AR-D4.19.A.2-190-1.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.19.A.2-190.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) via “csp.exe”[SSHD]. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '19.B.1', 'Techniques': [{'TechniqueId': 'T0849', 'TechniqueName': 'Masquerading', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.19.B.1-156.png'}, {'ScreenshotName': 'system-64-AR-D4.19.B.1-156-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.19.B.1-156.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.19.B.1-156.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the newly created files from the extraction of “Install_GuardLogix.zip” in the Temp Rockwell GuardLogix directory are not legitimate (“RSLogix5000.exe”, “RSComms.exe”, “abRSA.exe”, etc.)'}, {'Substep': '20.A.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.20.A.1-160.png'}, {'ScreenshotName': 'system-63-MS-D4.20.A.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.20.A.1-160.png'}, {'ScreenshotName': 'system-64-AR-D4.20.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.20.A.1-160.png'}, {'ScreenshotName': 'system-66-DR-D4.20.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.A.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '20.A.2', 'Techniques': [{'TechniqueId': 'T0868', 'TechniqueName': 'Detect Operating Mode', 'Tactics': [{'TacticId': 'TA0100', 'TacticName': 'Collection'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.20.A.2-174.png'}, {'ScreenshotName': 'system-63-MS-D4.20.A.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.20.A.2-174.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.20.A.2-174.png'}, {'ScreenshotName': 'system-66-DR-D4.20.A.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.A.2-174.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D4.20.A.2-174.png'}, {'ScreenshotName': 'system-69-CL-D4.20.A.2-174-1.png'}, {'ScreenshotName': 'system-69-CL-D4.20.A.2-174-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated Get Attribute Single CIP request for the “Status” attribute (attribute 0x05, instance 0x01, class 0x01) of the safety PLC (10.0.100.105).'}, {'Substep': '20.B.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.20.B.1-160.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.20.B.1-160.png'}, {'ScreenshotName': 'system-64-AR-D4.20.B.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.20.B.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.B.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '20.B.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.20.B.2-177.png'}, {'ScreenshotName': 'system-63-MS-D4.20.B.2-177-1.png'}, {'ScreenshotName': 'system-63-MS-D4.20.B.2-177-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': ['Configuration Change'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.20.B.2-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.20.B.2-177.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.B.2-177.png'}, {'ScreenshotName': 'system-67-II-D4.20.B.2-177-1.png'}, {'ScreenshotName': 'system-67-II-D4.20.B.2-177-2.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D4.20.B.2-177-8.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.2-177.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.2-177-1.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.2-177-2.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.2-177-3.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.2-177-4.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.2-177-5.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.2-177-6.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.2-177-7.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated program upload action of the safety PLC (10.0.100.105) to collect the current running configuration (requested from the safety EWS [10.0.100.15]). '}, {'Substep': '20.B.3', 'Techniques': [{'TechniqueId': 'T0843', 'TechniqueName': 'Program Download', 'Tactics': [{'TacticId': 'TA0109', 'TacticName': 'Lateral Movement'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.20.B.3-150.png'}, {'ScreenshotName': 'system-63-MS-D4.20.B.3-150-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.20.B.3-150.png'}, {'ScreenshotName': 'system-66-DR-D4.20.B.3-150-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.B.3-150.png'}, {'ScreenshotName': 'system-67-II-D4.20.B.3-150-1.png'}, {'ScreenshotName': 'system-67-II-D4.20.B.3-150-2.png'}, {'ScreenshotName': 'system-67-II-D4.20.B.3-150-3.png'}, {'ScreenshotName': 'system-67-II-D4.20.B.3-150-4.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D4.20.B.3-150-2.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.3-150-3.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.3-150-4.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.3-150-5.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.3-150.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.3-150-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated online edit action on the safety PLC (10.0.100.105), requested from the safety EWS (10.0.100.15).'}, {'Substep': '20.B.4', 'Techniques': [{'TechniqueId': 'T0889', 'TechniqueName': 'Modify Program', 'Tactics': [{'TacticId': 'TA0110', 'TacticName': 'Persistence'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D4.20.B.4-194.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.4-194-1.png'}, {'ScreenshotName': 'system-69-CL-D4.20.B.4-194-2.png'}]}]}]}], 'Criteria': 'Evidence of the modified program “P04_Trips_FO_R00_Trips” to include new function block logic and a “CC” tag for command and control on the safety PLC. '}, {'Substep': '20.C.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_MS_D4.20.C.1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.20.C.1-160.png'}, {'ScreenshotName': 'system-64-AR-D4.20.C.1-160-1.png'}, {'ScreenshotName': 'system-64-AR-D4.20.C.1-160-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.20.C.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.C.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSComms.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '20.C.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.20.C.2-177.png'}, {'ScreenshotName': 'system-63-MS-D4.20.C.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.C.2-177-4.png'}, {'ScreenshotName': 'system-67-II-D4.20.C.2-177-5.png'}, {'ScreenshotName': 'system-67-II-D4.20.C.2-177-6.png'}, {'ScreenshotName': 'system-67-II-D4.20.C.2-177.png'}, {'ScreenshotName': 'system-67-II-D4.20.C.2-177-1.png'}, {'ScreenshotName': 'system-67-II-D4.20.C.2-177-2.png'}, {'ScreenshotName': 'system-67-II-D4.20.C.2-177-3.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated read action of the “CC” tag using the 0x4C CIP service.'}, {'Substep': '20.C.3', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.20.C.3-177.png'}, {'ScreenshotName': 'system-63-MS-D4.20.C.3-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.20.C.3-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.C.3-177.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': []}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated write tag action to the “CC” tag using the 0x4D CIP service (a low value of “0” or False was written).'}, {'Substep': '20.D.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_MS_D4.20.D.1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.20.D.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.20.D.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.D.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '20.D.2', 'Techniques': [{'TechniqueId': 'T0868', 'TechniqueName': 'Detect Operating Mode', 'Tactics': [{'TacticId': 'TA0100', 'TacticName': 'Collection'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.20.D.2-174.png'}, {'ScreenshotName': 'system-63-MS-D4.20.D.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.20.D.2-174.png'}, {'ScreenshotName': 'system-64-AR-D4.20.D.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.20.D.2-174.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated Get Attribute Single CIP request for the “Status” attribute (attribute 0x05, instance 0x01, class 0x01) of the control PLC (10.0.100.110).'}, {'Substep': '21.E.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.21.E.1-160.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.21.E.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.21.E.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSComms.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '21.E.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.21.E.2-177.png'}, {'ScreenshotName': 'system-63-MS-D4.21.E.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.21.E.2-177.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of abuse of a CIP handshake between the control EWS and control PLC resulting in an adversary privilege escalation (handshake sequence consisted of a service 0x4B class 0x64 initiation request and 0x4C class 0x64 challenge response).'}, {'Substep': '21.F.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_MS_D4.21.F.1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.21.F.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.21.F.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSComms.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '21.F.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.21.F.2-177.png'}, {'ScreenshotName': 'system-63-MS-D4.21.F.2-177-1.png'}, {'ScreenshotName': 'system-63-MS-D4.21.F.2-177-2.png'}, {'ScreenshotName': 'system-63-MS-D4.21.F.2-177-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.21.F.2-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.21.F.2-177.png'}, {'ScreenshotName': 'system-66-DR-D4.21.F.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': []}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of adversary initiated write tag actions to the “eR01_3ZC2071” and “f3ZC2071_HMI_Enb” tags to change setpoints and control actions using the 0x4D and 0x51 CIP services (the air damper setpoint tag was written to “0” [percent open] and HMI_Enb was pulsed to remove cascade control).'}, {'Substep': '22.A.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.22.A.1-160.png'}, {'ScreenshotName': 'system-64-AR-D4.22.A.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.22.A.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '22.A.2', 'Techniques': [{'TechniqueId': 'T0858', 'TechniqueName': 'Change Operating Mode', 'Tactics': [{'TacticId': 'TA0103', 'TacticName': 'Evasion'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.22.A.2-165.png'}, {'ScreenshotName': 'system-64-AR-D4.22.A.2-165-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.22.A.2-165.png'}, {'ScreenshotName': 'system-66-DR-D4.22.A.2-165-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': []}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of the safety PLC operating mode being switched to Program Mode following adversary CIP request to instance 0x01 of class 0x8E using service 0x07. '}, {'Substep': '22.B.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.22.B.1-160.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.22.B.1-160.png'}, {'ScreenshotName': 'system-64-AR-D4.22.B.1-160-1.png'}, {'ScreenshotName': 'system-64-AR-D4.22.B.1-160-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.22.B.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.22.B.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '22.B.2', 'Techniques': [{'TechniqueId': 'T0843', 'TechniqueName': 'Program Download', 'Tactics': [{'TacticId': 'TA0109', 'TacticName': 'Lateral Movement'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D4.22.B.2-150.png'}, {'ScreenshotName': 'system-63-MS-D4.22.B.2-150-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D4.22.B.2-150.png'}, {'ScreenshotName': 'system-64-AR-D4.22.B.2-150-1.png'}, {'ScreenshotName': 'system-64-AR-D4.22.B.2-150-2.png'}, {'ScreenshotName': 'system-64-AR-D4.22.B.2-150-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D4.22.B.2-150.png'}, {'ScreenshotName': 'system-66-DR-D4.22.B.2-150-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D4.22.B.2-150.png'}, {'ScreenshotName': 'system-67-II-D4.22.B.2-150-1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': []}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated program download action on the safety PLC (10.0.100.105) to overwrite the current configuration (requested from the safety EWS [10.0.100.15]). '}, {'Substep': '23.A.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.23.A.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.23.A.1-190.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.23.A.1-190.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D5.23.A.1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) tunneling SSH.'}, {'Substep': '23.A.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.23.A.2-190.png'}, {'ScreenshotName': 'system-63-MS-D5.23.A.2-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.23.A.2-190.png'}, {'ScreenshotName': 'system-64-AR-D5.23.A.2-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.23.A.2-190.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.23.A.2-190.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via “csp.exe”[SSHD]. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '23.B.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.23.B.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.23.B.1-190.png'}, {'ScreenshotName': 'system-64-AR-D5.23.B.1-190-1.png'}, {'ScreenshotName': 'system-64-AR-D5.23.B.1-190-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.23.B.1-190.png'}, {'ScreenshotName': 'system-66-DR-D5.23.B.1-190-1.png'}, {'ScreenshotName': 'system-66-DR-D5.23.B.1-190-2.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D5.23.B.1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) as SSH.'}, {'Substep': '23.B.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.23.B.2-190.png'}, {'ScreenshotName': 'system-63-MS-D5.23.B.2-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.23.B.2-190.png'}, {'ScreenshotName': 'system-64-AR-D5.23.B.2-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.23.B.2-190.png'}, {'ScreenshotName': 'system-66-DR-D5.23.B.2-190-1.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.23.B.2-190.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 2223 between the control EWS (10.0.100.20) and the safety EWS (10.0.100.15) via “csp.exe”[SSHD]. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '24.A.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.24.A.1-160.png'}, {'ScreenshotName': 'system-63-MS-D5.24.A.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.24.A.1-160.png'}, {'ScreenshotName': 'system-64-AR-D5.24.A.1-160-1.png'}, {'ScreenshotName': 'system-64-AR-D5.24.A.1-160-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.24.A.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.24.A.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '24.A.2', 'Techniques': [{'TechniqueId': 'T0868', 'TechniqueName': 'Detect Operating Mode', 'Tactics': [{'TacticId': 'TA0100', 'TacticName': 'Collection'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.24.A.2-174.png'}, {'ScreenshotName': 'system-63-MS-D5.24.A.2-174-1.png'}, {'ScreenshotName': 'system-63-MS-D5.24.A.2-174-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.24.A.2-174.png'}, {'ScreenshotName': 'system-64-AR-D5.24.A.2-174-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.24.A.2-174.png'}, {'ScreenshotName': 'system-66-DR-D5.24.A.2-174-1.png'}, {'ScreenshotName': 'system-66-DR-D5.24.A.2-174-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.24.A.2-174.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated Get Attribute Single CIP request for the “Status” attribute (attribute 0x05, instance 0x01, class 0x01) of the safety PLC (10.0.100.105).'}, {'Substep': '24.B.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.24.B.1-160.png'}, {'ScreenshotName': 'system-63-MS-D5.24.B.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.24.B.1-160.png'}, {'ScreenshotName': 'system-64-AR-D5.24.B.1-160-1.png'}, {'ScreenshotName': 'system-64-AR-D5.24.B.1-160-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.24.B.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.24.B.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSLogix5000.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '24.B.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.24.B.2-177.png'}, {'ScreenshotName': 'system-63-MS-D5.24.B.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.24.B.2-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.24.B.2-177.png'}, {'ScreenshotName': 'system-66-DR-D5.24.B.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.24.B.2-177.png'}, {'ScreenshotName': 'system-67-II-D5.24.B.2-177-1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated program upload action of the safety PLC (10.0.100.105) to collect the current running configuration (requested from the safety EWS [10.0.100.15]). '}, {'Substep': '24.B.3', 'Techniques': [{'TechniqueId': 'T0843', 'TechniqueName': 'Program Download', 'Tactics': [{'TacticId': 'TA0109', 'TacticName': 'Lateral Movement'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Tactic', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.24.B.3-150-2.png'}, {'ScreenshotName': 'system-63-MS-D5.24.B.3-150-3.png'}, {'ScreenshotName': 'system-63-MS-D5.24.B.3-150-4.png'}, {'ScreenshotName': 'system-63-MS-D5.24.B.3-150-5.png'}, {'ScreenshotName': 'system-63-MS-D5.24.B.3-150.png'}, {'ScreenshotName': 'system-63-MS-D5.24.B.3-150-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.24.B.3-150.png'}, {'ScreenshotName': 'system-64-AR-D5.24.B.3-150-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.24.B.3-150.png'}, {'ScreenshotName': 'system-66-DR-D5.24.B.3-150-1.png'}, {'ScreenshotName': 'system-66-DR-D5.24.B.3-150-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.24.B.3-150.png'}, {'ScreenshotName': 'system-67-II-D5.24.B.3-150-1.png'}, {'ScreenshotName': 'system-67-II-D5.24.B.3-150-2.png'}, {'ScreenshotName': 'system-67-II-D5.24.B.3-150-3.png'}, {'ScreenshotName': 'system-67-II-D5.24.B.3-150-4.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.24.B.3-150.png'}, {'ScreenshotName': 'system-69-CL-D5.24.B.3-150-1.png'}, {'ScreenshotName': 'system-69-CL-D5.24.B.3-150-2.png'}, {'ScreenshotName': 'system-69-CL-D5.24.B.3-150-3.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an adversary initiated online edit action on the safety PLC (10.0.100.105), requested from the safety EWS (10.0.100.15).'}, {'Substep': '24.B.4', 'Techniques': [{'TechniqueId': 'T0889', 'TechniqueName': 'Modify Program', 'Tactics': [{'TacticId': 'TA0110', 'TacticName': 'Persistence'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.24.B.4-194.png'}, {'ScreenshotName': 'system-69-CL-D5.24.B.4-194-1.png'}, {'ScreenshotName': 'system-69-CL-D5.24.B.4-194-2.png'}]}]}]}], 'Criteria': 'Evidence of the modified program “P04_Trips_FO_R00_Trips” to include new function block logic and a “CC” tag for command and control on the safety PLC. '}, {'Substep': '24.C.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.24.C.1-160.png'}, {'ScreenshotName': 'system-63-MS-D5.24.C.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.24.C.1-160.png'}, {'ScreenshotName': 'system-64-AR-D5.24.C.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.24.C.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.24.C.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSComms.exe payload was executed on the safety EWS (10.0.100.15).'}, {'Substep': '24.C.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.24.C.2-177.png'}, {'ScreenshotName': 'system-63-MS-D5.24.C.2-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.24.C.2-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.24.C.2-177.png'}, {'ScreenshotName': 'system-67-II-D5.24.C.2-177-1.png'}, {'ScreenshotName': 'system-67-II-D5.24.C.2-177-2.png'}, {'ScreenshotName': 'system-67-II-D5.24.C.2-177-3.png'}, {'ScreenshotName': 'system-67-II-D5.24.C.2-177-4.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.24.C.2-177.png'}]}]}]}], 'Criteria': 'Evidence of an adversary initiated read action of the “CC” tag using the 0x4C CIP service.'}, {'Substep': '24.C.3', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.24.C.3-177.png'}, {'ScreenshotName': 'system-63-MS-D5.24.C.3-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.24.C.3-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.24.C.3-177.png'}]}]}]}], 'Criteria': 'Evidence of an adversary initiated write tag action to the “CC” tag using the 0x4D CIP service (a low value of “1” or True was written).'}, {'Substep': '25.D.1', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.D.1-190.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.25.D.1-190.png'}, {'ScreenshotName': 'system-64-AR-D5.25.D.1-190-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.25.D.1-190.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_II_D5.25.D.1.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.25.D.1-190.png'}]}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) as SSH.'}, {'Substep': '25.D.2', 'Techniques': [{'TechniqueId': 'T0885', 'TechniqueName': 'Commonly Used Port', 'Tactics': [{'TacticId': 'TA0101', 'TacticName': 'Command and Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.D.2-190.png'}, {'ScreenshotName': 'system-63-MS-D5.25.D.2-190-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_AR_D5.25.D.2.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.25.D.2-190.png'}, {'ScreenshotName': 'system-66-DR-D5.25.D.2-190-1.png'}, {'ScreenshotName': 'system-66-DR-D5.25.D.2-190-2.png'}, {'ScreenshotName': 'system-66-DR-D5.25.D.2-190-3.png'}, {'ScreenshotName': 'system-66-DR-D5.25.D.2-190-4.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of an established network connection over TCP port 445 between the adversary machine (10.0.100.1) and the control EWS (10.0.100.20) via “csp.exe”[SSHD]. Successful logon as user “Engineer” may be present or as a part of the connection and process creation.'}, {'Substep': '25.E.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.E.1-160.png'}, {'ScreenshotName': 'system-63-MS-D5.25.E.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.25.E.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.25.E.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.25.E.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSComms.exe payload was executed on the control EWS (10.0.100.15).'}, {'Substep': '25.E.2', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.E.2-177.png'}, {'ScreenshotName': 'system-63-MS-D5.25.E.2-177-1.png'}, {'ScreenshotName': 'system-63-MS-D5.25.E.2-177-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of abuse of a CIP handshake between the control EWS and control PLC resulting in an adversary privilege escalation (handshake sequence consisted of a service 0x4B class 0x64 initiation request and 0x4C class 0x64 challenge response).'}, {'Substep': '25.E.3', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.E.3-177.png'}, {'ScreenshotName': 'system-63-MS-D5.25.E.3-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.25.E.3-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'TRITON_DR_D5.25.E.3.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.25.E.3-177-2.png'}, {'ScreenshotName': 'system-69-CL-D5.25.E.3-177-3.png'}, {'ScreenshotName': 'system-69-CL-D5.25.E.3-177-4.png'}, {'ScreenshotName': 'system-69-CL-D5.25.E.3-177-5.png'}, {'ScreenshotName': 'system-69-CL-D5.25.E.3-177.png'}, {'ScreenshotName': 'system-69-CL-D5.25.E.3-177-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of adversary initiated write tag actions to the “eR01_3ZC2071” and “f3ZC2071_HMI_Enb” tags to change setpoints and control actions using the 0x4D and 0x51 CIP services (the air damper setpoint tag was written to “0” [percent open] and HMI_Enb was pulsed to remove cascade control).'}, {'Substep': '25.F.1', 'Techniques': [{'TechniqueId': 'T0880', 'TechniqueName': 'Loss of Safety', 'Tactics': [{'TacticId': 'TA0105', 'TacticName': 'Impact'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.F.1-185.png'}, {'ScreenshotName': 'system-63-MS-D5.25.F.1-185-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.25.F.1-185.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.25.F.1-185.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.25.F.1-185-4.png'}, {'ScreenshotName': 'system-67-II-D5.25.F.1-185-5.png'}, {'ScreenshotName': 'system-67-II-D5.25.F.1-185-6.png'}, {'ScreenshotName': 'system-67-II-D5.25.F.1-185.png'}, {'ScreenshotName': 'system-67-II-D5.25.F.1-185-1.png'}, {'ScreenshotName': 'system-67-II-D5.25.F.1-185-2.png'}, {'ScreenshotName': 'system-67-II-D5.25.F.1-185-3.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of the safety HMI (10.0.100.16) writing to the safety PLC (10.0.100.105). Manual trip actions were engaged through onsite access by process operators on the HMI to disable the burner management system. '}, {'Substep': '25.G.1', 'Techniques': [{'TechniqueId': 'T0853', 'TechniqueName': 'Scripting', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.G.1-160.png'}, {'ScreenshotName': 'system-63-MS-D5.25.G.1-160-1.png'}]}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': ['Correlated'], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.25.G.1-160.png'}, {'ScreenshotName': 'system-64-AR-D5.25.G.1-160-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.25.G.1-160.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-67-II-D5.25.G.1-160.png'}]}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'N/A', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that the RSComms.exe payload was executed on the control EWS (10.0.100.20).'}, {'Substep': '25.G.2', 'Techniques': [{'TechniqueId': 'T0855', 'TechniqueName': 'Unauthorized Command Message', 'Tactics': [{'TacticId': 'TA0106', 'TacticName': 'Impair Process Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.G.2-162.png'}, {'ScreenshotName': 'system-63-MS-D5.25.G.2-162-1.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.25.G.2-162.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Technique', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.25.G.2-162.png'}, {'ScreenshotName': 'system-69-CL-D5.25.G.2-162-1.png'}, {'ScreenshotName': 'system-69-CL-D5.25.G.2-162-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence of a privileged write or force point action being used to overwrite polled tag values on the control PLC when the adversary initiated the CIP service 0x51 within the class 0x6A. The tags associated with the Ignitor (3XY2070) and Flame Sensor (3HS2070) were the target of these actions.'}, {'Substep': '25.G.3', 'Techniques': [{'TechniqueId': 'T0871', 'TechniqueName': 'Execution through API', 'Tactics': [{'TacticId': 'TA0104', 'TacticName': 'Execution'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-64-AR-D5.25.G.3-177.png'}]}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.25.G.3-177.png'}]}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.25.G.3-177.png'}]}]}]}], 'Criteria': 'Evidence of write actions occurring on the tags “eR01_3ZC2071” and “f3ZC2071_HMI_Enb” to change setpoints and control actions with the CIP service 0x4D and service 0x51, respectively. HMI_Enb was pulsed to remove cascade control and the air damper setpoint tag was written to “100” [percent open].'}, {'Substep': '25.G.4', 'Techniques': [{'TechniqueId': 'T0855', 'TechniqueName': 'Unauthorized Command Message', 'Tactics': [{'TacticId': 'TA0106', 'TacticName': 'Impair Process Control'}], 'Participants': [{'ParticipantName': 'Microsoft', 'DisplayName': 'Microsoft', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-63-MS-D5.25.G.4-162.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'armis', 'DisplayName': 'Armis', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'dragos', 'DisplayName': 'Dragos', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-66-DR-D5.25.G.4-162.png'}, {'ScreenshotName': 'system-66-DR-D5.25.G.4-162-1.png'}, {'ScreenshotName': 'system-66-DR-D5.25.G.4-162-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'iii', 'DisplayName': 'Institute for Information Industry', 'Detections': [{'DetectionType': 'None', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}, {'ParticipantName': 'claroty', 'DisplayName': 'Claroty', 'Detections': [{'DetectionType': 'General', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': [{'ScreenshotName': 'system-69-CL-D5.25.G.4-162.png'}, {'ScreenshotName': 'system-69-CL-D5.25.G.4-162-1.png'}, {'ScreenshotName': 'system-69-CL-D5.25.G.4-162-2.png'}]}, {'DetectionType': 'Telemetry', 'DetectionNote': '', 'Modifiers': [], 'Footnotes': [], 'Screenshots': []}]}]}], 'Criteria': 'Evidence that a privileged write action occurred and actuated all forced points set in the logic (Enable all forces in Allen Bradley) following the adversary request the class 0x69 using service 0x4D. '}]}
    };

    var current_round = 'TRITON';
    var selected_round;
    var all_vendors_in_round = [];
    var all_vendors_in_round_lwr = [];
    var vendor_display_names = [];
    var vendor1_selected = false;
    var vendor2_selected = false;
    var global_vendor1 = {};
    var global_vendor2 = {};
    var detection_row_uid = 0;      // All detections rows are unique
    var original_query_string_options = {};
    var load_from_query_string = false;
    var card_open_status = false;

    document.onload = load_initial();

    function load_initial() {
        var round_info = {'TRITON': 'public'};

        set_original_query_string_options();

        load_rounds_dropdown(round_info);

        if (selected_round == 'TRITON') {
            load_round(selected_round);
        }
        else {
            selected_round = current_round;
            load_round(current_round);
        }
    }

    window.addEventListener('popstate', function (event) {
        window.location = window.location.href;
    });

    function set_original_query_string_options () {
        var url_string = window.location.href;
        var url_obj = new URL(url_string);

        selected_round = url_obj.searchParams.get("adversary");
        if (selected_round != undefined ) {
            if (selected_round == 'TRITON') selected_round = 'TRITON'
            else selected_round = selected_round.toUpperCase();
        }
        
        if (url_obj.searchParams.get("participants")) {
            var vendors = url_obj.searchParams.get("participants").split(",");
            original_query_string_options["vendor1"] = vendors[0];
            original_query_string_options["vendor2"] = vendors[1];
            load_from_query_string = true;
        }

        if (url_obj.searchParams.get("steps")) {
            original_query_string_options["steps"] = url_obj.searchParams.get("steps");
            load_from_query_string = true;
        }

        if (url_obj.searchParams.get("tactic")) {
            original_query_string_options["tactic"] = url_obj.searchParams.get("tactic");
            load_from_query_string = true;
        }

        if (url_obj.searchParams.get("cards_open")) {
            original_query_string_options["cards_open"] = url_obj.searchParams.get("cards_open");
            load_from_query_string = true;
        }
    }

    function load_rounds_dropdown(round_info) {
        var dropdown = document.getElementById("round_dropdown");
        for (const [round, status] of Object.entries(round_info)) {
            if (status == "public") {
                var dropitem = document.createElement("a");
                dropitem.appendChild(document.createTextNode(round));
                dropitem.setAttribute("id", round);
                dropitem.setAttribute("class", "dropdown-item");
                dropitem.setAttribute("style", "color: white");
                dropitem.setAttribute("href", "javascript:void(0);");
                dropitem.setAttribute("onclick", "new_round_selected(this.id);");
                dropdown.appendChild(dropitem);                
            }
        }
    }    

    function load_round(round) {
        var vendors_str;
        var vendors;
        var step_to_load;
        var tactics_in_round = [];

        // Set the dropdown button text to the URL Specified round
        btnSelectRound = document.getElementById("btnSelectRound");
        btnSelectRound.innerHTML = "Adversary: " + round;

        // Load the dropdown options for vendor select with the vendors from that round
        load_vendor_select_dropdowns(round);

        // Load the substep, techniques, procedure, and criteria for the round
        var steps = json_data[round].Steps;
        var div_main = document.getElementById("diff_div_main");

        // Clear the contents of the div to prepare for new round's data.
        div_main.innerHTML = "";

        for (step of steps) {
            let current_substep = step.Substep;
            let current_procedure = step.Procedure;
            let current_criteria = step.Criteria;
            let technique_id = step.Techniques[0].TechniqueId;
            let technique_name = step.Techniques[0].TechniqueName;
            // let step_tid = (current_substep + "_" + technique_id).replaceAll(".", "_");
            let step_tid = custom_replaceAll((current_substep + "_" + technique_id), ".", "_");
            let tactics = step.Techniques[0].Tactics;
            let tactic_ids = "";

            for (tactic_obj of tactics) {
                tactics_in_round.push(tactic_obj);
                tactic_ids += tactic_obj.TacticId + " ";
            }

            // Create a card for each step_tid
            var step_tid_card = document.createElement("div");
            step_tid_card.setAttribute("class", "diff_div_step_tid_card");
            step_tid_card.setAttribute("id", "div_" + step_tid);
            step_tid_card.setAttribute("data-match_status", "match");
            step_tid_card.setAttribute("data-tactic_ids", tactic_ids);

            // Create collapse/expand card for procedure/criteria and diff details
            var div_collapse_card = document.createElement("div");
            div_collapse_card.setAttribute("class", "card w-100");
            div_collapse_card.setAttribute("style", "border: none;");
            var div_collapse_header = document.createElement("div");
            // div_collapse_header.setAttribute("class", "card-header collapsed hoverpointer");
            div_collapse_header.setAttribute("class", "card-header collapsed hoverpointer card-header-text");
            div_collapse_header.setAttribute("id", "div_collapse_header_" + step_tid);
            // div_collapse_header.setAttribute("style", "background-color: white; border: none;");
            div_collapse_header.setAttribute("data-toggle", "collapse");
            div_collapse_header.setAttribute("data-target", "#div_collapse_body_" + step_tid);
            div_collapse_header.setAttribute("aria-expanded", "false");
            div_collapse_header.setAttribute("aria-controls", "div_collapse_body_" + step_tid);
            div_collapse_header.setAttribute("onclick", "check_expand_status(this);");


            // Create step title for header
            var substep_label = document.createElement("h5");
            substep_label.setAttribute("class", "diff_substep_label");
            substep_label.appendChild(document.createTextNode(current_substep));
            div_collapse_header.appendChild(substep_label);

            // Create Technique/TID label for header
            var technique_tid_label = document.createElement("h5");
            technique_tid_label.setAttribute("style", "display: inline-block; margin-left: 40px; margin-bottom: 0;");
            technique_tid_label.appendChild(document.createTextNode(technique_name + " (" + technique_id + ")"));
            div_collapse_header.appendChild(technique_tid_label);

            var div_collapse_body = document.createElement("div");
            div_collapse_body.setAttribute("id", "div_collapse_body_" + step_tid);
            div_collapse_body.setAttribute("class", "collapse");
            div_collapse_body.setAttribute("aria-labelledby", "div_collapse_header_" + step_tid);
            div_collapse_body.setAttribute("style", "border-top: 1px solid rgba(0,0,0,.1);");

            div_collapse_card.appendChild(div_collapse_header);
            div_collapse_card.appendChild(div_collapse_body);
            step_tid_card.appendChild(div_collapse_card);
            
            // Create table for aligning procedure/criteria with diff table
            var table_proc_crit = document.createElement("table");
            var tr_proc = document.createElement("tr");
            var td_diff_placeholder1 = document.createElement("td");
            var td_proc = document.createElement("td");
            var tr_crit = document.createElement("tr");
            var td_diff_placeholder2 = document.createElement("td");
            var td_crit = document.createElement("td");
            
            table_proc_crit.setAttribute("class", "diff_step_tid_table");
            table_proc_crit.setAttribute("style", "margin-bottom: 0px;");
            tr_proc.setAttribute("class", "tr_diff_row");
            tr_crit.setAttribute("class", "tr_diff_row");
            td_diff_placeholder1.setAttribute("class", "td_diff_cell");
            td_diff_placeholder2.setAttribute("class", "td_diff_cell");
            td_diff_placeholder1.setAttribute("style", "visibility: hidden; font-size: 12px;");
            td_diff_placeholder2.setAttribute("style", "visibility: hidden; font-size: 12px;");
            td_diff_placeholder1.appendChild(document.createTextNode("="));
            td_diff_placeholder2.appendChild(document.createTextNode("="));
            td_proc.setAttribute("class", "td_diff_proc_crit");
            td_crit.setAttribute("class", "td_diff_proc_crit");

            // Create Procedure Label
            if(current_procedure) {
                var procedure_h6 = document.createElement("h6");
                procedure_h6.innerText = "Procedure: " + current_procedure;
                var procedure_label = document.createElement("span");
                procedure_label.appendChild(procedure_h6);
                procedure_label.setAttribute("class", "span_proc_crit_title");
                td_proc.appendChild(procedure_label);
                tr_proc.appendChild(td_diff_placeholder1);
                tr_proc.appendChild(td_proc);
                table_proc_crit.appendChild(tr_proc);
            }

            // Create Criteria Label
            if (selected_round != "TRITON") {
                var criteria_h6 = document.createElement("h6");
                criteria_h6.innerText = "Criteria: " + current_criteria;
                var criteria_label = document.createElement("span");
                criteria_label.appendChild(criteria_h6);
                criteria_label.setAttribute("class", "span_proc_crit_title");
                criteria_label.setAttribute("style", "margin-right:42px;");
                
                td_crit.appendChild(criteria_label);
                tr_crit.appendChild(td_diff_placeholder2);
                tr_crit.appendChild(td_crit);
                table_proc_crit.appendChild(tr_crit);
            }
            div_collapse_body.appendChild(table_proc_crit);
            div_main.appendChild(step_tid_card);
        }

        load_tactics_filter_options(tactics_in_round);

        // If there's a query string, load the parameters
        if (load_from_query_string) {
            if (original_query_string_options["cards_open"]) {
                card_open_status = original_query_string_options["cards_open"]
                if (original_query_string_options["cards_open"] == "true") {
                    open_all_cards(false);
                } else {
                    close_all_cards(false);
                }
            }

            if (original_query_string_options["steps"]) {
                var match_filter = document.getElementById("diff_match_filter");
                
                for (var i = 0;  i < match_filter.children.length; i++) {
                    if (match_filter.children[i].value == original_query_string_options["steps"]) {
                        match_filter.selectedIndex = i;
                    }
                }
            }

            if (original_query_string_options["tactic"]) {
                var tactic_filter = document.getElementById("diff_tactic_filter");

                for (var i = 0;  i < tactic_filter.children.length; i++) {
                    if (tactic_filter.children[i].value == original_query_string_options["tactic"]) {
                        tactic_filter.selectedIndex = i;
                    }
                }
            }

            // This is called after vendor_selected already
            // applyFilters();

            if (original_query_string_options["vendor1"] && original_query_string_options["vendor2"]) {

                // Set the vendor select dropdowns
                var v1_select = document.getElementById("diff_vendor1_select");
                var v2_select = document.getElementById("diff_vendor2_select");

                for (var i = 0; i < v1_select.children.length; i++) {
                    if (v1_select.children[i].getAttribute("data-vendorname") == original_query_string_options["vendor1"]) {
                        v1_select.selectedIndex = i;
                        vendor_selected(v1_select.children[i], true);
                        break;
                    }
                }

                for (var i = 0; i < v2_select.children.length; i++) {
                    if (v2_select.children[i].getAttribute("data-vendorname") == original_query_string_options["vendor2"]) {
                        v2_select.selectedIndex = i;
                        last_selected_option = v2_select.children[i];
                        vendor_selected(v2_select.children[i], true);
                        break;
                    }
                }
            }

            load_from_query_string = false;
        }
    }

    function new_round_selected(round) {
        // Reset to allow reloading of vendors that participated in the new round (for dropdowns)
        all_vendors_in_round = [];
        all_vendors_in_round_lwr = [];
        vendor_display_names = [];

        vendor1_selected = false;
        vendor2_selected = false;
        global_vendor1 = {};
        global_vendor2 = {};

        // Reset filters
        document.getElementById("diff_match_filter").selectedIndex = 0;
        document.getElementById("diff_tactic_filter").selectedIndex = 0;

        // Disable Match filter until two vendors are selected
        document.getElementById("diff_match_filter").disabled = true;

        selected_round = round;

        update_url(true);

        load_round(selected_round, null);
    }

    function load_vendor_select_dropdowns(round) {
        var v1_select = document.getElementById("diff_vendor1_select");
        var v2_select = document.getElementById("diff_vendor2_select");
        var vendors_from_round = json_data[round].Steps[0].Techniques[0].Participants;

        v1_select.setAttribute("onchange", "if (this.selectedOptions) vendor_selected(this.selectedOptions[0], false);");
        v2_select.setAttribute("onchange", "if (this.selectedOptions) vendor_selected(this.selectedOptions[0], false);");

        // Always clear the selects before loading new options
        v1_select.innerHTML = "";
        v2_select.innerHTML = "";

        // Add a default option to both selects
        default_option1 = document.createElement("option");
        default_option1.appendChild(document.createTextNode("Select Participant"));
        default_option1.setAttribute("class", "default_option");

        default_option2 = document.createElement("option");
        default_option2.appendChild(document.createTextNode("Select Participant"));
        default_option2.setAttribute("class", "default_option");

        v1_select.appendChild(default_option1);
        v2_select.appendChild(default_option2);

        for (let vendor of vendors_from_round) { 
            // Populate the vendors in the round (in case used elsewhere)
            all_vendors_in_round.push(vendor.ParticipantName);
            vendor_display_names.push(vendor.DisplayName)
            all_vendors_in_round_lwr.push(vendor.ParticipantName.toLowerCase());

            // Create an option for vendor 1
            let v1_option_item = document.createElement("option");
            v1_option_item.setAttribute("data-vendorName", vendor.ParticipantName);
            v1_option_item.setAttribute("data-displayName", vendor.DisplayName);
            v1_option_item.setAttribute("data-vendorTable", "v1")
            v1_option_item.value = vendor.ParticipantName;
            v1_option_item.appendChild(document.createTextNode(vendor.DisplayName));

            // Create an option for vendor 2, greyed out if url obj is selected already
            let v2_option_item = document.createElement("option");
            v2_option_item.setAttribute("data-vendorName", vendor.ParticipantName);
            v2_option_item.setAttribute("data-displayName", vendor.DisplayName);
            v2_option_item.setAttribute("data-vendorTable", "v2")
            v2_option_item.value = vendor.ParticipantName;
            v2_option_item.appendChild(document.createTextNode(vendor.DisplayName));

            v1_select.appendChild(v1_option_item);
            v2_select.appendChild(v2_option_item);
        }
    }

    function vendor_selected(vendor_item, loaded_from_url) {
        var column_uid = vendor_item.parentNode.getAttribute("data-column_uid");
        var vendorName = vendor_item.getAttribute("data-vendorName");
        var displayName = vendor_item.getAttribute("data-displayName");
        // var query_string = window.location.href;

        if (column_uid == 1) {
            global_vendor1 = {"vendorName": vendorName, "displayName": displayName};
        }
        else if (column_uid == 2) {
            global_vendor2 = {"vendorName": vendorName, "displayName": displayName};
        }

        // Remove "Select Vendor" option from the dropdown
        var default_option = vendor_item.parentNode.getElementsByClassName("default_option")[0];
        if (default_option) {
            vendor_item.parentNode.removeChild(default_option);
        }

        if (Object.keys(global_vendor1).length > 0 && Object.keys(global_vendor2).length > 0) {
            // Enable match filter
            document.getElementById("diff_match_filter").disabled = false;

            for (step of json_data[selected_round].Steps) {
                // var detection_counter = 0;
                var substep = step.Substep;
                var tid = step.Techniques[0].TechniqueId;
                // var step_tid = (step.Substep + "_" + tid).replaceAll(".", "_");
                var step_tid = custom_replaceAll((step.Substep + "_" + tid), ".", "_");
                var div_step_tid = document.getElementById("div_" + step_tid);
                
                var div_collapse_body = document.getElementById("div_collapse_body_" + step_tid);
                var diff_table = document.getElementById("diff_table_" + step_tid);
                var horizontal_rule = div_collapse_body.querySelector("#card_hr")

                // If the diff table doesn't exist, create it and fill it. If it does exist, remove it and replace it with a new table.
                if (diff_table) {
                    diff_table.parentNode.removeChild(diff_table);
                }

                diff_table = document.createElement("table");
                diff_table.setAttribute("class", "diff_step_tid_table");
                diff_table.setAttribute("id", "diff_table_" + step_tid);

                var diff_table_header = document.createElement("thead");
                var tr_diff_header_row = document.createElement("tr");
                // var diff_table_th_diff = document.createElement("th");
                var diff_table_th_vendor1 = document.createElement("th");
                var diff_table_th_vendor2 = document.createElement("th");
                var vendor1_h5 = document.createElement("h5");
                var vendor2_h5 = document.createElement("h5");
                var diff_table_body = document.createElement("tbody");

                tr_diff_header_row.setAttribute("class", "tr_diff_row");
                // diff_table_th_diff.setAttribute("class", "th_diff_cell");
                diff_table_th_vendor1.setAttribute("class", "th_v1_detection_cell");
                diff_table_th_vendor2.setAttribute("class", "th_v2_detection_cell");

                vendor1_h5.setAttribute("class", "sub-h5")
                vendor2_h5.setAttribute("class", "sub-h5")
                vendor1_h5.innerText = global_vendor1.displayName;
                vendor2_h5.innerText = global_vendor2.displayName;

                diff_table_th_vendor1.appendChild(vendor1_h5);
                diff_table_th_vendor2.appendChild(vendor2_h5);
                
                // tr_diff_header_row.appendChild(diff_table_th_diff);
                tr_diff_header_row.appendChild(diff_table_th_vendor1);
                tr_diff_header_row.appendChild(diff_table_th_vendor2);

                diff_table_header.appendChild(tr_diff_header_row);
                diff_table.appendChild(diff_table_header);

                var all_detection_rows = [];
                var detection_type_count = 0;
                var vendor1_detections = [];
                var vendor2_detections = [];
                var previous_dtype = "";
                var diff_value;
                var vendor_data_matches = 0;

                // Get the vendors' data from json, makes it easier to work with.
                for (vendor of step.Techniques[0]["Participants"]) {
                    if (vendor.ParticipantName == global_vendor1.vendorName) {
                        vendor1_detections = vendor.Detections.slice();
                        vendor_data_matches++;
                    }
                    else if (vendor.ParticipantName == global_vendor2.vendorName) {
                        vendor2_detections = vendor.Detections.slice();
                        vendor_data_matches++;
                    }

                    if (vendor_data_matches > 1) {
                        break;
                    }
                }
                
                // Keep a record of v2 detections that have already been matched, exclude them from further matching
                var done_indexes = [];

                // For every v1 detection, loop through v2 2 detections and assess diff value.
                // Creates tuple-like arrays (stored in all_detection_rows[]) that will be used to generate table rows later
                for (detection of vendor1_detections) {
                    var v1_dtype = detection.DetectionType;

                    // Check v2 detections for repeats before assessing a new v1 detection type
                    if (previous_dtype && (v1_dtype != previous_dtype)) {
                        for (const [idx, detection2] of vendor2_detections.entries()) {
                            if ((!done_indexes.includes(idx)) && detection2.DetectionType == previous_dtype) {
                                var detection_row = ["no_match", detection2.DetectionType, detection2];
                                all_detection_rows.push(detection_row);
                                done_indexes.push(idx);
                            }
                        }
                    }

                    previous_dtype = v1_dtype;
                    diff_value = "no_match";

                    for (const [idx, detection2] of vendor2_detections.entries()) {
                        // If detection types match, check if modifiers match
                        if ((!done_indexes.includes(idx)) && detection2.DetectionType == v1_dtype) {

                            detection.Modifiers.sort();
                            detection2.Modifiers.sort();

                            if (JSON.stringify(detection.Modifiers) == JSON.stringify(detection2.Modifiers)) {
                                diff_value = "match";
                            }
                            else {
                                diff_value = "partial_match";
                            }

                            var detection_row = [diff_value, detection, detection2];
                            all_detection_rows.push(detection_row);
                            done_indexes.push(idx);
                            break;
                        }
                    }

                    // No match was found, so create a placeholder
                    if (diff_value == "no_match") {
                        var detection_row = ["no_match", detection, detection.DetectionType];
                        all_detection_rows.push(detection_row);
                    }
                }

                // Check vendor 2 detections for leftovers
                for (const [idx, detection] of vendor2_detections.entries()) {
                    if (!done_indexes.includes(idx)) {
                        var detection_row = ["no_match", detection.DetectionType, detection];
                        all_detection_rows.push(detection_row);
                    }
                }

                // Append rows to diff_table and append diff_table to the step_tid card
                var diff_detection = false;
                for (row of all_detection_rows) {
                    if (row[0] == "no_match") {
                        if ((typeof(row[1] == Object) && row[1].DetectionType == "None") || row[1] == "None") {
                            continue;
                        }
                        else if ((typeof(row[2] == Object) && row[2].DetectionType == "None") || row[2] == "None") {
                            continue;
                        }
                    }

                    var diff_row = document.createElement("tr");
                    // var diff_cell = document.createElement("td");
                    var td_v1_detection_cell = document.createElement("td");
                    var td_v2_detection_cell = document.createElement("td");
                    var match_type = row[0];

                    diff_row.setAttribute("class", "tr_diff_row");
                    // diff_cell.setAttribute("class", "td_diff_cell");
                    td_v1_detection_cell.setAttribute("class", "td_v1_detection_cell");
                    td_v2_detection_cell.setAttribute("class", "td_v2_detection_cell");
                    
                    switch(match_type) {
                        case "match":
                            // diff_cell.innerHTML = '=';
                            break;
                        case "partial_match":
                            diff_detection = true;
                            // diff_cell.innerHTML = '&asymp;';
                            // div_step_tid.setAttribute("data-match_status", "no_match");
                            break;
                        default:
                            // no match
                            diff_detection = true;
                            // diff_cell.innerHTML = '&ne;';
                            div_step_tid.setAttribute("data-match_status", "no_match");
                    }
                    td_v1_detection_cell.appendChild(create_detection_card(match_type, row[1], false));
                    td_v2_detection_cell.appendChild(create_detection_card(match_type, row[2], true));

                    // diff_row.appendChild(diff_cell);
                    diff_row.appendChild(td_v1_detection_cell);
                    diff_row.appendChild(td_v2_detection_cell);

                    diff_table_body.appendChild(diff_row);
                }

                // If there was a diff in the step, highlight the card header 
                if (diff_detection) {
                    header = document.getElementById("div_collapse_header_" + step_tid)
                    header.setAttribute("class", "card-header collapsed hoverpointer card-header-text-difference");
                    div_step_tid.setAttribute("data-match_status", "no_match");
                } else {
                    header = document.getElementById("div_collapse_header_" + step_tid)
                    header.setAttribute("class", "card-header collapsed hoverpointer card-header-text");
                    div_step_tid.setAttribute("data-match_status", "match");
                }

                if(!horizontal_rule) {
                    horizontal_rule = document.createElement("hr");
                    horizontal_rule.setAttribute("id", "card_hr");
                    div_collapse_body.appendChild(horizontal_rule);
                }

                diff_table.appendChild(diff_table_body);
                div_collapse_body.appendChild(diff_table);
            }

            applyFilters(false);
            check_expand_status(null);

        }
    }
    
    function create_detection_card(match_type, detection, increment_row_uid) {
        var div_detection_card = document.createElement("div");
        div_detection_card.setAttribute("class", "card w-100");

        var div_card_header = document.createElement("div");
        div_card_header.setAttribute("class", "card-header collapsed hover-pointer");
        // div_card_header.setAttribute("id", "card_header_" + column_uid + "_" + step_tid + "_" + detection_counter_str);
        div_card_header.setAttribute("data-toggle", "collapse");
        div_card_header.setAttribute("data-target", ".detection_" + detection_row_uid + "_body");
        div_card_header.setAttribute("aria-expanded", "false");
        div_card_header.setAttribute("aria-controls", "detection_" + detection_row_uid + "_body");

        // Get Dtype and modifiers for header
        var span_detection_type = document.createElement("h6");
        span_detection_type.setAttribute("class", "mb-0");
        
        if (typeof(detection) == "string") {
            // Detection is missing, so make a blank detection cell
            div_detection_card.setAttribute("style", "background-color: lightgrey");
            span_detection_type.appendChild(document.createTextNode(detection));
            span_detection_type.setAttribute("style", "visibility: hidden;");
            
            
            div_card_header.appendChild(span_detection_type);

            // Placeholder for modifiers so that all cards are the same height
            var span_modifiers = document.createElement("h6");
            span_modifiers.setAttribute("class", "mb-0 sub-h6");
            span_modifiers.appendChild(document.createTextNode("(invisible)"));
            span_modifiers.setAttribute("style", "visibility: hidden;");
            div_card_header.appendChild(span_modifiers);

            div_detection_card.appendChild(div_card_header);
        }
        else if (typeof(detection) == "object") {
            // There's either a match or a modifier difference
            span_detection_type.appendChild(document.createTextNode(detection.DetectionType));


            if (match_type == "partial_match" || match_type == "no_match") {
                // span_detection_type.setAttribute("style", "color: pink");
                div_card_header.setAttribute("style", "background-color: lightgrey");
            }

            div_card_header.appendChild(span_detection_type);

            // Always add placeholder so that all cards are the same height.
            var span_modifiers = document.createElement("h6");
            span_modifiers.setAttribute("class", "mb-0 sub-h6");

            var modifiers_text = "placeholder";

            if (detection.Modifiers.length > 0) {
                modifiers_text = "";
                for (const [idx, modifier] of detection.Modifiers.entries()) {
                    modifiers_text += modifier;
                    if (idx < detection.Modifiers.length -1) {
                        modifiers_text += ", ";
                    }
                }

                if (match_type == "partial_match" || match_type == "no_match") {
                    // span_modifiers.setAttribute("style", "color: pink");
                    div_card_header.setAttribute("style", "background-color: lightgrey");
                }
            }
            else {
                span_modifiers.setAttribute("style", "visibility: hidden;");
            }

            span_modifiers.appendChild(document.createTextNode(modifiers_text));
                
            div_card_header.appendChild(span_modifiers);
            div_detection_card.appendChild(div_card_header);

            // Make detection card body
            let div_card_body = document.createElement("div");
            div_card_body.setAttribute("class", "collapse detection_" + detection_row_uid + "_body");
            // div_card_body.setAttribute("id", "detection_" + detection_row_uid + "_body");
            div_card_body.setAttribute("aria-labelledby", "detection_" + detection_row_uid + "_header");
            
            // Create inner div for detection note
            var div_card_body_inner = document.createElement("div");
            div_card_body_inner.setAttribute("class", "card-body");
            var span_detection_note = document.createElement("span");
            span_detection_note.setAttribute("class", "tc_span_detection_note");
            var detection_note_text = detection.DetectionNote;
            var regex = /\[[A-Z][A-Z]\d+\]/g;
            detection_note_text = detection_note_text.replace(regex, '');
            span_detection_note.appendChild(document.createTextNode(detection_note_text));
            
            // Add footnotes after the detection note
            if (detection.Footnotes) {
                for (let i = 0; i < detection.Footnotes.length; i++) {
                    let a_footnote = document.createElement("a");
                    a_footnote.setAttribute("href", "javascript:void(0);")
                    a_footnote.setAttribute("class", "aFootnote");

                    let i_detection_icon = document.createElement("i");
                    i_detection_icon.setAttribute("class", "fas fa-info-circle mr-1");

                    let span_footnote = document.createElement("span");
                    span_footnote.setAttribute("class", "diff_spanPopup_footnotes");
                    span_footnote.setAttribute("onclick", "return false;");
                    span_footnote.setAttribute("href", "#")
                    span_footnote.appendChild(document.createTextNode(detection.Footnotes[i]));

                    i_detection_icon.appendChild(span_footnote);
                    a_footnote.appendChild(i_detection_icon);
                    span_detection_note.appendChild(a_footnote);
                }
            }

            if (detection.Modifiers) {
                // Add screenshots after detection note and footnotes
                for (i = 0; i < detection.Screenshots.length; i++) {
                    let a_screenshot = document.createElement("a");
                    a_screenshot.setAttribute("href", "https://d1zq5d3dtjfcoj.cloudfront.net/" + detection.Screenshots[i].ScreenshotName);
                    a_screenshot.setAttribute("target", "_blank");
                    a_screenshot.innerHTML = a_screenshot.innerHTML + "<sup>[" + (i + 1) + "]</sup> ";
                    span_detection_note.appendChild(a_screenshot);
                }
            }

            // Append card body elements
            div_card_body_inner.append(span_detection_note);
            div_card_body.appendChild(div_card_body_inner);
            div_detection_card.appendChild(div_card_body);
        }

        if (increment_row_uid) {
            detection_row_uid++;
        } 

        return div_detection_card;
    }

    function open_all_cards(filter_applied) {
        var headers = document.getElementsByClassName("card-header");
        for (header of headers) {
            if (header.id.indexOf("div_collapse_header") > -1) {
                var matching_body = document.getElementById(header.id.replace("header", "body"));
                if (!filter_applied) {
                    header.classList.remove("collapsed");
                    header.setAttribute("aria-expanded", "true");
                    matching_body.classList.add("show");
                }
            }
        }
        var expand_btn = document.getElementById("expand");
        var collapse_btn = document.getElementById("collapse");

        expand_btn.setAttribute("style", "display: none;")
        collapse_btn.setAttribute("style", "display: block")

        card_open_status = true;
        update_url(false)

    }

    function close_all_cards(filter_applied) {
        var headers = document.getElementsByClassName("card-header");
        for (header of headers) {
            if (header.id.indexOf("div_collapse_header") > -1) {
                var matching_body = document.getElementById(header.id.replace("header", "body"));
                if (!filter_applied) {
                    header.classList.add("collapsed");
                    header.setAttribute("aria-expanded", "false");
                    matching_body.classList.remove("show");
                }
            }
        }
        var expand_btn = document.getElementById("expand");
        var collapse_btn = document.getElementById("collapse");

        collapse_btn.setAttribute("style", "display: none;")
        expand_btn.setAttribute("style", "display: block")

        card_open_status = false;

        update_url(false)
    }

    function check_expand_status(card_clicked) {
        // Need to get the cards that currently have their display attribute as "block"
        var currently_displayed_cards = $('.diff_div_step_tid_card:visible > div > div.card-header');
        var opened_cards = 0;
        
        // From those cards, check their open status ie. if aria-expanded = true
        for (card of currently_displayed_cards) {
            // If current card matches the card that was clicked, confirm the correct value of aria-expanded into tally
            if(card_clicked && (card == card_clicked)) {
                var clicked_status_post_render = !(card.getAttribute('aria-expanded') == 'true');
                if(clicked_status_post_render) {
                    opened_cards += 1;
                }
            } else {
                if(card.getAttribute('aria-expanded') == 'true') {
                    opened_cards += 1;
                } 
            }
        }

        if(opened_cards == currently_displayed_cards.length) {
            open_all_cards(true);
        } 
        if(opened_cards == 0) {
            close_all_cards(true);
        }
    }

    function update_url(new_round_selected) {
        var vendor1_value = document.getElementById("diff_vendor1_select").selectedOptions[0].value;
        var vendor2_value = document.getElementById("diff_vendor2_select").selectedOptions[0].value;
        var match_filter_value = document.getElementById("diff_match_filter").selectedOptions[0].value;
        var tactic_filter_value = document.getElementById("diff_tactic_filter").selectedOptions[0].value;
        var cards_open_status = card_open_status;
        var base_url = window.location.href;

        if (base_url.indexOf("?") > -1) {
            base_url = base_url.substring(0, base_url.indexOf("?"));
        }

        var query_string = base_url;

        query_string += "?adversary=" + selected_round;

        if (!new_round_selected) {
            if (vendor1_value != "Select Participant" && vendor2_value != "Select Participant") {
                query_string += "&participants=" + vendor1_value + "," + vendor2_value;
            }
            
            if (match_filter_value == "all_steps" && tactic_filter_value == "all_tactics") {
                // pass
            }
            else {
                query_string += "&steps=" + match_filter_value + "&tactic=" + tactic_filter_value;
            }
        }
        if (cards_open_status) {
            query_string += "&cards_open=true";
        }
        else {
            query_string += "&cards_open=false";
        }

        window.history.replaceState({}, "", query_string);
    }


    function applyFilters(filter_selected) {
        update_url(false);
        var all_cards = document.querySelectorAll("[data-match_status]");
        var match_filter = document.getElementById("diff_match_filter");
        var tactic_filter = document.getElementById("diff_tactic_filter");
        var match_filter_value = match_filter.selectedOptions[0].value;
        var tactic_filter_value = tactic_filter.selectedOptions[0].value;

        for (card of all_cards) {
            var match_status = card.getAttribute("data-match_status");
            var tactic_ids = card.getAttribute("data-tactic_ids").trim();
            var show_card = false;

            if (match_filter_value == "all_steps") {
                if (tactic_filter_value == "all_tactics") {
                    show_card = true;
                }
                else if (tactic_ids.indexOf(tactic_filter_value) > -1) {
                    show_card = true;
                }
            }
            else if (match_filter_value == "diffs") {
                if (match_status == "no_match") {
                    if ((tactic_filter_value == "all_tactics") || (tactic_ids.indexOf(tactic_filter_value) > -1)) {
                        show_card = true;
                    }
                }
            }
            else if (match_filter_value == "matches") {
                if (match_status == "match") {
                    if ((tactic_filter_value == "all_tactics") || (tactic_ids.indexOf(tactic_filter_value) > - 1)) {
                        show_card = true;
                    }
                }
            }

            if (show_card) {
                card.setAttribute("style", "display: block;");
            }
            else {
                card.setAttribute("style", "display: none;");
            }
        }

        // Filter isn't being applied for query string, option was selected from dropdowns
        if (filter_selected) {
            close_all_cards(false)
        }
    }

    function load_tactics_filter_options(raw_tactics_in_round) {
        var diff_tactic_filter = document.getElementById("diff_tactic_filter");
        
        // First clear the filter
        diff_tactic_filter.innerHTML = "";
        
        clean_tactics_in_round = [];
        
        for (tactic of raw_tactics_in_round) {
            var tactic_str = tactic.TacticId + "." + tactic.TacticName;

            if (!clean_tactics_in_round.includes(tactic_str)) {
                clean_tactics_in_round.push(tactic_str);
            }
        }

        clean_tactics_in_round.sort();

        var all_tactics_option = document.createElement("option");
        all_tactics_option.value = "all_tactics";
        all_tactics_option.appendChild(document.createTextNode("All tactics"));
        diff_tactic_filter.appendChild(all_tactics_option);

        for (tactic_str of clean_tactics_in_round) {
            var tactic_id = tactic_str.slice(0, tactic_str.indexOf("."));
            var tactic_name = tactic_str.slice(tactic_str.indexOf(".") + 1);
            // var formatted_tactic_str = tactic_name + " (" + tactic_id + ")";
            var formatted_tactic_str = tactic_name;
            var tactic_option = document.createElement("option");
            
            tactic_option.value = tactic_id;
            tactic_option.setAttribute("data-tactic_name", tactic_name);
            tactic_option.appendChild(document.createTextNode(formatted_tactic_str));

            diff_tactic_filter.appendChild(tactic_option);
        }
    }

    // Scroll to top button
    $(window).scroll(function() {
        var height = $(window).scrollTop();
        if (height > 100) {
            $('#scrollUp').fadeIn();
        } else {
            $('#scrollUp').fadeOut();
        }
    });
    $(document).ready(function() {
        $("#scrollUp").click(function(event) {
            event.preventDefault();
            $("html, body").animate({ scrollTop: 0 }, "slow");
            return false;
        });

    });

    
    function custom_replaceAll(string, char_to_replace, replacement_char) {
        let new_str = "";
        
        for (letter of string) {
            if (letter != char_to_replace) {
                new_str += letter;
            }
            else {
                new_str += replacement_char;
            }
        }
        
        return new_str;
    }


    function start_tour() {
        document.getElementById("div_vendor_comparison_main").style.display = "None";
        document.getElementById("div_collapse_body_1_A_2_T1028_tour").classList.remove("show");
        document.getElementById("divTourBody").style.display = "Block";

        run_tour();
    }


    function expand_for_tour(card_type) {
        if (card_type == 'step') {
            document.getElementById("div_collapse_body_1_A_2_T1028_tour").classList.add("show");
        }
        else if (card_type == 'detection') {
            document.getElementById("div_detection1_expand_tour1").classList.remove("collapsed");
            document.getElementById("div_detection1_expand_tour2").classList.add("show");

            document.getElementById("div_detection2_expand_tour1").classList.remove("collapsed");
            document.getElementById("div_detection2_expand_tour2").classList.add("show");
        }
    }


    function end_tour() {
        document.getElementById("div_vendor_comparison_main").style.display = "Block";
        document.getElementById("divTourBody").style.display = "None";
        document.getElementById("tourBackdrop").style.display = "None";

        // Also reset expansion of divs in case the tour is run again
        document.getElementById("div_collapse_body_1_A_2_T1028_tour").classList.remove("show");
        
        document.getElementById("div_detection1_expand_tour1").classList.add("collapsed");
        document.getElementById("div_detection1_expand_tour2").classList.remove("show");
        document.getElementById("div_detection2_expand_tour1").classList.add("collapsed");
        document.getElementById("div_detection2_expand_tour2").classList.remove("show");
    }


    function run_tour() {
        // Instance the tour
        var tour = new Tour({
            framework: 'bootstrap4',   // or "bootstrap4" depending on your version of bootstrap
            storage: false,
            onEnd: function() {end_tour();},
            steps: [
                {
                    // slide 1
                    orphan: true,
                    backdrop: true,
                    title: 'Welcome to the Participant Comparison tour!',
                    content: 'This guided tour will teach you how to use the Participant Comparison Tool.'
                },
                {
                    // slide 2
                    element: '#btnSelectRound_tour',
                    title: 'First, select an adversary.',
                    content: 'If your desired adversary is not already selected, choose it from this dropdown. Selecting a new adversary will automatically update the steps shown on the right.'
                },
                {
                    // slide 3
                    element: '#diff_vendor1_select_tour',
                    title: 'Second, select participants for comparison.',
                    content: 'Here, you can select the two participants you wish to compare. Once both participants are selected, the data on the right will automatically be updated.'
                },
                {
                    // slide 4
                    element: '#div_1_A_1_T1032_tour',
                    placement: 'left',
                    title: 'Lastly, view the results!',
                    content: 'The results of your comparison will appear here. If the participants had identical detection categories for a given step, it will appear in black, like this. If the participants had any differences in their detection categories, they will appear in purple, like the card below.',
                },
                {
                    // slide 5
                    element: '#div_collapse_header_1_A_2_T1028_tour',
                    placement: 'left',
                    title: 'Expand Details',
                    content: 'If you want to see the details of the comparison, you can click on a result header to expand the card. Clicking the header again will collapse the card details for a more compact view.',
                    onNext: function() {
                        expand_for_tour('step');
                    }
                },
                {
                    // slide 6
                    element: '#same_tour',
                    placement: 'left',
                    title: 'Similar Detection Categories',
                    content: "In this table, you can see the comparison of each participant's detection categories. Light gray cards like these indicate that the detection categories were the same between the two participants."
                },
                {
                    // slide 7
                    element: '#different_tour',
                    placement: 'left',
                    title: 'Different Detection Categories or Modifiers',
                    content: 'Here, the dark gray color indicates that there was a difference in detection categories between the two participants. Similar detection categories with different modifiers are treated as different (not similar) results. You can also click on a detection to expand/collapse the details of that detection.',
                    onNext: function() {
                        expand_for_tour('detection');
                    }
                },
                {
                    // slide 8
                    element: '#div_detection1_expand_tour2',
                    placement: 'left',
                    title: 'Detection Notes',
                    content: 'Clicking on a detection will expand the detection notes section, showing more detail. You can collapse the notes by clicking on the detection header again.',
                },
                {
                    // slide 9
                    element: '#diff_match_filter_tour',
                    title: 'Filters',
                    content: 'At any point in your comparison, you can filter the results with these dropdowns.'
                },
                {
                    // slide 10
                    element: '#expand_tour',
                    title: 'Expand/Collapse Cards',
                    content: 'You can toggle through expanding/collapsing all of the results cards with this button. Please note that this button will only affect the expanding/collapsing of the main results cards and will not affect the appearance of the detection details.'
                },
                {
                    // slide 11
                    orphan: true,
                    backdrop: true,
                    title: 'Conclusion',
                    content: "We hope you have enjoyed this tour of the Participant Comparison Tool! If you have any feedback or suggestions, please visit the <a href='/contact'>contact page</a> to get in touch.",
                    onShown: function() {
                        document.getElementById("step-10").querySelector("[data-role='next']").style.display = "None";
                    }
                }
            ]
        });

        // Start the tour - note, no call to .init() is required
        tour.start();
    }
    
</script>

<style>
    .popover[class*="tour-"].orphan {
        left: 50% !important;
        top: 50% !important;
        margin-top: 0;
        position: absolute;
        transform: translate(-50%, -50%) !important;
    }
</style>


</div>
</div>
<footer>
    <div class="container-fluid border-top pt-4 pb-4">
        <div class="row" style="width: 95%; margin: 0 auto;">
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <p class="footer-links-left"><a class="footer-links-left" href="/terms-of-use">Terms and Conditions</a></p>
                <p class="footer-links-left"><a class="footer-links-left" href="/privacy">Privacy Policy</a></p>
                <p class="footer-links-left">© 2018 - 2021, The MITRE Corporation and MITRE Engenuity.</p>
                <p class="footer-links-left">MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.</p>
            </div>
            <div class="col-xl-6 style: display: flex; flex-direction: column;">
                <div class="footer-float-right-responsive">
                    <div class="mb-1">
                        <a href="https://twitter.com/MITREengenuity" class="btn btn-footer w-100">
                            <img src="https://d1zq5d3dtjfcoj.cloudfront.net/twitter.png" class="mr-1" style="vertical-align: top" width="20" height="20">
                            <b>@MITREengenuity</b>
                        </a>
                    </div>
                    <div class="">
                        <a href="/contact" class="btn btn-footer w-100">
                            Contact
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
    
    <!--SCRIPTS-->
    <script src="/theme/scripts/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="/theme/scripts/bootstrap.min.js"></script>
    <script src="/theme/scripts/site.js"></script>

    <script src="/theme/scripts/bootstrap-tourist.js"></script>
    
</body>

<!-- jjli -->

</html>