{"Participant_Name": "CyCraft", "PublicRelease": "\u00a9 2021 MITRE Engenuity. Approved for Public Release. Document number AT0016", "Aggregate_Data": {"Evaluation_Aggregate_Data": {"Adversaries": [{"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Total_Detections": 190, "Analytic_Detections": 101, "Telemetry_Detections": 1, "Analytic_Coverage": "108/134", "Telemetry_Coverage": "1/134", "Visibility": "108/134", "Total_Substeps": 134}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Total_Detections": 264, "Analytic_Detections": 136, "Telemetry_Detections": 128, "Analytic_Coverage": "125/174", "Telemetry_Coverage": "128/174", "Visibility": "130/174", "Total_Substeps": 174, "Linux_Participant": true}]}}, "Adversaries": [{"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) including \"User Execution\" was generated when explorer.exe executed rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-14868.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection including \"User Execution\" was received that included a description of rcs.3aka3.doc and its execution.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-11803.png", "CyCraft-APT29-12218.png"], "Footnotes": []}]}, {"Substep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.002", "Subtechnique_Name": "Masquerading: Right-to-Left Override"}, "Detections": [{"Detection_Note": "A Technique alert detection (purple severity) was generated for rcs.3aka.doc, identified as an EXE.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2048.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was received that included details of the file rcs.3aka3.doc and identified it as an EXE.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12471.png"], "Footnotes": []}]}, {"Substep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CyCraft-APT29-2051.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Uncommonly Used Port\" was received that included a description of rcs.3aka3.doc and explained that it established a network connection to 192.168.0.5:1234.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-11803.png"], "Footnotes": []}]}, {"Substep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.001", "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "An MSSP detection for was received that included a description of rcs.3aka3.doc spawning cmd.exe interactively.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-11805.png", "CyCraft-APT29-11806.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection (yellow indicator) for \"Execution\" was generated for cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2200.png", "CyCraft-APT29-2201.png"], "Footnotes": []}]}, {"Substep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"Powershell\" was generated when cmd.exe spawned powershell.exe. The alert was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2056.png", "CyCraft-APT29-2057.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"PowerShell\" was received that included a description of PowerShell execution and an explanation of the commands executed through it.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12220.png", "CyCraft-APT29-12222.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"File and Directory Discovery\" was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12220.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (purple indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2203.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12220.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (purple indicator) showed powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2203.png"], "Footnotes": []}]}, {"Substep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing Compress-Archive", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A General alert detection (purple indicator) was generated for powershell.exe executing Compress-Archive. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2205.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Data Compressed\" was received that included an explanation of the PowerShell script used to collect certain file types on host Nashua (10.0.1.6) and then archive them as DRAFT.ZIP.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12220.png"], "Footnotes": []}]}, {"Substep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Deploy Stealth Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within monkey.png", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.003", "Subtechnique_Name": "Obfuscated Files or Information: Steganography"}, "Detections": [{"Detection_Note": "A General alert detection (purple indicator) was generated for PowerShell extracting and executing the code embedded within monkey.png. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2206.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12231.png"], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for the addition of the DelegateExecute Registry Value.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2106.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Component Object Model Hijacking\" was received that included a PowerShell script and explained that it was used to modify a COM component to delegate execution.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12434.png", "CyCraft-APT29-12435.png", "CyCraft-APT29-12243.png"], "Footnotes": []}]}, {"Substep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"Bypass UAC\" was generated when sdclt.exe was executed in a high integrity context by cmd.exe. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2208.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection (yellow indicator) was generated for an unprivileged process executing another program with SYSTEM permissions.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2083.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Bypass User Account Control\" was received that explained that cmd.exe (medium integrity) executed sdclt.exe (high integrity) to facilitate a UAC bypass resulting in execution of powershell.exe (High Integrity).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12243.png"], "Footnotes": []}]}, {"Substep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert (red indicator) was generated for powershell.exe execution, which included connecting to 192.168.0.5 on TCP 443. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2211.png"], "Footnotes": []}]}, {"Substep": "3.B.4", "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Modify Registry\" was received that included a PowerShell script and explained that it was used to delete previously created registry keys.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12437.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (blue indicator) was generated for the PowerShell command to remove DelegateExecute Registry Value. The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2213.png"], "Footnotes": []}]}]}, {"Step_Num": 4, "Step_Name": "Clean Up and Reconnaissance", "Substeps": [{"Substep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Tactic alert detection (yellow indicator) was generated for a new powershell.exe spawning from powershell.exe.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-14918.png"], "Footnotes": []}]}, {"Substep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection was occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12439.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (blue indicator) was generated due to powershell.exe decompressing the ZIP via Expand-Archive. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-14998.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated due to powershell.exe executing Get-Process. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2217.png"], "Footnotes": []}]}, {"Substep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) was generated due to sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-15479.png"], "Footnotes": []}]}, {"Substep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) was generated due to sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-14996.png"], "Footnotes": []}]}, {"Substep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "An MSSP detection for \"File Deletion\" was received that included a PowerShell script and explained that it was used to execute sdelete64.exe to delete SysInternalsSuite.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12440.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (yellow indicator) was generated due to sdelete64.exe deleting  SysinternalsSuite.zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-14994.png"], "Footnotes": []}]}, {"Substep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing $env:TEMP", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"File and Directory Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current directory.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12466.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current user name.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12466.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current computer name.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12466.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current environment information.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12466.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to obtain the current environment information.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12466.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to obtain the OS system information.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12466.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Security Software Discovery\" was received that included a PowerShell script and explained that it was used to detect the installed anti-virus product.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12466.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Security Software Discovery\" was received that included a PowerShell script and explained that it was used to detect the installed firewall product.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12466.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe executing the NetUserGetGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetGroups command to search for domain groups through Win32 API calls.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12465.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used to search for domain groups through Win32 API calls.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12465.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.11", "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API", "Criteria": "powershell.exe executing the NetUserGetLocalGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetLocalGroups command to search for local groups through Win32 API calls.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12467.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}, {"Substep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Permission Groups Discovery\" was received that included a PowerShell script and explained that it was used the Invoke-NetUserGetLocalGroups command to search for local groups through Win32 API calls.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12467.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}]}, {"Step_Num": 5, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "A General alert detection (orange indicator) showed a Registry event for the creation of javamtsup service.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2168.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"New Service\" was received that included events and analysis related to registration and execution of the javamtsup service.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12442.png", "CyCraft-APT29-12441.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique alert detection (green indicator) for \"Registry Run Keys / Startup Folder\" was generated due to hostui.lnk being written to the Startup folder.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2232.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a Registry Created event for addition of hostui.lnk to the Startup folder. Additional analysis was received that included a PowerShell script and explained that it used the Invoke-Persistence command to create a LNK file in the Startup folder.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12469.png", "CyCraft-APT29-12443.png"], "Footnotes": ["MSSP analysis that was performed on Windows Event Logs (Event ID 4104, PowerShell ScriptBlock Logs) would have been requested during a normal engagement when CyCraft MDR received insufficient information for analysis of adversary activity."]}]}]}, {"Step_Num": 6, "Step_Name": "Credential Access", "Substeps": [{"Substep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Masquerading\" was received that included an execution event for accesschk.exe and explained that the file was masquerading as a legitimate SysInternals tool. Additional data was received that included details of the file accesscheck.exe such as the hash, company name, and signer.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12444.png", "CyCraft-APT29-12472.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.004", "Subtechnique_Name": "Unsecured Credentials: Private Keys"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"Credential Dumping\" was generated when powershell.exe attempted to read the lsass.exe process memory. The event was correlated to a parent Technique detection for User Execution on rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2233.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Credential Dumping\" was received that described PowerShell dumping credentials from LSASS process memory.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12445.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Screen Capture\" occurred containing evidence of screen capture.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12449.png", "CyCraft-APT29-12446.png", "CyCraft-APT29-12447.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for suspicious threat activity for PowerShell calling CopyFromScreen.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2137.png"], "Footnotes": []}]}, {"Substep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-14850.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of a PowerShell script used to gather information from the clipboard.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12448.png"], "Footnotes": []}]}, {"Substep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A General alert detection for Threat Activity (red indicator) was generated for PowerShell calling the GetAsyncKeyState API.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-14846.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Input Capture\" occurred containing evidence of key logging.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12450.png", "CyCraft-APT29-12451.png"], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.B.2", "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A General alert detection (orange indicator) was generated due to powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-14986.png", "CyCraft-APT29-14984.png"], "Footnotes": []}]}, {"Substep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1048.003", "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"}, "Detections": [{"Detection_Note": "A General alert detection (yellow indicator) was generated due to rundll32.exe executing the API Call DavSetCookie in daclnt.dll to map a share using WebDav.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2241.png", "CyCraft-APT29-2242.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Expand Access", "Substeps": [{"Substep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Remote System Discovery\" was received that explained that the Ad-Search PowerShell command was used to discover remote systems in the domain.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12453.png", "CyCraft-APT29-12452.png"], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) for \"PowerShell\" was generated due to powershell.exe using Invoke-Command to remotely execute Get-Process on host Scranton (10.0.1.4). The event was correlated to a parent Technique detection for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2244.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to execute Get-Process on host Scranton (10.0.1.4).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12454.png"], "Footnotes": []}]}, {"Substep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (yellow indicator) for \"File Creation\" for the file create event of python.exe.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-14901.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (orange indicator) for \"Remote Access\" was generated for the file copy of python.exe from host Nashua (10.0.1.6) to host Scranton (10.0.1.4).", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-14872.png"], "Footnotes": []}]}, {"Substep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.002", "Subtechnique_Name": "Obfuscated Files or Information: Software Packing"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"Software Packing\" was generated for the file creation event for python.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-14901.png"], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam", "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Valid Accounts\" was received that showed execution of PSExec64.exe using Pam's valid credentials.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12455.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (orange indicator) was generated showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2253.png"], "Footnotes": []}]}, {"Substep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for \"Remote Accessed.\"", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2254.png"], "Footnotes": []}]}, {"Substep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Service Execution\" was generated for the execution of python.exe by PSEXECSVC.exe on host Scranton (10.0.1.4) as SYSTEM.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2255.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Service Execution\" occurred containing evidence of PSEXESVC.exe executing python.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12457.png", "CyCraft-APT29-12456.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Clean Up, Collection, and Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file rar.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from python.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"PowerShell\" was generated when python.exe spawned powershell.exe. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2257.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"PowerShell\" was received that showed execution of powershell.exe by python.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12461.png"], "Footnotes": []}]}, {"Substep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2258.png"], "Footnotes": []}]}, {"Substep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for powershell.exe executing Get-ChildItem. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2258.png"], "Footnotes": []}]}, {"Substep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"T1022 Data Encrypted\" was generated when rar.exe was used to create an encrypted zip archive. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2262.png"], "Footnotes": []}]}, {"Substep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"T1002 Data Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.  The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2262.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Data Compressed\" was received that showed execution of rar.exe by powershell.exe and explained that it was used to compress data for exfiltration.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12461.png"], "Footnotes": []}]}, {"Substep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe reading the file working.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-14982.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12464.png"], "Footnotes": []}]}, {"Substep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2266.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration, including C:\\Users\\pam\\Desktop\\working.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12464.png"], "Footnotes": []}]}, {"Substep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) for \"File Deletion T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. The event was correlated to a parent Technique detection for Service Execution of python.exe by PSEXECSVC.exe.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2265.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"File Deletion\" was received that described the adversary using sdelete64.exe to remove evidence of exfiltration.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12464.png"], "Footnotes": []}]}, {"Substep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Service Execution\" was generated when services.exe spawned javamtsup.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2267.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.002", "Subtechnique_Name": "Access Token Manipulation: Create Process with Token"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Access Token Manipulation\" was generated when hostui.exe created a powershell.exe process with the CreateProcessWithToken WinAPI function.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2269.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "A Technique alert detection (orange indicator) for \"User Execution\" was generated when the .lnk file was executed.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2417.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (blue indicator) was generated identifying explorer.exe executing powershell.exe as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2279.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"User Execution\" was received that described the user executing 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk to launch powershell.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-2503.png", "CyCraft-APT29-12473.png"], "Footnotes": []}]}, {"Substep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1564", "Technique_Name": "Hide Artifacts"}, "Subtechnique": {"Subtechnique_Id": "T1564.004", "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes"}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated identifying powershell.exe executing the schemas ADS with Get-Content and IEX as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2432.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"NTFS File Attributes\" was received that described a PowerShell script reading another script from the schemas Alternate Data Stream in 2016_United_States_presidential_election_-_Wikipedia.html and executing it via IEX.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-2503.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (yellow indicator) was generated NTFS File Attributes for 2016_UNITED_STATES_PRESEDENTIAL_ELECTION_-_WIKIPEDIA.HTML:SCHEMAS.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-14981.png"], "Footnotes": []}]}, {"Substep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Virtualization/Sandbox Evasion\" was generated for the PowerShell gwmi query for Win32_BIOS.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2419.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Virtualization/Sandbox Evasion\" was received that included a PowerShell script and explained that it was used to check for virtualization.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12475.png", "CyCraft-APT29-2503.png"], "Footnotes": []}]}, {"Substep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated identifying the PowerShell gwmi query for Win32_BIOS as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2419.png", "CyCraft-APT29-2421.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-2503.png", "CyCraft-APT29-12476.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated identifying the PowerShell gwmi queries for Win32_ComputerSystem as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2421.png"], "Footnotes": []}]}, {"Substep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1120", "Technique_Name": "Peripheral Device Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated identifying a PowerShell gwmi query for Win32_PnPEntity as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2423.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Peripheral Device Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_PnPEntity via WMI.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12477.png", "CyCraft-APT29-2503.png"], "Footnotes": []}]}, {"Substep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated identying a PowerShell gwmi query for Win32_ComputerSystem as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2421.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-2503.png", "CyCraft-APT29-12476.png"], "Footnotes": []}]}, {"Substep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated identying a PowerShell gwmi query for Win32_ComputerSystem as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2421.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_ComputerSystem via WMI.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-2503.png", "CyCraft-APT29-12476.png"], "Footnotes": []}]}, {"Substep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Process Discovery\" was generated for a PowerShell gwmi query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2424.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to query Win32_Process via WMI.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12478.png"], "Footnotes": []}]}, {"Substep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for PowerShell executing Get-Item for the current path.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2285.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell script and explained that it was used to to obtain the current path.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12479.png"], "Footnotes": []}]}, {"Substep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (purple indicator) was generated identifying the execution of certutil.exe with command-line parameters for decoding the payload as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2426.png", "CyCraft-APT29-2427.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12480.png", "CyCraft-APT29-2503.png"], "Footnotes": []}]}, {"Substep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a PowerShell script and explained that it was used to establish Registry Run Key persistence.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-2503.png", "CyCraft-APT29-12497.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for \"Registry Run Keys / Startup Folder\" was generated for a Registry Creation event associated with establishing Registry Run Key persistence.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2437.png"], "Footnotes": []}]}, {"Substep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "An MSSP detection was received that included a PowerShell script and explained that it was used to download and execute another script via IEX.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12483.png", "CyCraft-APT29-2503.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for \"PowerShell\" was generated for powershell.exe spawned from a PowerShell stager.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2436.png"], "Footnotes": []}]}, {"Substep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection was received that included a PowerShell script and explained that it was used to download and execute another script from 192.168.0.4 over port 443.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-2503.png", "CyCraft-APT29-12483.png"], "Footnotes": []}]}, {"Substep": "11.A.14", "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 12, "Step_Name": "Fortify Access", "Substeps": [{"Substep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic alert detection for Discovery (blue icon) was genereated due to PowerShell enumeration of System32.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2438.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.006", "Subtechnique_Name": "Indicator Removal on Host: Timestomp"}, "Detections": [{"Detection_Note": "A Technique alert detection (purple icon) for \"Timestomp\" was generated when the kxwn.lock was created with falsified creation, last access, and last write times.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2437.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Timestomp\" occured that noted modified timestamp of kxwn.lock.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12485.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "A Technique alert detection (red icon) for \"Security Software Discovery\" was generated due to powershell.exe loading a custom script that contained code to detect installed antivirus products.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2439.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Security Software Discovery\" was received that included PowerShell gwmi query for AntiVirusProduct", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12487.png", "CyCraft-APT29-12485.png"], "Footnotes": []}]}, {"Substep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for the script block with registry query for installed software. The event was correlated to a previous detection for \"Security Software Discovery.\"", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2440.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Query Registry\" was received that included a PowerShell script and explained that it was used to detect installed software.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Processing)"], "Screenshots": ["CyCraft-APT29-12488.png"], "Footnotes": []}]}, {"Substep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for the scriptblock with registry query for installed software. The event was correlated to a previous detection for \"Security Software Discovery.\"", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2440.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Query Registry\" was received that included a PowerShell script and explained that it was used to detect installed software.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12488.png"], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Reconnaissance", "Substeps": [{"Substep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated due to the execution of the comp function.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2441.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"System Information Discovery\" occurred containing evidence of PowerShell calling the GetComputerNameEx API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12489.png"], "Footnotes": []}]}, {"Substep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for Threat Activity.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2442.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell script and explained that it was used to obtain the domain name.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Processing)"], "Screenshots": ["CyCraft-APT29-12490.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection was generated for powershell.exe executing the script which contained GetUserNameEx API function. The event was correlated to a parent Technique detection for PowerShell.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2443.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used enumerate users.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12489.png"], "Footnotes": []}]}, {"Substep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for Threat Activity.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CyCraft-APT29-2316.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Process Discovery\" occurred with evidence of a PowerShell script used to enumerate processes.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12489.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Elevation & Credential Access", "Substeps": [{"Substep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for powershell.exe loading code that creates the DelegateExecute Registry key.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2446.png", "CyCraft-APT29-2319.png"], "Footnotes": []}]}, {"Substep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A General alert detection (yellow indicator) was generated showing a new High Integrity PowerShell callback spawned from control.exe.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2320.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Bypass User Account Control\" was received that included a PowerShell script and explained that it was used to bypass UAC.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12498.png", "CyCraft-APT29-12495.png"], "Footnotes": []}]}, {"Substep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection was received that included a PowerShell script and explained that it was used to clean the Registry after a UAC Bypass.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12498.png"], "Footnotes": []}]}, {"Substep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1047", "Technique_Name": "Windows Management Instrumentation"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Windows Management Instrumentation\" was received that included a PowerShell script and explained that it was used to set up execution of Mimikatz.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12500.png", "CyCraft-APT29-12499.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Execution\" with \"T1047 Windows Management Instrumentation\" label was generated for WmiPrvSE.exe executing powershell.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-14976.png", "CyCraft-APT29-14975.png"], "Footnotes": []}]}, {"Substep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Process Discovery\" was generated for PowerShell executing Get-Process.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2456.png", "CyCraft-APT29-2450.png"], "Footnotes": []}]}, {"Substep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (purple indicator) was generated identifying the PowerShell command to download m.exe as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2339.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (purple indicator) was generated showed the file write event for m.exe into the System32 folder.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2452.png", "CyCraft-APT29-2342.png"], "Footnotes": []}]}, {"Substep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) of \"Credential Dumping\" was generated for dumping credentials/keys from Lsass process memory", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2454.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) of \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2453.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Credential Dumping\" was received that described the adversary executing m.exe to access LSASS process memory.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12501.png"], "Footnotes": []}]}, {"Substep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated showing PowerShell writing encoded content into the WMI class.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2455.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Obfuscated Files or Information\" was received that included a PowerShell script and explained that it was used to write the Mimikatz payload to Win32_AuditCode.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12502.png"], "Footnotes": []}]}, {"Substep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for PowerShell reading encoded content from the WMI class.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2456.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Obfuscated Files or Information\" was received that included a PowerShell script and explained that it was used to write the Mimikatz payload to Win32_AuditCode.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12502.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated when powershell.exe ran the script, which obtained the name of the current user.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2457.png"], "Footnotes": []}]}, {"Substep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" was occurred containing evidence of a PowerShell script and explained that it was used establish persistence.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12504.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red alert icon) for \"Windows Management Instrumentation Event Subscription\" was generated due to the WindowsParentalControlMigration event filter creation.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2458.png"], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for powershell.exe executing the Get-NetDomainController command.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2463.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Remote System Discovery\" was received that included a PowerShell script and explained that it was used to discover a remote system.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12506.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) for threat activity was generated for PowerShell executing the ConvertSidToStringSid API function.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2357.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell script and explained that it was used to obtain the domain SID from the current user's SID.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12506.png"], "Footnotes": []}]}, {"Substep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for the PowerShell script which contained ConvertSidToStringSid API function being loaded.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2357.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Execution through API\" was received that included a PowerShell script and explained that it was used to execute the ConvertSidToStringSid API function from Advapi32.dll.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12506.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) for threat activity was generated for powershell.exe executing the Invoke-WinRMSession command.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2358.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Windows Remote Management\" was received that included a PowerShell command and explained that it was used to create a WinRM session to host Scranton (10.0.1.4).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12506.png"], "Footnotes": []}]}, {"Substep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) was generated for the successful logon event  on NewYork (10.0.0.4) as user MScott.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2362.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Valid Accounts\" was received that described the adversary establishing a WinRM session with MScott's credentials.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12506.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (purple indicator) for File Movement was generated indicating that m.exe was moved from host Utica (10.0.1.5) to host NewYork (10.0.0.4).", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2473.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Remote File Copy\" was received that described the adversary moving m.exe from host Utica (10.0.1.5) to host NewYork (10.0.0.4).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12511.png", "CyCraft-APT29-12510.png"], "Footnotes": []}]}, {"Substep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2475.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (yellow indicator) was generated identifying m.exe as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2474.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Credential Dumping\" was received that described the adversary remotely executing m.exe to dump the krbtgt hash.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12513.png", "CyCraft-APT29-12514.png", "CyCraft-APT29-12506.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Collection", "Substeps": [{"Substep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1114", "Technique_Name": "Email Collection"}, "Subtechnique": {"Subtechnique_Id": "T1114.001", "Subtechnique_Name": "Email Collection: Local Email Collection"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Email Collection\" was generated when powershell.exe loaded an Outlook DLL.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2478.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Email Collection\" was received that included a PowerShell script and explained that it was used to obtain the collect emails.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-2479.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for the PowerShell script which included compressing collection via the ZipFile.CreateFromDirectory .NET method.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2386.png", "CyCraft-APT29-2481.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of data compression.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12516.png"], "Footnotes": []}]}, {"Substep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated for the PowerShell script, which included PowerShell appending the GIF file header to the compressed file.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2481.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence PowerShell was used to add noisy data (GIF89) to an archive.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12516.png"], "Footnotes": []}]}]}, {"Step_Num": 18, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1102", "Technique_Name": "Web Service"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Web Service\" was received that described the adversary mapping OneDrive as a network device and exfiltrating data to it.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12519.png", "CyCraft-APT29-12518.png"], "Footnotes": []}]}, {"Substep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1567", "Technique_Name": "Exfiltration Over Web Service"}, "Subtechnique": {"Subtechnique_Id": "T1567.002", "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage"}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated identifying PowerShell executing Copy-Item as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2485.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Exfiltration Over Alternative Protocol\" was received that described the adversary mapping OneDrive as a network device and exfiltrating data to it.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12519.png", "CyCraft-APT29-12518.png"], "Footnotes": []}]}]}, {"Step_Num": 20, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for rundll32.exe executing kxwn.lock.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2491.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Rundll32\" described rundll32.exe executing kxwn.lock, triggered by Registry Run Keys / Startup Folder persistence.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12521.png"], "Footnotes": []}]}, {"Substep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "A Technique alert detection (red alert icon) for \"Windows Management Instrumentation Event Subscription\" was generated for wmiprvse.exe executing the PowerShell stager.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-15516.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" was received that described the triggering of a WMI Event Subscription upon logon of user Oscar in order to execute powershell.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12522.png", "CyCraft-APT29-12521.png"], "Footnotes": []}]}, {"Substep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicatorl) for \"Powershell\" was generated due to  a SYSTEM-level powershell.exe spawning from wmiprvse.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2494.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"PowerShell\" was received that described execution of powershell.exe triggered by a WMI Event Subscription.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12522.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.003", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket"}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated identifying PowerShell executing Invoke-Mimikatz as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2496.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (yellow indicator) called of \"Pass the Ticket\" was generated when the user MScott forged a suspicious Kerberos ticket with the domain krbtgt.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2495.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Pass the Ticket\" was received that described the adversary using Mimikatz to forge a golden ticket.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12523.png", "CyCraft-APT29-12521.png"], "Footnotes": []}]}, {"Substep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "A General alert detection (blue indicator) was generated identifying PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4) as threat activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2498.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (orange indicator) for execution and tagged with \"Windows Remote Management\" was generated when net.exe was executed remotely on Scranton by wsmprovhost.exe.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2500.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Windows Remote Management\" was received that described the adversary using a golden ticket to establish a WinRM session to Scranton (10.0.1.4)", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12523.png", "CyCraft-APT29-12521.png"], "Footnotes": []}]}, {"Substep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "A Technique alert detection (orange indicator) for \"Account Operation\" was generated for the addition of the new user Toby.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CyCraft-APT29-2500.png", "CyCraft-APT29-2501.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Create Account\" was received that described the attacker creating a new account on host Scranton (10.0.1.4) for persistence.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CyCraft-APT29-12523.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (orange indicator) for \"Create Account\" was generated for net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for creation of a Windows Remote Management session.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CyCraft-APT29-2500.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Eval_Range_Screenshots": {"Scenario_1": [{"Screenshot_Name": "Carbanak-FIN7_CC_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CC_1_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CC_1_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CC_1_3.png", "Screenshot_Caption": ""}], "Scenario_2": [{"Screenshot_Name": "Carbanak-FIN7_CC_2_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CC_2_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CC_2.png", "Screenshot_Caption": ""}]}, "Linux_Participant": true, "Alerting_Strategy": "Events that are deemed to be related to a suspicious or malicious behavior are assigned appropriate severity values (1-10). These behaviors are also enriched with a short description, related events, and potential mapping(s) to related ATT&CK Tactics and Techniques. Tagged behaviors are aggregated into specific views as well as highlighted (with specific icons and colors) when included as part of other views of system events/data.", "Correlation_Strategy": "Campaign Graph and Behavior Graph views highlight potentially associated suspicious or malicious behaviors in an environment. Each detection includes one or more hosts and process tree views which capture correlation between system events and data, such as process lineage or interactions between processes and files or network connections. Campaign Sequence views are also available to provide a timeline of events across multiple hosts.", "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "1.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1204 User Execution\" (3) was generated when explorer.exe spawned winword.exe when the user clicks 1-list.rtf.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "3", "Indicator_Name": "T1204 User Execution"}], "Linux_Only": false}, {"Substep": "1.A.2", "Procedure": "", "Criteria": "winword.exe loads VBE7.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.3", "Procedure": "", "Criteria": "wscript.exe executes unprotected.vbe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.005 Command and Scripting Interpreter (Visual Basic)\" (6) was generated when wscript.exe spawned unprotected.vbe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.3_2.png", "Carbanak-FIN7_CC_1.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "6", "Indicator_Name": "T1059.005 Command and Scripting Interpreter (Visual Basic)"}], "Linux_Only": false}, {"Substep": "1.A.4", "Procedure": "", "Criteria": "unprotected.vbe is an encoded file", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.5", "Procedure": "", "Criteria": "wscript.exe decodes content and creates starter.vbs", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.5_1.png", "Carbanak-FIN7_CC_1.A.5_2.png", "Carbanak-FIN7_CC_1.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (4) was generated when wscript.exe decoded and created starter.vbs.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.5_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "4", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.6", "Procedure": "", "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (4) was generated when wscript.exe decoded and created TransBaseOdbcDriver.js.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "4", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.7", "Procedure": "", "Criteria": "wscript.exe executes starter.vbs", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.005 Command and Scripting Interpreter (Visual Basic)\" (5) was generated when wscript.exe executed starter.vbs.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "T1059.005 Command and Scripting Interpreter (Visual Basic)"}], "Linux_Only": false}, {"Substep": "1.A.8", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (4) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.8_4.png", "Carbanak-FIN7_CC_1.A.8_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "4", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}], "Linux_Only": false}, {"Substep": "1.A.9", "Procedure": "", "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.9_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059 Command and Scripting Interpreter\" (5) was generated when cmd.exe spawned wscript.exe to execute TransBaseOdbcDriver.js.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_1.A.9.png", "Carbanak-FIN7_CC_1.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "T1059 Command and Scripting Interpreter"}], "Linux_Only": false}, {"Substep": "1.A.10", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.11", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 2, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "2.A.2", "Procedure": "", "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"T1082 System Information Discovery\" (7) was generated when wscript.exe makes WMI queries for Win32_OperatingSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.A.2_1.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "7", "Indicator_Name": "T1082 System Information Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.A.2.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.A.4", "Procedure": "", "Criteria": "wscript.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"T1057 Process Discovery\" (7) was generated when wscript.exe made a WMI query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.A.4.png"], "Footnotes": [], "Data_Sources": ["WMI Objects"], "Indicator": "7", "Indicator_Name": "T1057 Process Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.A.4_1.png"], "Footnotes": [], "Data_Sources": ["WMI Objects"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.1", "Procedure": "", "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.B.1.png", "Carbanak-FIN7_CC_2.B.1_1.png", "Carbanak-FIN7_CC_2.B.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (7) was generated when wscript.exe downloaded screenshot__.ps1 from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"Execution\" (7) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "Execution"}], "Linux_Only": false}, {"Substep": "2.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (4) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "4", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}], "Linux_Only": false}, {"Substep": "2.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1113 Screen Capture\" (7) was generated when powershell.exe executed CopyFromScreen().", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_2.B.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": "T1113 Screen Capture"}], "Linux_Only": false}, {"Substep": "2.B.5", "Procedure": "", "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 3, "Step_Name": "Deploy Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Tactic detection named \"Execution\" (7) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "Execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.A.2", "Procedure": "", "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (5) was generated when cmd.exe spawned reg.exe to modify the registry.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.A.3", "Procedure": "", "Criteria": "Value added to Registry is base64 encoded", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.1", "Procedure": "", "Criteria": "wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (7) was generated when wscript.exe downloaded LanCradDriver.ps1 from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.1_2.png", "Carbanak-FIN7_CC_3.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Tactic detection named \"Execution\" (7) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "Execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (9) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.3_1.png", "Carbanak-FIN7_CC_3.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.3_3.png", "Carbanak-FIN7_CC_3.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.4", "Procedure": "", "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (7) was generated when powershell.exe read a value from the Registry via Get-ItemProperty.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.5", "Procedure": "", "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.5.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (7) was generated when powershell.exe decrypted, decompressed, and base64 decoded the Registry value into plaintext shellcode.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.6", "Procedure": "", "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (7) was generated when powershell.exe executed the shellcode from the Registry via the CreateThread() API.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_3.B.6_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 4, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "4.A.1", "Procedure": "", "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.A.1_2.png", "Carbanak-FIN7_CC_4.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.2", "Procedure": "", "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.A.2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (3) was generated when powershell.exe executed Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "3", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.3", "Procedure": "", "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (3) was generated when powershell.exe executed Find-LocalAdminAccess, which connected to multiple hosts over port 135 to check for access.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "3", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.4", "Procedure": "", "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.A.4_1.png", "Carbanak-FIN7_CC_4.A.4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Authentication Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.1", "Procedure": "", "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.2", "Procedure": "", "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (10) was generated when powershell.exe downloaded smrs.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "10", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.3", "Procedure": "", "Criteria": "powershell.exe executes rad353F7.ps1", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpeter (PowerShell)\" (4) was generated when powershell.exe executed rad353F7.ps1.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "4", "Indicator_Name": "T1059.001 Command and Scripting Interpeter (PowerShell)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.4", "Procedure": "", "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (10) was generated when powershell.exe added a value to the Registry via New-Item and New-ItemProperty.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "10", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.5", "Procedure": "", "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection was generated when fodhelper.exe spawned cmd.exe as a high-integrity process.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.6", "Procedure": "", "Criteria": "cmd.exe spawns smrs.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Tactic detection named \"Execution\" (9) was generated when cmd.exe executed smrs.exe.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "Execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.7", "Procedure": "", "Criteria": "smrs.exe opens and reads lsass.exe", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.7_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (10) was generated when smrs.exe is identified as Mimikatz.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.7_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "10", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 5, "Step_Name": "Expand Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "", "Criteria": "powershell.exe downloads pscp.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.2", "Procedure": "", "Criteria": "powershell.exe downloads psexec.py from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.3", "Procedure": "", "Criteria": "powershell.exe downloads runtime from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.4", "Procedure": "", "Criteria": "powershell.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.5", "Procedure": "", "Criteria": "powershell.exe downloads tiny.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.6", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"Execution\" (7) was generated when powershell.exe spawned cmd.exe.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.6_2.png", "Carbanak-FIN7_CC_5.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "Execution"}], "Linux_Only": false}, {"Substep": "5.A.7", "Procedure": "", "Criteria": "Pscp.exe connects over SCP (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1021.004 Remote Services (SSH)\" (6) was generated when user kmitnick logged on via SSH to bankfileserver (10.0.0.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "6", "Indicator_Name": "T1021.004 Remote Services (SSH)"}], "Linux_Only": true}, {"Substep": "5.A.8", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1078 Valid Accounts\" (6) was generated when user kmitnick logged on to bankfileserver (10.0.0.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "6", "Indicator_Name": "T1078 Valid Accounts"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.8.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.9", "Procedure": "", "Criteria": "Pscp.exe copies psexec.py to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (6) was generated when pscp.exe copied psexec.py to bankfileserver (10.0.0.7).", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "6", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1570 Lateral Tool Transfer\" (5) was generated when scp on bankfileserver (10.0.0.7) was invoked by another scp instance to receive psexec.py.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.9_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring"], "Indicator": "5", "Indicator_Name": "T1570 Lateral Tool Transfer"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.9.png", "Carbanak-FIN7_CC_5.A.9_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.10", "Procedure": "", "Criteria": "Pscp.exe copies runtime to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (2) was generated when pscp.exe copied runtime to bankfileserver (10.0.0.7).", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.10_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "2", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.10_1.png", "Carbanak-FIN7_CC_5.A.10_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1570 Lateral Tool Tansfer\" (5) was generated when scp on bankfileserver (10.0.0.7) was invoked by another scp instance to receive runtime.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.10_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "T1570 Lateral Tool Tansfer"}], "Linux_Only": true}, {"Substep": "5.A.11", "Procedure": "", "Criteria": "Pscp.exe copies tiny.exe to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (2) was generated when pscp.exe copied tiny.exe to bankfileserver (10.0.0.7).", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.11_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "2", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.11.png", "Carbanak-FIN7_CC_5.A.11_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1570 Lateral Tool Transfer\" (5) was generated when scp on bankfileserver (10.0.0.7) was invoked by another scp instance to receive tiny.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.A.11_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "T1570 Lateral Tool Transfer"}], "Linux_Only": true}, {"Substep": "5.B.1", "Procedure": "", "Criteria": "plink.exe connects over SSH (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "A General detection (None) was generated when plink.exe ran with destination bankfileserver (10.0.0.7).", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "None", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.1_4.png", "Carbanak-FIN7_CC_5.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1021.004 Remote Services (SSH)\" (6) was generated when user kmitnick logged on via SSH to bankfileserver (10.0.0.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.1.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "6", "Indicator_Name": "T1021.004 Remote Services (SSH)"}], "Linux_Only": true}, {"Substep": "5.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1078 Valid Accounts\" (6) was generated when user kmitnick logged on to bankfileserver (10.0.0.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.2.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "6", "Indicator_Name": "T1078 Valid Accounts"}], "Linux_Only": true}, {"Substep": "5.B.3", "Procedure": "", "Criteria": "User kmitnick executes ps ax", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"T1057 Process Discovery\" (5) was generated when user kmitnick executed ps ax.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "T1057 Process Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.4", "Procedure": "", "Criteria": "User kmitnick executes ls -lsahR /var/", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1083 File and Directory Discovery\" (2) was generated when user kmitnick executed ls -lsahR /var/.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "2", "Indicator_Name": "T1083 File and Directory Discovery"}], "Linux_Only": true}, {"Substep": "5.B.5", "Procedure": "", "Criteria": "User kmitnick reads network-diagram-financial.xml via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.5_3.png", "Carbanak-FIN7_CC_5.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1005 Data from Local System\" (2) was generated when user kmitnick read network-diagram-financial.xml via cat.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.5_1.png", "Carbanak-FIN7_CC_5.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "2", "Indicator_Name": "T1005 Data from Local System"}], "Linux_Only": true}, {"Substep": "5.B.6", "Procedure": "", "Criteria": "User kmitnick reads help-desk-ticket.txt via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.6_1.png", "Carbanak-FIN7_CC_5.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1005 Data from Local System\" (6) was generated when user kmitnick read help-desk-ticket.txt via cat.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.6_2.png", "Carbanak-FIN7_CC_5.B.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "6", "Indicator_Name": "T1005 Data from Local System"}], "Linux_Only": true}, {"Substep": "5.B.7", "Procedure": "", "Criteria": "User kmitnick enumerates the domain controller via nslookup, which queries for the DC (10.0.0.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"T1018 Remote System Discovery\" (2) was generated when user kmitnick enumerated the domain controller via nslookup.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.7.png", "Carbanak-FIN7_CC_5.B.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "2", "Indicator_Name": "T1018 Remote System Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.B.7_2.png", "Carbanak-FIN7_CC_5.B.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.C.1", "Procedure": "", "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1550.002 Use Alternate Authentication Material (Pass the Hash)\" (9) was generated when psexec.py logged on to bankdc (10.0.0.4) as user kmitnick.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.1.png", "Carbanak-FIN7_CC_5.C.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "T1550.002 Use Alternate Authentication Material (Pass the Hash)"}], "Linux_Only": false}, {"Substep": "5.C.2", "Procedure": "", "Criteria": "psexec.py connects to SMB shares on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1021.002 Remote Services (SMB/Windows Admin Shares)\" (10) was generated when SMB shares were accessed on bankdc (10.0.0.4).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.2_1.png", "Carbanak-FIN7_CC_5.C.2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "10", "Indicator_Name": "T1021.002 Remote Services (SMB/Windows Admin Shares)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.3", "Procedure": "", "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (5) was generated when a service executable in C:\\Windows\\ spawned cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.4", "Procedure": "", "Criteria": "tiny.exe is created on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (10) was generated when tiny.exe was created on bankdc (10.0.0.4).", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "10", "Indicator_Name": ""}, {"Detection_Note": "A General detection (10) was generated when tiny.exe was created on bankdc (10.0.0.4) and was associated with other flagged suspicious processes.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.4_1.png", "Carbanak-FIN7_CC_5.C.4_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "10", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.5", "Procedure": "", "Criteria": "cmd.exe spawns tiny.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059 Command and Scripting Intepreter\" (5) was generated when cmd.exe spawned tiny.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "T1059 Command and Scripting Intepreter"}], "Linux_Only": false}, {"Substep": "5.C.6", "Procedure": "", "Criteria": "tiny.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (9) was generated when tiny.exe loaded shellcode from a network connection into memory.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 6, "Step_Name": "Discover Potential Targets", "Substeps": [{"Substep": "6.A.1", "Procedure": "", "Criteria": "tiny.exe loads system.management.automation.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "6.A.2", "Procedure": "", "Criteria": "PowerShell executes Get-ADComputer", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (10) was generated when PowerShell executed Get-ADComputer.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_6.A.2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "10", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_6.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "6.A.3", "Procedure": "", "Criteria": "PowerShell executes Get-NetUser", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "A General detection (10) was generated when PowerShell executes Get-NetUser.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_6.A.3.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "10", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_6.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 7, "Step_Name": "Setup Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "", "Criteria": "tiny.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.2", "Procedure": "", "Criteria": "tiny.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"Execution\" (5) was generated when tiny.exe spawned cmd.exe.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "Execution"}], "Linux_Only": false}, {"Substep": "7.A.3", "Procedure": "", "Criteria": "plink.exe transmits data to 192.168.0.4 over SSH protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to bankdc (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A General detection (6) was generated when user kmitnick logged on to bankdc (10.0.0.4).", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.A.4.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "6", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.5", "Procedure": "", "Criteria": "RDP session from the localhost over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.A.5.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.B.1", "Procedure": "", "Criteria": "powershell.exe executes qwinsta /server:cfo", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1033 System Owner/User Discovery\" (6) was generated when powershell.exe executed qwinsta /server:cfo.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "6", "Indicator_Name": "T1033 System Owner/User Discovery"}], "Linux_Only": false}, {"Substep": "7.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to cfo (10.0.0.5)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Remote Desktop Access (RDP)\" (6) was generated when user kmitnick logged on to cfo (10.0.0.5) .", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.B.2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "6", "Indicator_Name": "Remote Desktop Access (RDP)"}], "Linux_Only": false}, {"Substep": "7.B.3", "Procedure": "", "Criteria": "RDP session from 10.0.0.4 to 10.0.0.5 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1021 Remote Services (Remote Desktop Protocol)\" (6) was generated when a logon event by kmitnick was detected as an RDP Login on cfo (10.0.0.5).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "6", "Indicator_Name": "T1021 Remote Services (Remote Desktop Protocol)"}], "Linux_Only": false}, {"Substep": "7.C.1", "Procedure": "", "Criteria": "scp.exe downloads Java-Update.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (10) was generated when Java-Update.exe was created.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.C.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "10", "Indicator_Name": ""}, {"Detection_Note": "A General detection (10) was generated when Java-Update.exe had an invalid certificate and was associated with other flagged suspicious processes.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.C.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "10", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.C.1_5.png", "Carbanak-FIN7_CC_7.C.1_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (9) was generated when scp.exe downloaded Java-Update.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.C.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.2", "Procedure": "", "Criteria": "dir lists the contents of C:\\Users\\Public", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.3", "Procedure": "", "Criteria": "cmd.exe downloads Java-Update.vbs from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.4", "Procedure": "", "Criteria": "Java-Update subkey is added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.C.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1547.001 Boot or Logon Autostart Execution (Registry Run Keys / Startup Folder)\" (5) was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_7.C.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "T1547.001 Boot or Logon Autostart Execution (Registry Run Keys / Startup Folder)"}], "Linux_Only": false}]}, {"Step_Num": 8, "Step_Name": "Gain Covert Access to Target", "Substeps": [{"Substep": "8.A.1", "Procedure": "", "Criteria": "wscript.exe spawns Java-Update.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_8.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.005 Command and Scripting Intepreter (Visual Basic)\" (7) was generated when wscript.exe spawned Java-Update.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_8.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1059.005 Command and Scripting Intepreter (Visual Basic)"}], "Linux_Only": false}, {"Substep": "8.A.2", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "8.A.3", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 9, "Step_Name": "Profile a Victim User", "Substeps": [{"Substep": "9.A.1", "Procedure": "", "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (2) was generated when DefenderUpgradeExec.exe was created.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_9.A.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "2", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_9.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.2", "Procedure": "", "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1056 Input Capture (Keylogging)\" (4) was generated when analysis of DLL modules in DefenderUpgradeExec.exe showed SetWindowsHookEx.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_9.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring", "DLL Monitoring"], "Indicator": "4", "Indicator_Name": "T1056 Input Capture (Keylogging)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_9.A.2.png", "Carbanak-FIN7_CC_9.A.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.3", "Procedure": "", "Criteria": "Java-Update.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.4", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_9.A.4_1.png", "Carbanak-FIN7_CC_9.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (5) was generated when analysis of DLL modules in explorer.exe showed CreateCompatibleBitmap and Gdi32.dll.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_9.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.5", "Procedure": "", "Criteria": "explorer.exe reads C:\\Users\\jsmith\\AppData\\Local\\Temp\\Klog2.txt over to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.1", "Procedure": "", "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.2", "Procedure": "", "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.3", "Procedure": "", "Criteria": "powershell.exe deletes files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1070.004 Indicator Removal on Host (File Deletion)\" (7) was generated when powershell.exe deleted files in: C:\\Users\\jsmith\\AppData\\Local\\Temp\\.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_9.B.3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1070.004 Indicator Removal on Host (File Deletion)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_9.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 10, "Step_Name": "Impersonate Victim", "Substeps": [{"Substep": "10.A.1", "Procedure": "", "Criteria": "explorer.exe downloads tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.2", "Procedure": "", "Criteria": "explorer.exe downloads vnc-settings.reg from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.3", "Procedure": "", "Criteria": "netsh adds Service Host rule for TCP port 5900", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1562", "Technique_Name": "Impair Defenses"}, "Subtechnique": {"Subtechnique_Id": "T1562.004", "Subtechnique_Name": "Impair Defenses: Disable or Modify System Firewall"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1562 Impair Defenses (Disable or Modify System Firewall)\" (7) was generated when netsh.exe added 'Service Host' rule to allow TCP port 5900 inbound.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_10.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1562 Impair Defenses (Disable or Modify System Firewall)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_10.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.4", "Procedure": "", "Criteria": "msiexec.exe adds the tvncontrol subkey in HKLM\\Software\\Microsoft\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_10.A.4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1547 Boot or Logon Autostart Execution (Registry Run Keys / Startup Folder)\" (4) was generated when tvncontrol subkey was added to HKLM\\Software\\Microsoft\\CurrentVersion\\Run.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_10.A.4_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Windows Registry"], "Indicator": "4", "Indicator_Name": "T1547 Boot or Logon Autostart Execution (Registry Run Keys / Startup Folder)"}], "Linux_Only": false}, {"Substep": "10.A.5", "Procedure": "", "Criteria": "Addition of subkeys in HKLM\\Software\\TightVNC\\Server", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.6", "Procedure": "", "Criteria": "Deletion of the Java-Update subkey in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (5) was generated when Java-Update subkey at HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run was deleted.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_10.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_10.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.B.1", "Procedure": "", "Criteria": "tvnserver.exe accepts a connection from 192.168.0.4 over TCP port 5900", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1219", "Technique_Name": "Remote Access Software"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "11.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"T1204 User Execution\" (3) was generated when explorer.exe spawned winword.exe when the user clicked 2-list.rtf.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "3", "Indicator_Name": "T1204 User Execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.2", "Procedure": "", "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.3", "Procedure": "", "Criteria": "winword.exe spawns mshta.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1218.005 Signed Binary Proxy Execution (Mshta)\" (7) was generated when winword.exe spawned mshta.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1218.005 Signed Binary Proxy Execution (Mshta)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.4", "Procedure": "", "Criteria": "mshta.exe executes an embedded VBScript payload", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1218.005 Signed Binary Proxy Execution (Mshta)\" (7) was generated when mshta.exe executed an embedded VBScript payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.4_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1218.005 Signed Binary Proxy Execution (Mshta)"}], "Linux_Only": false}, {"Substep": "11.A.5", "Procedure": "", "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (5) was generated when mshta.exe assembled text embedded within 2-list.rtf into a JS payload.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.5_1.png", "Carbanak-FIN7_CC_11.A.5.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.6", "Procedure": "", "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Detections": [{"Detection_Note": "A General detection (5) was generated when mshta.exe made a copy of the legitimate wscript.exe as adb156.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "5", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.6.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.7", "Procedure": "", "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.8", "Procedure": "", "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "A General detection (5) was generated when mshta.exe created a scheduled task to execute in 5 minutes.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.8_1.png", "Carbanak-FIN7_CC_11.A.8.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "5", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Scheduled Task\" was generated when a scheduled task was created.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "Scheduled Task"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.8_4.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 12, "Step_Name": "Delayed Malware Execution", "Substeps": [{"Substep": "12.A.1", "Procedure": "", "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1053 Scheduled Task/Job (Scheduled Task)\" (9) was generated when svchost.exe spawned adb156.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "T1053 Scheduled Task/Job (Scheduled Task)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.2", "Procedure": "", "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (9) was generated when adb156.exe executed sql-rat.js using Jscript.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.3", "Procedure": "", "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (3) was generated when adb156.exe connected to 192.168.0.6 via MSSQL transactions.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "3", "Indicator_Name": ""}, {"Detection_Note": "A General detection (9) was generated when adb156.exe connected to 192.168.0.6 port 1433 via MSSQL transactions.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (7) was generated when adb156.exe made a WMI query for Win32_NetworkAdapterConfiguration.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "7", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.5", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"Discovery\" (7) was generated when adb156.exe made a WMI query for Win32_LogicalDisk.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "7", "Indicator_Name": "Discovery"}], "Linux_Only": false}, {"Substep": "12.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads stager.ps1 from 192.168.0.6", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.B.1_2.png", "Carbanak-FIN7_CC_12.B.1_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (10) was generated when adb156.exe downloaded stager.ps1 from 192.168.0.6.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "10", "Indicator_Name": ""}, {"Detection_Note": "A General detection (10) was generated when stager.ps1 was created and identified as crimeware/riskware by NGAV.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_12.B.1_4.png", "Carbanak-FIN7_CC_12.B.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "10", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 13, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "13.A.1", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1057 Process Discovery\" (7) was generated when adb156.exe made a WMI query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "7", "Indicator_Name": "T1057 Process Discovery"}], "Linux_Only": false}, {"Substep": "13.A.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (7) was generated when adb156.exe spawned cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.3", "Procedure": "", "Criteria": "cmd.exe executes net view", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"T1135 Network Share Discovery\" (5) was generated when cmd.exe executed net view.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5", "Indicator_Name": "T1135 Network Share Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1497.001 Virtualization/Sandbox Evasion (System Checks)\" (7) was generated when adb156.exe made a WMI query for Win32_BIOS.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.4_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1497.001 Virtualization/Sandbox Evasion (System Checks)"}], "Linux_Only": false}, {"Substep": "13.A.5", "Procedure": "", "Criteria": "Adb156.exe queries the USERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.5.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1033 System Owner/User Discovery\" (7) was generated when adb156.exe queried the USERNAME environment variable.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.5_2.png", "Carbanak-FIN7_CC_13.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": "T1033 System Owner/User Discovery"}], "Linux_Only": false}, {"Substep": "13.A.6", "Procedure": "", "Criteria": "Adb156.exe queries the COMPUTERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"T1082 System Information Discovery\" (7) was generated when adb156.exe queried the COMPUTERNAME environment variable.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.6_1.png", "Carbanak-FIN7_CC_13.A.6.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": "T1082 System Information Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.8", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1082 System Information Discovery\" (7) was generated when adb156.exe made a WMI query for Win32_ComputerSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.8_1.png", "Carbanak-FIN7_CC_13.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "7", "Indicator_Name": "T1082 System Information Discovery"}], "Linux_Only": false}, {"Substep": "13.A.9", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"T1082 System Information Discovery\" (7) was generated when adb156.exe made a WMI query for Win32_OperatingSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "7", "Indicator_Name": "T1082 System Information Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.A.9.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (7) was generated when adb156.exe downloaded takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.1_1.png", "Carbanak-FIN7_CC_13.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (7) was generated when adb156.exe spawns cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (4) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "4", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}], "Linux_Only": false}, {"Substep": "13.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1113 Screen Capture\" (None) was generated when powershell.exe executed CopyFromScreen().", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "None", "Indicator_Name": "T1113 Screen Capture"}], "Linux_Only": false}, {"Substep": "13.B.5", "Procedure": "", "Criteria": "Adb156.exe reads and uploads image.png to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.5_1.png", "Carbanak-FIN7_CC_13.B.5.png", "Carbanak-FIN7_CC_13.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (4) was generated when powershell.exe uploaded image.png to 192.168.0.6 via MSSQL transactions.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_13.B.5_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "4", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 14, "Step_Name": "Staging Interactive Toolkit", "Substeps": [{"Substep": "14.A.1", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (9) was generated when adb156.exe spawned cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.2", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.2.png", "Carbanak-FIN7_CC_14.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (None) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.2_2.png", "Carbanak-FIN7_CC_14.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "None", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}], "Linux_Only": false}, {"Substep": "14.A.3", "Procedure": "", "Criteria": "powershell.exe decodes an embedded DLL payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.3_1.png", "Carbanak-FIN7_CC_14.A.3.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1027 Obfuscated Files or Information\" (5) was generated when powershell.exe decoded an embedded DLL payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "5", "Indicator_Name": "T1027 Obfuscated Files or Information"}], "Linux_Only": false}, {"Substep": "14.A.4", "Procedure": "", "Criteria": "powershell.exe executes the decoded payload using Invoke-Expression (IEX)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (10) was generated when powershell.exe executed the decoded payload using Invoke-Expression.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.4_1.png", "Carbanak-FIN7_CC_14.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "10", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.5", "Procedure": "", "Criteria": "powershell.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"Defense Evasion\" (9) was generated when powershell.exe loaded shellcode from network connection into memory.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.5_1.png", "Carbanak-FIN7_CC_14.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "Defense Evasion"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_14.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.6", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 15, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "15.A.1", "Procedure": "", "Criteria": "powershell.exe calls the CreateToolhelp32Snapshot() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.1_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (9) was generated when powershell.exe calls the CreateToolhelp32Snapshot() API.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.1_3.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "9", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.2", "Procedure": "", "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (10) was generated when samcat.exe was identified by NGAV as Mimikatz.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.2_2.png", "Carbanak-FIN7_CC_15.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "10", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.3", "Procedure": "", "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.4", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (4) was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "4", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.5", "Procedure": "", "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A Tactic detection named \"Privilege Escalation\" (9) was generated when powershell.exe spawned samcat.exe as a high-integrity process.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "Privilege Escalation"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.6", "Procedure": "", "Criteria": "samcat.exe opens and reads the SAM via LSASS", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A General detection named \"S0002 Mimikatz\" (9) was generated when samcat.exe was identified as Mimikatz.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "S0002 Mimikatz"}], "Linux_Only": false}, {"Substep": "15.A.7", "Procedure": "", "Criteria": "powershell.exe calls the GetIpNetTable() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.7.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (9) was generated when powershell.exe calls the GetIpNetTable() API.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "9", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.8", "Procedure": "", "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (6) was generated when powershell.exe spawned nslookup.exe, which queried the DC (10.0.1.4) over DNS (port 53).", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "6", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "", "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (2) was generated when paexec.exe was created.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "2", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.2", "Procedure": "", "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection was generated when hollow.exe was identified by NGAV as Metasploit and associated with stager.ps1 along with other suspicious processes.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.3", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (4) was generated when powershell.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.3_1.png", "Carbanak-FIN7_CC_16.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "4", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}], "Linux_Only": false}, {"Substep": "16.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.5", "Procedure": "", "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1021.002 Remote Services (SMB/Windows Admin Shares)\" (8) was generated when user kmitnick remotely accessed PAExec on itadmin (10.0.1.6) from hotelmanager (10.0.1.5).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "8", "Indicator_Name": "T1021.002 Remote Services (SMB/Windows Admin Shares)"}], "Linux_Only": false}, {"Substep": "16.A.6", "Procedure": "", "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.6_4.png", "Carbanak-FIN7_CC_16.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1569.002 System Services (Service Execution)\" (9) was generated when Windows service started PAExec.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.6_2.png", "Carbanak-FIN7_CC_16.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "T1569.002 System Services (Service Execution)"}], "Linux_Only": false}, {"Substep": "16.A.7", "Procedure": "", "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.8", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.9", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 17, "Step_Name": "Setup User Monitoring", "Substeps": [{"Substep": "17.A.1", "Procedure": "", "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (2) was generated when srrstr.dll was created.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_17.A.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "2", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_17.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.2", "Procedure": "", "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1036 Masquerading\" (9) was generated when srrstr.dll was detected as not legitimate .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_17.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "T1036 Masquerading"}], "Linux_Only": false}, {"Substep": "17.A.3", "Procedure": "", "Criteria": "svchost.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_17.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (4) was generated when svchost.exe spawned cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_17.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "4", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.4", "Procedure": "", "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_17.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1574.001 Hijack Execution Flow (DLL Search Order Hijacking)\" (9) was generated when SystemPropertiesAdvanced.exe executed code in the illegitimate srrstr.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_17.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9", "Indicator_Name": "T1574.001 Hijack Execution Flow (DLL Search Order Hijacking)"}], "Linux_Only": false}, {"Substep": "17.A.5", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.6", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 18, "Step_Name": "User Monitoring", "Substeps": [{"Substep": "18.A.1", "Procedure": "", "Criteria": "svchost.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "18.A.2", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_18.A.2_2.png", "Carbanak-FIN7_CC_18.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (5) was generated when explorer.exe called the CreateCompatibleBitmap API from Gdi32.dll.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_18.A.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "5", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "18.A.3", "Procedure": "", "Criteria": "explorer.exe injects into mstsc.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "18.A.4", "Procedure": "", "Criteria": "mstsc.exe calls APIs such as GetAsyncKeyState, GetKeyState, or GetKeyboardState", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 19, "Step_Name": "Setup Shim Persistence", "Substeps": [{"Substep": "19.A.1", "Procedure": "", "Criteria": "User kmitnick logs on to accounting (10.0.1.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A General detection (6) was generated when user kmitnick logged on to accounting (10.0.1.7) detected as RDP Login.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "6", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.A.1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.A.2", "Procedure": "", "Criteria": "RDP session from 10.0.1.6 to 10.0.1.7 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1021.001 Remote Services (Remote Desktop Protocol)\" (6) was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.A.2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "6", "Indicator_Name": "T1021.001 Remote Services (Remote Desktop Protocol)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.A.3", "Procedure": "", "Criteria": "itadmin (10.0.1.6) is relaying RDP traffic from attacker infrastructure", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1090", "Technique_Name": "Proxy"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (7) was generated when ktminick logged onto accounting from workstation \"attack-evals\" .", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "7", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.1", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1059.001 Command and Scripting Interpreter (PowerShell)\" (7) was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1059.001 Command and Scripting Interpreter (PowerShell)"}], "Linux_Only": false}, {"Substep": "19.B.2", "Procedure": "", "Criteria": "powershell.exe executes base64 encoded commands", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (7) was generated when powershell.exe executed base64 encoded commands\n.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "7", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.2.png"], "Footnotes": [], "Data_Sources": ["Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.3", "Procedure": "", "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (7) was generated when powershell.exe downloaded dll329.dll from 192.168.0.4 over RDP mounted network drive\n.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "7", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.3_3.png", "Carbanak-FIN7_CC_19.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.4", "Procedure": "", "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (7) was generated when powershell.exe downloaded sdbE376.tmp from 192.168.0.4 over RDP mounted network drive\n.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "7", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.5", "Procedure": "", "Criteria": "sdbinst.exe installs sdbE376.tmp shim", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1546.011 Event Triggered Execution (Application Shimming)\" (7) was generated when sdbinst.exe installed sdbE376.tmp shim database\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1546.011 Event Triggered Execution (Application Shimming)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_19.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 20, "Step_Name": "Steal Payment Data", "Substeps": [{"Substep": "20.A.1", "Procedure": "", "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.A.1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1546 Event Triggered Execution (Application Shimming)\" (7) was generated when dll329.dll is injected into AccountingIQ.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.A.1_1.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "7", "Indicator_Name": "T1546 Event Triggered Execution (Application Shimming)"}], "Linux_Only": false}, {"Substep": "20.A.2", "Procedure": "", "Criteria": "AccountingIQ.exe injects into SyncHost.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.A.2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"T1055 Process Injection\" (9) was generated when AccountingIQ.exe injects into SyncHost.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.A.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "9", "Indicator_Name": "T1055 Process Injection"}], "Linux_Only": false}, {"Substep": "20.A.3", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.A.4", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.1", "Procedure": "", "Criteria": "rundll32.exe downloads debug.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (5) was generated when debug.exe was created.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.B.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "5", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.B.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (6) was generated when debug.exe was created in a suspicious folder.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.B.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "6", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.2", "Procedure": "", "Criteria": "debug.exe calls the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.3", "Procedure": "", "Criteria": "rundll32.exe downloads 7za.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.B.3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection (6) was generated when 7za.exe was created in a suspicious folder.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.B.3_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "6", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.4", "Procedure": "", "Criteria": "7za.exe creates C:\\Users\\Public\\log.7z", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Technique detection named \"T1560 Archive Collected Data\" (7) was generated when 7za.exe created C:\\Users\\Public\\log.7z.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7", "Indicator_Name": "T1560 Archive Collected Data"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CC_20.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.5", "Procedure": "", "Criteria": "rundll32.exe reads and uploads log.7z to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}]}}, "Protections": {"Protection_Tests": [{"Test_Num": 1, "Test_Group": "Carbanak", "Test_Name": "Initial Access with Embedded VBE in Word Document", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "1.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf"}, {"Substep_Name": "1.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe loads VBE7.DLL"}, {"Substep_Name": "1.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes unprotected.vbe"}, {"Substep_Name": "1.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "unprotected.vbe is an encoded file"}, {"Substep_Name": "1.A.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates starter.vbs"}, {"Substep_Name": "1.A.6", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.7", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes starter.vbs"}, {"Substep_Name": "1.A.8", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "1.A.9", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.10", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "1.A.11", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "2.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem"}, {"Substep_Name": "2.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes a WMI query for Win32_Process"}, {"Substep_Name": "2.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4"}, {"Substep_Name": "2.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "2.B.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "cmd.exe spawns powershell.exe"}, {"Substep_Name": "2.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes CopyFromScreen()"}, {"Substep_Name": "2.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4"}], "Test_Screenshots": []}, {"Test_Num": 2, "Test_Group": "Carbanak", "Test_Name": "Registry Shellcode and Execution", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "3.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer"}, {"Substep_Name": "3.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Value added to Registry is base64 encoded"}, {"Substep_Name": "3.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty"}, {"Substep_Name": "3.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode"}, {"Substep_Name": "3.B.6", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API"}, {"Substep_Name": "3.B.7", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP"}, {"Substep_Name": "4.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs"}, {"Substep_Name": "4.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4"}, {"Substep_Name": "4.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access"}, {"Substep_Name": "4.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick"}], "Test_Screenshots": []}, {"Test_Num": 3, "Test_Group": "Carbanak", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "4.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4"}, {"Substep_Name": "4.B.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "smrs.exe was removed from disk, because it was identified as mimikatz and blocked.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.2P.png", "Carbanak-FIN7_CC_4.B.2P_2.png", "Carbanak-FIN7_CC_4.B.2P_1.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4"}, {"Substep_Name": "4.B.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe executes rad353F7.ps1"}, {"Substep_Name": "4.B.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty"}, {"Substep_Name": "4.B.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "4.B.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns smrs.exe"}, {"Substep_Name": "4.B.7", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 3 was blocked when smrs.exe could not be executed, because the output file was empty.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CC_4.B.7P_1.png"], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "smrs.exe opens and reads lsass.exe"}], "Test_Screenshots": []}, {"Test_Num": 4, "Test_Group": "Carbanak", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity all on bankfileserver (10.0.0.7) to bankdc (10.0.0.4) as user kmitnick", "Substeps": [{"Substep_Name": "5.C.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 4 was blocked when psexec.py was removed, because it was identified as impacket-psexec.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CC_5.C.1P_5.png", "Carbanak-FIN7_CC_5.C.1P_4.png", "Carbanak-FIN7_CC_5.C.1P_3.png"], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick"}, {"Substep_Name": "5.C.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "psexec.py connects to SMB shares on 10.0.0.4"}, {"Substep_Name": "5.C.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\"}, {"Substep_Name": "5.C.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe is created on 10.0.0.4"}, {"Substep_Name": "5.C.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns tiny.exe"}, {"Substep_Name": "5.C.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe loads shellcode from network connection into memory"}], "Test_Screenshots": []}, {"Test_Num": 5, "Test_Group": "Carbanak", "Test_Name": "Credential Access", "Test_Description": "Activity on cfo (10.0.0.5) as user jsmith", "Substeps": [{"Substep_Name": "9.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4"}, {"Substep_Name": "9.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API"}, {"Substep_Name": "9.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4"}, {"Substep_Name": "9.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll"}], "Test_Screenshots": []}, {"Test_Num": 11, "Test_Group": "FIN7", "Test_Name": "Initial Access with Embedded VBS in Word Document", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "11.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf"}, {"Substep_Name": "11.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk"}, {"Substep_Name": "11.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Criteria": "winword.exe spawns mshta.exe"}, {"Substep_Name": "11.A.4", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 11 was blocked when sql-rat.js was removed upon creation, because it was identified as a backdoor.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CC_11.A.4P_1.png", "Carbanak-FIN7_CC_11.A.4P.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "mshta.exe executes an embedded VBScript payload"}, {"Substep_Name": "11.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload"}, {"Substep_Name": "11.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe"}, {"Substep_Name": "11.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL"}, {"Substep_Name": "11.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes"}, {"Substep_Name": "12.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe"}, {"Substep_Name": "12.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript"}, {"Substep_Name": "12.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions"}, {"Substep_Name": "12.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration"}, {"Substep_Name": "12.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk"}], "Test_Screenshots": []}, {"Test_Num": 12, "Test_Group": "FIN7", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "15.A.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Also, samcat.exe was removed upon create, because it was identified as threat activity.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.2P_2.png", "Carbanak-FIN7_CC_15.A.2P_3.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4"}, {"Substep_Name": "15.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4"}, {"Substep_Name": "15.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "15.A.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "15.A.6", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 12 was blocked when uac-samcats.ps1 failed, because samcat.exe was removed upon creation, because it was identified as Mimikatz.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CC_15.A.6P_2.png", "Carbanak-FIN7_CC_15.A.6P_1.png", "Carbanak-FIN7_CC_15.A.6P.png"], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "samcat.exe opens and reads the SAM via LSASS"}, {"Substep_Name": "15.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the GetIpNetTable() API"}, {"Substep_Name": "15.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)"}], "Test_Screenshots": []}, {"Test_Num": 13, "Test_Group": "FIN7", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity from hotelmanager (10.0.1.5) to itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "16.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4"}, {"Substep_Name": "16.A.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 13 was blocked when hollow.exe was removed after creation, because it was identified as Metasploit.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CC_16.A.2P.png", "Carbanak-FIN7_CC_16.A.2P_1.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4"}, {"Substep_Name": "16.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)"}, {"Substep_Name": "16.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed"}, {"Substep_Name": "16.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe"}, {"Substep_Name": "16.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection"}, {"Substep_Name": "16.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "16.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 14, "Test_Group": "FIN7", "Test_Name": "DLL Hijacking", "Test_Description": "Activity on itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "17.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)"}, {"Substep_Name": "17.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library"}, {"Substep_Name": "17.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll"}, {"Substep_Name": "17.A.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "17.A.6", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 15, "Test_Group": "FIN7", "Test_Name": "Shim Persistence", "Test_Description": "Activity on accounting (10.0.1.7) as user kmitnick", "Substeps": [{"Substep_Name": "19.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "19.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes base64 encoded commands"}, {"Substep_Name": "19.B.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4"}, {"Substep_Name": "19.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4"}, {"Substep_Name": "19.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "sdbinst.exe installs sdbE376.tmp shim"}, {"Substep_Name": "20.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll"}, {"Substep_Name": "20.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "20.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}]}}]}