{"Participant_Name": "VMware Carbon Black", "PublicRelease": "\u00a9 2021 MITRE Engenuity. Approved for Public Release. Document number AT0016", "Aggregate_Data": {"Evaluation_Aggregate_Data": {"Adversaries": [{"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Total_Detections": 204, "Analytic_Detections": 72, "Telemetry_Detections": 100, "Analytic_Coverage": "62/134", "Telemetry_Coverage": "100/134", "Visibility": "102/134", "Total_Substeps": 134}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Total_Detections": 278, "Analytic_Detections": 126, "Telemetry_Detections": 152, "Analytic_Coverage": "90/174", "Telemetry_Coverage": "152/174", "Visibility": "154/174", "Total_Substeps": 174, "Linux_Participant": true}]}}, "Adversaries": [{"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-3702.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (blue indicator) was generated for rcs.3aka3.doc being tagged as suspicious.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-3707.png", "Carbon Black-APT29-3714.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Suspect Malware from executing."]}, {"Detection_Note": "An MSSP detection for the execution of the malicious document rcs.3aka3.doc file.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12751.png"], "Footnotes": []}]}, {"Substep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.002", "Subtechnique_Name": "Masquerading: Right-to-Left Override"}, "Detections": [{"Detection_Note": "Telemetry showed that the file was a .scr binary, and that the filename included the unicode character for RTLO.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-3713.png"], "Footnotes": []}]}, {"Substep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 over TCP port 1234.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-3717.png", "Carbon Black-APT29-3709.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office Documents making network connections."]}, {"Detection_Note": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12751.png"], "Footnotes": []}]}, {"Substep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.001", "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-3718.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12751.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3724.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office documents or untrusted applications spawning command interpreters."]}]}, {"Substep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for \"AMSI - Abnormal Fileless command-line length being executed.\" The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-3737.png", "Carbon Black-APT29-3733.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showing powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3727.png", "Carbon Black-APT29-3723.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Office documents or untrusted applications spawning command interpreters."]}, {"Detection_Note": "An MSSP detection was generated for cmd.exe spawning powershell.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12751.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection was generated for the use of ChildItem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12751.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3750.png", "Carbon Black-APT29-3751.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3751.png", "Carbon Black-APT29-3750.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated for the use of ChildItem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12751.png"], "Footnotes": []}]}, {"Substep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing Compress-Archive", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"Data Compressed via Command Interpreter for Staging\" was generated for a file modification with the .zip extension. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-3776.png", "Carbon Black-APT29-3779.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3751.png", "Carbon Black-APT29-3759.png"], "Footnotes": []}]}, {"Substep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3758.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated referencing the creation of Draft.zip for later exfiltration.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12751.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Deploy Stealth Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3780.png"], "Footnotes": []}]}, {"Substep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within monkey.png", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.003", "Subtechnique_Name": "Obfuscated Files or Information: Steganography"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3793.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for the execution of the PowerShell executing a fileless script or command. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-3788.png", "Carbon Black-APT29-3790.png"], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "An MSSP detection was generated for the Registry Modification of the command subkey.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12752.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the Registry modifications of the DelegateExecute Registry value. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3795.png", "Carbon Black-APT29-13937.png", "Carbon Black-APT29-3797.png"], "Footnotes": []}]}, {"Substep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3793.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection was generated for \"Privilege Escalation\" based on suspicious PowerShell behavior.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-3799.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated for the use of sdclt.exe as a high privilege process, which called control.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12752.png"], "Footnotes": []}]}, {"Substep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3824.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell making network connections."]}]}, {"Substep": "3.B.4", "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-13938.png", "Carbon Black-APT29-3825.png"], "Footnotes": []}]}, {"Substep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-13938.png", "Carbon Black-APT29-3825.png"], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3854.png", "Carbon Black-APT29-3851.png"], "Footnotes": []}]}]}, {"Step_Num": 4, "Step_Name": "Clean Up and Reconnaissance", "Substeps": [{"Substep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) was generated for \"Sysinternals Tools Downloaded via Command Interpreter.\" The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-3885.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3890.png"], "Footnotes": []}]}, {"Substep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3888.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking Powershell or untrusted applications spawning command interpreters."]}]}, {"Substep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (yellow indicator) for powershell.exe fileless script or command was generated for \"code_drop\" and \"detected_pup_app\".", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-3883.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive as well as the subsequent file writes. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3892.png", "Carbon Black-APT29-13939.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3902.png"], "Footnotes": []}]}, {"Substep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3903.png", "Carbon Black-APT29-13940.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-3915.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\" was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-3915.png"], "Footnotes": []}]}, {"Substep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-13941.png", "Carbon Black-APT29-3903.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\"  was generated due to Sdelete64.exe deleting Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-3911.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-3911.png"], "Footnotes": []}]}, {"Substep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-13942.png", "Carbon Black-APT29-3903.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated for the of SysinternalsSuite.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12754.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\" was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-3914.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-3914.png"], "Footnotes": []}]}, {"Substep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing $env:TEMP", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-3935.png"], "Footnotes": []}]}, {"Substep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-3935.png"], "Footnotes": []}]}, {"Substep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-3935.png"], "Footnotes": []}]}, {"Substep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-3935.png"], "Footnotes": []}]}, {"Substep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-3935.png"], "Footnotes": []}]}, {"Substep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-3935.png"], "Footnotes": []}]}, {"Substep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-3935.png"], "Footnotes": []}]}, {"Substep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-3935.png"], "Footnotes": []}]}, {"Substep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe executing the NetUserGetGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-3938.png", "Carbon Black-APT29-3942.png"], "Footnotes": []}]}, {"Substep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-3942.png", "Carbon Black-APT29-3938.png"], "Footnotes": []}]}, {"Substep": "4.C.11", "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API", "Criteria": "powershell.exe executing the NetUserGetLocalGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-3941.png", "Carbon Black-APT29-3938.png"], "Footnotes": []}]}, {"Substep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-3938.png", "Carbon Black-APT29-3941.png"], "Footnotes": []}]}]}, {"Step_Num": 5, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Host Interrogation", "Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-3957.png", "Carbon Black-APT29-3949.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique alert detection called \"Persistence - PowerShell Startup Folder\" was generated due to hostui.lnk being written to the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-3985.png", "Carbon Black-APT29-3984.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-3983.png"], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Credential Access", "Substeps": [{"Substep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-3981.png"], "Footnotes": ["The vendor states that this activity would have been blocked."]}]}, {"Substep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "An MSSP detection was generated for the execution of accesschk.exe to dump passwords.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12755.png"], "Footnotes": []}]}, {"Substep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-3975.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for a \"PUP or Potentially Unwanted Program (PUP: ChromePassRecovery)\".", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-3976.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.004", "Subtechnique_Name": "Unsecured Credentials: Private Keys"}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for \"PFX Extraction via PowerShell\" on filemod of the $RandomFileName.pfx file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-4015.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-13943.png", "Carbon Black-APT29-4016.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated for a file create event of $RandomFileName.pfx file by powershell.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12756.png"], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe opening a handle to a lsass.exe thread. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4017.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator)  called \"Screen Capture using Powershell\" was generated for a powershell.exe modload for gdiplus.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-4004.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4007.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated containing evidence of PowerShell capturing screenshots.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12757.png"], "Footnotes": []}]}, {"Substep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"AMSI - Clipboard Monitoring\" was generated for fileless_scriptload of Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-4011.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12757.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4012.png"], "Footnotes": []}]}, {"Substep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4008.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of key logging.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12758.png", "Carbon Black-APT29-12757.png"], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.B.2", "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed the file creation event for OfficeSupplies.7z. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4028.png"], "Footnotes": []}]}, {"Substep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-13944.png", "Carbon Black-APT29-4026.png"], "Footnotes": []}]}, {"Substep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1048.003", "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4028.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Expand Access", "Substeps": [{"Substep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4029.png"], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4034.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for suspicious fileless execution not originating from PowerShell.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4040.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called \"Remote Services\" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-4036.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called \"Remote powershell activity\" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-14749.png", "Carbon Black-APT29-14748.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated for \"Powershell or WinRM remoting activity\" based on wsmprovhost.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4040.png"], "Footnotes": []}]}, {"Substep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for Powershell or WinRM remoting activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4041.png"], "Footnotes": []}]}, {"Substep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the filemod event for the creation of python.exe on the remote host Scranton (10.0.1.4). Telemetry also showed the file write from the local host. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4042.png", "Carbon Black-APT29-4044.png"], "Footnotes": []}]}, {"Substep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.002", "Subtechnique_Name": "Obfuscated Files or Information: Software Packing"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam", "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-4056.png"], "Footnotes": []}]}, {"Substep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-13945.png"], "Footnotes": []}]}, {"Substep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"T1035 & T1077 - Service Execution - psexec - target\" was generated due to a process running remotely with PsExec.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4055.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed python.exe spawned by PSEXESVC.exe", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4055.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Clean Up, Collection, and Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file rar.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file create event for rar.exe by python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4058.png"], "Footnotes": []}]}, {"Substep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file create event for sdelete64.exe by python.exe.  The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4058.png"], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from python.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4059.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for the execution of a abnormal fileless command-line length. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-13946.png"], "Footnotes": []}]}, {"Substep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4061.png"], "Footnotes": []}]}, {"Substep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4061.png"], "Footnotes": []}]}, {"Substep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed a filemod event for powershell.exe creating working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4064.png"], "Footnotes": []}]}, {"Substep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-13948.png", "Carbon Black-APT29-4060.png"], "Footnotes": []}]}, {"Substep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"Data Compressed via Command Interpreter for Staging\" was generated due to powershell.exe executing rar.exe creating a filemod event for working.zip.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4070.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-13948.png", "Carbon Black-APT29-4060.png"], "Footnotes": []}]}, {"Substep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe reading the file working.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4074.png", "Carbon Black-APT29-4078.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-13951.png", "Carbon Black-APT29-13950.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-13949.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-13949.png"], "Footnotes": []}]}, {"Substep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4075.png", "Carbon Black-APT29-4074.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-13951.png", "Carbon Black-APT29-13950.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-4075.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-4075.png"], "Footnotes": []}]}, {"Substep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4076.png", "Carbon Black-APT29-13952.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-13951.png", "Carbon Black-APT29-13950.png"], "Footnotes": []}]}, {"Substep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe deleting sdelete64.exe and filemod(delete) event. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4079.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-13951.png", "Carbon Black-APT29-13950.png"], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe with a parent process of javamtsup.exe (identified as being spawned from services.exe).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4101.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-13953.png"], "Footnotes": []}]}, {"Substep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-13954.png"], "Footnotes": []}]}, {"Substep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.002", "Subtechnique_Name": "Access Token Manipulation: Create Process with Token"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed explorer.exe spawning powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4112.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for the execution of powershell.exe from explorer.exe.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4112.png"], "Footnotes": []}]}, {"Substep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1564", "Technique_Name": "Hide Artifacts"}, "Subtechnique": {"Subtechnique_Id": "T1564.004", "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4162.png", "Carbon Black-APT29-4112.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for the use of PowerShell executing with Invoke-Expression.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4113.png"], "Footnotes": []}]}, {"Substep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4163.png"], "Footnotes": []}]}, {"Substep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4165.png", "Carbon Black-APT29-4163.png"], "Footnotes": []}]}, {"Substep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1120", "Technique_Name": "Peripheral Device Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4164.png"], "Footnotes": []}]}, {"Substep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4165.png"], "Footnotes": []}]}, {"Substep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4165.png"], "Footnotes": []}]}, {"Substep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4167.png"], "Footnotes": []}]}, {"Substep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4168.png"], "Footnotes": []}]}, {"Substep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information\" was generated for the use of certutil.exe decoding a payload.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4126.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4127.png", "Carbon Black-APT29-4170.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for a executable file found in memory.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-14754.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12763.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information - certuil\" was generated for the use of certutil.exe decoding a payload.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4126.png"], "Footnotes": []}]}, {"Substep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for Registry Run Keys was generated based on powershell.exe modifying the Run key.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4124.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4171.png"], "Footnotes": []}]}, {"Substep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4121.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated for powershell.exe executing encoded instructions.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4121.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4123.png"], "Footnotes": []}]}, {"Substep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for .NET attempting to make suspicious network connections.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4119.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4110.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell making network connections."]}]}, {"Substep": "11.A.14", "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-13955.png"], "Footnotes": []}]}]}, {"Step_Num": 12, "Step_Name": "Fortify Access", "Substeps": [{"Substep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell enumeration of System32. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4145.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.006", "Subtechnique_Name": "Indicator Removal on Host: Timestomp"}, "Detections": [{"Detection_Note": "Telemetry showed script block with commands to timestomp kxwn.lock as well as the execution of the timestomp function against the kxwn.lock file. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4146.png", "Carbon Black-APT29-4145.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell modifying filesystem access and write times of the kxwn.lock file.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-14755.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4150.png", "Carbon Black-APT29-4151.png"], "Footnotes": []}]}, {"Substep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell querying the registry.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-14755.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-13958.png", "Carbon Black-APT29-13956.png"], "Footnotes": []}]}, {"Substep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell querying the registry.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-14755.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-13958.png", "Carbon Black-APT29-13956.png"], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Reconnaissance", "Substeps": [{"Substep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4182.png", "Carbon Black-APT29-13959.png"], "Footnotes": []}]}, {"Substep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4182.png", "Carbon Black-APT29-4191.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4182.png", "Carbon Black-APT29-4189.png"], "Footnotes": []}]}, {"Substep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4186.png", "Carbon Black-APT29-4189.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Elevation & Credential Access", "Substeps": [{"Substep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4207.png", "Carbon Black-APT29-4206.png", "Carbon Black-APT29-13960.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry value.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12767.png"], "Footnotes": []}]}, {"Substep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A Tactic alert detection was generated for supicious privilege escalation process behavior by PowerShell.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4193.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection was generated for bypassing UAC with sdclt.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4195.png", "Carbon Black-APT29-4193.png", "Carbon Black-APT29-4194.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell elevating privileges via a UAC bypass using sdclt.exe and control.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12767.png"], "Footnotes": []}]}, {"Substep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4205.png", "Carbon Black-APT29-4207.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of the deletion of the DelegateExecute Registry value.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12767.png"], "Footnotes": []}]}, {"Substep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1047", "Technique_Name": "Windows Management Instrumentation"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) for Privilege Escalation was generated for suspicious PowerShell behavior.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4232.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for Windows Management Instrumentation was generated for WmiPrvSE.exe executing powershell.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4235.png", "Carbon Black-APT29-4236.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed WmiPrvSe.exe executing powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4223.png", "Carbon Black-APT29-4221.png"], "Footnotes": []}]}, {"Substep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (orange indicator) was generated for PowerShell enumerating processes. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-4223.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell executing Get-Process.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"Substep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for .Net attempting suspicious network connections. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-4232.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for PowerShell with network connections spawned by WMI. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-4237.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4219.png", "Carbon Black-APT29-4242.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-14756.png"], "Footnotes": []}]}, {"Substep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-4239.png", "Carbon Black-APT29-4238.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4225.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4219.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking powershell from executing untrusted applications or blocking PUP applications from executing. Credential dumping can be blocked by preventing untrusted applications from reading the memory of other processes."]}, {"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell executing Mimikatz to obtain login credentials.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12768.png"], "Footnotes": []}]}, {"Substep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4241.png"], "Footnotes": []}]}, {"Substep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4244.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4258.png"], "Footnotes": []}]}, {"Substep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell establishing WMI event subscription persistence.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12769.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated for PowerShell establishing WMI event subscription persistence.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-13961.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4258.png", "Carbon Black-APT29-4264.png"], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-14757.png", "Carbon Black-APT29-4267.png", "Carbon Black-APT29-4292.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4293.png"], "Footnotes": []}]}, {"Substep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4293.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4298.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated on NewYork (10.0.0.4) for a remote PowerShell session based on the identification of the WinRM process (wsmprovhost.exe).", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4302.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection (yellow indicator) was generated for powershell.exe accessing the network. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Carbon Black-APT29-4298.png"], "Footnotes": []}]}, {"Substep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Carbon Black-APT29-4300.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) was generated for a code drop of m.exe (identified as Mimikatz by the file metadata).", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4271.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a filemod for the creation of m.exe in the System32 directory by wsmprovhost.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4308.png"], "Footnotes": []}]}, {"Substep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for a code drop of m.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4271.png"], "Footnotes": []}, {"Detection_Note": "A General detection was generated for process injection by m.exe. The detection was correlated to a parent alert for a code drop of m.exe.", "Detection_Type": "General", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4274.png"], "Footnotes": ["According to the vendor, the VMware Carbon Black Cloud could be configured to prevent this activity by implementing rules blocking PUP applications from executing. Credential dumping can be prevented by implementing rules blocking untrusted applications reading the memory of another process."]}, {"Detection_Note": "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-13962.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Collection", "Substeps": [{"Substep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1114", "Technique_Name": "Email Collection"}, "Subtechnique": {"Subtechnique_Id": "T1114.001", "Subtechnique_Name": "Email Collection: Local Email Collection"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell collecting emails.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-14758.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Fileless Reconnaissance of Outlook Folder data\"  was generated for powershell.exe interacting with Outlook.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4319.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) called \"Suspicious loading of Outlook .NET assembly\"  was generated for powershell.exe interacting with an Outlook DLL.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4319.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4322.png", "Carbon Black-APT29-4315.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell staging a collected file into a directory.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-14758.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4330.png"], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell compressed a staging directory.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-14758.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4326.png", "Carbon Black-APT29-4331.png"], "Footnotes": []}]}, {"Substep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4326.png"], "Footnotes": []}]}]}, {"Step_Num": 18, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1102", "Technique_Name": "Web Service"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection was generated for net.exe making network connections. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Carbon Black-APT29-14759.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4333.png", "Carbon Black-APT29-4334.png"], "Footnotes": []}]}, {"Substep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1567", "Technique_Name": "Exfiltration Over Web Service"}, "Subtechnique": {"Subtechnique_Id": "T1567.002", "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-14758.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a OneDrive account, along with the creation of the exfiltrated data within the OneDrive. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4344.png", "Carbon Black-APT29-4341.png"], "Footnotes": []}]}]}, {"Step_Num": 20, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of rundll32.exe executing kxwn.lock.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12778.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4364.png"], "Footnotes": []}]}, {"Substep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) was generated for Windows Management Instrumentation based on wmiprvse.exe executing PowerShell stager.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-13963.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated for a PowerShell with network connections launched by WMI.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-13964.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4358.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for PowerShell having an unusual parent.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4371.png"], "Footnotes": []}]}, {"Substep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe spawning from wmiprvse.exe with SYSTEM-level integrity.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbon Black-APT29-4375.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for a hidden PowerShell with an Unusual Parent.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4371.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4371.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.003", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket"}, "Detections": [{"Detection_Note": "Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4391.png", "Carbon Black-APT29-4390.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12778.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for a Credential Theft Application Running.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4386.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for PowerShell running Mimikatz.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4386.png"], "Footnotes": []}]}, {"Substep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell create a WinRM session to remote host Scranton (10.0.1.4).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12778.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4). The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4392.png", "Carbon Black-APT29-4393.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Powershell or WinRM remoting activity\" was generated for a powershell WinRM session on the remote host Scranton (10.0.1.4).", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4387.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection (red indicator) called for remote PowerShell activity was generated for a PowerShell WinRM session.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-4387.png"], "Footnotes": []}]}, {"Substep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed the PowerShell command to add the new User Toby to the remote host Scranton (10.0.1.4). Telemetry also subsequently showed wsmprovhost.exe spawning net.exe with the command-line arguments. The detection was correlated to a parent alert for Windows Management Instrumentation.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Carbon Black-APT29-4396.png", "Carbon Black-APT29-4395.png", "Carbon Black-APT29-4388.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell adding new user to the remote host Scranton (10.0.1.4) using net.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Carbon Black-APT29-12778.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated for the creation of a local user with Net.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-13966.png", "Carbon Black-APT29-13965.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for a process spawned from PowerShell remoting (WinRM).", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Carbon Black-APT29-13965.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Eval_Range_Screenshots": {"Scenario_1": [{"Screenshot_Name": "Carbanak-FIN7_VM_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_1_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_1_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_1_3.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_1_4.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_1_5.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_1_6.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_1_7.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_1_8.png", "Screenshot_Caption": ""}], "Scenario_2": [{"Screenshot_Name": "Carbanak-FIN7_VM_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_2_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_2_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_2_3.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_2_4.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_2_5.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_2_6.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_2_7.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_VM_2_8.png", "Screenshot_Caption": ""}]}, "Linux_Participant": true, "Alerting_Strategy": "Events that match analytic logic for malicious behaviors are assigned appropriate severity values (1-10 or 1-100). These alerted events are also enriched with contextual information, such as a short description and potential mapping(s) to related ATT&CK Tactics and Techniques. Alerted events are aggregated into specific views as well as highlighted (with specific icons and fonts) when included as part of other views of system events/data.", "Correlation_Strategy": "Alerts are aggregated into a central queue, where the data for each can be explored. Data within each alert captures relevant evidence, including correlation between surrounding system events such as process lineage or interactions between processes and files. Each alert may focus on one or more devices. Dashboard views also exist to provide a wider perspective on events across multiple hosts. Relations Graphs can also be created to visualize connections between various data types.", "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "1.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.2", "Procedure": "", "Criteria": "winword.exe loads VBE7.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.2_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Initial Access - MS Office Applications Loading Suspicious Visual Basic Libraries\" (8/10) was generated when winword.exe loads VBE7.DLL.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.2.png", "Carbanak-FIN7_VM_1.A.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "8/10", "Indicator_Name": "Initial Access - MS Office Applications Loading Suspicious Visual Basic Libraries"}], "Linux_Only": false}, {"Substep": "1.A.3", "Procedure": "", "Criteria": "wscript.exe executes unprotected.vbe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - AMSI - Suspicious Windows Script Host Execution\" (10/10) was generated when wscript.exe spawned unprotected.vbe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "10/10", "Indicator_Name": "Execution - AMSI - Suspicious Windows Script Host Execution"}, {"Detection_Note": "A General detection named \"Initial Access - Spearphishing Attachment - Word\" (7/10) was generated when wscript.exe spawned unprotected.vbe from winword.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7/10", "Indicator_Name": "Initial Access - Spearphishing Attachment - Word"}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when wscript.exe spawned unprotected.vbe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}, {"Detection_Note": "A Technique detection named \"Initial Access - Word Executing WScript\" (9/10) was generated when wscript.exe spawned unprotected.vbe from winword.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9/10", "Indicator_Name": "Initial Access - Word Executing WScript"}], "Linux_Only": false}, {"Substep": "1.A.4", "Procedure": "", "Criteria": "unprotected.vbe is an encoded file", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.5", "Procedure": "", "Criteria": "wscript.exe decodes content and creates starter.vbs", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.5_1.png", "Carbanak-FIN7_VM_1.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.6", "Procedure": "", "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.6_2.png", "Carbanak-FIN7_VM_1.A.6_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.7", "Procedure": "", "Criteria": "wscript.exe executes starter.vbs", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.7_2.png", "Carbanak-FIN7_VM_1.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - AMSI - Suspicious Windows Script Host Execution\" (10/10) was generated when wscript.exe executed starter.vbs.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.7_4.png", "Carbanak-FIN7_VM_1.A.7.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "10/10", "Indicator_Name": "Execution - AMSI - Suspicious Windows Script Host Execution"}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when wscript.exe executed starter.vbs.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}], "Linux_Only": false}, {"Substep": "1.A.8", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Defense Evasion - Suspicious Child Processes Spawned by WScript\" (8/10) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "8/10", "Indicator_Name": "Defense Evasion - Suspicious Child Processes Spawned by WScript"}], "Linux_Only": false}, {"Substep": "1.A.9", "Procedure": "", "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.9_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - AMSI - Suspicious Windows Script Host Execution\" (10/10) was generated when cmd.exe spawned wscript.exe to execute TransBaseOdbcDriver.js.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "10/10", "Indicator_Name": "Execution - AMSI - Suspicious Windows Script Host Execution"}], "Linux_Only": false}, {"Substep": "1.A.10", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.11", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_1.A.11_1.png", "Carbanak-FIN7_VM_1.A.11.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 2, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "2.A.2", "Procedure": "", "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.A.4", "Procedure": "", "Criteria": "wscript.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Enumerate Processes\" was generated when wscript.exe made a WMI query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.A.4_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Enumerate Processes"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.A.4_6.png", "Carbanak-FIN7_VM_2.A.4_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.1", "Procedure": "", "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Execution - Wscript Spawning CMD with Filemods to Appdata/Temp\" (8/10) was generated when wscript.exe downloaded screenshot__.ps1 from 192.168.0.4 then later spawned cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "8/10", "Indicator_Name": "Execution - Wscript Spawning CMD with Filemods to Appdata/Temp"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Defense Evasion - Supicious Child Processes Spawned by WScript\" (8/10) was generated when  wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.2_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "8/10", "Indicator_Name": "Defense Evasion - Supicious Child Processes Spawned by WScript"}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when  wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command-Line Interface (cmd.exe /c)\" (1/10) was generated when  wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.2_2.png", "Carbanak-FIN7_VM_2.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command-Line Interface (cmd.exe /c)"}], "Linux_Only": false}, {"Substep": "2.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}], "Linux_Only": false}, {"Substep": "2.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_2.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.5", "Procedure": "", "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 3, "Step_Name": "Deploy Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A General detection named \"Defense Evasion - Suspicious Child Process Spawned by WScript\" was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Defense Evasion - Suspicious Child Process Spawned by WScript"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command-Line Interface (cmd.exe /c)\" (1/10) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command-Line Interface (cmd.exe /c)"}], "Linux_Only": false}, {"Substep": "3.A.2", "Procedure": "", "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Defense Evasion - Modification of Another User's Registry\" (9/10) was generated when cmd.exe spawned reg.exe to add a value to the registry key.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "9/10", "Indicator_Name": "Defense Evasion - Modification of Another User's Registry"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.A.3", "Procedure": "", "Criteria": "Value added to Registry is base64 encoded", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.1", "Procedure": "", "Criteria": "wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Execution - Wscript Spawning CMD with Filemods to Appdata/Temp\" (1/10) was generated when wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4 then later spawned cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Wscript Spawning CMD with Filemods to Appdata/Temp"}], "Linux_Only": false}, {"Substep": "3.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command-Line Interface (cmd.exe /c)\" (1/10) was generated when wscript.exe spawned cmd.exe .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command-Line Interface (cmd.exe /c)"}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when wscript.exe spawned cmd.exe .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}], "Linux_Only": false}, {"Substep": "3.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}], "Linux_Only": false}, {"Substep": "3.B.4", "Procedure": "", "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.5", "Procedure": "", "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Defense Evasion - AMSI - Fileless Script Contains Base64 Encoded Content\" (10/10) was generated when powershell.exe loaded the Registry value into plaintext shellcode.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "10/10", "Indicator_Name": "Defense Evasion - AMSI - Fileless Script Contains Base64 Encoded Content"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Execution - AMSI - .Net Loading Suspicious Content Into Memory\" (10/10) was generated when powershell.exe loaded the Registry value into plaintext shellcode.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "10/10", "Indicator_Name": "Execution - AMSI - .Net Loading Suspicious Content Into Memory"}], "Linux_Only": false}, {"Substep": "3.B.6", "Procedure": "", "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection (8/10) was generated when powershell.exe executed known malware performing highly suspicious process injection behavior.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "8/10", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.6.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_3.B.7_2.png", "Carbanak-FIN7_VM_3.B.7.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 4, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "4.A.1", "Procedure": "", "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.A.1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.2", "Procedure": "", "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.A.2_3.png", "Carbanak-FIN7_VM_4.A.2.png", "Carbanak-FIN7_VM_4.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.3", "Procedure": "", "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.A.3_1.png", "Carbanak-FIN7_VM_4.A.3_3.png", "Carbanak-FIN7_VM_4.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.4", "Procedure": "", "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.A.4_1.png", "Carbanak-FIN7_VM_4.A.4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.1", "Procedure": "", "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.1_3.png", "Carbanak-FIN7_VM_4.B.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.2", "Procedure": "", "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Malware drop\" was generated when powershell.exe downloaded smrs.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Malware drop"}, {"Detection_Note": "A General detection named \"Medium Risk - Sample contains suspicious behavior\" (45/100) was generated when powershell.exe downloaded smrs.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_4.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Sandbox"], "Indicator": "45/100", "Indicator_Name": "Medium Risk - Sample contains suspicious behavior"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.3", "Procedure": "", "Criteria": "powershell.exe executes rad353F7.ps1", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when powershell.exe executed rad353F7.ps1.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}], "Linux_Only": false}, {"Substep": "4.B.4", "Procedure": "", "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Defense Evasion - Modificaiton of Another User's Registry\" (9/10) was generated when powershell.exe added a value to the Registry via New-Item and New-ItemProperty.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "9/10", "Indicator_Name": "Defense Evasion - Modificaiton of Another User's Registry"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.4.png", "Carbanak-FIN7_VM_4.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.5", "Procedure": "", "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A Technique detection named \"Defense Evasion - UAC Bypass Via Registry Auto-Elevation\" (10/10) was generated when powershell.exe modified a Registry key associated with a UAC bypass.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.5_3.png", "Carbanak-FIN7_VM_4.B.5_2.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "10/10", "Indicator_Name": "Defense Evasion - UAC Bypass Via Registry Auto-Elevation"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Defense Evasion - UAC Bypass via Fodhelper Auto-Elevate Processes Execution\" (9/10) was generated when fodhelper.exe spawned cmd.exe as a high-integrity process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9/10", "Indicator_Name": "Defense Evasion - UAC Bypass via Fodhelper Auto-Elevate Processes Execution"}], "Linux_Only": false}, {"Substep": "4.B.6", "Procedure": "", "Criteria": "cmd.exe spawns smrs.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command-Line Interface (cmd.exe /c)\" (1/10) was generated when cmd.exe executed smrs.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command-Line Interface (cmd.exe /c)"}], "Linux_Only": false}, {"Substep": "4.B.7", "Procedure": "", "Criteria": "smrs.exe opens and reads lsass.exe", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.7_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Credential Dump\" was generated when  smrs.exe opened and read lsass.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Credential Dump"}, {"Detection_Note": "A General detection named \"KNOWN_MALWARE\" was generated when smrs.exe was executed.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_4.B.7_4.png", "Carbanak-FIN7_VM_4.B.7_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "KNOWN_MALWARE"}], "Linux_Only": false}]}, {"Step_Num": 5, "Step_Name": "Expand Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "", "Criteria": "powershell.exe downloads pscp.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Code drop\" was generated when powershell.exe downloaded pscp.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}], "Linux_Only": false}, {"Substep": "5.A.2", "Procedure": "", "Criteria": "powershell.exe downloads psexec.py from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Code drop\" was generated when powershell.exe downloaded psexec.py.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.3", "Procedure": "", "Criteria": "powershell.exe downloads runtime from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.4", "Procedure": "", "Criteria": "powershell.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Code drop\" was generated when powershell.exe downloaded plink.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.5", "Procedure": "", "Criteria": "powershell.exe downloads tiny.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Code drop\" was generated when powershell.exe downloaded tiny.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.6", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.7", "Procedure": "", "Criteria": "Pscp.exe connects over SCP (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.7_3.png", "Carbanak-FIN7_VM_5.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection was generated when pscp.exe was identified as acting like a reverse shell.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.7_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Lateral Movement - Remote Services\" (1/10) was generated when Pscp.exe connected over SCP (port 22) to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remote Services"}], "Linux_Only": true}, {"Substep": "5.A.8", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.8.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.9", "Procedure": "", "Criteria": "Pscp.exe copies psexec.py to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"anomaly:upload_ssh_collection\" was generated when a large amount of data was uploaded over SSH.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "anomaly:upload_ssh_collection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.9_5.png", "Carbanak-FIN7_VM_5.A.9_4.png", "Carbanak-FIN7_VM_5.A.9_6.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.10", "Procedure": "", "Criteria": "Pscp.exe copies runtime to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.10_4.png", "Carbanak-FIN7_VM_5.A.10_6.png", "Carbanak-FIN7_VM_5.A.10_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"anomaly:upload_ssh_collection\" was generated when a large amount of data was uploaded over SSH.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.10_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "anomaly:upload_ssh_collection"}], "Linux_Only": true}, {"Substep": "5.A.11", "Procedure": "", "Criteria": "Pscp.exe copies tiny.exe to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.11_7.png", "Carbanak-FIN7_VM_5.A.11_4.png", "Carbanak-FIN7_VM_5.A.11_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"anomaly:upload_ssh_collection\" was generated when a large amount of data was uploaded over SSH.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.A.11_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "anomaly:upload_ssh_collection"}], "Linux_Only": true}, {"Substep": "5.B.1", "Procedure": "", "Criteria": "plink.exe connects over SSH (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Lateral Movement - Remote Services\" (1/10) was generated when plink.exe connected over SSH (port 22) to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remote Services"}], "Linux_Only": true}, {"Substep": "5.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.B.2.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.3", "Procedure": "", "Criteria": "User kmitnick executes ps ax", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_5.B.3.png", "Carbanak-FIN7_VM_5.B.3_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.4", "Procedure": "", "Criteria": "User kmitnick executes ls -lsahR /var/", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_5.B.4_2.png", "Carbanak-FIN7_VM_5.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.5", "Procedure": "", "Criteria": "User kmitnick reads network-diagram-financial.xml via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_5.B.5.png", "Carbanak-FIN7_VM_5.B.5_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.6", "Procedure": "", "Criteria": "User kmitnick reads help-desk-ticket.txt via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_5.B.6_1.png", "Carbanak-FIN7_VM_5.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.7", "Procedure": "", "Criteria": "User kmitnick enumerates the domain controller via nslookup, which queries for the DC (10.0.0.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.B.7_1.png", "Carbanak-FIN7_VM_5.B.7.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.C.1", "Procedure": "", "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Detections": [{"Detection_Note": "A General detection named \"Credential Access\" (9/10) was generated when psexec.py created a logon to 10.0.0.4 as user kmitnick.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.C.1_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9/10", "Indicator_Name": "Credential Access"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.C.1_3.png", "Carbanak-FIN7_VM_5.C.1_4.png", "Carbanak-FIN7_VM_5.C.1_5.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.2", "Procedure": "", "Criteria": "psexec.py connects to SMB shares on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.C.2.png", "Carbanak-FIN7_VM_5.C.2_2.png", "Carbanak-FIN7_VM_5.C.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"llrules\" was generated when SMB traffic matched a non-standard SMB client associated with red-teaming tools.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.C.2_4.png", "Carbanak-FIN7_VM_5.C.2_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "llrules"}], "Linux_Only": false}, {"Substep": "5.C.3", "Procedure": "", "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.C.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.4", "Procedure": "", "Criteria": "tiny.exe is created on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.C.4_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.5", "Procedure": "", "Criteria": "cmd.exe spawns tiny.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_5.C.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.6", "Procedure": "", "Criteria": "tiny.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 6, "Step_Name": "Discover Potential Targets", "Substeps": [{"Substep": "6.A.1", "Procedure": "", "Criteria": "tiny.exe loads system.management.automation.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Execution - PowerShell Execution via Module Load Detected\" (2/10) was generated when tiny.exe loaded system.management.automation.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_6.A.1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "2/10", "Indicator_Name": "Execution - PowerShell Execution via Module Load Detected"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_6.A.1_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "6.A.2", "Procedure": "", "Criteria": "PowerShell executes Get-ADComputer", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_6.A.2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Discovery - AMSI - Suspect Domain Enumeration Detected\" (5/10) was generated when PowerShell executed Get-ADComputer.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_6.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "5/10", "Indicator_Name": "Discovery - AMSI - Suspect Domain Enumeration Detected"}], "Linux_Only": false}, {"Substep": "6.A.3", "Procedure": "", "Criteria": "PowerShell executes Get-NetUser", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_6.A.3_2.png", "Carbanak-FIN7_VM_6.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 7, "Step_Name": "Setup Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "", "Criteria": "tiny.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Code drop\" was generated when tiny.exe downloaded plink.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}], "Linux_Only": false}, {"Substep": "7.A.2", "Procedure": "", "Criteria": "tiny.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.3", "Procedure": "", "Criteria": "plink.exe transmits data to 192.168.0.4 over SSH protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.A.3_5.png", "Carbanak-FIN7_VM_7.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to bankdc (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.A.4.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.5", "Procedure": "", "Criteria": "RDP session from the localhost over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"Lateral Movement - Remote Desktop Protocol\" (1/10) was generated when an RDP session was created from localhost over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.A.5_6.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remote Desktop Protocol"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.A.5_3.png", "Carbanak-FIN7_VM_7.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Windows Event Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Lateral Movement - Remote Services\" (1/10) was generated when an RDP session was created from localhost over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.A.5_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remote Services"}], "Linux_Only": false}, {"Substep": "7.B.1", "Procedure": "", "Criteria": "powershell.exe executes qwinsta /server:cfo", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Discovery - System Owner/User Discovery #2\" (6/10) was generated when powershell.exe executed qwinsta /server:cfo.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "6/10", "Indicator_Name": "Discovery - System Owner/User Discovery #2"}], "Linux_Only": false}, {"Substep": "7.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to cfo (10.0.0.5)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.B.3", "Procedure": "", "Criteria": "RDP session from 10.0.0.4 to 10.0.0.5 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"llrules\" was generated when a cookie was observed in a RDP connection request.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "llrules"}, {"Detection_Note": "A Technique detection named \"Lateral Movement - Remove Services\" (1/10) was generated when an RDP session was created from bankdc (10.0.0.4) to cfo (10.0.0.5) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.3_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remove Services"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.3_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Anomalous Network Interaction\" (Low) was generated when an RDP session was created from bankdc (10.0.0.4) to cfo (10.0.0.5) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "Low", "Indicator_Name": "Anomalous Network Interaction"}, {"Detection_Note": "A Technique detection named \"Lateral Movement - Remote Desktop Protocol\" (1/10) was generated when an RDP session was created from bankdc (10.0.0.4) to cfo (10.0.0.5) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.3_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remote Desktop Protocol"}, {"Detection_Note": "A Technique detection named \"Lateral Movement - Successful RDP Connection\" (1/10) was generated when an RDP session was created from bankdc (10.0.0.4) to cfo (10.0.0.5) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.B.3_7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Successful RDP Connection"}], "Linux_Only": false}, {"Substep": "7.C.1", "Procedure": "", "Criteria": "scp.exe downloads Java-Update.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Code Drop\" was generated when scp.exe downloaded Java-Update.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.C.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Code Drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.C.1_6.png", "Carbanak-FIN7_VM_7.C.1_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Malicious\" (High) was generated when Java-Update.exe was detected as a suspicious file.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_7.C.1_4.png"], "Footnotes": [], "Data_Sources": ["Sandbox"], "Indicator": "High", "Indicator_Name": "Malicious"}], "Linux_Only": false}, {"Substep": "7.C.2", "Procedure": "", "Criteria": "dir lists the contents of C:\\Users\\Public", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.3", "Procedure": "", "Criteria": "cmd.exe downloads Java-Update.vbs from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.C.3_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Code drop\" was generated when cmd.exe downloaded Java-Update.vbs from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.C.3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}], "Linux_Only": false}, {"Substep": "7.C.4", "Procedure": "", "Criteria": "Java-Update subkey is added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique detection named \"Persistence - Run Key Added With Non-Program Files Value Path\" (8/10) was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.C.4_4.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "8/10", "Indicator_Name": "Persistence - Run Key Added With Non-Program Files Value Path"}, {"Detection_Note": "A Technique detection named \"Persistence - Regmod Run or Runonce Key Modification\" (3/10) was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.C.4_3.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "3/10", "Indicator_Name": "Persistence - Regmod Run or Runonce Key Modification"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_7.C.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 8, "Step_Name": "Gain Covert Access to Target", "Substeps": [{"Substep": "8.A.1", "Procedure": "", "Criteria": "wscript.exe spawns Java-Update.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when wscript.exe spawned Java-Update.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_8.A.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_8.A.1_3.png", "Carbanak-FIN7_VM_8.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - AMSI - Suspicious Windows Script Host Execution\" (10/10) was generated when wscript.exe spawned Java-Update.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_8.A.1_5.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "10/10", "Indicator_Name": "Execution - AMSI - Suspicious Windows Script Host Execution"}], "Linux_Only": false}, {"Substep": "8.A.2", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "8.A.3", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_8.A.3_3.png", "Carbanak-FIN7_VM_8.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 9, "Step_Name": "Profile a Victim User", "Substeps": [{"Substep": "9.A.1", "Procedure": "", "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Code Drop\" was generated when Java-Update.exe downloaded DefenderUpgradeExec.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Code Drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Sample contains suspicious behavior\" (Medium) was generated when DefenderUpgradeExec.exe was identified as suspicious.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_9.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Sandbox"], "Indicator": "Medium", "Indicator_Name": "Sample contains suspicious behavior"}], "Linux_Only": false}, {"Substep": "9.A.2", "Procedure": "", "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Technique detection named \"Monitor user input\" was generated when DefenderUpgradeExec.exe called the SetWindowsHookEx API.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.A.2_3.png", "Carbanak-FIN7_VM_9.A.2_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Monitor user input"}], "Linux_Only": false}, {"Substep": "9.A.3", "Procedure": "", "Criteria": "Java-Update.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.4", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.5", "Procedure": "", "Criteria": "explorer.exe reads C:\\Users\\jsmith\\AppData\\Local\\Temp\\Klog2.txt over to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.1", "Procedure": "", "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Code Drop\" was generated when explorer.exe downloaded infosMin48.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.B.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Code Drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.2", "Procedure": "", "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.B.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.3", "Procedure": "", "Criteria": "powershell.exe deletes files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.B.3_2.png", "Carbanak-FIN7_VM_9.B.3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Defense Evasion - File Deletion\" (1/10) was generated when powershell.exe deleted files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_9.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Defense Evasion - File Deletion"}], "Linux_Only": false}]}, {"Step_Num": 10, "Step_Name": "Impersonate Victim", "Substeps": [{"Substep": "10.A.1", "Procedure": "", "Criteria": "explorer.exe downloads tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Code drop\" was generated when explorer.exe downloaded tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.2", "Procedure": "", "Criteria": "explorer.exe downloads vnc-settings.reg from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.2_2.png", "Carbanak-FIN7_VM_10.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Code drop\" was generated when explorer.exe downloaded vnc-settings.reg from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}], "Linux_Only": false}, {"Substep": "10.A.3", "Procedure": "", "Criteria": "netsh adds Service Host rule for TCP port 5900", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1562", "Technique_Name": "Impair Defenses"}, "Subtechnique": {"Subtechnique_Id": "T1562.004", "Subtechnique_Name": "Impair Defenses: Disable or Modify System Firewall"}, "Detections": [{"Detection_Note": "A Technique detection named \"Defense Evasion - Disabling Security Tools\" (5/10) was generated when netsh.exe added 'Service Host' rule to allow TCP port 5900 inbound.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5/10", "Indicator_Name": "Defense Evasion - Disabling Security Tools"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.4", "Procedure": "", "Criteria": "msiexec.exe adds the tvncontrol subkey in HKLM\\Software\\Microsoft\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.4_4.png", "Carbanak-FIN7_VM_10.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Persistence - Regmod Run or Runonce Key Modification\" (3/10) was generated when tvncontrol subkey was added to HKLM\\Software\\Microsoft\\CurrentVersion\\Run.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "3/10", "Indicator_Name": "Persistence - Regmod Run or Runonce Key Modification"}], "Linux_Only": false}, {"Substep": "10.A.5", "Procedure": "", "Criteria": "Addition of subkeys in HKLM\\Software\\TightVNC\\Server", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.5_1.png", "Carbanak-FIN7_VM_10.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.6", "Procedure": "", "Criteria": "Deletion of the Java-Update subkey in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Persistence - Regmod Run or Runonce Key Modification\" (3/10) was generated when the Java-Update subkey in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run was deleted.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry"], "Indicator": "3/10", "Indicator_Name": "Persistence - Regmod Run or Runonce Key Modification"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.B.1", "Procedure": "", "Criteria": "tvnserver.exe accepts a connection from 192.168.0.4 over TCP port 5900", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1219", "Technique_Name": "Remote Access Software"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Network Access\" was generated when tvnserver.exe accepted a connection from 192.168.0.4 over TCP port 5900\n.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Network Access"}, {"Detection_Note": "A General detection named \"Lateral Movement - Remote Services\" (1/10) was generated when tvnserver.exe accepted a connection from 192.168.0.4 over TCP port 5900.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remote Services"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_10.B.1_6.png", "Carbanak-FIN7_VM_10.B.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "11.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.2", "Procedure": "", "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Identified exploit code\" (100/100) was generated when 2-list.rtf contained an embedded lnk payload.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_11.A.2_4.png", "Carbanak-FIN7_VM_11.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Sandbox"], "Indicator": "100/100", "Indicator_Name": "Identified exploit code"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.3", "Procedure": "", "Criteria": "winword.exe spawns mshta.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Detections": [{"Detection_Note": "A General detection named \"Initial Access - Spearphshing Attachment - Word\" (7/10) was generated when winword.exe spawned mshta.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "7/10", "Indicator_Name": "Initial Access - Spearphshing Attachment - Word"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.4", "Procedure": "", "Criteria": "mshta.exe executes an embedded VBScript payload", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.4_2.png", "Carbanak-FIN7_VM_11.A.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Defense Evasion - AMSI - Suspicious MSHTA File Write and Execute Behaviors Detected\" (10/10) was generated when mshta.exe executed an embedded VBScript payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "10/10", "Indicator_Name": "Defense Evasion - AMSI - Suspicious MSHTA File Write and Execute Behaviors Detected"}], "Linux_Only": false}, {"Substep": "11.A.5", "Procedure": "", "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.5_3.png", "Carbanak-FIN7_VM_11.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.6", "Procedure": "", "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Detections": [{"Detection_Note": "A Technique detection named \"Defense Evasion - Script Processors Renamed - Wscript VB Script Processors\" (10/10) was generated when adb156.exe was executed and identified as a renamed script processor.", "Detection_Type": "Technique", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_11.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "10/10", "Indicator_Name": "Defense Evasion - Script Processors Renamed - Wscript VB Script Processors"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.6_6.png", "Carbanak-FIN7_VM_11.A.6_4.png", "Carbanak-FIN7_VM_11.A.6_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.7", "Procedure": "", "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "A General detection named \"Initial Access - MS Office Applications Loading Suspicious Visual Basic Libraries\" (8/10) was generated when  winword.exe loaded VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "8/10", "Indicator_Name": "Initial Access - MS Office Applications Loading Suspicious Visual Basic Libraries"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.8", "Procedure": "", "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_11.A.8_1.png", "Carbanak-FIN7_VM_11.A.8.png", "Carbanak-FIN7_VM_11.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "File Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 12, "Step_Name": "Delayed Malware Execution", "Substeps": [{"Substep": "12.A.1", "Procedure": "", "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.2", "Procedure": "", "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.A.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Defense Evasion - Wscript Execution from Non-Std Path\" (9/10) was generated when Adb156.exe loaded scrobj.dll and executed sql-rat.js using Jscript.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9/10", "Indicator_Name": "Defense Evasion - Wscript Execution from Non-Std Path"}, {"Detection_Note": "A Technique detection named \"Execution - AMSI - Suspicious Windows Script Host Execution\" (10/10) was generated when Adb156.exe loaded scrobj.dll and executed sql-rat.js using Jscript.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "10/10", "Indicator_Name": "Execution - AMSI - Suspicious Windows Script Host Execution"}], "Linux_Only": false}, {"Substep": "12.A.3", "Procedure": "", "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.A.3_3.png", "Carbanak-FIN7_VM_12.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.A.4_2.png", "Carbanak-FIN7_VM_12.A.4_3.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.5", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.A.5_2.png", "Carbanak-FIN7_VM_12.A.5.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads stager.ps1 from 192.168.0.6", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.B.1_3.png", "Carbanak-FIN7_VM_12.B.1_5.png", "Carbanak-FIN7_VM_12.B.1_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Script Logs", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Code drop\" was generated when Adb156.exe downloaded stager.ps1 from 192.168.0.6.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_12.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}], "Linux_Only": false}]}, {"Step_Num": 13, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "13.A.1", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command-Line Interface (cmd.exe /c)\" (1/10) was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command-Line Interface (cmd.exe /c)"}], "Linux_Only": false}, {"Substep": "13.A.3", "Procedure": "", "Criteria": "cmd.exe executes net view", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Discovery - Network Share Discovery\" (2/10) was generated when cmd.exe executed net view.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "2/10", "Indicator_Name": "Discovery - Network Share Discovery"}], "Linux_Only": false}, {"Substep": "13.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.5", "Procedure": "", "Criteria": "Adb156.exe queries the USERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.6", "Procedure": "", "Criteria": "Adb156.exe queries the COMPUTERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.6.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.8", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.8.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.9", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.A.9.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.B.1_2.png", "Carbanak-FIN7_VM_13.B.1_3.png", "Carbanak-FIN7_VM_13.B.1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "Script Logs", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command-Line Interface (cmd.exe /c)\" (1/10) was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command-Line Interface (cmd.exe /c)"}], "Linux_Only": false}, {"Substep": "13.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}], "Linux_Only": false}, {"Substep": "13.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Collection - AMSI - Suspicious ScreenCapture Detected\" (8/10) was generated when powershell.exe executed CopyFromScreen().", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "8/10", "Indicator_Name": "Collection - AMSI - Suspicious ScreenCapture Detected"}], "Linux_Only": false}, {"Substep": "13.B.5", "Procedure": "", "Criteria": "Adb156.exe reads and uploads image.png to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_13.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 14, "Step_Name": "Staging Interactive Toolkit", "Substeps": [{"Substep": "14.A.1", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}, {"Detection_Note": "A Technique detection named \"Execution - Command-Line Interface (cmd.exe /c)\" (1/10) was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command-Line Interface (cmd.exe /c)"}], "Linux_Only": false}, {"Substep": "14.A.2", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter - Powershell\" (2/10) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "2/10", "Indicator_Name": "Execution - Command and Scripting Interpreter - Powershell"}], "Linux_Only": false}, {"Substep": "14.A.3", "Procedure": "", "Criteria": "powershell.exe decodes an embedded DLL payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"Defense Evasion - AMSI - Executable File (PE) Discovered In-Memory\" (10/10) was generated when encoded content was embedded in a script and executed.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "10/10", "Indicator_Name": "Defense Evasion - AMSI - Executable File (PE) Discovered In-Memory"}, {"Detection_Note": "A Tactic detection (8/10) was generated when powershell.exe attempted to execute fileless content.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "8/10", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.4", "Procedure": "", "Criteria": "powershell.exe executes the decoded payload using Invoke-Expression (IEX)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.5", "Procedure": "", "Criteria": "powershell.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.6", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_14.A.7_5.png", "Carbanak-FIN7_VM_14.A.7_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 15, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "15.A.1", "Procedure": "", "Criteria": "powershell.exe calls the CreateToolhelp32Snapshot() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.2", "Procedure": "", "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.2_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Code drop\" was generated when powershell.exe downloaded samcat.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "A General detection named \"Sample contains suspicious behavior\" (Medium) was generated when samcat.exe was identified as a suspicious file.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_VM_15.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Sandbox"], "Indicator": "Medium", "Indicator_Name": "Sample contains suspicious behavior"}], "Linux_Only": false}, {"Substep": "15.A.3", "Procedure": "", "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Code drop\" was generated when powershell.exe downloaded uac-samcats.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}], "Linux_Only": false}, {"Substep": "15.A.4", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter Execution\" (1/10) was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command and Scripting Interpreter Execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.5", "Procedure": "", "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Defense Evasion - UAC Bypass via Registry Auto-Elevation\" (10/10) was generated when a Registry key associated with UAC bypass was changed.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.5_3.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "10/10", "Indicator_Name": "Defense Evasion - UAC Bypass via Registry Auto-Elevation"}], "Linux_Only": false}, {"Substep": "15.A.6", "Procedure": "", "Criteria": "samcat.exe opens and reads the SAM via LSASS", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.7", "Procedure": "", "Criteria": "powershell.exe calls the GetIpNetTable() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.8", "Procedure": "", "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_15.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "", "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Code drop\" was generated when powershell.exe downloaded paexec.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.1_2.png", "Carbanak-FIN7_VM_16.A.1_1.png", "Carbanak-FIN7_VM_16.A.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.2", "Procedure": "", "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Code drop\" was generated when powershell.exe downloaded hollow.exe from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.2_1.png", "Carbanak-FIN7_VM_16.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.3", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.4.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.5", "Procedure": "", "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Tactic detection named \"Potential Metasploit Payload Transfer\" (Medium) was generated when network signatures between 10.0.1.5 and 10.0.1.6 matched a threat hacking tool.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.5_10.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "Medium", "Indicator_Name": "Potential Metasploit Payload Transfer"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.5_6.png", "Carbanak-FIN7_VM_16.A.5_7.png", "Carbanak-FIN7_VM_16.A.5_8.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"Windows X64 VNCInject Reverse TCP\" (Medium) was generated when network signatures between 10.0.1.5 and 10.0.1.6 matched a threat hacking tool.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.5_9.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "Medium", "Indicator_Name": "Windows X64 VNCInject Reverse TCP"}], "Linux_Only": false}, {"Substep": "16.A.6", "Procedure": "", "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Service Execution - paexec Masquerading\" (9/10) was generated when a Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executed hollow.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9/10", "Indicator_Name": "Service Execution - paexec Masquerading"}], "Linux_Only": false}, {"Substep": "16.A.7", "Procedure": "", "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Detections": [{"Detection_Note": "A General detection named \"Defense Evasion - Unsigned Binary with Suspicious Parent/Child process\" was generated when hollow.exe spawned svchost.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.7_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Defense Evasion - Unsigned Binary with Suspicious Parent/Child process"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.7_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Hollow Process\" (8/10) was generated when hollow.exe spawned svchost.exe and unmapped its memory image.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "8/10", "Indicator_Name": "Hollow Process"}, {"Detection_Note": "A General detection named \"SANS Unusual svchost.exe parent\" (10/10) was generated when hollow.exe spawned svchost.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.7_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "10/10", "Indicator_Name": "SANS Unusual svchost.exe parent"}], "Linux_Only": false}, {"Substep": "16.A.8", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.9", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_16.A.9_1.png", "Carbanak-FIN7_VM_16.A.9_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 17, "Step_Name": "Setup User Monitoring", "Substeps": [{"Substep": "17.A.1", "Procedure": "", "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_17.A.1_3.png", "Carbanak-FIN7_VM_17.A.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Code drop\" was generated when svchost.exe downloaded srrstr.dll from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_17.A.1_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}], "Linux_Only": false}, {"Substep": "17.A.2", "Procedure": "", "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_17.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.3", "Procedure": "", "Criteria": "svchost.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_17.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command-Line Interface (cmd.exe /c)\" (1/10) was generated when svchost.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_17.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Execution - Command-Line Interface (cmd.exe /c)"}, {"Detection_Note": "A Technique detection named \"Lateral Movment - DCOM - svchost Launching Command Interpreter\" (1/10) was generated when svchost.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_17.A.3_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movment - DCOM - svchost Launching Command Interpreter"}], "Linux_Only": false}, {"Substep": "17.A.4", "Procedure": "", "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_17.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.5", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.6", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_17.A.6_1.png", "Carbanak-FIN7_VM_17.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 18, "Step_Name": "User Monitoring", "Substeps": [{"Substep": "18.A.1", "Procedure": "", "Criteria": "svchost.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Inject Code\" (8/10) was generated when svchost.exe injected into explorer.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_18.A.1_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "8/10", "Indicator_Name": "Inject Code"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_18.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Modify Process\" was generated when svchost.exe injected into explorer.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_18.A.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Modify Process"}], "Linux_Only": false}, {"Substep": "18.A.2", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "18.A.3", "Procedure": "", "Criteria": "explorer.exe injects into mstsc.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_18.A.3_3.png", "Carbanak-FIN7_VM_18.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Inject code\" (8/10) was generated when explorer.exe injected into mstsc.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_18.A.3_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "8/10", "Indicator_Name": "Inject code"}], "Linux_Only": false}, {"Substep": "18.A.4", "Procedure": "", "Criteria": "mstsc.exe calls APIs such as GetAsyncKeyState, GetKeyState, or GetKeyboardState", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_18.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 19, "Step_Name": "Setup Shim Persistence", "Substeps": [{"Substep": "19.A.1", "Procedure": "", "Criteria": "User kmitnick logs on to accounting (10.0.1.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.A.1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.A.2", "Procedure": "", "Criteria": "RDP session from 10.0.1.6 to 10.0.1.7 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"Lateral Movement - Remote Desktop Protocol\" (1/10) was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remote Desktop Protocol"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.A.2_3.png", "Carbanak-FIN7_VM_19.A.2_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"RDP Protocol\" (14/100) was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.A.2_7.png", "Carbanak-FIN7_VM_19.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "14/100", "Indicator_Name": "RDP Protocol"}, {"Detection_Note": "A Technique detection named \"Lateral Movement - Remote Services\" (1/10) was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.A.2_6.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "1/10", "Indicator_Name": "Lateral Movement - Remote Services"}], "Linux_Only": false}, {"Substep": "19.A.3", "Procedure": "", "Criteria": "itadmin (10.0.1.6) is relaying RDP traffic from attacker infrastructure", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1090", "Technique_Name": "Proxy"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.1", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Command and Scripting Interpreter - Powershell\" (2/10) was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "2/10", "Indicator_Name": "Execution - Command and Scripting Interpreter - Powershell"}], "Linux_Only": false}, {"Substep": "19.B.2", "Procedure": "", "Criteria": "powershell.exe executes base64 encoded commands", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Defense Evasion - Powershell Executed with Encoded Instructions\" (5/10) was generated when powershell.exe executed base64 encoded commands.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "5/10", "Indicator_Name": "Defense Evasion - Powershell Executed with Encoded Instructions"}], "Linux_Only": false}, {"Substep": "19.B.3", "Procedure": "", "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.3_2.png", "Carbanak-FIN7_VM_19.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Code drop\" was generated when powershell.exe downloaded dll329.dll from 192.168.0.4 over RDP mounted network drive\n.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.3_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}], "Linux_Only": false}, {"Substep": "19.B.4", "Procedure": "", "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.4.png", "Carbanak-FIN7_VM_19.B.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.5", "Procedure": "", "Criteria": "sdbinst.exe installs sdbE376.tmp shim", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.5_2.png", "Carbanak-FIN7_VM_19.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Persistence - Application Shimming Registry Modification Detected\" (8/10) was generated when sdbinst.exe installed sdbE376.tmp shim database\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.5_3.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "8/10", "Indicator_Name": "Persistence - Application Shimming Registry Modification Detected"}, {"Detection_Note": "A Technique detection named \"Persistence - Suspicious PowerShell Application Shimming Detected via Sdbinst.exe\" (9/10) was generated when sdbinst.exe installed the sdbE376.tmp shim.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_19.B.5_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "9/10", "Indicator_Name": "Persistence - Suspicious PowerShell Application Shimming Detected via Sdbinst.exe"}], "Linux_Only": false}]}, {"Step_Num": 20, "Step_Name": "Steal Payment Data", "Substeps": [{"Substep": "20.A.1", "Procedure": "", "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.A.2", "Procedure": "", "Criteria": "AccountingIQ.exe injects into SyncHost.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Inject code\" was generated when AccountingIQ.exe injected into SyncHost.exe with CreateRemoteThread\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.A.2_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Inject code"}], "Linux_Only": false}, {"Substep": "20.A.3", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.A.4", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.A.4_4.png", "Carbanak-FIN7_VM_20.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.1", "Procedure": "", "Criteria": "rundll32.exe downloads debug.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Code drop\" was generated when rundll32.exe downloaded debug.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.2", "Procedure": "", "Criteria": "debug.exe calls the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Enumerate Processes\" (Medium) was generated when debug.exe called the CreateToolhelp32Snapshot API.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.B.2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Enumerate Processes"}], "Linux_Only": false}, {"Substep": "20.B.3", "Procedure": "", "Criteria": "rundll32.exe downloads 7za.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Code drop\" was generated when rundll32.exe downloaded 7za.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.B.3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Code drop"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.4", "Procedure": "", "Criteria": "7za.exe creates C:\\Users\\Public\\log.7z", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_VM_20.B.4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.5", "Procedure": "", "Criteria": "rundll32.exe reads and uploads log.7z to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}]}}}]}