{"Participant_Name": "Cybereason", "PublicRelease": "\u00a9 2021 MITRE Engenuity. Approved for Public Release. Document number AT0016", "Aggregate_Data": {"Evaluation_Aggregate_Data": {"Adversaries": [{"Adversary_Name": "apt3", "Display_Name": "APT3", "Evaluation_Year": 2018, "Total_Detections": 160, "Analytic_Detections": 61, "Telemetry_Detections": 99, "Analytic_Coverage": "59/136", "Telemetry_Coverage": "99/136", "Visibility": "107/136", "Total_Procedures_Tested": 136}, {"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Total_Detections": 126, "Analytic_Detections": 32, "Telemetry_Detections": 60, "Analytic_Coverage": "59/134", "Telemetry_Coverage": "60/134", "Visibility": "99/134", "Total_Substeps": 134}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Total_Detections": 302, "Analytic_Detections": 149, "Telemetry_Detections": 153, "Analytic_Coverage": "148/174", "Telemetry_Coverage": "153/174", "Visibility": "160/174", "Total_Substeps": 174, "Linux_Participant": true}]}}, "Adversaries": [{"Adversary_Name": "apt3", "Display_Name": "APT3", "Evaluation_Year": 2018, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated based on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Detection_Type": "General Behavior", "Modifiers": [], "Screenshots": ["CR-1.A.1-100.png", "CR-1.A.1-11.png", "CR-1.A.1-10.png"], "Footnotes": []}, {"Detection_Note": "A General Behavior alert was generated based on the identification of Resume Viewer.exe as unknown malware by the Anti-Malware engine.", "Detection_Type": "General Behavior", "Modifiers": [], "Screenshots": ["CR-1.A.1-11.png", "CR-1.A.1-10.png", "CR-1.A.1-100.png"], "Footnotes": ["Vendor stated that the capability would have prevented the execution of Resume Viewer.exe."]}, {"Detection_Note": "Telemetry showed that Resume Viewer.exe was executed and running as a process. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-1.A.1-11.png", "CR-1.A.1-100.png", "CR-1.A.1-10.png"], "Footnotes": ["The provided screenshot was captured later in the evaluation and includes additional information appended to explorer.exe not relevant to this procedure."]}]}, {"Substep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for injected shellcode by a compromised legitimate process (rundll32.exe). The alert was tagged with the correct ATT&CK Tactic (Defense Evasion) and a related Technique (Process Injection) and was tainted by parent alert on rundll32.exe injection.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-1.A.1-101.png", "CR-1.A.1-30.png", "CR-1.A.1-200.png"], "Footnotes": []}, {"Detection_Note": "A Specific Behavior alert was generated for rundll32.exe launching a module in a temporary folder and injecting shell code into a victim process. The alert was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-1.A.1-200.png", "CR-1.A.1-30.png", "CR-1.A.1-101.png"], "Footnotes": []}, {"Detection_Note": "Telemetry within the rundll32.exe injection alert also showed full command-line arguments of rundll32.exe executing update.dat. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-1.A.1-30.png", "CR-1.A.1-101.png", "CR-1.A.1-200.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability and counted as a separate detection."]}]}, {"Substep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe launching pdfhelper.cmd. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-1.A.1-20.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe rewriting autoupdate.bat to the user Debbie's Startup folder. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-1.B.1-100.png", "CR-1.B.1-10.png"], "Footnotes": []}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed port 53 command and control traffic.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-1.C.1-10.png"], "Footnotes": []}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.004", "Subtechnique_Name": "Application Layer Protocol: DNS"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe making DNS queries to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-1.C.1-20.png", "CR-1.C.1-100.png"], "Footnotes": []}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1132", "Technique_Name": "Data Encoding"}, "Subtechnique": {"Subtechnique_Id": "T1132.001", "Subtechnique_Name": "Data Encoding: Standard Encoding"}, "Detections": [{"Detection_Note": "Telemetry showed base64-encoded DNS requests for freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-1.C.1-100.png", "CR-1.C.1-20.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Initial Discovery", "Substeps": [{"Substep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing ipconfig.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.A.1-10.png", "CR-2.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing ipconfig with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.A.1-10.png", "CR-2.B.1-10.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed arp.exe executing with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.A.2-5.png", "CR-2.A.2-10.png", "CR-2.B.1-10.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.B.1-100.png"], "Footnotes": []}]}, {"Substep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "2.C.2", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing tasklist with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.A.2-10.png", "CR-2.C.2-10.png"], "Footnotes": []}]}, {"Substep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing sc.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.D.1-10.png", "CR-2.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing sc with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.B.1-10.png", "CR-2.D.1-10.png"], "Footnotes": []}]}, {"Substep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing net.exe with the correct ATT&CK Tactic (Discovery) and Technique (System Service Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.D.2-10.png", "CR-2.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.D.2-10.png", "CR-2.B.1-10.png"], "Footnotes": []}]}, {"Substep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched systeminfo.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.E.1-11.png", "CR-2.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing systeminfo with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.E.1-11.png", "CR-2.B.1-10.png"], "Footnotes": []}]}, {"Substep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Discovery) and Technique (System Information Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.E.2-10.png", "CR-2.E.2-12.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.E.2-10.png", "CR-2.E.2-12.png"], "Footnotes": []}]}, {"Substep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.D.2-10.png", "CR-2.F.1-10.png", "CR-2.F.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.F.1-10.png", "CR-2.F.1-100.png", "CR-2.D.2-10.png"], "Footnotes": []}]}, {"Substep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.D.2-10.png", "CR-2.F.2-10.png", "CR-2.F.2-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.D.2-10.png", "CR-2.F.2-100.png", "CR-2.F.2-10.png"], "Footnotes": []}]}, {"Substep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \\\"Domain Admins\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Permission Groups Discovery) and Technique (Discovery). The alert was tainted by a parent Injected Shellcode alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.D.2-10.png", "CR-2.F.3-10.png", "CR-2.F.3-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.F.3-100.png", "CR-2.D.2-10.png", "CR-2.F.3-10.png"], "Footnotes": []}]}, {"Substep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with the correct ATT&CK Technique (Account Discovery). The data was tainted by a parent Injected Shellcode alert", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.G.1-10.png", "CR-2.D.2-10.png", "CR-2.G.2-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.D.2-10.png", "CR-2.G.1-10.png", "CR-2.G.2-100.png"], "Footnotes": []}]}, {"Substep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with the correct ATT&CK Technique (Account Discovery). The data was tainted by a parent Injected Shellcode alert", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.D.2-10.png", "CR-2.G.2-10.png", "CR-2.G.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-2.G.2-10.png", "CR-2.D.2-10.png", "CR-2.G.1-100.png"], "Footnotes": []}]}, {"Substep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-2.H.1-11.png", "CR-2.H.1-10.png"], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Privilege Escalation", "Substeps": [{"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe running as medium integrity as user Debbie then another instance running later as high integrity as user Debbie. The telemetry is tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-3.A.1-1.png", "CR-3.A.1-20.png"], "Footnotes": []}]}, {"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.001", "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CR-3.A.1-10.png", "CR-3.C.1-10.png"], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for process injection from powershell.exe into cmd.exe (Anonymous RWX). The alert is tagged with the correct ATT&CK Tactic (Defense Evasion) and Technique (Process Injection). The alert is tainted by a parent PowerShell alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-3.C.1-10.png", "CR-3.C.1-100.png"], "Footnotes": []}]}]}, {"Step_Num": 4, "Step_Name": "Discovery for Lateral Movement", "Substeps": [{"Substep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \\\"Domain Controllers\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe executing as part of a suspicious execution chain related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent Injected Shellcode alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-4.A.1-10.png", "CR-4.A.1-101.png", "CR-4.A.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-4.A.1-101.png", "CR-4.A.1-10.png", "CR-4.A.1-100.png"], "Footnotes": []}]}, {"Substep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \\\"Domain Computers\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe executing as part of a suspicious execution chain related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery). The alert was tainted by a parent Injected Shellcode alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-4.A.2-10.png", "CR-4.A.2-100.png", "CR-4.A.1-101.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-4.A.2-100.png", "CR-4.A.1-101.png", "CR-4.A.2-10.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched netsh.exe executing with the correct ATT&CK Tactic (Discovery) and a related Technique (Security Software Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-4.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-4.B.1-10.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched netstat.exe executing as Reconnaissance and mapped to the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-4.C.1-10.png", "CR-4.C.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing netstat with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-4.C.1-100.png", "CR-4.C.1-10.png"], "Footnotes": []}]}]}, {"Step_Num": 5, "Step_Name": "Credential Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for svchost.exe loading Mimikatz and accessing lsass (an audited system resource). The alert was also tagged with the correct ATT&CK Tactic (Credential Access) and related Technique (Process Injection).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CR-5.A.1-11.png"], "Footnotes": []}]}, {"Substep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for svchost.exe reflectively loading a malicious executable, identified as Mimikatz, then accessing lsass. The alert was also tagged with the correct ATT&CK Technique (Process Injection) and Tactics (Defense Evasion, Privilege Escalation). The powerkatz.dll was also seen loaded as a floating executable code.", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CR-5.A.1-11.png", "CR-5.A.1-21.png"], "Footnotes": []}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "Telemetry showed svchost.exe injecting into lsass.exe. The telemetry was tainted by the parent \\\"injected (svchost.exe > lsass.exe)\\\" alert. The hashdumpx64.dll was also seen loaded as a floating executable code.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-5.A.2-20.png", "CR-5.A.2-10.png", "CR-5.A.2-11.png"], "Footnotes": []}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for svchost.exe injection into lsass.exe. The alert was mapped with the correct ATT&CK Tactic (Defense Evasion, Privilege Escalation) and Technique (Process Injection). The hashdumpx64.dll was also seen loaded as a floating executable code.", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CR-5.A.2-11.png", "CR-5.A.2-10.png", "CR-5.A.2-20.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.001", "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe associated with both users Debbie and George, indicating user context change via token manipulation. The telemetry was tainted by a parent alert on explorer.exe attempting to execute a file (Resume Viewer.exe) identified as malicious.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-5.B.1-10.png"], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Lateral Movement", "Substeps": [{"Substep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-6.A.1-10.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched rundll32.exe opening a connection to the C2 server over a \\\\\"HTTP port\\\\\" with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-6.B.1-20.png", "CR-6.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed rundll32.exe opening a connection over port 80. The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-6.B.1-20.png", "CR-6.B.1-10.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "The capability enriched rundll32.exe opening an unusual network connection to the C2 server over the port 80 \\\"HTTP port.\\\" The data was tagged with the correct ATT&CK Tactic (Command and Control) and Technique (Standard Application Layer Protocol), and also showed the amount of transmitted/received bytes as well as that the winhttp.dll module was loaded (which an analyst could use to determine HTTP was used). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-6.B.1-30.png", "CR-6.B.1-101.png", "CR-6.B.1-100.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1026", "Technique_Name": "Multiband Communication"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the same rundll32.exe opening a connection over port 80 while making DNS queries to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-6.B.1-20.png"], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker) with Remote Interactive Logon Type. The telemetry was tainted by a parent Injected Shellcode alert listed as the owner process Telemetry also showed rdpclip.exe executing on 10.0.0.5 (Conficker).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-6.C.1-10.png", "CR-6.C.1-11.png", "CR-6.B.1-20.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed lsass.exe creating a Registry key for user Jesse, indicating that the user is new.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-7.A.1-20.png"], "Footnotes": []}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1061", "Technique_Name": "Graphical User Interface"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-7.A.1-30.png"], "Footnotes": []}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.001", "Subtechnique_Name": "Account Discovery: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-7.A.1-10.png"], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the creation of updater.dll. Telemetry was tainted by a parent alert on cmd.exe (listed as the owner process) generated based on updater.dll being detected as known malware.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-7.B.1-11.png", "CR-7.B.1-10.png"], "Footnotes": []}]}, {"Substep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "The capability enriched schtasks.exe creating the Resume Viewer Update Checker scheduled task as reboot persistence and as SYSTEM. The data was also mapped to the correct ATT&CK Tactic (Persistence).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["CR-7.C.1-11.png", "CR-7.C.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the Resume Viewer Update Checker scheduled task.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-7.C.1-10.png", "CR-7.C.1-11.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Collection", "Substeps": [{"Substep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \\\"\\\\conficker\\wormshare\\\"' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing dir with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-8.A.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing dir with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-8.A.1-10.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \\\"C:\\Users\\debbie\\\"' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing tree with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (File and Directory Discovery). The data was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-8.A.1-20.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing tree with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-8.A.1-20.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CR-8.C.1-10.png", "CR-8.C.1-12.png", "CR-8.C.1-100.png", "CR-8.C.1-11.png"], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1010", "Technique_Name": "Application Window Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CR-8.D.1-10.png", "CR-8.D.1-11.png"], "Footnotes": []}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated based on a malicious code injection caused by process injection of explorer.exe. The alert was mapped with the correct ATT&CK Tactics (Defense Evasion, Privilege Escalation) and Technique (Process Injection) and indicated that explorer.exe was hosting injected threads and loading malicious files.", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CR-8.D.1-20.png", "CR-8.D.1-21.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1039", "Technique_Name": "Data from Network Shared Drive"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CR-9.B.1-20.png"], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Criteria": "", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CR-9.B.1-20.png"], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Execution of Persistence", "Substeps": [{"Substep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe executing autoupdate.bat from the Startup folder. The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-10.A.1-100.png", "CR-10.A.1-10.png"], "Footnotes": []}]}, {"Substep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe executing update.dat with command-line arguments. The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-10.A.2-100.png", "CR-10.A.1-20.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.003", "Subtechnique_Name": "Valid Accounts: Local Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed the logon session for Jesse to Conficker (10.0.0.5) as a Remote Interactive Logon Type.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-10.B.1-10.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed the logon session for Jesse to Conficker (10.0.0.5) as a Remote Interactive Logon Type. Telemetry also showed a connection over port 3389 to Conficker (10.0.0.5) through rundll32.exe serving as a proxy. The telemetry was tainted by a parent Injected Shellcode alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-10.B.1-20.png", "CR-10.B.1-100.png", "CR-10.B.1-10.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for powershell.exe, labeled with Command and Control as well as Malicious use of PowerShell. The alert was tagged as a Obfuscated PowerShell payload and mapped to the correct ATT&CK Tactic (Execution) and Technique (PowerShell)", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CR-11.A.1-14.png", "CR-11.A.1-11.png", "CR-11.A.1-13.png", "CR-11.A.1-12.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe execution, including decoded full command-line arguments, as well as wscript.exe executing autoupdate.vbs. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-11.A.1-13.png", "CR-11.A.1-12.png", "CR-11.A.1-11.png", "CR-11.A.1-14.png"], "Footnotes": []}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe as making a connection over a \\\"HTTP Port\\\". The data was tagged with the correct ATT&CK Technique (Commonly Used Port) and Tactic (Command and Control) and was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-11.A.1-13.png", "CR-11.B.1-11.png", "CR-11.B.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe making an outgoing connection on TCP port 443 to 192.168.0.5 (C2 Server). Telemetry also showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain) over port 443. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-11.A.1-13.png", "CR-11.B.1-11.png", "CR-11.B.1-100.png"], "Footnotes": []}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Telemetry showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent PowerShell alert. Telemetry also showed that powershell.exe had an outgoing connection on port 443, identified as HTTP type traffic.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-11.B.1-11.png", "CR-11.A.1-13.png"], "Footnotes": []}]}, {"Substep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Telemetry showed that powershell.exe had an outgoing connection on port 443, identified as HTTP type traffic. Telemetry also showed decoded command-line arguments to perform a HTTPS connection to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-11.B.1-11.png", "CR-11.A.1-13.png"], "Footnotes": []}]}]}, {"Step_Num": 12, "Step_Name": "Initial Discovery", "Substeps": [{"Substep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed route.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.A.1-1.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched ipconfig.exe executing with command-line arguments with the correct ATT&CK Tactic (Discovery) and Technique (System Network Configuration Discovery). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.A.2-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed ipconfig.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.A.2-1.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched whoami.exe executing as Reconnaissance and the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.B.1-1.png", "CR-12.B.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed whoami.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.B.1-2.png", "CR-12.B.1-1.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched qprocess.exe executing as Reconnaissance and Local process discovery as well as the correct ATT&CK Technique (Process Discovery) and Tactic (Discovery). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.C.1-1.png", "CR-12.B.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed qprocess.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.C.1-1.png", "CR-12.B.1-2.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Services Discovery). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.D.1-100.png", "CR-12.D.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.D.1-1.png", "CR-12.D.1-100.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a malicious command, which was identified as the Invoke-WinEnum function. The alert also identified the PowerShell commands as suspicious and were tagged with the correct ATT&CK Technique (PowerShell) and Tactic (Execution). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.E.1-2.png", "CR-12.E.1-1.png", "CR-12.E.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell Script module (.psm1) being written to the temp folder. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.E.1-1.png", "CR-12.E.1-2.png", "CR-12.E.1-100.png"], "Footnotes": []}]}, {"Substep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1201", "Technique_Name": "Password Policy Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the decoded powershell.exe function to gather clipboard data. The telemetry was tainted by a parent PowerShell alert..", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.E.1.5-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.E.1.12-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed netstat.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.E.1.12-1.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.F.1", "Procedure": "Empire: 'net group \\\"Domain Admins\\\" -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Permission Groups Discovery). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.F.1-100.png", "CR-12.F.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.F.1-100.png", "CR-12.F.1-1.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.F.2", "Procedure": "Empire: 'Net Localgroup Administrators' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Permission Groups Discovery). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.F.2-1.png", "CR-12.F.2-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.F.2-1.png", "CR-12.F.2-100.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.001", "Subtechnique_Name": "Account Discovery: Local Account"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Account Discovery). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.G.1-1.png", "CR-12.G.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.G.1-1.png", "CR-12.G.1-100.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Account Discovery). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-12.G.1-1.png", "CR-12.G.2-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-12.G.2-100.png", "CR-12.G.1-1.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"Step_Num": 13, "Step_Name": "Discovery for Lateral Movement", "Substeps": [{"Substep": "13.A.1", "Procedure": "Empire: 'net group \\\"Domain Computers\\\" -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (Remote System Discovery). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-13.A.1-10.png", "CR-13.A.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-13.A.1-10.png", "CR-13.A.1-100.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was also tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Network Connections Discovery). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-13.B.1-100.png", "CR-13.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-13.B.1-10.png", "CR-13.B.1-100.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched netstat.exe executing as Reconnaissance and the correct ATT&CK Technique (System Network Connections Discovery). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-13.B.2-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed netstat.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-13.B.2-10.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "13.C.1", "Procedure": "Empire:'reg query' via PowerShell to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-13.C.1-10.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Privilege Escalation", "Substeps": [{"Substep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed an integrity level change from medium to high for powershell.exe, which is indicative of bypass UAC. The telemetry was tainted by a parent Malicious use of PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-14.A.1-13.png", "CR-14.A.1-11.png", "CR-14.A.1-12.png"], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated based on the downloading and execution of wdbypass, identified as Fileless malware, from freegoogleadsenseinfo.com (C2 domain) over port 8080. The alert also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-14.A.1-10.png", "CR-14.A.1-40.png"], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for powershell.exe executed as a PowerShell downloader. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and the Technique (Standard Application Layer Protocol). Data also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-14.A.1-30.png", "CR-14.A.1-40.png"], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for powershell.exe executed as a PowerShell downloader. The alert was tagged with the correct ATT&CK Tactic (Command and Control) and the Technique (Commonly Used Port). Data also showed decoded PowerShell commands extracted from the command-line arguments showing a connection over port 8080 with a HTTP request to download the wdbypass payload. The alert was tainted by a parent PowerShell alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-14.A.1-30.png", "CR-14.A.1-40.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe making a network connection over port 8080.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-14.A.1-40.png", "CR-14.A.1-30.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"Step_Num": 15, "Step_Name": "Credential Access", "Substeps": [{"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "An Indicator of Compromise alert was generated based on the execution of a malicious command in PowerShell named Get-Keystrokes.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["CR-15.A.1-100.png", "CR-15.A.1-20.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed modloads associated with the execution of a keylogger.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-15.A.1-20.png", "CR-15.A.1-100.png"], "Footnotes": []}]}, {"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1010", "Technique_Name": "Application Window Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Lateral Movement", "Substeps": [{"Substep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of usersKmitnick, Bob, and Frieda", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "The capability enriched net.exe execution with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.A.1-2.png", "CR-16.A.1-10.png", "CR-16.A.1-20.png", "CR-16.A.1-3.png", "CR-16.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.A.1-10.png", "CR-16.A.1-20.png", "CR-16.A.1-3.png", "CR-16.A.1-2.png", "CR-16.A.1-1.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.A.1-2.png", "CR-16.A.1-20.png", "CR-16.A.1-3.png", "CR-16.A.1-10.png", "CR-16.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.A.1-20.png", "CR-16.A.1-2.png", "CR-16.A.1-1.png", "CR-16.A.1-10.png", "CR-16.A.1-3.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.003", "Subtechnique_Name": "Valid Accounts: Local Accounts"}, "Detections": [{"Detection_Note": "The capability enriched a logon attempt via net.exe, using the valid credentials of user Kmitnick, with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.B.1-20.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.B.1-20.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.B.1-20.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.B.1-20.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "The capability enriched net.exe execution with a related ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares) in addition to labeling net.exe as having a High Internal Outgoing Embryonic Connection Rate (meaning 25% of the internal network connections did not receive a response). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.B.1-20.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.B.1-20.png"], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.005", "Subtechnique_Name": "Indicator Removal on Host: Network Share Connection Removal"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.C.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.C.1-10.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for net.exe attempting to mount an administrative share. The alert was tagged with the correct ATT&CK Tactic (Lateral Movement) and Technique (Windows Admin Shares). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.D.1-10.png", "CR-16.D.1-100.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.D.1-10.png", "CR-16.D.1-100.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe conducting suspicious activity related to Discovery/Privilege Escalation as well as being a descendant of a suspicious process. The alert was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.D.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.D.1-10.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file write of autoupdate.vbs. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.E.1-10.png"], "Footnotes": []}]}, {"Substep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing autoupdate.vbs though wscript.exe. The telemetry was tainted by a parent PowerShell alert based on a malicious Invoke-RunAs command.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.F.1-11.png", "CR-16.F.1-13.png"], "Footnotes": []}]}, {"Substep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file events for the write of update.vbs to Creeper (10.0.0.4). The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.G.1-10.png"], "Footnotes": []}]}, {"Substep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed sc.exe execution with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.H.1-10.png"], "Footnotes": []}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for the unconventional creation of a new service with the correct ATT&CK Technique (New Service) and Tactic (Persistence, Privilege Escalation). The alert was tainted by a parent PowerShell alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.I.1-13.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed sc.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-16.I.1-13.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.004", "Subtechnique_Name": "Masquerading: Masquerade Task or Service"}, "Detections": [{"Detection_Note": "Telemetry showed sc.exe executing with command-line arguments to set the service description. An analyst could use this information to determine it is not a legitimate service. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.I.1-21.png"], "Footnotes": []}]}, {"Substep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed sc.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.J.1-10.png"], "Footnotes": []}]}, {"Substep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing the update.vbs from the Adobe Flash Updater service. Telemetry also showed sc.exe executing the service. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-16.L.1-12.png", "CR-16.L.1-100.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Persistence", "Substeps": [{"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services were enabled. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-17.A.1-20.png"], "Footnotes": []}]}, {"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed reg.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-17.A.1-10.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1222", "Technique_Name": "File and Directory Permissions Modification"}, "Subtechnique": {"Subtechnique_Id": "T1222.001", "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for takeown.exe performing activity related to swapping an accessibility features binary. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-17.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed takeown.exe executing with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-17.B.1-10.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1222", "Technique_Name": "File and Directory Permissions Modification"}, "Subtechnique": {"Subtechnique_Id": "T1222.001", "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"}, "Detections": [{"Detection_Note": "Telemetry showed icacls.exe executing with command-line arguments. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-17.B.2-10.png"], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.008", "Subtechnique_Name": "Event Triggered Execution: Accessibility Features"}, "Detections": [{"Detection_Note": "Telemetry showed creation and file write events for magnify.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-17.C.1-10.png"], "Footnotes": []}]}]}, {"Step_Num": 18, "Step_Name": "Collection", "Substeps": [{"Substep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.002", "Subtechnique_Name": "Data Staged: Remote Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed creation of the .vsdx file in the Recycle Bin.  The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-18.B.1-10.png"], "Footnotes": []}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1039", "Technique_Name": "Data from Network Shared Drive"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 19, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed that recycler.exe was WinRAR via file metadata. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-19.A.1-100.png"], "Footnotes": []}]}, {"Substep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file creation of recycler.exe by powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-19.A.1-20.png"], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent PowerShell alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-19.B.1-20.png"], "Footnotes": []}]}, {"Substep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Criteria": "", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched ftp.exe execution with a related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol). The data was tainted by a parent PowerShell alert.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"Detection_Note": "Telemetry showed the execution of ftp.exe and command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["The telemetry behind each enrichment is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "19.D.1", "Procedure": "Empire: 'del C:\\\\\"$\\\"Recycle.bin\\old.rar'", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed a deletion event for old.rar via powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-19.D.1-10.png"], "Footnotes": []}]}, {"Substep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed a deletion event for recycler.exe via powershell.exe. The telemetry was tainted by a parent PowerShell alert listed as the owner process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CR-19.D.2-10.png"], "Footnotes": []}]}]}, {"Step_Num": 20, "Step_Name": "Execution of Persistence", "Substeps": [{"Substep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.008", "Subtechnique_Name": "Event Triggered Execution: Accessibility Features"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated based on a new process masquerading as a Windows accessibility feature, mapped to the correct ATT&CK Tactic (Persistence) and Technique (Accessibility Features).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CR-20.A.1-11.png", "CR-20.A.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the execution of magnify.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-20.A.1-10.png", "CR-20.A.1-11.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "The capability enriched a RDP connection with information that the connection was made to a RDP port, as well as a related ATT&CK Tactic (Command and Control) and Techniques (Commonly Used Port, Standard Application Layer Protocol).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["CR-20.A.1-21.png", "CR-20.A.1-20.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed creation of a RDP session on Creeper (10.0.0.4).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-20.A.1-20.png", "CR-20.A.1-21.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated based on whoami.exe performing Reconnaissance as a SYSTEM user. The alert was tagged with the correct ATT&CK Tactic (Discovery) and Technique (System Owner/User Discovery). The alert was tainted by a parent Accessibility Features alert.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CR-20.B.1-10.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the execution of whoami.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CR-20.B.1-10.png"], "Footnotes": ["For most alerts in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was showed to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}]}}}, {"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-7333.png", "Cybereason-APT29-7330.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red; unique symbol) called \"User Execution\" was generated due to explorer.exe executing rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-7330.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for rcs.3aka3.doc being identified as unknown malware.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-7333.png"], "Footnotes": []}]}, {"Substep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.002", "Subtechnique_Name": "Masquerading: Right-to-Left Override"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) was generated for a payload using the RTLO character to manipulate and obscure the payload's extension.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-7328.png"], "Footnotes": []}]}, {"Substep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-7334.png"], "Footnotes": []}]}, {"Substep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.001", "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Cybereason-APT29-7335.png", "Cybereason-APT29-7334.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-7351.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10771.png"], "Footnotes": []}]}, {"Substep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of powershell.exe spawning from cmd.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10771.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-7352.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of a file event for powershell.exe executing ChildItem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10773.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for powershell.exe executing Get-ChildItem.", "Detection_Type": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-9952.png"], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}, {"Substep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection for \"malicious command\" was generated on powershell.exe executing Get-ChildItem.", "Detection_Type": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-9952.png"], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}, {"Detection_Note": "An MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of a file event and powershell.exe executing ChildItem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10773.png"], "Footnotes": []}]}, {"Substep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"PowerShell activity looking for files in a directory T1005\" occurred containing evidence of a file event for powershell.exe reading files from Pam's system.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10772.png", "Cybereason-APT29-10773.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed file opens of C:\\Users\\Pam\\*. The event was correlated to a parent General detection rcs.3aka3.doc being identified as unknown malware.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-9889.png", "Cybereason-APT29-9887.png"], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}, {"Substep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing Compress-Archive", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "An MSSP detection for \"PowerShell activity looking for files in a directory\" occurred containing evidence of powershell.exe compressing via Compress-Archive.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10772.png", "Cybereason-APT29-10773.png"], "Footnotes": []}]}, {"Substep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "An MSSP detection for Data Staged occurred containing evidence of the creation of the file Draft.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10772.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-7372.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-13667.png"], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Deploy Stealth Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-7379.png"], "Footnotes": []}]}, {"Substep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within monkey.png", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.003", "Subtechnique_Name": "Obfuscated Files or Information: Steganography"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9893.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for a malicious PowerShell process that showed the PowerShell script contained within monkey.png. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Cybereason-APT29-9895.png", "Cybereason-APT29-9894.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10775.png"], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "Telemetry showed the addition of the DelegateExecute Registry Value.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-9902.png"], "Footnotes": ["For the Configuration Change, the PowerShell detection policy was disabled."]}, {"Detection_Note": "An MSSP detection for \"COM Hijacking (T1122)\" occurred containing evidence of the addition of the DelegateExecute Registry Value.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10777.png"], "Footnotes": []}]}, {"Substep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-7389.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red; unique symbol) for malicious PowerShell was generated for new high integrity PowerShell callback spawning from control.exe. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-7389.png"], "Footnotes": []}]}, {"Substep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.  The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-7390.png"], "Footnotes": []}]}, {"Substep": "3.B.4", "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 4, "Step_Name": "Clean Up and Reconnaissance", "Substeps": [{"Substep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9594.png", "Cybereason-APT29-9596.png"], "Footnotes": []}]}, {"Substep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique alert detection (red; unique symbol) for \"Malicious Process powershell.exe\" was generated due to suspicious use of PowerShell. The detection was correlated to a parent alert for User Execution of rcs.3aka3.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Cybereason-APT29-9594.png", "Cybereason-APT29-9597.png"], "Footnotes": []}]}, {"Substep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9599.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9603.png", "Cybereason-APT29-9602.png", "Cybereason-APT29-9605.png", "Cybereason-APT29-9601.png"], "Footnotes": []}]}, {"Substep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9602.png", "Cybereason-APT29-9601.png", "Cybereason-APT29-9605.png", "Cybereason-APT29-9603.png"], "Footnotes": []}]}, {"Substep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9602.png", "Cybereason-APT29-9601.png", "Cybereason-APT29-9605.png", "Cybereason-APT29-9603.png"], "Footnotes": []}]}, {"Substep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing $env:TEMP", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Discovery - System Owner/User Discovery\" occurred containing evidence of PowerShell executing: $env:USERNAME.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10799.png"], "Footnotes": []}]}, {"Substep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "An MSSP detection for Security Software Discovery occurred containing evidence of powershell executing Get-WmiObject and -Class AntiVirusProduct.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10786.png", "Cybereason-APT29-10790.png"], "Footnotes": []}]}, {"Substep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Enumeration Invoke-Discovery\" occurred containing evidence of powershell.exe executing: Get-WmiObject ... -Class FireWallProduct.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10786.png"], "Footnotes": []}]}, {"Substep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe executing the NetUserGetGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Enumeration Invoke-Discovery\" occurred containing evidence of the NetUserGetGroups API call.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10785.png", "Cybereason-APT29-10786.png"], "Footnotes": []}]}, {"Substep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Invoke-NetUserGetGroups (psreflect)\" occurred containing evidence of the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10785.png"], "Footnotes": []}]}, {"Substep": "4.C.11", "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API", "Criteria": "powershell.exe executing the NetUserGetLocalGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Invoke-NetUserGetLocalGroups (psreflect)\" occurred containing evidence of the NetUserGetLocalGroups API call.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10783.png"], "Footnotes": []}]}, {"Substep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Invoke-NetUserGetLocalGroups (psreflect)\" occurred containing evidence of the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10783.png"], "Footnotes": []}]}]}, {"Step_Num": 5, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "Telemetry showed the creation of javamtsup service. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9606.png", "Cybereason-APT29-9608.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9610.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Invoke-Persistence (persistence via shortcut/run key)\" occurred containing evidence of the  PowerShell creating the hostui.lnk file.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10787.png"], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Credential Access", "Substeps": [{"Substep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": ["Cybereason-APT29-9912.png"], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}, {"Substep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated for accesschk.exe being an unsigned file with a known signed version. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Cybereason-APT29-9615.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.004", "Subtechnique_Name": "Unsecured Credentials: Private Keys"}, "Detections": [{"Detection_Note": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9616.png"], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "A Technique alert detection (red; unique symbol) called \"Credential Theft\" was generated due to powershell.exe injection into lsass.exe. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-9618.png", "Cybereason-APT29-9619.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-9966.png", "Cybereason-APT29-9965.png"], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}, {"Substep": "7.B.2", "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9623.png"], "Footnotes": []}]}, {"Substep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1048.003", "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed PoweShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9623.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Expand Access", "Substeps": [{"Substep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Windows Remote Management\" occurred containing evidence of the connection to remote host Scranton (10.0.1.4) over port 5985.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10779.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Windows Remote Management\" was generated due to the connection to remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-9633.png", "Cybereason-APT29-9632.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9632.png"], "Footnotes": []}]}, {"Substep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection called \"Malicious Command\" was generated for wsmprovhost.exe executing Get-Process.", "Detection_Type": "General", "Modifiers": ["Configuration Change (Detections)", "Alert"], "Screenshots": ["Cybereason-APT29-9967.png"], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}, {"Substep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a file write event of python.exe. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9635.png"], "Footnotes": []}]}, {"Substep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.002", "Subtechnique_Name": "Obfuscated Files or Information: Software Packing"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Defense Evasion - Software Packing\" showed python.exe was packed.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10780.png"], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam", "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9641.png"], "Footnotes": []}]}, {"Substep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9644.png"], "Footnotes": []}]}, {"Substep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A Tactic alert detection (red icon) called \"ATT&CK: Execution\" was generated due to PSEXESVC.exe attempting to execute a malicious file. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Cybereason-APT29-9648.png", "Cybereason-APT29-9647.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed python.exe spawned by PSEXESVC.exe. The detection was correlated to a parent alert for malicious PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9647.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Clean Up, Collection, and Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file rar.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a create file event for python.exe creating rar.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9650.png"], "Footnotes": []}]}, {"Substep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a create file event for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9650.png"], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from python.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9651.png"], "Footnotes": []}]}, {"Substep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection was generated for powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert", "Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-13287.png"], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}, {"Substep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection for \"malicious command\" was generated on powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "General", "Modifiers": ["Configuration Change (Detections)", "Alert", "Correlated"], "Screenshots": ["Cybereason-APT29-13287.png"], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}, {"Substep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file opens of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-9972.png", "Cybereason-APT29-9973.png"], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}, {"Substep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed a Create File event for powershell.exe creating working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9653.png"], "Footnotes": []}]}, {"Substep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9655.png"], "Footnotes": []}]}, {"Substep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9655.png"], "Footnotes": []}]}, {"Substep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe reading the file working.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed python.exe reading working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-13668.png"], "Footnotes": []}]}, {"Substep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9661.png"], "Footnotes": []}]}, {"Substep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9661.png"], "Footnotes": []}]}, {"Substep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9664.png"], "Footnotes": []}]}, {"Substep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for psexec.exe executing a malicious file.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-13290.png"], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Registry Run Keys / Startup Folder\" occurred containing evidence of hostui.lnk executing from Startup Folder.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10781.png"], "Footnotes": []}]}, {"Substep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9674.png"], "Footnotes": []}]}, {"Substep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.002", "Subtechnique_Name": "Access Token Manipulation: Create Process with Token"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called was generated for a mismatch between the parent and creator process on PowerShell.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-9675.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed explorer.exe spawning powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for malicious use of powershell.exe.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-9685.png", "Cybereason-APT29-9687.png"], "Footnotes": []}]}, {"Substep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1564", "Technique_Name": "Hide Artifacts"}, "Subtechnique": {"Subtechnique_Id": "T1564.004", "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9689.png", "Cybereason-APT29-9687.png"], "Footnotes": []}]}, {"Substep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1120", "Technique_Name": "Peripheral Device Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Win32 process executing...attempting to retrieve users\" occurred containing evidence of the PowerShell gwmi query for Win32_Process.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10788.png"], "Footnotes": []}]}, {"Substep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Certutil.exe used to decode data\" was generated for certutil decoding the payload with command-line arguments.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-9691.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9691.png"], "Footnotes": []}]}, {"Substep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"Registry key modification (ATT&CK Persistence)\" was generated when the Webcache subkey was added to the Registry Run key.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-9693.png", "Cybereason-APT29-9696.png"], "Footnotes": []}]}, {"Substep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9689.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red; unique symbol) called \"ATT&CK Execution: PowerShell\" was generated due to powershell.exe spawned from a PowerShell stager.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-9689.png", "Cybereason-APT29-9695.png"], "Footnotes": []}]}, {"Substep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9723.png"], "Footnotes": []}]}, {"Substep": "11.A.14", "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so detection does not apply."]}]}, {"Substep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so detection does not apply."]}]}]}, {"Step_Num": 12, "Step_Name": "Fortify Access", "Substeps": [{"Substep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.006", "Subtechnique_Name": "Indicator Removal on Host: Timestomp"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["Cybereason-APT29-9726.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Reconnaissance", "Substeps": [{"Substep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"System Information Discovery\" occurred containing evidence of the GetComputerNameEx API call.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10791.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for GetComputerNameEx being executed by powershell.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "General", "Modifiers": ["Correlated", "Configuration Change (Detections)", "Alert"], "Screenshots": ["Cybereason-APT29-9928.png"], "Footnotes": ["For the Configuration Change, the PowerShell detection policy was disabled."]}]}, {"Substep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10792.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for a PowerShell process occurred containing evidence of the GetUserNameEx API call.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10793.png"], "Footnotes": []}]}, {"Substep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for a PowerShell process occurred containing evidence of the CreateToolhelp32Snapshot API call.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10794.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Elevation & Credential Access", "Substeps": [{"Substep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9731.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red; unique symbol) was generated for \"malicious use of powershell.exe\" that showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-9734.png", "Cybereason-APT29-9733.png", "Cybereason-APT29-9731.png"], "Footnotes": []}]}, {"Substep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1047", "Technique_Name": "Windows Management Instrumentation"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9749.png"], "Footnotes": []}]}, {"Substep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Process Discovery\" occurred containing evidence of PowerShell Get-Process.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10796.png", "Cybereason-APT29-10795.png"], "Footnotes": []}]}, {"Substep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (unique symbol) was generated for using PowerShell to execute suspicious 'download' commands. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-9742.png"], "Footnotes": []}]}, {"Substep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"Credential Theft\" was generated for command-line arguments indicative of Mimikatz credential dumping and accessing Lsass. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-9750.png", "Cybereason-APT29-9751.png"], "Footnotes": []}]}, {"Substep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection was generated for Set-WmiInstance (by suspicious process). The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "General", "Modifiers": ["Alert", "Configuration Change (Detections)", "Correlated"], "Screenshots": ["Cybereason-APT29-9929.png"], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}]}, {"Substep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Deobfuscate/Decode Files or Information\" occurred containing evidence of the PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10798.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Windows Management Instrumentation Event Subscription\" occurred containing evidence of WindowsParentalControlMigration WMI filter.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10801.png"], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9767.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for Account Discovery occurred containing evidence of the ConvertSidToStringSid API call.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10802.png"], "Footnotes": []}]}, {"Substep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9773.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10805.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9779.png"], "Footnotes": []}]}, {"Substep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "An MSSP detection for Valid Accounts occurred containing evidence of the Successful logon on NewYork as user MScott.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10803.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9782.png", "Cybereason-APT29-9783.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file write of m.exe to the System32 directory by wsmprovhost.exe. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9790.png"], "Footnotes": []}]}, {"Substep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection (red, unique symbol) called Credential Theft was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-9794.png", "Cybereason-APT29-9795.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Collection", "Substeps": [{"Substep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1114", "Technique_Name": "Email Collection"}, "Subtechnique": {"Subtechnique_Id": "T1114.001", "Subtechnique_Name": "Email Collection: Local Email Collection"}, "Detections": [{"Detection_Note": "A Technique alert detection (red, unique symbol) called \"PowerShell access to Outlook mailbox data (ATT&CK: Collection)\" was generated due a process having access to Outlook mailbox data through use of a PowerShell script. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-9797.png", "Cybereason-APT29-13286.png", "Cybereason-APT29-9798.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9797.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell opening MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for malicious use of PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-9935.png", "Cybereason-APT29-9934.png"], "Footnotes": ["A sensor policy update that enables file read event collection was re-applied."]}]}, {"Substep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9799.png"], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "An MSSP detection for Data Compressed occurred containing evidence of PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10807.png"], "Footnotes": []}]}, {"Substep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of PowerShell appending the GIF file header to the compressed file.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10808.png", "Cybereason-APT29-10807.png"], "Footnotes": []}]}]}, {"Step_Num": 18, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1102", "Technique_Name": "Web Service"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) was generated due to net.exe conducting suspicious activity and connecting to a well known port. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-9807.png", "Cybereason-APT29-9812.png"], "Footnotes": []}]}, {"Substep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1567", "Technique_Name": "Exfiltration Over Web Service"}, "Subtechnique": {"Subtechnique_Id": "T1567.002", "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage"}, "Detections": [{"Detection_Note": "A General alert detection (unique symbol) was generated for PowerShell executing a malicious command. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated", "Configuration Change (Detections)"], "Screenshots": ["Cybereason-APT29-9814.png", "Cybereason-APT29-9942.png"], "Footnotes": ["A sensor policy update that enables deeper PowerShell visibility was re-applied."]}, {"Detection_Note": "An MSSP detection for Exfiltration Over Alternative Protocol occurred containing evidence of PowerShell using Copy-Item to the Y drive.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Cybereason-APT29-10809.png"], "Footnotes": []}]}]}, {"Step_Num": 20, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9830.png"], "Footnotes": []}]}, {"Substep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9831.png"], "Footnotes": []}]}, {"Substep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe spawned from WMI event subscription (wmiprvse.exe) as SYSTEM.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Cybereason-APT29-9834.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red, unique symbol) called \"ATT&CK Execution: PowerShell\" was generated due to a SYSTEM-level PowerShell spawned from wmiprvse.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Cybereason-APT29-9836.png", "Cybereason-APT29-9832.png", "Cybereason-APT29-9834.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.003", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket"}, "Detections": [{"Detection_Note": "A General alert detection was generated for attempted credential theft. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Cybereason-APT29-13712.png", "Cybereason-APT29-9840.png"], "Footnotes": []}]}, {"Substep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9846.png", "Cybereason-APT29-9845.png"], "Footnotes": []}]}, {"Substep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Cybereason-APT29-9849.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"net.exe is used to create a user or add a user to a group\" was generated for net.exe with the command-line arguments to add the new user Toby. The detection was correlated to a parent alert for the malicious use of powershell.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Cybereason-APT29-9848.png", "Cybereason-APT29-9849.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Eval_Range_Screenshots": {"Scenario_1": [{"Screenshot_Name": "Carbanak-FIN7_CR_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CR_1_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CR_1_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CR_1_3.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CR_1_4.png", "Screenshot_Caption": ""}], "Scenario_2": [{"Screenshot_Name": "Carbanak-FIN7_CR_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CR_2_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CR_2_2.png", "Screenshot_Caption": ""}]}, "Linux_Participant": true, "Alerting_Strategy": "Events that are deemed to be malicious will receive a brief description of the activity as well as relevant ATT&CK Tactics and Techniques when applicable. These alerted events are applied directly to processes, connections, and files and aggregated into a centralized view. Opening a specific alert on a process will show timestamps as well as the telemetry data that caused the alert to fire.", "Correlation_Strategy": "The process tree captures correlation between processes. Honing in on a specific process within the tree allows users to view specific information about the process such as file writes, network connections, registry modifications, and alerts with corresponding ATT&CK Tactics and Techniques. The broader Malop view provides a wider perspective on events across multiple users and hosts.", "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "1.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"User Execution (T1204) | Malicious File (T1204.002)\" was generated when explorer.exe spawned winword.exe when the user clicks 1-list.rtf.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "User Execution (T1204) | Malicious File (T1204.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.2", "Procedure": "", "Criteria": "winword.exe loads VBE7.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "A Technique detection named \"Inter-Process Communication: Component Object Model (T1559.001)\" was generated when winword.exe loaded VBE7.DLL and spawned 1-list.rtf.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.2_4.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Inter-Process Communication: Component Object Model (T1559.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.2_5.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.3", "Procedure": "", "Criteria": "wscript.exe executes unprotected.vbe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) |  Visual Basic (T1059.005)\" was generated when wscript.exe spawned unprotected.vbe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) |  Visual Basic (T1059.005)"}], "Linux_Only": false}, {"Substep": "1.A.4", "Procedure": "", "Criteria": "unprotected.vbe is an encoded file", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Obfuscated Files or Information (T1027)\" was generated when unprotected.vbe was encoded.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Obfuscated Files or Information (T1027)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.5", "Procedure": "", "Criteria": "wscript.exe decodes content and creates starter.vbs", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.5.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.6", "Procedure": "", "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.7", "Procedure": "", "Criteria": "wscript.exe executes starter.vbs", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) |  Visual Basic (T1059.005)\" was generated when wscript.exe executed starter.vbs.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) |  Visual Basic (T1059.005)"}], "Linux_Only": false}, {"Substep": "1.A.8", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.9", "Procedure": "", "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | JavaScript/JScript (T1059.007)\" was generated when cmd.exe spawned wscript.exe to executed TransBaseOdbcDriver.js.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.9_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | JavaScript/JScript (T1059.007)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.9_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.10", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "A Technique detection named \"Application Layer Protocol (T1071) | Web Protocols (T1071.001)\" was generated when wscript.exe transmitted data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.10_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Application Layer Protocol (T1071) | Web Protocols (T1071.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.10_1.png", "Carbanak-FIN7_CR_1.A.10_2.png", "Carbanak-FIN7_CR_1.A.10_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "1.A.11", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)\" was generated when wscript.exe transmitted data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.11_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.11.png", "Carbanak-FIN7_CR_1.A.11_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 2, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "2.A.2", "Procedure": "", "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"System Information Discovery (T1082)\" was generated when  wscript.exe made WMI queries for Win32_Processor & Win32_OperatingSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.A.2_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "System Information Discovery (T1082)"}], "Linux_Only": false}, {"Substep": "2.A.4", "Procedure": "", "Criteria": "wscript.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Discovery (T1057)\" was generated when  wscript.exe made WMI queries for Win32_Process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Process Discovery (T1057)"}], "Linux_Only": false}, {"Substep": "2.B.1", "Procedure": "", "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when wscript.exe downloaded screenshot__.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.B.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.B.1_6.png", "Carbanak-FIN7_CR_2.B.1_3.png", "Carbanak-FIN7_CR_2.B.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when  wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}], "Linux_Only": false}, {"Substep": "2.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) |  PowerShell (T1059.001)\" was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) |  PowerShell (T1059.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Screen Capture (T1113)\" was generated when powershell.exe executed CopyFromScreen().", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_2.B.4_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Screen Capture (T1113)"}], "Linux_Only": false}, {"Substep": "2.B.5", "Procedure": "", "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 3, "Step_Name": "Deploy Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter: (T1059) | Windows Command Shell (T1059.003)\" was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter: (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.A.2", "Procedure": "", "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.A.3", "Procedure": "", "Criteria": "Value added to Registry is base64 encoded", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.1", "Procedure": "", "Criteria": "wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when wscript.exe downloaded LanCradDriver.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.1_4.png", "Carbanak-FIN7_CR_3.B.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)\" was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.4", "Procedure": "", "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Query Registry (T1012) \" was generated when powershell.exe read Registry via Get-ItemProperty.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.4_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Query Registry (T1012)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.5", "Procedure": "", "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.5_4.png", "Carbanak-FIN7_CR_3.B.5_3.png", "Carbanak-FIN7_CR_3.B.5_5.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.6", "Procedure": "", "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Native API (T1106)\" was generated when powershell.exe executed shellcode via the CreateThread() API.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Native API (T1106)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"Command and Control (TA0011)\" was generated when powershell.exe transmited data to 192.168.0.4 over TCP.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.7_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Control (TA0011)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.7_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 4, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "4.A.1", "Procedure": "", "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"File and Directory Discovery (T1083)\" was generated when powershell.exe executed discovery techniques.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.A.1_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "File and Directory Discovery (T1083)"}], "Linux_Only": false}, {"Substep": "4.A.2", "Procedure": "", "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.A.2_3.png", "Carbanak-FIN7_CR_4.A.2_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.3", "Procedure": "", "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.A.3_2.png", "Carbanak-FIN7_CR_4.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.4", "Procedure": "", "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.1", "Procedure": "", "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded rad353F7.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.1_4.png", "Carbanak-FIN7_CR_4.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.2", "Procedure": "", "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded smrs.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.2_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.2_3.png", "Carbanak-FIN7_CR_4.B.2_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.3", "Procedure": "", "Criteria": "powershell.exe executes rad353F7.ps1", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)\" was generated when powershell.exe executed rad353F7.ps1.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.4", "Procedure": "", "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Modify Registry (T1112)\" was generated when powershell.exe added a value to the Registry via New-Item and New-ItemProperty.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Modify Registry (T1112)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.5", "Procedure": "", "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.6", "Procedure": "", "Criteria": "cmd.exe spawns smrs.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when  cmd.exe executed smrs.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}], "Linux_Only": false}, {"Substep": "4.B.7", "Procedure": "", "Criteria": "smrs.exe opens and reads lsass.exe", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique detection named \"OS Credential Dumping (T1003) | LSASS Memory (T1003.001)\" was generated when smrs.exe opened and read lsass.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.7_4.png", "Carbanak-FIN7_CR_4.B.7_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "OS Credential Dumping (T1003) | LSASS Memory (T1003.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.7_3.png", "Carbanak-FIN7_CR_4.B.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 5, "Step_Name": "Expand Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "", "Criteria": "powershell.exe downloads pscp.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded pscp.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.1_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.1_8.png", "Carbanak-FIN7_CR_5.A.1_7.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.2", "Procedure": "", "Criteria": "powershell.exe downloads psexec.py from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.2_4.png", "Carbanak-FIN7_CR_5.A.2_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded psexec.py from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.2_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}], "Linux_Only": false}, {"Substep": "5.A.3", "Procedure": "", "Criteria": "powershell.exe downloads runtime from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.3_5.png", "Carbanak-FIN7_CR_5.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded runtime from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.3_6.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}], "Linux_Only": false}, {"Substep": "5.A.4", "Procedure": "", "Criteria": "powershell.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded plink.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.4_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.4_5.png", "Carbanak-FIN7_CR_5.A.4_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.5", "Procedure": "", "Criteria": "powershell.exe downloads tiny.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded tiny.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.5_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.5_3.png", "Carbanak-FIN7_CR_5.A.5_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.6", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when powershell.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.7", "Procedure": "", "Criteria": "Pscp.exe connects over SCP (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote Services: SSH (T1021.004)\" was generated when pscp.exe connected to 10.0.0.7 over port 22.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Remote Services: SSH (T1021.004)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.8", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Valid Accounts | Domain Accounts \" was generated when kmitnick logged on to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": "Valid Accounts | Domain Accounts"}], "Linux_Only": true}, {"Substep": "5.A.9", "Procedure": "", "Criteria": "Pscp.exe copies psexec.py to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Lateral Tool Transfer (T1570)\" was generated when pscp.exe copied psexec.py to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.9_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Lateral Tool Transfer (T1570)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.9_4.png", "Carbanak-FIN7_CR_5.A.9_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.10", "Procedure": "", "Criteria": "Pscp.exe copies runtime to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Lateral Tool Transfer (T1570)\" was generated when pscp.exe copied runtime to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.10_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Lateral Tool Transfer (T1570)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.10_4.png", "Carbanak-FIN7_CR_5.A.10_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.11", "Procedure": "", "Criteria": "Pscp.exe copies tiny.exe to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.11_3.png", "Carbanak-FIN7_CR_5.A.11_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Lateral Tool Transfer (T1570)\" was generated when pscp.exe copied tiny.exe to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.A.11_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Lateral Tool Transfer (T1570)"}], "Linux_Only": true}, {"Substep": "5.B.1", "Procedure": "", "Criteria": "plink.exe connects over SSH (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote Services (T1021) | SSH (T1021.004)\" was generated when plink.exe connected to 10.0.0.7 over port 22.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Remote Services (T1021) | SSH (T1021.004)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Valid Accounts | Domain Accounts\" was generated when user kmitnick logged on to bankfileserver (10.0.0.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs"], "Indicator": "", "Indicator_Name": "Valid Accounts | Domain Accounts"}], "Linux_Only": true}, {"Substep": "5.B.3", "Procedure": "", "Criteria": "User kmitnick executes ps ax", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Discovery (T1057)\" was generated when user kmitnick executed ps ax.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Discovery (T1057)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.4", "Procedure": "", "Criteria": "User kmitnick executes ls -lsahR /var/", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"File and Directory Discovery (T1083)\" was generated when user kmitnick executed ls -lsahR /var/.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "File and Directory Discovery (T1083)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.5", "Procedure": "", "Criteria": "User kmitnick reads network-diagram-financial.xml via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Data from Local System\" was generated when user kmitnick read network-diagram-financial.xml via cat.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Data from Local System"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.6", "Procedure": "", "Criteria": "User kmitnick reads help-desk-ticket.txt via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Data from Local System (T1005) \" was generated when user kmitnick read help-desk-ticket.txt via cat.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Data from Local System (T1005)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.7", "Procedure": "", "Criteria": "User kmitnick enumerates the domain controller via nslookup, which queries for the DC (10.0.0.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote System Discovery (T1018)\" was generated when user kmitnick enumerated the domain controller via nslookup.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Remote System Discovery (T1018)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.B.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.C.1", "Procedure": "", "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Detections": [{"Detection_Note": "A Technique detection named \"Use Alternate Authentication Material (T1550) | Pass the Hash (T1550.002)\" was generated when psexec.py created a logon to 10.0.0.4 as user kmitnick.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Use Alternate Authentication Material (T1550) | Pass the Hash (T1550.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.2", "Procedure": "", "Criteria": "psexec.py connects to SMB shares on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote Services (T1021) | SMB/Windows Admin Shares (T1021.002)\" was generated when psexec.py connected to SMB shares on 10.0.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.2_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Remote Services (T1021) | SMB/Windows Admin Shares (T1021.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.3", "Procedure": "", "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A Technique detection named \"System Services (T1569) | Service Execution (T1569.002)\" was generated when cmd.exe spawned from a service executable in C:\\Windows\\.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "System Services (T1569) | Service Execution (T1569.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.4", "Procedure": "", "Criteria": "tiny.exe is created on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.5", "Procedure": "", "Criteria": "cmd.exe spawns tiny.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when cmd.exe spawned tiny.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.6", "Procedure": "", "Criteria": "tiny.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"Defense Evasion (TA0005)\" was generated when tiny.exe loaded shellcode from a network connection into memory.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.6_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Defense Evasion (TA0005)"}], "Linux_Only": false}]}, {"Step_Num": 6, "Step_Name": "Discover Potential Targets", "Substeps": [{"Substep": "6.A.1", "Procedure": "", "Criteria": "tiny.exe loads system.management.automation.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)\" was generated when tiny.exe loaded PowerShell modules.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_6.A.1_3.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_6.A.1_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "6.A.2", "Procedure": "", "Criteria": "PowerShell executes Get-ADComputer", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "6.A.3", "Procedure": "", "Criteria": "PowerShell executes Get-NetUser", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_6.A.3_3.png"], "Footnotes": ["Executed command is Base64 encoded"], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Account Discovery (T1087) | Domain Account (T1087.002)\" was generated when PowerShell executed Get-NetUser.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_6.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Account Discovery (T1087) | Domain Account (T1087.002)"}], "Linux_Only": false}]}, {"Step_Num": 7, "Step_Name": "Setup Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "", "Criteria": "tiny.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.1_4.png", "Carbanak-FIN7_CR_7.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.2", "Procedure": "", "Criteria": "tiny.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when tiny.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.3", "Procedure": "", "Criteria": "plink.exe transmits data to 192.168.0.4 over SSH protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Remote Services | SSH\" was generated when plink.exe transmited data to 192.168.0.4 over SSH protocol.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.3_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Remote Services | SSH"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.3_4.png", "Carbanak-FIN7_CR_7.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to bankdc (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Valid Accounts | Domain Accounts \" was generated when user kmitnick logged on to bankdc (10.0.0.4).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "Valid Accounts | Domain Accounts"}], "Linux_Only": false}, {"Substep": "7.A.5", "Procedure": "", "Criteria": "RDP session from the localhost over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Remote Services (T1021) | Remote Desktop Protocol (T1021.001)\" was generated when an RDP session was created from localhost over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Remote Services (T1021) | Remote Desktop Protocol (T1021.001)"}], "Linux_Only": false}, {"Substep": "7.B.1", "Procedure": "", "Criteria": "powershell.exe executes qwinsta /server:cfo", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"System Owner/User Discovery (T1033)\" was generated when powershell.exe executed qwinsta /server:cfo.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "System Owner/User Discovery (T1033)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to cfo (10.0.0.5)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Valid Accounts | Domain Accounts \" was generated when user kmitnick logged on to cfo (10.0.0.5).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "Valid Accounts | Domain Accounts"}], "Linux_Only": false}, {"Substep": "7.B.3", "Procedure": "", "Criteria": "RDP session from 10.0.0.4 to 10.0.0.5 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Remote Services (T1021) | Remote Desktop Protocol (T1021.001)\" was generated when an RDP session was created from bankdc (10.0.0.4) to cfo (10.0.0.5) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Remote Services (T1021) | Remote Desktop Protocol (T1021.001)"}], "Linux_Only": false}, {"Substep": "7.C.1", "Procedure": "", "Criteria": "scp.exe downloads Java-Update.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when scp.exe downloaded Java-Update.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.C.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.C.1_2.png", "Carbanak-FIN7_CR_7.C.1_4.png", "Carbanak-FIN7_CR_7.C.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.2", "Procedure": "", "Criteria": "dir lists the contents of C:\\Users\\Public", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.3", "Procedure": "", "Criteria": "cmd.exe downloads Java-Update.vbs from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"File Download Indication\" was generated when cmd.exe downloaded Java-Update.vbs from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.C.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "File Download Indication"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.C.3_2.png", "Carbanak-FIN7_CR_7.C.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.4", "Procedure": "", "Criteria": "Java-Update subkey is added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique detection named \"Boot or Logon Autostart Execution (T1547) | Registry Run Keys / Startup Folder (T1547.001)\" was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.C.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Boot or Logon Autostart Execution (T1547) | Registry Run Keys / Startup Folder (T1547.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_7.C.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 8, "Step_Name": "Gain Covert Access to Target", "Substeps": [{"Substep": "8.A.1", "Procedure": "", "Criteria": "wscript.exe spawns Java-Update.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059)\" was generated when wscript.exe spawned Java-Update.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_8.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_8.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "8.A.2", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_8.A.2_3.png", "Carbanak-FIN7_CR_8.A.2_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Application Layer Protocol (T1071) | Web Protocols (T1071.001)\" was generated when Java-Update.exe transmited data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_8.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Application Layer Protocol (T1071) | Web Protocols (T1071.001)"}], "Linux_Only": false}, {"Substep": "8.A.3", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_8.A.3_3.png", "Carbanak-FIN7_CR_8.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)\" was generated when Java-Update.exe transmited data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_8.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)"}], "Linux_Only": false}]}, {"Step_Num": 9, "Step_Name": "Profile a Victim User", "Substeps": [{"Substep": "9.A.1", "Procedure": "", "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when Java-Update.exe downloaded DefenderUpgradeExec.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.1_6.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.1_4.png", "Carbanak-FIN7_CR_9.A.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.2", "Procedure": "", "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Technique detection named \"Input Capture (T1056)\" was generated when DefenderUpgradeExec.exe made a Windows API call associated with keylogging.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.2_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Input Capture (T1056)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.3", "Procedure": "", "Criteria": "Java-Update.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Injection (T1055)\" was generated when Java-Update.exe injected into explorer.exe .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Process Injection (T1055)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.3_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.4", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Screen Capture (T1113)\" was generated when explorer.exe made a Windows API call associated with taking screenshots.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Screen Capture (T1113)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.4_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.5", "Procedure": "", "Criteria": "explorer.exe reads C:\\Users\\jsmith\\AppData\\Local\\Temp\\Klog2.txt over to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.1", "Procedure": "", "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when explorer.exe downloaded infosMin48.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.B.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.B.1_4.png", "Carbanak-FIN7_CR_9.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.2", "Procedure": "", "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.B.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.3", "Procedure": "", "Criteria": "powershell.exe deletes files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique detection named \"Indicator Removal on Host (T1070)\" was generated when powershell.exe deleted files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.B.3_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Indicator Removal on Host (T1070)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_9.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 10, "Step_Name": "Impersonate Victim", "Substeps": [{"Substep": "10.A.1", "Procedure": "", "Criteria": "explorer.exe downloads tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when explorer.exe downloaded tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.1_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.1_3.png", "Carbanak-FIN7_CR_10.A.1_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.2", "Procedure": "", "Criteria": "explorer.exe downloads vnc-settings.reg from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.2_3.png", "Carbanak-FIN7_CR_10.A.2_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when explorer.exe downloaded vnc-settings.reg from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.2_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}], "Linux_Only": false}, {"Substep": "10.A.3", "Procedure": "", "Criteria": "netsh adds Service Host rule for TCP port 5900", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1562", "Technique_Name": "Impair Defenses"}, "Subtechnique": {"Subtechnique_Id": "T1562.004", "Subtechnique_Name": "Impair Defenses: Disable or Modify System Firewall"}, "Detections": [{"Detection_Note": "A Technique detection named \"Impair Defenses (T1562) | Disable or Modify System Firewall (T562.004)\" was generated when netsh.exe added 'Service Host' rule to allow TCP port 5900 inbound.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Impair Defenses (T1562) | Disable or Modify System Firewall (T562.004)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.4", "Procedure": "", "Criteria": "msiexec.exe adds the tvncontrol subkey in HKLM\\Software\\Microsoft\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique detection named \"Boot or Logon Autostart Execution (T1547)\" was generated when tvncontrol subkey was added to HKLM\\Software\\Microsoft\\CurrentVersion\\Run.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Boot or Logon Autostart Execution (T1547)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.5", "Procedure": "", "Criteria": "Addition of subkeys in HKLM\\Software\\TightVNC\\Server", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Modify Registry (T1112)\" was generated when subkeys added to HKLM\\Software\\TightVNC\\Server via vnc-settings.reg.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.5_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "Modify Registry (T1112)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.6", "Procedure": "", "Criteria": "Deletion of the Java-Update subkey in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Boot or Logon Autostart Execution (T1547) / Registry Run Keys / Startup Folder (T1547.001)\" was generated when Java-Update subkey at HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run was deleted.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Boot or Logon Autostart Execution (T1547) / Registry Run Keys / Startup Folder (T1547.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.A.6_4.png", "Carbanak-FIN7_CR_10.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.B.1", "Procedure": "", "Criteria": "tvnserver.exe accepts a connection from 192.168.0.4 over TCP port 5900", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1219", "Technique_Name": "Remote Access Software"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote Access Software (T1219)\" was generated when tvnserver.exe accepted a connection from 192.168.0.4 over TCP port 5900.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.B.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Remote Access Software (T1219)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_10.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "11.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"User Execution (T1204) | Malicious File (T1204.002)\" was generated when explorer.exe spawned winword.exe when the user clicked 2-list.rtf.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "User Execution (T1204) | Malicious File (T1204.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.2", "Procedure": "", "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Obfuscated Files or Information (T1027)\" was generated when 2-list.rtf contained an embedded lnk payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Obfuscated Files or Information (T1027)"}], "Linux_Only": false}, {"Substep": "11.A.3", "Procedure": "", "Criteria": "winword.exe spawns mshta.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Signed Binary Proxy Execution (T1218) | Mshta (T1218.005)\" was generated when winword.exe spawned mshta.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Signed Binary Proxy Execution (T1218) | Mshta (T1218.005)"}], "Linux_Only": false}, {"Substep": "11.A.4", "Procedure": "", "Criteria": "mshta.exe executes an embedded VBScript payload", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Visual Basic (T1059.005)\" was generated when mshta.exe executed an embedded VBScript payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Visual Basic (T1059.005)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.4_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.5", "Procedure": "", "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"Defense Evasion (TA0002)\" was generated when mshta.exe executed sql-rat.js.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.5_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Defense Evasion (TA0002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.5_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.6", "Procedure": "", "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Detections": [{"Detection_Note": "A Technique detection named \"Masquerading (T1036) | Rename System Utilities (T1036.003)\" was generated when Adb156.exe was executed.", "Detection_Type": "Technique", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CR_11.A.6_4.png"], "Footnotes": ["Marked as delayed due to detection occurring after execution, not file create."], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Masquerading (T1036) | Rename System Utilities (T1036.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.7", "Procedure": "", "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Inter-Process Communication (T1559) | Component Object Model (T1559.001)\" was generated when winword.exe spawned verclsid.exe and loaded VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "Inter-Process Communication (T1559) | Component Object Model (T1559.001)"}], "Linux_Only": false}, {"Substep": "11.A.8", "Procedure": "", "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.8_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Scheduled Task/Job (T1053) | Scheduled Task (T1053.005)\" .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.8_5.png", "Carbanak-FIN7_CR_11.A.8_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Scheduled Task/Job (T1053) | Scheduled Task (T1053.005)"}], "Linux_Only": false}]}, {"Step_Num": 12, "Step_Name": "Delayed Malware Execution", "Substeps": [{"Substep": "12.A.1", "Procedure": "", "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "A Tactic detection named \"Execution (TA0002)\" was generated when svchost.exe (-s Schedule) spawned Adb156.exe.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_12.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Execution (TA0002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_12.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.2", "Procedure": "", "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | JavaScript/JScript (T1059.007)\" was generated when Adb156.exe loaded scrobj.dll and executed sql-rat.js using Jscript.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_12.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | JavaScript/JScript (T1059.007)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_12.A.2_4.png", "Carbanak-FIN7_CR_12.A.2_3.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.3", "Procedure": "", "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_12.A.3_3.png", "Carbanak-FIN7_CR_12.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"System Network Configuration Discovery (T1016) \" was generated when Adb156.exe made a WMI query for Win32_NetworkAdapterConfiguration.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_12.A.4_3.png"], "Footnotes": ["change to monitor WMI queries"], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "System Network Configuration Discovery (T1016)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_12.A.4_2.png"], "Footnotes": ["change to monitor WMI queries"], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.5", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads stager.ps1 from 192.168.0.6", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when Adb156.exe downloaded stager.ps1 from 192.168.0.6.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_12.B.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_12.B.1_3.png", "Carbanak-FIN7_CR_12.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 13, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "13.A.1", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Discovery (T1057)\" was generated when Adb156.exe made a WMI query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_13.A.1_3.png"], "Footnotes": ["change to monitor WMI queries"], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Process Discovery (T1057)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_13.A.1_2.png"], "Footnotes": ["change to monitor WMI queries"], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.3", "Procedure": "", "Criteria": "cmd.exe executes net view", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Network Share Discovery (T1135)\" was generated when cmd.exe executed net view.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Network Share Discovery (T1135)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "A Technique detection named \"Virtualization/Sandbox Evasion (T1497) | System Checks (T1497.001)\" was generated when Adb156.exe made a WMI query for Win32_BIOS.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_13.A.4_4.png"], "Footnotes": ["change to monitor WMI queries"], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Virtualization/Sandbox Evasion (T1497) | System Checks (T1497.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_13.A.4_3.png"], "Footnotes": ["change to monitor WMI queries"], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.5", "Procedure": "", "Criteria": "Adb156.exe queries the USERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"System Owner/User Discovery (T1033)\" was generated when Adb156.exe queried the USERNAME environment variable.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_13.A.5_3.png"], "Footnotes": ["change to monitor queries of environment variables"], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "System Owner/User Discovery (T1033)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_13.A.5_2.png"], "Footnotes": ["change to monitor queries of environment variables"], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.6", "Procedure": "", "Criteria": "Adb156.exe queries the COMPUTERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"System Information Discovery (T1082)\" was generated when Adb156.exe queried the COMPUTERNAME environment variable.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_13.A.6_3.png"], "Footnotes": ["change to monitor queries of environment variables"], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "System Information Discovery (T1082)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CR_13.A.6_2.png"], "Footnotes": ["change to monitor queries of environment variables"], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.8", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.9", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when Adb156.exe downloaded takeScreenshot.ps1 from 192.168.0.6 over port 1433.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.B.1_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.B.1_4.png", "Carbanak-FIN7_CR_13.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)\" was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)"}], "Linux_Only": false}, {"Substep": "13.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.B.4_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Screen Capture (T1113)\" was generated when  powershell.exe executed CopyFromScreen() .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_13.B.4_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Screen Capture (T1113)"}], "Linux_Only": false}, {"Substep": "13.B.5", "Procedure": "", "Criteria": "Adb156.exe reads and uploads image.png to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 14, "Step_Name": "Staging Interactive Toolkit", "Substeps": [{"Substep": "14.A.1", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.2", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)\" was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.3", "Procedure": "", "Criteria": "powershell.exe decodes an embedded DLL payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Obfuscated Files of Information\" was generated when  powershell.exe decoded an embedded DLL payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Obfuscated Files of Information"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.4", "Procedure": "", "Criteria": "powershell.exe executes the decoded payload using Invoke-Expression (IEX)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Powershell Indication, Command and Scripting Interpreter (T1059) | Powershell (T1059.001)\" was generated when powershell.exe used Invoke-Expression (IEX).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Powershell Indication, Command and Scripting Interpreter (T1059) | Powershell (T1059.001)"}], "Linux_Only": false}, {"Substep": "14.A.5", "Procedure": "", "Criteria": "powershell.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"Defense Evasion (TA0005)\" was generated when powershell.exe loaded shellcode from network connection into memory.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.5_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Defense Evasion (TA0005)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.5.png", "Carbanak-FIN7_CR_14.A.5_1.png", "Carbanak-FIN7_CR_14.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.6", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.6_3.png", "Carbanak-FIN7_CR_14.A.6_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Application Layer Protocol (T1071) | Web Protocols (T1071.001)\" was generated when powershell.exe transmited data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.6_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Application Layer Protocol (T1071) | Web Protocols (T1071.001)"}], "Linux_Only": false}, {"Substep": "14.A.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.7_3.png", "Carbanak-FIN7_CR_14.A.7_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)\" was generated when powershell.exe transmited data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_14.A.7_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)"}], "Linux_Only": false}]}, {"Step_Num": 15, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "15.A.1", "Procedure": "", "Criteria": "powershell.exe calls the CreateToolhelp32Snapshot() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Discovery (T1057)\" was generated when powershell.exe called the CreateToolhelp32Snapshot API.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Process Discovery (T1057)"}], "Linux_Only": false}, {"Substep": "15.A.2", "Procedure": "", "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when  powershell.exe downloaded samcat.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.2_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.2_2.png", "Carbanak-FIN7_CR_15.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.3", "Procedure": "", "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded uac-samcats.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.3_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.3_3.png", "Carbanak-FIN7_CR_15.A.3_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.4", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)\" was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.5", "Procedure": "", "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.5_3.png", "Carbanak-FIN7_CR_15.A.5_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Abuse Elevation Control Mechanism (T1548) | Bypass User Account Control (T1548.002 )\" was generated when a duplicate of a token for a high integrity account was detected.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.5.png", "Carbanak-FIN7_CR_15.A.5_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Abuse Elevation Control Mechanism (T1548) | Bypass User Account Control (T1548.002 )"}], "Linux_Only": false}, {"Substep": "15.A.6", "Procedure": "", "Criteria": "samcat.exe opens and reads the SAM via LSASS", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.6_4.png", "Carbanak-FIN7_CR_15.A.6_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"OS Credential Dumping (T1003) | Security Account Manager (T1003.002)\" was generated when abnormal access to the Sysket encryption registry key was detected.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "OS Credential Dumping (T1003) | Security Account Manager (T1003.002)"}], "Linux_Only": false}, {"Substep": "15.A.7", "Procedure": "", "Criteria": "powershell.exe calls the GetIpNetTable() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.7_2.png"], "Footnotes": [], "Data_Sources": ["RPC", "Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"System Network Configuration Discovery (T1016)\" was generated when powershell.exe made rpc requests querying for installed network adapters.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.7_3.png"], "Footnotes": [], "Data_Sources": ["RPC", "Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "System Network Configuration Discovery (T1016)"}], "Linux_Only": false}, {"Substep": "15.A.8", "Procedure": "", "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote System Discovery (T1018)\" was generated when powershell.exe spawned nslookup.exe, which queried the DC (10.0.1.4) over DNS (port 53).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.8_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Remote System Discovery (T1018)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "", "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105) \" was generated when powershell.exe downloaded paexec.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.1_3.png", "Carbanak-FIN7_CR_16.A.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.2", "Procedure": "", "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105) \" was generated when powershell.exe downloaded hollow.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.2_4.png", "Carbanak-FIN7_CR_16.A.2_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.3", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when powershell.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Valid Accounts (T1078) | Domain Accounts (T1078.002)\" was generated when kmitnick logged on to itadmin (10.0.1.6).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "Valid Accounts (T1078) | Domain Accounts (T1078.002)"}], "Linux_Only": false}, {"Substep": "16.A.5", "Procedure": "", "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.6", "Procedure": "", "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A Technique detection named \"System Services (T1569) | Service Execution (T1569.002)\" was generated when Windows service started PAExec service, which executes hollow.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.6_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "System Services (T1569) | Service Execution (T1569.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.6_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.7", "Procedure": "", "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Injection (T1055) | Process Hollowing (T1055.012)\" was generated when hollow.exe spawned svchost.exe and umapped its memory image.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Process Injection (T1055) | Process Hollowing (T1055.012)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.7_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.8", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.8_3.png", "Carbanak-FIN7_CR_16.A.8_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Application Layer Protocol (T1071) | Web Protocols (T1071.001)\" was generated when svchost.exe transmited data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.8_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Application Layer Protocol (T1071) | Web Protocols (T1071.001)"}], "Linux_Only": false}, {"Substep": "16.A.9", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.9_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)\" was generated when svchost.exe transmited data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.9_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)"}], "Linux_Only": false}]}, {"Step_Num": 17, "Step_Name": "Setup User Monitoring", "Substeps": [{"Substep": "17.A.1", "Procedure": "", "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when svchost.exe downloaded srrstr.dll from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.1_3.png", "Carbanak-FIN7_CR_17.A.1_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.2", "Procedure": "", "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "A Technique detection named \"Masquerading (T1036) | Match Legitimate Name or Location (T1036.005)\" was generated when SystemPropertiesAdvanced.exe loaded a malicious module from a system folder.", "Detection_Type": "Technique", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CR_17.A.2_5.png"], "Footnotes": ["Marked as delayed due to detection occurring after execution, not file create."], "Data_Sources": ["File Monitoring", "Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "Masquerading (T1036) | Match Legitimate Name or Location (T1036.005)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.2_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.3", "Procedure": "", "Criteria": "svchost.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)\" was generated when svchost.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | Windows Command Shell (T1059.003)"}], "Linux_Only": false}, {"Substep": "17.A.4", "Procedure": "", "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Hijack Execution Flow (T1574) | DLL Search Order Hijacking (T1574.001)\" was generated when SystemPropertiesAdvanced.exe executed code in the illegitimate srrstr.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.4_3.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Hijack Execution Flow (T1574) | DLL Search Order Hijacking (T1574.001)"}], "Linux_Only": false}, {"Substep": "17.A.5", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.5_4.png", "Carbanak-FIN7_CR_17.A.5_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Application Layer Protocol (T1071) | Web Protocols (T1071.001)\" was generated when rundll32.exe transmited data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.5_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Application Layer Protocol (T1071) | Web Protocols (T1071.001)"}], "Linux_Only": false}, {"Substep": "17.A.6", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)\" was generated when rundll32.exe transmited data to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.6_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.6_4.png", "Carbanak-FIN7_CR_17.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 18, "Step_Name": "User Monitoring", "Substeps": [{"Substep": "18.A.1", "Procedure": "", "Criteria": "svchost.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_18.A.1_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Process Injection (T1055)\" was generated when svchost.exe injected into explorer.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_18.A.1_3.png", "Carbanak-FIN7_CR_18.A.1_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Injection (T1055)"}], "Linux_Only": false}, {"Substep": "18.A.2", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Screen Capture (T1113)\" was generated when explorer.exe called the CreateCompatibleBitmap API from Gdi32.dll .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_18.A.2_4.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Screen Capture (T1113)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_18.A.2_3.png", "Carbanak-FIN7_CR_18.A.2_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "18.A.3", "Procedure": "", "Criteria": "explorer.exe injects into mstsc.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_18.A.3_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Process Injection (T1055)\" was generated when explorer.exe injected into mstsc.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_18.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Process Injection (T1055)"}], "Linux_Only": false}, {"Substep": "18.A.4", "Procedure": "", "Criteria": "mstsc.exe calls APIs such as GetAsyncKeyState, GetKeyState, or GetKeyboardState", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Technique detection named \"Input Capture (T1056) | Keylogging (T1056.001)\" was generated when mstsc.exe called APIs to capture key strokes.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_18.A.4_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Input Capture (T1056) | Keylogging (T1056.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_18.A.4_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 19, "Step_Name": "Setup Shim Persistence", "Substeps": [{"Substep": "19.A.1", "Procedure": "", "Criteria": "User kmitnick logs on to accounting (10.0.1.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"Valid Accounts | Local Accounts\" was generated when user kmitnick logged on to accounting (10.0.1.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "Valid Accounts | Local Accounts"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.A.2", "Procedure": "", "Criteria": "RDP session from 10.0.1.6 to 10.0.1.7 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Remote Services (T1021) | Remote Desktop Protocol (T1021.001)\" was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Remote Services (T1021) | Remote Desktop Protocol (T1021.001)"}], "Linux_Only": false}, {"Substep": "19.A.3", "Procedure": "", "Criteria": "itadmin (10.0.1.6) is relaying RDP traffic from attacker infrastructure", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1090", "Technique_Name": "Proxy"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.1", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)\" was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command and Scripting Interpreter (T1059) | PowerShell (T1059.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.2", "Procedure": "", "Criteria": "powershell.exe executes base64 encoded commands", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Obfuscated Files or Information (T078)\" was generated when powershell.exe executed base64 encoded commands\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.2_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Obfuscated Files or Information (T078)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.2_3.png", "Carbanak-FIN7_CR_19.B.2_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.3", "Procedure": "", "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded dll329.dll from 192.168.0.4 over RDP mounted network drive\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.3_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.4", "Procedure": "", "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when powershell.exe downloaded sdbE376.tmp from 192.168.0.4 over RDP mounted network drive\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}], "Linux_Only": false}, {"Substep": "19.B.5", "Procedure": "", "Criteria": "sdbinst.exe installs sdbE376.tmp shim", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "A Technique detection named \"Event Triggered Execution (T1546) | Application Shimming (T1546.011)\" was generated when sdbinst.exe installed sdbE376.tmp shim database\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.5_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Event Triggered Execution (T1546) | Application Shimming (T1546.011)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 20, "Step_Name": "Steal Payment Data", "Substeps": [{"Substep": "20.A.1", "Procedure": "", "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "A Technique detection named \"Event Triggered Execution (T1546) | Application Shimming (T1546.011)\" was generated when shim database registry key modification was observed.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Event Triggered Execution (T1546) | Application Shimming (T1546.011)"}], "Linux_Only": false}, {"Substep": "20.A.2", "Procedure": "", "Criteria": "AccountingIQ.exe injects into SyncHost.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Injection (T1055)\" was generated when AccountingIQ.exe injected into SyncHost.exe with CreateRemoteThread\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.A.2_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Injection (T1055)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.A.3", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.A.4", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)\" was generated when rundll32.exe exchanged data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.A.4_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Encrypted Channel (T1573) | Asymmetric Cryptography (T1573.002)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.A.4_2.png", "Carbanak-FIN7_CR_20.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.1", "Procedure": "", "Criteria": "rundll32.exe downloads debug.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when rundll32.exe downloaded debug.exe from 192.168.0.4\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.B.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.B.1_4.png", "Carbanak-FIN7_CR_20.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.2", "Procedure": "", "Criteria": "debug.exe calls the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.3", "Procedure": "", "Criteria": "rundll32.exe downloads 7za.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress Tool Transfer (T1105)\" was generated when rundll32.exe downloaded 7za.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.B.3_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress Tool Transfer (T1105)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.B.3_3.png", "Carbanak-FIN7_CR_20.B.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.4", "Procedure": "", "Criteria": "7za.exe creates C:\\Users\\Public\\log.7z", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A General detection named \"Exfiltration Over C2 Channel (T1041)\" was generated when rundll32.exe ran an archive utility while connected to an external IP address.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.B.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Exfiltration Over C2 Channel (T1041)"}, {"Detection_Note": "A Technique detection named \"Archive Collected Data (T1560) | Archive via Utility (T1560.001)\" was generated when 7za.exe created C:\\Users\\Public\\log.7z.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.B.4_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Archive Collected Data (T1560) | Archive via Utility (T1560.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CR_20.B.4_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.5", "Procedure": "", "Criteria": "rundll32.exe reads and uploads log.7z to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}]}}, "Protections": {"Protection_Tests": [{"Test_Num": 1, "Test_Group": "Carbanak", "Test_Name": "Initial Access with Embedded VBE in Word Document", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "1.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf"}, {"Substep_Name": "1.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe loads VBE7.DLL"}, {"Substep_Name": "1.A.3", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 1 was blocked when unprotected.vbe could not be written, because of the file write location.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_1.A.3P.png", "Carbanak-FIN7_CR_1.A.3P_1.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes unprotected.vbe"}, {"Substep_Name": "1.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "unprotected.vbe is an encoded file"}, {"Substep_Name": "1.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates starter.vbs"}, {"Substep_Name": "1.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes starter.vbs"}, {"Substep_Name": "1.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "1.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.10", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "1.A.11", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "2.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem"}, {"Substep_Name": "2.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes a WMI query for Win32_Process"}, {"Substep_Name": "2.B.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4"}, {"Substep_Name": "2.B.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "2.B.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "cmd.exe spawns powershell.exe"}, {"Substep_Name": "2.B.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes CopyFromScreen()"}, {"Substep_Name": "2.B.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4"}], "Test_Screenshots": []}, {"Test_Num": 2, "Test_Group": "Carbanak", "Test_Name": "Registry Shellcode and Execution", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "3.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer"}, {"Substep_Name": "3.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Value added to Registry is base64 encoded"}, {"Substep_Name": "3.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty"}, {"Substep_Name": "3.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode"}, {"Substep_Name": "3.B.6", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 2 was blocked when powershell.exe was terminated, because it tried to execute shellcode.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_3.B.6P.png", "Carbanak-FIN7_CR_3.B.6P_3.png", "Carbanak-FIN7_CR_3.B.6P_2.png", "Carbanak-FIN7_CR_3.B.6P_1.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API"}, {"Substep_Name": "3.B.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP"}, {"Substep_Name": "4.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs"}, {"Substep_Name": "4.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4"}, {"Substep_Name": "4.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access"}, {"Substep_Name": "4.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick"}], "Test_Screenshots": []}, {"Test_Num": 3, "Test_Group": "Carbanak", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "4.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4"}, {"Substep_Name": "4.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4"}, {"Substep_Name": "4.B.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe executes rad353F7.ps1"}, {"Substep_Name": "4.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty"}, {"Substep_Name": "4.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "4.B.6", "Protection_Type": "None", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns smrs.exe"}, {"Substep_Name": "4.B.7", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 3 was blocked when smrs.exe was terminated, because it was identified as known malware.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_4.B.7P_2.png", "Carbanak-FIN7_CR_4.B.7P.png", "Carbanak-FIN7_CR_4.B.7P_1.png"], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "smrs.exe opens and reads lsass.exe"}], "Test_Screenshots": []}, {"Test_Num": 4, "Test_Group": "Carbanak", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity all on bankfileserver (10.0.0.7) to bankdc (10.0.0.4) as user kmitnick", "Substeps": [{"Substep_Name": "5.C.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 4 was blocked when psexec.py was blocked before creation, because it was identified as threat activity.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_5.C.1P_2.png", "Carbanak-FIN7_CR_5.C.1P_3.png", "Carbanak-FIN7_CR_5.C.1P_1.png", "Carbanak-FIN7_CR_5.C.1P.png"], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick"}, {"Substep_Name": "5.C.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "psexec.py connects to SMB shares on 10.0.0.4"}, {"Substep_Name": "5.C.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\"}, {"Substep_Name": "5.C.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe is created on 10.0.0.4"}, {"Substep_Name": "5.C.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns tiny.exe"}, {"Substep_Name": "5.C.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe loads shellcode from network connection into memory"}], "Test_Screenshots": []}, {"Test_Num": 5, "Test_Group": "Carbanak", "Test_Name": "Credential Access", "Test_Description": "Activity on cfo (10.0.0.5) as user jsmith", "Substeps": [{"Substep_Name": "9.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4"}, {"Substep_Name": "9.A.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Also, DefenderUpgradeExec.exe was blocked on execution, because it was identified as malware.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_9.A.2P_2.png", "Carbanak-FIN7_CR_9.A.2P_1.png", "Carbanak-FIN7_CR_9.A.2P.png", "Carbanak-FIN7_CR_9.A.2P_3.png"], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API"}, {"Substep_Name": "9.B.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4"}, {"Substep_Name": "9.B.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 5 was blocked when infosmin48.exe was terminated, because it was identified as unknown malware.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_9.B.2P_6.png", "Carbanak-FIN7_CR_9.B.2P_5.png", "Carbanak-FIN7_CR_9.B.2P_7.png", "Carbanak-FIN7_CR_9.B.2P_4.png"], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll"}], "Test_Screenshots": []}, {"Test_Num": 11, "Test_Group": "FIN7", "Test_Name": "Initial Access with Embedded VBS in Word Document", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "11.A.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 11 was blocked when the 2-list.rtf was not created, because it detected as malware.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_11.A.1P.png", "Carbanak-FIN7_CR_11.A.1P_3.png", "Carbanak-FIN7_CR_11.A.1P_2.png", "Carbanak-FIN7_CR_11.A.1P_1.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf"}, {"Substep_Name": "11.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk"}, {"Substep_Name": "11.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Criteria": "winword.exe spawns mshta.exe"}, {"Substep_Name": "11.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "mshta.exe executes an embedded VBScript payload"}, {"Substep_Name": "11.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload"}, {"Substep_Name": "11.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe"}, {"Substep_Name": "11.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL"}, {"Substep_Name": "11.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes"}, {"Substep_Name": "12.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe"}, {"Substep_Name": "12.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript"}, {"Substep_Name": "12.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions"}, {"Substep_Name": "12.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration"}, {"Substep_Name": "12.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk"}], "Test_Screenshots": []}, {"Test_Num": 12, "Test_Group": "FIN7", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "15.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4"}, {"Substep_Name": "15.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4"}, {"Substep_Name": "15.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "15.A.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "15.A.6", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 12 was blocked when samcat.exe was prevented from running, because it was identified as known malware.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_15.A.6P_2.png", "Carbanak-FIN7_CR_15.A.6P_1.png", "Carbanak-FIN7_CR_15.A.6P.png"], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "samcat.exe opens and reads the SAM via LSASS"}, {"Substep_Name": "15.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the GetIpNetTable() API"}, {"Substep_Name": "15.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)"}], "Test_Screenshots": []}, {"Test_Num": 13, "Test_Group": "FIN7", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity from hotelmanager (10.0.1.5) to itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "16.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4"}, {"Substep_Name": "16.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4"}, {"Substep_Name": "16.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)"}, {"Substep_Name": "16.A.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed"}, {"Substep_Name": "16.A.6", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 13 was blocked when the paexec service was terminated, because of \"Behavioral Execution Prevention\"", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_16.A.6P.png", "Carbanak-FIN7_CR_16.A.6P_4.png", "Carbanak-FIN7_CR_16.A.6P_1.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe"}, {"Substep_Name": "16.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection"}, {"Substep_Name": "16.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "16.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 14, "Test_Group": "FIN7", "Test_Name": "DLL Hijacking", "Test_Description": "Activity on itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "17.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)"}, {"Substep_Name": "17.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library"}, {"Substep_Name": "17.A.4", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 14 was blocked when srrstr.dll failed to execute, because it was identified as unknown malware.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_17.A.4P_3.png", "Carbanak-FIN7_CR_17.A.4P_4.png", "Carbanak-FIN7_CR_17.A.4P.png", "Carbanak-FIN7_CR_17.A.4P_1.png", "Carbanak-FIN7_CR_17.A.4P_2.png"], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll"}, {"Substep_Name": "17.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "17.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 15, "Test_Group": "FIN7", "Test_Name": "Shim Persistence", "Test_Description": "Activity on accounting (10.0.1.7) as user kmitnick", "Substeps": [{"Substep_Name": "19.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "19.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes base64 encoded commands"}, {"Substep_Name": "19.B.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4"}, {"Substep_Name": "19.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4"}, {"Substep_Name": "19.B.5", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 15 was blocked when sdbinst.exe was terminated, because it was deemed malicious", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CR_19.B.5P_3.png", "Carbanak-FIN7_CR_19.B.5P_2.png", "Carbanak-FIN7_CR_19.B.5P_4.png", "Carbanak-FIN7_CR_19.B.5P_1.png", "Carbanak-FIN7_CR_19.B.5P.png"], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "sdbinst.exe installs sdbE376.tmp shim"}, {"Substep_Name": "20.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll"}, {"Substep_Name": "20.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "20.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}]}}]}