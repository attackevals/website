{"Participant_Name": "Palo Alto Networks", "PublicRelease": "\u00a9 2021 MITRE Engenuity. Approved for Public Release. Document number AT0016", "Aggregate_Data": {"Evaluation_Aggregate_Data": {"Adversaries": [{"Adversary_Name": "apt3", "Display_Name": "APT3", "Evaluation_Year": 2018, "Total_Detections": 225, "Analytic_Detections": 125, "Telemetry_Detections": 100, "Analytic_Coverage": "88/136", "Telemetry_Coverage": "100/136", "Visibility": "124/136", "Total_Procedures_Tested": 136}, {"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Total_Detections": 275, "Analytic_Detections": 65, "Telemetry_Detections": 110, "Analytic_Coverage": "101/134", "Telemetry_Coverage": "110/134", "Visibility": "121/134", "Total_Substeps": 134}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Total_Detections": 335, "Analytic_Detections": 181, "Telemetry_Detections": 154, "Analytic_Coverage": "149/174", "Telemetry_Coverage": "154/174", "Visibility": "169/174", "Total_Substeps": 174, "Linux_Participant": true}]}}, "Adversaries": [{"Adversary_Name": "apt3", "Display_Name": "APT3", "Evaluation_Year": 2018, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed that Resume Viewer.exe was executed and running as a process owned by user Debbie.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-1.A.1-1.png"], "Footnotes": []}]}, {"Substep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "Specific Behavior alerts were generated for rundll32. The alerts were tagged with the correct ATT&CK Technique (Rundll32) and were tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-1.A.1-6.png", "PA-1.A.1-4.png", "PA-1.A.1-5.png", "PA-1.A.1-7.png"], "Footnotes": []}, {"Detection_Note": "A General Behavior alert was generated based on rundll32.exe executing update.dat, identified as a suspicious DLL and malware. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-1.A.1-4.png", "PA-1.A.1-5.png", "PA-1.A.1-6.png", "PA-1.A.1-7.png"], "Footnotes": ["Vendor stated the capability would have prevented execution of update.dat."]}, {"Detection_Note": "Telemetry showed rundll32.exe executing update.dat with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-1.A.1-4.png", "PA-1.A.1-5.png", "PA-1.A.1-6.png", "PA-1.A.1-7.png"], "Footnotes": []}]}, {"Substep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for execution of the Windows script engine. The alert was tagged with the correct ATT&CK Technique (Scripting).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-1.A.1-2.png", "PA-1.A.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe launching pdfhelper.cmd.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-1.A.1-2.png", "PA-1.A.1-3.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "The capability enriched a file being created in the Startup folder with the correct ATT&CK Technique (Registry Run Keys / Start Folder). The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted", "Configuration Change"], "Screenshots": ["PA-1.B.1-1.png", "PA-1.B.1-2.png"], "Footnotes": ["The logic to produce the enrichment was configured after the start of the evaluation so it is identified as a config change."]}, {"Detection_Note": "Telemetry showed autoupdate.bat being moved to the user Debbie's Startup folder. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-1.B.1-1.png", "PA-1.B.1-2.png"], "Footnotes": []}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a scripting engine (rundll32.exe) making a network connection over DNS ports. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-1.C.1-2.png", "PA-1.C.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed port 53 command and control traffic. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-1.C.1-2.png", "PA-1.C.1-1.png"], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.004", "Subtechnique_Name": "Application Layer Protocol: DNS"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1132", "Technique_Name": "Data Encoding"}, "Subtechnique": {"Subtechnique_Id": "T1132.001", "Subtechnique_Name": "Data Encoding: Standard Encoding"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}]}, {"Step_Num": 2, "Step_Name": "Initial Discovery", "Substeps": [{"Substep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for a commonly abused process (cmd.exe) spawning out of rundll32.exe. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.A.1-3.png", "PA-2.A.1-1.png", "PA-2.A.1-2.png", "PA-2.A.1-4.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.A.1-2.png", "PA-2.A.1-3.png", "PA-2.A.1-4.png", "PA-2.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of ipconfig.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.A.1-3.png", "PA-2.A.1-2.png", "PA-2.A.1-1.png", "PA-2.A.1-4.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing ipconfig with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.A.1-1.png", "PA-2.A.1-2.png", "PA-2.A.1-4.png", "PA-2.A.1-3.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.A.2-3.png", "PA-2.A.2-2.png", "PA-2.A.2-4.png", "PA-2.A.2-1.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of arp.exe as possible reconnaissance as well as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.A.2-2.png", "PA-2.A.2-1.png", "PA-2.A.2-4.png", "PA-2.A.2-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing arp with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.A.2-1.png", "PA-2.A.2-3.png", "PA-2.A.2-4.png", "PA-2.A.2-2.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.B.1-2.png", "PA-2.B.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.B.1-1.png", "PA-2.B.1-2.png"], "Footnotes": []}]}, {"Substep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.C.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"Substep": "2.C.2", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched tasklist.exe executing with a related ATT&CK Technique (System Information Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.C.2-1.png", "PA-2.C.2-3.png", "PA-2.C.2-2.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of tasklist.exe as the enumeration of running processes via the command line. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.C.2-3.png", "PA-2.C.2-1.png", "PA-2.C.2-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing tasklist with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.C.2-1.png", "PA-2.C.2-3.png", "PA-2.C.2-2.png"], "Footnotes": []}]}, {"Substep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing sc with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.D.1-1.png"], "Footnotes": []}]}, {"Substep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.D.2-3.png", "PA-2.D.2-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.D.2-1.png", "PA-2.D.2-3.png"], "Footnotes": []}]}, {"Substep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.E.1-2.png", "PA-2.E.1-3.png", "PA-2.E.1-1.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of systeminfo.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.E.1-2.png", "PA-2.E.1-3.png", "PA-2.E.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing systeminfo with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.E.1-1.png", "PA-2.E.1-2.png", "PA-2.E.1-3.png"], "Footnotes": []}]}, {"Substep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.E.2-2.png", "PA-2.E.2-1.png", "PA-2.E.2-3.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.E.2-1.png", "PA-2.E.2-2.png", "PA-2.E.2-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.E.2-3.png", "PA-2.E.2-2.png", "PA-2.E.2-1.png"], "Footnotes": []}]}, {"Substep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.F.1-1.png"], "Footnotes": []}]}, {"Substep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.F.2-1.png"], "Footnotes": []}]}, {"Substep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \\\"Domain Admins\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.F.3-1.png", "PA-2.F.3-3.png", "PA-2.F.3-4.png", "PA-2.F.3-2.png", "PA-2.F.3-5.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of net.exe as the execution of an enumeration command as well as the execution of net1.exe as the execution of an enumeration command using net or net1. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.F.3-2.png", "PA-2.F.3-5.png", "PA-2.F.3-1.png", "PA-2.F.3-4.png", "PA-2.F.3-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.F.3-2.png", "PA-2.F.3-3.png", "PA-2.F.3-5.png", "PA-2.F.3-1.png", "PA-2.F.3-4.png"], "Footnotes": []}]}, {"Substep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.G.1-2.png", "PA-2.G.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.G.1-1.png", "PA-2.G.1-2.png"], "Footnotes": []}]}, {"Substep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "The capability enriched net1.exe executing with the correct ATT&CK Technique (Account Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.G.2-3.png", "PA-2.G.2-1.png", "PA-2.G.2-2.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.G.2-2.png", "PA-2.G.2-1.png", "PA-2.G.2-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.G.2-1.png", "PA-2.G.2-3.png", "PA-2.G.2-2.png"], "Footnotes": []}]}, {"Substep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched reg.exe executing with the correct ATT&CK Technique (Query Registry).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-2.H.1-2.png", "PA-2.H.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-2.H.1-2.png", "PA-2.H.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Privilege Escalation", "Substeps": [{"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed a process integrity level change from parent rundll32.exe (medium / 8192) to child powershell.exe (high / 12288), both running as user Debbie.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-3.A.1-3.png"], "Footnotes": []}]}, {"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.001", "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft"}, "Detections": [{"Detection_Note": "Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent logon event with an elevated token and new logon ID, indicating token manipulation.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-3.A.1-1.png", "PA-3.A.1-2.png"], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-3.B.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"Substep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for PowerShell injecting shellcode. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-3.C.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}]}, {"Step_Num": 4, "Step_Name": "Discovery for Lateral Movement", "Substeps": [{"Substep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \\\"Domain Controllers\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-4.A.1-4.png", "PA-4.A.1-1.png", "PA-4.A.1-2.png", "PA-4.A.1-3.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of net.exe as the execution of an enumeration command.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-4.A.1-1.png", "PA-4.A.1-2.png", "PA-4.A.1-3.png", "PA-4.A.1-4.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of net.exe as the execution of an enumeration command using net or net1.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-4.A.1-4.png", "PA-4.A.1-3.png", "PA-4.A.1-2.png", "PA-4.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-4.A.1-1.png", "PA-4.A.1-2.png", "PA-4.A.1-4.png", "PA-4.A.1-3.png"], "Footnotes": []}]}, {"Substep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \\\"Domain Computers\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the execution of net.exe as the execution of an enumeration command using net or net1.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-4.A.2-1.png", "PA-4.A.2-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-4.A.2-1.png", "PA-4.A.2-2.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-4.B.1-2.png", "PA-4.B.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing netsh with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-4.B.1-2.png", "PA-4.B.1-1.png"], "Footnotes": []}]}, {"Substep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-4.C.1-1.png", "PA-4.C.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing netsh with command-line arguments.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-4.C.1-2.png", "PA-4.C.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 5, "Step_Name": "Credential Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a suspicious handle being opened to lsass.exe to dump passwords. The alert was tagged with the correct ATT&CK Technique (Credential Dumping).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-5.A.1-1.png"], "Footnotes": ["Vendor stated the capability would have prevented this behavior."]}]}, {"Substep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a suspicious handle being opened to lsass.exe. The alert was tagged with a related ATT&CK Technique (Credential Dumping).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-5.A.1-1.png"], "Footnotes": ["Vendor stated the capability would have prevented this behavior."]}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for svchost dumping credentials via the Registry. The alert was tagged with the correct ATT&CK Technique (Credential Dumping).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-5.A.1-2.png", "PA-5.A.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a code injection into lsass.exe. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-5.A.1-3.png", "PA-5.A.1-2.png"], "Footnotes": []}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a code injection into lsass.exe. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-5.A.1-2.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.001", "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft"}, "Detections": [{"Detection_Note": "Telemetry showed a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-5.B.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Lateral Movement", "Substeps": [{"Substep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched reg.exe executing with the correct ATT&CK Technique (Query Registry).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-6.A.1-3.png", "PA-6.A.1-1.png", "PA-6.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of reg.exe as querying a remote key. The data was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-6.A.1-3.png", "PA-6.A.1-2.png", "PA-6.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-6.A.1-3.png", "PA-6.A.1-2.png", "PA-6.A.1-1.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed port 80 command and control traffic.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-6.B.1-1.png"], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Telemetry showed port 80 command and control traffic as well as the loading of winhttp.dll, which an analyst could use to determine HTTP was used.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-6.B.1-1.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1026", "Technique_Name": "Multiband Communication"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed command and control traffic for both ports 80 and 53 .", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-6.B.1-1.png"], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for an unexpected process using the RDP port. The data was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-6.C.1-1.png", "PA-6.C.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker). The telemetry was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-6.C.1-1.png", "PA-6.C.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "The capability enriched the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-7.A.1-4.png", "PA-7.A.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed mmc.exe creating a Registry key for user Jesse, indicating that the user is new.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-7.A.1-4.png", "PA-7.A.1-3.png"], "Footnotes": []}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1061", "Technique_Name": "Graphical User Interface"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-7.A.1-2.png", "PA-7.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-7.A.1-2.png", "PA-7.A.1-1.png"], "Footnotes": []}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.001", "Subtechnique_Name": "Account Discovery: Local Account"}, "Detections": [{"Detection_Note": "The capability enriched mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in) as reconnaissance via the MMC utility with local users and groups view.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-7.A.1-5.png", "PA-7.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-7.A.1-1.png", "PA-7.A.1-5.png"], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a script engine creating/writing a DLL in the system32 folder. The alert was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-7.B.1-1.png", "PA-7.B.1-3.png", "PA-7.B.1-2.png"], "Footnotes": []}, {"Detection_Note": "A Specific Behavior alert was generated for a Windows scripting engine creating an executable on disk.", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-7.B.1-3.png", "PA-7.B.1-1.png", "PA-7.B.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file create event for updater.dll.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-7.B.1-3.png", "PA-7.B.1-2.png", "PA-7.B.1-1.png"], "Footnotes": []}]}, {"Substep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a commonly abused host process scheduling a task. The alert was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-7.C.1-3.png", "PA-7.C.1-1.png", "PA-7.C.1-2.png", "PA-7.C.1-4.png"], "Footnotes": ["Vendor stated the capability would have prevented the creation of the scheduled task."]}, {"Detection_Note": "A Specific Behavior alert was generated for the creation of a new scheduled task. The alert was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-7.C.1-2.png", "PA-7.C.1-3.png", "PA-7.C.1-1.png", "PA-7.C.1-4.png"], "Footnotes": ["Vendor stated the capability would have prevented the creation of the scheduled task."]}, {"Detection_Note": "The capability enriched schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-7.C.1-2.png", "PA-7.C.1-4.png", "PA-7.C.1-3.png", "PA-7.C.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed schtasks.exe creating the Resume Viewer Update Checker scheduled task as reboot persistence and as SYSTEM. The telemetry was tainted by a parent process injection alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-7.C.1-2.png", "PA-7.C.1-1.png", "PA-7.C.1-4.png", "PA-7.C.1-3.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Collection", "Substeps": [{"Substep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \\\"\\\\conficker\\wormshare\\\"' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for a commonly abused process (cmd.exe) spawning out of rundll32.exe. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-8.A.1-1.png", "PA-8.A.1-2.png", "PA-8.A.1-4.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched cmd.exe executing dir with command-line arguments as the execution of the dir command on a network location. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-8.A.1-4.png", "PA-8.A.1-2.png", "PA-8.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing dir with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-8.A.1-4.png", "PA-8.A.1-2.png", "PA-8.A.1-1.png"], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \\\"C:\\Users\\debbie\\\"' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-8.A.2-2.png", "PA-8.A.2-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing tree with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-8.A.2-2.png", "PA-8.A.2-1.png"], "Footnotes": []}]}, {"Substep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-8.B.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "The capability enriched the execution of a specific API call as keylogging and suspicious activity. Though it does not count as a detection, the capability also showed code and hook injections into explorer.exe.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-8.C.1-1.png", "PA-8.C.1-2.png", "PA-8.C.1-3.png"], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1010", "Technique_Name": "Application Window Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the execution of a specific API call as information gathering using screen capture and suspicious activity.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-8.D.1-1.png"], "Footnotes": []}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched cmd.exe injecting into explorer.exe as code injection via CreateThread.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-8.D.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1039", "Technique_Name": "Data from Network Shared Drive"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a file read event for the .vsdx file from the network shared drive.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-9.B.1-1.png"], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Criteria": "", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["PA-9.B.1-2.png"], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}]}, {"Step_Num": 10, "Step_Name": "Execution of Persistence", "Substeps": [{"Substep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-10.A.1-1.png"], "Footnotes": []}]}, {"Substep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "Telemetry showed the execution sequence for rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\\"-k netsvcs -p -s Schedule\\\".", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-10.A.2-3.png", "PA-10.A.2-4.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.003", "Subtechnique_Name": "Valid Accounts: Local Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed userinit.exe as well as explorer.exe spawn as the user Jesse.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-10.B.1-1.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "The capability enriched the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-10.B.1-2.png", "PA-10.B.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-10.B.1-3.png", "PA-10.B.1-2.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for PowerShell execution. The alert was tagged with a related Technique (PowerShell)", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-11.A.1-1.png", "PA-11.A.1-2.png", "PA-11.A.1-3.png", "PA-11.A.1-6.png", "PA-11.A.1-7.png", "PA-11.A.1-8.png", "PA-11.A.1-4.png", "PA-11.A.1-5.png"], "Footnotes": []}, {"Detection_Note": "A Specific Behavior alert was generated for PowerShell execution with base64 encoded commands.", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-11.A.1-1.png", "PA-11.A.1-2.png", "PA-11.A.1-5.png", "PA-11.A.1-8.png", "PA-11.A.1-4.png", "PA-11.A.1-6.png", "PA-11.A.1-7.png", "PA-11.A.1-3.png"], "Footnotes": []}, {"Detection_Note": "A Specific Behavior alert was generated for suspicious PowerShell activity", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-11.A.1-8.png", "PA-11.A.1-3.png", "PA-11.A.1-6.png", "PA-11.A.1-1.png", "PA-11.A.1-2.png", "PA-11.A.1-5.png", "PA-11.A.1-4.png", "PA-11.A.1-7.png"], "Footnotes": []}, {"Detection_Note": "A Specific Behavior alert was generated for the execution of the windows script engine The alert was tagged with the correct ATT&CK Technique (Scripting).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-11.A.1-4.png", "PA-11.A.1-2.png", "PA-11.A.1-1.png", "PA-11.A.1-5.png", "PA-11.A.1-8.png", "PA-11.A.1-7.png", "PA-11.A.1-4.png", "PA-11.A.1-1.png", "PA-11.A.1-5.png", "PA-11.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "An Indicator of Compromise alert was generated identifying PowerShell Empire.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-11.A.1-6.png", "PA-11.A.1-7.png", "PA-11.A.1-8.png", "PA-11.A.1-4.png", "PA-11.A.1-5.png", "PA-11.A.1-1.png", "PA-11.A.1-2.png", "PA-11.A.1-3.png"], "Footnotes": []}, {"Detection_Note": "Indicator of Compromise alerts were generated for suspicious PowerShell strings.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-11.A.1-2.png", "PA-11.A.1-1.png", "PA-11.A.1-3.png", "PA-11.A.1-6.png", "PA-11.A.1-1.png", "PA-11.A.1-8.png", "PA-11.A.1-4.png", "PA-11.A.1-5.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed wscript.exe executing autoupdate.vbs as well as the resulting powershell.exe execution. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-11.A.1-8.png", "PA-11.A.1-4.png", "PA-11.A.1-3.png", "PA-11.A.1-2.png", "PA-11.A.1-1.png", "PA-11.A.1-5.png", "PA-11.A.1-7.png", "PA-11.A.1-6.png"], "Footnotes": []}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "General Behavior alerts were generated for PowerShell making network connections to the internet as well as Wscript connecting to an external network. The alerts were tainted by a parent alert on wscript.exe.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-11.B.1-1.png", "PA-11.A.1-3.png", "PA-11.B.1-2.png"], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}, {"Detection_Note": "The capability enriched the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port). The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-11.B.1-2.png", "PA-11.B.1-1.png", "PA-11.A.1-3.png"], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}, {"Detection_Note": "Telemetry showed port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-11.A.1-3.png", "PA-11.B.1-1.png", "PA-11.B.1-2.png"], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}, {"Substep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor stated that more information would be available if their firewall appliance was installed and activated."]}]}]}, {"Step_Num": 12, "Step_Name": "Initial Discovery", "Substeps": [{"Substep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.A.1-1.png", "PA-12.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.A.1-2.png", "PA-12.A.1-1.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.A.2-1.png", "PA-12.A.2-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.A.2-1.png", "PA-12.A.2-2.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.B.1-1.png"], "Footnotes": []}]}, {"Substep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched qprocess.exe executing with a related ATT&CK Technique (System Service Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.C.1-1.png", "PA-12.C.1-2.png", "PA-12.C.1-3.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of qprocess.exe as the enumeration of running processes via the command line. The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.C.1-2.png", "PA-12.C.1-3.png", "PA-12.C.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.C.1-2.png", "PA-12.C.1-3.png", "PA-12.C.1-1.png"], "Footnotes": []}]}, {"Substep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for net.exe executing as an enumeration command called by a commonly abused causality group owner (CGO, wscipt.exe). The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.D.1-1.png", "PA-12.D.1-2.png", "PA-12.D.1-3.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched net.exe executing as the execution of an enumeration command. The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.D.1-2.png", "PA-12.D.1-1.png", "PA-12.D.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.D.1-3.png", "PA-12.D.1-1.png", "PA-12.D.1-2.png"], "Footnotes": []}]}, {"Substep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for PowerShell execution with base64 encoded commands. The alert was tainted by a parent alert on wscript.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.E.1-1.png", "PA-12.E.1-3.png", "PA-12.E.1-2.png"], "Footnotes": []}, {"Detection_Note": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire WinEnum.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-12.E.1-1.png", "PA-12.E.1-3.png", "PA-12.E.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.E.1-3.png", "PA-12.E.1-2.png", "PA-12.E.1-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire UserInfo.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-12.E.1.1-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1201", "Technique_Name": "Password Policy Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.E.1.4-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.E.1.4-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Clipboard Data).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.E.1.5-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire SysImfo.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-12.E.1.6-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the enumeration of system information via a Registry query as suspicious. The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.E.1.6-1.png", "PA-12.E.1.7-1.png"], "Footnotes": []}, {"Detection_Note": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire SysImfo.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-12.E.1.7-1.png", "PA-12.E.1.6-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.E.1.8-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.E.1.9-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.E.1.9-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Telemetry showed an event log for the WMI query of the system AV products.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-12.E.1.10-2.png"], "Footnotes": []}]}, {"Substep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Security Software Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.E.1.10-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire NetInfo.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-12.E.1.11-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Network Connections Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.E.1.12-1.png"], "Footnotes": []}]}, {"Substep": "12.F.1", "Procedure": "Empire: 'net group \\\"Domain Admins\\\" -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.F.1-1.png", "PA-12.F.1-2.png", "PA-12.F.1-4.png", "PA-12.F.1-3.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of net.exe and net1.exe as an enumeration command. The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.F.1-2.png", "PA-12.F.1-3.png", "PA-12.F.1-1.png", "PA-12.F.1-4.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.F.1-4.png", "PA-12.F.1-3.png", "PA-12.F.1-2.png", "PA-12.F.1-4.png", "PA-12.F.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.F.1-4.png", "PA-12.F.1-2.png", "PA-12.F.1-4.png", "PA-12.F.1-1.png", "PA-12.F.1-3.png"], "Footnotes": []}]}, {"Substep": "12.F.2", "Procedure": "Empire: 'Net Localgroup Administrators' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.F.2-1.png", "PA-12.F.2-2.png", "PA-12.F.2-3.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.F.2-1.png", "PA-12.F.2-3.png", "PA-12.F.2-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.F.2-2.png", "PA-12.F.2-3.png", "PA-12.F.2-1.png"], "Footnotes": []}]}, {"Substep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.001", "Subtechnique_Name": "Account Discovery: Local Account"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.G.1-1.png", "PA-12.G.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.G.1-2.png", "PA-12.G.1-1.png"], "Footnotes": []}]}, {"Substep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-12.G.2-2.png", "PA-12.G.2-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-12.G.2-2.png", "PA-12.G.2-1.png"], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Discovery for Lateral Movement", "Substeps": [{"Substep": "13.A.1", "Procedure": "Empire: 'net group \\\"Domain Computers\\\" -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched the execution of net.exe and net1.exe as an enumeration command. The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-13.A.1-1.png", "PA-13.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-13.A.1-1.png", "PA-13.A.1-2.png"], "Footnotes": []}]}, {"Substep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-13.B.1-1.png"], "Footnotes": []}]}, {"Substep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing netstat with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-13.B.2-1.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Empire:'reg query' via PowerShell to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-13.B.3-1.png", "PA-13.B.3-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-13.B.3-2.png", "PA-13.B.3-1.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Privilege Escalation", "Substeps": [{"Substep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "An Indicator of Compromise alert was generated identifying a PowerShell Empire script performing the bypass UAC attack.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-14.A.1-3.png", "PA-14.A.1-2.png", "PA-14.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a process integrity level change from parent powershell.exe (medium / 8192) to child powershell.exe (high / 12288).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-14.A.1-1.png", "PA-14.A.1-3.png", "PA-14.A.1-2.png"], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["PA-14.A.1-5.png"], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["PA-14.A.1-5.png"], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed an outgoing network connection to www.freegoogleadsenseinfo.com (C2 domain) over port 8080.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-14.A.1-4.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Credential Access", "Substeps": [{"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "The capability enriched the execution of a specific API call as keylogging and suspicious activity.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-15.A.1-1.png", "PA-15.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "An Indicator of Compromise alert was generated identifying a PowerShell Empire script logging keys pressed, time, and the active window.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-15.A.1-2.png", "PA-15.A.1-1.png"], "Footnotes": []}]}, {"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1010", "Technique_Name": "Application Window Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An Indicator of Compromise alert was generated identifying a PowerShell Empire script logging keys pressed, time, and the active window.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-15.A.1-3.png", "PA-15.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the decoded PowerShell script, which includes the API call GetForegroundWindow to enumerate the active window.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-15.A.1-2.png", "PA-15.A.1-3.png"], "Footnotes": []}]}, {"Substep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "Telemetry showed a file read event for IT_tasks.txt.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-15.B.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Lateral Movement", "Substeps": [{"Substep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of usersKmitnick, Bob, and Frieda", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for sensitive administrative shares mapping with unexpected parent.", "Detection_Type": "General Behavior", "Modifiers": [], "Screenshots": ["PA-16.A.1-1.png", "PA-16.A.1-4.png", "PA-16.A.1-3.png", "PA-16.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.A.1-1.png", "PA-16.A.1-4.png", "PA-16.A.1-3.png", "PA-16.A.1-2.png"], "Footnotes": []}]}, {"Substep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a net.exe logon attempt to ADMIN$. The alert was tagged with the correct ATT&CK Technique (Windows Admin Shares).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["PA-16.A.1-1.png", "PA-16.A.1-2.png", "PA-16.A.1-3.png", "PA-16.A.1-5.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.A.1-2.png", "PA-16.A.1-3.png", "PA-16.A.1-1.png", "PA-16.A.1-5.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.003", "Subtechnique_Name": "Valid Accounts: Local Accounts"}, "Detections": [{"Detection_Note": "The capability enriched an lsass.exe event with the correct ATT&CK Technique (Valid Accounts).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-16.B.1-1.png", "PA-16.B.1-2.png", "PA-16.B.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick followed by an event for the credentials being validated by the DC. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.B.1-2.png", "PA-16.B.1-1.png", "PA-16.B.1-3.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local Kmitnick. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.B.1-1.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local user Kmitnick followed by an event for the credentials being validated by the DC. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.B.1-2.png", "PA-16.B.1-1.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.005", "Subtechnique_Name": "Indicator Removal on Host: Network Share Connection Removal"}, "Detections": [{"Detection_Note": "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-16.C.1-2.png", "PA-16.C.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.C.1-2.png", "PA-16.C.1-1.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "Telemetry showed a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.D.1-1.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick followed by a event for a successful login. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.D.1-2.png", "PA-16.D.1-1.png"], "Footnotes": []}]}, {"Substep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file create and write events for autoupdate.vbs.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-16.E.1-1.png"], "Footnotes": []}]}, {"Substep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-16.F.1-1.png", "PA-16.F.1-3.png", "PA-16.F.1-2.png"], "Footnotes": []}, {"Detection_Note": "An Indicator of Compromise Alert was generated identify PowerShell Empire using the Runas functionality.", "Detection_Type": "Indicator of Compromise", "Modifiers": [], "Screenshots": ["PA-16.F.1-1.png", "PA-16.F.1-3.png", "PA-16.F.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing autoupdate.vbs. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.F.1-2.png", "PA-16.F.1-3.png", "PA-16.F.1-1.png"], "Footnotes": []}]}, {"Substep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a script being modified/moved to a remote location. The alert was tainted by a parent alert on wscript.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.G.1-2.png", "PA-16.G.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed file create and write events for update.vbs.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-16.G.1-1.png", "PA-16.G.1-2.png"], "Footnotes": []}]}, {"Substep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for the sc utility be used to perform actions of remote services. The alert was tainted by a parent alert on wscript.exe.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.H.1-3.png", "PA-16.H.1-2.png", "PA-16.H.1-1.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-16.H.1-2.png", "PA-16.H.1-3.png", "PA-16.H.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing sc with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.H.1-3.png", "PA-16.H.1-1.png", "PA-16.H.1-2.png"], "Footnotes": []}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a new service created via the command line. The alert was tainted by a parent alert on wscript.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.I.1-2.png", "PA-16.I.1-4.png", "PA-16.I.1-3.png", "PA-16.I.1-1.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched sc.exe executing with the correct ATT&CK Technique (New Service).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-16.I.1-2.png", "PA-16.I.1-1.png", "PA-16.I.1-4.png", "PA-16.I.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed execution of sc.exe with command-line arguments to create a new AdobeUpdater service containing a binPath pointed to cmd.exe with arguments to execute update.vbs. Telemetry also showed the creation of Registry keys associated with this new service. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.I.1-3.png", "PA-16.I.1-4.png", "PA-16.I.1-3.png", "PA-16.I.1-1.png", "PA-16.I.1-2.png"], "Footnotes": []}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.004", "Subtechnique_Name": "Masquerading: Masquerade Task or Service"}, "Detections": [{"Detection_Note": "Telemetry showed execution of sc.exe with command-line arguments to set the service description. An analyst could use this information to determine it is not a legitimate service. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.I.1-5.png"], "Footnotes": []}]}, {"Substep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe executing sc.exe as enumeration of services via the command line. The data was tainted by a parent alert on wscript.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.J.1-2.png", "PA-16.J.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing sc.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.J.1-1.png", "PA-16.J.1-2.png"], "Footnotes": []}]}, {"Substep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a file read event for update.vbs. The telemetry was tainted by a parent alert on wscript.exe", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.K.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"Substep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "The capability enriched sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-16.L.1-1.png", "PA-16.L.1-2.png", "PA-16.L.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing sc with command-line arguments. As part of the service, telemetry also showed cmd.exe executing update.vbs on 10.0.0.4 (Creeper). The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-16.L.1-1.png", "PA-16.L.1-3.png", "PA-16.L.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Persistence", "Substeps": [{"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched reg.exe executing with command-line arguments as the terminal server key queried by the reg utility. The data was tainted by a parent alert on cmd.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-17.A.1-2.png", "PA-17.A.1-3.png", "PA-17.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-17.A.1-1.png", "PA-17.A.1-2.png", "PA-17.A.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-17.A.1-1.png", "PA-17.A.1-2.png", "PA-17.A.1-3.png"], "Footnotes": []}]}, {"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched reg.exe executing with command-line arguments as the terminal server key queried by the reg utility. The data was tainted by a parent alert on cmd.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-17.A.1-3.png", "PA-17.A.1-2.png", "PA-17.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-17.A.1-3.png", "PA-17.A.1-1.png", "PA-17.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing reg with command-line arguments to check if terminal services were enabled. The telemetry was tainted by a parent alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-17.A.1-2.png", "PA-17.A.1-1.png", "PA-17.A.1-3.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1222", "Technique_Name": "File and Directory Permissions Modification"}, "Subtechnique": {"Subtechnique_Id": "T1222.001", "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"}, "Detections": [{"Detection_Note": "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-17.B.1-1.png", "PA-17.B.1-2.png", "PA-17.B.1-3.png"], "Footnotes": []}, {"Detection_Note": "The capability enriched takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder. The data was tainted by a parent alert on cmd.exe.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["PA-17.B.1-2.png", "PA-17.B.1-3.png", "PA-17.B.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing takeown with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-17.B.1-3.png", "PA-17.B.1-1.png", "PA-17.B.1-2.png"], "Footnotes": []}]}, {"Substep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1222", "Technique_Name": "File and Directory Permissions Modification"}, "Subtechnique": {"Subtechnique_Id": "T1222.001", "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"}, "Detections": [{"Detection_Note": "The capability enriched icalcs.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-17.B.2-1.png", "PA-17.B.2-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing icalcs with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-17.B.2-1.png", "PA-17.B.2-2.png"], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.008", "Subtechnique_Name": "Event Triggered Execution: Accessibility Features"}, "Detections": [{"Detection_Note": "Telemetry showed file write events overwriting magnify.exe in the system directory as well as the change in the hash of the file. The telemetry was tainted by a parent alert on cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-17.C.1-2.png", "PA-17.C.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}]}, {"Step_Num": 18, "Step_Name": "Collection", "Substeps": [{"Substep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed an event with the execution of the Get-ChildItem command. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-18.A.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.002", "Subtechnique_Name": "Data Staged: Remote Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed file read and write events for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) to the Recycle Bin. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-18.B.1-1.png"], "Footnotes": []}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1039", "Technique_Name": "Data from Network Shared Drive"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a script engine reading files from network locations. The alert was tainted by a parent alert on wscript.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-18.B.1-2.png", "PA-18.B.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}, {"Detection_Note": "Telemetry showed a file read event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker). The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-18.B.1-2.png", "PA-18.B.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 19, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the MD5 and SHA256 hash values of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-19.A.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"Substep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for executables created to disk by the Windows scripting engine. The alert was tainted by a parent alert on wscript.exe.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-19.A.1-1.png", "PA-19.A.1-2.png", "PA-19.A.1-3.png"], "Footnotes": []}, {"Detection_Note": "A General Behavior alert was generated for PowerShell dropping an executable file to disk. The alert was tainted by a parent alert on wscript.exe.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted"], "Screenshots": ["PA-19.A.1-2.png", "PA-19.A.1-3.png", "PA-19.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file create and write events for recycler.exe. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-19.A.1-3.png", "PA-19.A.1-1.png", "PA-19.A.1-2.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent alert on wscript.exe", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-19.B.1-1.png", "PA-19.B.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent alert on wscript.exe", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-19.B.1-2.png", "PA-19.B.1-1.png"], "Footnotes": []}]}, {"Substep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Criteria": "", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched ftp.exe as the execution of a CLI file transfer/copy utility. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"Detection_Note": "Telemetry showed the execution of ftp.exe and command-line arguments as well as a an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "19.D.1", "Procedure": "Empire: 'del C:\\\\\"$\\\"Recycle.bin\\old.rar'", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed the file delete event for old.rar. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-19.D.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}, {"Substep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed the file delete event for recycler.exe. The telemetry was tainted by a parent alert on wscript.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["PA-19.D.1-1.png"], "Footnotes": ["The process tree showing taintedness is visible within the same UI but did not fit within the current frame."]}]}]}, {"Step_Num": 20, "Step_Name": "Execution of Persistence", "Substeps": [{"Substep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.008", "Subtechnique_Name": "Event Triggered Execution: Accessibility Features"}, "Detections": [{"Detection_Note": "Telemetry showed magnify.exe executing from utilman.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-20.A.1-1.png"], "Footnotes": []}]}, {"Substep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed an inbound connection to Creeper (10.0.0.4) on port 3389.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-20.A.1-2.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched whoami.exe executing as an enumeration command.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["PA-20.B.1-1.png", "PA-20.B.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed magnify.exe executing whoami.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["PA-20.B.1-2.png", "PA-20.B.1-1.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of the user Pam executing the malicious document rcs.3aka3.doc file.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13200.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-2605.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (medium severity) was generated for rcs.3aka3.doc being tagged as malware.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-2611.png"], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}]}, {"Substep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.002", "Subtechnique_Name": "Masquerading: Right-to-Left Override"}, "Detections": [{"Detection_Note": "An MSSP detection for Masquerading \"(T1036)\" occurred containing evidence of of the RLO character to obfuscate payload file name.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13200.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (low severity) was generated for rcs.3aka3.doc, identified as a screensaver process, executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-2649.png"], "Footnotes": []}]}, {"Substep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for an Uncommonly used port \"(T1065)\" occurred containing evidence of rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13200.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-2651.png"], "Footnotes": []}]}, {"Substep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.001", "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-2656.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique alert detection was generated for a command line interface spawned from a process identified as malware with an active network connection.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-14274.png", "Palo Alto Networks-APT29-14271.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Command Line Interfaces \"(T1059)\" occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13201.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2666.png"], "Footnotes": []}]}, {"Substep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "An MSSP detection for Powershell \"(T1086)\" occurred containing evidence of powershell.exe spawning from cmd.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13201.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2666.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection was generated for PowerShell executing suspicious File and Directory Discovery commands. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-14307.png", "Palo Alto Networks-APT29-14305.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for File and Directory Discovery \"(T1083)\" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13202.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13640.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13640.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Automated Collection \"(T1119)\" occurred containing evidence that a discovery script was using Get-Childitem to search the filesystem to specific file patterns.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13202.png"], "Footnotes": []}]}, {"Substep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2679.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Data From Local System \"(T1005)\" occurred containing evidence that a discovery script was executed file read operations on local folder C:\\Users\\Pam.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13202.png"], "Footnotes": []}]}, {"Substep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing Compress-Archive", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13640.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Data Compressed \"(T1002)\" occurred containing evidence that the files \"C:\\Users\\pam\\Links\\Downloads.lnk, C:\\Users\\pam\\Links\\Desktop.lnk, C:\\Users\\pam\\Favorites\\Bing.url, and C:\\Users\\pam\\Desktop\\Microsoft Edge.lnk\" were compressed into a zip file draft.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13202.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Scripting engine creates compressed file under suspicious folder\" was generated due identifying Draft.zip as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2674.png"], "Footnotes": []}]}, {"Substep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "An MSSP detection for Data Staged \"(T1074)\" occurred containing evidence that there was a compressed zip file created named Draft.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13202.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2678.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2699.png", "Palo Alto Networks-APT29-2651.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Exfiltration Over Command and Control Channel \"(T1041)\" occurred containing evidence that \"After the zip file is created, it's read by cod.3aka3.scr... [and] the timeline view shows a C2 connection from nashua to 192.168.0.5, in which cod.3aka3.scr sent 319,936 Bytes.\"", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13203.png"], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Deploy Stealth Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-17855.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Remote File Copy \"(T1105)\" occurred containing evidence that cod.3aka3.scr has downloaded and wrote a file named monkey.png to C:\\Users\\pam\\Downloads.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13195.png"], "Footnotes": []}]}, {"Substep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within monkey.png", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.003", "Subtechnique_Name": "Obfuscated Files or Information: Steganography"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13195.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2757.png", "Palo Alto Networks-APT29-2719.png"], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "A General alert detection was generated identifying the Registry modification as a malware behavior threat. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-13643.png", "Palo Alto Networks-APT29-13642.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of addition of DelegateExecute subkey.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13196.png", "Palo Alto Networks-APT29-13197.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2767.png"], "Footnotes": []}]}, {"Substep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "An MSSP detection for \"UAC bypass (T1088)\" occurred for a new high hntegrity PowerShell callback spawning from control.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13197.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) was generated for for \"Bypass User Account Control VIA registry hijack T1088\" for control.exe creating a high integrity powershell.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-2741.png", "Palo Alto Networks-APT29-2744.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed control.exe creating a high integrity powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"Substep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2757.png", "Palo Alto Networks-APT29-2745.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Commonly Used Port was\ngenerated containing evidence monkey.png performed C&C over port 443 to IP address 192.168.0.5.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13197.png"], "Footnotes": []}]}, {"Substep": "3.B.4", "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2768.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Modify Registry \"(T1070)\" occurred for the Deletion of the registry value.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13198.png"], "Footnotes": []}]}]}, {"Step_Num": 4, "Step_Name": "Clean Up and Reconnaissance", "Substeps": [{"Substep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection was generated for the creation of a file identified as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-14323.png", "Palo Alto Networks-APT29-14322.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2784.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for Remote File Copy \"(T1105)\" was received. The alert stated the privileged Powershell.exe created a zip file named SysInternalsSuite.zip in the Downloads folder.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13205.png"], "Footnotes": []}]}, {"Substep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of a new interactive session of PowerShell being created.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13208.png", "Palo Alto Networks-APT29-13205.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2786.png"], "Footnotes": []}]}, {"Substep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and the corresponding file writes. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2789.png", "Palo Alto Networks-APT29-13644.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13208.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13209.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2833.png", "Palo Alto Networks-APT29-2832.png"], "Footnotes": []}]}, {"Substep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2835.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of sdelete64.exe deleting ?cod.3aka.scr.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13211.png"], "Footnotes": []}]}, {"Substep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2831.png", "Palo Alto Networks-APT29-2830.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13211.png"], "Footnotes": []}]}, {"Substep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2829.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13211.png"], "Footnotes": []}]}, {"Substep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing $env:TEMP", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13646.png", "Palo Alto Networks-APT29-13645.png"], "Footnotes": []}]}, {"Substep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13645.png", "Palo Alto Networks-APT29-13646.png"], "Footnotes": []}]}, {"Substep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13646.png", "Palo Alto Networks-APT29-13645.png"], "Footnotes": []}]}, {"Substep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13646.png", "Palo Alto Networks-APT29-13645.png"], "Footnotes": []}]}, {"Substep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-13645.png", "Palo Alto Networks-APT29-13646.png"], "Footnotes": []}]}, {"Substep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2870.png", "Palo Alto Networks-APT29-2838.png"], "Footnotes": []}, {"Detection_Note": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13212.png"], "Footnotes": []}]}, {"Substep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "A Technique alert detection (high severity) was generated for PowerShell performing suspicious Security Software Discovery.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-13649.png", "Palo Alto Networks-APT29-13648.png"], "Footnotes": []}, {"Detection_Note": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13212.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing Get-WmiObject... -Class AntiVirusProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2858.png", "Palo Alto Networks-APT29-2868.png"], "Footnotes": []}]}, {"Substep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13212.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing Get-WmiObject... -Class FireWallProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2858.png", "Palo Alto Networks-APT29-2869.png"], "Footnotes": []}]}, {"Substep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe executing the NetUserGetGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13651.png", "Palo Alto Networks-APT29-13650.png"], "Footnotes": []}, {"Detection_Note": "A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13212.png"], "Footnotes": []}]}, {"Substep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13651.png", "Palo Alto Networks-APT29-13650.png"], "Footnotes": []}]}, {"Substep": "4.C.11", "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API", "Criteria": "powershell.exe executing the NetUserGetLocalGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13652.png", "Palo Alto Networks-APT29-13651.png"], "Footnotes": []}]}, {"Substep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed Netapi32.dll loaded into powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13652.png", "Palo Alto Networks-APT29-13651.png"], "Footnotes": []}]}]}, {"Step_Num": 5, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell created the new service javamtsup. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13653.png", "Palo Alto Networks-APT29-13666.png", "Palo Alto Networks-APT29-13656.png", "Palo Alto Networks-APT29-13655.png", "Palo Alto Networks-APT29-13654.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13199.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"registry run key or file in start up folder created - T1060\" was generated due to powershell.exe creating the hostui.lnk file. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-2935.png", "Palo Alto Networks-APT29-2924.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a file create event for hostui.lnk in the Startup folder. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2933.png"], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Credential Access", "Substeps": [{"Substep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "An MSSP detection occurred for accesschk.exe reading the Chrome database file for credentials.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13214.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for \"Browser login data access by non-browser process\" was generated when accesschk.exe accessed the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-2943.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2942.png"], "Footnotes": []}]}, {"Substep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13214.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Windows process masquerading by an unsigned process\" was generated when accesschk.exe was identified as an unsigned executable and the hash did not match the valid accesschk.exe hash. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-2944.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2942.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.004", "Subtechnique_Name": "Unsecured Credentials: Private Keys"}, "Detections": [{"Detection_Note": "An MSSP detection was generated for the creation of the $RandomFileName.pfx file.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13215.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"New certificate file has been created\" was generated for the file creation event of the lotu40lg.b0j.pfx file.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-2954.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2979.png"], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "An MSSP detection for \"Mimikatz\" was received that described PowerShell dumping credentials from LSASS process memory.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13216.png", "Palo Alto Networks-APT29-13214.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Credentials in Registry\" was generated due to a group owner child process querying the User SAM registry keys. Detection incurred a delay based on additional data processing to generate the behavioral threat.", "Detection_Type": "Technique", "Modifiers": ["Delayed (Processing)", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-2959.png", "Palo Alto Networks-APT29-2958.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of powershell.exe executing performing a Screen Capture.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13217.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A Technique alert detection called \"Screen Capture - T1056\" was generated for powershell.exe making the GdiBitBlt API call.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-2969.png", "Palo Alto Networks-APT29-2967.png"], "Footnotes": []}]}, {"Substep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13217.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing Get-Clipboard.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A Technique alert detection called \"clipboard data accessed\" was generated due to the use of getclipboarddata API.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-2965.png", "Palo Alto Networks-APT29-2964.png"], "Footnotes": []}]}, {"Substep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of key logging.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13218.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"Input Capture\" was generated due to powershell.exe making the GetAsyncKeyState API call.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-2963.png", "Palo Alto Networks-APT29-2961.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"Substep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of  powershell.exe accessing files from C:\\Users\\pam\\Downloads.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13219.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2983.png"], "Footnotes": []}]}, {"Substep": "7.B.2", "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13219.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Scripting engine creates compressed file under suspicious location\" was generated for the file creation event of a .7z file in %APPDATA%. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-2976.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2975.png"], "Footnotes": []}]}, {"Substep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1048.003", "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-2975.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network via WebDav to 192.168.0.4.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13219.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) called \"File being written to remote path\" was generated for the file OfficeSupplies.7z being written a WebDav share at 192.168.0.4.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-2977.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Expand Access", "Substeps": [{"Substep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3000.png"], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13221.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from a temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3001.png"], "Footnotes": []}]}, {"Substep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-Process.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3007.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred for powershell.exe executing Get-Process.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13221.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Process Discovery with PowerShell\" was generated due to powershell.exe executing Get-Process.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3004.png", "Palo Alto Networks-APT29-3003.png", "Palo Alto Networks-APT29-3005.png"], "Footnotes": []}]}, {"Substep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"Executable copied to remote host via $ share\" was generated for python.exe being copied from Nashua to Scranton. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-3008.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13222.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Remote File Copy\" was generated for python.exe being copied Scranton (10.0.1.4).", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3010.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file create event of python.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.002", "Subtechnique_Name": "Obfuscated Files or Information: Software Packing"}, "Detections": [{"Detection_Note": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13223.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for \"Software Packing - T1045\" was generated for the file creation event for python.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3013.png", "Palo Alto Networks-APT29-3014.png", "Palo Alto Networks-APT29-3012.png"], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam", "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13225.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3022.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection was generated for an executable being copied to a remote host via a share. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-3016.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for network share access was generated due to remote access to a Windows admin share.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3018.png", "Palo Alto Networks-APT29-3019.png"], "Footnotes": []}]}, {"Substep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13225.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"Service Execution Start service T1050\" was generated due to psexec.exe spawning python.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3023.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (low severity) was generated due to an unsigned process running from a temporary directory.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3025.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed python.exe spawned by PSEXESVC.exe and originated from a RPC call originating on the remote host Nashua (10.0.1.6).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3025.png", "Palo Alto Networks-APT29-13658.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for PSEXESVC.exe being copied to a remote host. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3016.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) for \"Lateral Movement\" was generated due to PSEXE64.exe execution with plain-text credentials from Nashua as the user Pam. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3016.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Clean Up, Collection, and Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file rar.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a file write event for python.exe creating rar.exe from a named pipe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13661.png", "Palo Alto Networks-APT29-13659.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for python.exe writing rar.exe to C:\\Windows\\Temp. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3032.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred for python.exe creating rar.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13226.png"], "Footnotes": []}]}, {"Substep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed File Write/Create events for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3036.png"], "Footnotes": []}, {"Detection_Note": "A MSSP detection occurred for python.exe creating sdelete64.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13226.png"], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from python.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3041.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of python spawning powershell.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13228.png"], "Footnotes": []}]}, {"Substep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3042.png"], "Footnotes": []}, {"Detection_Note": "A MSSP detection occurred for PowerShell looking for certain files in a directory.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13228.png"], "Footnotes": []}]}, {"Substep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for Automated Collection \"(T1119)\" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13228.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3041.png"], "Footnotes": []}]}, {"Substep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3045.png"], "Footnotes": []}, {"Detection_Note": "A MSSP detection occurred for powershell.exe reading files in C:\\Users\\Pam.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13228.png"], "Footnotes": []}]}, {"Substep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "A Tactic alert detection called \"Collection\" was generated due to working.zip file creation in %APPDATA%\\roaming folder. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3049.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of the creation of working.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13228.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file create of working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3052.png", "Palo Alto Networks-APT29-13663.png"], "Footnotes": []}]}, {"Substep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3050.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13229.png"], "Footnotes": []}]}, {"Substep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3050.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) for \"Scripting engine creates compressed file under suspicious folder\" was generated when rar.exe was used to create an compressed zip archive in %APPDATA%. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-3051.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13229.png"], "Footnotes": []}]}, {"Substep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe reading the file working.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3058.png", "Palo Alto Networks-APT29-3057.png"], "Footnotes": []}]}, {"Substep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3066.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of the deletion of Rar.exe by SDelete64.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13230.png"], "Footnotes": []}]}, {"Substep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique alert detection called \"file deletion T1107\"  was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3086.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed file delete event for sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3088.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of the deletion of Desktop\\working.zip by SDelete64.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13230.png"], "Footnotes": []}]}, {"Substep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3085.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of the deletion of roaming\\working.zip by SDelete64.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13230.png"], "Footnotes": []}]}, {"Substep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3089.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of the deletion of SDelete64.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13230.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"file deletion T1107\" was generated when cmd.exe deleted sdelete.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-13664.png"], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "An MSSP detection occurred for hostui.lnk executing from Startup Folder.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13232.png"], "Footnotes": []}]}, {"Substep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13233.png"], "Footnotes": []}]}, {"Substep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.002", "Subtechnique_Name": "Access Token Manipulation: Create Process with Token"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"Access Token Manipulation\" was generated for thread impersonation.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3102.png", "Palo Alto Networks-APT29-3110.png", "Palo Alto Networks-APT29-3103.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13233.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed explorer.exe executing powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3125.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13234.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3125.png"], "Footnotes": []}]}, {"Substep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1564", "Technique_Name": "Hide Artifacts"}, "Subtechnique": {"Subtechnique_Id": "T1564.004", "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3126.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13234.png"], "Footnotes": []}]}, {"Substep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13236.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"System Information Discovery\" was generated for a PowerShell gwmi query for Win32_BIOS.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3129.png"], "Footnotes": []}]}, {"Substep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection called \"System Information Discovery\" was generated for a PowerShell gwmi query for Win32_BIOS.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3129.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13236.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-13687.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3132.png"], "Footnotes": []}]}, {"Substep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1120", "Technique_Name": "Peripheral Device Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence execution of an WMI query for Win32_PnPEntity.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13236.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-13686.png"], "Footnotes": []}]}, {"Substep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13236.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-13687.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3132.png"], "Footnotes": []}]}, {"Substep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13236.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-13687.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3132.png"], "Footnotes": []}]}, {"Substep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection contained evidence of PowerShell executing a gwmi query for Win32_Process.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13236.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"process discovery - T1057\" was generated for a PowerShell gwmi query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3137.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"Substep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3395.png", "Palo Alto Networks-APT29-3394.png"], "Footnotes": []}]}, {"Substep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A MSSP detection occurred for certutil.exe decoding kxwn.lock.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13237.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3153.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) for \"encoding information using Windows certificate management tool\" was generated due to certutil decoding the kwxn.lock payload.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3149.png"], "Footnotes": []}]}, {"Substep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13237.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"commonly abused process creates a new autostart Registry key\" was generated for powershell.exe adding Run key persistence into the Registry.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3164.png", "Palo Alto Networks-APT29-3163.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"New entry added to startup related Registry keys by signed binary\" was generated for powershell.exe adding Run key persistence into the Registry.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3164.png", "Palo Alto Networks-APT29-3163.png"], "Footnotes": []}]}, {"Substep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "An MSSP detection contained evidence of PowerShell executing from schemas ADS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13238.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3142.png"], "Footnotes": []}]}, {"Substep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13238.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3140.png", "Palo Alto Networks-APT29-3142.png"], "Footnotes": []}]}, {"Substep": "11.A.14", "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 12, "Step_Name": "Fortify Access", "Substeps": [{"Substep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for Timestomping was generated containing evidence of PowerShell enumeration of System32.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13239.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.006", "Subtechnique_Name": "Indicator Removal on Host: Timestomp"}, "Detections": [{"Detection_Note": "Telemetry showed scriptblock with commands to timestomp kxwn.lock.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A Technique alert detection called \"ioc.Timestomp_T1099\" (high severity) was generated due to PowerShell modifying timestamps on kxwn.lock file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-13688.png", "Palo Alto Networks-APT29-3178.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A MSSP detection occurred containing evidence of security software discovery attempts.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13240.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (high severity) called \"Security Software Discovery\" was generated due to powershell executing a gwmi query for AntiVirusProduct.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3180.png", "Palo Alto Networks-APT29-3183.png"], "Footnotes": []}]}, {"Substep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed script block with registry query for installed software.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-14500.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of the registry query for installed software.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13242.png", "Palo Alto Networks-APT29-13241.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection (high severity) called for Discovery was generated when the software function was executed.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3183.png", "Palo Alto Networks-APT29-3180.png"], "Footnotes": []}]}, {"Substep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed scriptblock with registry query for installed software.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-14500.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of the registry query for installed software.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13242.png", "Palo Alto Networks-APT29-13241.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection (high severity) for Discovery was generated when the software function was executed.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3183.png", "Palo Alto Networks-APT29-3180.png"], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Reconnaissance", "Substeps": [{"Substep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13689.png"], "Footnotes": []}]}, {"Substep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13689.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13689.png"], "Footnotes": []}]}, {"Substep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-14501.png", "Palo Alto Networks-APT29-13689.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Elevation & Credential Access", "Substeps": [{"Substep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3186.png", "Palo Alto Networks-APT29-3187.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of the addition of DelegateExecute subkey.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13244.png"], "Footnotes": []}]}, {"Substep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3380.png", "Palo Alto Networks-APT29-3379.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13244.png"], "Footnotes": []}]}, {"Substep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3186.png", "Palo Alto Networks-APT29-3187.png"], "Footnotes": []}]}, {"Substep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1047", "Technique_Name": "Windows Management Instrumentation"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executed by WMI. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["Palo Alto Networks-APT29-3383.png"], "Footnotes": ["The way this data was presented was altered after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}]}, {"Substep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) was generated for an executable created by a Windows scripting engine. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13720.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell command to download m.exe as well as the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13715.png", "Palo Alto Networks-APT29-3189.png"], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}, {"Detection_Note": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13245.png"], "Footnotes": []}]}, {"Substep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A General alert was generated identifying m.exe as malware.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-13719.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (high severity) for Credential Dumping was generated for PowerShell reading credentials from Lsass memory.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3192.png", "Palo Alto Networks-APT29-3191.png", "Palo Alto Networks-APT29-3193.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13246.png", "Palo Alto Networks-APT29-13250.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Command line arguments matching Mimikatz execution\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3190.png"], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}]}, {"Substep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-13715.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13251.png"], "Footnotes": []}]}, {"Substep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13247.png", "Palo Alto Networks-APT29-13252.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred for PowerShell executing $env:UserName.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13248.png", "Palo Alto Networks-APT29-13254.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3400.png"], "Footnotes": []}]}, {"Substep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3400.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection was generated for PowerShell creating a WMI event subscription.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-14507.png", "Palo Alto Networks-APT29-13724.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of WMI persistence established for user Oscar.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13254.png"], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-13726.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3390.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13255.png"], "Footnotes": []}]}, {"Substep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13255.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3390.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13256.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3249.png"], "Footnotes": []}]}, {"Substep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3302.png", "Palo Alto Networks-APT29-3300.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3280.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13257.png"], "Footnotes": []}]}, {"Substep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "Telemetry showed m.exe injecting a thread into lsass.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3283.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Credential Dumping\" was generated for m.exe reading lsass.exe process memory.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3273.png", "Palo Alto Networks-APT29-3272.png", "Palo Alto Networks-APT29-3271.png"], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Command line arguments matching Mimikatz execution\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3282.png"], "Footnotes": ["According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."]}, {"Detection_Note": "A General alert detection called \"heuristic.b.mimikatz_lsadump_inject\" was generated for possible Mimikatz activity.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3285.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13258.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) was generated for a rare child process spawned from wsmprovhost.exe.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3282.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Collection", "Substeps": [{"Substep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1114", "Technique_Name": "Email Collection"}, "Subtechnique": {"Subtechnique_Id": "T1114.001", "Subtechnique_Name": "Email Collection: Local Email Collection"}, "Detections": [{"Detection_Note": "Telemetry showed outlook.exe spawning from powershell.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3291.png", "Palo Alto Networks-APT29-13727.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3297.png", "Palo Alto Networks-APT29-3298.png"], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A General alert detection for Data Staged was generated when the WindowsParentalControlMigration.tmp file was compressed.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3303.png", "Palo Alto Networks-APT29-3305.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-17857.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of data compression.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13259.png"], "Footnotes": []}]}, {"Substep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-17857.png", "Palo Alto Networks-APT29-13729.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13259.png"], "Footnotes": []}]}]}, {"Step_Num": 18, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1102", "Technique_Name": "Web Service"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (red indicator) called \"Non-browser access to a web service\" was generated when net.exe made an HTTPS connection to a OneDrive URL. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["Palo Alto Networks-APT29-3318.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) called \"WebDAV drive mount from net.exe over HTTPS\" was generated when net.exe made an HTTPS connection. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3318.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of net.exe connection to OneDrive over TCP port 443.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13260.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3318.png"], "Footnotes": []}]}, {"Substep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1567", "Technique_Name": "Exfiltration Over Web Service"}, "Subtechnique": {"Subtechnique_Id": "T1567.002", "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage"}, "Detections": [{"Detection_Note": "Telemetry showed the creation of the exfiltrated data within the mapped OneDrive directory. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["Palo Alto Networks-APT29-3321.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence  WindowsParentalControlMigration.tmp file was written to the mapped OneDrive network share.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13260.png"], "Footnotes": []}]}]}, {"Step_Num": 20, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3325.png", "Palo Alto Networks-APT29-3322.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated containing evidence of rundll32.exe executing kxwn.lock.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-15751.png"], "Footnotes": []}]}, {"Substep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "A Technique alert detection (high severity) called was generated for PowerShell executing as part of a Windows Management Instrumentation Event Subscription.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3327.png", "Palo Alto Networks-APT29-3326.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated containing evidence of powershell.exe executing from Windows Management Instrumentation Event Subscription.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-15752.png"], "Footnotes": []}]}, {"Substep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed a SYSTEM-level PowerShell spawning from a svchost.exe associated with the WMI service.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-13731.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated containing evidence of powershell.exe executing another powershell.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-15752.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.003", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket"}, "Detections": [{"Detection_Note": "An MSSP detection was generated containing evidence of powershell.exe executing Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-15752.png"], "Footnotes": []}]}, {"Substep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. Telemetry also showed the WinRM process on Scranton (10.0.1.4) exchanging data with Utica (10.0.1.5).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-13732.png", "Palo Alto Networks-APT29-3351.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13261.png"], "Footnotes": []}]}, {"Substep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "A Technique alert detection called \"created account T1136\" (high severity) was generated for net.exe with the command-line arguments to add the new user Toby.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["Palo Alto Networks-APT29-3348.png", "Palo Alto Networks-APT29-3349.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["Palo Alto Networks-APT29-13261.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Palo Alto Networks-APT29-3350.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Eval_Range_Screenshots": {"Scenario_1": [{"Screenshot_Name": "Carbanak-FIN7_PA_1_5.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_PA_1_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_PA_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_PA_1_3.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_PA_1_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_PA_1_4.png", "Screenshot_Caption": ""}], "Scenario_2": [{"Screenshot_Name": "Carbanak-FIN7_PA_2_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_PA_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_PA_2_1.png", "Screenshot_Caption": ""}]}, "Linux_Participant": true, "Alerting_Strategy": "When an event or set of events deemed to be malicious, an alert is generated for the process or for the Causality group instance responsible for the malicious behavior. The alert will be graded on a severity scale between Informational and High and will include a name, brief description, and potential mapping(s) to related ATT&CK Tactics and Techniques. Expanding an alert will show the logic that caused it to trigger.", "Correlation_Strategy": "Events are correlated within a Causality tree. Selecting a specific process or instance will show various events associated with it such as file activity, network connections, RPC calls, module loads, and registry activity. The Causality/process tree may be stitched across multiple hosts. Dashboard views also exist to provide a wider perspective on events across multiple hosts.", "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "1.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.2", "Procedure": "", "Criteria": "winword.exe loads VBE7.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "A Technique detection named \"Possible Abusive Module Load\" (Informational) was generated when winword.exe loaded VBE7.DLL.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.2_3.png", "Carbanak-FIN7_PA_1.A.2_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "Informational", "Indicator_Name": "Possible Abusive Module Load"}, {"Detection_Note": "A Technique detection named \"Office process loads scripting related DLLs \" (Informational) was generated when winword.exe loaded VBE7.DLL.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.2_4.png", "Carbanak-FIN7_PA_1.A.2_5.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Office process loads scripting related DLLs"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.2_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.3", "Procedure": "", "Criteria": "wscript.exe executes unprotected.vbe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Technique detection named \"Scripting engine reads script from suspicious folder\" (Low) was generated when wscript.exe executed unprotected.vbe from the TEMP folder.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.3_2.png", "Carbanak-FIN7_PA_1.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Scripting engine reads script from suspicious folder"}, {"Detection_Note": "A General detection named \"Malware\" was generated when unprotected.vbe was detected as malware.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Sandbox", "File Monitoring"], "Indicator": "", "Indicator_Name": "Malware"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.4", "Procedure": "", "Criteria": "unprotected.vbe is an encoded file", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"YARA Malware Signature\" was generated when unprotected.vbe was identified as an encoded file.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.4_2.png", "Carbanak-FIN7_PA_1.A.4_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Sandbox", "Process Monitoring"], "Indicator": "", "Indicator_Name": "YARA Malware Signature"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.5", "Procedure": "", "Criteria": "wscript.exe decodes content and creates starter.vbs", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Deobfuscation Attempt\" (Medium) was generated when wscript.exe executed commands that can be used to deobfuscate commands or files.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Deobfuscation Attempt"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.5_1.png", "Carbanak-FIN7_PA_1.A.5_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.6", "Procedure": "", "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"YARA Malware Signature\" (High) was generated when TransBaseOdbcDriver.js was detected as malware.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.6_3.png", "Carbanak-FIN7_PA_1.A.6_2.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "High", "Indicator_Name": "YARA Malware Signature"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Deobfuscation attempt\" (Medium) was generated when wscript.exe decoded and created TransBaseOdbcDriver.js.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Deobfuscation attempt"}], "Linux_Only": false}, {"Substep": "1.A.7", "Procedure": "", "Criteria": "wscript.exe executes starter.vbs", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.7_3.png", "Carbanak-FIN7_PA_1.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"YARA Malware Signature\" (High) was generated when wscript.exe executed starter.vbs which was detected as suspicious.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.7_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Sandbox", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "YARA Malware Signature"}], "Linux_Only": false}, {"Substep": "1.A.8", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Windows Command Shell\" (Low) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Windows Command Shell"}], "Linux_Only": false}, {"Substep": "1.A.9", "Procedure": "", "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.9_3.png", "Carbanak-FIN7_PA_1.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Suspicious JavaScript file detected\" (High) was generated when cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js, which was detected as suspicious.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.9_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Suspicious JavaScript file detected"}], "Linux_Only": false}, {"Substep": "1.A.10", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "A Technique detection named \"Application Layer Protocol: Web Protocols (T1071.001)\" was generated when wscript.exe connected to 192.168.0.4 over HTTPS.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.10_3.png", "Carbanak-FIN7_PA_1.A.10_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "System Calls/API Monitoring", "Process Monitoring", "RPC"], "Indicator": "", "Indicator_Name": "Application Layer Protocol: Web Protocols (T1071.001)"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.10_5.png", "Carbanak-FIN7_PA_1.A.10_6.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "RPC", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.11", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"HTTPS Traffic via Direct IP\" was generated when wscript.exe connected to 192.168.0.4 over HTTPS.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.11_3.png", "Carbanak-FIN7_PA_1.A.11_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "RPC", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "HTTPS Traffic via Direct IP"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.11_5.png", "Carbanak-FIN7_PA_1.A.11_6.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "RPC", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 2, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "2.A.2", "Procedure": "", "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.A.2_4.png", "Carbanak-FIN7_PA_2.A.2_3.png", "Carbanak-FIN7_PA_2.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"System Information Discovery\" (Informational) was generated when wscript.exe made WMI queries for Win32_Processor & Win32_OperatingSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.A.2.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "System Information Discovery"}], "Linux_Only": false}, {"Substep": "2.A.4", "Procedure": "", "Criteria": "wscript.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.A.4_3.png", "Carbanak-FIN7_PA_2.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Remote Process Discovery\" (Informational) was generated when wscript.exe made a WMI query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.A.4_4.png", "Carbanak-FIN7_PA_2.A.4.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Remote Process Discovery"}], "Linux_Only": false}, {"Substep": "2.B.1", "Procedure": "", "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.B.1_1.png", "Carbanak-FIN7_PA_2.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Script Logs", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Commandline Process Created a Shell Process\" (Low) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.B.3_2.png", "Carbanak-FIN7_PA_2.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Commandline Process Created a Shell Process"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"PowerShell Screenshot Taken\" (High) was generated when powershell took a screenshot.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.B.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "PowerShell Screenshot Taken"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Windows Event Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.5", "Procedure": "", "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_2.B.5.png", "Carbanak-FIN7_PA_2.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 3, "Step_Name": "Deploy Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Cmd.exe Execution\" (Informational) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_PA_3.A.1_1.png"], "Footnotes": ["Marked as delayed due to data being uploaded to cloud for further analysis"], "Data_Sources": ["Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Cmd.exe Execution"}, {"Detection_Note": "A Technique detection named \"Scripting Engine Spawns cmd.exe\" (Informational) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_PA_3.A.1_2.png"], "Footnotes": ["Marked as delayed due to data being uploaded to cloud for further analysis"], "Data_Sources": ["Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Scripting Engine Spawns cmd.exe"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.A.2", "Procedure": "", "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Office Script Dropper\" (High) was generated when reg.exe was spawned in a process tree started by winword.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Office Script Dropper"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.A.3", "Procedure": "", "Criteria": "Value added to Registry is base64 encoded", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.1", "Procedure": "", "Criteria": "wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote File Opertaion\" (Low) was generated when wscript.exe downloaded LanCradDriver.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.1_1.png", "Carbanak-FIN7_PA_3.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Remote File Opertaion"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Non-powershell Process Launched with PowerShell Arguments\" (Informational) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.3_1.png", "Carbanak-FIN7_PA_3.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Non-powershell Process Launched with PowerShell Arguments"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.4", "Procedure": "", "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.5", "Procedure": "", "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Deobfuscation Attempt\" (Medium) was generated when powershell.exe executed commands that can be used to deobfuscate commands or files.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.5_2.png", "Carbanak-FIN7_PA_3.B.5_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "Medium", "Indicator_Name": "Deobfuscation Attempt"}], "Linux_Only": false}, {"Substep": "3.B.6", "Procedure": "", "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Behavioral Threat Detected\" (High) was generated when powershell.exe executed the shellcode from the Registry by calling the CreateThread() API.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.6_2.png", "Carbanak-FIN7_PA_3.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "System Calls/API Monitoring"], "Indicator": "High", "Indicator_Name": "Behavioral Threat Detected"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Event Logs", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.7_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 4, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "4.A.1", "Procedure": "", "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "4.A.2", "Procedure": "", "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote System Discovery\" was generated when Powershell.exe created an unusual ldap connection that might be used for reconnaissance.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.A.2.png", "Carbanak-FIN7_PA_4.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Remote System Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.3", "Procedure": "", "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "A Technique detection named \"Powersploit Password Spray\" was generated when powershell.exe executed Find-LocalAdminAccess, which connected to multiple hosts over port 135 to check for access.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Powersploit Password Spray"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.A.3_2.png", "Carbanak-FIN7_PA_4.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.4", "Procedure": "", "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Authentication Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Uncommon Successful Network Login\" (Low) was generated when user kmitnick successfully logged into cfo (10.0.0.5).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Authentication Logs", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon Successful Network Login"}], "Linux_Only": false}, {"Substep": "4.B.1", "Procedure": "", "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Scripts\" (Low) was generated when powershell.exe downloaded rad353F7.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN Dropping Uncommon Scripts"}], "Linux_Only": false}, {"Substep": "4.B.2", "Procedure": "", "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Executable\" (Low) was generated when powershell.exe downloaded smrs.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.2_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN Dropping Uncommon Executable"}], "Linux_Only": false}, {"Substep": "4.B.3", "Procedure": "", "Criteria": "powershell.exe executes rad353F7.ps1", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowerShell Suspicious Flags Signal\" (Low) was generated when powershell.exe executed rad353F7.ps1.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "PowerShell Suspicious Flags Signal"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.3_1.png", "Carbanak-FIN7_PA_4.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.4", "Procedure": "", "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.4_2.png", "Carbanak-FIN7_PA_4.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "Windows Event Logs", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.5", "Procedure": "", "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A General detection named \"Suspicious Process Creation\" was generated when fodhelper.exe spawned cmd.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.5_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Suspicious Process Creation"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.5.png", "Carbanak-FIN7_PA_4.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Bypass User Access Control\" was generated when fodhelper.exe spawned cmd.exe as a high-integrity process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Bypass User Access Control"}], "Linux_Only": false}, {"Substep": "4.B.6", "Procedure": "", "Criteria": "cmd.exe spawns smrs.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"CMD Executed an Uncommonly Executed Process\" was generated when cmd.exe executed smrs.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "CMD Executed an Uncommonly Executed Process"}], "Linux_Only": false}, {"Substep": "4.B.7", "Procedure": "", "Criteria": "smrs.exe opens and reads lsass.exe", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique detection named \"Sync.Mimikatz_RPM\" (High) was generated when smrs.exe opened and read lsass.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.7_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Sync.Mimikatz_RPM"}, {"Detection_Note": "A Technique detection named \"MiniDumper\" (High) was generated when smrs.exe opened and read lsass.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.7.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "MiniDumper"}, {"Detection_Note": "A General detection named \"Yara Malware Signature\" (High) was generated when smrs.exe was detected as a credential dumper.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.7_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "High", "Indicator_Name": "Yara Malware Signature"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.7_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 5, "Step_Name": "Expand Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "", "Criteria": "powershell.exe downloads pscp.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Executable\" (Low) was generated when powershell.exe created pscp.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.1.png", "Carbanak-FIN7_PA_5.A.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN Dropping Uncommon Executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.2", "Procedure": "", "Criteria": "powershell.exe downloads psexec.py from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Scripts\" (Low) was generated when powershell.exe created psexec.py.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.2_4.png", "Carbanak-FIN7_PA_5.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN Dropping Uncommon Scripts"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.2_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.3", "Procedure": "", "Criteria": "powershell.exe downloads runtime from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Executable\" (Low) was generated when powershell.exe created runtime.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.3.png", "Carbanak-FIN7_PA_5.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN Dropping Uncommon Executable"}], "Linux_Only": false}, {"Substep": "5.A.4", "Procedure": "", "Criteria": "powershell.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Executable\" (Low) was generated when Powershell.exe created plink.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.4.png", "Carbanak-FIN7_PA_5.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN Dropping Uncommon Executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.5", "Procedure": "", "Criteria": "powershell.exe downloads tiny.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.5_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Executable\" (Low) was generated when powershell.exe created tiny.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.5.png", "Carbanak-FIN7_PA_5.A.5_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN Dropping Uncommon Executable"}], "Linux_Only": false}, {"Substep": "5.A.6", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.7", "Procedure": "", "Criteria": "Pscp.exe connects over SCP (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "A Technique detection named \"Incoming SSH Connection\" (Low) was generated when pscp.exe connected over SCP (port 22) to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.7.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Incoming SSH Connection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.7_1.png", "Carbanak-FIN7_PA_5.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution of a CLI file transfer/copy utility\" (Low) was generated when pscp.exe was executed.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Execution of a CLI file transfer/copy utility"}], "Linux_Only": true}, {"Substep": "5.A.8", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": true}, {"Substep": "5.A.9", "Procedure": "", "Criteria": "Pscp.exe copies psexec.py to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.9_7.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"SCP File Drop\" (Medium) was generated when pscp.exe copied psexec.py to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.9_6.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "SCP File Drop"}, {"Detection_Note": "A Technique detection named \"Uncommon Script File Dropped via SCP\" (Low) was generated when pscp.exe copied psexec.py to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.9_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon Script File Dropped via SCP"}], "Linux_Only": true}, {"Substep": "5.A.10", "Procedure": "", "Criteria": "Pscp.exe copies runtime to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon Executable Dropped Via SCP\" (Low) was generated when pscp.exe copied runtime to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.10.png", "Carbanak-FIN7_PA_5.A.10_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon Executable Dropped Via SCP"}, {"Detection_Note": "A Technique detection named \"Remote File Copy via SCP\" (Low) was generated when pscp.exe copied runtime to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.10_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Remote File Copy via SCP"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.10_3.png", "Carbanak-FIN7_PA_5.A.10_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.11", "Procedure": "", "Criteria": "Pscp.exe copies tiny.exe to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"SCP File Drop\" (Medium) was generated when pscp.exe copied tiny.exe to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.11_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Medium", "Indicator_Name": "SCP File Drop"}, {"Detection_Note": "A Technique detection named \"Uncommon File Dropped via SSH Daemon\" (Low) was generated when pscp.exe copied tiny.exe to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.11_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon File Dropped via SSH Daemon"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.A.11_5.png", "Carbanak-FIN7_PA_5.A.11_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.1", "Procedure": "", "Criteria": "plink.exe connects over SSH (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "A Technique detection named \"Incoming SSH Connections\" was generated when plink.exe connected over SSH (port 22) to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.1_3.png", "Carbanak-FIN7_PA_5.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Incoming SSH Connections"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.1.png", "Carbanak-FIN7_PA_5.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Suspicious Account Login\" (Low) was generated when user kmitnick logged on to bankfileserver (10.0.0.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.2_1.png", "Carbanak-FIN7_PA_5.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Suspicious Account Login"}], "Linux_Only": true}, {"Substep": "5.B.3", "Procedure": "", "Criteria": "User kmitnick executes ps ax", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process enumeration using ps\" (Low) was generated when user kmitnick executes ps ax.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Process enumeration using ps"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.3_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.4", "Procedure": "", "Criteria": "User kmitnick executes ls -lsahR /var/", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.4_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"File Discovery Using ls\" (Low) was generated when user kmitnick executed ls -lsahR /var/.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "File Discovery Using ls"}], "Linux_Only": true}, {"Substep": "5.B.5", "Procedure": "", "Criteria": "User kmitnick reads network-diagram-financial.xml via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"File Data Collection\" was generated when user kmitnick read network-diagram-financial.xml via cat.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "File Data Collection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.6", "Procedure": "", "Criteria": "User kmitnick reads help-desk-ticket.txt via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon cat Command Execution\" (Low) was generated when user kmitnick read help-desk-ticket.txt via cat.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon cat Command Execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.7", "Procedure": "", "Criteria": "User kmitnick enumerates the domain controller via nslookup, which queries for the DC (10.0.0.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Nslookup Enumeration\" (Low) was generated when user kmitnick enumerated the domain controller via nslookup.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Nslookup Enumeration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.B.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.C.1", "Procedure": "", "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Detections": [{"Detection_Note": "A Technique detection named \"Impacket Used for Pass the Hash\" (Low) was generated when psexec.py created a logon to 10.0.0.4 as user kmitnick.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Impacket Used for Pass the Hash"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.2", "Procedure": "", "Criteria": "psexec.py connects to SMB shares on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.2_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"SMB Traffic for Non-Standard Process\" (Low) was generated when psexec.py connected to SMB shares on 10.0.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "Low", "Indicator_Name": "SMB Traffic for Non-Standard Process"}, {"Detection_Note": "A Technique detection named \"Linux to Windows Lateral Movement via SMB\" (Medium) was generated when psexec.py connected to 10.0.0.4 over port 445.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.2_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Linux to Windows Lateral Movement via SMB"}], "Linux_Only": false}, {"Substep": "5.C.3", "Procedure": "", "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A General detection named \"Remote Windows Service Creation\" (Informational) was generated when the service executable was created.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.3_3.png"], "Footnotes": [], "Data_Sources": ["RPC", "Script Logs"], "Indicator": "Informational", "Indicator_Name": "Remote Windows Service Creation"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Uncommon Process Execution from Services.exe\" (Low) was generated when cmd.exe spawned from a service executable in C:\\Windows\\.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon Process Execution from Services.exe"}], "Linux_Only": false}, {"Substep": "5.C.4", "Procedure": "", "Criteria": "tiny.exe is created on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.5", "Procedure": "", "Criteria": "cmd.exe spawns tiny.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Windows Scripting Engine Runs with System Privileges \" (Low) was generated when cmd.exe spawned tiny.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Windows Scripting Engine Runs with System Privileges"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.6", "Procedure": "", "Criteria": "tiny.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Behavioral Threat\" was generated when threat activity indicitive of shellcode was identified.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.6_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Behavioral Threat"}], "Linux_Only": false}]}, {"Step_Num": 6, "Step_Name": "Discover Potential Targets", "Substeps": [{"Substep": "6.A.1", "Procedure": "", "Criteria": "tiny.exe loads system.management.automation.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_6.A.1_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "6.A.2", "Procedure": "", "Criteria": "PowerShell executes Get-ADComputer", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_6.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Powershell remote host discovery used\" (Low) was generated when PowerShell executed Get-ADComputer.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_6.A.2.png", "Carbanak-FIN7_PA_6.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Powershell remote host discovery used"}], "Linux_Only": false}, {"Substep": "6.A.3", "Procedure": "", "Criteria": "PowerShell executes Get-NetUser", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_6.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Powershell user discovery command used\" was generated when PowerShell executed Get-NetUser.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_6.A.3.png", "Carbanak-FIN7_PA_6.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Powershell user discovery command used"}], "Linux_Only": false}]}, {"Step_Num": 7, "Step_Name": "Setup Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "", "Criteria": "tiny.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon executable dropping an uncommon executable\" (Low) was generated when tiny.exe downloaded plink.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.A.1_4.png", "Carbanak-FIN7_PA_7.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon executable dropping an uncommon executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.A.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.2", "Procedure": "", "Criteria": "tiny.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Behavioral Threat\" (Informational) was generated when an unsigned process (tiny.exe) spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Behavioral Threat"}, {"Detection_Note": "A Technique detection named \"Uncommon LOLBIN execution\" (Low) was generated when tiny.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon LOLBIN execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.3", "Procedure": "", "Criteria": "plink.exe transmits data to 192.168.0.4 over SSH protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to bankdc (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon Successful Network Login\" (Low) was generated when kmitnick logged on to bankdc (10.0.0.4).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "Low", "Indicator_Name": "Uncommon Successful Network Login"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.A.4.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "7.A.5", "Procedure": "", "Criteria": "RDP session from the localhost over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote RDP Session Enumeration via Qwinsta.exe\" (Low) was generated when powershell.exe was spawned and labeled as a remote process.", "Detection_Type": "Technique", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_PA_7.A.5_1.png", "Carbanak-FIN7_PA_7.A.5_2.png"], "Footnotes": ["Marked as delayed due to detection only coming after a new process was spawned"], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Remote RDP Session Enumeration via Qwinsta.exe"}], "Linux_Only": false}, {"Substep": "7.B.1", "Procedure": "", "Criteria": "powershell.exe executes qwinsta /server:cfo", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Remote RDP Session Enumeration via Qwinsta.exe\" (Low) was generated when powershell.exe executed qwinsta /server:cfo.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.B.1_2.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "Low", "Indicator_Name": "Remote RDP Session Enumeration via Qwinsta.exe"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to cfo (10.0.0.5)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon successful network login\" (Low) was generated when user kmitnick logged on to cfo (10.0.0.5).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.B.2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "Low", "Indicator_Name": "Uncommon successful network login"}], "Linux_Only": false}, {"Substep": "7.B.3", "Procedure": "", "Criteria": "RDP session from 10.0.0.4 to 10.0.0.5 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote Desktop Protocol\" (Informational) was generated when powershell.exe was initiated from a remote terminal session.", "Detection_Type": "Technique", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_PA_7.B.3.png", "Carbanak-FIN7_PA_7.B.3_1.png"], "Footnotes": ["Marked as delayed due to detection only coming after a new process was spawned"], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Remote Desktop Protocol"}], "Linux_Only": false}, {"Substep": "7.C.1", "Procedure": "", "Criteria": "scp.exe downloads Java-Update.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection was generated when Java-Update.exe was detected as malware.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.1_5.png"], "Footnotes": [], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.1_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Uncommon executable dropping an uncommon executable\" (Low) was generated when scp.exe downloads Java-Update.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon executable dropping an uncommon executable"}], "Linux_Only": false}, {"Substep": "7.C.2", "Procedure": "", "Criteria": "dir lists the contents of C:\\Users\\Public", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN Uncommon Directory Discovery\" (Informational) was generated when cmd.exe listed the contents of C:\\Users\\Public.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.2_2.png", "Carbanak-FIN7_PA_7.C.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "LOLBIN Uncommon Directory Discovery"}], "Linux_Only": false}, {"Substep": "7.C.3", "Procedure": "", "Criteria": "cmd.exe downloads Java-Update.vbs from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"YARA Malware Signature\" (High) was generated when Java-Update.vbs was detected as malware.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.3_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "High", "Indicator_Name": "YARA Malware Signature"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.3_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "None", "Indicator_Name": "None"}, {"Detection_Note": "A Technique detection named \"LOLBIN dropping uncommon scripts\" (Low) was generated when cmd.exe downloaded Java-Update.vbs from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN dropping uncommon scripts"}], "Linux_Only": false}, {"Substep": "7.C.4", "Procedure": "", "Criteria": "Java-Update subkey is added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique detection named \"New entry added to startup related Registry keys by signed process\" was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.4.png", "Carbanak-FIN7_PA_7.C.4_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "New entry added to startup related Registry keys by signed process"}, {"Detection_Note": "A Technique detection named \"Autostart Registry key created by a commonly-abused process\" was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.4_6.png", "Carbanak-FIN7_PA_7.C.4_8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "Autostart Registry key created by a commonly-abused process"}, {"Detection_Note": "A Technique detection named \"Script file added to startup-related Registry keys\" was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.4_5.png", "Carbanak-FIN7_PA_7.C.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "Script file added to startup-related Registry keys"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_7.C.4_9.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 8, "Step_Name": "Gain Covert Access to Target", "Substeps": [{"Substep": "8.A.1", "Procedure": "", "Criteria": "wscript.exe spawns Java-Update.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A General detection named \"Memory Corruption Exploit\" was generated when Suscpicious access to DLLs was attempted.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_8.A.1_2.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": "Memory Corruption Exploit"}, {"Detection_Note": "A Technique detection named \"YARA Malware Signatue\" (High) was generated when wscript.exe spawned Java-Update.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_8.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "YARA Malware Signatue"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_8.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "8.A.2", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "A Technique detection named \"HTTPS Traffic via Direct IP\" (Informational) was generated when Java-Update.exe exchanged data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_8.A.2_1.png", "Carbanak-FIN7_PA_8.A.2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Network Monitoring", "RPC", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "HTTPS Traffic via Direct IP"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_8.A.2_4.png", "Carbanak-FIN7_PA_8.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "RPC", "System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "8.A.3", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"HTTPS Traffic via Direct IP\" (Informational) was generated when Java-Update.exe exchanges data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_8.A.3_1.png", "Carbanak-FIN7_PA_8.A.3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring", "RPC", "Network Monitoring"], "Indicator": "Informational", "Indicator_Name": "HTTPS Traffic via Direct IP"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_8.A.3_4.png", "Carbanak-FIN7_PA_8.A.3_3.png"], "Footnotes": [], "Data_Sources": ["RPC", "System Calls/API Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 9, "Step_Name": "Profile a Victim User", "Substeps": [{"Substep": "9.A.1", "Procedure": "", "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection was generated when DefenderUpgradeExec.exe was detected as malware.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.1_4.png"], "Footnotes": [], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Uncommon executable dropping uncommon executable\" was generated when Java-Update.exe downloaded DefenderUpgradeExec.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Uncommon executable dropping uncommon executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.2", "Procedure": "", "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon process calls keylogging syscalls\" (Low) was generated when DefenderUpgradeExec.exe called the SetWindowsHookEx API.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon process calls keylogging syscalls"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.3", "Procedure": "", "Criteria": "Java-Update.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Behavioral Threat\" was generated when Java-Update.exe wrote virtul memory in explorer.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Behavioral Threat"}, {"Detection_Note": "A Technique detection named \"Injection After Allocation\" (High) was generated when Java-Update.exe injected into explorer.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.3_2.png", "Carbanak-FIN7_PA_9.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "High", "Indicator_Name": "Injection After Allocation"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.4", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Injected thread using suspicious API call\" (Low) was generated when explorer.exe called the CreateCompatibleBitmap API from Gdi32.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.4.png", "Carbanak-FIN7_PA_9.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Injected thread using suspicious API call"}], "Linux_Only": false}, {"Substep": "9.A.5", "Procedure": "", "Criteria": "explorer.exe reads C:\\Users\\jsmith\\AppData\\Local\\Temp\\Klog2.txt over to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Injected thread reads an uncommon file\" (Low) was generated when explorer.exe read C:\\Users\\jsmith\\AppData\\Local\\Temp\\klog2.txt.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Injected thread reads an uncommon file"}], "Linux_Only": false}, {"Substep": "9.B.1", "Procedure": "", "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Injected thread writes an uncommon executable\" (Low) was generated when explorer.exe downloaded infosMin48.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.B.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Injected thread writes an uncommon executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.B.1_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Executable file written to a temporary folder\" (Low) was generated when explorer.exe wrote infosMin48.exe to the TEMP folder.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Executable file written to a temporary folder"}], "Linux_Only": false}, {"Substep": "9.B.2", "Procedure": "", "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.B.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Suspicious loading of vaultcli.dll by unsigned process\" (High) was generated when infosMin48.exe loaded vaultcli.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "High", "Indicator_Name": "Suspicious loading of vaultcli.dll by unsigned process"}], "Linux_Only": false}, {"Substep": "9.B.3", "Procedure": "", "Criteria": "powershell.exe deletes files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Suspicous file deletion by powershell.exe\" was generated when powershell.exe deleted files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_9.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Suspicous file deletion by powershell.exe"}], "Linux_Only": false}]}, {"Step_Num": 10, "Step_Name": "Impersonate Victim", "Substeps": [{"Substep": "10.A.1", "Procedure": "", "Criteria": "explorer.exe downloads tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Injected thread writes an uncommon executable\" (Low) was generated when explorer.exe downloaded tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Injected thread writes an uncommon executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.2", "Procedure": "", "Criteria": "explorer.exe downloads vnc-settings.reg from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Injected thread writes an uncommon script file\" (Low) was generated when explorer.exe downloaded vnc-settings.reg from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Injected thread writes an uncommon script file"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.2_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.3", "Procedure": "", "Criteria": "netsh adds Service Host rule for TCP port 5900", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1562", "Technique_Name": "Impair Defenses"}, "Subtechnique": {"Subtechnique_Id": "T1562.004", "Subtechnique_Name": "Impair Defenses: Disable or Modify System Firewall"}, "Detections": [{"Detection_Note": "A Technique detection named \"Netsh.exe modifies allowed firewall port/program lists\" (Low) was generated when netsh.exe added 'Service Host' rule to allow TCP port 5900 inbound.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.3.png", "Carbanak-FIN7_PA_10.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Netsh.exe modifies allowed firewall port/program lists"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.4", "Procedure": "", "Criteria": "msiexec.exe adds the tvncontrol subkey in HKLM\\Software\\Microsoft\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique detection named \"New entry added to startup related Registry keys by signed process\" was generated when tvncontrol subkey was added to HKLM\\Software\\Microsoft\\CurrentVersion\\Run.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.4_1.png", "Carbanak-FIN7_PA_10.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "New entry added to startup related Registry keys by signed process"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.5", "Procedure": "", "Criteria": "Addition of subkeys in HKLM\\Software\\TightVNC\\Server", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.6", "Procedure": "", "Criteria": "Deletion of the Java-Update subkey in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon reg.exe command-line executed\" (Low) was generated when Java-Update subkey at HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run was deleted.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon reg.exe command-line executed"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.B.1", "Procedure": "", "Criteria": "tvnserver.exe accepts a connection from 192.168.0.4 over TCP port 5900", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1219", "Technique_Name": "Remote Access Software"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Rare VNC session\" (Low) was generated when tvnserver.exe accepted a connection from 192.168.0.4 over TCP port 5900\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_10.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "Low", "Indicator_Name": "Rare VNC session"}], "Linux_Only": false}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "11.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.2", "Procedure": "", "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Office process creates an unusual .LNK file\" was generated when 2-list.rtf contained an embedded lnk payload.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.2.png", "Carbanak-FIN7_PA_11.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Office process creates an unusual .LNK file"}], "Linux_Only": false}, {"Substep": "11.A.3", "Procedure": "", "Criteria": "winword.exe spawns mshta.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Detections": [{"Detection_Note": "A Technique detection named \"Mshta.exe launched with suspicious arguments\" (Medium) was generated when winword.exe spawned mshta.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Mshta.exe launched with suspicious arguments"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.4", "Procedure": "", "Criteria": "mshta.exe executes an embedded VBScript payload", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A General detection named \"Behavioral Threat\" was generated when mshta.exe executed an embedded VBScript payload.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Behavioral Threat"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.4_2.png", "Carbanak-FIN7_PA_11.A.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "None", "Indicator_Name": "None"}, {"Detection_Note": "A Technique detection named \"VBScript or VBA Execution via vbscript/vbe7.dll\" was generated when mshta.exe executed an embedded VBScript payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.4_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "VBScript or VBA Execution via vbscript/vbe7.dll"}], "Linux_Only": false}, {"Substep": "11.A.5", "Procedure": "", "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Suspicious VBScript obfuscation technique\" (Low) was generated when mshta.exe assembled text embedded within 2-list.rtf into a JS payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.5_3.png", "Carbanak-FIN7_PA_11.A.5_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring", "Script Logs"], "Indicator": "Low", "Indicator_Name": "Suspicious VBScript obfuscation technique"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.6", "Procedure": "", "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.6_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Renamed Script Engine by Hash\" was generated when mshta.exe made a copy of the legitimate wscript.exe as Adb156.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.6_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": "Renamed Script Engine by Hash"}], "Linux_Only": false}, {"Substep": "11.A.7", "Procedure": "", "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Inter-Process Communication\" (Low) was generated when winword.exe spawned verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.7_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Inter-Process Communication"}], "Linux_Only": false}, {"Substep": "11.A.8", "Procedure": "", "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "A Technique detection named \"Office process creates a scheduled task via file access\" (Medium) was generated when mshta.exe created a scheduled task to execute in 5 minutes.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.8.png", "Carbanak-FIN7_PA_11.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Medium", "Indicator_Name": "Office process creates a scheduled task via file access"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.8_5.png", "Carbanak-FIN7_PA_11.A.8_4.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring", "Named Pipes", "RPC"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 12, "Step_Name": "Delayed Malware Execution", "Substeps": [{"Substep": "12.A.1", "Procedure": "", "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote Scheduled Task Executed\" (Informational) was generated when svchost.exe spawned adb156.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.1_1.png"], "Footnotes": [], "Data_Sources": ["RPC", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Remote Scheduled Task Executed"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.2", "Procedure": "", "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"JScript execution from renamed/unknown script engines executables\" (Low) was generated when  Adb156.exe executed sql-rat.js using Jscript.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "JScript execution from renamed/unknown script engines executables"}], "Linux_Only": false}, {"Substep": "12.A.3", "Procedure": "", "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Unusual Port used to Connect to an External Destination\" (Low) was generated when adb156.exe transmits data to 192.168.0.6 over port 1433.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Unusual Port used to Connect to an External Destination"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.3_2.png", "Carbanak-FIN7_PA_12.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "12.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.4_2.png", "Carbanak-FIN7_PA_12.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs", "RPC", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Security Tools Detection Attempted\" was generated when Adb156.exe made a WMI query for Win32_NetworkAdapterConfiguration.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.4.png", "Carbanak-FIN7_PA_12.A.4_1.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Security Tools Detection Attempted"}], "Linux_Only": false}, {"Substep": "12.A.5", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Security Tools Detection Attempted\" was generated when Adb156.exe made a WMI query for Win32_LogicalDisk.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.A.5_1.png", "Carbanak-FIN7_PA_12.A.5.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Security Tools Detection Attempted"}], "Linux_Only": false}, {"Substep": "12.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads stager.ps1 from 192.168.0.6", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon script files created in public directory\" was generated when Adb156.exe downloaded stager.ps1.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.B.1_1.png", "Carbanak-FIN7_PA_12.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "Uncommon script files created in public directory"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_12.B.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 13, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "13.A.1", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Discovery\" (Informational) was generated when Adb156.exe made a WMI query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.1_1.png", "Carbanak-FIN7_PA_13.A.1_2.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Process Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.1_6.png", "Carbanak-FIN7_PA_13.A.1_5.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring", "Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"cmd.exe execution\" (Informational) was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "cmd.exe execution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.3", "Procedure": "", "Criteria": "cmd.exe executes net view", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Enumeration using net.exe or net1.exe\" (Low) was generated when cmd.exe executed net view.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Enumeration using net.exe or net1.exe"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.3_1.png", "Carbanak-FIN7_PA_13.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "A Technique detection named \"WMI Sandbox Virtualization Discovery\" (Informational) was generated when Adb156.exe made a WMI query for Win32_BIOS.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.4_2.png", "Carbanak-FIN7_PA_13.A.4_1.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "WMI Sandbox Virtualization Discovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.4_3.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.5", "Procedure": "", "Criteria": "Adb156.exe queries the USERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Environment variables queried inside script\" was generated when Adb156.exe queried the USERNAME environment variable.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.5.png", "Carbanak-FIN7_PA_13.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Environment variables queried inside script"}], "Linux_Only": false}, {"Substep": "13.A.6", "Procedure": "", "Criteria": "Adb156.exe queries the COMPUTERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.6_4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Environment variables queried inside script\" was generated when  Adb156.exe queried the COMPUTERNAME environment variable.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.6_3.png", "Carbanak-FIN7_PA_13.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Environment variables queried inside script"}], "Linux_Only": false}, {"Substep": "13.A.8", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"System network configuration discovery via WMI\" (Informational) was generated when  Adb156.exe made a WMI query for Win32_ComputerSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.8_2.png", "Carbanak-FIN7_PA_13.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "Informational", "Indicator_Name": "System network configuration discovery via WMI"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.8.png", "Carbanak-FIN7_PA_13.A.8_3.png"], "Footnotes": [], "Data_Sources": ["RPC", "Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.9", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"System information discovery via WMI\" (Informational) was generated when Adb156.exe made a WMI query for Win32_OperatingSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.9_2.png", "Carbanak-FIN7_PA_13.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "Informational", "Indicator_Name": "System information discovery via WMI"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.A.9_4.png", "Carbanak-FIN7_PA_13.A.9_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "RPC"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon script files created in public directory\" (Low) was generated when  Adb156.exe downloaded takeScreenshot.ps1.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.B.1_2.png", "Carbanak-FIN7_PA_13.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon script files created in public directory"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command-line Process Started a Shell Process\" (Low) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Command-line Process Started a Shell Process"}], "Linux_Only": false}, {"Substep": "13.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Possible screen capture from powershell.exe\" (Low) was generated when powershell.exe executed CopyFromScreen().", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.B.4_3.png", "Carbanak-FIN7_PA_13.B.4_1.png", "Carbanak-FIN7_PA_13.B.4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Possible screen capture from powershell.exe"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.B.4_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.5", "Procedure": "", "Criteria": "Adb156.exe reads and uploads image.png to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_13.B.5_1.png", "Carbanak-FIN7_PA_13.B.5_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Script Logs", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 14, "Step_Name": "Staging Interactive Toolkit", "Substeps": [{"Substep": "14.A.1", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.2", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Non-PowerShell process launched with PowerShell\" (Informational) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Non-PowerShell process launched with PowerShell"}], "Linux_Only": false}, {"Substep": "14.A.3", "Procedure": "", "Criteria": "powershell.exe decodes an embedded DLL payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Behavioral Threat\" was generated when powershell.exe decoded and imported a .dll.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.3_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Behavioral Threat"}, {"Detection_Note": "A Technique detection named \"Powershell Executed Encoded Data\" was generated when the buffer of the dll was detected upon reading it in memory.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.3.png", "Carbanak-FIN7_PA_14.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Powershell Executed Encoded Data"}], "Linux_Only": false}, {"Substep": "14.A.4", "Procedure": "", "Criteria": "powershell.exe executes the decoded payload using Invoke-Expression (IEX)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Powershell executed encoded data\" was generated when powershell.exe executed the decoded payload using Invoke-Expression (IEX).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.4_1.png", "Carbanak-FIN7_PA_14.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Powershell executed encoded data"}], "Linux_Only": false}, {"Substep": "14.A.5", "Procedure": "", "Criteria": "powershell.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Deobfuscation attempt\" was generated when powershell.exe executed commands that can be used to deobfuscate commands or files.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.5_3.png", "Carbanak-FIN7_PA_14.A.5.png", "Carbanak-FIN7_PA_14.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Deobfuscation attempt"}], "Linux_Only": false}, {"Substep": "14.A.6", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.6_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"HTTP & HTTPS traffic originating for uncommonly located executable\" (Informational) was generated when powershell.exe connected to 192.168.0.4 over HTTPS.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_14.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring", "Network Monitoring", "RPC"], "Indicator": "Informational", "Indicator_Name": "HTTP & HTTPS traffic originating for uncommonly located executable"}], "Linux_Only": false}, {"Substep": "14.A.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "None", "Indicator_Name": "None"}], "Linux_Only": false}]}, {"Step_Num": 15, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "15.A.1", "Procedure": "", "Criteria": "powershell.exe calls the CreateToolhelp32Snapshot() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Powershell process list query\" was generated when powershell queried the system process list.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Powershell process list query"}], "Linux_Only": false}, {"Substep": "15.A.2", "Procedure": "", "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN dropping an uncommon executable\" was generated when powershell.exe downloaded samcat.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.2_1.png", "Carbanak-FIN7_PA_15.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "LOLBIN dropping an uncommon executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.3", "Procedure": "", "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Executable\" was generated when powershell.exe downloaded uac-samcats.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "LOLBIN Dropping Uncommon Executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.4", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"PowerShell suspicious flags signal\" was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowerShell suspicious flags signal"}], "Linux_Only": false}, {"Substep": "15.A.5", "Procedure": "", "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A General detection named \"Powershell Run Key Added\" (Informational) was generated when a Registry entry used for User Account Control bypass was set.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.5_3.png", "Carbanak-FIN7_PA_15.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Informational", "Indicator_Name": "Powershell Run Key Added"}, {"Detection_Note": "A Technique detection named \"Rare process runs with high integrity level\" was generated when powershell.exe spawned samcat.exe as a high-integrity process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.5_1.png", "Carbanak-FIN7_PA_15.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Rare process runs with high integrity level"}], "Linux_Only": false}, {"Substep": "15.A.6", "Procedure": "", "Criteria": "samcat.exe opens and reads the SAM via LSASS", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique detection named \"Behavioral Threat\" was generated when a suspicious handle to lsass was detected.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.6_9.png", "Carbanak-FIN7_PA_15.A.6_8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Behavioral Threat"}, {"Detection_Note": "A Technique detection named \"Behavioral Threat\" (Informational) was generated when a registry query for the SAM hive occured.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.6_11.png", "Carbanak-FIN7_PA_15.A.6_10.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "Informational", "Indicator_Name": "Behavioral Threat"}, {"Detection_Note": "A General detection named \"YARA Malware Signature\" was generated when samcat.exe was identified as a credential dumper.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.6.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "YARA Malware Signature"}, {"Detection_Note": "A Technique detection named \"Mimikatz LSA Dump\" (High) was generated when samcat.exe opened and read lsass.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.6_7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Mimikatz LSA Dump"}], "Linux_Only": false}, {"Substep": "15.A.7", "Procedure": "", "Criteria": "powershell.exe calls the GetIpNetTable() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "15.A.8", "Procedure": "", "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Enumeration command executed\" was generated when powershell.exe spawned nslookup.exe, which queried the DC (10.0.1.4) over DNS (port 53).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.8_1.png", "Carbanak-FIN7_PA_15.A.8_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Enumeration command executed"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.8_2.png", "Carbanak-FIN7_PA_15.A.8_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "", "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection was generated when paexec.exe was detected as Grayware.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.1_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.1_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"LOLBIN dropping an uncommon executable\" (Low) was generated when powershell.exe downloaded paexec.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.1.png", "Carbanak-FIN7_PA_16.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN dropping an uncommon executable"}], "Linux_Only": false}, {"Substep": "16.A.2", "Procedure": "", "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection was generated when hollow.exe was detected as malware.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.2_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.2_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"LOLBIN dropping an uncommon executable\" (Low) was generated when powershell.exe downloaded hollow.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.2.png", "Carbanak-FIN7_PA_16.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN dropping an uncommon executable"}], "Linux_Only": false}, {"Substep": "16.A.3", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"LOLBIN Executed a Command Shell\" (Low) was generated when powershell.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN Executed a Command Shell"}], "Linux_Only": false}, {"Substep": "16.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon successful network login\" (Low) was generated when user kmitnick logged on to itadmin.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "Low", "Indicator_Name": "Uncommon successful network login"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.4.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.5", "Procedure": "", "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.5_3.png", "Carbanak-FIN7_PA_16.A.5_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"RPC traffic from non-standard process\" (Low) was generated when paexec.exe communicated over port 135 to 10.0.1.6.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.5.png", "Carbanak-FIN7_PA_16.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "RPC"], "Indicator": "Low", "Indicator_Name": "RPC traffic from non-standard process"}], "Linux_Only": false}, {"Substep": "16.A.6", "Procedure": "", "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Service Execution\" (Low) was generated when Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executed hollow.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Service Execution"}], "Linux_Only": false}, {"Substep": "16.A.7", "Procedure": "", "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon Process Injects Code\" (Low) was generated when hollow.exe spawned svchost.exe and unmapped its memory image via: NtUnmapViewOfSection.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon Process Injects Code"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.7_3.png", "Carbanak-FIN7_PA_16.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.8", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.8_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "RPC"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"HTTP & HTTPS traffic originating for uncommonly located executable\" (Informational) was generated when svchost.exe exchanges data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.8_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "RPC"], "Indicator": "Informational", "Indicator_Name": "HTTP & HTTPS traffic originating for uncommonly located executable"}], "Linux_Only": false}, {"Substep": "16.A.9", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.9_4.png"], "Footnotes": [], "Data_Sources": ["RPC", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Meterpreter Custom HTTPS\" (Informational) was generated when svchost.exe exchanged data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.9_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "Named Pipes", "System Calls/API Monitoring"], "Indicator": "Informational", "Indicator_Name": "Meterpreter Custom HTTPS"}], "Linux_Only": false}]}, {"Step_Num": 17, "Step_Name": "Setup User Monitoring", "Substeps": [{"Substep": "17.A.1", "Procedure": "", "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection was generated when srrstr.dll was detected as malware.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.1_6.png", "Carbanak-FIN7_PA_17.A.1_7.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Injected thread writes an uncommon executable\" (Low) was generated when svchost.exe downloaded srrstr.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.1_1.png", "Carbanak-FIN7_PA_17.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Injected thread writes an uncommon executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.2", "Procedure": "", "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "17.A.3", "Procedure": "", "Criteria": "svchost.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"cmd.exe execution\" (Low) was generated when svchost.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "cmd.exe execution"}], "Linux_Only": false}, {"Substep": "17.A.4", "Procedure": "", "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Detections": [{"Detection_Note": "A Technique detection named \"DLL Search Order Hijacking\" (Low) was generated when SystemPropertiesAdvanced.exe executed code in the illegitimate srrstr.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.4.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "DLL Search Order Hijacking"}], "Linux_Only": false}, {"Substep": "17.A.5", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.5_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Web application protocol\" (Low) was generated when rundll32.exe connected to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.5.png", "Carbanak-FIN7_PA_17.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "RPC", "Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Web application protocol"}], "Linux_Only": false}, {"Substep": "17.A.6", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"HTTPS Traffic from Executable in Unusual Location\" (Low) was generated when rundll32.exe connected to 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.6_2.png", "Carbanak-FIN7_PA_17.A.6.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "RPC", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "HTTPS Traffic from Executable in Unusual Location"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "RPC"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 18, "Step_Name": "User Monitoring", "Substeps": [{"Substep": "18.A.1", "Procedure": "", "Criteria": "svchost.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Behavioral threat\" (High) was generated when svchost.exe injected into explorer.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_18.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "High", "Indicator_Name": "Behavioral threat"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_18.A.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "18.A.2", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Suspicious GdiBitBlt call\" (Low) was generated when explorer.exe called the BitBlt API after calling the CreateCompatibleBitmap API from Gdi32.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_18.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Suspicious GdiBitBlt call"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_18.A.2_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "18.A.3", "Procedure": "", "Criteria": "explorer.exe injects into mstsc.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon Injection\" (Low) was generated when explorer.exe injected into mstsc.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_18.A.3_2.png", "Carbanak-FIN7_PA_18.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Uncommon Injection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_18.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "18.A.4", "Procedure": "", "Criteria": "mstsc.exe calls APIs such as GetAsyncKeyState, GetKeyState, or GetKeyboardState", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 19, "Step_Name": "Setup Shim Persistence", "Substeps": [{"Substep": "19.A.1", "Procedure": "", "Criteria": "User kmitnick logs on to accounting (10.0.1.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"Uncommon successful network login\" (Low) was generated when user kmitnick logged on to accounting (10.0.1.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.A.1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "Low", "Indicator_Name": "Uncommon successful network login"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.A.2", "Procedure": "", "Criteria": "RDP session from 10.0.1.6 to 10.0.1.7 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"Suspicious RDP process\" (Low) was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "Low", "Indicator_Name": "Suspicious RDP process"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.A.3", "Procedure": "", "Criteria": "itadmin (10.0.1.6) is relaying RDP traffic from attacker infrastructure", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1090", "Technique_Name": "Proxy"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Suspicious RDP communication\" (Low) was generated when itadmin (10.0.1.6) relayed RDP traffic.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.A.3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Suspicious RDP communication"}], "Linux_Only": false}, {"Substep": "19.B.1", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.2", "Procedure": "", "Criteria": "powershell.exe executes base64 encoded commands", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.2_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Deobfuscation attempt\" (Medium) was generated when powershell.exe executed base64 encoded commands\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.2_1.png", "Carbanak-FIN7_PA_19.B.2_2.png", "Carbanak-FIN7_PA_19.B.2_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Deobfuscation attempt"}], "Linux_Only": false}, {"Substep": "19.B.3", "Procedure": "", "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN Dropping Uncommon Executable\" was generated when powershell.exe created dll329.dll\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "LOLBIN Dropping Uncommon Executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.4", "Procedure": "", "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Ingress tool transfer\" was generated when powershell.exe downloaded sdbE376.tmp from 192.168.0.4 over RDP mounted network drive\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.4.png", "Carbanak-FIN7_PA_19.B.4_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Ingress tool transfer"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.5", "Procedure": "", "Criteria": "sdbinst.exe installs sdbE376.tmp shim", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.5_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Shim Database Registration via Registry\" (Low) was generated when sdbinst.exe installed sdbE376.tmp shim database.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.5_2.png", "Carbanak-FIN7_PA_19.B.5_1.png", "Carbanak-FIN7_PA_19.B.5.png", "Carbanak-FIN7_PA_19.B.5_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "Low", "Indicator_Name": "Shim Database Registration via Registry"}, {"Detection_Note": "A Technique detection named \"Application Shimming\" (Low) was generated when sdbinst.exe was executed.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.5_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Application Shimming"}], "Linux_Only": false}]}, {"Step_Num": 20, "Step_Name": "Steal Payment Data", "Substeps": [{"Substep": "20.A.1", "Procedure": "", "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "A Technique detection named \"Unsigned module application shimming\" (Low) was generated when an unsigned module was loaded by an application shimming mechanism.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.A.1_4.png", "Carbanak-FIN7_PA_20.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "Low", "Indicator_Name": "Unsigned module application shimming"}], "Linux_Only": false}, {"Substep": "20.A.2", "Procedure": "", "Criteria": "AccountingIQ.exe injects into SyncHost.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Unsigned Process Injected Code\" (Low) was generated when AccountingIQ.exe injected into SyncHost.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.A.2_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "Unsigned Process Injected Code"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.A.3", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "RPC", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Web application protocol - HTTPS Traffic via Direct IP \" (Low) was generated when rundll32.exe exchanged data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.A.3_1.png", "Carbanak-FIN7_PA_20.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "RPC", "Network Monitoring"], "Indicator": "Low", "Indicator_Name": "Web application protocol - HTTPS Traffic via Direct IP"}], "Linux_Only": false}, {"Substep": "20.A.4", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"HTTP or HTTPS traffic by unsigned process\" (Low) was generated when rundll32.exe exchanged TLS/SSL encrypted data with 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "Low", "Indicator_Name": "HTTP or HTTPS traffic by unsigned process"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.A.4_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.1", "Procedure": "", "Criteria": "rundll32.exe downloads debug.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN dropping an uncommon executable\" (Low) was generated when rundll32.exe downloaded debug.exe from 192.168.0.4\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.1_2.png", "Carbanak-FIN7_PA_20.B.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN dropping an uncommon executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.2", "Procedure": "", "Criteria": "debug.exe calls the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process discovery system call called\" (Low) was generated when debug.exe called QueryProcessList.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Low", "Indicator_Name": "Process discovery system call called"}], "Linux_Only": false}, {"Substep": "20.B.3", "Procedure": "", "Criteria": "rundll32.exe downloads 7za.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"LOLBIN dropping an uncommon executable\" (Low) was generated when rundll32.exe downloaded 7za.exe from 192.168.0.4\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.3_2.png", "Carbanak-FIN7_PA_20.B.3_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN dropping an uncommon executable"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.3_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.4", "Procedure": "", "Criteria": "7za.exe creates C:\\Users\\Public\\log.7z", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Compression utility executed\" (Low) was generated when 7za.exe created C:\\Users\\Public\\log.7z.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "Compression utility executed"}], "Linux_Only": false}, {"Substep": "20.B.5", "Procedure": "", "Criteria": "rundll32.exe reads and uploads log.7z to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"LOLBIN read a compressed file\" (Low) was generated when rundll32.exe read log.7z.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_PA_20.B.5_1.png", "Carbanak-FIN7_PA_20.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Low", "Indicator_Name": "LOLBIN read a compressed file"}], "Linux_Only": false}]}]}}, "Protections": {"Protection_Tests": [{"Test_Num": 1, "Test_Group": "Carbanak", "Test_Name": "Initial Access with Embedded VBE in Word Document", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "1.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf"}, {"Substep_Name": "1.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe loads VBE7.DLL"}, {"Substep_Name": "1.A.3", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 1 was blocked when script execution was blocked, because winword.exe launched a vbe payload and the script was deemed malicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_1.A.3P.png", "Carbanak-FIN7_PA_1.A.3P_1.png", "Carbanak-FIN7_PA_1.A.3P_2.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes unprotected.vbe"}, {"Substep_Name": "1.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "unprotected.vbe is an encoded file"}, {"Substep_Name": "1.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates starter.vbs"}, {"Substep_Name": "1.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes starter.vbs"}, {"Substep_Name": "1.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "1.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.10", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "1.A.11", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "2.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem"}, {"Substep_Name": "2.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes a WMI query for Win32_Process"}, {"Substep_Name": "2.B.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4"}, {"Substep_Name": "2.B.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "2.B.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "cmd.exe spawns powershell.exe"}, {"Substep_Name": "2.B.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes CopyFromScreen()"}, {"Substep_Name": "2.B.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4"}], "Test_Screenshots": []}, {"Test_Num": 2, "Test_Group": "Carbanak", "Test_Name": "Registry Shellcode and Execution", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "3.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer"}, {"Substep_Name": "3.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Value added to Registry is base64 encoded"}, {"Substep_Name": "3.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty"}, {"Substep_Name": "3.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode"}, {"Substep_Name": "3.B.6", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 2 was blocked when powershell.exe was terminated, because it attempted to execute malicious code.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_3.B.6P.png", "Carbanak-FIN7_PA_3.B.6P_1.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API"}, {"Substep_Name": "3.B.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP"}, {"Substep_Name": "4.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs"}, {"Substep_Name": "4.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4"}, {"Substep_Name": "4.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access"}, {"Substep_Name": "4.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick"}], "Test_Screenshots": []}, {"Test_Num": 3, "Test_Group": "Carbanak", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "4.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4"}, {"Substep_Name": "4.B.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Also, smrs.exe was quarantined, because it was identified as known malware", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.2P.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4"}, {"Substep_Name": "4.B.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe executes rad353F7.ps1"}, {"Substep_Name": "4.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty"}, {"Substep_Name": "4.B.5", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 3 was blocked when fodhelper.exe was terminated, because it was identified as being used to bypass UAC.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_4.B.5P_2.png", "Carbanak-FIN7_PA_4.B.5P_3.png"], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "4.B.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns smrs.exe"}, {"Substep_Name": "4.B.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "smrs.exe opens and reads lsass.exe"}], "Test_Screenshots": []}, {"Test_Num": 4, "Test_Group": "Carbanak", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity all on bankfileserver (10.0.0.7) to bankdc (10.0.0.4) as user kmitnick", "Substeps": [{"Substep_Name": "5.C.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 4 was blocked when runtime created a SMB connection, because it was identified as threat activity.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_5.C.1P_4.png"], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick"}, {"Substep_Name": "5.C.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "psexec.py connects to SMB shares on 10.0.0.4"}, {"Substep_Name": "5.C.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\"}, {"Substep_Name": "5.C.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe is created on 10.0.0.4"}, {"Substep_Name": "5.C.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns tiny.exe"}, {"Substep_Name": "5.C.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe loads shellcode from network connection into memory"}], "Test_Screenshots": []}, {"Test_Num": 5, "Test_Group": "Carbanak", "Test_Name": "Credential Access", "Test_Description": "Activity on cfo (10.0.0.5) as user jsmith", "Substeps": [{"Substep_Name": "9.A.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Also, DefenderUpgradeExec.exe was quarantined, because it was identified as malicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_9.A.1P_3.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4"}, {"Substep_Name": "9.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API"}, {"Substep_Name": "9.B.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 5 was blocked when infosmin48.exe was quarantined, because it was identified as malicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_9.B.1P.png", "Carbanak-FIN7_PA_9.B.1P_1.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4"}, {"Substep_Name": "9.B.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll"}], "Test_Screenshots": []}, {"Test_Num": 11, "Test_Group": "FIN7", "Test_Name": "Initial Access with Embedded VBS in Word Document", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "11.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf"}, {"Substep_Name": "11.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk"}, {"Substep_Name": "11.A.3", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 11 was blocked when winword.exe was terminated, because it attempted to spawn mshta.exe.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_11.A.3P_1.png", "Carbanak-FIN7_PA_11.A.3P.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Criteria": "winword.exe spawns mshta.exe"}, {"Substep_Name": "11.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "mshta.exe executes an embedded VBScript payload"}, {"Substep_Name": "11.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload"}, {"Substep_Name": "11.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe"}, {"Substep_Name": "11.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL"}, {"Substep_Name": "11.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes"}, {"Substep_Name": "12.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe"}, {"Substep_Name": "12.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript"}, {"Substep_Name": "12.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions"}, {"Substep_Name": "12.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration"}, {"Substep_Name": "12.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk"}], "Test_Screenshots": []}, {"Test_Num": 12, "Test_Group": "FIN7", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "15.A.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 12 was blocked when samcat.exe was quarantined, because it was identified as suspicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_15.A.2P_3.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4"}, {"Substep_Name": "15.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4"}, {"Substep_Name": "15.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "15.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "15.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "samcat.exe opens and reads the SAM via LSASS"}, {"Substep_Name": "15.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the GetIpNetTable() API"}, {"Substep_Name": "15.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)"}], "Test_Screenshots": []}, {"Test_Num": 13, "Test_Group": "FIN7", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity from hotelmanager (10.0.1.5) to itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "16.A.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Also, paexec.exe was quarantined, because it was deemed suspicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_16.A.1P.png", "Carbanak-FIN7_PA_16.A.1P_1.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4"}, {"Substep_Name": "16.A.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 13 was blocked when hollow.exe was quarantined, because it was deemed suspicious.", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4"}, {"Substep_Name": "16.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)"}, {"Substep_Name": "16.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed"}, {"Substep_Name": "16.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe"}, {"Substep_Name": "16.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection"}, {"Substep_Name": "16.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "16.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 14, "Test_Group": "FIN7", "Test_Name": "DLL Hijacking", "Test_Description": "Activity on itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "17.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)"}, {"Substep_Name": "17.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library"}, {"Substep_Name": "17.A.4", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 14 was blocked when SystemPropertiesAdvanced.exe failed to execute, because it executed code in the illegitimate srrstr.dll and triggered a \"DLL Search Order Hijacking\" alert.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_17.A.4P_1.png", "Carbanak-FIN7_PA_17.A.4P.png"], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll"}, {"Substep_Name": "17.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "17.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 15, "Test_Group": "FIN7", "Test_Name": "Shim Persistence", "Test_Description": "Activity on accounting (10.0.1.7) as user kmitnick", "Substeps": [{"Substep_Name": "19.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "19.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes base64 encoded commands"}, {"Substep_Name": "19.B.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4"}, {"Substep_Name": "19.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4"}, {"Substep_Name": "19.B.5", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 15 was blocked when sdbinst.exe was terminated, because of a suspicious process creation.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_PA_19.B.5P_1.png", "Carbanak-FIN7_PA_19.B.5P.png"], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "sdbinst.exe installs sdbE376.tmp shim"}, {"Substep_Name": "20.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll"}, {"Substep_Name": "20.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "20.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}]}}]}