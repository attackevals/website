{"Participant_Name": "CrowdStrike", "PublicRelease": "\u00a9 2021 MITRE Engenuity. Approved for Public Release. Document number AT0016", "Aggregate_Data": {"Evaluation_Aggregate_Data": {"Adversaries": [{"Adversary_Name": "apt3", "Display_Name": "APT3", "Evaluation_Year": 2018, "Total_Detections": 208, "Analytic_Detections": 106, "Telemetry_Detections": 102, "Analytic_Coverage": "71/136", "Telemetry_Coverage": "102/136", "Visibility": "105/136", "Total_Procedures_Tested": 136}, {"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Total_Detections": 163, "Analytic_Detections": 47, "Telemetry_Detections": 109, "Analytic_Coverage": "34/134", "Telemetry_Coverage": "109/134", "Visibility": "115/134", "Total_Substeps": 134}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Total_Detections": 231, "Analytic_Detections": 90, "Telemetry_Detections": 141, "Analytic_Coverage": "64/174", "Telemetry_Coverage": "141/174", "Visibility": "152/174", "Total_Substeps": 174, "Linux_Participant": true}]}}, "Adversaries": [{"Adversary_Name": "apt3", "Display_Name": "APT3", "Evaluation_Year": 2018, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "A General Behavior alert for Machine Learning showed that Resume Viewer.exe was executed and that it was detected as malicious.", "Detection_Type": "General Behavior", "Modifiers": [], "Screenshots": ["CS-1.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry within the alert showed that Resume Viewer.exe executed, and would also be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-1.A.1-1.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"Substep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated due to rundll32 launching a suspended process. The alert was mapped to the correct ATT&CK Technique (Rundll32) and Tactic (Defense Evasion).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CS-1.A.1-4.png", "CS-1.A.1-6.png"], "Footnotes": []}, {"Detection_Note": "OverWatch generated a General Behavior alert indicating rundll32 executing update.dat was suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-1.A.1-6.png", "CS-1.A.1-4.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry within the OverWatch alert showed rundll32.exe executing, and would also be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-1.A.1-6.png", "CS-1.A.1-4.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating the execution of pdfhelper.cmd was suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-1.A.1-7.png", "CS-1.A.1-5.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry showed pdfhelper.cmd being executed by cmd.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-1.A.1-5.png", "CS-1.A.1-7.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed Registry activity related to the Startup folder. Though no screenshot of the file write is available, this data maybe indicative of modifications to the folder.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-1.B.1-1.png"], "Footnotes": []}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CS-1.C.1-1.png"], "Footnotes": []}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.004", "Subtechnique_Name": "Application Layer Protocol: DNS"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for abnormally large DNS requests for freegoogleadsenseinfo.com (C2 domain) being sent. The alert was mapped to a related ATT&CK Technique (Exfiltration Over Alternative Protocol) and Tactic (Exfiltration).", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CS-1.C.1-1.png", "CS-1.C.1-2.png", "CS-E-4.png"], "Footnotes": []}, {"Detection_Note": "The OverWatch team also sent an email indicating a Specific Behavior occurred because they observed suspected command and control or data exfiltration via DNS.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-1.C.1-2.png", "CS-E-4.png", "CS-1.C.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "OverWatch also generated a General Behavior alert indicating the DNS traffic was suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-1.C.1-1.png", "CS-E-4.png", "CS-1.C.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry within the OverWatch alert showed the DNS requests, and would also be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-1.C.1-2.png", "CS-1.C.1-1.png", "CS-E-4.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1132", "Technique_Name": "Data Encoding"}, "Subtechnique": {"Subtechnique_Id": "T1132.001", "Subtechnique_Name": "Data Encoding: Standard Encoding"}, "Detections": [{"Detection_Note": "Telemetry showed the base64-encoded DNS requests for freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the parent Exfiltration alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-1.C.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Initial Discovery", "Substeps": [{"Substep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because ipconfig was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.A.1-1.png", "CS-E-3.png", "CS-2.A.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing ipconfig with command-line arguments. The process tree showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran ipconfig) were considered tainted and suspicious.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-3.png", "CS-2.A.1-1.png", "CS-2.A.1-2.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because arp was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.A.2-1.png", "CS-2.A.1-1.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing arp with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran arp) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-3.png", "CS-2.A.1-1.png", "CS-2.A.2-1.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because echo was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.B.1-1.png", "CS-2.A.1-1.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing echo with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran echo) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.B.1-1.png", "CS-E-3.png", "CS-2.A.1-1.png"], "Footnotes": []}]}, {"Substep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "2.C.2", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because tasklist was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.B.1-1.png", "CS-E-3.png", "CS-2.A.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing tasklist with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran tasklist) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-3.png", "CS-2.A.1-1.png", "CS-2.B.1-1.png"], "Footnotes": []}]}, {"Substep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because sc query was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-3.png", "CS-2.B.1-1.png", "CS-2.A.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing sc with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran sc) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.B.1-1.png", "CS-2.A.1-1.png", "CS-E-3.png"], "Footnotes": []}]}, {"Substep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.A.1-1.png", "CS-2.D.2-1.png"], "Footnotes": []}]}, {"Substep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch also generated a General Behavior alert indicating systeminfo execution was suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.E.1-1.png", "CS-2.A.1-1.png", "CS-2.D.2-1.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because systeminfo was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-3.png", "CS-2.A.1-1.png", "CS-2.D.2-1.png", "CS-2.E.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing systeminfo. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran systeminfo) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.A.1-1.png", "CS-2.E.1-1.png", "CS-2.D.2-1.png", "CS-E-3.png"], "Footnotes": []}]}, {"Substep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because net config was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.A.1-1.png", "CS-E-3.png", "CS-2.D.2-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.D.2-1.png", "CS-2.A.1-1.png", "CS-E-3.png"], "Footnotes": []}]}, {"Substep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "OverWatch also generated a General Behavior alert indicating net localgroup execution was suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.F.1-3.png", "CS-2.A.1-1.png", "CS-2.F.1-1.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because net localgroup was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-3.png", "CS-2.F.1-3.png", "CS-2.A.1-1.png", "CS-2.F.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-3.png", "CS-2.F.1-1.png", "CS-2.A.1-1.png", "CS-2.F.1-3.png"], "Footnotes": []}]}, {"Substep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net localgroup was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.F.1-1.png", "CS-E-3.png", "CS-2.A.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.F.1-1.png", "CS-E-3.png", "CS-2.A.1-1.png"], "Footnotes": []}]}, {"Substep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \\\"Domain Admins\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.A.1-1.png", "CS-2.F.1-1.png", "CS-2.F.1-2.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "The capability showed cmd.exe executing net.exe with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The enrichment was tainted by a previous detection.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.F.1-1.png", "CS-2.A.1-1.png", "CS-E-3.png", "CS-2.F.1-2.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.F.1-1.png", "CS-E-3.png", "CS-2.A.1-1.png", "CS-2.F.1-2.png"], "Footnotes": []}]}, {"Substep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net.exe) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-2.G.1-1.png", "CS-2.A.1-1.png"], "Footnotes": []}]}, {"Substep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net user was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-2.A.1-1.png", "CS-2.G.1-1.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing net with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran net) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-3.png", "CS-2.G.1-1.png", "CS-2.A.1-1.png"], "Footnotes": []}]}, {"Substep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because reg query was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-3.png", "CS-2.G.1-1.png", "CS-2.A.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe executing reg with command-line arguments. The process tree view showed that all children cmd.exe processes under the parent rundll32.exe (including the one that ran reg) were considered tainted.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-3.png", "CS-2.G.1-1.png", "CS-2.A.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Privilege Escalation", "Substeps": [{"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed an integrity level change for user Debbie from 8192 (0x2000/Medium) to 12288 (0x3000/High), which is indicative of bypassing UAC.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-3.A.1-1.png"], "Footnotes": []}]}, {"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.001", "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated showing that PowerShell created a thread into a remote process. The alert identified the correct ATT&CK Technique (Process Injection) and Tactic (Defense Evasion). The process tree view showed the alert as tainted by parent svchost.exe and powershell.exe detections.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CS-3.C.1-2.png", "CS-3.C.1-1.png"], "Footnotes": []}, {"Detection_Note": "OverWatch also generated a General Behavior alert identifying the injection as suspicious. The process tree view showed the alert as tainted by previous svchost.exe and powershell.exe detections.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed", "Tainted"], "Screenshots": ["CS-3.C.1-2.png", "CS-3.C.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry associated with the alert would show thread creation in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-3.C.1-2.png", "CS-3.C.1-1.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}]}, {"Step_Num": 4, "Step_Name": "Discovery for Lateral Movement", "Substeps": [{"Substep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \\\"Domain Controllers\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch also generated a General Behavior alert identifying cmd.exe executing net as suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-4.A.1-1.png", "CS-4.A.1-2.png", "CS-4.A.1-3.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-4.A.1-2.png", "CS-E-3.png", "CS-4.A.1-1.png", "CS-4.A.1-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "The capability showed net.exe executing with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["CS-4.A.1-3.png", "CS-4.A.1-2.png", "CS-4.A.1-1.png", "CS-E-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry within the enrichment showed net.exe executing with command-line arguments, and would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-4.A.1-1.png", "CS-4.A.1-3.png", "CS-4.A.1-2.png", "CS-E-3.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"Substep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \\\"Domain Computers\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because net group was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-3.png", "CS-4.A.2-2.png", "CS-4.A.2-1.png", "CS-4.A.2-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "The OverWatch team identified net group as suspicious with a General Behavior alert.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-4.A.2-1.png", "CS-4.A.2-3.png", "CS-4.A.2-2.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The capability showed net.exe executing with command-line arguments and enriched the command with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["CS-4.A.2-2.png", "CS-4.A.2-1.png", "CS-E-3.png", "CS-4.A.2-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry within the enrichment showed net.exe with command-line arguments, and would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-3.png", "CS-4.A.2-1.png", "CS-4.A.2-2.png", "CS-4.A.2-3.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"Substep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating the execution of netsh by cmd.exe was suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-3.png", "CS-4.B.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because netsh was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-4.B.1-1.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry within the OverWatch alert showed netsh executing with command-line arguments, and would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-3.png", "CS-4.B.1-1.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating cmd.exe executing netstat with command-line arguments was suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-3.png", "CS-4.C.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because netstat was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-4.C.1-1.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry within the OverWatch alert showed cmd.exe executing netstat with command-line arguments, and would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-4.C.1-1.png", "CS-E-3.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}]}, {"Step_Num": 5, "Step_Name": "Credential Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for Credential Dumping, which indicated \\\"a DLL was detected as being reflectively loaded in the callstack.\\\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CS-5.A.1-6.png"], "Footnotes": []}, {"Detection_Note": "A General Behavior alert was generated by the OverWatch team indicating the Credential Dumping activity was suspicious. The process tree view showed the alert as tainted by a parent detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": ["CS-5.A.1-6.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry showing the lsass handle open and DLL loading would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-5.A.1-6.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"Substep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched several event types with descriptions, including for a remote process opening a handle to lsass and a DLL being reflectively loaded (ReflectiveDllOpenLsass), as well as an lsass process accessed (ProcessHollowingDetected).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["CS-5.A.1-8.png"], "Footnotes": []}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "A second Specific Behavior alert was generated for Credential Dumping, which indicated that \\\"a remote thread in LSASS accessed credential registry keys.\\\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CS-5.A.2-1.png", "CS-5.A.2-4.png"], "Footnotes": []}, {"Detection_Note": "A Specific Behavior alert was generated for Credential Dumping, which indicated \\\"a DLL was detected as being reflectively loaded in the callstack.\\\" The alert was mapped to the correct ATT&CK Technique (Credential Dumping) and Tactic (Credential Access). The process tree view showed the alert as tainted by a parent detection.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CS-5.A.2-1.png", "CS-5.A.2-4.png"], "Footnotes": []}, {"Detection_Note": "OverWatch also generated a General Behavior alert indicating the Credential Dumping activity was suspicious. The process tree view showed the alert as tainted by a previous detection.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed", "Tainted"], "Screenshots": ["CS-5.A.2-4.png", "CS-5.A.2-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry for the lsass remote thread and DLL loading would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-5.A.2-1.png", "CS-5.A.2-4.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not specifically taken in this instance."]}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The capability enriched several event types with descriptions, including for a remote process opening a handle to lsass and a DLL being reflectively loaded (ReflectiveDllOpenLsass), malicious process hollowing (ProcessHollowingDetected), and a remote process injecting code into lsass (LsassInjectedCode).", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["CS-5.A.2-5.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.001", "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft"}, "Detections": [{"Detection_Note": "Telemetry showed the compromised process (21898821890) running as Debbie, then children from this process spawning first as Debbie and later as George. This could indicate theft of George's token within the context of the process.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-5.B.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Lateral Movement", "Substeps": [{"Substep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating the reg query command was suspicious. The alert was tainted by the parent cmd.exe process.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed", "Tainted"], "Screenshots": ["CS-6.A.1-2.png", "CS-6.A.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by the parent cmd.exe process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-6.A.1-1.png", "CS-6.A.1-2.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a connection over TCP port 80 to 192.168.0.4 (C2 server).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-6.C.1-1.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1026", "Technique_Name": "Multiband Communication"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed connections over both DNS and TCP port 80, which could indicate multiband communication. The DNS connections were tainted by a parent Exfiltration alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-6.C.1-1.png", "CS-1.C.1-2.png"], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because they identified suspicious communications over port 3389 (RDP) to other hosts.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-1.png", "CS-6.C.1-3.png", "CS-6.C.1-5.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed a connection for logon type 10 (interactive logon) and a connection to 10.0.0.5 (Conficker) over TCP port 3389.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-6.C.1-5.png", "CS-6.C.1-3.png", "CS-E-1.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed the creation of the user Jesse and the user being added to the domain admin group.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-7.A.1-3.png", "CS-7.A.1-1.png", "CS-7.A.1-2.png"], "Footnotes": []}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1061", "Technique_Name": "Graphical User Interface"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-6.C.1-4.png"], "Footnotes": []}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.001", "Subtechnique_Name": "Account Discovery: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-6.C.1-4.png"], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file write for updater.dll into the system32 folder by user George. The telemetry was tainted by the parent \\\\\"unexpected process\\\\\" alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-7.B.1-1.png", "CS-7.B.1-2.png"], "Footnotes": []}]}, {"Substep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a scheduled task was created for persistence.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-7.C.1-2.png", "CS-E-4.png", "CS-7.C.1-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "OverWatch generated a General Behavior alert indicating the creation of the scheduled task was suspicious. The process tree view showed the alert as tainted by a previous cmd.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed", "Tainted"], "Screenshots": ["CS-7.C.1-2.png", "CS-7.C.1-3.png", "CS-E-4.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry showed the creation of the scheduled task.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-7.C.1-2.png", "CS-E-4.png", "CS-7.C.1-3.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Collection", "Substeps": [{"Substep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \\\"\\\\conficker\\wormshare\\\"' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe running dir. The process tree view showed the cmd.exe process that ran dir as tainted by a prior detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-8.A.1-2.png", "CS-8.A.1-1.png"], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \\\"C:\\Users\\debbie\\\"' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating tree.com was suspicious. The process tree view showed the alert as tainted by a previous cmd.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": ["CS-8.A.2-2.png", "CS-8.A.1-1.png", "CS-8.A.1-2.png", "CS-E-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was identified because tree was one of the reconnaissance commands performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-3.png", "CS-8.A.1-1.png", "CS-8.A.1-2.png", "CS-8.A.2-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed cmd.exe running tree with command-line arguments. The process tree view also showed the cmd.exe that was the parent for tree.com as tainted by a prior detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-3.png", "CS-8.A.1-1.png", "CS-8.A.1-2.png", "CS-8.A.2-2.png"], "Footnotes": []}]}, {"Substep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CS-8.C.1-1.png"], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1010", "Technique_Name": "Application Window Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CS-8.D.1-2.png"], "Footnotes": []}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed InjectedThread events for explorer.exe (pid=21776848613) injecting from cmd.exe (pid=21898821890), which is a known beacon.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-8.D.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1039", "Technique_Name": "Data from Network Shared Drive"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Criteria": "", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Execution of Persistence", "Substeps": [{"Substep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe running autoupdate.bat from the Startup folder.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-10.A.1-1.png"], "Footnotes": []}]}, {"Substep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe starting updater.dll. The telemetry was tainted by the parent OverWatch alert.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-10.A.2-2.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.003", "Subtechnique_Name": "Valid Accounts: Local Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a type 10 (interactive) UserLogon event for Jesse.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-10.B.1-1.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior occurred because they observed suspicious communications over 3389 (RDP) to other hosts.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-10.B.1-1.png", "CS-E-1.png", "CS-10.B.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed the remote connection to Conficker for a user logon by Jesse with type 10 (interactive) as well as the use of rdpclip.exe by the logged-on user.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-1.png", "CS-10.B.1-1.png", "CS-10.B.1-2.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated indicating \\\"A PowerShell script launched that shares characteristics with known PowerShell exploit kits.\\\"", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CS-E-6.png", "CS-11.A.1-2.png", "CS-11.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a malicious script invoked by wscript was run by Bob on CodeRed and launched PowerShell.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-11.A.1-1.png", "CS-11.A.1-2.png", "CS-E-6.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "A General Behavior alert was generated from OverWatch indicating wscript.exe executing launcher.vbs was suspicious.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-6.png", "CS-11.A.1-1.png", "CS-11.A.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry within the OverWatch alert showed wscript.exe executing launcher.vbs, and would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-11.A.1-2.png", "CS-E-6.png", "CS-11.A.1-1.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe making connection to 192.168.0.5 (C2 server) over port 443. The telemetry was tainted by an alert on its parent powershell.exe process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-11.B.1-1.png"], "Footnotes": []}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CS-11.B.1-1.png"], "Footnotes": []}]}, {"Substep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CS-11.B.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 12, "Step_Name": "Initial Discovery", "Substeps": [{"Substep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because route print was part of the basic reconnaissance activity performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-6.png", "CS-12.A.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed powershell.exe executing route.exe with command-line arguments. The process tree view showed route.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-6.png", "CS-12.A.1-1.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because ipconfig was part of the basic reconnaissance activity performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-6.png", "CS-12.A.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The process tree view showed ipconfig.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-12.A.1-2.png", "CS-E-6.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating whoami.exe with command-line arguments was suspicious. The process tree view showed whoami.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": ["CS-E-6.png", "CS-12.B.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because whoami was part of the basic reconnaissance activity performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-12.B.1-1.png", "CS-E-6.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry within the OverWatch alert showed powershell.exe executing whoami.exe with command-line arguments, and would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-12.B.1-1.png", "CS-E-6.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating qprocess.exe with command-line arguments was suspicious. The process tree view showed qprocess.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed", "Tainted"], "Screenshots": ["CS-E-6.png", "CS-12.C.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because qprocess was part of the basic reconnaissance activity performed performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-12.C.1-1.png", "CS-E-6.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry within the OverWatch alert showed execution of qprocess.exe with command-line arguments, and would be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-6.png", "CS-12.C.1-1.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net start was part of the basic reconnaissance activity performed performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-6.png", "CS-12.D.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe and net1.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-6.png", "CS-12.D.1-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "The OverWatch team also sent an email indicating they identified a Specific Behavior for an unidentified PowerShell script running.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-12.E.1-3.png", "CS-12.E.1-1.png", "CS-12.E.1-4.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "The OverWatch team generated a Specific Behavior alert indicating the PowerShell script was malicious.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-12.E.1-3.png", "CS-12.E.1-1.png", "CS-12.E.1-4.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry showed the PowerShell script (.ps1) being written to the temp folder.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-12.E.1-1.png", "CS-12.E.1-4.png", "CS-12.E.1-3.png"], "Footnotes": []}]}, {"Substep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1201", "Technique_Name": "Password Policy Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CS-12.E.1.5-1.png", "CS-12.E.1.5-3.png", "CS-12.E.1-2.png"], "Footnotes": []}]}, {"Substep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry from decoded PowerShell (within the capability) showed the Get-Sysinfo function.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-12.E.1.6.1-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry from decoded PowerShell (within the capability) showed the Get-Sysinfo function.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-12.E.1.6.1-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments. The process tree view showed netstat.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-12.E.12-2.png"], "Footnotes": []}]}, {"Substep": "12.F.1", "Procedure": "Empire: 'net group \\\"Domain Admins\\\" -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net group was part of additional malicious discovery performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-12.F.1-1.png", "CS-E-8.png", "CS-12.F.1-3.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CS-12.F.1-3.png", "CS-E-8.png", "CS-12.F.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-12.F.1-3.png", "CS-E-8.png", "CS-12.F.1-1.png"], "Footnotes": []}]}, {"Substep": "12.F.2", "Procedure": "Empire: 'Net Localgroup Administrators' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net localgroup was part of additional malicious discovery performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-8.png", "CS-12.F.2-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-8.png", "CS-12.F.2-1.png"], "Footnotes": []}]}, {"Substep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.001", "Subtechnique_Name": "Account Discovery: Local Account"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net user was part of additional malicious discovery performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-8.png", "CS-12.G.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-12.G.1-1.png", "CS-E-8.png"], "Footnotes": []}]}, {"Substep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net user was part of additional malicious discovery performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-8.png", "CS-12.G.2-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-12.G.2-1.png", "CS-E-8.png"], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Discovery for Lateral Movement", "Substeps": [{"Substep": "13.A.1", "Procedure": "Empire: 'net group \\\"Domain Computers\\\" -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net group was part of additional malicious discovery performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-8.png", "CS-13.A.1-2.png", "CS-13.A.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery) and the correct Tactic (Discovery). The process tree view showed the enrichment was tainted by a previous powershell.exe detection.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["CS-13.A.1-1.png", "CS-13.A.1-2.png", "CS-E-8.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-8.png", "CS-13.A.1-2.png", "CS-13.A.1-1.png"], "Footnotes": []}]}, {"Substep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because net use was part of additional malicious discovery performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-13.B.1-1.png", "CS-E-8.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-8.png", "CS-13.B.1-1.png"], "Footnotes": []}]}, {"Substep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because netstat was part of additional malicious discovery performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-8.png", "CS-13.B.2-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed netstat.exe executing with command-line arguments. The process tree view showed netstat.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-13.B.2-1.png", "CS-E-8.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Empire:'reg query' via PowerShell to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert identifying reg.exe execution as suspicious. The alert was tainted by a parent powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": ["CS-13.C.1-4.png", "CS-13.C.1-3.png", "CS-E-8.png", "CS-13.C.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because reg query was part of additional malicious discovery performed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-13.C.1-4.png", "CS-E-8.png", "CS-13.C.1-3.png", "CS-13.C.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed reg.exe executing with command-line arguments. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-13.C.1-3.png", "CS-E-8.png", "CS-13.C.1-4.png", "CS-13.C.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Privilege Escalation", "Substeps": [{"Substep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "The OverWatch team also sent an email indicating a Specific Behavior was observed because a base64 obfuscated PowerShell command was used to invoke UAC bypass.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-14.A.1-4.png", "CS-E-8.png", "CS-14.A.1-9.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed an integrity level change through a query for powershell.exe processes of high integrity (12288/0x3000) that were created by medium integrity processes (8192/0x2000), which is indicative of bypassing UAC. Telemetry also showed the Invoke-BypassUACTokenManipulation function in the script.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-8.png", "CS-14.A.1-9.png", "CS-14.A.1-4.png"], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was observed because PowerShell retrieved the file wdbypass from www.freegoogleadsenseinfo.com (C2 domain) over port 8080.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-11.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CS-14.A.1-7.png", "CS-14.A.1-6.png"], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a network connection event to 192.168.0.5 (C2 server) on TCP port 8080 that was associated with the encoded PowerShell IEX command.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-14.A.1-5.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Credential Access", "Substeps": [{"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was identified because they observed the adversary logging keystrokes based on the GetKeystrokes PowerShell function.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-15.A.1-2.png", "CS-E-8.png", "CS-E-12.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed the decoded PowerShell script, which displayed the function Get-Keystrokes.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-8.png", "CS-E-12.png", "CS-15.A.1-2.png"], "Footnotes": []}]}, {"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1010", "Technique_Name": "Application Window Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the decoded PowerShell script, which displayed the API call GetForegroundWindow to enumerate the active window.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-15.A.1-2.png"], "Footnotes": []}]}, {"Substep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because IT_tasks.txt was retrieved from a network share as a file of interest.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-15.B.1-1.png", "CS-15.B.1-2.png", "CS-E-12.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed a file read event for IT_tasks.txt by powershell.exe as well as a FsPostOpen event indicating IT_tasks.txt was opened.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-12.png", "CS-15.B.1-1.png", "CS-15.B.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Lateral Movement", "Substeps": [{"Substep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of usersKmitnick, Bob, and Frieda", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "OverWatch generated General Behavior alerts indicating the net use commands were suspicious. The alerts were tainted by a parent powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": ["CS-16.A.1-2.png", "CS-E-10.png", "CS-16.A.1-1.png", "CS-16.A.1-3.png", "CS-16.A.1-4.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally using several accounts.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-16.A.1-3.png", "CS-16.A.1-1.png", "CS-E-10.png", "CS-16.A.1-2.png", "CS-16.A.1-4.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying, including details that the logons were for local admin (type 6) and that they failed.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-16.A.1-3.png", "CS-16.A.1-4.png", "CS-16.A.1-2.png", "CS-E-10.png", "CS-16.A.1-1.png"], "Footnotes": []}]}, {"Substep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "OverWatch generated General Behavior alerts indicating the net use commands attempting logon to ADMIN$ shares were suspicious. The alerts were tainted by a parent powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed", "Tainted"], "Screenshots": ["CS-E-10.png", "CS-16.A.1-1.png", "CS-16.A.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-10.png", "CS-16.A.1-2.png", "CS-16.A.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed repeated logon attempts via net.exe with command-line arguments targeting ADMIN$ shares on the machines 10.0.1.4 (Morris) and 10.0.1.6 (Nimda).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-16.A.1-1.png", "CS-E-10.png", "CS-16.A.1-2.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.003", "Subtechnique_Name": "Valid Accounts: Local Accounts"}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating the successful net use connection was suspicious. The alert was tainted by a parent powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": ["CS-16.B.1-1.png", "CS-16.B.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a parent powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-16.B.1-1.png", "CS-16.B.1-2.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating the successful net use connection to ADMIN$ was suspicious. The alert was tainted by a parent powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": ["CS-E-10.png", "CS-16.B.1-1.png", "CS-16.B.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-16.B.1-2.png", "CS-E-10.png", "CS-16.B.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect to ADMIN$ on 10.0.0.5 (Conficker) as the user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-16.B.1-2.png", "CS-E-10.png", "CS-16.B.1-1.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "OverWatch generated a General Behavior alert indicating the successful net use connection was suspicious. The alert was tainted by a parent powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": ["CS-16.B.1-1.png", "CS-16.B.1-2.png", "CS-E-10.png"], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "The OverWatch team also sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally using several accounts.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-16.B.1-1.png", "CS-16.B.1-2.png", "CS-E-10.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments to connect as the user Kmitnick (following multiple failed net use attempts). The telemetry was tainted by a parent powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-10.png", "CS-16.B.1-2.png", "CS-16.B.1-1.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.005", "Subtechnique_Name": "Indicator Removal on Host: Network Share Connection Removal"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because the user Bob removed an artifact for the ADMIN$ share.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-10.png", "CS-16.C.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed net.exe executing with command-line arguments. The telemetry was tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-10.png", "CS-16.C.1-1.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because the user Bob attempted to move laterally to access resources on the network.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-10.png", "CS-16.D.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed a logon attempt via net.exe with command-line arguments to the C$ share on 10.0.0.4 (Creeper) as the user Kmitnick. The telemetry was tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-10.png", "CS-16.D.1-2.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a logon attempt via net.exe with command-line arguments to the C$ share on Creeper as the user Kmitnick. The process tree view showed net.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-16.D.1-2.png"], "Footnotes": []}]}, {"Substep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because a .vbs was written to the filesystem, which was likely used to carry out additional actions.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-16.E.1-1.png", "CS-E-10.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed File Write and New Script Write events for autoupdate.vbs under powershell.exe. The telemetry was tainted by a previous detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-10.png", "CS-16.E.1-1.png"], "Footnotes": []}]}, {"Substep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a new cmd.exe process running wscript.exe as user Kmitnick, which then launched powershell.exe. The command line arguments for cmd.exe showed that autoupdate.vbs was run. The telemetry was tainted by a previous detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-16.F.1-1.png", "CS-16.F.1-2.png"], "Footnotes": []}]}, {"Substep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed update.vbs written to the C$ remote share on host 10.0.0.4 (Creeper).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-16.G.1-1.png"], "Footnotes": []}]}, {"Substep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was observed because the user Bob was querying for a particular service on Creeper.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-11.png", "CS-16.H.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed execution of sc.exe to query services on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-16.H.1-1.png", "CS-E-11.png"], "Footnotes": []}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating they observed a General Behavior because newly created file (AdobeUpdater service in registry) established persistence on the host.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-16.H.1-2.png", "CS-E-11.png", "CS-16.H.1-4.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed sc.exe executing with command-line arguments for a new service called AdobeUpdater with binPath pointed to cmd.exe with arguments to execute update.vbs and service description \\\\\"Synchronize with Adobe for security updates.\\\\\" The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-11.png", "CS-16.H.1-4.png", "CS-16.H.1-2.png"], "Footnotes": []}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.004", "Subtechnique_Name": "Masquerading: Masquerade Task or Service"}, "Detections": [{"Detection_Note": "Telemetry showed sc.exe executing with command-line arguments for a new service called AdobeUpdater with binPath pointed to cmd.exe with arguments to execute update.vbs and service description \\\\\"Synchronize with Adobe for security updates.\\\\\". An analyst could use this information to determine it is not a legitimate service. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-16.H.1-4.png", "CS-16.H.1-3.png"], "Footnotes": []}]}, {"Substep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating they observed a Specific Behavior because the user Bob queried for a particular service on Creeper.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-11.png", "CS-16.J.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed sc.exe executing with command-line arguments to query the AdobeUpdater service on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-11.png", "CS-16.J.1-1.png"], "Footnotes": []}]}, {"Substep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating they observed a Specific Behavior because update.vbs executed following the start of the AdobeUpdater service.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-16.L.1-1.png", "CS-E-11.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed sc.exe executing with command-line arguments to start the AdobeUpdater service on Creeper. The process tree view showed sc.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-E-11.png", "CS-16.L.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Persistence", "Substeps": [{"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed reg.exe executing with command-line arguments to check if terminal services are enabled. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-17.A.1-1.png"], "Footnotes": []}]}, {"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed reg.exe executing with command-line arguments. The process tree view showed reg.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-17.A.1-1.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1222", "Technique_Name": "File and Directory Permissions Modification"}, "Subtechnique": {"Subtechnique_Id": "T1222.001", "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because takeown.exe was executed to bypass Windows logon.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-11.png", "CS-17.B.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed takeown.exe executing with command-line arguments. The process tree view showed takeown.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-17.B.1-1.png", "CS-E-11.png"], "Footnotes": []}]}, {"Substep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1222", "Technique_Name": "File and Directory Permissions Modification"}, "Subtechnique": {"Subtechnique_Id": "T1222.001", "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a General Behavior was observed because icacls.exe was executed to bypass Windows logon.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-17.B.2-1.png", "CS-E-11.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed execution of icacls.exe with command-line arguments. The process tree view showed icacls.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-17.B.2-1.png", "CS-E-11.png"], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.008", "Subtechnique_Name": "Event Triggered Execution: Accessibility Features"}, "Detections": [{"Detection_Note": "Telemetry showed a file write of magnify.exe by powershell.exe in the system directory. The telemetry was tainted by an alert on its parent powershell.exe process.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-17.C.1-2.png", "CS-17.C.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 18, "Step_Name": "Collection", "Substeps": [{"Substep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.002", "Subtechnique_Name": "Data Staged: Remote Data Staging"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was observed the .vsdx file being copied to the Recycle Bin, a \\\\\"likely location to stage files of interest.\\\\\"", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-12.png", "CS-18.B.1-1.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed the .vsdx file being written into the Recycle Bin.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-12.png", "CS-18.B.1-1.png"], "Footnotes": []}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1039", "Technique_Name": "Data from Network Shared Drive"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 19, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the SHA256 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-19.A.1-2.png"], "Footnotes": []}]}, {"Substep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file write of recycler.exe by powershell.exe as well as the network connection over which the download occurred. The process tree view showed the parent powershell.exe process as tainted by a previous wscript.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-19.A.1-3.png", "CS-19.A.1-1.png"], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated for a RAR archive \\\"written by a process with suspicious command line arguments.\\\" The alert showed the command-line details and was tagged with the correct ATT&CK Technique (Data Compressed) and Tactic (Exfiltration). The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"Detection_Note": "The OverWatch team sent an email indicating they observed a Specific Behavior because a .vsdx file was archived for likely exfiltration using the renamed RAR binary, recycler.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was created for a RAR archive \\\"written by a process with suspicious command line arguments.\\\" Details showed the flags -hp within the command line that indicated use of encryption, and the alert was mapped to a related ATT&CK Technique (Data Compressed) and the correct Tactic (Exfiltration). The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}, {"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was observed because a .vsdx file was archived for likely exfiltration using the renamed WinRAR binary, recycler.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Specific Behavior alert was created for a RAR archive \\\"written by a process with suspicious command line arguments.\\\". Details showed that recycler.exe wrote a RAR archive and that recycler.exe was signed by win.rar GmbH. The process tree view showed the recycler.exe alert as tainted by a previous powershell.exe detection.", "Detection_Type": "Specific Behavior", "Modifiers": ["Tainted"], "Screenshots": ["CS-19.B.1-1.png", "CS-19.B.1-3.png", "CS-E-12.png"], "Footnotes": []}, {"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was observed because a .vsdx file was archived for likely exfiltration using the renamed WinRAR binary, recycler.exe.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-19.B.1-3.png", "CS-19.B.1-1.png", "CS-E-12.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry within the alert showed the command-line details for the execution of recycler.exe, and would also be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-19.B.1-3.png", "CS-19.B.1-1.png", "CS-E-12.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Criteria": "", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was observed because collected files were exfiltrated via FTP.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": [], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "OverWatch generated a General Behavior alert indicating ftp.exe executing with ftp.txt was suspicious. The process tree view showed ftp.exe as tainted by a previous powershell.exe detection.", "Detection_Type": "General Behavior", "Modifiers": ["Tainted", "Delayed"], "Screenshots": [], "Footnotes": ["OverWatch is the managed threat hunting service."]}, {"Detection_Note": "Telemetry within the OverWatch alert showed ftp.exe executing with ftp.txt.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "19.D.1", "Procedure": "Empire: 'del C:\\\\\"$\\\"Recycle.bin\\old.rar'", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was observed because files (including old.rar) were deleted from the host CodeRed.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-19.D.1-1.png", "CS-E-12.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed the deletion of old.rar with an event name of FileDeleted.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-19.D.1-1.png", "CS-E-12.png"], "Footnotes": []}]}, {"Substep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "The OverWatch team sent an email indicating a Specific Behavior was observed because files (including recycler.exe) were deleted from the host CodeRed.", "Detection_Type": "Specific Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-E-12.png", "CS-19.D.1-2.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry showed the deletion of recycler.exe with an event name of ExecutableDeleted.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-12.png", "CS-19.D.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 20, "Step_Name": "Execution of Persistence", "Substeps": [{"Substep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.008", "Subtechnique_Name": "Event Triggered Execution: Accessibility Features"}, "Detections": [{"Detection_Note": "A Specific Behavior alert was generated on utilman.exe executing magnify.exe, noting that \\\"a process chain bypassed Windows logon security.\\\" The alert was marked critical and was mapped to the correct ATT&CK Technique (Accessibility Features) and Tactic (Persistence). Data in the alert also showed that magnify.exe was identified as cmd.exe based on hash value in the common name field.", "Detection_Type": "Specific Behavior", "Modifiers": [], "Screenshots": ["CS-20.A.1-1.png", "CS-E-12.png", "CS-20.A.1-2.png"], "Footnotes": []}, {"Detection_Note": "OverWatch generated a General Behavior alert indicating a Windows logon bypass on Creeper was observed.", "Detection_Type": "General Behavior", "Modifiers": ["Delayed"], "Screenshots": ["CS-20.A.1-2.png", "CS-20.A.1-1.png", "CS-E-12.png"], "Footnotes": ["OverWatch is the managed threat hunting service. The team sent emails to MITRE to mimic what they would send in a real incident."]}, {"Detection_Note": "Telemetry within the alert showed the details for magnify.exe, and would also be available in a separate view.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-E-12.png", "CS-20.A.1-2.png", "CS-20.A.1-1.png"], "Footnotes": ["For any alert in the user interface, the telemetry behind it is separately available in the capability. This is counted as a separate detection because the functionality was shown to MITRE throughout the evaluation, though a screenshot was not taken in this instance."]}]}, {"Substep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed a logon type 10 (remote interactive logon) for Kmitnick on Creeper, indicating a RDP session was established and logged into.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CS-20.A.1-3.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of whoami.exe. The process tree view showed whoami.exe was tainted by a previous magnify.exe detection.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["CS-20.B.1-1.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "A General alert detection (yellow indicator) was generated for a suspicious file meeting the sensor's low-confidence threshold for a malicious file.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10176.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for the suspicious execution of the rcs.3aka3.doc file.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CrowdStrike-APT29-10184.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10179.png"], "Footnotes": []}]}, {"Substep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.002", "Subtechnique_Name": "Masquerading: Right-to-Left Override"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) called \"Masquerading\" was generated when an executable ran containing a RTLO character.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10177.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was received that included details of the file rcs.3aka3.doc and identified it as an portable executable.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CrowdStrike-APT29-10183.png", "CrowdStrike-APT29-10188.png"], "Footnotes": []}]}, {"Substep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CrowdStrike-APT29-10190.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10192.png"], "Footnotes": []}]}, {"Substep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.001", "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-15010.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10196.png"], "Footnotes": []}]}, {"Substep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A General alert detection (yellow indicator) was generated when powershell.exe spawned from cmd.exe. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detection_Type": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10204.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10204.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing ChildItem.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10208.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP alert was generated when a portable executable file used a script to collected various filetypes found on the filesystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CrowdStrike-APT29-10262.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing ChildItem.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10208.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (purple hexagon) called \"Automated Collection\" was generated when powershell.exe executed an automated search routine with Get-ChildItem. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CrowdStrike-APT29-10205.png"], "Footnotes": []}]}, {"Substep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file opens of C:\\Users\\Pam\\*. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10221.png"], "Footnotes": []}]}, {"Substep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing Compress-Archive", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10216.png"], "Footnotes": []}]}, {"Substep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed file creation of Draft.zip.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10759.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10192.png", "CrowdStrike-APT29-10254.png"], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Deploy Stealth Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed rcs.3aka3.doc reading file monkey.png. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10256.png"], "Footnotes": []}]}, {"Substep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within monkey.png", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.003", "Subtechnique_Name": "Obfuscated Files or Information: Steganography"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-15011.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}, {"Detection_Note": "A Technique alert (high severity) was generated for PowerShell using obfuscation. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10259.png"], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10257.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed control.exe creating a high integrity powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10272.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection (purple hexagon) called \"Defense Evasion\" was generated when a process reflectively loaded a DLL associated with meterpreter using the PowerShell payload. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CrowdStrike-APT29-10261.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (purple hexagon) called \"Bypass User Account Control\" was generated when control.exe spawned an elevated PowerShell payload. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10265.png"], "Footnotes": []}]}, {"Substep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.  The event was correlated to a parent technique detection for Bypass User Account Control of control.exe spawning powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10275.png"], "Footnotes": []}, {"Detection_Note": "An MSSP report showed sdclt.exe spawned a process that connected to 192.168.0.5 on port 443.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CrowdStrike-APT29-10285.png"], "Footnotes": []}]}, {"Substep": "3.B.4", "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the deletion of the command subkey. The event was correlated to a parent technique detection for Bypass User Account Control of control.exe spawning powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10282.png"], "Footnotes": []}]}]}, {"Step_Num": 4, "Step_Name": "Clean Up and Reconnaissance", "Substeps": [{"Substep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10291.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10290.png"], "Footnotes": []}]}, {"Substep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The event was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10293.png", "CrowdStrike-APT29-10295.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10298.png"], "Footnotes": []}]}, {"Substep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) for \"File Deletion\" was generated due to sdelete64.exe deleting rcs.3aka3.doc. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CrowdStrike-APT29-10360.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename events. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10296.png", "CrowdStrike-APT29-10328.png"], "Footnotes": []}]}, {"Substep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for user execution of Draft.zip.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10296.png"], "Footnotes": []}]}, {"Substep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed file rename and delete operations from sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert for user execution of SysinternalsSuite.zip.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10296.png"], "Footnotes": []}]}, {"Substep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing $env:TEMP", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10306.png", "CrowdStrike-APT29-10305.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10306.png", "CrowdStrike-APT29-10305.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10306.png", "CrowdStrike-APT29-10305.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10305.png", "CrowdStrike-APT29-10306.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10306.png", "CrowdStrike-APT29-10305.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10305.png", "CrowdStrike-APT29-10306.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-WmiObject... -Class AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10306.png", "CrowdStrike-APT29-10305.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-WmiObject... -Class FireWallProduct. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10306.png", "CrowdStrike-APT29-10305.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}, {"Detection_Note": "A Technique detection called \"GenericSoftwareSystemDiscovery\" was generated when WMI was used to query information about firewall products. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-15008.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe executing the NetUserGetGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10313.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed Netapi32.dll loaded into powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10307.png", "CrowdStrike-APT29-10313.png", "CrowdStrike-APT29-10308.png"], "Footnotes": []}]}, {"Substep": "4.C.11", "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API", "Criteria": "powershell.exe executing the NetUserGetLocalGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10312.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed Netapi32.dll loaded into powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10312.png", "CrowdStrike-APT29-10307.png", "CrowdStrike-APT29-10308.png"], "Footnotes": []}]}]}, {"Step_Num": 5, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell command used to create the new service javamtsup. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10337.png", "CrowdStrike-APT29-10338.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed the file write of hostui.lnk in the Startup folder. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10347.png"], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Credential Access", "Substeps": [{"Substep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. Detection incurred a delay based on accesschk.exe executing in a malware detonation chamber where the results were later available to an analyst.", "Detection_Type": "Telemetry", "Modifiers": ["Delayed (Processing)"], "Screenshots": ["CrowdStrike-APT29-10377.png"], "Footnotes": []}]}, {"Substep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "A General detection called \"HashPupAdwareCrowdStrikeSha256\" was generated when accesschk.exe matched known malicious payload hashes. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detection_Type": "General", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10366.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.004", "Subtechnique_Name": "Unsecured Credentials: Private Keys"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "A Technique alert detection (red hexagon indicator) for \"Credential Dumping\" was generated when powershell.exe injected into LSASS. The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10395.png", "CrowdStrike-APT29-10386.png", "CrowdStrike-APT29-10389.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe triggered a ScreenshotTakenETW event. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10405.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10413.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10414.png", "CrowdStrike-APT29-10413.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}, {"Detection_Note": "A Technique alert detection called \"Input Capture\" was generated when a process performed reads of the user key buffers. The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10408.png", "CrowdStrike-APT29-10414.png"], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for User Execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10427.png", "CrowdStrike-APT29-10433.png"], "Footnotes": []}]}, {"Substep": "7.B.2", "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed the file write event for OfficeSupplies.7z. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10432.png"], "Footnotes": []}]}, {"Substep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent alert for User Execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10427.png", "CrowdStrike-APT29-10426.png"], "Footnotes": []}]}, {"Substep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1048.003", "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell Copy-Item to a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10427.png", "CrowdStrike-APT29-10426.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}, {"Detection_Note": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network to a remote adversary WebDav network share (192.168.0.4).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CrowdStrike-APT29-10442.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Expand Access", "Substeps": [{"Substep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10451.png", "CrowdStrike-APT29-10454.png"], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port 5985. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10454.png"], "Footnotes": []}]}, {"Substep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-Process.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10451.png"], "Footnotes": []}]}, {"Substep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a file write event of python.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10457.png"], "Footnotes": []}]}, {"Substep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.002", "Subtechnique_Name": "Obfuscated Files or Information: Software Packing"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"Software Packing\" was generated when python.exe was written to disk.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10468.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a packed executable written event for python.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10458.png", "CrowdStrike-APT29-10461.png"], "Footnotes": ["A FileSubType_decimal value of 4 is a PE_PACKER_UPX reference in documentation."]}]}, {"Substep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam", "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10476.png"], "Footnotes": []}]}, {"Substep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Technique alert detection (yellow indicator) called \"Windows Admin Shares\" was generated when python.exe was copied to Scranton via SMB.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10491.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10483.png", "CrowdStrike-APT29-10491.png"], "Footnotes": []}]}, {"Substep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "Telemetry showed python.exe spawned from PSEXESVC.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10474.png"], "Footnotes": []}, {"Detection_Note": "A Technique detection for \"ServiceExecOnSMBFile\" was generated due to PsExec running a python.exe remotely.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-15006.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Clean Up, Collection, and Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file rar.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed an executable file write event for python.exe creating rar.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10487.png"], "Footnotes": []}]}, {"Substep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed Executable File Write event for python.exe creating sdelete64.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10487.png"], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from python.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed Python.exe executing powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10489.png"], "Footnotes": []}]}, {"Substep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing ChildItem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10490.png"], "Footnotes": []}]}, {"Substep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed Powershell.exe executing ChildItem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10490.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (yellow indicator) called \"Automated Collection\" was generated when powershell.exe executed Get-ChildItem. The event was correlated to a parent Technique detection for Windows Admin Shares.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CrowdStrike-APT29-10493.png", "CrowdStrike-APT29-10491.png"], "Footnotes": []}]}, {"Substep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed a ZipFileWritten event for the creation of working.zip.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10496.png"], "Footnotes": []}]}, {"Substep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to a parent Technique detection for Windows Admin Shares.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10491.png", "CrowdStrike-APT29-10493.png"], "Footnotes": []}]}, {"Substep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Technique alert detection (purple indicator) called \"Data Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. The event was correlated to a parent Technique detection for Windows Admin Shares.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10493.png", "CrowdStrike-APT29-10491.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.The event was correlated to a parent Technique detection for Windows Admin Shares.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10492.png", "CrowdStrike-APT29-10491.png"], "Footnotes": []}]}, {"Substep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe reading the file working.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10511.png", "CrowdStrike-APT29-10512.png"], "Footnotes": []}]}, {"Substep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10511.png", "CrowdStrike-APT29-10512.png"], "Footnotes": []}]}, {"Substep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10511.png", "CrowdStrike-APT29-10512.png"], "Footnotes": []}]}, {"Substep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed an ExecutableDeleted event for sdelete64.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10511.png"], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed hostui.lnk executing from the Startup Folder.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10552.png"], "Footnotes": []}]}, {"Substep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.002", "Subtechnique_Name": "Access Token Manipulation: Create Process with Token"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing with the same token (identified by the AuthenticationID) as explorer.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10562.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"Access Token Manipulation\" was generated for token stealing activity.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10557.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed explorer.exe executing powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10567.png"], "Footnotes": []}]}, {"Substep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1564", "Technique_Name": "Hide Artifacts"}, "Subtechnique": {"Subtechnique_Id": "T1564.004", "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10569.png", "CrowdStrike-APT29-10568.png"], "Footnotes": []}]}, {"Substep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"Substep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"Substep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1120", "Technique_Name": "Peripheral Device Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"Substep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"Substep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"Substep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"Substep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"Substep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the certutil.exe process and corresponding PE file write of the kxwn.lock payload.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10585.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (high severity) called \"Deobfuscate/Decode Files or Information\" was generated when certutil.exe decoded a malicious payload.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10581.png"], "Footnotes": []}]}, {"Substep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10574.png"], "Footnotes": []}]}, {"Substep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10582.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"PowerShell\" was generated for the executed PowerShell stager matching existing malware characteristics.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10588.png", "CrowdStrike-APT29-10582.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (yellow indicator) called \"PowerShell\" was generated for powershell.exe run with a hidden window and encoded commands.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10587.png"], "Footnotes": []}]}, {"Substep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10575.png", "CrowdStrike-APT29-10585.png"], "Footnotes": []}]}, {"Substep": "11.A.14", "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10589.png"], "Footnotes": []}]}, {"Substep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "An MSSP alert showed outbound connection with Cryptographic API calls to C2 server.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["CrowdStrike-APT29-10579.png"], "Footnotes": []}]}]}, {"Step_Num": 12, "Step_Name": "Fortify Access", "Substeps": [{"Substep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell enumeration of System32.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10599.png", "CrowdStrike-APT29-10598.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.006", "Subtechnique_Name": "Indicator Removal on Host: Timestomp"}, "Detections": [{"Detection_Note": "Telemetry showed script block with commands to timestomp kxwn.lock.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10599.png", "CrowdStrike-APT29-10598.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "A Technique detection called \"GenericSecuritySoftwareDiscovery\" was generated due to PowerShell gwmi query for AntiVirusProduct.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10603.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell gwmi query for AntiVirusProduct.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10603.png"], "Footnotes": []}]}, {"Substep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed scriptblock with registry query for installed software.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10605.png", "CrowdStrike-APT29-10604.png"], "Footnotes": []}]}, {"Substep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed script block with registry query for installed software.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10605.png", "CrowdStrike-APT29-10604.png"], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Reconnaissance", "Substeps": [{"Substep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10608.png"], "Footnotes": []}]}, {"Substep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the NetWkstaGetInfo API.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10611.png", "CrowdStrike-APT29-10612.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing the GetUserNameEx API.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10613.png", "CrowdStrike-APT29-10616.png"], "Footnotes": []}]}, {"Substep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10615.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Elevation & Credential Access", "Substeps": [{"Substep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "Telemetry showed the addition of the DelegateExecute Registry value.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10619.png", "CrowdStrike-APT29-10627.png"], "Footnotes": []}]}, {"Substep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A Tactic alert detection (red indicator) called \"Privilege Escalation - Access Token Manipulation\" was generated powershell.exe impersonated another user via access token manipulation. The event was correlated to a parent technique detection for PowerShell.", "Detection_Type": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10620.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).  The event was correlated to a parent technique detection for PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10629.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Bypass User Account Control\" was generated when the parent powershell.exe process of sdclt.exe attempted to escalated privileges with UAC bypass or UAC elevation. The event was correlated to a parent Technique detection for PowerShell.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CrowdStrike-APT29-10625.png"], "Footnotes": []}]}, {"Substep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the deletion of the Registry value.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10627.png", "CrowdStrike-APT29-10619.png"], "Footnotes": []}]}, {"Substep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1047", "Technique_Name": "Windows Management Instrumentation"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for execution via PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10633.png"], "Footnotes": []}]}, {"Substep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Get-Process.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10647.png"], "Footnotes": []}]}, {"Substep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert for Execution via Powershell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10634.png"], "Footnotes": []}, {"Detection_Note": "A General detection called \"NewExecutableWritten\" was generated was generated for the PowerShell command to download m.exe.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-15003.png"], "Footnotes": []}]}, {"Substep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"Credential Dumping\" was generated when Mimikatz (m.exe) launched. The detection was correlated to a parent alert for Execution via Powershell.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10643.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Credential Dumping\" was generated LSASS process was accessed by Mimikatz (m.exe). The detection was correlated to a parent alert for Execution via Powershell.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10635.png", "CrowdStrike-APT29-10641.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (red indicator) called \"Machine Learning via Sensor-based ML\" was generated when m.exe met machine learning-based on-sensor AV protection's high confidence threshold for malicious files. The detection was correlated to a parent alert for Execution via Powershell.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["CrowdStrike-APT29-10641.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Credential Dumping\" was generated when m.exe read LSASS memory. The detection was correlated to a parent alert for Execution via Powershell.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10635.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (red indicator) called \"Credential Dumping\" was generated when the encoded powershell payload script launched a mimikatz process (m.exe) . The detection was correlated to a parent alert for Execution via Powershell.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["CrowdStrike-APT29-10643.png"], "Footnotes": []}]}, {"Substep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell writing encoded content into the WMI class.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10649.png", "CrowdStrike-APT29-10653.png"], "Footnotes": []}]}, {"Substep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell reading encoded content from the WMI class.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10647.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10657.png", "CrowdStrike-APT29-10656.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "A Technique detection for \"WmiFilterConsumerBind\" was generated due to the WindowsParentalControlMigration event filter creation.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-15451.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10654.png", "CrowdStrike-APT29-10655.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the System.DirectoryServices.dll module loaded by powershell.exe as well as powershell.exe executing the Get-NetDomainController cmdlet. The detection was correlated to a parent alert on PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10664.png", "CrowdStrike-APT29-10662.png", "CrowdStrike-APT29-10659.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10667.png", "CrowdStrike-APT29-10666.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed that PowerShell loaded Advapi32.dll in order to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10666.png", "CrowdStrike-APT29-10668.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10679.png", "CrowdStrike-APT29-10672.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}, {"Detection_Note": "A Technique detection called \"GenericWinRMLateralMovement\" was generated when powershell.exe executed Invoke-WinRMSession to connect to remote host NewYork (10.0.0.4) with credentials for user MScott. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10678.png", "CrowdStrike-APT29-10672.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10679.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a file write of m.exe to System32 directory by wsmprovhost.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10689.png", "CrowdStrike-APT29-10683.png"], "Footnotes": []}]}, {"Substep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection (orange indicator) called \"Credential Dumping\" was generated when a remote thread was written to LSASS memory by m.exe (mimikatz).", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10687.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (orange indicator) called \"Credential Dumping\" was generated when m.exe read LSASS memory.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10685.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection  (orange indicator) called \"Credential Dumping\" was generated when m.exe (mimikatz) accessed LSASS memory.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10686.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (orange indicator) called \"Credential Dumping\" was generated identifying m.exe as Mimikatz.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10688.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (orange indicator) called \"Credential Dumping\" was generated when m.exe allocated executable memory inside of LSASS.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10686.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection (orange indicator) called \"Machine Learning via Sensor-based ML\" was generated when m.exe met machine learning-based on-sensor AV protection's high confidence threshold for malicious files.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10685.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (orange indicator) called \"Credential Dumping\" was generated when m.exe injected code into the LSASS process.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10686.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (orange indicator) called \"Credential Dumping\" was generated when a thread was injected into LSASS from a signed executable with untrusted root authority.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10687.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Collection", "Substeps": [{"Substep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1114", "Technique_Name": "Email Collection"}, "Subtechnique": {"Subtechnique_Id": "T1114.001", "Subtechnique_Name": "Email Collection: Local Email Collection"}, "Detections": [{"Detection_Note": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10694.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method and the subsequent ZipFileWritten event. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10701.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"Substep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10701.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"Step_Num": 18, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1102", "Technique_Name": "Web Service"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent technique detection for PowerShell.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10708.png", "CrowdStrike-APT29-10709.png"], "Footnotes": []}]}, {"Substep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1567", "Technique_Name": "Exfiltration Over Web Service"}, "Subtechnique": {"Subtechnique_Id": "T1567.002", "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["CrowdStrike-APT29-10704.png"], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"Step_Num": 20, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10738.png"], "Footnotes": []}]}, {"Substep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10739.png"], "Footnotes": []}, {"Detection_Note": "A Technique detection for \"WmiFilterConsumerBind\" was generated due to PowerShell being executed by WMI.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-15009.png"], "Footnotes": []}]}, {"Substep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed a SYSTEM-level PowerShell spawning from wmiprvse.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10739.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (yellow unique icon) called \"PowerShell\" was generated when powershell was executed with a hidden window and encoded commands.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10735.png"], "Footnotes": []}, {"Detection_Note": "A Technique detection called \"PShellExploitKit2\" was generated by wmiprvse.exe executing powershell.exe as SYSTEM.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10740.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.003", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into current session.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10745.png"], "Footnotes": []}]}, {"Substep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "A Technique alert detection (red indicator) called \"Execution via Windows Remote Management\" was generated for WinRM execution based on the WSMProvHost process on the remote host Scranton (10.0.1.4).", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10753.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10751.png"], "Footnotes": []}, {"Detection_Note": "A Technique detection called \"GenericWinRMLateralMovement\" was generated based on PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10746.png"], "Footnotes": []}]}, {"Substep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10752.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection (purple hexagon) called \"Create Account\" was generated for the addition of the new user Toby.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["CrowdStrike-APT29-10748.png"], "Footnotes": []}, {"Detection_Note": "A Technique detection called \"GenericCreateAccountPersistence\" was generated for the addition of the new user Toby.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["CrowdStrike-APT29-10747.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Eval_Range_Screenshots": {"Scenario_1": [{"Screenshot_Name": "Carbanak-FIN7_CS_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_1_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_1_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_1_3.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_1_4.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_1_5.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_1_6.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_1_7.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_1_8.png", "Screenshot_Caption": ""}], "Scenario_2": [{"Screenshot_Name": "Carbanak-FIN7_CS_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_2_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_2_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_CS_2_3.png", "Screenshot_Caption": ""}]}, "Linux_Participant": true, "Alerting_Strategy": "Indicators that are deemed to be related to a compromise are assigned appropriate severity values (Informational, Low, Medium, High, Critical). These compromise related indicators are also enriched with contextual information, such as a short description and potential mappings to related ATT&CK Tactics and Techniques, processes, users, hosts, or other assets involved in the alert. In addition, CrowdScore will detect attacks from observed behavior and Indicators of Attack across multiple processes and lateral movement to other devices to identify attacker behavior. These detections are given a contextual CrowdScore (out of 10) to indicate the severity based on the observed behaviors in the customer environment and globally. An overall CrowdScore (out of 100) is given to represent the current threat level across the entire enterprise.", "Correlation_Strategy": "The Incident Workbench presents CrowdScore detections and correlation between system events and data, such as process lineage or interactions between processes, files, and networks. Within the Incident Workbench you can see an overview of activity on hosts, and between hosts and pivot into investigation or response workflows. Investigation and activity views are also present, where process trees are generated that enable visualizations of process lineage, detections, and context for each of the processes within the tree.", "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "1.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"Malicious Macro - Execution\" was generated when winword.exe launched 1-list.rtf, which was identified as possible Execution.", "Detection_Type": "Tactic", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_1.A.1_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Malicious Macro - Execution"}], "Linux_Only": false}, {"Substep": "1.A.2", "Procedure": "", "Criteria": "winword.exe loads VBE7.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "A Tactic detection named \"Malicious Macro - Execution\" was generated when winword.exe loaded VBE7.DLL and spawned 1-list.rtf, which was identified as possible Execution.", "Detection_Type": "Tactic", "Modifiers": ["Configuration Change (Detection Logic)", "Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CS_1.A.2_2.png"], "Footnotes": ["Increased collection of module load activity"], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "Malicious Macro - Execution"}], "Linux_Only": false}, {"Substep": "1.A.3", "Procedure": "", "Criteria": "wscript.exe executes unprotected.vbe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A General detection (Suspicious) was generated when sandbox analysis deemed unprotected.vbe suspicious.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_1.A.3_1.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "Suspicious", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Initial Access via Spearphishing Attachment\" (High) was generated when wscript.exe spawned unprotected.vbe from winword.exe, which was identified because of a scripting process launched under a productivity application.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Initial Access via Spearphishing Attachment"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.3_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Execution - Scripting v2\" (Medium) was generated when wscript.exe spawned unprotected.vbe.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_1.A.3_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Execution - Scripting v2"}], "Linux_Only": false}, {"Substep": "1.A.4", "Procedure": "", "Criteria": "unprotected.vbe is an encoded file", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.5", "Procedure": "", "Criteria": "wscript.exe decodes content and creates starter.vbs", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.5_1.png", "Carbanak-FIN7_CS_1.A.5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.6", "Procedure": "", "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.6_1.png", "Carbanak-FIN7_CS_1.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.7", "Procedure": "", "Criteria": "wscript.exe executes starter.vbs", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.7_3.png", "Carbanak-FIN7_CS_1.A.7_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.8", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command-Line Interface\" (High) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "High", "Indicator_Name": "Command-Line Interface"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.9", "Procedure": "", "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "A General detection named \"Suspicious\" was generated when sandbox analysis deemed TransBaseOdbcDriver.js suspicious.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_1.A.9.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": "Suspicious"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.9_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.10", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.10_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "1.A.11", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.11_3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 2, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "2.A.2", "Procedure": "", "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.A.2.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.A.4", "Procedure": "", "Criteria": "wscript.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.A.4.png"], "Footnotes": [], "Data_Sources": ["WMI Objects"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.1", "Procedure": "", "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.B.1_1.png", "Carbanak-FIN7_CS_2.B.1_2.png", "Carbanak-FIN7_CS_2.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "2.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}, {"Detection_Note": "A Technique detection named \"Command-Line Interface\" (High) was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Command-Line Interface"}], "Linux_Only": false}, {"Substep": "2.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"PowerShell\" (High) was generated when cmd.exe spawned a PowerShell process with suspicious command line arguments.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "PowerShell"}], "Linux_Only": false}, {"Substep": "2.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Screen Capture\" was generated when powershell.exe executed CopyFromScreen().", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Screen Capture"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_2.B.4_1.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "2.B.5", "Procedure": "", "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_2.B.5.png", "Carbanak-FIN7_CS_2.B.5_1.png", "Carbanak-FIN7_CS_2.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 3, "Step_Name": "Deploy Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}, {"Detection_Note": "A Technique detection named \"Command-Line Interface\" (High) was generated when wscript.exe spawned cmd.exe in a process subtree beneath a productivity application.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Command-Line Interface"}], "Linux_Only": false}, {"Substep": "3.A.2", "Procedure": "", "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.A.2.png", "Carbanak-FIN7_CS_3.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"RegGenericValueUpdate\" was generated when cmd.exe spawned reg.exe to add a value to the registry key.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_3.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Windows Registry"], "Indicator": "", "Indicator_Name": "RegGenericValueUpdate"}], "Linux_Only": false}, {"Substep": "3.A.3", "Procedure": "", "Criteria": "Value added to Registry is base64 encoded", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.A.3.png", "Carbanak-FIN7_CS_3.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.1", "Procedure": "", "Criteria": "wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.1.png", "Carbanak-FIN7_CS_3.B.1_2.png", "Carbanak-FIN7_CS_3.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "3.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command-Line Interface\" (High) was generated when wscript.exe spawned cmd.exe in a process subtree beneath a productivity application.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Command-Line Interface"}], "Linux_Only": false}, {"Substep": "3.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"PowerShell\" (High) was generated when cmd.exe spawned a PowerShell process with suspicious command line arguments.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "PowerShell"}], "Linux_Only": false}, {"Substep": "3.B.4", "Procedure": "", "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_3.B.4.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "3.B.5", "Procedure": "", "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.5_2.png", "Carbanak-FIN7_CS_3.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Obfuscate Files or Information\" was generated when powershell.exe decrypted, decompressed, and base64 decoded the Registry value into plaintext shellcode.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_3.B.5_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Obfuscate Files or Information"}], "Linux_Only": false}, {"Substep": "3.B.6", "Procedure": "", "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.6_4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "System Calls/API Monitoring", "Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "CreateThreadReflectiveDLL"}, {"Detection_Note": "A Tactic detection named \"Execution via PowerShell\" (High) was generated when a PowerShell script was executed that shared characteristics with known PowerShell exploit kits.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.6_6.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Execution via PowerShell"}, {"Detection_Note": "A General detection named \"Defense Evasion via Process Injection\" (High) was generated when a DLL associated with Metasploit's meterpreter server was loaded into a process.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.6_5.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "DLL Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Defense Evasion via Process Injection"}], "Linux_Only": false}, {"Substep": "3.B.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.7_2.png", "Carbanak-FIN7_CS_3.B.7_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}]}, {"Step_Num": 4, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "4.A.1", "Procedure": "", "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.2", "Procedure": "", "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.A.2_2.png", "Carbanak-FIN7_CS_4.A.2_4.png", "Carbanak-FIN7_CS_4.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.3", "Procedure": "", "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.A.4", "Procedure": "", "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.1", "Procedure": "", "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.1_1.png", "Carbanak-FIN7_CS_4.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.2", "Procedure": "", "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.2_2.png", "Carbanak-FIN7_CS_4.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection was generated when sandbox analysis identified smrs.exe as Mimikatz.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_4.B.2_3.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.3", "Procedure": "", "Criteria": "powershell.exe executes rad353F7.ps1", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.4", "Procedure": "", "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "4.B.5", "Procedure": "", "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A Technique detection named \"UACRegMod\" (High) was generated when powershell.exe modified a Registry key to facilitate UAC bypass.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.5_7.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "Windows Registry"], "Indicator": "High", "Indicator_Name": "UACRegMod"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.5_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Bypass User Account Control\" (High) was generated when fodhelper.exe spawned cmd.exe as a high-integrity process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.5_1.png", "Carbanak-FIN7_CS_4.B.5_6.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Bypass User Account Control"}], "Linux_Only": false}, {"Substep": "4.B.6", "Procedure": "", "Criteria": "cmd.exe spawns smrs.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command-Line Interface\" (High) was generated when cmd.exe executed smrs.exe in a process subtree beneath a productivity application.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Command-Line Interface"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.7", "Procedure": "", "Criteria": "smrs.exe opens and reads lsass.exe", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique detection named \"Credential Dumping\" (High) was generated when an unsigned process (smrs.exe) obtained a handle to lsass.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.7_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Credential Dumping"}, {"Detection_Note": "A Technique detection named \"Credential Dumping\" (High) was generated when smrs.exe opened and read lsass.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.7_5.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "High", "Indicator_Name": "Credential Dumping"}, {"Detection_Note": "A General detection named \"LsassAccessFromMimikatz\" was generated when LSASS process was accessed from the mimikatz hack tool.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.7_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "LsassAccessFromMimikatz"}, {"Detection_Note": "A General detection named \"Machine Learning via Sensor-based ML\" (Medium) was generated when smrs.exe met the on-sensor AV's medium confidence threshold for malicious files.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.7_6.png", "Carbanak-FIN7_CS_4.B.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Medium", "Indicator_Name": "Machine Learning via Sensor-based ML"}], "Linux_Only": false}]}, {"Step_Num": 5, "Step_Name": "Expand Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "", "Criteria": "powershell.exe downloads pscp.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.1.png", "Carbanak-FIN7_CS_5.A.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.2", "Procedure": "", "Criteria": "powershell.exe downloads psexec.py from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.2.png", "Carbanak-FIN7_CS_5.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.3", "Procedure": "", "Criteria": "powershell.exe downloads runtime from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.4", "Procedure": "", "Criteria": "powershell.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.4.png", "Carbanak-FIN7_CS_5.A.4_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.5", "Procedure": "", "Criteria": "powershell.exe downloads tiny.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.5_2.png", "Carbanak-FIN7_CS_5.A.5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.6", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command-Line Interface\" (High) was generated when powershell.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.6_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Command-Line Interface"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.A.7", "Procedure": "", "Criteria": "Pscp.exe connects over SCP (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.7_1.png", "Carbanak-FIN7_CS_5.A.7.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Remote Services - SSH\" (Medium) was generated when pscp.exe connected over SCP (port 22) to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_5.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "Medium", "Indicator_Name": "Remote Services - SSH"}], "Linux_Only": true}, {"Substep": "5.A.8", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.9", "Procedure": "", "Criteria": "Pscp.exe copies psexec.py to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.9.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.10", "Procedure": "", "Criteria": "Pscp.exe copies runtime to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.10.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.A.11", "Procedure": "", "Criteria": "Pscp.exe copies tiny.exe to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.A.11.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.1", "Procedure": "", "Criteria": "plink.exe connects over SSH (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Remote Services - SSH\" (Medium) was generated when plink.exe connected over SSH (port 22) to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_5.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Remote Services - SSH"}], "Linux_Only": true}, {"Substep": "5.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.3", "Procedure": "", "Criteria": "User kmitnick executes ps ax", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.4", "Procedure": "", "Criteria": "User kmitnick executes ls -lsahR /var/", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.5", "Procedure": "", "Criteria": "User kmitnick reads network-diagram-financial.xml via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.6", "Procedure": "", "Criteria": "User kmitnick reads help-desk-ticket.txt via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.B.7", "Procedure": "", "Criteria": "User kmitnick enumerates the domain controller via nslookup, which queries for the DC (10.0.0.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.B.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": true}, {"Substep": "5.C.1", "Procedure": "", "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Detections": [{"Detection_Note": "A Tactic detection named \"Lateral Movement\" was generated when an authenticated network connection occurred from bankfileserver (10.0.0.7) to bankdc (10.0.0.4).", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Windows Event Logs"], "Indicator": "", "Indicator_Name": "Lateral Movement"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Exploitation - Command and Scripting Interpreter\" (Medium) was generated when a suspicious script was launched from python.", "Detection_Type": "General", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_5.C.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Exploitation - Command and Scripting Interpreter"}], "Linux_Only": false}, {"Substep": "5.C.2", "Procedure": "", "Criteria": "psexec.py connects to SMB shares on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Technique detection named \"Windows Admin Shares\" (High) was generated when the Service Control Manager executed a file written by SMB.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.2_3.png", "Carbanak-FIN7_CS_5.C.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "High", "Indicator_Name": "Windows Admin Shares"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.2_2.png", "Carbanak-FIN7_CS_5.C.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.3", "Procedure": "", "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A General detection named \"RemCom\" was generated when sandbox analysis identified the service executable as RemCom malware.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_5.C.3_2.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": "RemCom"}, {"Detection_Note": "A General detection named \"Machine Learning via Cloud-based ML\" (High) was generated when the service executable met a high confidence threshold for malicious files.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.3_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Machine Learning via Cloud-based ML"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.3.png", "Carbanak-FIN7_CS_5.C.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.4", "Procedure": "", "Criteria": "tiny.exe is created on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.4_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "None", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "5.C.5", "Procedure": "", "Criteria": "cmd.exe spawns tiny.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "5.C.6", "Procedure": "", "Criteria": "tiny.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"Defense Evasion via Process Injection\" (High) was generated when a DLL associated with Metasploit's meterpreter server was loaded into a process.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "High", "Indicator_Name": "Defense Evasion via Process Injection"}], "Linux_Only": false}]}, {"Step_Num": 6, "Step_Name": "Discover Potential Targets", "Substeps": [{"Substep": "6.A.1", "Procedure": "", "Criteria": "tiny.exe loads system.management.automation.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_6.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "6.A.2", "Procedure": "", "Criteria": "PowerShell executes Get-ADComputer", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_6.A.2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "6.A.3", "Procedure": "", "Criteria": "PowerShell executes Get-NetUser", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_6.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"PowerShell\" (High) was generated when a PowerShell script launched that shared characteristics with known PowerShell exploit kits.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_6.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "System Calls/API Monitoring", "DLL Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "PowerShell"}], "Linux_Only": false}]}, {"Step_Num": 7, "Step_Name": "Setup Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "", "Criteria": "tiny.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.A.1_1.png", "Carbanak-FIN7_CS_7.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.2", "Procedure": "", "Criteria": "tiny.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.A.2_1.png", "Carbanak-FIN7_CS_7.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.3", "Procedure": "", "Criteria": "plink.exe transmits data to 192.168.0.4 over SSH protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to bankdc (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.A.4.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.A.5", "Procedure": "", "Criteria": "RDP session from the localhost over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.A.5.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.B.1", "Procedure": "", "Criteria": "powershell.exe executes qwinsta /server:cfo", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to cfo (10.0.0.5)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.B.2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.B.3", "Procedure": "", "Criteria": "RDP session from 10.0.0.4 to 10.0.0.5 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"LateralMovementUserLogoninteractive\" was generated when a logon event by kmitnick was detected as an RDP Login from a host exhibiting suspicious behavior.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Event Logs"], "Indicator": "", "Indicator_Name": "LateralMovementUserLogoninteractive"}, {"Detection_Note": "A Tactic detection named \"Lateral Movement\" was generated when an authenticated network connection occurred from bankdc (10.0.0.4) to cfo (10.0.0.5).", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.B.3_2.png", "Carbanak-FIN7_CS_7.B.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Windows Event Logs"], "Indicator": "", "Indicator_Name": "Lateral Movement"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.1", "Procedure": "", "Criteria": "scp.exe downloads Java-Update.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Meterpreter\" (Malicious) was generated when sandbox analysis identified Java-Update.exe as Meterpreter.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_7.C.1.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "Malicious", "Indicator_Name": "Meterpreter"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.C.1_2.png", "Carbanak-FIN7_CS_7.C.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.2", "Procedure": "", "Criteria": "dir lists the contents of C:\\Users\\Public", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.C.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.3", "Procedure": "", "Criteria": "cmd.exe downloads Java-Update.vbs from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.C.3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "7.C.4", "Procedure": "", "Criteria": "Java-Update subkey is added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.C.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}, {"Detection_Note": "A Technique detection named \"Registry Run Keys / Startup Folder\" was generated when a process (reg.exe) made a suspicious change to the Registry, indicating a malicious persistence mechanism.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_7.C.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "Registry Run Keys / Startup Folder"}, {"Detection_Note": "A Tactic detection named \"ASEP Value Update\" was generated when the Java-Update subkey added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run was identified as an Autostart Extensibility Point (ASEP).", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_7.C.4_4.png", "Carbanak-FIN7_CS_7.C.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "ASEP Value Update"}], "Linux_Only": false}]}, {"Step_Num": 8, "Step_Name": "Gain Covert Access to Target", "Substeps": [{"Substep": "8.A.1", "Procedure": "", "Criteria": "wscript.exe spawns Java-Update.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A General detection named \"Machine Learning via Sensor-based ML\" (Medium) was generated when Java-Update.exe met the on-sensor AV's medium confidence threshold for malicious files.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_8.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Medium", "Indicator_Name": "Machine Learning via Sensor-based ML"}, {"Detection_Note": "A General detection named \"CustomIOAWinMedium\" (Suspicious activity) was generated when wscript.exe spawned Java-Update.exe.", "Detection_Type": "General", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_8.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Suspicious activity", "Indicator_Name": "CustomIOAWinMedium"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_8.A.1_4.png", "Carbanak-FIN7_CS_8.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "8.A.2", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "8.A.3", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_8.A.3.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 9, "Step_Name": "Profile a Victim User", "Substeps": [{"Substep": "9.A.1", "Procedure": "", "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_9.A.1_1.png", "Carbanak-FIN7_CS_9.A.1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.2", "Procedure": "", "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Technique detection named \"Input Capture\" was generated when DefenderUpgradeExec.exe called the SetWindowsHookEx API.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Data Sources)"], "Screenshots": ["Carbanak-FIN7_CS_9.A.2_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Input Capture"}, {"Detection_Note": "A General detection named \"Imports Suspicious APIs\" (Suspicious) was generated when sandbox analysis found DefenderUpgradeExec.exe imported suspicious APIs, including the SetWindowsHookEx API.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_9.A.2.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "Suspicious", "Indicator_Name": "Imports Suspicious APIs"}], "Linux_Only": false}, {"Substep": "9.A.3", "Procedure": "", "Criteria": "Java-Update.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Injection\" (Medium) was generated when a DLL associated with Metasploit's meterpreter server was loaded into a process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_9.A.3.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring", "System Calls/API Monitoring"], "Indicator": "Medium", "Indicator_Name": "Process Injection"}, {"Detection_Note": "A Technique detection named \"Contextual Detection - Defense Evasion via Process Injection\" (Medium) was generated when a process containing a reflectively loaded DLL (Java-Update.exe) opened a handle to another process (explorer.exe).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_9.A.3_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring", "DLL Monitoring"], "Indicator": "Medium", "Indicator_Name": "Contextual Detection - Defense Evasion via Process Injection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_9.A.3_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "CreateThreadReflectiveDll and CreateThreadNoStartImage"}], "Linux_Only": false}, {"Substep": "9.A.4", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_9.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.A.5", "Procedure": "", "Criteria": "explorer.exe reads C:\\Users\\jsmith\\AppData\\Local\\Temp\\Klog2.txt over to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.1", "Procedure": "", "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_9.B.1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.2", "Procedure": "", "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_9.B.2.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "9.B.3", "Procedure": "", "Criteria": "powershell.exe deletes files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_9.B.3_1.png", "Carbanak-FIN7_CS_9.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 10, "Step_Name": "Impersonate Victim", "Substeps": [{"Substep": "10.A.1", "Procedure": "", "Criteria": "explorer.exe downloads tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_10.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.2", "Procedure": "", "Criteria": "explorer.exe downloads vnc-settings.reg from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_10.A.2_1.png", "Carbanak-FIN7_CS_10.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.3", "Procedure": "", "Criteria": "netsh adds Service Host rule for TCP port 5900", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1562", "Technique_Name": "Impair Defenses"}, "Subtechnique": {"Subtechnique_Id": "T1562.004", "Subtechnique_Name": "Impair Defenses: Disable or Modify System Firewall"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_10.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.4", "Procedure": "", "Criteria": "msiexec.exe adds the tvncontrol subkey in HKLM\\Software\\Microsoft\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Tactic detection named \"ASEP Value Update\" was generated when the tvncontrol subkey added to HKLM\\Software\\Microsoft\\CurrentVersion\\Run was identified as an Autostart Extensibility Point (ASEP).", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_10.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "ASEP Value Update"}], "Linux_Only": false}, {"Substep": "10.A.5", "Procedure": "", "Criteria": "Addition of subkeys in HKLM\\Software\\TightVNC\\Server", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_10.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "10.A.6", "Procedure": "", "Criteria": "Deletion of the Java-Update subkey in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_10.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"ASEP Value Update\" was generated when the Java-Update subkey, identified as related to an Autostart Extensibility Point (ASEP), was deleted.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_10.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "ASEP Value Update"}], "Linux_Only": false}, {"Substep": "10.B.1", "Procedure": "", "Criteria": "tvnserver.exe accepts a connection from 192.168.0.4 over TCP port 5900", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1219", "Technique_Name": "Remote Access Software"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_10.B.1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Remote Services - VNC\" (Medium) was generated when tvnserver.exe accepted a connection from 192.168.0.4 over port 5900.", "Detection_Type": "General", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_10.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "Medium", "Indicator_Name": "Remote Services - VNC"}], "Linux_Only": false}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "11.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"MaliciousMacro - Execution\" was generated when explorer.exe spawned winword.exe when the user clicked 2-list.rtf.", "Detection_Type": "Tactic", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_11.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "MaliciousMacro - Execution"}], "Linux_Only": false}, {"Substep": "11.A.2", "Procedure": "", "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.3", "Procedure": "", "Criteria": "winword.exe spawns mshta.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "None", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Mshta\" (High) was generated when winword.exe spawned mshta.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "High", "Indicator_Name": "Mshta"}], "Linux_Only": false}, {"Substep": "11.A.4", "Procedure": "", "Criteria": "mshta.exe executes an embedded VBScript payload", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.4_1.png", "Carbanak-FIN7_CS_11.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "None", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "11.A.5", "Procedure": "", "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "11.A.6", "Procedure": "", "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Masquerading\" (High) was generated when a copy of an executable (wscript.exe) was manipulated (filename, path) to create Adb156.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.6.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Masquerading"}], "Linux_Only": false}, {"Substep": "11.A.7", "Procedure": "", "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"MaliciousMacro - Execution\" was generated when a process launched that was related to a malicious macro in a document.", "Detection_Type": "Tactic", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_11.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "MaliciousMacro - Execution"}], "Linux_Only": false}, {"Substep": "11.A.8", "Procedure": "", "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.8.png", "Carbanak-FIN7_CS_11.A.8_3.png", "Carbanak-FIN7_CS_11.A.8_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 12, "Step_Name": "Delayed Malware Execution", "Substeps": [{"Substep": "12.A.1", "Procedure": "", "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_12.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "None", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.2", "Procedure": "", "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_12.A.2_1.png", "Carbanak-FIN7_CS_12.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "None", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.3", "Procedure": "", "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_12.A.3.png", "Carbanak-FIN7_CS_12.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "12.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"System Information Discovery\" was generated when a process (Adb156.exe) gathered information about the operating system or hardware.", "Detection_Type": "Tactic", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_12.A.4.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": "System Information Discovery"}], "Linux_Only": false}, {"Substep": "12.A.5", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"System Information Discovery\" was generated when a process (Adb156.exe) gathered information about the operating system or hardware.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_12.A.5.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": "System Information Discovery"}], "Linux_Only": false}, {"Substep": "12.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads stager.ps1 from 192.168.0.6", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_12.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "None", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 13, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "13.A.1", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.A.1_1.png", "Carbanak-FIN7_CS_13.A.1.png"], "Footnotes": [], "Data_Sources": ["WMI Objects"], "Indicator": "None", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "13.A.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.A.2_1.png", "Carbanak-FIN7_CS_13.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.3", "Procedure": "", "Criteria": "cmd.exe executes net view", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}, {"Detection_Note": "A Tactic detection named \"System Network Configuration Discovery\" was generated when a process (net.exe) accessed system network configuration settings.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "System Network Configuration Discovery"}], "Linux_Only": false}, {"Substep": "13.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.A.4.png", "Carbanak-FIN7_CS_13.A.4_1.png"], "Footnotes": [], "Data_Sources": ["WMI Objects"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "13.A.5", "Procedure": "", "Criteria": "Adb156.exe queries the USERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.6", "Procedure": "", "Criteria": "Adb156.exe queries the COMPUTERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.A.8", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.A.8.png", "Carbanak-FIN7_CS_13.A.8_1.png"], "Footnotes": [], "Data_Sources": ["WMI Objects"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "13.A.9", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.A.9_1.png", "Carbanak-FIN7_CS_13.A.9.png"], "Footnotes": [], "Data_Sources": ["WMI Objects"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "13.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.B.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.B.2_2.png", "Carbanak-FIN7_CS_13.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "13.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.B.3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "13.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}, {"Detection_Note": "A Technique detection named \"Screen Capture\" (High) was generated when a desktop screenshot was taken by a suspicious process (powershell.exe).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_13.B.4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Screen Capture"}], "Linux_Only": false}, {"Substep": "13.B.5", "Procedure": "", "Criteria": "Adb156.exe reads and uploads image.png to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 14, "Step_Name": "Staging Interactive Toolkit", "Substeps": [{"Substep": "14.A.1", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_14.A.1_1.png", "Carbanak-FIN7_CS_14.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.2", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_14.A.2_3.png", "Carbanak-FIN7_CS_14.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Command and Scripting Interpreter - PowerShell\" (Medium) was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_14.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Command and Scripting Interpreter - PowerShell"}], "Linux_Only": false}, {"Substep": "14.A.3", "Procedure": "", "Criteria": "powershell.exe decodes an embedded DLL payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_14.A.3_1.png", "Carbanak-FIN7_CS_14.A.3_2.png", "Carbanak-FIN7_CS_14.A.3.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.4", "Procedure": "", "Criteria": "powershell.exe executes the decoded payload using Invoke-Expression (IEX)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowerShell\" was generated when powershell.exe executed the decoded payload using Invoke-Expression (IEX).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_14.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "PowerShell"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_14.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.5", "Procedure": "", "Criteria": "powershell.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_14.A.5_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"Defense Evasion via Process Injection\" (High) was generated when a DLL associated with Metasploit's meterpreter server was reflectively loaded into a process.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_14.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring", "DLL Monitoring"], "Indicator": "High", "Indicator_Name": "Defense Evasion via Process Injection"}], "Linux_Only": false}, {"Substep": "14.A.6", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "14.A.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 15, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "15.A.1", "Procedure": "", "Criteria": "powershell.exe calls the CreateToolhelp32Snapshot() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Discovery\" was generated when a process (powershell.exe) gathered information about other processes running on network systems.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_15.A.1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Discovery"}], "Linux_Only": false}, {"Substep": "15.A.2", "Procedure": "", "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.3", "Procedure": "", "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.4", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "None", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.5", "Procedure": "", "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "A Technique detection named \"Bypass User Account Control\" (High) was generated when a Registry entry used for User Account Control bypass was set.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "High", "Indicator_Name": "Bypass User Account Control"}, {"Detection_Note": "A Technique detection named \"Bypass User Account Control\" (High) was generated when powershell.exe spawned samcat.exe as a high-integrity process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.5_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Bypass User Account Control"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.5_3.png", "Carbanak-FIN7_CS_15.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "15.A.6", "Procedure": "", "Criteria": "samcat.exe opens and reads the SAM via LSASS", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A General detection named \"Mimikatz\" was generated when sandbox analysis identified samcat.exe as Mimikatz.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_15.A.6_3.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": "Mimikatz"}, {"Detection_Note": "A Technique detection named \"Credential Dumping\" (High) was generated when credential-related Registry keys were accessed using an impersonation token by samcat.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "System Calls/API Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Credential Dumping"}, {"Detection_Note": "A General detection named \"Machine Learning via Sensor-based ML\" (High) was generated when samcat.exe met the on-sensor AV's medium confidence threshold for malicious files.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "High", "Indicator_Name": "Machine Learning via Sensor-based ML"}, {"Detection_Note": "A Technique detection named \"Credential Dumping\" (High) was generated when samcat.exe opened and read the SAM.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "High", "Indicator_Name": "Credential Dumping"}], "Linux_Only": false}, {"Substep": "15.A.7", "Procedure": "", "Criteria": "powershell.exe calls the GetIpNetTable() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "15.A.8", "Procedure": "", "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.8.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "", "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.2", "Procedure": "", "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.3", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.3_1.png", "Carbanak-FIN7_CS_16.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "16.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.4.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "16.A.5", "Procedure": "", "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "A Technique detection named \"Windows Admin Shares\" (High) was generated when the Service Control Manager executed a file written by SMB.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Windows Event Logs"], "Indicator": "High", "Indicator_Name": "Windows Admin Shares"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.5_3.png", "Carbanak-FIN7_CS_16.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "16.A.6", "Procedure": "", "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.6.png", "Carbanak-FIN7_CS_16.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "None", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.7", "Procedure": "", "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Hollowing\" (High) was generated when activity associated with malicious process hollowing was detected from hollow.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "High", "Indicator_Name": "Process Hollowing"}, {"Detection_Note": "A General detection named \"Machine Learning via Sensor-based ML\" (High) was generated when hollow.exe met the on-sensor AV's medium confidence threshold for malicious files.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "High", "Indicator_Name": "Machine Learning via Sensor-based ML"}, {"Detection_Note": "A Technique detection named \"Defense Evasion via Process Injection\" (High) was generated when a userspace process (hollow.exe) spawned a new process (svchost.exe) and used it to execute shellcode.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.7_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "High", "Indicator_Name": "Defense Evasion via Process Injection"}, {"Detection_Note": "A General detection (Malicious) was generated when sandbox analysis deemed hollow.exe malicious.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_16.A.7_6.png", "Carbanak-FIN7_CS_16.A.7_3.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "Malicious", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.8", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "16.A.9", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 17, "Step_Name": "Setup User Monitoring", "Substeps": [{"Substep": "17.A.1", "Procedure": "", "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_17.A.1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.2", "Procedure": "", "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "A Technique detection named \"Masquerading\" was generated when srrstr.dll was detected as illegitimate.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_17.A.2_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": "Masquerading"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_17.A.2_1.png", "Carbanak-FIN7_CS_17.A.2.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.3", "Procedure": "", "Criteria": "svchost.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_17.A.3_1.png", "Carbanak-FIN7_CS_17.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.4", "Procedure": "", "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_17.A.4_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Defense Evasion via Process Injection\" (High) was generated when a userspace process (SystemPropertiesAdvanced.exe) spawned a new process (rundll32.exe) and used it to execute shellcode in srrstr.dll.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_17.A.4_3.png", "Carbanak-FIN7_CS_17.A.4.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring"], "Indicator": "High", "Indicator_Name": "Defense Evasion via Process Injection"}, {"Detection_Note": "A Technique detection named \"DLL Search Order Hijacking\" was generated when SystemPropertiesAdvanced.exe loaded the illegitimate srrstr.dll.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_17.A.4_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring"], "Indicator": "", "Indicator_Name": "DLL Search Order Hijacking"}], "Linux_Only": false}, {"Substep": "17.A.5", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "17.A.6", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 18, "Step_Name": "User Monitoring", "Substeps": [{"Substep": "18.A.1", "Procedure": "", "Criteria": "svchost.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_18.A.1_4.png", "Carbanak-FIN7_CS_18.A.1_3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}, {"Detection_Note": "A Technique detection named \"Process Injection\" (High) was generated when a DLL associated with Metasploit's meterpreter exploit kit was reflectively loaded into a process when svchost.exe injected into explorer.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_18.A.1_5.png", "Carbanak-FIN7_CS_18.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring", "System Calls/API Monitoring"], "Indicator": "High", "Indicator_Name": "Process Injection"}], "Linux_Only": false}, {"Substep": "18.A.2", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_18.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "18.A.3", "Procedure": "", "Criteria": "explorer.exe injects into mstsc.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Injection\" (High) was generated when explorer.exe injected into mstsc.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_18.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "High", "Indicator_Name": "Process Injection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_18.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "None", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "18.A.4", "Procedure": "", "Criteria": "mstsc.exe calls APIs such as GetAsyncKeyState, GetKeyState, or GetKeyboardState", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_18.A.4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}, {"Step_Num": 19, "Step_Name": "Setup Shim Persistence", "Substeps": [{"Substep": "19.A.1", "Procedure": "", "Criteria": "User kmitnick logs on to accounting (10.0.1.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.A.1.png", "Carbanak-FIN7_CS_19.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.A.2", "Procedure": "", "Criteria": "RDP session from 10.0.1.6 to 10.0.1.7 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"Remote Services\" was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Remote Services"}, {"Detection_Note": "A Tactic detection named \"Lateral Movement\" was generated when an authenticated network connection was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.A.2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Windows Event Logs"], "Indicator": "", "Indicator_Name": "Lateral Movement"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.A.2_2.png", "Carbanak-FIN7_CS_19.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.A.3", "Procedure": "", "Criteria": "itadmin (10.0.1.6) is relaying RDP traffic from attacker infrastructure", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1090", "Technique_Name": "Proxy"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.1", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"Ingress Tool Transfer - PowerShell\" (Medium) was generated when a suspicious script was written to a uncommon location.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_19.B.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Ingress Tool Transfer - PowerShell"}], "Linux_Only": false}, {"Substep": "19.B.2", "Procedure": "", "Criteria": "powershell.exe executes base64 encoded commands", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.B.2_2.png", "Carbanak-FIN7_CS_19.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.3", "Procedure": "", "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.B.3.png", "Carbanak-FIN7_CS_19.B.3_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Sandbox Report - dll329.dll\" (Malicious) was generated when sandbox analysis deemed dll329.dll as malicious.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_19.B.3_1.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "Malicious", "Indicator_Name": "Sandbox Report - dll329.dll"}], "Linux_Only": false}, {"Substep": "19.B.4", "Procedure": "", "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"CustomIOAWinMedium\" (Suspicious Activity) was generated when powershell.exe created sdbE376.tmp\n.", "Detection_Type": "General", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_19.B.4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Suspicious Activity", "Indicator_Name": "CustomIOAWinMedium"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "19.B.5", "Procedure": "", "Criteria": "sdbinst.exe installs sdbE376.tmp shim", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.B.5.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Tactic detection named \"ASEP Value Update\" was generated when sdbinst.exe installed a custom shim database file, which was identified as an Autostart Extensibility Point (ASEP).", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_19.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "ASEP Value Update"}], "Linux_Only": false}]}, {"Step_Num": 20, "Step_Name": "Steal Payment Data", "Substeps": [{"Substep": "20.A.1", "Procedure": "", "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.A.2", "Procedure": "", "Criteria": "AccountingIQ.exe injects into SyncHost.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Injection\" was generated when a process (SyncHost.exe) was identified as the target of a remote thread injection.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.A.2_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Injection"}, {"Detection_Note": "A Technique detection named \"ProcessMigrationViaShellcode\" was generated when a userspace process (AccountingIQ.exe) spawned a new process (SyncHost.exe) and used it to execute shellcode.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "ProcessMigrationViaShellcode"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "20.A.3", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.A.4", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.1", "Procedure": "", "Criteria": "rundll32.exe downloads debug.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Machine Learning via Cloud-based ML\" (Informational) was generated when debug.exe met the lowest confidence detection threshold for malicious files.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Informational", "Indicator_Name": "Machine Learning via Cloud-based ML"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.B.1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.2", "Procedure": "", "Criteria": "debug.exe calls the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Application running from the root of PUBLIC user\" (Medium) was generated when debug.exe was executed from the root directory of the Public user.", "Detection_Type": "General", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_20.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "Medium", "Indicator_Name": "Application running from the root of PUBLIC user"}, {"Detection_Note": "A General detection named \"Imports suspicious APIs\" (Suspicious) was generated when debug.exe imported suspicious API calls, which included CreateToolhelp32Snapshot.", "Detection_Type": "General", "Modifiers": ["Delayed"], "Screenshots": ["Carbanak-FIN7_CS_20.B.2.png"], "Footnotes": ["Delayed results due to sandbox execution"], "Data_Sources": ["Sandbox"], "Indicator": "Suspicious", "Indicator_Name": "Imports suspicious APIs"}, {"Detection_Note": "A General detection named \"Machine Learning via Sensor-based ML\" (Informational) was generated when debug.exe met the on-sensor AV's lowest confidence threshold for malicious files.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.B.2_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Informational", "Indicator_Name": "Machine Learning via Sensor-based ML"}], "Linux_Only": false}, {"Substep": "20.B.3", "Procedure": "", "Criteria": "rundll32.exe downloads 7za.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.B.3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "20.B.4", "Procedure": "", "Criteria": "7za.exe creates C:\\Users\\Public\\log.7z", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.B.4.png", "Carbanak-FIN7_CS_20.B.4_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A General detection named \"Application running from the root of PUBLIC user\" (Medium) was generated when 7za.exe was executed from the root directory of the Public user.", "Detection_Type": "General", "Modifiers": ["Configuration Change (Detection Logic)"], "Screenshots": ["Carbanak-FIN7_CS_20.B.4_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "Medium", "Indicator_Name": "Application running from the root of PUBLIC user"}], "Linux_Only": false}, {"Substep": "20.B.5", "Procedure": "", "Criteria": "rundll32.exe reads and uploads log.7z to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_CS_20.B.5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}]}]}}, "Protections": {"Protection_Tests": [{"Test_Num": 1, "Test_Group": "Carbanak", "Test_Name": "Initial Access with Embedded VBE in Word Document", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "1.A.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 1 was blocked when winword.exe was terminated, because \"a suspicious script launched under a productivity application.\"", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CS_1.A.1P_2.png", "Carbanak-FIN7_CS_1.A.1P_1.png", "Carbanak-FIN7_CS_1.A.1P.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf"}, {"Substep_Name": "1.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe loads VBE7.DLL"}, {"Substep_Name": "1.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes unprotected.vbe"}, {"Substep_Name": "1.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "unprotected.vbe is an encoded file"}, {"Substep_Name": "1.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates starter.vbs"}, {"Substep_Name": "1.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes starter.vbs"}, {"Substep_Name": "1.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "1.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.10", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "1.A.11", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "2.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem"}, {"Substep_Name": "2.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes a WMI query for Win32_Process"}, {"Substep_Name": "2.B.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4"}, {"Substep_Name": "2.B.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "2.B.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "cmd.exe spawns powershell.exe"}, {"Substep_Name": "2.B.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes CopyFromScreen()"}, {"Substep_Name": "2.B.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4"}], "Test_Screenshots": []}, {"Test_Num": 2, "Test_Group": "Carbanak", "Test_Name": "Registry Shellcode and Execution", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "3.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer"}, {"Substep_Name": "3.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Value added to Registry is base64 encoded"}, {"Substep_Name": "3.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty"}, {"Substep_Name": "3.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode"}, {"Substep_Name": "3.B.6", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 2 was blocked when powershell.exe was terminated, because it reflectively loaded a DLL associated with the meterpreter exploit kit.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CS_3.B.6P_1.png", "Carbanak-FIN7_CS_3.B.6P.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API"}, {"Substep_Name": "3.B.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP"}, {"Substep_Name": "4.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs"}, {"Substep_Name": "4.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4"}, {"Substep_Name": "4.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access"}, {"Substep_Name": "4.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick"}], "Test_Screenshots": []}, {"Test_Num": 3, "Test_Group": "Carbanak", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "4.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4"}, {"Substep_Name": "4.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4"}, {"Substep_Name": "4.B.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe executes rad353F7.ps1"}, {"Substep_Name": "4.B.4", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 3 was blocked when the Registry failed to update, because the modification was identified as a behavior which facilitates a UAC bypass.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CS_4.B.4P.png", "Carbanak-FIN7_CS_4.B.4P_2.png", "Carbanak-FIN7_CS_4.B.4P_1.png"], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty"}, {"Substep_Name": "4.B.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "4.B.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns smrs.exe"}, {"Substep_Name": "4.B.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "smrs.exe opens and reads lsass.exe"}], "Test_Screenshots": []}, {"Test_Num": 4, "Test_Group": "Carbanak", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity all on bankfileserver (10.0.0.7) to bankdc (10.0.0.4) as user kmitnick", "Substeps": [{"Substep_Name": "5.C.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 4 was blocked when the psexec.py was terminated, because it was identified as \"Lateral Movement via Exploitation of Remote Services\"", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CS_5.C.1P_2.png"], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick"}, {"Substep_Name": "5.C.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "psexec.py connects to SMB shares on 10.0.0.4"}, {"Substep_Name": "5.C.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\"}, {"Substep_Name": "5.C.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe is created on 10.0.0.4"}, {"Substep_Name": "5.C.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns tiny.exe"}, {"Substep_Name": "5.C.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe loads shellcode from network connection into memory"}], "Test_Screenshots": []}, {"Test_Num": 5, "Test_Group": "Carbanak", "Test_Name": "Credential Access", "Test_Description": "Activity on cfo (10.0.0.5) as user jsmith", "Substeps": [{"Substep_Name": "9.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4"}, {"Substep_Name": "9.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API"}, {"Substep_Name": "9.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4"}, {"Substep_Name": "9.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll"}], "Test_Screenshots": []}, {"Test_Num": 11, "Test_Group": "FIN7", "Test_Name": "Initial Access with Embedded VBS in Word Document", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "11.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf"}, {"Substep_Name": "11.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk"}, {"Substep_Name": "11.A.3", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 11 was blocked when mshta.exe was terminated, because it contained malicious commands from an obfuscated script.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CS_11.A.3P.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Criteria": "winword.exe spawns mshta.exe"}, {"Substep_Name": "11.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "mshta.exe executes an embedded VBScript payload"}, {"Substep_Name": "11.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload"}, {"Substep_Name": "11.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe"}, {"Substep_Name": "11.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL"}, {"Substep_Name": "11.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes"}, {"Substep_Name": "12.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe"}, {"Substep_Name": "12.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript"}, {"Substep_Name": "12.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions"}, {"Substep_Name": "12.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration"}, {"Substep_Name": "12.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk"}], "Test_Screenshots": []}, {"Test_Num": 12, "Test_Group": "FIN7", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "15.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4"}, {"Substep_Name": "15.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4"}, {"Substep_Name": "15.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "15.A.5", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 12 was blocked when powershell.exe was terminated, because it attempted to modify the Registry to facilitate a UAC bypass.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CS_15.A.5P_1.png"], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "15.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "samcat.exe opens and reads the SAM via LSASS"}, {"Substep_Name": "15.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the GetIpNetTable() API"}, {"Substep_Name": "15.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)"}], "Test_Screenshots": []}, {"Test_Num": 13, "Test_Group": "FIN7", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity from hotelmanager (10.0.1.5) to itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "16.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4"}, {"Substep_Name": "16.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4"}, {"Substep_Name": "16.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)"}, {"Substep_Name": "16.A.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed"}, {"Substep_Name": "16.A.6", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe"}, {"Substep_Name": "16.A.7", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 13 was blocked when hollow.exe was removed, because on sensor machine learning identified the file as suspicious at the lowest confidence threshold.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_CS_16.A.7P_1.png"], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection"}, {"Substep_Name": "16.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "16.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 14, "Test_Group": "FIN7", "Test_Name": "DLL Hijacking", "Test_Description": "Activity on itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "17.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)"}, {"Substep_Name": "17.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library"}, {"Substep_Name": "17.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll"}, {"Substep_Name": "17.A.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "17.A.6", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 15, "Test_Group": "FIN7", "Test_Name": "Shim Persistence", "Test_Description": "Activity on accounting (10.0.1.7) as user kmitnick", "Substeps": [{"Substep_Name": "19.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "19.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes base64 encoded commands"}, {"Substep_Name": "19.B.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4"}, {"Substep_Name": "19.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4"}, {"Substep_Name": "19.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "sdbinst.exe installs sdbE376.tmp shim"}, {"Substep_Name": "20.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll"}, {"Substep_Name": "20.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "20.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}]}}]}