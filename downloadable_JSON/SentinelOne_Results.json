{"Participant_Name": "SentinelOne", "PublicRelease": "\u00a9 2021 MITRE Engenuity. Approved for Public Release. Document number AT0016", "Aggregate_Data": {"Evaluation_Aggregate_Data": {"Adversaries": [{"Adversary_Name": "apt3", "Display_Name": "APT3", "Evaluation_Year": 2018, "Total_Detections": 105, "Analytic_Detections": 8, "Telemetry_Detections": 97, "Analytic_Coverage": "8/136", "Telemetry_Coverage": "97/136", "Visibility": "101/136", "Total_Procedures_Tested": 136}, {"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Total_Detections": 290, "Analytic_Detections": 65, "Telemetry_Detections": 109, "Analytic_Coverage": "123/134", "Telemetry_Coverage": "109/134", "Visibility": "127/134", "Total_Substeps": 134}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Total_Detections": 333, "Analytic_Detections": 169, "Telemetry_Detections": 164, "Analytic_Coverage": "159/174", "Telemetry_Coverage": "164/174", "Visibility": "174/174", "Total_Substeps": 174, "Linux_Participant": true}]}}, "Adversaries": [{"Adversary_Name": "apt3", "Display_Name": "APT3", "Evaluation_Year": 2018, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated due to static analysis of the file through the DFI resulting in it being marked as suspicious, which generated a story (group ID) that subsequent linked events are tainted by.", "Detection_Type": "General Behavior", "Modifiers": [], "Screenshots": ["S1-1.A.1-2.png", "S1-1.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed Resume Viewer.exe execution with subsequent file writes and execution.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["S1-1.A.1-2.png", "S1-1.A.1-1.png"], "Footnotes": []}]}, {"Substep": "1.A.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe executing as a result of Resume Viewer.exe running. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-1.A.1-1.png"], "Footnotes": []}]}, {"Substep": "1.A.1", "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing the pdfhelper.cmd script. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-1.B.1-1.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry on actions performed from Resume Viewer.exe showed autoupdate.bat being written to the Startup Folder. The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-1.B.1-1.png"], "Footnotes": []}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using port 53", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["DNS requests were observed (no detection showed port 53 specifically)."]}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.004", "Subtechnique_Name": "Application Layer Protocol: DNS"}, "Detections": [{"Detection_Note": "Telemetry showed DNS requests to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-1.C.1-1.png"], "Footnotes": []}]}, {"Substep": "1.C.1", "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1132", "Technique_Name": "Data Encoding"}, "Subtechnique": {"Subtechnique_Id": "T1132.001", "Subtechnique_Name": "Data Encoding: Standard Encoding"}, "Detections": [{"Detection_Note": "Telemetry showed DNS requests with encoded content to freegoogleadsenseinfo.com (the C2 domain). The telemetry was tainted by the previous alert generated from Resume Viewer.exe because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-1.C.1-1.png", "S1-1.C.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Initial Discovery", "Substeps": [{"Substep": "2.A.1", "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-3.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Cobalt Strike: 'arp -a' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing arp.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.2-1.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-4.png"], "Footnotes": []}]}, {"Substep": "2.C.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "2.C.2", "Procedure": "Cobalt Strike: 'tasklist -v' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing tasklist.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-5.png"], "Footnotes": []}]}, {"Substep": "2.D.1", "Procedure": "Cobalt Strike: 'sc query' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing sc.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-6.png"], "Footnotes": []}]}, {"Substep": "2.D.2", "Procedure": "Cobalt Strike: 'net start' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-7.png"], "Footnotes": []}]}, {"Substep": "2.E.1", "Procedure": "Cobalt Strike: 'systeminfo' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-8.png"], "Footnotes": []}]}, {"Substep": "2.E.2", "Procedure": "Cobalt Strike: 'net config workstation' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-9.png"], "Footnotes": []}]}, {"Substep": "2.F.1", "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-10.png"], "Footnotes": []}]}, {"Substep": "2.F.2", "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-11.png"], "Footnotes": []}]}, {"Substep": "2.F.3", "Procedure": "Cobalt Strike: 'net group \\\"Domain Admins\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-12.png"], "Footnotes": []}]}, {"Substep": "2.G.1", "Procedure": "Cobalt Strike: 'net user -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-13.png"], "Footnotes": []}]}, {"Substep": "2.G.2", "Procedure": "Cobalt Strike: 'net user george -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.A.1-14.png"], "Footnotes": []}]}, {"Substep": "2.H.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing reg.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-2.H.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Privilege Escalation", "Substeps": [{"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed process integrity levels changing from medium to high.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Detect was verified, but a screenshot for this data was unavailable. Integrity level values are based upon how the capability tracks integrity levels and not how Windows tracks them causing a difference in values."]}]}, {"Substep": "3.A.1", "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.001", "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe allocating memory, writing to memory space, and invoking a thread into cmd.exe (tainted by association with parent alert for powershell.exe process executed by svchost.exe).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-3.C.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 4, "Step_Name": "Discovery for Lateral Movement", "Substeps": [{"Substep": "4.A.1", "Procedure": "Cobalt Strike: 'net group \\\"Domain Controllers\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-4.A.1-1.png"], "Footnotes": []}]}, {"Substep": "4.A.2", "Procedure": "Cobalt Strike: 'net group \\\"Domain Computers\\\" -domain' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing net.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-4.A.1-3.png", "S1-4.A.1-2.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing netsh.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-4.A.1-2.png"], "Footnotes": []}]}, {"Substep": "4.C.1", "Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing netstat.exe with command-line arguments. The telemetry was tainted by activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-4.A.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 5, "Step_Name": "Credential Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor states that the capability would normally block credential dumping activity like this, but the mitigation capability was disabled due to the evaluation parameters."]}]}, {"Substep": "5.A.1", "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Built-in hash dump capability executed", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Vendor states that the capability would normally block credential dumping activity like this, but the mitigation capability was disabled due to the evaluation parameters."]}]}, {"Substep": "5.A.2", "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe injecting into svchost.exe (not counted for detection) then invoking a remote thread into lsass.exe. Powershell.exe was listed as the source of the remote thread into lsass.exe instead of svchost.exe because the alert on powershell.exe came before other events and therefore had increased precedence. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-5.A.2-1.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.001", "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Lateral Movement", "Substeps": [{"Substep": "6.A.1", "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-6.A.1-1.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use port 80", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a port 80 connection to 192.168.0.4 (C2 server) that was associated with the rundll32 parent process. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-6.B.1-1.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["Telemetry showed a connection to port 80 (no detection showed HTTP specifically)."]}]}, {"Substep": "6.B.1", "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1026", "Technique_Name": "Multiband Communication"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed port 80 connections to 192.168.0.4 (C2 server) and DNS requests for freegoogleadsenseinfo.com (C2 domain), which could indicate multiband communication. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-6.B.1-1.png", "S1-1.C.1-1.png"], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "Telemetry showed a port 3389 connection. The telemetry was tainted by the activity seen during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-6.C.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed the creation of the user Jesse which was noted from SAM Registry events.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["S1-7.A.1-1.png"], "Footnotes": []}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1061", "Technique_Name": "Graphical User Interface"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.A.1", "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.001", "Subtechnique_Name": "Account Discovery: Local Account"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file write of updater.dll. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-7.B.1-1.png"], "Footnotes": []}]}, {"Substep": "7.C.1", "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "Telemetry showed execution of schtasks.exe and associated command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-7.C.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 8, "Step_Name": "Collection", "Substeps": [{"Substep": "8.A.1", "Procedure": "Cobalt Strike: 'dir -s -b \\\"\\\\conficker\\wormshare\\\"' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing dir with command-line arguments. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-8.A.1-2.png"], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Cobalt Strike: 'tree \\\"C:\\Users\\debbie\\\"' via cmd", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe executing tree with command-line arguments. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-8.A.1-3.png"], "Footnotes": []}]}, {"Substep": "8.B.1", "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "Telemetry showed GetAsyncKeyStateApi, which was indicative of keylogging. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-8.C.1-1.png", "S1-8.C.1-2.png"], "Footnotes": ["Vendor stated log files indicate the powershell process was using the SSL cache folder."]}]}, {"Substep": "8.C.1", "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1010", "Technique_Name": "Application Window Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "8.D.1", "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the sequence of events related to process injection from powershell.exe into explorer.exe. The capability associated the process with the highest threat to the event (powershell.exe) instead of cmd.exe (the expected source of the injection) because it had an alert associated with it previously. The telemetry was tainted by the activity seen during the initial compromise step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-8.D.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1039", "Technique_Name": "Data from Network Shared Drive"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed remote file access behavior for the .vsdx file from the network shared drive.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["S1-9.B.1-1.png"], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "Criteria": "", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Execution of Persistence", "Substeps": [{"Substep": "10.A.1", "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "Telemetry showed execution of autoupdate.bat from the Startup folder for persistence. The telemetry was associated to a new story (Group ID) but was not marked as malicious or tainted because it is not associated with an alert.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["S1-10.A.1-3.png", "S1-10.A.1-2.png"], "Footnotes": []}]}, {"Substep": "10.A.2", "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe executing updater.dll as part of the scheduled task persistence. The telemetry was associated with the execution of autoupdate.bat for persistence because it was associated with the same story (Group ID) but is not marked as malicious or tainted because it is not associated with an alert.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["S1-10.A.1-3.png", "S1-10.A.2-2.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.003", "Subtechnique_Name": "Valid Accounts: Local Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed the Jesse account had logged into the system.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["S1-10.B.1-3.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "Telemetry from Nimda showed a TCP port 3389 connection from 10.0.1.6 (Nimda) to 10.0.0.5 (Conficker). The rundll32.exe process (PID 184) that was used to load updater.dll was used to proxy the RDP connection to Conficker. The telemetry was tainted by the activity generated during the privilege escalation step because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-10.B.1-1.png", "S1-10.B.1-2.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for the execution of autoupdate.vbs that was listed as an active threat.", "Detection_Type": "General Behavior", "Modifiers": [], "Screenshots": ["S1-11.A.1-2.png", "S1-11.A.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed wscript.exe executing autoupdate.vbs which then executed powershell.exe with an encoded PowerShell script.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["S1-11.A.1-2.png", "S1-11.A.1-1.png"], "Footnotes": []}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using port 443", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed network connections to 192.168.0.5 (C2 server) over TCP port 443. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-11.B.1-1.png"], "Footnotes": []}]}, {"Substep": "11.B.1", "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["S1-11.B.1-1.png"], "Footnotes": ["Vendor stated log files indicate the powershell process was using the SSL cache folder.", "Telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over TCP port 443 (no protocol was identified for this traffic)."]}]}, {"Substep": "11.B.1", "Procedure": "Empire: Encrypted C2 channel established using HTTPS", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["S1-11.B.1-1.png"], "Footnotes": ["Vendor stated log files indicate the powershell process was using the SSL cache folder.", "Telemetry showed an outbound network connection to 192.168.0.5 (C2 server) over TCP port 443 (no protocol was identified for this traffic)."]}]}]}, {"Step_Num": 12, "Step_Name": "Initial Discovery", "Substeps": [{"Substep": "12.A.1", "Procedure": "Empire: 'route print' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.A.1-2.png", "S1-12.A.1-3.png", "S1-12.A.1-1.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Empire: 'ipconfig -all' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.A.1-3.png", "S1-12.A.1-1.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Empire: 'whoami -all -fo list' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.A.1-3.png", "S1-12.A.1-2.png"], "Footnotes": []}]}, {"Substep": "12.C.1", "Procedure": "Empire: 'qprocess *' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.A.1-1.png", "S1-12.A.1-3.png"], "Footnotes": []}]}, {"Substep": "12.D.1", "Procedure": "Empire: 'net start' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.A.1-3.png", "S1-12.A.1-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1", "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed execution of a PowerShell script with follow-on enumeration activity that coincided with the execution of the WinEnum module. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.E.1-1.png"], "Footnotes": []}]}, {"Substep": "12.E.1.1", "Procedure": "Empire: WinEnum module included enumeration of user information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.2", "Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.3", "Procedure": "Empire: WinEnum module included enumeration of password policy information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1201", "Technique_Name": "Password Policy Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.4.1", "Procedure": "Empire: WinEnum module included enumeration of recently opened files", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.4.2", "Procedure": "Empire: WinEnum module included enumeration of interesting files", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.5", "Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": ["PowerShell telemetry showed execution of an encoded command and the script was decoded to Windows.Clipboard(...) outside of the capability, but this was not counted as a detection because it was external to the capability."]}]}, {"Substep": "12.E.1.6.1", "Procedure": "Empire: WinEnum module included enumeration of system information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing WMI queries that indicated operating system information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.E.1-2.png", "S1-12.E.1-3.png"], "Footnotes": []}]}, {"Substep": "12.E.1.6.2", "Procedure": "Empire: WinEnum module included enumeration of Windows update information", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.7", "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.8", "Procedure": "Empire: WinEnum module included enumeration of services", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.9.1", "Procedure": "Empire: WinEnum module included enumeration of available shares", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.9.2", "Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing WMI queries that indicated logical disk information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.E.1-2.png", "S1-12.E.1-3.png"], "Footnotes": []}]}, {"Substep": "12.E.1.10.1", "Procedure": "Empire: WinEnum module included enumeration of AV solutions", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "The capability enriched powershell.exe activity with the action \\\\\"attempted to find other installed security software.\\\\\" The enrichment was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.E.1-2.png", "S1-12.E.1-3.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing WMI queries that indicated antivirus product information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.E.1-2.png", "S1-12.E.1-3.png"], "Footnotes": []}]}, {"Substep": "12.E.1.10.2", "Procedure": "Empire: WinEnum module included enumeration of firewall rules", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "12.E.1.11", "Procedure": "Empire: WinEnum module included enumeration of network adapters", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing WMI queries that indicated network adapter and configuration information was queried. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.E.1-3.png", "S1-12.E.1-2.png"], "Footnotes": []}]}, {"Substep": "12.E.1.12", "Procedure": "Empire: WinEnum module included enumeration of established network connections", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing netstat.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.E.1-1.png"], "Footnotes": []}]}, {"Substep": "12.F.1", "Procedure": "Empire: 'net group \\\"Domain Admins\\\" -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.F.1-3.png"], "Footnotes": []}]}, {"Substep": "12.F.2", "Procedure": "Empire: 'Net Localgroup Administrators' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.F.1-1.png"], "Footnotes": []}]}, {"Substep": "12.G.1", "Procedure": "Empire: 'net user' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.001", "Subtechnique_Name": "Account Discovery: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.F.1-2.png", "S1-12.F.1-1.png", "S1-12.F.1-3.png"], "Footnotes": []}]}, {"Substep": "12.G.2", "Procedure": "Empire: 'net user -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by the alert generated during initial compromise because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-12.F.1-1.png", "S1-12.F.1-3.png", "S1-12.F.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Discovery for Lateral Movement", "Substeps": [{"Substep": "13.A.1", "Procedure": "Empire: 'net group \\\"Domain Computers\\\" -domain' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of net.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-13.A.1-1.png"], "Footnotes": []}]}, {"Substep": "13.B.1", "Procedure": "Empire: 'net use' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of net.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-13.A.1-1.png"], "Footnotes": []}]}, {"Substep": "13.B.2", "Procedure": "Empire: 'netstat -ano' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1049", "Technique_Name": "System Network Connections Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of netstat.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-13.A.1-1.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Empire:'reg query' via PowerShell to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of reg.exe with command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-13.A.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Privilege Escalation", "Substeps": [{"Substep": "14.A.1", "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed process integrity levels changing from medium to high (tainted by parent alert).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-14.A.1-1.png"], "Footnotes": ["Integrity level numbers are based upon how the capability tracks integrity levels and not how Windows tracks them causing a difference in values."]}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "14.A.1", "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed network connections over port 8080. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-14.A.1-2.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Credential Access", "Substeps": [{"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "The capability enriched data collected as keylogging behavior that was not visible through the standard interface during the evaluation.", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["S1-15.A.1-1.png"], "Footnotes": ["The capability associated the keylogging event to the parent Group ID even though it is not visible in the data provided."]}]}, {"Substep": "15.A.1", "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1010", "Technique_Name": "Application Window Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "15.B.1", "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Lateral Movement", "Substeps": [{"Substep": "16.A.1", "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of usersKmitnick, Bob, and Frieda", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.A.1-1.png", "S1-16.A.1-2.png"], "Footnotes": []}]}, {"Substep": "16.A.1", "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "Telemetry showed repeated logon attempts targeting ADMIN$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.A.1-2.png", "S1-16.A.1-1.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.003", "Subtechnique_Name": "Valid Accounts: Local Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a logon attempt using valid credentials of user Kmitnick via net.exe and command-line arguments (tainted by relationship to threat story). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.A.1-2.png", "S1-16.B.1-1.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting ADMIN$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.B.1-1.png", "S1-16.A.1-2.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "Criteria": "", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID). The log files showed an exit code of 0x2 which indicates a logon failure, but does not differentiate between bad credentials and access denied to resource.", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.A.1-2.png", "S1-16.B.1-1.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Empire: 'net use -delete' via PowerShell", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.005", "Subtechnique_Name": "Indicator Removal on Host: Network Share Connection Removal"}, "Detections": [{"Detection_Note": "Telemetry showed execution of net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.C.1-1.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "Telemetry showed a logon attempt via net.exe and command-line arguments targeting C$ via net.exe and command-line arguments. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.D.1-1.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "Telemetry showed a logon attempt via net.exe and command-line arguments using valid credentials of user Kmitnick. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.D.1-1.png"], "Footnotes": []}]}, {"Substep": "16.E.1", "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed creation and file write events for autoupdate.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.E.1-2.png", "S1-16.E.1-1.png"], "Footnotes": []}]}, {"Substep": "16.F.1", "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe execution of autoupdate.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.F.1-1.png"], "Footnotes": []}]}, {"Substep": "16.G.1", "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed creation of update.vbs on 10.0.0.4 (Creeper). The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.G.1-2.png"], "Footnotes": []}]}, {"Substep": "16.H.1", "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of sc.exe to query services on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.H.1-1.png"], "Footnotes": []}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "Telemetry showed execution of sc.exe to create the AdobeUpdater service on Creeper with a binPath pointing to cmd.exe to execute update.vbs. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.I.1-1.png"], "Footnotes": []}]}, {"Substep": "16.I.1", "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.004", "Subtechnique_Name": "Masquerading: Masquerade Task or Service"}, "Detections": [{"Detection_Note": "Telemetry showed executions of sc.exe to create the AdobeUpdater service on Creeper with a binPath pointing to cmd.exe to execute update.vbs as well as a setting the service description. An analyst can use this information to determine AdobeUpdater is masquerading. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.I.1-1.png"], "Footnotes": []}]}, {"Substep": "16.J.1", "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of sc.exe to query the AdobeUpdater service on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.J.1-1.png"], "Footnotes": []}]}, {"Substep": "16.K.1", "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a remote access event on update.vbs.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["MITRE verified telemetry was generated for the remote update.vbs file access event, but no screenshot was available."]}]}, {"Substep": "16.L.1", "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A General Behavior alert was generated for the lateral movement activity. A new story grouping was generated for the event on Creeper to associate subsequent activity.", "Detection_Type": "General Behavior", "Modifiers": [], "Screenshots": ["S1-16.L.1-1.png", "S1-16.G.1-1.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed execution of sc.exe to start the AdobeUpdater service on Creeper. The activity seen during the initial compromise step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-16.L.1-1.png", "S1-16.G.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Persistence", "Substeps": [{"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1007", "Technique_Name": "System Service Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed reg.exe execution with command-line arguments indicating a check to see if terminal services was enabled. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-17.A.1-4.png"], "Footnotes": []}]}, {"Substep": "17.A.1", "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed reg.exe execution with command-line arguments. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-17.A.1-4.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1222", "Technique_Name": "File and Directory Permissions Modification"}, "Subtechnique": {"Subtechnique_Id": "T1222.001", "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"}, "Detections": [{"Detection_Note": "Telemetry showed takeown.exe execution with command-line arguments containing magnify.exe. The event was enriched to show that ownership of a file was taken over. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["S1-17.A.1-1.png"], "Footnotes": []}]}, {"Substep": "17.B.2", "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1222", "Technique_Name": "File and Directory Permissions Modification"}, "Subtechnique": {"Subtechnique_Id": "T1222.001", "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"}, "Detections": [{"Detection_Note": "Telemetry showed icacls.exe execution with command-line arguments containing magnify.exe. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-17.A.1-3.png"], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.008", "Subtechnique_Name": "Event Triggered Execution: Accessibility Features"}, "Detections": [{"Detection_Note": "Telemetry showed file write of magnify.exe in the system directory from a file copy event for cmd.exe with matching hash values. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-17.C.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 18, "Step_Name": "Collection", "Substeps": [{"Substep": "18.A.1", "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.002", "Subtechnique_Name": "Data Staged: Remote Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed file write of the .vsdx to the Recycle Bin. The activity seen during the lateral movement step tainted the telemetry because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-18.B.1-1.png"], "Footnotes": []}]}, {"Substep": "18.B.1", "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1039", "Technique_Name": "Data from Network Shared Drive"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the .vsdx file copied from a network shared drive on Conficker. The activity seen during the lateral movement step tainted the telemetry because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-18.B.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 19, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "19.A.1", "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file creation event for recycler.exe on CodeRed along with MD5, SHA1, and SHA256 hashes. Hashes could be used to look up information on the binary. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-19.A.1-1.png", "S1-19.A.1-2.png"], "Footnotes": []}]}, {"Substep": "19.A.1", "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file write of recycler.exe with hash value. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-19.A.1-2.png", "S1-19.A.1-1.png"], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "Criteria": "", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "19.B.1", "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed execution of recycler.exe with command-line arguments, including the -hp flag, indicating use of encryption and compression with a WinRAR utility. The Process Name field in the row for recycler.exe enriched the event with \\\"Command line RAR\\\". The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Enrichment", "Modifiers": ["Tainted"], "Screenshots": ["S1-19.B.1-1.png", "S1-19.A.1-2.png"], "Footnotes": []}]}, {"Substep": "19.C.1", "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "Criteria": "", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed ftp.exe running with ftp.txt as an argument. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": [], "Footnotes": []}]}, {"Substep": "19.D.1", "Procedure": "Empire: 'del C:\\\\\"$\\\"Recycle.bin\\old.rar'", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed the file deletion of old.rar. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-19.D.1-1.png"], "Footnotes": []}]}, {"Substep": "19.D.2", "Procedure": "Empire: 'del recycler.exe'", "Criteria": "", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed the file deletion of recycler.exe. The activity seen during the lateral movement step tainted the event because it was associated with the same story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": ["Tainted"], "Screenshots": ["S1-19.D.1-1.png"], "Footnotes": []}]}]}, {"Step_Num": 20, "Step_Name": "Execution of Persistence", "Substeps": [{"Substep": "20.A.1", "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.008", "Subtechnique_Name": "Event Triggered Execution: Accessibility Features"}, "Detections": [{"Detection_Note": "Telemetry showed execution of magnify.exe which was identified as a Windows Command Processor within the interface. Activity associated with a new story (Group ID).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["S1-20.B.1-1.png"], "Footnotes": []}]}, {"Substep": "20.A.1", "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "Criteria": "", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "Criteria": "", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Enrichment showed execution of the whoami command (enriched with description \\\"whoami - displays logged on user information\\\"). Execution of whoami was associated to the story (Group ID) created from the execution of magnify.exe, but was not considered tainted because an alert was not generated when magnify.exe was executed.", "Detection_Type": "Enrichment", "Modifiers": [], "Screenshots": ["S1-20.B.1-1.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "apt29", "Display_Name": "APT29", "Evaluation_Year": 2019, "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6457.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of explorer.exe executing rcs.3aka3.doc.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12790.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for explorer.exe executing rcs.3aka3.doc.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-14532.png"], "Footnotes": []}]}, {"Substep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.002", "Subtechnique_Name": "Masquerading: Right-to-Left Override"}, "Detections": [{"Detection_Note": "A Technique alert detection called \"Masquerading\" was generated for \"SuspiciousCharInPath\" observed on rcs.3aka.doc.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6463.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for the RTLO character in [?]cod.3aka3.scr was used to masquerade as rcs.3aka.doc.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12369.png"], "Footnotes": []}]}, {"Substep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on TCP port 1234.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6468.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-14534.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"T1065 - Uncommonly Used Port\" was generated for rcs.3aka3.doc due to TCP port 1234 being used.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6462.png"], "Footnotes": []}]}, {"Substep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.001", "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6470.png", "SentinelOne-APT29-6469.png"], "Footnotes": []}]}, {"Substep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc.The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-16471.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1059\" contained evidence of cmd.exe spawning from rcs.3aka3.doc.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12794.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for rcs.3aka3.doc spawning cmd.exe.", "Detection_Type": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-17871.png"], "Footnotes": []}]}, {"Substep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6477.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1086\" contained evidence of powershell.exe spawning from cmd.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12795.png", "SentinelOne-APT29-12794.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for powershell.exe spawning from cmd.exe.", "Detection_Type": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-14541.png"], "Footnotes": []}]}]}, {"Step_Num": 2, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6485.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"File Enumeration\" occurred containing evidence of PowerShell searching the filesystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12796.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"File Enumeration\" under \"Discovery {T1083}\" was generated when powershell.exe executed Get-ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6487.png"], "Footnotes": []}]}, {"Substep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6485.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"InteractivePSCommand\" contained evidence of powershell.exe executing ChildItem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12797.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"Automated Collection\" was generated on powershell.exe executing Get-ChildItem after a short delay. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Delayed (Processing)", "Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6498.png"], "Footnotes": []}]}, {"Substep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe reading files from C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (Detections)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7164.png"], "Footnotes": ["A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005)."]}, {"Detection_Note": "An MSSP detection for \"PowerShell is seen enumerating the system and searching for files\" contained evidence of file reads to C:/Users/Pam/*.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12797.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"Data from Local System {T1005}\" was generated on powershell.exe executing Get-ChildItem and reading C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Configuration Change (Detections)", "Alert"], "Screenshots": ["SentinelOne-APT29-7164.png", "SentinelOne-APT29-7161.png"], "Footnotes": ["A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005)."]}]}, {"Substep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing Compress-Archive", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"Data Compressed. MITRE Exfiltration {T1002}\" was generated on powershell.exe compressing via Compress-Archive. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6486.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe compressing via Compress-Archive.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-14543.png", "SentinelOne-APT29-14542.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection occurred for powershell.exe compressing via Compress-Archive.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-14544.png", "SentinelOne-APT29-14546.png", "SentinelOne-APT29-14545.png"], "Footnotes": []}]}, {"Substep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "An MSSP detection for the file creation of Draft.zip was received. The alert stated that \"C:\\Users\\pam\\AppData\\Roaming\\Draft.zip\" file was created.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-10769.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-17890.png"], "Footnotes": []}]}, {"Substep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-14572.png", "SentinelOne-APT29-14571.png"], "Footnotes": ["A UX Configuration Change was made to bring host file reads into the UI."]}, {"Detection_Note": "An MSSP detection for \"T1041\" containing evidence of a cod.3aka3.scr reading Draft.zip and a network connection to C2 (192.168.0.5).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12800.png"], "Footnotes": []}]}]}, {"Step_Num": 3, "Step_Name": "Deploy Stealth Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed rcs.3aka3.doc creating new file monkey.png. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6500.png", "SentinelOne-APT29-6501.png", "SentinelOne-APT29-6499.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1105\" occurred containing evidence of rcs.3aka3.doc creating monkey.png.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12801.png"], "Footnotes": []}]}, {"Substep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within monkey.png", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.003", "Subtechnique_Name": "Obfuscated Files or Information: Steganography"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-7278.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1027\" occurred containing evidence of the PowerShell script contained within monkey.png.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12802.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"Steganography\" was generated when identifying the PowerShell script contained within monkey.png.  The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7279.png"], "Footnotes": ["A Detection Configuration Change was made to detect common extensions without the appropriate file type content in the file."]}]}, {"Substep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "Telemetry showed addition of the DelegateExecute Registry Value. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6508.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1122\" occurred containing evidence of DelegateExecute subkey being added to the Registry.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12804.png"], "Footnotes": []}]}, {"Substep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed a new high integrity PowerShell callback spawning from control.exe (spawned from sdclt.exe). The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6514.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1088\" occurred containing evidence of new high integrity PowerShell callback spawning from control.exe (spawned from sdclt.exe).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12805.png", "SentinelOne-APT29-12806.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"TokenManipulation\" was generated when user Pam targeted user \"NT AUTHORITY\\SYSTEM\" in conjunction with \"setcbprivilege\" usage. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6512.png", "SentinelOne-APT29-6513.png", "SentinelOne-APT29-6516.png"], "Footnotes": []}]}, {"Substep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe connecting outbound to 192.168.0.5 on TCP 443. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6515.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1043\" occurred containing evidence of powershell.exe connecting to 192.168.0.5 on TCP 443.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12807.png"], "Footnotes": []}]}, {"Substep": "3.B.4", "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6515.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1071\" occurred containing evidence of PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12807.png"], "Footnotes": []}]}, {"Substep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6515.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1032\" occurred containing evidence of the PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12807.png"], "Footnotes": []}]}, {"Substep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6520.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1112\" occurred containing evidence of command subkey being removed from the Registry.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12808.png"], "Footnotes": []}]}]}, {"Step_Num": 4, "Step_Name": "Clean Up and Reconnaissance", "Substeps": [{"Substep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6521.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1105\" occurred containing evidence of the file write of the ZIP by PowerShell.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12809.png"], "Footnotes": []}]}, {"Substep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Tactic alert detection called \"ProcessCreationExtra\" was generated for powershell.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-14583.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6524.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1086\" occurred containing evidence of a new interactive session of PowerShell being created.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-11807.png"], "Footnotes": []}]}, {"Substep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1140\" occurred containing evidence of the extracted root folder being created, and the contents extracted.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12810.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-7187.png", "SentinelOne-APT29-6523.png"], "Footnotes": []}]}, {"Substep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7189.png"], "Footnotes": ["A UX Configuration Change was made to bring Get-Process usage from host logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1057\" occurred containing evidence of PowerShell listing current process via \"Get-Process\".", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12811.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated for PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-14654.png"], "Footnotes": []}]}, {"Substep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.  The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6528.png", "SentinelOne-APT29-6527.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12812.png", "SentinelOne-APT29-12814.png", "SentinelOne-APT29-12813.png"], "Footnotes": []}]}, {"Substep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6527.png", "SentinelOne-APT29-6528.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12812.png", "SentinelOne-APT29-12813.png", "SentinelOne-APT29-12814.png"], "Footnotes": []}]}, {"Substep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6528.png", "SentinelOne-APT29-6527.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1107\" occurred containing evidence of Sdelete (Secure Deletion) being used to remove the original *.3aka3.* RAT, Draft.zip, and SysinternalSuite.zip).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12812.png", "SentinelOne-APT29-12813.png", "SentinelOne-APT29-12814.png"], "Footnotes": []}]}, {"Substep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing $env:TEMP", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection occurred for \"basic discovery\" containing evidence of $env:TEMP usage.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12815.png"], "Footnotes": []}]}, {"Substep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"basic discovery\" containing evidence of $env:USERNAME usage.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12815.png"], "Footnotes": []}]}, {"Substep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"basic discovery\" containing evidence of $env:COMPUTERNAME usage.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12815.png"], "Footnotes": []}]}, {"Substep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"basic discovery\" containing evidence of $env:USERDOMAIN usage.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12815.png"], "Footnotes": []}]}, {"Substep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection for \"ProcessEnumeration\" was generated when PowerShell accessed $PID. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6536.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing: $PID.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "An MSSP detection for \"basic discovery\" containing evidence of $PID usage.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12815.png"], "Footnotes": []}]}, {"Substep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection for \"Local Environment Information Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing Win32_OperatingSystem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6535.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing Win32_OperatingSystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12816.png"], "Footnotes": []}]}, {"Substep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"Security Software Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing AntiVirusProduct.  The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6532.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe executing: Get-WmiObject ... -Class AntiVirusProduct.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "An MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing AntiVirusProduct.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12817.png"], "Footnotes": []}]}, {"Substep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing: Get-WmiObject ... -Class FireWallProduct.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A Technique alert detection for \"Security Software Discovery\" specific to WMI was generated when PowerShell executed the suspicious WMI query containing FireWallProduct. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6533.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"use of Gwmi\" occurred containing evidence of WMI query containing FireWallProduct.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12817.png"], "Footnotes": []}]}, {"Substep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe executing the NetUserGetGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.002", "Subtechnique_Name": "Permission Groups Discovery: Domain Groups"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.C.11", "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API", "Criteria": "powershell.exe executing the NetUserGetLocalGroups API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1069", "Technique_Name": "Permission Groups Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1069.001", "Subtechnique_Name": "Permission Groups Discovery: Local Groups"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}]}, {"Step_Num": 5, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1543", "Technique_Name": "Create or Modify System Process"}, "Subtechnique": {"Subtechnique_Id": "T1543.003", "Subtechnique_Name": "Create or Modify System Process: Windows Service"}, "Detections": [{"Detection_Note": "An MSSP detection occurred for PowerShell initiating a new persistence service \"javamtsup\".", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12819.png", "SentinelOne-APT29-12818.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"ServiceCreate\" under \"Persistence {T1084}\" was generated due to \"javamtsup\" being added to the \"...\\Services\" registry path. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6556.png", "SentinelOne-APT29-6555.png", "SentinelOne-APT29-6554.png"], "Footnotes": []}]}, {"Substep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"StartupDirectory\" under was generated due to the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6559.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the creation of hostui.lnk in the Startup folder. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-14685.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1060\" occurred containing evidence of PowerShell placing LNK in startup folder, gaining persistence to launch hostui.bat.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12821.png", "SentinelOne-APT29-12820.png"], "Footnotes": []}]}]}, {"Step_Num": 6, "Step_Name": "Credential Access", "Substeps": [{"Substep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.001", "Subtechnique_Name": "Unsecured Credentials: Credentials in Files"}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1081\" occurred containing evidence of accesschk.exe reading the Chrome database file for credentials.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12822.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"BrowserInfoStealing\" under \"Collection {T1213}\" was generated when accesschk.exe read the Chrome database file for credentials. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6564.png"], "Footnotes": []}]}, {"Substep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesschk.exe executing the CryptUnprotectedData API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash value provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6569.png", "SentinelOne-APT29-6562.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1036\" occurred containing evidence of accesschk.exe with an MD5 value which was also found publicly and is known to be malicious.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12822.png"], "Footnotes": []}]}, {"Substep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1552", "Technique_Name": "Unsecured Credentials"}, "Subtechnique": {"Subtechnique_Id": "T1552.004", "Subtechnique_Name": "Unsecured Credentials: Private Keys"}, "Detections": [{"Detection_Note": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6570.png"], "Footnotes": []}]}, {"Substep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.002", "Subtechnique_Name": "OS Credential Dumping: Security Account Manager"}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1003\" occurred containing evidence of credential dumping as indicated by \"Infostealer.\"", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12823.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when PowerShell read sensitive information from LSASS. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6573.png"], "Footnotes": ["This activity would have been blocked."]}, {"Detection_Note": "Telemetry shows a remote process injection into lsass.exe by powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-17881.png"], "Footnotes": []}]}]}, {"Step_Num": 7, "Step_Name": "Collection and Exfiltration", "Substeps": [{"Substep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection for \"Screenshot\" generated due to CopyFromScreen API execution. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7238.png", "SentinelOne-APT29-7239.png"], "Footnotes": ["A Detection Configuration Change was made to align CopyFromScreen usage with \"Screenshot\"."]}, {"Detection_Note": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7219.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1113\" occurred containing evidence of System.Drawing.dll being loaded and Invoke-ScreenCapture called.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12824.png", "SentinelOne-APT29-12825.png"], "Footnotes": []}]}, {"Substep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1115", "Technique_Name": "Clipboard Data"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7206.png"], "Footnotes": ["A UX Configuration Change was made to bring Get-Clipboard usage from host logs into the user interface."]}, {"Detection_Note": "A Technique alert detection for \"ClipBoardAccess\" was generated due to PowerShell executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-7216.png"], "Footnotes": ["A Detection Configuration Change was made to align Get-Clipboard cmdlet usage with \"ClipBoardAccess\"."]}]}, {"Substep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"SuspiciousKeylogging\" was generated due to GetAsyncKeyState execution. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert", "Configuration Change (Detections)"], "Screenshots": ["SentinelOne-APT29-7214.png"], "Footnotes": ["A Detection Configuration Change was made to align GetAsyncKeyState usage with \"SuspiciousKeylogging\" under \"Collection {T1056}\"."]}, {"Detection_Note": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7211.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1056\" occurred containing evidence of GetAsyncKeyState API calls and Get-Keystrokes function call.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12827.png", "SentinelOne-APT29-12826.png"], "Footnotes": []}]}, {"Substep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": ["Delayed (Manual)", "Host Interrogation"], "Screenshots": ["SentinelOne-APT29-6686.png"], "Footnotes": ["The script containing the variables in scope was manually recovered from the system by the analyst, so it is identified as Host Interrogation."]}, {"Detection_Note": "A Technique alert detection for \"Data from Local System {T1005}\" was generated due to powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated", "Configuration Change (Detections)"], "Screenshots": ["SentinelOne-APT29-14732.png"], "Footnotes": ["A Detection Configuration Change was made to align PowerShell process file reads with Data from Local System (T1005)"]}]}, {"Substep": "7.B.2", "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6670.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"exfiltrate\" occurred containing evidence of OfficeSupplies.7z being created.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12828.png"], "Footnotes": []}]}, {"Substep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7224.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"Exfiltrate\" occurred containing evidence of Compress-7zip compressing and encrypting the download directory with 7z using the password \"lolol.\"", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12828.png"], "Footnotes": []}]}, {"Substep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1048", "Technique_Name": "Exfiltration Over Alternative Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1048.003", "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"}, "Detections": [{"Detection_Note": "An MSSP detection occurred containing evidence of exfiltration via WebDav.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12829.png", "SentinelOne-APT29-12828.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PoweShell Copy-Item to remote a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7231.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"Step_Num": 8, "Step_Name": "Expand Access", "Substeps": [{"Substep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4). The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6692.png", "SentinelOne-APT29-6690.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1018\" occurred containing evidence of Ad-Search function definition along with LDAP network connection to NewYork (10.0.0.4).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12830.png"], "Footnotes": []}]}, {"Substep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"WinRMSession\" under \"Lateral Movement {T1028}\" was generated when a connection to remote host Scranton (10.0.1.4) from host Nashua (10.0.1.6) over port 5985 using the wsman protocol was issued.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6698.png", "SentinelOne-APT29-6695.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1028\" occurred containing evidence of Lateral Movement via WinRM with wsman network connection to host Scranton (10.0.1.4) over port 5985.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12830.png", "SentinelOne-APT29-12831.png"], "Footnotes": []}]}, {"Substep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7233.png"], "Footnotes": ["A UX Configuration Change was made to bring Get-Process usage from host logs into the user interface."]}, {"Detection_Note": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated due to Invoke-Command executing Get-Process.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6696.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"ProcessEnumeration\" occurred containing evidence of WinRM alerting on Get-Process.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12831.png"], "Footnotes": []}]}, {"Substep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed the file create event of python.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6699.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1105\" occurred containing evidence of python.exe file creation.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12832.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection for \"AdminShareAccess\" was generated when python.exe was written from host Nashua (10.0.1.6) to the ADMIN$ share on host Scranton (10.0.1.4), indicating Lateral Movement.  The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Tactic", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6697.png"], "Footnotes": []}]}, {"Substep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "T1027.002", "Subtechnique_Name": "Obfuscated Files or Information: Software Packing"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"UPXProcess\" under \"Defense Evasion {T1045}\" was generated due to python.exe being packed with UPX.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6725.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12833.png"], "Footnotes": []}]}, {"Substep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam", "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique alert detection \"UserLogin\" under \"Valid Accounts {T1078}\" showed a valid logon on Scranton (10.0.1.4) as user Pam.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-17872.png"], "Footnotes": []}]}, {"Substep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135 identified as RPC.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-14733.png", "SentinelOne-APT29-6718.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1077\" occurred containing evidence of  PsExec64.exe establishing SMB session to Scranton's IPC$ share, and writes PSEXESVC.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12835.png", "SentinelOne-APT29-12834.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"AdminShareAccess\" was generated due to PSEXESVC.exe being copied to $ADMIN on Scranton (10.0.1.4). The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6721.png"], "Footnotes": []}]}, {"Substep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6727.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called \"ProcessCreationExtra\" was generated due to PSEXESVC.exe executing python.exe.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-14734.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1035\" occurred containing evidence of PsExec executing python.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12835.png"], "Footnotes": []}]}]}, {"Step_Num": 9, "Step_Name": "Clean Up, Collection, and Exfiltration", "Substeps": [{"Substep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file rar.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed a file creation event for python.exe creating rar.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6738.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Python spawns PowerShell which then writes rar.exe and sdelete64.exe\" occurred containing evidence of file write events for rar.exe and sdelete64.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12836.png"], "Footnotes": []}]}, {"Substep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)", "Criteria": "python.exe creating the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed File Creation event for python.exe creating sdelete64.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6739.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"Python spawns PowerShell which then writes Rar.exe and sdelete64.exe\" occurred containing evidence of file write events for rar.exe and sdelete64.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12836.png"], "Footnotes": []}]}, {"Substep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from python.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6753.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1086\" occurred containing evidence of python.exe executing powershell.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12837.png"], "Footnotes": []}]}, {"Substep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7235.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1083\" occurred containing evidence of enumerating directories in search for specific files. The function \"ChildItem\" is observed.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12838.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"File Enumeration\" under \"Discovery {T1083}\" was generated when powershell.exe executed Get-ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6751.png"], "Footnotes": []}]}, {"Substep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1119", "Technique_Name": "Automated Collection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7235.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1119\" occurred containing evidence of enumerating directories in search for specific files. The function \"ChildItem\" is observed.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12838.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"Automated Collection\" was generated when powershell.exe accessed multiple files when using ChildItem. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (UX)", "Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-17873.png"], "Footnotes": ["A UX Configuration Change was made to bring host file reads into the UI."]}]}, {"Substep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection for \"OpenedFile\" under \"Data from Local System {T1005}\" was generated when a known malicious powershell.exe read files in C:\\Users\\Pam\\*. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-7240.png", "SentinelOne-APT29-7241.png"], "Footnotes": ["A Detection Configuration Change was made to Get-ChildItem to align usage with Data from Local System (T1005)."]}]}, {"Substep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed a File Creation event for powershell.exe creating working.zip.The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6743.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1074\" occurred containing evidence of working.zip creation from file creation events.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12839.png"], "Footnotes": []}]}, {"Substep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6744.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1022\" occurred containing evidence of rar.exe being executed with an encryption password parameter passed.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12839.png"], "Footnotes": []}]}, {"Substep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6744.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1002\" occurred containing evidence of powershell.exe executing rar.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12839.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection called \"Compression\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-14735.png"], "Footnotes": []}]}, {"Substep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe reading the file working.zip while connected to the C2 channel", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over TCP port 8443).", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-6748.png", "SentinelOne-APT29-7242.png"], "Footnotes": ["A UX Configuration Change was made to bring host file reads into the UI."]}, {"Detection_Note": "An MSSP detection for \"T1041\" occurred containing evidence of the C2 instance of Python.exe being observed establishing a network connection to 192.168.0.4 on port 8443 (https).", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-13193.png", "SentinelOne-APT29-12839.png"], "Footnotes": []}]}, {"Substep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed a file deletion event for secure file delete deleting rar.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6767.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12840.png"], "Footnotes": []}]}, {"Substep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to Desktop\\working.zip. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6765.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12840.png"], "Footnotes": []}]}, {"Substep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "An MSSP detection for \"sdelete\" occurred containing evidence of sdelete being run to delete rar.exe, and working.zip.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12840.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6769.png"], "Footnotes": []}]}, {"Substep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "Telemetry showed a file deletion event on \"Windows Command Processor\" deleting sdelete64.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6766.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"executing a deletion\" occurred containing evidence of cmd.exe being run to delete sdelete64.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12840.png"], "Footnotes": []}]}]}, {"Step_Num": 10, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "Telemetry showed javamtsup.exe with parent process services.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6770.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1035\" occurred containing evidence of javamtsup.exe with parent process services.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12841.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called \"ProcessCreationExtra\" was generated when services.exe executed javamtsup.exe.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-14736.png"], "Footnotes": []}]}, {"Substep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "An MSSP detection for \"startup persistence\" occurred containing evidence of hostui.lnk executing from Startup Folder.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12842.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"StartedFromLnk\" under \"Registry Run Keys / Startup Folder {T1060}\" was generated due to hostui.lnk triggering on login from the StartUp Folder.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": ["SentinelOne-APT29-7243.png"], "Footnotes": ["A Detection Configuration Change was made to capture .lnk files triggering on login from the StartUp folder. Aligned usage with \"StartedFromLnk\" under \"Registry Run Keys / Startup Folder {T1060}\"."]}, {"Detection_Note": "Telemetry showed hostui.lnk executing from the Startup Folder.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-7243.png"], "Footnotes": []}]}, {"Substep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Minimum detection criteria was not met for this procedure.", "Detection_Type": "None", "Modifiers": [], "Screenshots": [], "Footnotes": []}]}, {"Substep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1134", "Technique_Name": "Access Token Manipulation"}, "Subtechnique": {"Subtechnique_Id": "T1134.002", "Subtechnique_Name": "Access Token Manipulation: Create Process with Token"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"TokenMismatch\" under \"Privilege Escalation {T1134}\" was generated when the parent process's, hostui.exe, token did not match the child token process's, powershell.exe, token. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6772.png"], "Footnotes": []}]}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Compromise", "Substeps": [{"Substep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "T1204.002", "Subtechnique_Name": "User Execution: Malicious File"}, "Detections": [{"Detection_Note": "Telemetry showed explorer.exe executing powershell.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6783.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection was generated for a suspicious powershell.exe process spawning.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6787.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1204\" occurred containing evidence of powershell.exe execution targeting .lnk payload.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12843.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection called \"ProcessCreationExtra\" was generated when explorer.exe executed powershell.exe.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-14963.png"], "Footnotes": []}]}, {"Substep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1564", "Technique_Name": "Hide Artifacts"}, "Subtechnique": {"Subtechnique_Id": "T1564.004", "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6785.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1096\" occurred containing evidence of powershell.exe executing schemas ADS via Get-Content and IEX.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12843.png"], "Footnotes": []}]}, {"Substep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1497\" occurred containing evidence of WMI query targeting Win32_BIOS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12844.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}, {"Detection_Note": "A Tactic alert detection for \"Discovery\" under \"SuspiciousWMIQuery\" was generated on a suspicious WMI query targeting Win32_BIOS.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6791.png"], "Footnotes": []}]}, {"Substep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1082\" occurred containing evidence of WMI query targeting Win32_BIOS and Win32_ComputerSystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12844.png"], "Footnotes": []}, {"Detection_Note": "A Tactic alert detection for \"Discovery\" was generated on a suspicious WMI query targeting Win32_BIOS and Win32_ComputerSystem.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6793.png", "SentinelOne-APT29-6791.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"Substep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1120", "Technique_Name": "Peripheral Device Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1120\" occurred containing evidence of WMI query targeting Win32_PnPEntity.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12845.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"{T1120}\" (Peripheral Device Discovery) was generated due to a suspicious WMI query for Win32_PnPEntity.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6792.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"Substep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic alert detection for \"Discovery\" was generated on a suspicious WMI query targeting Win32_ComputerSystem.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6793.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"information discovery\" occurred containing evidence of WMI query targeting Win32_ComputerSystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12845.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-17530.png"], "Footnotes": []}]}, {"Substep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"Discovery {T1016}\" was generated on a suspicious WMI query targeting Win32_ComputerSystem.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6793.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"information discovery\" occurred containing evidence of WMI query targeting Win32_ComputerSystem.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12845.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-17530.png"], "Footnotes": []}]}, {"Substep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic alert detection for \"Discovery\" under \"SuspiciousWMIQuery\" was generated on a suspicious WMI query targeting Win32_Process.", "Detection_Type": "Tactic", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6794.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"information discovery\" occurred containing evidence of Process Enumeration relating to WMI query targeting Win32_Process.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12845.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated due to the PowerShell gwmi query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-14983.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-17534.png"], "Footnotes": []}]}, {"Substep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Get-Item for the current path.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7244.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"information discovery\" occurred containing evidence of File Enumeration relating to Get-Item function.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12846.png"], "Footnotes": []}]}, {"Substep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1140\" occurred containing evidence of certutil.exe decoding kxwn.lock with command-line arguments.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12848.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6784.png"], "Footnotes": []}]}, {"Substep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1060\" occurred containing evidence of Webcache subkey added to Registry.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12848.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"RegistryAutorun\" under \"Persistence {T1060}\" was generated for powershell.exe adding Run key persistence into the Registry.", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6786.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6786.png"], "Footnotes": []}]}, {"Substep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6785.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1086\" occurred containing evidence of PowerShell stager executing (IEX) from schemas via script block logs.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12848.png"], "Footnotes": []}]}, {"Substep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1043", "Technique_Name": "Commonly Used Port"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6786.png", "SentinelOne-APT29-6810.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1043\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12849.png"], "Footnotes": []}]}, {"Substep": "11.A.14", "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1071\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12849.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6810.png"], "Footnotes": []}]}, {"Substep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6810.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1032\" occurred containing evidence of PowerShell making network connection to C2 (192.168.0.4) over port 443 via HTTPS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12849.png"], "Footnotes": []}]}]}, {"Step_Num": 12, "Step_Name": "Fortify Access", "Substeps": [{"Substep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell enumeration of System32.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7245.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1083\" occurred containing evidence of PowerShell enumeration of System32.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12852.png"], "Footnotes": []}]}, {"Substep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.006", "Subtechnique_Name": "Indicator Removal on Host: Timestomp"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"FileTimeCopied\" was generated due to GetCreationTime API call targeting kxwn.lock. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6828.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1099\" occurred containing evidence of timestamp modifications of kxwn.lock.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12852.png", "SentinelOne-APT29-12853.png"], "Footnotes": []}]}, {"Substep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1518", "Technique_Name": "Software Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1518.001", "Subtechnique_Name": "Software Discovery: Security Software Discovery"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"SuspiciousWMIQuery\" under \"Discovery {T1063}\" was generated when PowerShell gwmi queried for AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6830.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection occurred containing evidence of gwmi query being used to enumerate AV software via \"detectav\" PowerShell function.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12854.png", "SentinelOne-APT29-12855.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"Substep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7246.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1012\" occurred containing scriptblock with registry query for installed software.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12856.png"], "Footnotes": []}]}, {"Substep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed scriptblock with registry query for installed software. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-7247.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1012\" occurred containing scriptblock with registry query for installed software.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12856.png"], "Footnotes": []}]}]}, {"Step_Num": 13, "Step_Name": "Reconnaissance", "Substeps": [{"Substep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7248.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1082\" occurred containing evidence of PowerShell calling the GetComputerNameEx API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12857.png"], "Footnotes": []}]}, {"Substep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7249.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-17874.png"], "Footnotes": []}]}, {"Substep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell script block log with function definition of \"user\" which calls GetUserNameEx API. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7250.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"Substep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection for \"ProcessEnumeration\" was generated due to running processes being enumerated. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6846.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7252.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1057\" occurred containing evidence of Process Enumeration and \"pslist\" function which calls CreateToolhelp32Snapshot API.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12859.png"], "Footnotes": []}]}]}, {"Step_Num": 14, "Step_Name": "Elevation & Credential Access", "Substeps": [{"Substep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.015", "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell function definition of \"bypass\" which adds the DelegateExecute subkey. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7254.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1122\" occurred containing evidence of \"bypass\" function definition with Software\\classes\\folder Registry key being modified and leveraged in COM hijacking.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12863.png"], "Footnotes": []}]}, {"Substep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6851.png", "SentinelOne-APT29-6850.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1088\" occurred containing evidence of a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe) with TokenMismatch indicator.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12861.png", "SentinelOne-APT29-12863.png", "SentinelOne-APT29-12860.png"], "Footnotes": []}]}, {"Substep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed powershell.exe deleting the command subkey. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7254.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1112\" occurred containing evidence of \"bypass\" function definition removing Registry subkey.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12863.png"], "Footnotes": []}]}, {"Substep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1047", "Technique_Name": "Windows Management Instrumentation"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6880.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"WMI Operation\" under \"Execution {T1047}\" was generated on Win32_AuditCode usage. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6874.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"WMI Operation\" occurred containing evidence of Win32_AuditCode usage. WmiPrvSE.exe executed powershell.exe with decoded payload.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12865.png", "SentinelOne-APT29-12866.png", "SentinelOne-APT29-12864.png"], "Footnotes": []}]}, {"Substep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7258.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "A Technique alert detection for \"ProcessEnumeration\" under \"Discovery {T1057}\" was generated for PowerShell executing Get-Process. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6876.png"], "Footnotes": []}]}, {"Substep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "An MSSP detection for \"FileModification\" occurred containing evidence of file write and analysis of m.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12867.png", "SentinelOne-APT29-12869.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-17875.png"], "Footnotes": []}]}, {"Substep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when m.exe read sensitive memory from lsass.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6870.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1003\" occurred containing evidence of Mimikatz sekurlsa::logonpasswords usage via m.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12870.png"], "Footnotes": []}, {"Detection_Note": "Telemetry shows a remote process injection into lsass.exe by Mimikatz. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"Substep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7260.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1027\" occurred containing evidence of \"wmidump\" function definition and WMI indicators writing to Win32_AuditCode.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12871.png", "SentinelOne-APT29-12872.png"], "Footnotes": []}]}, {"Substep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7261.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1027\" occurred containing evidence of \"wmidump\" function definition and WMI indicators reading from Win32_AuditCode.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12872.png", "SentinelOne-APT29-12873.png"], "Footnotes": []}]}]}, {"Step_Num": 15, "Step_Name": "Establish Persistence", "Substeps": [{"Substep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7262.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}, {"Substep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"WMI\" under \"Persistence {T1084}\" was generated when a WMI binding was created under root/subscription. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6895.png"], "Footnotes": []}, {"Detection_Note": "A General detection for a suspicious \"WMIOperation\" showed WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "General", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6896.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1084\" occurred containing evidence of WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12876.png", "SentinelOne-APT29-12875.png", "SentinelOne-APT29-12874.png"], "Footnotes": []}]}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell loading System.DirectoryServices.dll and making a network connection to the domain controller NewYork (10.0.0.4).", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6906.png", "SentinelOne-APT29-6899.png"], "Footnotes": []}]}, {"Substep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7264.png", "SentinelOne-APT29-7265.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1033\" occurred containing evidence of ConvertSidToStringSid API usage.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12877.png"], "Footnotes": []}]}, {"Substep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Configuration Change (UX)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7264.png", "SentinelOne-APT29-7265.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1106\" occurred containing evidence of ConvertSidToStringSid API with Advapi32.dll.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12877.png"], "Footnotes": []}]}, {"Substep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Telemetry showed connection to remote host NewYork (10.0.0.4) over port 5985 using the wsman protocol. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-15014.png", "SentinelOne-APT29-6910.png"], "Footnotes": []}, {"Detection_Note": "A Technique alert detection for \"WinRMSession\" was generated for the creation of a WinRM session. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-6913.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1028\" occurred containing evidence of a connection to remote host NewYork (10.0.0.4) over port 5985 using the wsman protocol, and a WinRM indicator for Lateral Movement.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12879.png"], "Footnotes": []}]}, {"Substep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0001", "Tactic_Name": "Initial Access"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"UserLogin\" was generated when valid user MScott was used to log onto NewYork (10.0.0.4).", "Detection_Type": "Technique", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6915.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1078\" occurred containing evidence of process wsmprovhost.exe creation by mscott on remote host proving valid logon.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12880.png"], "Footnotes": []}]}, {"Substep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General alert detection (medium severity) was generated identifying m.exe as a threat file.", "Detection_Type": "General", "Modifiers": ["Alert"], "Screenshots": ["SentinelOne-APT29-6917.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed a file write event for m.exe in the System32 directory by \"Host process for WinRM plug-ins\". The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6918.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"File Creation\" occurred containing evidence of file write of m.exe to System32 directory by WinRM.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12881.png"], "Footnotes": []}]}, {"Substep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"SensitiveMemoryAccess\" under \"Credential Access {T1003}\" was generated when m.exe read sensitive memory from lsass.exe. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6922.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"SensitiveMemoryAccess\" occurred containing evidence of mimikatz lsadump::lsa /inject /name:krbtgt via m.exe.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12882.png", "SentinelOne-APT29-12881.png"], "Footnotes": []}, {"Detection_Note": "Telemetry shows a remote process injection into lsass.exe by Mimikatz. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-17880.png"], "Footnotes": []}]}]}, {"Step_Num": 17, "Step_Name": "Collection", "Substeps": [{"Substep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1114", "Technique_Name": "Email Collection"}, "Subtechnique": {"Subtechnique_Id": "T1114.001", "Subtechnique_Name": "Email Collection: Local Email Collection"}, "Detections": [{"Detection_Note": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6925.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1114\" occurred containing evidence of Outlook process being started from the parent process \"svchost.exe\" along with the function definition for \"psemail\".", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12883.png"], "Footnotes": []}]}, {"Substep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection for Data from Local System was generated for a process reading MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)", "Correlated"], "Screenshots": ["SentinelOne-APT29-7266.png"], "Footnotes": ["The logic used to produce this detection was configured after the start of the evaluation, so it is identified as a Detection Configuration Change."]}]}, {"Substep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1074", "Technique_Name": "Data Staged"}, "Subtechnique": {"Subtechnique_Id": "T1074.001", "Subtechnique_Name": "Data Staged: Local Data Staging"}, "Detections": [{"Detection_Note": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.  The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6938.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1074\" occurred containing evidence of Copy-Item with ..\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML being the destination file.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12884.png"], "Footnotes": []}]}, {"Substep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "A Technique alert detection for \"Data Compressed\" was generated due to an entropy calculation of WindowsParentalControlMigration.tmp. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-6950.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7273.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1002\" occurred containing evidence of \"zip\" function compressing collection via ZipFile.CreateFromDirectory .NET method.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12885.png"], "Footnotes": []}]}, {"Substep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique alert detection called \"HeaderExtensionMismatch\" was generated due to file header not matching file extension. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Technique", "Modifiers": ["Configuration Change (Detections)", "Correlated", "Alert"], "Screenshots": ["SentinelOne-APT29-7274.png"], "Footnotes": ["A Detection Configuration Change was made to identify \"HeaderExtensionMismatch\", generated on file header not matching file extension."]}, {"Detection_Note": "An MSSP detection occurred containing evidence that additional bytes were used to disguise a zip as a GIF image format.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12885.png"], "Footnotes": []}, {"Detection_Note": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-15041.png", "SentinelOne-APT29-15040.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}]}]}, {"Step_Num": 18, "Step_Name": "Exfiltration", "Substeps": [{"Substep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1102", "Technique_Name": "Web Service"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-6955.png", "SentinelOne-APT29-6952.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1102\" occurred containing evidence of net.exe with command-line arguments connecting to OneDrive public IP and URL over port 443 using HTTPS.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12886.png", "SentinelOne-APT29-12887.png"], "Footnotes": []}]}, {"Substep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1567", "Technique_Name": "Exfiltration Over Web Service"}, "Subtechnique": {"Subtechnique_Id": "T1567.002", "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated", "Configuration Change (UX)"], "Screenshots": ["SentinelOne-APT29-7282.png"], "Footnotes": ["A UX Configuration Change was made to bring PowerShell script block logs into the user interface."]}, {"Detection_Note": "An MSSP detection for \"T1048\" occurred containing evidence of PowerShell executing Copy-Item on WindowsParentalControlMigration.tmp.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12887.png"], "Footnotes": []}]}]}, {"Step_Num": 20, "Step_Name": "Persistence Execution", "Substeps": [{"Substep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.011", "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32"}, "Detections": [{"Detection_Note": "Telemetry showed rundll32.exe executing kxwn.lock.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6980.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1085\" occurred containing evidence of rundll32.exe executing kxwn.lock.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12891.png"], "Footnotes": []}]}, {"Substep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.003", "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"}, "Detections": [{"Detection_Note": "Telemetry showed the WMI Provider Host executing the PowerShell stager.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6992.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection contained evidence of wmiprvse.exe executing the PowerShell stager.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-17876.png"], "Footnotes": []}]}, {"Substep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "Telemetry showed a SYSTEM-level powershell.exe spawning from wmiprvse.exe.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-6992.png", "SentinelOne-APT29-6991.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"PowerShell\" occurred containing evidence of WMI Provider Host spawning PowerShell.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12892.png"], "Footnotes": []}]}, {"Substep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.003", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket"}, "Detections": [{"Detection_Note": "An MSSP detection for \"T1097\" occurred containing evidence of  Invoke-Mimikatz (kerberos::golden) usage along with Token Manipulation indicator.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12893.png"], "Footnotes": []}, {"Detection_Note": "A General alert detection for \"TokenPrivAdd\" under \"Privilege Escalation/Defense Evation {T1134} \" was generated when Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session was executed. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": ["SentinelOne-APT29-7011.png"], "Footnotes": []}]}, {"Substep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.006", "Subtechnique_Name": "Remote Services: Windows Remote Management"}, "Detections": [{"Detection_Note": "Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent grouping of malicious activity.", "Detection_Type": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": ["SentinelOne-APT29-7016.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1028\" occurred containing evidence of Enter-PSSession to create WinRM session to remote host Scranton (10.0.1.4) over port 5985.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12894.png"], "Footnotes": []}]}, {"Substep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1136", "Technique_Name": "Create Account"}, "Subtechnique": {"Subtechnique_Id": "T1136.001", "Subtechnique_Name": "Create Account: Local Account"}, "Detections": [{"Detection_Note": "Telemetry showed wsmprovhost.exe spawning net1.exe with the command-line arguments to add the new user Toby.", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["SentinelOne-APT29-7041.png"], "Footnotes": []}, {"Detection_Note": "An MSSP detection for \"T1136\" occurred containing evidence of Invoke-Command with command-line arguments adding the user Toby.", "Detection_Type": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": ["SentinelOne-APT29-12894.png"], "Footnotes": []}]}]}]}}}, {"Adversary_Name": "carbanak_fin7", "Display_Name": "Carbanak+FIN7", "Evaluation_Year": 2020, "Eval_Range_Screenshots": {"Scenario_1": [{"Screenshot_Name": "Carbanak-FIN7_SO_1_4.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_SO_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_SO_1_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_SO_1_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_SO_1_3.png", "Screenshot_Caption": ""}], "Scenario_2": [{"Screenshot_Name": "Carbanak-FIN7_SO_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_SO_2_1.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_SO_2_2.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_SO_2_3.png", "Screenshot_Caption": ""}, {"Screenshot_Name": "Carbanak-FIN7_SO_2_4.png", "Screenshot_Caption": ""}]}, "Linux_Participant": true, "Alerting_Strategy": "Alerts are generated for events that match a behavioral pattern identified with malicious behavior(s) on a host and assigned a mitigation threat status, alert confidence level, and incident status. The alert view presents a timeline of additional behavioral indicators associated with the alert, a general description of the event triggered, potential mapping(s) to related ATT&CK Tactics and Techniques, and host information. Once an alert is generated, a storyline number is assigned with all associated events triggered. Additional events are called, behavioral indicators and aggregated in a different view.", "Correlation_Strategy": "After the initial Alert is fired, additional alerts linked to the initial alert are identified as Behavioral Indicators. Behavioral Indicators are individual events that have triggered as a result of a malicious behavior and use a unique number to maintain association with the initial Alert known as a Storyline ID. Using the Hunting View, Behavioral Indicators are enriched with metadata such as process information, network connections, associated file events, and descriptions with potential mapping to related ATT&CK tactics and techniques.  Behavioral Indicators are aggregated into a central queue associated with the initial Alert that Analysts can query. Behavioral Indicators can be associated across multiple devices throughout the environment or a single device. Additional Dashboard views also exist to visualize the incident timeline, connections between processes, and associated behavioral indicators. Using the Storyline ID link between events, mitigation strategies can be deployed for one alert and potentially resolve all associated Behavioral Indicators.", "Detections_By_Step": {"Scenario_1": {"Steps": [{"Step_Num": 1, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "1.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}, {"Detection_Note": "A Technique detection named \"UserExecution\" was generated when explorer.exe spawned winword.exe when the user clicks 1-list.rtf.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "UserExecution"}], "Linux_Only": false}, {"Substep": "1.A.2", "Procedure": "", "Criteria": "winword.exe loads VBE7.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "Behavioral Indicators"}, {"Detection_Note": "A Technique detection named \"Behavioral Inidicators\" was generated when winword.exe loaded VBE7.DLL and spawned 1-list.rtf.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "Behavioral Inidicators"}], "Linux_Only": false}, {"Substep": "1.A.3", "Procedure": "", "Criteria": "wscript.exe executes unprotected.vbe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Technique detection named \"Command Script\" was generated when wscript.exe spawned unprotected.vbe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.3_8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.3_9.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script"}], "Linux_Only": false}, {"Substep": "1.A.4", "Procedure": "", "Criteria": "unprotected.vbe is an encoded file", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"Command Script\" was generated when a command script event indicated that encryption was used in process.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script"}], "Linux_Only": false}, {"Substep": "1.A.5", "Procedure": "", "Criteria": "wscript.exe decodes content and creates starter.vbs", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.5_3.png", "Carbanak-FIN7_SO_1.A.5_2.png", "Carbanak-FIN7_SO_1.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "File Creation / File Modification"}], "Linux_Only": false}, {"Substep": "1.A.6", "Procedure": "", "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.6_2.png", "Carbanak-FIN7_SO_1.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}], "Linux_Only": false}, {"Substep": "1.A.7", "Procedure": "", "Criteria": "wscript.exe executes starter.vbs", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SuspiciousDocument"}, {"Detection_Note": "A Technique detection named \"SuspiciousDocument\" was generated when wscript.exe executed starter.vbs.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "SuspiciousDocument"}], "Linux_Only": false}, {"Substep": "1.A.8", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ProcessCreation"}, {"Detection_Note": "A Technique detection named \"ProcessCreation\" was generated when wscript.exe spawned cmd.exe (DEPRECATED TECHNIQUE TAG).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ProcessCreation"}], "Linux_Only": false}, {"Substep": "1.A.9", "Procedure": "", "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.9.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when cmd.exe spawned wscript.exe to execute TransBaseOdbcDriver.js.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "1.A.10", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "A Technique detection named \"DataExfiltration\" was generated when wscript.exe connected to 192.168.0.4 over port 443.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.10_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.10_1.png", "Carbanak-FIN7_SO_1.A.10.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}], "Linux_Only": false}, {"Substep": "1.A.11", "Procedure": "", "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.11.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"EncryptedChannel\" was generated when wscript connected to 192.168.0.4 over 443.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.11_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "EncryptedChannel"}], "Linux_Only": false}]}, {"Step_Num": 2, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "2.A.2", "Procedure": "", "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"WMIQuerySystemInformationDiscovery\" was generated when wscript.exe made a WMI query for Win32_OperatingSystem .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.A.2.png", "Carbanak-FIN7_SO_2.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs", "Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WMIQuerySystemInformationDiscovery"}], "Linux_Only": false}, {"Substep": "2.A.4", "Procedure": "", "Criteria": "wscript.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiOperation"}, {"Detection_Note": "A Technique detection named \"WMIQueryProcessDiscovery\" was generated when wscript.exe made a WMI query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WMIQueryProcessDiscovery"}], "Linux_Only": false}, {"Substep": "2.B.1", "Procedure": "", "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when wscript.exe downloaded screenshot__.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "2.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "2.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowershellExecution\" was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellExecution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.3.png", "Carbanak-FIN7_SO_2.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "2.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"ScreenshotTaken\" was generated when powershell.exe executed CopyFromScreen().", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "ScreenshotTaken"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.4.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script"}], "Linux_Only": false}, {"Substep": "2.B.5", "Procedure": "", "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"DataExfiltration\" was generated when wscript.exe uploaded screenshot__.png to 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_2.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}], "Linux_Only": false}]}, {"Step_Num": 3, "Step_Name": "Deploy Toolkit", "Substeps": [{"Substep": "3.A.1", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}], "Linux_Only": false}, {"Substep": "3.A.2", "Procedure": "", "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.A.2.png", "Carbanak-FIN7_SO_3.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}, {"Detection_Note": "A Technique detection named \"ModifyRegistry\" was generated when cmd.exe spawned reg.exe to add a value to the registry key.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry"], "Indicator": "", "Indicator_Name": "ModifyRegistry"}], "Linux_Only": false}, {"Substep": "3.A.3", "Procedure": "", "Criteria": "Value added to Registry is base64 encoded", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}], "Linux_Only": false}, {"Substep": "3.B.1", "Procedure": "", "Criteria": "wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.1_4.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "3.B.2", "Procedure": "", "Criteria": "wscript.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.2_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when wscript.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "3.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowershellExecution\" was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellExecution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellExecution"}], "Linux_Only": false}, {"Substep": "3.B.4", "Procedure": "", "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"PowershellCommand\" was generated when powershell.exe read HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty. (could be telemetry but TID may be indicative of sus behavior).", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellCommand"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellCommand"}], "Linux_Only": false}, {"Substep": "3.B.5", "Procedure": "", "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.5.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DecodeData"}, {"Detection_Note": "A Technique detection named \"DecodeData\" was generated when powershell.exe decrypted, decompressed, and base64 decoded the Registry value into plaintext shellcode.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DecodeData"}], "Linux_Only": false}, {"Substep": "3.B.6", "Procedure": "", "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellCommand"}, {"Detection_Note": "A Technique detection named \"SuspiciousShellcode\" was generated when poweshell.exe executed suspicious shell code.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SuspiciousShellcode"}], "Linux_Only": false}, {"Substep": "3.B.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.7_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"DataExfiltration\" was generated when powershell connected to 192.168.0.4 over TCP. (tactic named but correct TID is present).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}], "Linux_Only": false}]}, {"Step_Num": 4, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "4.A.1", "Procedure": "", "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"DirectoryEnumeration\" was generated when powershell.exe calls the FindFirstFileW(). (note from vendor about performance issues on FindNextFileW()).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "DirectoryEnumeration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.A.1_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DirectoryEnumeration"}], "Linux_Only": false}, {"Substep": "4.A.2", "Procedure": "", "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteSystemDiscovery\" was generated when powershell.exe executed Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "RemoteSystemDiscovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.A.2.png", "Carbanak-FIN7_SO_4.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellCommand"}], "Linux_Only": false}, {"Substep": "4.A.3", "Procedure": "", "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.A.3.png", "Carbanak-FIN7_SO_4.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Command Script + IP Connect"}], "Linux_Only": false}, {"Substep": "4.A.4", "Procedure": "", "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"UserLogon\" was generated when powershell.exe successfully logged into host 10.0.0.4 and 10.0.0.5 as user kmitnick.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.A.4_4.png", "Carbanak-FIN7_SO_4.A.4_3.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "UserLogon"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "UserLogon"}], "Linux_Only": false}, {"Substep": "4.B.1", "Procedure": "", "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded rad353F7.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "4.B.2", "Procedure": "", "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded smrs.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.2.png", "Carbanak-FIN7_SO_4.B.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "4.B.3", "Procedure": "", "Criteria": "powershell.exe executes rad353F7.ps1", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowershellExecution + PowershellExecutionPolicyChanged\" was generated when powershell.exe executed rad353F7.ps1.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellExecution + PowershellExecutionPolicyChanged"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellExecution"}], "Linux_Only": false}, {"Substep": "4.B.4", "Procedure": "", "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"ModifyRegistry\" was generated when powershell.exe added a value to the Registry via New-Item and New-ItemProperty.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "Windows Registry"], "Indicator": "", "Indicator_Name": "ModifyRegistry"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.4.png", "Carbanak-FIN7_SO_4.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "Windows Registry"], "Indicator": "", "Indicator_Name": ""}], "Linux_Only": false}, {"Substep": "4.B.5", "Procedure": "", "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.5_1.png", "Carbanak-FIN7_SO_4.B.5.png", "Carbanak-FIN7_SO_4.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ProcessCreation"}], "Linux_Only": false}, {"Substep": "4.B.6", "Procedure": "", "Criteria": "cmd.exe spawns smrs.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when cmd.exe executed smrs.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ProcessCreation"}], "Linux_Only": false}, {"Substep": "4.B.7", "Procedure": "", "Criteria": "smrs.exe opens and reads lsass.exe", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SensitiveMemoryAccess"}, {"Detection_Note": "A Technique detection named \"SensitiveMemoryAccess\" was generated when smrs.exe opened and read lsass.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SensitiveMemoryAccess"}], "Linux_Only": false}]}, {"Step_Num": 5, "Step_Name": "Expand Access", "Substeps": [{"Substep": "5.A.1", "Procedure": "", "Criteria": "powershell.exe downloads pscp.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded pscp.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.1.png", "Carbanak-FIN7_SO_5.A.1_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "5.A.2", "Procedure": "", "Criteria": "powershell.exe downloads psexec.py from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded psexec.py from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.2_1.png", "Carbanak-FIN7_SO_5.A.2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "5.A.3", "Procedure": "", "Criteria": "powershell.exe downloads runtime from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.3_4.png", "Carbanak-FIN7_SO_5.A.3.png", "Carbanak-FIN7_SO_5.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded runtime from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "5.A.4", "Procedure": "", "Criteria": "powershell.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded plink.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.4_1.png", "Carbanak-FIN7_SO_5.A.4.png", "Carbanak-FIN7_SO_5.A.4_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "5.A.5", "Procedure": "", "Criteria": "powershell.exe downloads tiny.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.5_4.png", "Carbanak-FIN7_SO_5.A.5.png", "Carbanak-FIN7_SO_5.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded tiny.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "5.A.6", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when powershell.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "5.A.7", "Procedure": "", "Criteria": "Pscp.exe connects over SCP (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.7.png", "Carbanak-FIN7_SO_5.A.7_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + RemoteConnection"}, {"Detection_Note": "A Technique detection named \"RemoteConnection\" was generated when pscp.exe connected over SCP (port 22) to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteConnection"}], "Linux_Only": true}, {"Substep": "5.A.8", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"ValidAccounts\" was generated when User kmitnick logged on to bakfileserver.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ValidAccounts"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.8_1.png", "Carbanak-FIN7_SO_5.A.8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}], "Linux_Only": true}, {"Substep": "5.A.9", "Procedure": "", "Criteria": "Pscp.exe copies psexec.py to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.9_1.png", "Carbanak-FIN7_SO_5.A.9.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + File Creation"}, {"Detection_Note": "A Technique detection named \"FetchedRemoteFile\" was generated when pscp.exe copied psexec.py to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.9_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "FetchedRemoteFile"}], "Linux_Only": true}, {"Substep": "5.A.10", "Procedure": "", "Criteria": "Pscp.exe copies runtime to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"FetchedRemoteFile\" was generated when pscp.exe copied runtime to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.10_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "FetchedRemoteFile"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.10.png", "Carbanak-FIN7_SO_5.A.10_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + File Creation"}], "Linux_Only": true}, {"Substep": "5.A.11", "Procedure": "", "Criteria": "Pscp.exe copies tiny.exe to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"FetchedRemoteFile\" was generated when pscp.exe copied tiny.exe to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.11.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "FetchedRemoteFile"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.A.11_2.png", "Carbanak-FIN7_SO_5.A.11_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + File Creation"}], "Linux_Only": true}, {"Substep": "5.B.1", "Procedure": "", "Criteria": "plink.exe connects over SSH (port 22) to 10.0.0.7", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.004", "Subtechnique_Name": "Remote Services: SSH"}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteConnection\" was generated when plink.exe connected over SSH (port 22) to 10.0.0.7.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteConnection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}], "Linux_Only": true}, {"Substep": "5.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"ValidAccounts\" was generated when user kmitnick logged on to bankfileserver (10.0.0.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ValidAccounts"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.2_2.png", "Carbanak-FIN7_SO_5.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ValidAccounts"}], "Linux_Only": true}, {"Substep": "5.B.3", "Procedure": "", "Criteria": "User kmitnick executes ps ax", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"ProcessDiscovery\" was generated when user kmitnick executed ps ax.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ProcessDiscovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.3.png", "Carbanak-FIN7_SO_5.B.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ProcessDiscovery"}], "Linux_Only": true}, {"Substep": "5.B.4", "Procedure": "", "Criteria": "User kmitnick executes ls -lsahR /var/", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"FileAndDirectoryDiscovery\" was generated when user kmitnick executed ls -lsahR /var/.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "FileAndDirectoryDiscovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.4_2.png", "Carbanak-FIN7_SO_5.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "FileAndDirectoryDiscovery"}], "Linux_Only": true}, {"Substep": "5.B.5", "Procedure": "", "Criteria": "User kmitnick reads network-diagram-financial.xml via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataFromLocalSystem"}, {"Detection_Note": "A Technique detection named \"DataFromLocalSystem\" was generated when user kmitnick read network-diagram-financial.xml via cat.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataFromLocalSystem"}], "Linux_Only": true}, {"Substep": "5.B.6", "Procedure": "", "Criteria": "User kmitnick reads help-desk-ticket.txt via cat", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataFromLocalSystem"}, {"Detection_Note": "A Technique detection named \"DataFromLocalSystem\" was generated when user kmitnick read help-desk-ticket.txt via cat.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataFromLocalSystem"}], "Linux_Only": true}, {"Substep": "5.B.7", "Procedure": "", "Criteria": "User kmitnick enumerates the domain controller via nslookup, which queries for the DC (10.0.0.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}, {"Detection_Note": "A Technique detection named \"RemoteSystemDiscovery\" was generated when user kmitnick enumerated the domain controller via nslookup.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.B.7_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteSystemDiscovery"}], "Linux_Only": true}, {"Substep": "5.C.1", "Procedure": "", "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Detections": [{"Detection_Note": "A Technique detection named \"PassTheHashTarget\" was generated when psexec.py created a logon to 10.0.0.4 as user kmitnick on bankdc.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.1_7.png", "Carbanak-FIN7_SO_5.C.1_8.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PassTheHashTarget"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + PassTheHash"}, {"Detection_Note": "A Technique detection named \"PassTheHash\" was generated when psexec.py created a logon to 10.0.0.4 as user kmitnick on Linux server.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.1_6.png", "Carbanak-FIN7_SO_5.C.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PassTheHash"}], "Linux_Only": false}, {"Substep": "5.C.2", "Procedure": "", "Criteria": "psexec.py connects to SMB shares on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}], "Linux_Only": false}, {"Substep": "5.C.3", "Procedure": "", "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.3_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ServiceStarted + ProcessCreation"}, {"Detection_Note": "A Technique detection named \"ServiceStarted + ProcessCreation\" was generated when cmd.exe spawned from a service executable in C:\\Windows\\.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.3.png", "Carbanak-FIN7_SO_5.C.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ServiceStarted + ProcessCreation"}, {"Detection_Note": "A General detection named \"ServiceStarted + ProcessCreation\" (Malicious) was generated when cmd.exe spawned from a service executable in C:\\Windows\\. Detection based on a service spawning cmd then executing from specified location.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.3_3.png", "Carbanak-FIN7_SO_5.C.3_2.png", "Carbanak-FIN7_SO_5.C.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "Malicious", "Indicator_Name": "ServiceStarted + ProcessCreation"}], "Linux_Only": false}, {"Substep": "5.C.4", "Procedure": "", "Criteria": "tiny.exe is created on 10.0.0.4", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when tiny.exe was created on 10.0.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.4_2.png", "Carbanak-FIN7_SO_5.C.4_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}], "Linux_Only": false}, {"Substep": "5.C.5", "Procedure": "", "Criteria": "cmd.exe spawns tiny.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when cmd.exe spawned tiny.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}], "Linux_Only": false}, {"Substep": "5.C.6", "Procedure": "", "Criteria": "tiny.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.6_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"SuspiciousShellcode\" was generated when tiny.exe loaded shellcode from a network connection into memory.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.6.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "SuspiciousShellcode"}], "Linux_Only": false}]}, {"Step_Num": 6, "Step_Name": "Discover Potential Targets", "Substeps": [{"Substep": "6.A.1", "Procedure": "", "Criteria": "tiny.exe loads system.management.automation.dll", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"DllLoad + PowershellWithoutPowershellExe\" was generated when tiny.exe loaded system.management.automation.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_6.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "DllLoad + PowershellWithoutPowershellExe"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_6.A.1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DllLoad"}], "Linux_Only": false}, {"Substep": "6.A.2", "Procedure": "", "Criteria": "PowerShell executes Get-ADComputer", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_6.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Command Script"}], "Linux_Only": false}, {"Substep": "6.A.3", "Procedure": "", "Criteria": "PowerShell executes Get-NetUser", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1087", "Technique_Name": "Account Discovery"}, "Subtechnique": {"Subtechnique_Id": "T1087.002", "Subtechnique_Name": "Account Discovery: Domain Account"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_6.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script Get-NetUser"}, {"Detection_Note": "A General detection named \"PowershellCommand\" was generated when PowerShell executed Get-NetUser.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_6.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellCommand"}], "Linux_Only": false}]}, {"Step_Num": 7, "Step_Name": "Setup Persistence", "Substeps": [{"Substep": "7.A.1", "Procedure": "", "Criteria": "tiny.exe downloads plink.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when tiny.exe downloaded plink.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "7.A.2", "Procedure": "", "Criteria": "tiny.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when tiny.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "7.A.3", "Procedure": "", "Criteria": "plink.exe transmits data to 192.168.0.4 over SSH protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.3_1.png", "Carbanak-FIN7_SO_7.A.3_2.png"], "Footnotes": [], "Data_Sources": [], "Indicator": "", "Indicator_Name": "IP Connect + DataExfiltration"}, {"Detection_Note": "A Tactic detection named \"DataExfiltration\" was generated when plink.exe exchanged data with 192.168.0.4 over TCP. Described as SSH.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.3.png", "Carbanak-FIN7_SO_7.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}], "Linux_Only": false}, {"Substep": "7.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to bankdc (10.0.0.4)", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"UserLogon\" was generated when user kmitnick logged on to bankdc (10.0.0.4).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "UserLogon"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "UserLogon"}], "Linux_Only": false}, {"Substep": "7.A.5", "Procedure": "", "Criteria": "RDP session from the localhost over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}], "Linux_Only": false}, {"Substep": "7.B.1", "Procedure": "", "Criteria": "powershell.exe executes qwinsta /server:cfo", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SystemPrimaryUserDiscovery"}, {"Detection_Note": "A Technique detection named \"SystemPrimaryUserDiscovery\" was generated when powershell.exe executed qwinsta /server:cfo.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SystemPrimaryUserDiscovery"}], "Linux_Only": false}, {"Substep": "7.B.2", "Procedure": "", "Criteria": "User kmitnick logs on to cfo (10.0.0.5)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"UserLogon\" was generated when user kmitnick logged on to cfo (10.0.0.5).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.B.2.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "UserLogon"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Windows Event Logs"], "Indicator": "", "Indicator_Name": "UserLogon"}], "Linux_Only": false}, {"Substep": "7.B.3", "Procedure": "", "Criteria": "RDP session from 10.0.0.4 to 10.0.0.5 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"RDPConnection\" was generated when an RDP session was created from bankdc (10.0.0.4) to cfo (10.0.0.5) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RDPConnection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration + RDPConnection"}], "Linux_Only": false}, {"Substep": "7.C.1", "Procedure": "", "Criteria": "scp.exe downloads Java-Update.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when scp.exe downloaded Java-Update.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.1.png", "Carbanak-FIN7_SO_7.C.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.1_3.png", "Carbanak-FIN7_SO_7.C.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "7.C.2", "Procedure": "", "Criteria": "dir lists the contents of C:\\Users\\Public", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"CmdInteractiveCommand + DirectoryEnumeration\" was generated when dir listed the contents of C:\\Users\\Public.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "CmdInteractiveCommand + DirectoryEnumeration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "CmdInteractiveCommand + DirectoryEnumeration"}], "Linux_Only": false}, {"Substep": "7.C.3", "Procedure": "", "Criteria": "cmd.exe downloads Java-Update.vbs from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"MALICIOUS\" was generated when Java-Update.vbs was written to disk in combination with identified patterns of behaviors determined as suspicoius.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "MALICIOUS"}, {"Detection_Note": "A Technique detection named \"CmdInteractiveCommand + RemoteFileCopy\" was generated when cmd.exe downloaded Java-Update.vbs from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "CmdInteractiveCommand + RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.3_3.png", "Carbanak-FIN7_SO_7.C.3_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "CmdInteractiveCommand + RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "7.C.4", "Procedure": "", "Criteria": "Java-Update subkey is added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.4_1.png", "Carbanak-FIN7_SO_7.C.4_2.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RegistryAutorun"}, {"Detection_Note": "A Technique detection named \"RegistryAutorun\" was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_7.C.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "RegistryAutorun"}], "Linux_Only": false}]}, {"Step_Num": 8, "Step_Name": "Gain Covert Access to Target", "Substeps": [{"Substep": "8.A.1", "Procedure": "", "Criteria": "wscript.exe spawns Java-Update.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when wscript.exe spawned Java-Update.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_8.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_8.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "8.A.2", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "A Technique detection named \"DataExfiltration\" was generated when Java-Update.exe exchanges data with 192.168.0.4 over port 80 with SSL.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_8.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_8.A.2_2.png", "Carbanak-FIN7_SO_8.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}], "Linux_Only": false}, {"Substep": "8.A.3", "Procedure": "", "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_8.A.3_3.png", "Carbanak-FIN7_SO_8.A.3_4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"EncryptedChannel\" was generated when Java-Update.exe exchanges data with 192.168.0.4 over port 80 with SSL.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_8.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "EncryptedChannel"}], "Linux_Only": false}]}, {"Step_Num": 9, "Step_Name": "Profile a Victim User", "Substeps": [{"Substep": "9.A.1", "Procedure": "", "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.1_3.png", "Carbanak-FIN7_SO_9.A.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + DataExfiltration"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when Java-Update.exe downloaded DefenderUpgradeExec.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.1.png", "Carbanak-FIN7_SO_9.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "9.A.2", "Procedure": "", "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Tactic detection named \"HookingViaSetHookAPI + KeyloggerInstallation\" was generated when DefenderUpgradeExec.exe called the SetWindowsHookEx API.Tagged with Collection.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.2_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "HookingViaSetHookAPI + KeyloggerInstallation"}, {"Detection_Note": "A Technique detection named \"HookingViaSetHookAPI + KeyloggerInstallation\" was generated when DefenderUpgradeExec.exe called the SetWindowsHookEx API. Key Logger Intallation.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "HookingViaSetHookAPI + KeyloggerInstallation"}], "Linux_Only": false}, {"Substep": "9.A.3", "Procedure": "", "Criteria": "Java-Update.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteInjection + Suspiccious Injection\" was generated when Java-Update.exe injected into remote process .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.3_5.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteInjection + Suspiccious Injection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.3_6.png", "Carbanak-FIN7_SO_9.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "SuspiciousInjection + RemoteInjection"}, {"Detection_Note": "A Technique detection named \"ApiExecution\" was generated when Java-Update.exe injected into explorer.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.3.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "ApiExecution"}], "Linux_Only": false}, {"Substep": "9.A.4", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"DllLoad + ScreenshotTaken\" was generated when explorer.exe took a screenshot.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.4_1.png", "Carbanak-FIN7_SO_9.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "DllLoad + ScreenshotTaken"}], "Linux_Only": false}, {"Substep": "9.A.5", "Procedure": "", "Criteria": "explorer.exe reads C:\\Users\\jsmith\\AppData\\Local\\Temp\\Klog2.txt over to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1005", "Technique_Name": "Data from Local System"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.5_2.png", "Carbanak-FIN7_SO_9.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"DataFromLocalSystemFileOpen\" was generated when explorer.exe (identified as Java-Update.exe) read C:\\Users\\jsmith\\AppData\\Local\\Temp\\klog2.txt over to 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.A.5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DataFromLocalSystemFileOpen"}], "Linux_Only": false}, {"Substep": "9.B.1", "Procedure": "", "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when Java-Update.exe downloaded infosMin48.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.B.1_5.png", "Carbanak-FIN7_SO_9.B.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.B.1_1.png", "Carbanak-FIN7_SO_9.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "None"}], "Linux_Only": false}, {"Substep": "9.B.2", "Procedure": "", "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.B.2.png", "Carbanak-FIN7_SO_9.B.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DllLoad"}], "Linux_Only": false}, {"Substep": "9.B.3", "Procedure": "", "Criteria": "powershell.exe deletes files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1070", "Technique_Name": "Indicator Removal on Host"}, "Subtechnique": {"Subtechnique_Id": "T1070.004", "Subtechnique_Name": "Indicator Removal on Host: File Deletion"}, "Detections": [{"Detection_Note": "A Technique detection named \"FileDelete\" was generated when powershell.exe deleted files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "FileDelete"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_9.B.3_1.png", "Carbanak-FIN7_SO_9.B.3_5.png", "Carbanak-FIN7_SO_9.B.3_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "FileDelete"}], "Linux_Only": false}]}, {"Step_Num": 10, "Step_Name": "Impersonate Victim", "Substeps": [{"Substep": "10.A.1", "Procedure": "", "Criteria": "explorer.exe downloads tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when Java-Update.exe downloaded tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.1_1.png", "Carbanak-FIN7_SO_10.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "File Creation + RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "10.A.2", "Procedure": "", "Criteria": "explorer.exe downloads vnc-settings.reg from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when Java-Update.exe downloads vnc-settings.reg from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "10.A.3", "Procedure": "", "Criteria": "netsh adds Service Host rule for TCP port 5900", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1562", "Technique_Name": "Impair Defenses"}, "Subtechnique": {"Subtechnique_Id": "T1562.004", "Subtechnique_Name": "Impair Defenses: Disable or Modify System Firewall"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "NetworkConfigurationDiscovery + IndirectExecution"}, {"Detection_Note": "A Tactic detection named \"NetworkConfigurationDiscovery + IndirectExecution\" was generated when netsh.exe added 'Service Host' rule to allow TCP port 5900 inbound.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "NetworkConfigurationDiscovery + IndirectExecution"}], "Linux_Only": false}, {"Substep": "10.A.4", "Procedure": "", "Criteria": "msiexec.exe adds the tvncontrol subkey in HKLM\\Software\\Microsoft\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1547", "Technique_Name": "Boot or Logon Autostart Execution"}, "Subtechnique": {"Subtechnique_Id": "T1547.001", "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"}, "Detections": [{"Detection_Note": "A Technique detection named \"RegistryAutorun\" was generated when tvncontrol subkey was added to HKLM\\Software\\Microsoft\\CurrentVersion\\Run.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.4.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RegistryAutorun"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "RegistryAutorun"}], "Linux_Only": false}, {"Substep": "10.A.5", "Procedure": "", "Criteria": "Addition of subkeys in HKLM\\Software\\TightVNC\\Server", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"ModifyRegistry\" was generated when subkeys added to HKLM\\Software\\TightVNC\\Server via vnc-settings.reg.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "ModifyRegistry"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.5_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "ModifyRegistry"}], "Linux_Only": false}, {"Substep": "10.A.6", "Procedure": "", "Criteria": "Deletion of the Java-Update subkey in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"ModifyRegistry + Registry Value Delete\" was generated when Java-Update subkey at HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run was deleted.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.6_1.png", "Carbanak-FIN7_SO_10.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "ModifyRegistry + Registry Value Delete"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.A.6_3.png", "Carbanak-FIN7_SO_10.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "ModifyRegistry"}], "Linux_Only": false}, {"Substep": "10.B.1", "Procedure": "", "Criteria": "tvnserver.exe accepts a connection from 192.168.0.4 over TCP port 5900", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1219", "Technique_Name": "Remote Access Software"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"IP Connect + RemoteServiceConnection\" was generated when tvnserver.exe accepted a connection from 192.168.0.4 over TCP port 5900\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + RemoteServiceConnection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_10.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + RemoteServiceConnection"}], "Linux_Only": false}]}]}, "Scenario_2": {"Steps": [{"Step_Num": 11, "Step_Name": "Initial Breach", "Substeps": [{"Substep": "11.A.1", "Procedure": "", "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"MALICIOUS\" was generated when explorer.exe spawned winword.exe when the user clicked 2-list.rtf.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "MALICIOUS"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Line"}, {"Detection_Note": "A Technique detection named \"UserExecution\" was generated when explorer.exe spawned winword.exe when the user clicked 2-list.rtf.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "UserExecution"}], "Linux_Only": false}, {"Substep": "11.A.2", "Procedure": "", "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"WriteToADS\" was generated when winword.exe wrote to a hidden file section.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "WriteToADS"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "WriteToADS"}], "Linux_Only": false}, {"Substep": "11.A.3", "Procedure": "", "Criteria": "winword.exe spawns mshta.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "MshtaExecuted"}, {"Detection_Note": "A Technique detection named \"MshtaExecuted\" was generated when winword.exe spawned mshta.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "MshtaExecuted"}], "Linux_Only": false}, {"Substep": "11.A.4", "Procedure": "", "Criteria": "mshta.exe executes an embedded VBScript payload", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when mshta.exe executed an embedded VBScript payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.4.png", "Carbanak-FIN7_SO_11.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "11.A.5", "Procedure": "", "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.5_1.png", "Carbanak-FIN7_SO_11.A.5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script + File Creation"}], "Linux_Only": false}, {"Substep": "11.A.6", "Procedure": "", "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Detections": [{"Detection_Note": "A Technique detection named \"DifferentOriginalFilename\" was generated when svchost.exe made a copy of the legitimate wscript.exe as Adb156.exe. (note here about the scheduled task artifact -- difference in parent process name). Delayed since based on execution. .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "DifferentOriginalFilename"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.6_5.png", "Carbanak-FIN7_SO_11.A.6_1.png", "Carbanak-FIN7_SO_11.A.6_6.png", "Carbanak-FIN7_SO_11.A.6_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "File Creation + DifferentOriginalFilename"}], "Linux_Only": false}, {"Substep": "11.A.7", "Procedure": "", "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.7_5.png", "Carbanak-FIN7_SO_11.A.7_6.png", "Carbanak-FIN7_SO_11.A.7_4.png", "Carbanak-FIN7_SO_11.A.7_7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "ModuleLoad(s) + Process Creation"}], "Linux_Only": false}, {"Substep": "11.A.8", "Procedure": "", "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "A Technique detection named \"ModuleLoad + ScheduleTaskRegister\" was generated when mshta.exe loaded taskschd.dll and created a scheduled task to execute in 5 minutes.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.8_1.png", "Carbanak-FIN7_SO_11.A.8.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "ModuleLoad + ScheduleTaskRegister"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.8_3.png", "Carbanak-FIN7_SO_11.A.8_8.png", "Carbanak-FIN7_SO_11.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script + Task Update"}], "Linux_Only": false}]}, {"Step_Num": 12, "Step_Name": "Delayed Malware Execution", "Substeps": [{"Substep": "12.A.1", "Procedure": "", "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.1.png", "Carbanak-FIN7_SO_12.A.1_1.png", "Carbanak-FIN7_SO_12.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}], "Linux_Only": false}, {"Substep": "12.A.2", "Procedure": "", "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Detections": [{"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when Adb156.exe loaded scrobj.dll and executed sql-rat.js using Jscript.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.2_7.png", "Carbanak-FIN7_SO_12.A.2.png", "Carbanak-FIN7_SO_12.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.2_2.png", "Carbanak-FIN7_SO_12.A.2_3.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DllLoad"}], "Linux_Only": false}, {"Substep": "12.A.3", "Procedure": "", "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"IP Connect + Command Script + DataExfiltration \" was generated when Adb156.exe connects to 192.168.0.6 MSSQL transactions.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + Command Script + DataExfiltration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.3_2.png", "Carbanak-FIN7_SO_12.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + Command Script"}], "Linux_Only": false}, {"Substep": "12.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"WmiQueryNetworkConfigurationDiscovery\" was generated when Adb156.exe made a WMI query for Win32_NetworkAdapterConfiguration.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQueryNetworkConfigurationDiscovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.4_2.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": "WmiQueryNetworkConfigurationDiscovery"}], "Linux_Only": false}, {"Substep": "12.A.5", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"WmiQuerySystemInformation\" was generated when Adb156.exe made a WMI query for Win32_LogicalDisk.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Event Logs", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQuerySystemInformation"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQuerySystemInformation"}], "Linux_Only": false}, {"Substep": "12.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads stager.ps1 from 192.168.0.6", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"DataExfiltration + RemoteFileCopy\" was generated when Adb156.exe downloaded stager.ps1 from 192.168.0.6.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration + RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_12.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration + RemoteFileCopy"}], "Linux_Only": false}]}, {"Step_Num": 13, "Step_Name": "Target Assessment", "Substeps": [{"Substep": "13.A.1", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_Process", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"WmiQueryProcessEnumeration\" was generated when Adb156.exe made a WMI query for Win32_Process.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.1_1.png", "Carbanak-FIN7_SO_13.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQueryProcessEnumeration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "WmiQueryProcessEnumeration"}], "Linux_Only": false}, {"Substep": "13.A.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.2_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}, {"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "13.A.3", "Procedure": "", "Criteria": "cmd.exe executes net view", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1135", "Technique_Name": "Network Share Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}, {"Detection_Note": "A Technique detection named \"NetworkShareDiscovery\" was generated when cmd.exe executed net view.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "NetworkShareDiscovery"}], "Linux_Only": false}, {"Substep": "13.A.4", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_BIOS", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1497", "Technique_Name": "Virtualization/Sandbox Evasion"}, "Subtechnique": {"Subtechnique_Id": "T1497.001", "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks"}, "Detections": [{"Detection_Note": "A Technique detection named \"WmiQueryAntiVM\" was generated when Adb156.exe made a WMI query for Win32_BIOS.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.4_1.png", "Carbanak-FIN7_SO_13.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQueryAntiVM"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.4_2.png"], "Footnotes": [], "Data_Sources": ["WMI Objects", "Process Monitoring"], "Indicator": "", "Indicator_Name": "WmiQueryAntiVM"}], "Linux_Only": false}, {"Substep": "13.A.5", "Procedure": "", "Criteria": "Adb156.exe queries the USERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.5_1.png", "Carbanak-FIN7_SO_13.A.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script + SystemPrimaryUserDiscovery"}, {"Detection_Note": "A Technique detection named \"SystemPrimaryUserDiscovery\" was generated when Adb156.exe queried the USERNAME environment variable.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SystemPrimaryUserDiscovery"}], "Linux_Only": false}, {"Substep": "13.A.6", "Procedure": "", "Criteria": "Adb156.exe queries the COMPUTERNAME environment variable", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SystemInformationDiscovery"}, {"Detection_Note": "A Technique detection named \"SystemInformationDiscovery\" was generated when Adb156.exe queried the COMPUTERNAME environment variable.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.6.png", "Carbanak-FIN7_SO_13.A.6_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "SystemInformationDiscovery"}], "Linux_Only": false}, {"Substep": "13.A.8", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_ComputerSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"WmiQueryNetworkConfigurationDiscovery\" was generated when Adb156.exe made a WMI query for Win32_ComputerSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.8.png", "Carbanak-FIN7_SO_13.A.8_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQueryNetworkConfigurationDiscovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQueryNetworkConfigurationDiscovery"}], "Linux_Only": false}, {"Substep": "13.A.9", "Procedure": "", "Criteria": "Adb156.exe makes a WMI query for Win32_OperatingSystem", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"WmiQuerySystemInformationDiscovery\" was generated when Adb156.exe made a WMI query for Win32_OperatingSystem.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.9.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQuerySystemInformationDiscovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "WMI Objects"], "Indicator": "", "Indicator_Name": "WmiQuerySystemInformationDiscovery"}], "Linux_Only": false}, {"Substep": "13.B.1", "Procedure": "", "Criteria": "Adb156.exe downloads takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.1_7.png", "Carbanak-FIN7_SO_13.B.1_5.png", "Carbanak-FIN7_SO_13.B.1_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script + RemoteFileCopy"}, {"Detection_Note": "A Technique detection named \"Command Script + RemoteFileCopy\" was generated when Adb156.exe downloaded takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script + RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "13.B.2", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": ""}, {"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}], "Linux_Only": false}, {"Substep": "13.B.3", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowershellCommand\" was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellCommand"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellCommand"}], "Linux_Only": false}, {"Substep": "13.B.4", "Procedure": "", "Criteria": "powershell.exe executes CopyFromScreen()", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"ScreenshotTaken\" was generated when powershell.exe executed CopyFromScreen().", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScreenshotTaken"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.4_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script"}], "Linux_Only": false}, {"Substep": "13.B.5", "Procedure": "", "Criteria": "Adb156.exe reads and uploads image.png to 192.168.0.6 via MSSQL transactions", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_13.B.5_3.png", "Carbanak-FIN7_SO_13.B.5_4.png", "Carbanak-FIN7_SO_13.B.5.png", "Carbanak-FIN7_SO_13.B.5_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + DataFromLocalFileSystemOpen"}], "Linux_Only": false}]}, {"Step_Num": 14, "Step_Name": "Staging Interactive Toolkit", "Substeps": [{"Substep": "14.A.1", "Procedure": "", "Criteria": "Adb156.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when Adb156.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Line"}], "Linux_Only": false}, {"Substep": "14.A.2", "Procedure": "", "Criteria": "cmd.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowershellCommand\" was generated when cmd.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellCommand"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Line"}], "Linux_Only": false}, {"Substep": "14.A.3", "Procedure": "", "Criteria": "powershell.exe decodes an embedded DLL payload", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"DecodeData\" was generated when powershell.exe decoded an embedded DLL payload.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "DecodeData"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.3_4.png", "Carbanak-FIN7_SO_14.A.3_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "Metadata"}], "Linux_Only": false}, {"Substep": "14.A.4", "Procedure": "", "Criteria": "powershell.exe executes the decoded payload using Invoke-Expression (IEX)", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowershellCommand\" was generated when powershell.exe executed the decoded payload using Invoke-Expression (IEX).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Script Logs"], "Indicator": "", "Indicator_Name": "PowershellCommand"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Script Logs", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script"}], "Linux_Only": false}, {"Substep": "14.A.5", "Procedure": "", "Criteria": "powershell.exe loads shellcode from network connection into memory", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"SuspiciousShellcode\" was generated when powershell.exe loaded shellcode from network connection into memory. (no assumed telemetry because im not sure if this is correct).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SuspiciousShellcode"}], "Linux_Only": false}, {"Substep": "14.A.6", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.6_7.png", "Carbanak-FIN7_SO_14.A.6.png", "Carbanak-FIN7_SO_14.A.6_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}], "Linux_Only": false}, {"Substep": "14.A.7", "Procedure": "", "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"EncryptedChannel\" was generated when powershell.exe connected to 192.168.0.4 over HTTPS.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "EncryptedChannel"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_14.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}], "Linux_Only": false}]}, {"Step_Num": 15, "Step_Name": "Escalate Privileges", "Substeps": [{"Substep": "15.A.1", "Procedure": "", "Criteria": "powershell.exe calls the CreateToolhelp32Snapshot() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"SystemQueryInformation\" was generated when Identifies Reconnaissance when powershell.exe called ntquerysysteminformation or ntquerysysteminformationex.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.1_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "SystemQueryInformation"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.1_2.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "ProcessEnumeration"}, {"Detection_Note": "A Technique detection named \"ProcessEnumeration\" was generated when powershell.exe called ntquerysysteminformation.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.1_1.png", "Carbanak-FIN7_SO_15.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "ProcessEnumeration"}], "Linux_Only": false}, {"Substep": "15.A.2", "Procedure": "", "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A General detection named \"MALICIOUS\" was generated when samcat.exe was written to disk.", "Detection_Type": "General", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.2_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": "MALICIOUS"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded samcat.exe from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.2_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "Metadata"}], "Linux_Only": false}, {"Substep": "15.A.3", "Procedure": "", "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded uac-samcats.ps1 from 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "Metadata"}], "Linux_Only": false}, {"Substep": "15.A.4", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "A Technique detection named \"PowershellExecution\" was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellExecution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Tree"}], "Linux_Only": false}, {"Substep": "15.A.5", "Procedure": "", "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.5_2.png", "Carbanak-FIN7_SO_15.A.5_1.png", "Carbanak-FIN7_SO_15.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}], "Linux_Only": false}, {"Substep": "15.A.6", "Procedure": "", "Criteria": "samcat.exe opens and reads the SAM via LSASS", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Detections": [{"Detection_Note": "A Technique detection named \"AccessSyskey\" was generated when samcat.exe opened and read the SAM.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.6.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "AccessSyskey"}], "Linux_Only": false}, {"Substep": "15.A.7", "Procedure": "", "Criteria": "powershell.exe calls the GetIpNetTable() API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"NetworkConfigDiscovery\" was generated when powershell.exe opened the Interfaces registry key.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.7_1.png", "Carbanak-FIN7_SO_15.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "NetworkConfigDiscovery"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.7_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Metadata"}], "Linux_Only": false}, {"Substep": "15.A.8", "Procedure": "", "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.8_4.png", "Carbanak-FIN7_SO_15.A.8_7.png", "Carbanak-FIN7_SO_15.A.8_6.png", "Carbanak-FIN7_SO_15.A.8_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "NetworkConfigurationDiscovery"}, {"Detection_Note": "A Technique detection named \"NetworkConfigurationDiscovery\" was generated when powershell.exe spawned nslookup.exe, which queried the DC (10.0.1.4) over DNS (port 53).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.8_3.png", "Carbanak-FIN7_SO_15.A.8.png", "Carbanak-FIN7_SO_15.A.8_1.png", "Carbanak-FIN7_SO_15.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "NetworkConfigurationDiscovery"}], "Linux_Only": false}]}, {"Step_Num": 16, "Step_Name": "Expand Access", "Substeps": [{"Substep": "16.A.1", "Procedure": "", "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.1_4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded paexec.exe from 192.168.0.4. (no telemetry because file create events missing, although I guess it can double count).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.1_2.png", "Carbanak-FIN7_SO_16.A.1.png", "Carbanak-FIN7_SO_16.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "16.A.2", "Procedure": "", "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.2_3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe downloaded hollow.exe from 192.168.0.4. (no telemetry because file create events missing, although I guess it can double count).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.2.png", "Carbanak-FIN7_SO_16.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "16.A.3", "Procedure": "", "Criteria": "powershell.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"ScriptExecuted\" was generated when powershell.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}], "Linux_Only": false}, {"Substep": "16.A.4", "Procedure": "", "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"UserLogon\" was generated when User kmitnick logged on to itadmin (10.0.1.6).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.4_1.png", "Carbanak-FIN7_SO_16.A.4_2.png", "Carbanak-FIN7_SO_16.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "UserLogon"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.4_4.png", "Carbanak-FIN7_SO_16.A.4_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Metadata"}], "Linux_Only": false}, {"Substep": "16.A.5", "Procedure": "", "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.5_5.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"SmbShareAccess\" was generated when SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "SmbShareAccess"}], "Linux_Only": false}, {"Substep": "16.A.6", "Procedure": "", "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Detections": [{"Detection_Note": "A Technique detection named \"ServiceStarted + ProcessCreation\" was generated when Windows service started PAExec-7928-HOTELMANAGER.exe, which executed hollow.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.6_1.png", "Carbanak-FIN7_SO_16.A.6_3.png", "Carbanak-FIN7_SO_16.A.6.png", "Carbanak-FIN7_SO_16.A.6_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ServiceStarted + ProcessCreation"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.6_4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ServiceStarted + ProcessCreation"}], "Linux_Only": false}, {"Substep": "16.A.7", "Procedure": "", "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Detections": [{"Detection_Note": "A Technique detection named \"ProcessCreation + ProcessHollowing\" was generated when hollow.exe spawned svchost.exe and mapped its memory image via: NtUnmapViewOfSection.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.7_1.png", "Carbanak-FIN7_SO_16.A.7.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "ProcessCreation + ProcessHollowing"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.7_2.png", "Carbanak-FIN7_SO_16.A.7_4.png", "Carbanak-FIN7_SO_16.A.7_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "ProcessCreation + ProcessHollowing"}], "Linux_Only": false}, {"Substep": "16.A.8", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.8_8.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"DataExfiltration\" was generated when svchost.exe exchanged data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.8.png", "Carbanak-FIN7_SO_16.A.8_1.png", "Carbanak-FIN7_SO_16.A.8_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}], "Linux_Only": false}, {"Substep": "16.A.9", "Procedure": "", "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.9_6.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"IP Connect + EncryptedChannel\" was generated when svchost.exe exchanged data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.9.png", "Carbanak-FIN7_SO_16.A.9_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + EncryptedChannel"}], "Linux_Only": false}]}, {"Step_Num": 17, "Step_Name": "Setup User Monitoring", "Substeps": [{"Substep": "17.A.1", "Procedure": "", "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when svchost.exe created srrstr.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.1_1.png", "Carbanak-FIN7_SO_17.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.1_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}], "Linux_Only": false}, {"Substep": "17.A.2", "Procedure": "", "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Detections": [{"Detection_Note": "A Technique detection named \"PossibleDllHijack\" was generated when srrstr.dll was detected as not legitimate .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "PossibleDllHijack"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.2_1.png", "Carbanak-FIN7_SO_17.A.2_2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "File Modification + PossibleDllHijack"}], "Linux_Only": false}, {"Substep": "17.A.3", "Procedure": "", "Criteria": "svchost.exe spawns cmd.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Detections": [{"Detection_Note": "A Technique detection named \"Process Creation + ScriptExecuted\" was generated when svchost.exe spawned cmd.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation + ScriptExecuted"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation + ScriptExecuted"}], "Linux_Only": false}, {"Substep": "17.A.4", "Procedure": "", "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll", "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "PossibleDllHijack"}, {"Detection_Note": "A Technique detection named \"PossibleDllHijack\" was generated when SystemPropertiesAdvanced.exe executed code in the illegitimate srrstr.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.4.png", "Carbanak-FIN7_SO_17.A.4_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "PossibleDllHijack"}], "Linux_Only": false}, {"Substep": "17.A.5", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "A Technique detection named \"IP Connect + RemoteInjection + DataExifiltration\" was generated when rundll32.exe exchanged data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.5_7.png", "Carbanak-FIN7_SO_17.A.5_8.png", "Carbanak-FIN7_SO_17.A.5_11.png", "Carbanak-FIN7_SO_17.A.5_9.png", "Carbanak-FIN7_SO_17.A.5_5.png", "Carbanak-FIN7_SO_17.A.5_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + RemoteInjection + DataExifiltration"}], "Linux_Only": false}, {"Substep": "17.A.6", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "A Technique detection named \"EncryptedChannel\" was generated when rundll32.exe exchanged data with 192.168.0.4 over HTTPS protocol.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.6_1.png", "Carbanak-FIN7_SO_17.A.6.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "EncryptedChannel"}], "Linux_Only": false}]}, {"Step_Num": 18, "Step_Name": "User Monitoring", "Substeps": [{"Substep": "18.A.1", "Procedure": "", "Criteria": "svchost.exe injects into explorer.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_18.A.1_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Cross Process Remote Thread Creation"}, {"Detection_Note": "A Technique detection named \"APIExecution\" was generated when svchost.exe injected into explorer.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_18.A.1_1.png"], "Footnotes": [], "Data_Sources": ["System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "APIExecution"}, {"Detection_Note": "A Technique detection named \"RemoteInjection + Suspicious Injection\" was generated when svchost.exe injected into explorer.exe with CreateRemoteThread. Note: Algorithm tracks first process rather than new processes throughout infection chain. .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_18.A.1_2.png", "Carbanak-FIN7_SO_18.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteInjection + Suspicious Injection"}], "Linux_Only": false}, {"Substep": "18.A.2", "Procedure": "", "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll", "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_18.A.2_1.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring"], "Indicator": "", "Indicator_Name": "ModuleLoad"}, {"Detection_Note": "A Technique detection named \"ScreenshotTaken\" was generated when explorer.exe called the CreateCompatibleBitmap API from Gdi32.dll.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_18.A.2.png"], "Footnotes": [], "Data_Sources": ["DLL Monitoring", "System Calls/API Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "ScreenshotTaken"}], "Linux_Only": false}, {"Substep": "18.A.3", "Procedure": "", "Criteria": "explorer.exe injects into mstsc.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"SuspiciousInjection + ApiExecution\" was generated when hollow.exe injected into mstsc.exe with CreateRemoteThread.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_18.A.3_2.png", "Carbanak-FIN7_SO_18.A.3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "SuspiciousInjection + ApiExecution"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_18.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "SuspiciousInjection"}], "Linux_Only": false}, {"Substep": "18.A.4", "Procedure": "", "Criteria": "mstsc.exe calls APIs such as GetAsyncKeyState, GetKeyState, or GetKeyboardState", "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Detections": [{"Detection_Note": "A Technique detection named \"KeyloggerRegistered\" was generated when mstsc.exe called APIs GetAsyncKeyState or GetKeyState. Note, process name is inherited from original process. .", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_18.A.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "KeyloggerRegistered"}], "Linux_Only": false}]}, {"Step_Num": 19, "Step_Name": "Setup Shim Persistence", "Substeps": [{"Substep": "19.A.1", "Procedure": "", "Criteria": "User kmitnick logs on to accounting (10.0.1.7)", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Detections": [{"Detection_Note": "A Technique detection named \"UserSuccessfulLogon\" was generated when user kmitnick logged on to accounting (10.0.1.7).", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.A.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "UserSuccessfulLogon"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.A.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "UserSuccessfulLogon"}], "Linux_Only": false}, {"Substep": "19.A.2", "Procedure": "", "Criteria": "RDP session from 10.0.1.6 to 10.0.1.7 over TCP port 3389", "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.001", "Subtechnique_Name": "Remote Services: Remote Desktop Protocol"}, "Detections": [{"Detection_Note": "A Technique detection named \"RDPConnection\" was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.A.2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RDPConnection"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "IPConnect"}], "Linux_Only": false}, {"Substep": "19.A.3", "Procedure": "", "Criteria": "itadmin (10.0.1.6) is relaying RDP traffic from attacker infrastructure", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1090", "Technique_Name": "Proxy"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.A.3_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "IPConnect + ProxySettingsChanged"}, {"Detection_Note": "A Technique detection named \"ProxySettingsChanged\" was generated when itadmin alerted ProxySettingsChanged with command Wpadroxy showing syspropadv process modifying settings earlier in execution.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.A.3.png", "Carbanak-FIN7_SO_19.A.3_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "ProxySettingsChanged"}], "Linux_Only": false}, {"Substep": "19.B.1", "Procedure": "", "Criteria": "powershell.exe spawns powershell.exe", "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Process Creation"}, {"Detection_Note": "A Technique detection named \"PowershellExecution\" was generated when powershell.exe spawned powershell.exe.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "PowershellExecution"}], "Linux_Only": false}, {"Substep": "19.B.2", "Procedure": "", "Criteria": "powershell.exe executes base64 encoded commands", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"EncodedPSCommand\" was generated when powershell.exe executed base64 encoded commands\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "EncodedPSCommand"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.2_1.png", "Carbanak-FIN7_SO_19.B.2_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Command Script + EncodedPSCommand"}], "Linux_Only": false}, {"Substep": "19.B.3", "Procedure": "", "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.3_4.png", "Carbanak-FIN7_SO_19.B.3_5.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "DLL Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when source process ps downloads dll329.dll with a behavioral indicator name of RemoteFileCopy.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.3_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "DLL Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}], "Linux_Only": false}, {"Substep": "19.B.4", "Procedure": "", "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"RemoteFileCopy\" was generated when powershell.exe created sdbE376.tmp\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.4_1.png", "Carbanak-FIN7_SO_19.B.4.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RemoteFileCopy"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.4_2.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}], "Linux_Only": false}, {"Substep": "19.B.5", "Procedure": "", "Criteria": "sdbinst.exe installs sdbE376.tmp shim", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "A Technique detection named \"RegistryShimInstall\" was generated when sdbinst.exe installed sdbE376.tmp shim database\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.5_1.png", "Carbanak-FIN7_SO_19.B.5.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "Process Monitoring"], "Indicator": "", "Indicator_Name": "RegistryShimInstall"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Windows Registry"], "Indicator": "", "Indicator_Name": "RegistryShimInstall"}], "Linux_Only": false}]}, {"Step_Num": 20, "Step_Name": "Steal Payment Data", "Substeps": [{"Substep": "20.A.1", "Procedure": "", "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll", "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.1_8.png", "Carbanak-FIN7_SO_20.A.1_5.png", "Carbanak-FIN7_SO_20.A.1_9.png", "Carbanak-FIN7_SO_20.A.1_4.png"], "Footnotes": [], "Data_Sources": ["Windows Registry", "DLL Monitoring", "File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DllLoad + QueryRegistry"}, {"Detection_Note": "A Technique detection named \"ApplicationShimming\" was generated when AccountingIQ.exe is shimmed by an unknown fix.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "ApplicationShimming"}], "Linux_Only": false}, {"Substep": "20.A.2", "Procedure": "", "Criteria": "AccountingIQ.exe injects into SyncHost.exe with CreateRemoteThread", "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.2_6.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring"], "Indicator": "", "Indicator_Name": "Cross Process Open Remote Connection"}, {"Detection_Note": "A Technique detection named \"APIExecution\" was generated when AccountingIQ.exe injected into SyncHost.exe with CreateRemoteThread\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.2_5.png", "Carbanak-FIN7_SO_20.A.2_3.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "APIExecution"}, {"Detection_Note": "A Technique detection named \"RemoteInjection + SuspiciousInjection\" was generated when AccountingIQ.exe injected into SyncHost.exe with CreateRemoteThread\n.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.2.png", "Carbanak-FIN7_SO_20.A.2_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "RemoteInjection + SuspiciousInjection"}], "Linux_Only": false}, {"Substep": "20.A.3", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.3_3.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"DataExfiltration\" was generated when rundll32.exe transmits data to 192.168.0.4 over HTTPS.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.3_4.png", "Carbanak-FIN7_SO_20.A.3_5.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}], "Linux_Only": false}, {"Substep": "20.A.4", "Procedure": "", "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.4_2.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect"}, {"Detection_Note": "A Technique detection named \"EncryptedChannel\" was generated when rundll32.exe exchanged TLS/SSL encrypted data with 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.A.4.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "EncryptedChannel"}], "Linux_Only": false}, {"Substep": "20.B.1", "Procedure": "", "Criteria": "rundll32.exe downloads debug.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Tactic detection named \"DataExfiltration\" was generated when rundll32.exe downloaded debug.exe from 192.168.0.4\n.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.1.png", "Carbanak-FIN7_SO_20.B.1_1.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.1_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}], "Linux_Only": false}, {"Substep": "20.B.2", "Procedure": "", "Criteria": "debug.exe calls the CreateToolhelp32Snapshot API", "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"SystemQueryInformation\" was generated when debug.exe calls the lower level API that calls CreateToolhelp32Snapshot API.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.2_1.png", "Carbanak-FIN7_SO_20.B.2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "System Calls/API Monitoring"], "Indicator": "", "Indicator_Name": "SystemQueryInformation"}], "Linux_Only": false}, {"Substep": "20.B.3", "Procedure": "", "Criteria": "rundll32.exe downloads 7za.exe from 192.168.0.4", "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.3_3.png", "Carbanak-FIN7_SO_20.B.3_1.png"], "Footnotes": [], "Data_Sources": ["Network Monitoring", "Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}, {"Detection_Note": "A Tactic detection named \"DataExfiltration\" was generated when rundll32.exe downloaded 7za.exe from 192.168.0.4\n.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.3.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}], "Linux_Only": false}, {"Substep": "20.B.4", "Procedure": "", "Criteria": "7za.exe creates C:\\Users\\Public\\log.7z", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1560", "Technique_Name": "Archive Collected Data"}, "Subtechnique": {"Subtechnique_Id": "T1560.001", "Subtechnique_Name": "Archive Collected Data: Archive via Utility"}, "Detections": [{"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.4_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Process Monitoring"], "Indicator": "", "Indicator_Name": "File Creation"}, {"Detection_Note": "A Tactic detection named \"DataFromLocalFileSystemOpen\" was generated when 7za.exe created C:\\Users\\Public\\log.7z.", "Detection_Type": "Tactic", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.4.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "File Monitoring"], "Indicator": "", "Indicator_Name": "DataFromLocalFileSystemOpen"}], "Linux_Only": false}, {"Substep": "20.B.5", "Procedure": "", "Criteria": "rundll32.exe reads and uploads log.7z to 192.168.0.4", "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": "", "Subtechnique_Name": ""}, "Detections": [{"Detection_Note": "A Technique detection named \"DataExfiltration\" was generated when rundll32.exe reads and uploads log.7z to 192.168.0.4.", "Detection_Type": "Technique", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.5_2.png"], "Footnotes": [], "Data_Sources": ["Process Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "DataExfiltration"}, {"Detection_Note": "", "Detection_Type": "Telemetry", "Modifiers": [], "Screenshots": ["Carbanak-FIN7_SO_20.B.5_1.png"], "Footnotes": [], "Data_Sources": ["File Monitoring", "Network Monitoring"], "Indicator": "", "Indicator_Name": "IP Connect + File Creation"}], "Linux_Only": false}]}]}}, "Protections": {"Protection_Tests": [{"Test_Num": 1, "Test_Group": "Carbanak", "Test_Name": "Initial Access with Embedded VBE in Word Document", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "1.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf"}, {"Substep_Name": "1.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe loads VBE7.DLL"}, {"Substep_Name": "1.A.3", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 1 was blocked when wscript.exe was terminated, because winword.exe launched wscript.exe and was deemed malicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_1.A.3P.png", "Carbanak-FIN7_SO_1.A.3P_1.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes unprotected.vbe"}, {"Substep_Name": "1.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "unprotected.vbe is an encoded file"}, {"Substep_Name": "1.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates starter.vbs"}, {"Substep_Name": "1.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "wscript.exe executes starter.vbs"}, {"Substep_Name": "1.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "1.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js"}, {"Substep_Name": "1.A.10", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "1.A.11", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "2.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1033", "Technique_Name": "System Owner/User Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem"}, {"Substep_Name": "2.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe accesses the Windows Script Host Network Object COM object by loading wshom.ocx then calling the DllGetClassObject() API"}, {"Substep_Name": "2.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1057", "Technique_Name": "Process Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe makes a WMI query for Win32_Process"}, {"Substep_Name": "2.B.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4"}, {"Substep_Name": "2.B.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "wscript.exe spawns cmd.exe"}, {"Substep_Name": "2.B.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "cmd.exe spawns powershell.exe"}, {"Substep_Name": "2.B.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0009", "Tactic_Name": "Collection"}, "Technique": {"Technique_Id": "T1113", "Technique_Name": "Screen Capture"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes CopyFromScreen()"}, {"Substep_Name": "2.B.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0010", "Tactic_Name": "Exfiltration"}, "Technique": {"Technique_Id": "T1041", "Technique_Name": "Exfiltration Over Command and Control Channel"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4"}], "Test_Screenshots": []}, {"Test_Num": 2, "Test_Group": "Carbanak", "Test_Name": "Registry Shellcode and Execution", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "3.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer"}, {"Substep_Name": "3.A.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Value added to Registry is base64 encoded"}, {"Substep_Name": "3.B.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1012", "Technique_Name": "Query Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty"}, {"Substep_Name": "3.B.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode"}, {"Substep_Name": "3.B.6", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 2 was blocked when the process was terminated, because it loaded shellcode of a known penetration framework", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_3.B.6P_1.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1106", "Technique_Name": "Native API"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API"}, {"Substep_Name": "3.B.7", "Protection_Type": "None", "Modifier": null, "Protection_Note": "", "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1095", "Technique_Name": "Non-Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP"}, {"Substep_Name": "4.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1083", "Technique_Name": "File and Directory Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs"}, {"Substep_Name": "4.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4"}, {"Substep_Name": "4.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1110", "Technique_Name": "Brute Force"}, "Subtechnique": {"Subtechnique_Id": "T1110.003", "Subtechnique_Name": "Brute Force: Password Spraying"}, "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access"}, {"Substep_Name": "4.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick"}], "Test_Screenshots": []}, {"Test_Num": 3, "Test_Group": "Carbanak", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hrmanager (10.0.0.6) as user kmitnick", "Substeps": [{"Substep_Name": "4.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4"}, {"Substep_Name": "4.B.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 3 was blocked when smrs.exe was quarantined upon creation, because the binary contained abnormal section names.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_4.B.2P.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4"}, {"Substep_Name": "4.B.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe executes rad353F7.ps1"}, {"Substep_Name": "4.B.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1112", "Technique_Name": "Modify Registry"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty"}, {"Substep_Name": "4.B.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "4.B.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns smrs.exe"}, {"Substep_Name": "4.B.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "smrs.exe opens and reads lsass.exe"}], "Test_Screenshots": []}, {"Test_Num": 4, "Test_Group": "Carbanak", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity all on bankfileserver (10.0.0.7) to bankdc (10.0.0.4) as user kmitnick", "Substeps": [{"Substep_Name": "5.C.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 4 was blocked when runtime was terminated and network session closed, because it was identified as running psexec.py.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_5.C.1P.png"], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1550", "Technique_Name": "Use Alternate Authentication Material"}, "Subtechnique": {"Subtechnique_Id": "T1550.002", "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash"}, "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick"}, {"Substep_Name": "5.C.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "psexec.py connects to SMB shares on 10.0.0.4"}, {"Substep_Name": "5.C.3", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\"}, {"Substep_Name": "5.C.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1570", "Technique_Name": "Lateral Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe is created on 10.0.0.4"}, {"Substep_Name": "5.C.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.003", "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell"}, "Criteria": "cmd.exe spawns tiny.exe"}, {"Substep_Name": "5.C.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "tiny.exe loads shellcode from network connection into memory"}], "Test_Screenshots": []}, {"Test_Num": 5, "Test_Group": "Carbanak", "Test_Name": "Credential Access", "Test_Description": "Activity on cfo (10.0.0.5) as user jsmith", "Substeps": [{"Substep_Name": "9.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4"}, {"Substep_Name": "9.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1056", "Technique_Name": "Input Capture"}, "Subtechnique": {"Subtechnique_Id": "T1056.001", "Subtechnique_Name": "Input Capture: Keylogging"}, "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API"}, {"Substep_Name": "9.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4"}, {"Substep_Name": "9.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1555", "Technique_Name": "Credentials from Password Stores"}, "Subtechnique": {"Subtechnique_Id": "T1555.003", "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers"}, "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll"}], "Test_Screenshots": []}, {"Test_Num": 11, "Test_Group": "FIN7", "Test_Name": "Initial Access with Embedded VBS in Word Document", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "11.A.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1204", "Technique_Name": "User Execution"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf"}, {"Substep_Name": "11.A.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk"}, {"Substep_Name": "11.A.3", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 11 was blocked when an OLE object within 2-list.rtf was not executed, because it was identified as malware.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_11.A.3P_1.png", "Carbanak-FIN7_SO_11.A.3P.png"], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1218", "Technique_Name": "Signed Binary Proxy Execution"}, "Subtechnique": {"Subtechnique_Id": "T1218.005", "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta"}, "Criteria": "winword.exe spawns mshta.exe"}, {"Substep_Name": "11.A.4", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.005", "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic"}, "Criteria": "mshta.exe executes an embedded VBScript payload"}, {"Substep_Name": "11.A.5", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1140", "Technique_Name": "Deobfuscate/Decode Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload"}, {"Substep_Name": "11.A.6", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.003", "Subtechnique_Name": "Masquerading: Rename System Utilities"}, "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe"}, {"Substep_Name": "11.A.7", "Protection_Type": null, "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1559", "Technique_Name": "Inter-Process Communication"}, "Subtechnique": {"Subtechnique_Id": "T1559.001", "Subtechnique_Name": "Inter-Process Communication: Component Object Model"}, "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL"}, {"Substep_Name": "11.A.8", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes"}, {"Substep_Name": "12.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1053", "Technique_Name": "Scheduled Task/Job"}, "Subtechnique": {"Subtechnique_Id": "T1053.005", "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task"}, "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe"}, {"Substep_Name": "12.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.007", "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/Jscript"}, "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript"}, {"Substep_Name": "12.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions"}, {"Substep_Name": "12.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration"}, {"Substep_Name": "12.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1082", "Technique_Name": "System Information Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk"}], "Test_Screenshots": []}, {"Test_Num": 12, "Test_Group": "FIN7", "Test_Name": "UAC Bypass and Credential Dumping", "Test_Description": "Activity all on hotelmanager (10.0.1.5) as user kmitnick", "Substeps": [{"Substep_Name": "15.A.2", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 12 was blocked when samcat.exe was quarantined after write, because it was determined this file to be malicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_15.A.2P.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4"}, {"Substep_Name": "15.A.3", "Protection_Type": null, "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4"}, {"Substep_Name": "15.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "15.A.5", "Protection_Type": null, "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1548", "Technique_Name": "Abuse Elevation Control Mechanism"}, "Subtechnique": {"Subtechnique_Id": "T1548.002", "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control"}, "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)"}, {"Substep_Name": "15.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0006", "Tactic_Name": "Credential Access"}, "Technique": {"Technique_Id": "T1003", "Technique_Name": "OS Credential Dumping"}, "Subtechnique": {"Subtechnique_Id": "T1003.001", "Subtechnique_Name": "OS Credential Dumping: LSASS Memory"}, "Criteria": "samcat.exe opens and reads the SAM via LSASS"}, {"Substep_Name": "15.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1016", "Technique_Name": "System Network Configuration Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe calls the GetIpNetTable() API"}, {"Substep_Name": "15.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0007", "Tactic_Name": "Discovery"}, "Technique": {"Technique_Id": "T1018", "Technique_Name": "Remote System Discovery"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)"}], "Test_Screenshots": []}, {"Test_Num": 13, "Test_Group": "FIN7", "Test_Name": "Lateral Movement via Pass-the-Hash", "Test_Description": "Activity from hotelmanager (10.0.1.5) to itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "16.A.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 13 was blocked when paexec.exe was quarantined, because it was determined to be malicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_16.A.1P.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4"}, {"Substep_Name": "16.A.2", "Protection_Type": null, "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4"}, {"Substep_Name": "16.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1078", "Technique_Name": "Valid Accounts"}, "Subtechnique": {"Subtechnique_Id": "T1078.002", "Subtechnique_Name": "Valid Accounts: Domain Accounts"}, "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)"}, {"Substep_Name": "16.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0008", "Tactic_Name": "Lateral Movement"}, "Technique": {"Technique_Id": "T1021", "Technique_Name": "Remote Services"}, "Subtechnique": {"Subtechnique_Id": "T1021.002", "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares"}, "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed"}, {"Substep_Name": "16.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1569", "Technique_Name": "System Services"}, "Subtechnique": {"Subtechnique_Id": "T1569.002", "Subtechnique_Name": "System Services: Service Execution"}, "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe"}, {"Substep_Name": "16.A.7", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1055", "Technique_Name": "Process Injection"}, "Subtechnique": {"Subtechnique_Id": "T1055.012", "Subtechnique_Name": "Process Injection: Process Hollowing"}, "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection"}, {"Substep_Name": "16.A.8", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "16.A.9", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 14, "Test_Group": "FIN7", "Test_Name": "DLL Hijacking", "Test_Description": "Activity on itadmin (10.0.1.6) as user kmitnick", "Substeps": [{"Substep_Name": "17.A.1", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 14 was blocked when srrstr.dll was quarantined, because it was identified as malicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_17.A.1P.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)"}, {"Substep_Name": "17.A.2", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1036", "Technique_Name": "Masquerading"}, "Subtechnique": {"Subtechnique_Id": "T1036.005", "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location"}, "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library"}, {"Substep_Name": "17.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0004", "Tactic_Name": "Privilege Escalation"}, "Technique": {"Technique_Id": "T1574", "Technique_Name": "Hijack Execution Flow"}, "Subtechnique": {"Subtechnique_Id": "T1574.001", "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking"}, "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll"}, {"Substep_Name": "17.A.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "17.A.6", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}, {"Test_Num": 15, "Test_Group": "FIN7", "Test_Name": "Shim Persistence", "Test_Description": "Activity on accounting (10.0.1.7) as user kmitnick", "Substeps": [{"Substep_Name": "19.B.1", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0002", "Tactic_Name": "Execution"}, "Technique": {"Technique_Id": "T1059", "Technique_Name": "Command and Scripting Interpreter"}, "Subtechnique": {"Subtechnique_Id": "T1059.001", "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell"}, "Criteria": "powershell.exe spawns powershell.exe"}, {"Substep_Name": "19.B.2", "Protection_Type": "None", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0005", "Tactic_Name": "Defense Evasion"}, "Technique": {"Technique_Id": "T1027", "Technique_Name": "Obfuscated Files or Information"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe executes base64 encoded commands"}, {"Substep_Name": "19.B.3", "Protection_Type": "Blocked", "Modifier": null, "Protection_Note": "Test 15 was blocked when dll329.dll was quarantined, because it was identified as malicious.", "Footnotes": [], "Screenshots": ["Carbanak-FIN7_SO_19.B.3P.png"], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4"}, {"Substep_Name": "19.B.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1105", "Technique_Name": "Ingress Tool Transfer"}, "Subtechnique": {"Subtechnique_Id": null, "Subtechnique_Name": null}, "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4"}, {"Substep_Name": "19.B.5", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "sdbinst.exe installs sdbE376.tmp shim"}, {"Substep_Name": "20.A.1", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0003", "Tactic_Name": "Persistence"}, "Technique": {"Technique_Id": "T1546", "Technique_Name": "Event Triggered Execution"}, "Subtechnique": {"Subtechnique_Id": "T1546.011", "Subtechnique_Name": "Event Triggered Execution: Application Shimming"}, "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll"}, {"Substep_Name": "20.A.3", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1071", "Technique_Name": "Application Layer Protocol"}, "Subtechnique": {"Subtechnique_Id": "T1071.001", "Subtechnique_Name": "Application Layer Protocol: Web Protocols"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}, {"Substep_Name": "20.A.4", "Protection_Type": "N/A", "Modifier": null, "Protection_Note": null, "Footnotes": [], "Screenshots": [], "Tactic": {"Tactic_Id": "TA0011", "Tactic_Name": "Command and Control"}, "Technique": {"Technique_Id": "T1573", "Technique_Name": "Encrypted Channel"}, "Subtechnique": {"Subtechnique_Id": "T1573.002", "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography"}, "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol"}], "Test_Screenshots": []}]}}]}